{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577",
    "id": 3277895355,
    "node_id": "PR_kwDOABII587DYLa7",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/34577",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/34577.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/34577.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
    "number": 34577,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "http: fix submission during shutdown race",
    "user": {
      "login": "furszy",
      "id": 5377650,
      "node_id": "MDQ6VXNlcjUzNzc2NTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/furszy",
      "html_url": "https://github.com/furszy",
      "followers_url": "https://api.github.com/users/furszy/followers",
      "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
      "organizations_url": "https://api.github.com/users/furszy/orgs",
      "repos_url": "https://api.github.com/users/furszy/repos",
      "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/furszy/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "Fixes #34573.\r\n\r\nAs mentioned in https://github.com/bitcoin/bitcoin/issues/34573#issuecomment-3891596958, the ThreadPool PR (#33689) revealed an existing issue.\r\n\r\nBefore that PR, we were returning an incorrect error \"Request rejected because http work queue depth exceeded\" during shutdown for unhandled requests (we were not differentiating between \"queue depth exceeded\" and \"server interrupted\" errors). Now, with the ThreadPool inclusion, we return the proper error but we don't handle it properly.\r\n\r\nThis PR improves exactly that. Handling the missing error and properly returning it to the user.\r\n\r\nThe race can be reproduced as follows:\r\n\r\n1) The server receives an http request.\r\n2) Processing of the request is delayed, and shutdown is triggered in the meantime.\r\n3) During shutdown, the libevent callback is unregistered and the threadpool interrupted.\r\n4) The delayed request (step 2) resumes and tries to submit a task to the now-interrupted server.\r\n\r\nReproduction test can be found https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3902672521.\r\n\r\nAlso, to prevent this kind of issue from happening again, this PR changes task submission\r\nto return the error as part of the function's return value using `util::Expected` instead of\r\nthrowing the exception. Unlike exceptions, which require extra try-catch blocks and can be\r\nignored, returning `Expected` forces callers to explicitly handle failures, and attributes\r\nlike `[[nodiscard]]` allow us catch unhandled ones at compile time.\r\n\r\n",
    "labels": [
      {
        "id": 98279177,
        "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
        "name": "RPC/REST/ZMQ",
        "color": "0052cc",
        "default": false
      }
    ],
    "milestone": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/74",
      "html_url": "https://github.com/bitcoin/bitcoin/milestone/74",
      "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/74/labels",
      "id": 12610874,
      "node_id": "MI_kwDOABII584AwG06",
      "number": 74,
      "state": "open",
      "title": "31.0",
      "creator": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "open_issues": 19,
      "closed_issues": 58,
      "created_at": "2025-03-25T18:44:16Z",
      "updated_at": "2026-02-20T11:13:10Z"
    },
    "created_at": "2026-02-12T19:52:35Z",
    "updated_at": "2026-02-20T12:18:55Z",
    "closed_at": "2026-02-19T20:41:24Z",
    "mergeable_state": "unknown",
    "merged": true,
    "merged_at": "2026-02-19T20:41:24Z",
    "merged_by": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "merge_commit_sha": "02c83fef84315ef227b1ec4a31fd558cecd3699c",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "head": {
      "label": "furszy:2026_http_submission_error",
      "ref": "2026_http_submission_error",
      "sha": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 143624913,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDM2MjQ5MTM=",
        "name": "bitcoin-core",
        "full_name": "furszy/bitcoin-core",
        "owner": {
          "login": "furszy",
          "id": 5377650,
          "node_id": "MDQ6VXNlcjUzNzc2NTA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/furszy",
          "html_url": "https://github.com/furszy",
          "followers_url": "https://api.github.com/users/furszy/followers",
          "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
          "organizations_url": "https://api.github.com/users/furszy/orgs",
          "repos_url": "https://api.github.com/users/furszy/repos",
          "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/furszy/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/furszy/bitcoin-core",
        "description": "Bitcoin-Core",
        "fork": true,
        "url": "https://api.github.com/repos/furszy/bitcoin-core",
        "archive_url": "https://api.github.com/repos/furszy/bitcoin-core/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/furszy/bitcoin-core/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/furszy/bitcoin-core/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/furszy/bitcoin-core/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/furszy/bitcoin-core/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/furszy/bitcoin-core/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/furszy/bitcoin-core/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/furszy/bitcoin-core/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/furszy/bitcoin-core/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/furszy/bitcoin-core/contributors",
        "deployments_url": "https://api.github.com/repos/furszy/bitcoin-core/deployments",
        "downloads_url": "https://api.github.com/repos/furszy/bitcoin-core/downloads",
        "events_url": "https://api.github.com/repos/furszy/bitcoin-core/events",
        "forks_url": "https://api.github.com/repos/furszy/bitcoin-core/forks",
        "git_commits_url": "https://api.github.com/repos/furszy/bitcoin-core/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/furszy/bitcoin-core/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/furszy/bitcoin-core/git/tags%7B/sha%7D",
        "git_url": "git://github.com/furszy/bitcoin-core.git",
        "issue_comment_url": "https://api.github.com/repos/furszy/bitcoin-core/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/furszy/bitcoin-core/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/furszy/bitcoin-core/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/furszy/bitcoin-core/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/furszy/bitcoin-core/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/furszy/bitcoin-core/languages",
        "merges_url": "https://api.github.com/repos/furszy/bitcoin-core/merges",
        "milestones_url": "https://api.github.com/repos/furszy/bitcoin-core/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/furszy/bitcoin-core/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/furszy/bitcoin-core/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/furszy/bitcoin-core/releases%7B/id%7D",
        "ssh_url": "git@github.com:furszy/bitcoin-core.git",
        "stargazers_url": "https://api.github.com/repos/furszy/bitcoin-core/stargazers",
        "statuses_url": "https://api.github.com/repos/furszy/bitcoin-core/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/furszy/bitcoin-core/subscribers",
        "subscription_url": "https://api.github.com/repos/furszy/bitcoin-core/subscription",
        "tags_url": "https://api.github.com/repos/furszy/bitcoin-core/tags",
        "teams_url": "https://api.github.com/repos/furszy/bitcoin-core/teams",
        "trees_url": "https://api.github.com/repos/furszy/bitcoin-core/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/furszy/bitcoin-core.git",
        "hooks_url": "https://api.github.com/repos/furszy/bitcoin-core/hooks",
        "svn_url": "https://github.com/furszy/bitcoin-core",
        "homepage": "",
        "language": "C++",
        "forks_count": 3,
        "stargazers_count": 6,
        "watchers_count": 6,
        "size": 449368,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-02-20T01:50:29Z",
        "created_at": "2018-08-05T15:28:43Z",
        "updated_at": "2026-02-07T21:37:50Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "5a8a427610ed9672f485ebfefbb8e63b55282636",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38919,
        "stargazers_count": 88193,
        "watchers_count": 88193,
        "size": 305452,
        "default_branch": "master",
        "open_issues_count": 719,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-02-20T11:13:08Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2026-02-20T11:25:22Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 73,
    "deletions": 38,
    "changed_files": 4,
    "commits": 2,
    "review_comments": 50,
    "comments": 16
  },
  "events": [
    {
      "event": "labeled",
      "id": 22746199637,
      "node_id": "LE_lADOABII587qd6NDzwAAAAVLx3ZV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22746199637",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T19:52:39Z",
      "label": {
        "name": "RPC/REST/ZMQ",
        "color": "0052cc"
      }
    },
    {
      "event": "commented",
      "id": 3893067383,
      "node_id": "IC_kwDOABII587oC353",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3893067383",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T19:52:59Z",
      "updated_at": "2026-02-19T19:52:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [sedited](https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3827194832), [pinheadmz](https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3827498505), [andrewtoth](https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3827663956), [achow101](https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3929502437), [hodlinator](https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3828179137) |\n| Concept ACK | [ismaelsadeeq](https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3809321408) |\n| Stale ACK | [Eunovo](https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3824639287) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#34562](https://github.com/bitcoin/bitcoin/pull/34562) (ThreadPool follow-ups, proactive shutdown and HasReason dependency cleanup by furszy)\n* [#32061](https://github.com/bitcoin/bitcoin/pull/32061) (Replace libevent with our own HTTP and socket-handling implementation by pinheadmz)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3893067383",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22746449751,
      "node_id": "HRFPE_lADOABII587qd6NDzwAAAAVLy0dX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22746449751",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "commit_url": "https://api.github.com/repos/furszy/bitcoin-core/commits/5326821cbffbef388421af082d43c7bc6bcc48f7",
      "created_at": "2026-02-12T20:02:29Z"
    },
    {
      "event": "labeled",
      "id": 22746465878,
      "node_id": "LE_lADOABII587qd6NDzwAAAAVLy4ZW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22746465878",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T20:03:05Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3893112838,
      "node_id": "IC_kwDOABII587oDDAG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3893112838",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T20:03:19Z",
      "updated_at": "2026-02-12T20:03:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Task `No wallet`: https://github.com/bitcoin/bitcoin/actions/runs/21961944156/job/63441463470</sub>\n<sub>LLM reason (âœ¨ experimental): Compilation failed in fuzz/threadpool.cpp: Submit returns util::Expected<future<void>, string> which cannot be assigned to std::future<void>, causing build errors.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3893112838",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "commented",
      "id": 3893242863,
      "node_id": "IC_kwDOABII587oDivv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3893242863",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T20:31:52Z",
      "updated_at": "2026-02-12T20:31:52Z",
      "author_association": "CONTRIBUTOR",
      "body": "> The race can be reproduced as follows:\r\n\r\nCan this be made into a functional regression test?",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3893242863",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "commented",
      "id": 3893331956,
      "node_id": "IC_kwDOABII587oD4f0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3893331956",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T20:53:36Z",
      "updated_at": "2026-02-12T21:13:39Z",
      "author_association": "MEMBER",
      "body": "> Can this be made into a functional regression test?\r\n\r\nThe \"processing request is delayed\" step means manually placing a `sleep()` inside the libevent callback `http_request_cb()` to progress on the server shutdown concurrently. Then we need to `sleep()` during shutdown, just after `InterruptHTTPServer()`, to resume the request processing before shutdown occurs.\r\nSo, the short answer is no. Sadly races aren't easy to replicate deterministically in functional tests.\r\nWe will surely be able to exercise more scenarios like this one, in unit tests, after the new http server inclusion (libevent removal path), which will bring better encapsulation.\r\n\r\nThat being said, could provide a `sleep()`-based patch to replicate it locally.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3893331956",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "reviewed",
      "id": 3793381996,
      "node_id": "PRR_kwDOABII587iGmps",
      "url": null,
      "actor": null,
      "commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-12T21:01:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK 5326821cbffbef388421af082d43c7bc6bcc48f7",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3793381996",
      "submitted_at": "2026-02-12T21:01:32Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "unlabeled",
      "id": 22748279893,
      "node_id": "UNLE_lADOABII587qd6NDzwAAAAVL5zRV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22748279893",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T21:16:37Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22750337843,
      "node_id": "HRFPE_lADOABII587qd6NDzwAAAAVMBpsz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22750337843",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "d6aa40edd23cdd8f3b49cf82ca8a79553fde9c75",
      "commit_url": "https://api.github.com/repos/furszy/bitcoin-core/commits/d6aa40edd23cdd8f3b49cf82ca8a79553fde9c75",
      "created_at": "2026-02-12T22:56:51Z"
    },
    {
      "event": "commented",
      "id": 3893890603,
      "node_id": "IC_kwDOABII587oGA4r",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3893890603",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T23:06:59Z",
      "updated_at": "2026-02-12T23:06:59Z",
      "author_association": "MEMBER",
      "body": "Updated per feedback, thanks @hodlinator!",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3893890603",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "mentioned",
      "id": 22750534572,
      "node_id": "MEE_lADOABII587qd6NDzwAAAAVMCZus",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22750534572",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T23:07:00Z"
    },
    {
      "event": "subscribed",
      "id": 22750534594,
      "node_id": "SE_lADOABII587qd6NDzwAAAAVMCZvC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22750534594",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T23:07:00Z"
    },
    {
      "event": "milestoned",
      "id": 22759466804,
      "node_id": "MIE_lADOABII587qd6NDzwAAAAVMkec0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22759466804",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-13T08:34:24Z",
      "milestone": {
        "title": "31.0"
      }
    },
    {
      "event": "reviewed",
      "id": 3797580441,
      "node_id": "PRR_kwDOABII587iWnqZ",
      "url": null,
      "actor": null,
      "commit_id": "668eaa4ab4060d9f0f6c955679c95d9ea61499e0",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-13T14:25:55Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3797580441",
      "submitted_at": "2026-02-13T14:25:55Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22770059722,
      "node_id": "HRFPE_lADOABII587qd6NDzwAAAAVNM4nK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22770059722",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "commit_url": "https://api.github.com/repos/furszy/bitcoin-core/commits/b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "created_at": "2026-02-13T15:38:00Z"
    },
    {
      "event": "reviewed",
      "id": 3799391187,
      "node_id": "PRR_kwDOABII587idhvT",
      "url": null,
      "actor": null,
      "commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-13T20:55:52Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3799391187",
      "submitted_at": "2026-02-13T20:55:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "commented",
      "id": 3899427784,
      "node_id": "IC_kwDOABII587obIvI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3899427784",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-13T20:59:27Z",
      "updated_at": "2026-02-13T20:59:27Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for incorporating my earlier feedback btw!",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3899427784",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22778869985,
      "node_id": "HRFPE_lADOABII587qd6NDzwAAAAVNufjh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22778869985",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "542879da7b66e890d2c1bf668ab5680e939541f8",
      "commit_url": "https://api.github.com/repos/furszy/bitcoin-core/commits/542879da7b66e890d2c1bf668ab5680e939541f8",
      "created_at": "2026-02-13T21:29:34Z"
    },
    {
      "event": "commented",
      "id": 3902672521,
      "node_id": "IC_kwDOABII587ong6J",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3902672521",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-14T22:26:10Z",
      "updated_at": "2026-02-14T22:26:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "> That being said, could provide a sleep()-based patch to replicate it locally.\r\n\r\nHere is a diff, along with a functional test `rpc_http_shutdown_race.py`. Applying this to the base commit 07b924775e4ff5dbfb9f2e7549fd13db8ec5c61b will fail with a remote disconnected error, and applying to this patch 542879da7b66e890d2c1bf668ab5680e939541f8 will pass. \r\n\r\n```diff\r\ndiff --git a/src/httpserver.cpp b/src/httpserver.cpp\r\nindex 671e119642..d2de754183 100644\r\n--- a/src/httpserver.cpp\r\n+++ b/src/httpserver.cpp\r\n@@ -18,6 +18,7 @@\r\n #include <util/strencodings.h>\r\n #include <util/threadnames.h>\r\n #include <util/threadpool.h>\r\n+#include <util/time.h>\r\n #include <util/translation.h>\r\n \r\n #include <condition_variable>\r\n@@ -257,6 +258,7 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\r\n             hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Work queue depth exceeded\");\r\n             return;\r\n         }\r\n+        UninterruptibleSleep(2s);\r\n \r\n         auto item = [req = std::move(hreq), in_path = std::move(path), fn = i->handler]() {\r\n             std::string err_msg;\r\n@@ -446,6 +448,7 @@ void InterruptHTTPServer()\r\n     }\r\n     // Interrupt pool after disabling requests\r\n     g_threadpool_http.Interrupt();\r\n+    UninterruptibleSleep(2s);\r\n }\r\n \r\n void StopHTTPServer()\r\ndiff --git a/test/functional/rpc_http_shutdown_race.py b/test/functional/rpc_http_shutdown_race.py\r\nnew file mode 100755\r\nindex 0000000000..f91cdee9f3\r\n--- /dev/null\r\n+++ b/test/functional/rpc_http_shutdown_race.py\r\n@@ -0,0 +1,42 @@\r\n+#!/usr/bin/env python3\r\n+# Copyright (c) The Bitcoin Core developers\r\n+# Distributed under the MIT software license, see the accompanying\r\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\r\n+\"\"\"Test that an in-flight RPC during shutdown receives 503.\"\"\"\r\n+\r\n+from test_framework.test_framework import BitcoinTestFramework\r\n+from test_framework.util import assert_equal, str_to_b64str\r\n+\r\n+import http.client\r\n+import urllib.parse\r\n+\r\n+class RpcHttpShutdownRaceTest(BitcoinTestFramework):\r\n+    def set_test_params(self):\r\n+        self.num_nodes = 1\r\n+        self.setup_clean_chain = True\r\n+\r\n+    def run_test(self):\r\n+        url = urllib.parse.urlparse(self.nodes[0].url)\r\n+        authpair = f\"{url.username}:{url.password}\"\r\n+        headers = {\"Authorization\": f\"Basic {str_to_b64str(authpair)}\"}\r\n+\r\n+        conn = http.client.HTTPConnection(url.hostname, url.port, timeout=10)\r\n+        conn.connect()\r\n+        conn.request(\"POST\", \"/\", '{\"method\":\"getblockchaininfo\",\"id\":1}', headers)\r\n+\r\n+        # Trigger shutdown outside RPC callback path so the in-flight request\r\n+        # is interrupted before submitting to the pool.\r\n+        self.nodes[0].process.terminate()\r\n+\r\n+        resp = conn.getresponse()\r\n+        body = resp.read()\r\n+        assert_equal(resp.status, http.client.SERVICE_UNAVAILABLE)\r\n+        assert b\"Request rejected during server shutdown\" in body\r\n+        node = self.nodes[0]\r\n+        self.wait_until(lambda: node.process.poll() is not None, timeout=20)\r\n+        stderr = node.stderr.read().decode(\"utf-8\", errors=\"replace\").strip()\r\n+        node.is_node_stopped(expected_stderr=stderr, expected_ret_code=node.process.returncode)\r\n+\r\n+\r\n+if __name__ == '__main__':\r\n+    RpcHttpShutdownRaceTest(__file__).main()\r\ndiff --git a/test/functional/test_runner.py b/test/functional/test_runner.py\r\nindex cdfa8c1022..0d21907677 100755\r\n--- a/test/functional/test_runner.py\r\n+++ b/test/functional/test_runner.py\r\n@@ -201,6 +201,7 @@ BASE_SCRIPTS = [\r\n     'wallet_reindex.py',\r\n     'wallet_reorgsrestore.py',\r\n     'interface_http.py',\r\n+    'rpc_http_shutdown_race.py',\r\n     'interface_rpc.py',\r\n     'interface_usdt_coinselection.py',\r\n     'interface_usdt_mempool.py',\r\n```",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3902672521",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "reviewed",
      "id": 3805060506,
      "node_id": "PRR_kwDOABII587izJ2a",
      "url": null,
      "actor": null,
      "commit_id": "542879da7b66e890d2c1bf668ab5680e939541f8",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-15T15:11:24Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK 542879da7b66e890d2c1bf668ab5680e939541f8\n\nThis fixes the unclean shutdown race condition. It's too bad we can't have a regression test without adding sleeps.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3805060506",
      "submitted_at": "2026-02-15T15:11:24Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "review_requested",
      "id": 22805721212,
      "node_id": "RRE_lADOABII587qd6NDzwAAAAVPU7B8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22805721212",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-15T15:11:28Z",
      "requested_reviewer": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "commented",
      "id": 3904770678,
      "node_id": "IC_kwDOABII587ovhJ2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3904770678",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-15T16:29:52Z",
      "updated_at": "2026-02-15T16:29:52Z",
      "author_association": "MEMBER",
      "body": "Thanks for the reproduction patch @andrewtoth! Added link to the PR description.\r\n\r\n> This fixes the unclean shutdown race condition. It's too bad we can't have a regression test without adding sleeps.\r\n\r\nA small reflection about this.\r\n\r\nWe can't expect to be able to cover everything in functional tests. Simply because they live on a higher level and have no access to internals to exercise race conditions.\r\n\r\nThese types of scenarios belong to the unit tests land. But for that to happen, the surrounding code has to be properly encapsulated. Which is not the case for the http server, as there is currently no class for it, we basically import an entire file with global variables and static functions (and up to a few days ago, we had no tests for the work queue at all and this race condition was already there, just hidden returning an incorrect error message instead).\r\n\r\nThe only way to replicate scenarios like this one atm, on a unit test, would be to manually copy paste startup and shutdown. Which is not really scalable nor maintainable.\r\n\r\nStill, we will get better soon, the libevent removal path @pinheadmz is working on also brings better encapsulation that we can use to deeply cover the area.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3904770678",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "mentioned",
      "id": 22806457089,
      "node_id": "MEE_lADOABII587qd6NDzwAAAAVPXusB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22806457089",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-15T16:29:53Z"
    },
    {
      "event": "subscribed",
      "id": 22806457095,
      "node_id": "SE_lADOABII587qd6NDzwAAAAVPXusH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22806457095",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-15T16:29:53Z"
    },
    {
      "event": "mentioned",
      "id": 22806457108,
      "node_id": "MEE_lADOABII587qd6NDzwAAAAVPXusU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22806457108",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-15T16:29:53Z"
    },
    {
      "event": "subscribed",
      "id": 22806457115,
      "node_id": "SE_lADOABII587qd6NDzwAAAAVPXusb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22806457115",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-15T16:29:53Z"
    },
    {
      "event": "reviewed",
      "id": 3809321408,
      "node_id": "PRR_kwDOABII587jDaHA",
      "url": null,
      "actor": null,
      "commit_id": "542879da7b66e890d2c1bf668ab5680e939541f8",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-16T15:58:06Z",
      "author_association": "MEMBER",
      "body": "Concept ACK\r\n\r\n@furszy, it would be nice if you share a branch with a reproducer. \r\n\r\nedit: see https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3902672521 for reproducer",
      "user": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3809321408",
      "submitted_at": "2026-02-16T15:44:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22838946089,
      "node_id": "HRFPE_lADOABII587qd6NDzwAAAAVRTqkp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22838946089",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "c6a02a1a7c4440ae06a26e85623f5563f59b90c2",
      "commit_url": "https://api.github.com/repos/furszy/bitcoin-core/commits/c6a02a1a7c4440ae06a26e85623f5563f59b90c2",
      "created_at": "2026-02-17T00:53:20Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22839736132,
      "node_id": "HRFPE_lADOABII587qd6NDzwAAAAVRWrdE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22839736132",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "881568b39b686f0a418e02972c28c050c76de059",
      "commit_url": "https://api.github.com/repos/furszy/bitcoin-core/commits/881568b39b686f0a418e02972c28c050c76de059",
      "created_at": "2026-02-17T01:57:59Z"
    },
    {
      "event": "labeled",
      "id": 22840414515,
      "node_id": "LE_lADOABII587qd6NDzwAAAAVRZREz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22840414515",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-17T02:52:40Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3812447114,
      "node_id": "PRR_kwDOABII587jPVOK",
      "url": null,
      "actor": null,
      "commit_id": "881568b39b686f0a418e02972c28c050c76de059",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-17T11:36:36Z",
      "author_association": "CONTRIBUTOR",
      "body": "The CI MSan failure in p2p_private_broadcast.py[^1] possibly stems from the I2P network being unstable[^2].\n\n[^1]: https://github.com/bitcoin/bitcoin/actions/runs/22083305828/job/63812732359?pr=34577#step:11:3388\n[^2]: https://stacker.news/items/1434628",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3812447114",
      "submitted_at": "2026-02-17T11:36:36Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22857844813,
      "node_id": "HRFPE_lADOABII587qd6NDzwAAAAVSbwhN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22857844813",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "62042e8b9c376a7afaeb489cf8115727ecc52d9c",
      "commit_url": "https://api.github.com/repos/furszy/bitcoin-core/commits/62042e8b9c376a7afaeb489cf8115727ecc52d9c",
      "created_at": "2026-02-17T15:55:35Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDU5ZDI0YmQ1ZGQyYTQ1NDk4ODhjZjdjNTU3NDYxZTZiNDk1OWY4MmY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/59d24bd5dd2a4549888cf7c557461e6b4959f82f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/59d24bd5dd2a4549888cf7c557461e6b4959f82f",
      "tree": {
        "sha": "033861da88dca00485a134274e6a8b3f34918d74",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/033861da88dca00485a134274e6a8b3f34918d74"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 033861da88dca00485a134274e6a8b3f34918d74\nparent a7c29df0e5ace05b6186612671d6103c112ec922\nauthor furszy <matiasfurszyfer@protonmail.com> 1770923302 -0500\ncommitter furszy <matiasfurszyfer@protonmail.com> 1771358560 -0500\n\nthreadpool: make Submit return Expected instead of throwing\n\nUnlike exceptions, which can be ignored as they require extra try-catch\nblocks, returning expected errors forces callers to always handle\nsubmission failures.\n\nNot throwing an exception also fixes an unclean shutdown bug\n#34573 since we no longer throw when attempting to Submit()\nfrom the libevent callback http_request_cb().\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmmUyWAACgkQXdI8zGhq\npiMNwhAAs178ePwvU6EUbUH09SHI3T3hS5HDpbXj4wE8b1lA+XRNLITQQ6xwyFse\nVqdtOuqQtdszg3Pfy2Uk00LNid/4zxLdaFIgrSc9Vd95BbokPuRGq1qZ+gGmbtKR\nZ3Z5Tr+3KxsnFwFOkYI3rkmUuEBHAgM9/R4Wdam9yoFmJ8JsUBWdp7BUhfi6Guer\nEiVqiVaKyZUf7uI9UqRxziQkPuyuyBWaNPxOvSSjJpqz9w7CORnFrOgHKYOTc94p\nylgRD6XTRFznxq4gFcA+AI/sPvoez0acMI2OIFOrZVgqXvi9Ua//OT3ENcopruWT\nxvsVimV08HbJkD8hl+ubvd8gKRDQesoEMpMhlpSxXA5YzWoKw48fkZ1YVvx1sbTJ\nqIONpXUhPUYaKhyJyfpJOGqMvYWe2v1E9rSuwF+Apowo3TnPeQsRV7+HxBI+2gQE\nWRTKPEDywtJlr4Nw8APdsvnkf1bWrQPv/JlBE1dH8dCOfD35p1CjH7c8/+FCn2Nm\nFpSqrm+4ERwWJItbsLFR1XjbPZQCxCscK04QTqr1d3iulMH2It+DxOOQrRvr8wJJ\ntcG0SMqssmurqCjJirD0cf4Gr4AdnLSygetWH35RBjl+gJBQ5Tc8zQGB1BC6An13\nm0vW5JTNSnY2wOPTpcOFAAP/ww+QlgWjFEn/RVFksD4gzrS8JCs=\n=Ly/a\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a7c29df0e5ace05b6186612671d6103c112ec922",
          "sha": "a7c29df0e5ace05b6186612671d6103c112ec922",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a7c29df0e5ace05b6186612671d6103c112ec922"
        }
      ],
      "message": "threadpool: make Submit return Expected instead of throwing\n\nUnlike exceptions, which can be ignored as they require extra try-catch\nblocks, returning expected errors forces callers to always handle\nsubmission failures.\n\nNot throwing an exception also fixes an unclean shutdown bug\n#34573 since we no longer throw when attempting to Submit()\nfrom the libevent callback http_request_cb().",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2026-02-17T20:02:40Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2026-02-12T19:08:22Z"
      },
      "sha": "59d24bd5dd2a4549888cf7c557461e6b4959f82f"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22863848564,
      "node_id": "HRFPE_lADOABII587qd6NDzwAAAAVSyqR0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22863848564",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "9d45a1b1bbccf21aa7750f5741af4d6edfd3dc48",
      "commit_url": "https://api.github.com/repos/furszy/bitcoin-core/commits/9d45a1b1bbccf21aa7750f5741af4d6edfd3dc48",
      "created_at": "2026-02-17T20:04:09Z"
    },
    {
      "event": "commented",
      "id": 3916825842,
      "node_id": "IC_kwDOABII587pdgTy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3916825842",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-17T20:05:12Z",
      "updated_at": "2026-02-17T20:05:12Z",
      "author_association": "MEMBER",
      "body": "rebased to get latest CI changes.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3916825842",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "unlabeled",
      "id": 22865253248,
      "node_id": "UNLE_lADOABII587qd6NDzwAAAAVS4BOA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22865253248",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-17T21:05:03Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3821353750,
      "node_id": "PRR_kwDOABII587jxTsW",
      "url": null,
      "actor": null,
      "commit_id": "9d45a1b1bbccf21aa7750f5741af4d6edfd3dc48",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-18T18:16:06Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK 9d45a1b1bbccf21aa7750f5741af4d6edfd3dc48",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3821353750",
      "submitted_at": "2026-02-18T18:16:06Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "review_requested",
      "id": 22892532003,
      "node_id": "RRE_lADOABII587qd6NDzwAAAAVUgFEj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22892532003",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-18T18:16:12Z",
      "requested_reviewer": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 22892532480,
      "node_id": "RRE_lADOABII587qd6NDzwAAAAVUgFMA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22892532480",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-18T18:16:13Z",
      "requested_reviewer": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 3821574252,
      "node_id": "PRR_kwDOABII587jyJhs",
      "url": null,
      "actor": null,
      "commit_id": "9d45a1b1bbccf21aa7750f5741af4d6edfd3dc48",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-18T18:36:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK 9d45a1b1bbccf21aa7750f5741af4d6edfd3dc48",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3821574252",
      "submitted_at": "2026-02-18T18:36:26Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "reviewed",
      "id": 3822255955,
      "node_id": "PRR_kwDOABII587j0v9T",
      "url": null,
      "actor": null,
      "commit_id": "379a9201b1aabffe5f19dbabf1fe4fd57e8fefba",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-18T21:09:45Z",
      "author_association": "MEMBER",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3822255955",
      "submitted_at": "2026-02-18T21:09:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDcyNmIzNjYzY2M4ZTIxNjRkNGU5NDUyZjEyZjU4NjZmNWU4ZjZmMWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "tree": {
        "sha": "5078db3658f847aecf1c4ef2baf437ed2415f2b9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5078db3658f847aecf1c4ef2baf437ed2415f2b9"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 5078db3658f847aecf1c4ef2baf437ed2415f2b9\nparent 59d24bd5dd2a4549888cf7c557461e6b4959f82f\nauthor furszy <matiasfurszyfer@protonmail.com> 1770923302 -0500\ncommitter furszy <matiasfurszyfer@protonmail.com> 1771452447 -0500\n\nhttp: properly respond to HTTP request during shutdown\n\nMakes sure we respond to the client as the HTTP request attempts to submit a task to\nthe thread pool during server shutdown.\n\nRoughly what happens:\n\n1) The server receives an HTTP request and starts calling http_request_cb().\n2) Meanwhile on another thread, shutdown is triggered which calls InterruptHTTPServer()\n   and unregisters libevent http_request_cb() callback and interrupts the thread pool.\n3) The request (step 1) resumes and tries to submit a task to the now-interrupted server.\n\nThis fix detects failed submissions immediately, and the server responds with\nHTTP_SERVICE_UNAVAILABLE.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmmWOB8ACgkQXdI8zGhq\npiNCUA//cjEQoh1Xmu+ZhTMAHb7JmhS2r/H0I/Yyp4sQP0U8Zmz3HOYB/m+y+CdE\nGLowh1vnPtYt37F+XKVoTPYhiXiwEvrwIreLpwlINeRDnGcLRtpKPC/Ojy2EfffO\noU0KROzdymIxcEe+abtjfFcvrb9Ci/6xqqQT76yFw9J04IOZDr7nl1hTXLp+L5Qq\nE/voYGCrnXpfRuOJ2nNPRusnTBnKpFVGyYGECCC5k9uKf7K2GZmaCHHj8KtaMte9\nzsVWECSQpg/3qCLN612lEJZ2FsccLhAjUr661bx+24m5dBFyg+jxFXxFp3UIpnXC\nxDBxaQauErV5cbaqqXxE1bAtVyIy/YfJetUqW1Gv9d9W8hCaZ9nclc5uH28aqLJG\n2DCpHGkOuDiM3IhkXYX0fOtVX82Qtd9Flxg0n3n9hZpQsmhbhWnrIhxvu6KA84SG\n5GYNyHM9At5jipTxy3SjG4ARAFpq8DW/JxYoxqX8dmtf7nKufzXP9V0ecI9r1abx\nnLR/2DvLx0tpRyPAi0ZsvQKO5qZLN92qaRc87am4gliqT2jvexSLYlS7mmo8twdD\naQQ1792GZcFXKtu0EsYR12/73P0OTrlVAiom44KyEMrvxuEYRbY9j4WfPxSCxSI7\nCZfCeqDK6Hk2zwCG354ECyOOZjeS7dkttQhDnPc894jT5N7cf+U=\n=81xG\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/59d24bd5dd2a4549888cf7c557461e6b4959f82f",
          "sha": "59d24bd5dd2a4549888cf7c557461e6b4959f82f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/59d24bd5dd2a4549888cf7c557461e6b4959f82f"
        }
      ],
      "message": "http: properly respond to HTTP request during shutdown\n\nMakes sure we respond to the client as the HTTP request attempts to submit a task to\nthe thread pool during server shutdown.\n\nRoughly what happens:\n\n1) The server receives an HTTP request and starts calling http_request_cb().\n2) Meanwhile on another thread, shutdown is triggered which calls InterruptHTTPServer()\n   and unregisters libevent http_request_cb() callback and interrupts the thread pool.\n3) The request (step 1) resumes and tries to submit a task to the now-interrupted server.\n\nThis fix detects failed submissions immediately, and the server responds with\nHTTP_SERVICE_UNAVAILABLE.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2026-02-18T22:07:27Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2026-02-12T19:08:22Z"
      },
      "sha": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22897862174,
      "node_id": "HRFPE_lADOABII587qd6NDzwAAAAVU0aYe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22897862174",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "a6fc8a43f3f5b7605ebcd24212e01524c86a9189",
      "commit_url": "https://api.github.com/repos/furszy/bitcoin-core/commits/a6fc8a43f3f5b7605ebcd24212e01524c86a9189",
      "created_at": "2026-02-18T22:11:31Z"
    },
    {
      "event": "commented",
      "id": 3923495127,
      "node_id": "IC_kwDOABII587p28jX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3923495127",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-18T22:15:34Z",
      "updated_at": "2026-02-18T22:15:34Z",
      "author_association": "MEMBER",
      "body": "Updated per @pinheadmz feedback, thanks.\r\nOnly added a `shared_pointer.use_count() == 1` check to be completely sure the request is destroyed upon submission failure.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3923495127",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "mentioned",
      "id": 22897937849,
      "node_id": "MEE_lADOABII587qd6NDzwAAAAVU0s25",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22897937849",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-18T22:15:36Z"
    },
    {
      "event": "subscribed",
      "id": 22897937871,
      "node_id": "SE_lADOABII587qd6NDzwAAAAVU0s3P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22897937871",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-18T22:15:36Z"
    },
    {
      "event": "reviewed",
      "id": 3824639287,
      "node_id": "PRR_kwDOABII587j9103",
      "url": null,
      "actor": null,
      "commit_id": "a6fc8a43f3f5b7605ebcd24212e01524c86a9189",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-19T10:00:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "Tested ACK https://github.com/bitcoin/bitcoin/pull/34577/commits/a6fc8a43f3f5b7605ebcd24212e01524c86a9189\r\n\r\nConfirmed using diff from https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3902672521\r\n",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3824639287",
      "submitted_at": "2026-02-19T10:00:57Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "review_requested",
      "id": 22910079849,
      "node_id": "RRE_lADOABII587qd6NDzwAAAAVVjBNp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22910079849",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-19T10:01:04Z",
      "requested_reviewer": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 22910081255,
      "node_id": "RRE_lADOABII587qd6NDzwAAAAVVjBjn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22910081255",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-19T10:01:05Z",
      "requested_reviewer": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 3824655844,
      "node_id": "PRR_kwDOABII587j953k",
      "url": null,
      "actor": null,
      "commit_id": "a6fc8a43f3f5b7605ebcd24212e01524c86a9189",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-19T10:03:14Z",
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK a6fc8a43f3f5b7605ebcd24212e01524c86a9189",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3824655844",
      "submitted_at": "2026-02-19T10:03:14Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "commented",
      "id": 3926178817,
      "node_id": "IC_kwDOABII587qBLwB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3926178817",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-19T10:13:29Z",
      "updated_at": "2026-02-19T10:13:29Z",
      "author_association": "MEMBER",
      "body": "@dergoegge does this resolve #34573 for you?",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3926178817",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "mentioned",
      "id": 22910510445,
      "node_id": "MEE_lADOABII587qd6NDzwAAAAVVkqVt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22910510445",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-19T10:13:30Z"
    },
    {
      "event": "subscribed",
      "id": 22910510521,
      "node_id": "SE_lADOABII587qd6NDzwAAAAVVkqW5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22910510521",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-19T10:13:30Z"
    },
    {
      "event": "reviewed",
      "id": 3825509836,
      "node_id": "PRR_kwDOABII587kBKXM",
      "url": null,
      "actor": null,
      "commit_id": "a6fc8a43f3f5b7605ebcd24212e01524c86a9189",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-19T12:19:44Z",
      "author_association": "MEMBER",
      "body": "ACK a6fc8a43f3f5b7605ebcd24212e01524c86a9189\n\nBuilt and tested on arm64/macos. Reviewed each commit, gave feedback which was addressed. I compared the results of the suggested functional test against modified code between master and branch, ran the test without the modified code between master and branch, and observed all those trials with Wireshark to confirm that the PR improves HTTP server behavior during shutdown.\n\n<details><summary>Show Signature</summary>\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA256\n\nACK a6fc8a43f3f5b7605ebcd24212e01524c86a9189\n-----BEGIN PGP SIGNATURE-----\n\niQIzBAEBCAAdFiEE5hdzzW4BBA4vG9eM5+KYS2KJyToFAmmW/0sACgkQ5+KYS2KJ\nyTomKxAAhc0LeceulNUcjufbNhrpCSGYCK3n+5BrLLKObfQbngO1OnOW3wOEVBjt\nRwwpJpwa7nIX2U9YoLWDEJKb5HmdozJZAIWHRuuX2qALOkEr/oguBYZEtan72DDq\ncvtm+d6jncur1FnieRTDIdj8/YFkJPIv4dtGyxuy7f3VF0cODuk2fE7oZ+NIQdzN\nrMcgI4757HIltYxJRuTVAt7KtvfZuMye/6UufBOcjz159vM+uUi6ORGORzf6EUk9\nN3ZF+6DWrQrRjWi0k195t9i0TVDlF/eND2DZmEkK5Jrt+ZjcTMoUaQ3Wj2WoRRfd\nXQ5CL9jzw0g8v6LMdYaVmAOfJbIzoF1H9NMWx1a7dwTkaABClXvm0QjB8N14kbhZ\nS3inDNJ0hTfyoEeXyHk+Ui+TMj1TutFq1kLvN5TUT+lDE/e/rybL9cKNQvl8NrEk\nCtD2mIXLf0vJynpo/hOEO4IP6WzUJjl/6gyrhJ3Dli6xLUznNsPnFB0YgNd2+tPk\n0xr/SQ0DTn5GVzOkw9E5jkvDjoVKRbV1sZaw039cBL3ika7ckvt3pEumKj+zZ+IK\nIVZ/mXSrfCVKxy3WfY9eQjgjp0A5gogpTQR/MHq1TQ3Pa0v0Qn18bdw0mvm32R8f\nDXw8cVQj0JZEP2XiOxD3G2v6rtYK+vnnFQUpxhgcbNSND/8Fpg8=\n=Q/ll\n-----END PGP SIGNATURE-----\n```\n\npinheadmz's public key is [on openpgp.org](https://keys.openpgp.org/vks/v1/by-fingerprint/E61773CD6E01040E2F1BD78CE7E2984B6289C93A)\n</details>\n",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3825509836",
      "submitted_at": "2026-02-19T12:19:44Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "reviewed",
      "id": 3825895791,
      "node_id": "PRR_kwDOABII587kColv",
      "url": null,
      "actor": null,
      "commit_id": "a6fc8a43f3f5b7605ebcd24212e01524c86a9189",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-19T13:21:50Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "sedited",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sedited",
        "html_url": "https://github.com/sedited",
        "followers_url": "https://api.github.com/users/sedited/followers",
        "following_url": "https://api.github.com/users/sedited/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sedited/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sedited/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sedited/subscriptions",
        "organizations_url": "https://api.github.com/users/sedited/orgs",
        "repos_url": "https://api.github.com/users/sedited/repos",
        "events_url": "https://api.github.com/users/sedited/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sedited/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3825895791",
      "submitted_at": "2026-02-19T13:21:49Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22921864849,
      "node_id": "HRFPE_lADOABII587qd6NDzwAAAAVWP-aR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22921864849",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "commit_url": "https://api.github.com/repos/furszy/bitcoin-core/commits/726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "created_at": "2026-02-19T16:41:26Z"
    },
    {
      "event": "commented",
      "id": 3928481231,
      "node_id": "IC_kwDOABII587qJ93P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3928481231",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-19T16:49:49Z",
      "updated_at": "2026-02-19T16:50:49Z",
      "author_association": "MEMBER",
      "body": "Due to the upcoming release freeze, decided to drop the last commit https://github.com/bitcoin/bitcoin/commit/a6fc8a43f3f5b7605ebcd24212e01524c86a9189 to keep this PR focused strictly on fixing the race.\r\n\r\nThat commit was a design improvement rather than a direct fix, so it makes sense to handle it separately. We can reintroduce it in a follow-up once we align on the overall design direction https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2828661015 (if possible).\r\n\r\nPR ready to go.\r\n",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3928481231",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "reviewed",
      "id": 3827194832,
      "node_id": "PRR_kwDOABII587kHlvQ",
      "url": null,
      "actor": null,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-19T17:05:14Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK 726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "user": {
        "login": "sedited",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sedited",
        "html_url": "https://github.com/sedited",
        "followers_url": "https://api.github.com/users/sedited/followers",
        "following_url": "https://api.github.com/users/sedited/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sedited/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sedited/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sedited/subscriptions",
        "organizations_url": "https://api.github.com/users/sedited/orgs",
        "repos_url": "https://api.github.com/users/sedited/repos",
        "events_url": "https://api.github.com/users/sedited/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sedited/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3827194832",
      "submitted_at": "2026-02-19T17:05:14Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "review_requested",
      "id": 22922523258,
      "node_id": "RRE_lADOABII587qd6NDzwAAAAVWSfJ6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22922523258",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-19T17:05:21Z",
      "requested_reviewer": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 22922523892,
      "node_id": "RRE_lADOABII587qd6NDzwAAAAVWSfT0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22922523892",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-19T17:05:22Z",
      "requested_reviewer": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 22922524675,
      "node_id": "RRE_lADOABII587qd6NDzwAAAAVWSfgD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22922524675",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-19T17:05:23Z",
      "requested_reviewer": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 3827498505,
      "node_id": "PRR_kwDOABII587kIv4J",
      "url": null,
      "actor": null,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-19T17:49:05Z",
      "author_association": "MEMBER",
      "body": "re-ACK 726b3663cc8e2164d4e9452f12f5866f5e8f6f1a\n\nChange since last review, dropped tip commit which doesn't affect the bug fix targeting by the rest of the branch.\n\n<details><summary>Show Signature</summary>\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA256\n\nACK 726b3663cc8e2164d4e9452f12f5866f5e8f6f1a\n-----BEGIN PGP SIGNATURE-----\n\niQIzBAEBCAAdFiEE5hdzzW4BBA4vG9eM5+KYS2KJyToFAmmXTMUACgkQ5+KYS2KJ\nyTrnag/+IVOKcTiwVPKY0LS+i96t8qwCDeBCYH22b7pzwdDbQ8Bmnhg42Bz5kSQq\nXuGPXt4sAn0MjGiC7EpAIErA+yhT/nrf1QuOyJslSUz+6BnO491trzZAdPJ9cnyF\n13x4AY2mYs/fLFCfKVk7QhW5U+0XfgqcVD/BNsPtmBfcA6ClXUmFatBL3Mb+P1Y8\nH26shtJUz3If+HAM6d5Iey/IoMgS6ENgaLr+4weMRej6JYpNfU2cC4+G9vs/WgRL\n+W2K+Fs+Ose2lMLwg+Py6m7vmtrrb1PzuYYGw2B07qsHOP9aGGN+SLDEVs/tEMeY\nYUVY0vWnplCG0NMo+VQoMa4xchaMNVpLN1Haa4nwBDWOxSn64t3a9E/EFh+9X3Z/\nfLppj+2KrUqCeJ6eN/bJB2sAutq+oZSMFwgybqArPQ9KSMSoNAwoUYySphMmeEkW\nJC6NcCTNkI1ZzVrZChizJPYLoGVF7YKWnlo2lLR74/l99+auKQAmTxBIl5hlctoB\n4Fv3tgqS+iKrPe9g1mrgGRInhCwsvXVU9tZtgXChzQGuecfQYaESmWVJ1RvqzbQx\nfUSbShCOT7iYs7OK+7j5BwPyIBgRoDEf9A9fJ8+/QlYSkQRnTMqux90AtdWXKm/V\nPde7ojKRmACJsuC2hLnE/Ympa63+EwSBf1xZXiLKNtCauVlQCpo=\n=TWiX\n-----END PGP SIGNATURE-----\n```\n\npinheadmz's public key is [on openpgp.org](https://keys.openpgp.org/vks/v1/by-fingerprint/E61773CD6E01040E2F1BD78CE7E2984B6289C93A)\n</details>\n",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3827498505",
      "submitted_at": "2026-02-19T17:49:05Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "reviewed",
      "id": 3827663956,
      "node_id": "PRR_kwDOABII587kJYRU",
      "url": null,
      "actor": null,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-19T18:18:24Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK 726b3663cc8e2164d4e9452f12f5866f5e8f6f1a\n",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3827663956",
      "submitted_at": "2026-02-19T18:18:24Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "commented",
      "id": 3929502437,
      "node_id": "IC_kwDOABII587qN3Ll",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3929502437",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-19T19:39:21Z",
      "updated_at": "2026-02-19T19:39:21Z",
      "author_association": "MEMBER",
      "body": "ACK 726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3929502437",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "reviewed",
      "id": 3828179137,
      "node_id": "PRR_kwDOABII587kLWDB",
      "url": null,
      "actor": null,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-19T19:52:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#pullrequestreview-3828179137",
      "submitted_at": "2026-02-19T19:52:37Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
    },
    {
      "event": "merged",
      "id": 22928538289,
      "node_id": "ME_lADOABII587qd6NDzwAAAAVWpbqx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22928538289",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "02c83fef84315ef227b1ec4a31fd558cecd3699c",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/02c83fef84315ef227b1ec4a31fd558cecd3699c",
      "created_at": "2026-02-19T20:41:24Z"
    },
    {
      "event": "closed",
      "id": 22928538350,
      "node_id": "CE_lADOABII587qd6NDzwAAAAVWpbru",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22928538350",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-19T20:41:24Z"
    },
    {
      "event": "head_ref_deleted",
      "id": 22928769233,
      "node_id": "HRDE_lADOABII587qd6NDzwAAAAVWqUDR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22928769233",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-19T20:49:27Z"
    },
    {
      "event": "commented",
      "id": 3933135742,
      "node_id": "IC_kwDOABII587qbuN-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3933135742",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-20T11:05:13Z",
      "updated_at": "2026-02-20T11:05:13Z",
      "author_association": "MEMBER",
      "body": "> does this resolve https://github.com/bitcoin/bitcoin/issues/34573 for you?\r\n\r\nI did re-run the test that found this new crash issue yesterday and it looks like it's fixed.\r\n\r\nFuzzing/property-based tests take some time to run. If I get pinged to re-test something it'd make sense to wait for me to follow up before merge. Otherwise I'll likely stop responding to these pings and will open a new issue if something wasn't fixed.",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3933135742",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "commented",
      "id": 3933658898,
      "node_id": "IC_kwDOABII587qdt8S",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3933658898",
      "actor": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-20T12:00:27Z",
      "updated_at": "2026-02-20T12:00:27Z",
      "author_association": "MEMBER",
      "body": "> Fuzzing/property-based tests take some time to run. If I get pinged to re-test something it'd make sense to wait for me to follow up before merge. Otherwise I'll likely stop responding to these pings and will open a new issue if something wasn't fixed.\r\n\r\nMaybe it would be helpful to let the maintainers/contributors know you're looking into it/ i.e re-running tests after getting pinged, so they know whether to wait or move forward?\r\nIf an issue wasn't fixed after a fix is merged and resolved, opening a new issue seems fair.",
      "user": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3933658898",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    },
    {
      "event": "commented",
      "id": 3933853616,
      "node_id": "IC_kwDOABII587qedew",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3933853616",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-20T12:18:55Z",
      "updated_at": "2026-02-20T12:18:55Z",
      "author_association": "MEMBER",
      "body": "In this case at least one maintainer knew, but in general they can expect me to follow up and if it's urgent they can also ping me elsewhere.",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#issuecomment-3933853616",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34577"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2800844092",
      "pull_request_review_id": 3793381996,
      "id": 2800844092,
      "node_id": "PRRC_kwDOABII586m8X08",
      "diff_hunk": "@@ -44,6 +44,13 @@ BOOST_FIXTURE_TEST_SUITE(threadpool_tests, ThreadPoolFixture)\n         }                                                                         \\\n     } while (0)\n \n+// Helper to unwrap a valid pool submission\n+template <typename F> [[nodiscard]]\n+auto Submit(ThreadPool& pool, F&& fn)",
      "path": "src/test/threadpool_tests.cpp",
      "position": 1,
      "original_position": 6,
      "commit_id": "0b2d12f83c96ac9f838412f1ea6634f5eea66d4e",
      "original_commit_id": "0b2d12f83c96ac9f838412f1ea6634f5eea66d4e",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Nice helper! Was actually experimenting with changing `ThreadPool::Submit()` to return `util::Expected` yesterday (suffering from lack of knowledge of `std::invoke_result_t<F>` though). It was *so* cumbersome to adapt these test without realizing a helper would be useful. :)\r\n \r\nnit: The going style seems to be `[[nodiscard]]` on the same line as the return type:\r\n\r\n```C++\r\ntemplate <typename F>\r\n[[nodiscard]] auto Submit(ThreadPool& pool, F&& fn)\r\n```\r\n\r\nExamples from master:\r\nhttps://github.com/bitcoin/bitcoin/blob/07b924775e4ff5dbfb9f2e7549fd13db8ec5c61b/src/util/overflow.h#L14-L15\r\nhttps://github.com/bitcoin/bitcoin/blob/07b924775e4ff5dbfb9f2e7549fd13db8ec5c61b/src/test/fuzz/util.h#L84-L85\r\n\r\nSame style nit goes for `ThreadPool::Submit()`.\r\n",
      "created_at": "2026-02-12T20:09:07Z",
      "updated_at": "2026-02-12T21:01:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2800844092",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2800844092"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": 48,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 49,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2800886683",
      "pull_request_review_id": 3793381996,
      "id": 2800886683,
      "node_id": "PRRC_kwDOABII586m8iOb",
      "diff_hunk": "@@ -151,20 +153,20 @@ class ThreadPool\n      * Note: Ignoring the returned future requires guarding the task against\n      * uncaught exceptions, as they would otherwise be silently discarded.\n      */\n-    template <class F> [[nodiscard]] EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n-    auto Submit(F&& fn)\n+    template <class F> [[nodiscard]]\n+    util::Expected<std::future<std::invoke_result_t<F>>, std::string> Submit(F&& fn) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n     {\n-        std::packaged_task task{std::forward<F>(fn)};\n+        std::packaged_task<std::invoke_result_t<F>()> task{std::forward<F>(fn)};\n         auto future{task.get_future()};\n         {\n             LOCK(m_mutex);\n             if (m_interrupt || m_workers.empty()) {\n-                throw std::runtime_error(\"No active workers; cannot accept new tasks\");\n+                return util::Unexpected<std::string>(\"No active workers; cannot accept new tasks\");\n             }\n             m_work_queue.emplace(std::move(task));\n         }\n         m_cv.notify_one();\n-        return future;\n+        return util::Expected<decltype(future), std::string>(std::move(future));",
      "path": "src/util/threadpool.h",
      "position": 1,
      "original_position": 38,
      "commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "original_commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: Can replace with:\n```C++\n        return {std::move(future)};\n```",
      "created_at": "2026-02-12T20:19:50Z",
      "updated_at": "2026-02-12T21:01:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2800886683",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2800886683"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": 167,
      "start_side": "LEFT",
      "line": null,
      "original_line": 169,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2800890119",
      "pull_request_review_id": 3793381996,
      "id": 2800890119,
      "node_id": "PRRC_kwDOABII586m8jEH",
      "diff_hunk": "@@ -151,20 +153,20 @@ class ThreadPool\n      * Note: Ignoring the returned future requires guarding the task against\n      * uncaught exceptions, as they would otherwise be silently discarded.\n      */\n-    template <class F> [[nodiscard]] EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n-    auto Submit(F&& fn)\n+    template <class F> [[nodiscard]]\n+    util::Expected<std::future<std::invoke_result_t<F>>, std::string> Submit(F&& fn) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n     {\n-        std::packaged_task task{std::forward<F>(fn)};\n+        std::packaged_task<std::invoke_result_t<F>()> task{std::forward<F>(fn)};\n         auto future{task.get_future()};\n         {\n             LOCK(m_mutex);\n             if (m_interrupt || m_workers.empty()) {\n-                throw std::runtime_error(\"No active workers; cannot accept new tasks\");\n+                return util::Unexpected<std::string>(\"No active workers; cannot accept new tasks\");",
      "path": "src/util/threadpool.h",
      "position": 1,
      "original_position": 32,
      "commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "original_commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: No need to specify `Unexpected` template arg:\r\n ```suggestion\r\n                 return util::Unexpected{\"No active workers; cannot accept new tasks\"};\r\n```",
      "created_at": "2026-02-12T20:20:40Z",
      "updated_at": "2026-02-12T21:01:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2800890119",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2800890119"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 164,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2800913416",
      "pull_request_review_id": 3793381996,
      "id": 2800913416,
      "node_id": "PRRC_kwDOABII586m8owI",
      "diff_hunk": "@@ -276,7 +276,12 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }\n+",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 28,
      "commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "original_commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "meganit: Superfluous newline after `if`-block before end of outer block.\n\n```suggestion\n```",
      "created_at": "2026-02-12T20:26:58Z",
      "updated_at": "2026-02-12T21:01:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2800913416",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2800913416"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 284,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2800934226",
      "pull_request_review_id": 3793381996,
      "id": 2800934226,
      "node_id": "PRRC_kwDOABII586m8t1S",
      "diff_hunk": "@@ -211,7 +211,7 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             }\n         }\n     }\n-    auto hreq{std::make_unique<HTTPRequest>(req, *static_cast<const util::SignalInterrupt*>(arg))};\n+    auto hreq{std::make_shared<HTTPRequest>(req, *static_cast<const util::SignalInterrupt*>(arg))};",
      "path": "src/httpserver.cpp",
      "position": 5,
      "original_position": 5,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "remark: Was experimenting with having `ThreadPool::Submit()` take a \"task_creator\" lambda that only gets called when no error condition in `Submit` occurs, it would then return the inner lambda which would take ownership of the `unique_ptr` as on master. Even though I have a distaste for `shared_ptr`, your version is more elegant.",
      "created_at": "2026-02-12T20:32:36Z",
      "updated_at": "2026-02-12T21:01:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2800934226",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2800934226"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 214,
      "original_line": 214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801004334",
      "pull_request_review_id": 3793381996,
      "id": 2801004334,
      "node_id": "PRRC_kwDOABII586m8-8u",
      "diff_hunk": "",
      "path": "src/test/fuzz/threadpool.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "241367d021d210f25e427e7bb35c676b293ff28a",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Commit message suggestion for 241367d021d210f25e427e7bb35c676b293ff28a:\r\n```diff\r\nthreadpool: make Submit return Expected instead of throwing\r\n\r\nUnlike exceptions, which can be ignored as they require extra try-catch\r\nblocks, returning expected errors forces callers to always handle\r\nsubmission failures.\r\n\r\n+ Not throwing an exception also happens to fix unclean shutdown bug\r\n+ #34573 since we no longer throw when attempting to Submit() from http_request_cb().\r\n```",
      "created_at": "2026-02-12T20:51:06Z",
      "updated_at": "2026-02-12T21:02:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2801004334",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801004334"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801017120",
      "pull_request_review_id": 3793381996,
      "id": 2801017120,
      "node_id": "PRRC_kwDOABII586m9CEg",
      "diff_hunk": "",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Commit message suggestion for 5326821cbffbef388421af082d43c7bc6bcc48f7:\r\n\r\nGiven that I think the unclean shutdown is already fixed in the first commit by using `util::Expected` instead of throwing exceptions, I think this is somewhat more correct for the second:\r\n```\r\nhttp: properly respond to HTTP request during shutdown\r\n\r\nMakes sure we respond to the client as the HTTP request attempts to submit a task to\r\nthe threadpool during server shutdown.\r\n\r\nRoughly what happens:\r\n\r\n1) The server receives an HTTP request and starts calling http_request_cb().\r\n2) Meanwhile on another thread, shutdown is triggered which calls InterruptHTTPServer()\r\n   and unregisters http_request_cb() and interrupts the thread pool.\r\n3) The request (step 1) resumes and tries to submit a task\r\n   to the now-interrupted server.\r\n\r\nThis fix detects failed submissions immediately, and the server\r\nresponds with HTTP_SERVICE_UNAVAILABLE.\r\n```\r\nI don't think it's necessary to classify this as a race condition. I guess it depends on how you define it.",
      "created_at": "2026-02-12T20:54:37Z",
      "updated_at": "2026-02-12T21:02:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2801017120",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801017120"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801459421",
      "pull_request_review_id": 3794149447,
      "id": 2801459421,
      "node_id": "PRRC_kwDOABII586m-uDd",
      "diff_hunk": "@@ -44,6 +44,13 @@ BOOST_FIXTURE_TEST_SUITE(threadpool_tests, ThreadPoolFixture)\n         }                                                                         \\\n     } while (0)\n \n+// Helper to unwrap a valid pool submission\n+template <typename F> [[nodiscard]]\n+auto Submit(ThreadPool& pool, F&& fn)",
      "path": "src/test/threadpool_tests.cpp",
      "position": 1,
      "original_position": 6,
      "commit_id": "0b2d12f83c96ac9f838412f1ea6634f5eea66d4e",
      "original_commit_id": "0b2d12f83c96ac9f838412f1ea6634f5eea66d4e",
      "in_reply_to_id": 2800844092,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done as suggested. [[nodiscard]] inlined.\r\nAlso, credits to ryanofsky for the helper function idea <3. I was about to use a macro.",
      "created_at": "2026-02-12T23:01:45Z",
      "updated_at": "2026-02-12T23:01:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2801459421",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801459421"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": 48,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 49,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801460139",
      "pull_request_review_id": 3794150427,
      "id": 2801460139,
      "node_id": "PRRC_kwDOABII586m-uOr",
      "diff_hunk": "@@ -151,20 +153,20 @@ class ThreadPool\n      * Note: Ignoring the returned future requires guarding the task against\n      * uncaught exceptions, as they would otherwise be silently discarded.\n      */\n-    template <class F> [[nodiscard]] EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n-    auto Submit(F&& fn)\n+    template <class F> [[nodiscard]]\n+    util::Expected<std::future<std::invoke_result_t<F>>, std::string> Submit(F&& fn) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n     {\n-        std::packaged_task task{std::forward<F>(fn)};\n+        std::packaged_task<std::invoke_result_t<F>()> task{std::forward<F>(fn)};\n         auto future{task.get_future()};\n         {\n             LOCK(m_mutex);\n             if (m_interrupt || m_workers.empty()) {\n-                throw std::runtime_error(\"No active workers; cannot accept new tasks\");\n+                return util::Unexpected<std::string>(\"No active workers; cannot accept new tasks\");\n             }\n             m_work_queue.emplace(std::move(task));\n         }\n         m_cv.notify_one();\n-        return future;\n+        return util::Expected<decltype(future), std::string>(std::move(future));",
      "path": "src/util/threadpool.h",
      "position": 1,
      "original_position": 38,
      "commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "original_commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "in_reply_to_id": 2800886683,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Cool. Done as suggested. Thanks.",
      "created_at": "2026-02-12T23:02:00Z",
      "updated_at": "2026-02-12T23:02:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2801460139",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801460139"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": 167,
      "start_side": "LEFT",
      "line": null,
      "original_line": 169,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801460424",
      "pull_request_review_id": 3794150790,
      "id": 2801460424,
      "node_id": "PRRC_kwDOABII586m-uTI",
      "diff_hunk": "@@ -151,20 +153,20 @@ class ThreadPool\n      * Note: Ignoring the returned future requires guarding the task against\n      * uncaught exceptions, as they would otherwise be silently discarded.\n      */\n-    template <class F> [[nodiscard]] EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n-    auto Submit(F&& fn)\n+    template <class F> [[nodiscard]]\n+    util::Expected<std::future<std::invoke_result_t<F>>, std::string> Submit(F&& fn) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n     {\n-        std::packaged_task task{std::forward<F>(fn)};\n+        std::packaged_task<std::invoke_result_t<F>()> task{std::forward<F>(fn)};\n         auto future{task.get_future()};\n         {\n             LOCK(m_mutex);\n             if (m_interrupt || m_workers.empty()) {\n-                throw std::runtime_error(\"No active workers; cannot accept new tasks\");\n+                return util::Unexpected<std::string>(\"No active workers; cannot accept new tasks\");",
      "path": "src/util/threadpool.h",
      "position": 1,
      "original_position": 32,
      "commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "original_commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "in_reply_to_id": 2800890119,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Cool. Done as suggested. Thanks.",
      "created_at": "2026-02-12T23:02:06Z",
      "updated_at": "2026-02-12T23:02:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2801460424",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801460424"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 164,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801460794",
      "pull_request_review_id": 3794151219,
      "id": 2801460794,
      "node_id": "PRRC_kwDOABII586m-uY6",
      "diff_hunk": "@@ -276,7 +276,12 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }\n+",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 28,
      "commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "original_commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "in_reply_to_id": 2800913416,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2026-02-12T23:02:13Z",
      "updated_at": "2026-02-12T23:02:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2801460794",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801460794"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 284,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801461558",
      "pull_request_review_id": 3794152404,
      "id": 2801461558,
      "node_id": "PRRC_kwDOABII586m-uk2",
      "diff_hunk": "",
      "path": "src/test/fuzz/threadpool.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "241367d021d210f25e427e7bb35c676b293ff28a",
      "in_reply_to_id": 2801004334,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Sure. Done as suggested. Thanks.",
      "created_at": "2026-02-12T23:02:32Z",
      "updated_at": "2026-02-12T23:02:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2801461558",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801461558"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801472139",
      "pull_request_review_id": 3794166799,
      "id": 2801472139,
      "node_id": "PRRC_kwDOABII586m-xKL",
      "diff_hunk": "",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "in_reply_to_id": 2801017120,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Taken, thanks!\r\n\r\n> I don't think it's necessary to classify this as a race condition. I guess it depends on how you define it.\r\n\r\nThere is a thread (shutdown - main thread) modifying a resource (thread pool) just before another thread (libevent http handler) accesses it. It is pretty much a race condition to me.",
      "created_at": "2026-02-12T23:06:35Z",
      "updated_at": "2026-02-12T23:06:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2801472139",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2801472139"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2804490918",
      "pull_request_review_id": 3797580441,
      "id": 2804490918,
      "node_id": "PRRC_kwDOABII586nKSKm",
      "diff_hunk": "@@ -151,20 +153,20 @@ class ThreadPool\n      * Note: Ignoring the returned future requires guarding the task against\n      * uncaught exceptions, as they would otherwise be silently discarded.\n      */\n-    template <class F> [[nodiscard]] EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n-    auto Submit(F&& fn)\n+    template <class F>\n+    [[nodiscard]] util::Expected<std::future<std::invoke_result_t<F>>, std::string> Submit(F&& fn) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)",
      "path": "src/util/threadpool.h",
      "position": 1,
      "original_position": 23,
      "commit_id": "668eaa4ab4060d9f0f6c955679c95d9ea61499e0",
      "original_commit_id": "668eaa4ab4060d9f0f6c955679c95d9ea61499e0",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Can this be `noexcept` now?",
      "created_at": "2026-02-13T14:25:55Z",
      "updated_at": "2026-02-13T14:25:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2804490918",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2804490918"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 157,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2804827413",
      "pull_request_review_id": 3797961362,
      "id": 2804827413,
      "node_id": "PRRC_kwDOABII586nLkUV",
      "diff_hunk": "@@ -151,20 +153,20 @@ class ThreadPool\n      * Note: Ignoring the returned future requires guarding the task against\n      * uncaught exceptions, as they would otherwise be silently discarded.\n      */\n-    template <class F> [[nodiscard]] EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n-    auto Submit(F&& fn)\n+    template <class F>\n+    [[nodiscard]] util::Expected<std::future<std::invoke_result_t<F>>, std::string> Submit(F&& fn) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)",
      "path": "src/util/threadpool.h",
      "position": 1,
      "original_position": 23,
      "commit_id": "668eaa4ab4060d9f0f6c955679c95d9ea61499e0",
      "original_commit_id": "668eaa4ab4060d9f0f6c955679c95d9ea61499e0",
      "in_reply_to_id": 2804490918,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Sure, done as suggested.",
      "created_at": "2026-02-13T15:38:08Z",
      "updated_at": "2026-02-13T15:38:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2804827413",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2804827413"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 157,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2805989097",
      "pull_request_review_id": 3799391187,
      "id": 2805989097,
      "node_id": "PRRC_kwDOABII586nP_7p",
      "diff_hunk": "",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "5326821cbffbef388421af082d43c7bc6bcc48f7",
      "in_reply_to_id": 2801017120,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> There is a thread (shutdown - main thread) modifying a resource (thread pool) just before another thread (libevent http handler) accesses it. It is pretty much a race condition to me.\r\n\r\nFair.",
      "created_at": "2026-02-13T20:34:38Z",
      "updated_at": "2026-02-13T20:55:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2805989097",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2805989097"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806053342",
      "pull_request_review_id": 3799391187,
      "id": 2806053342,
      "node_id": "PRRC_kwDOABII586nQPne",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "1. Log the inner error string (currently it's never read).\n2. Even though we know it in the context of this PR/issue - I think it's a bit overly presumptuous to claim we are shutting down. All this outer logic knows is that `Submit()` failed. Would go with more neutral language.\n```suggestion\n        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n            LogWarning(\"Request rejected by thread pool: %s\", res.error());\n            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected by thread pool\");\n            return;\n        }\n```\n(I was experimenting with changing `ThreadPool::Submit()` to enforce the queue depth by itself, which would be another potential reason for it to fail).",
      "created_at": "2026-02-13T20:55:13Z",
      "updated_at": "2026-02-13T20:55:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2806053342",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806053342"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806122394",
      "pull_request_review_id": 3799567550,
      "id": 2806122394,
      "node_id": "PRRC_kwDOABII586nQgea",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The `LogWarning` change makes sense, but the `WriteReply` one isn't really appropriate. Have in mind that `WriteReply` is an user-facing response, and referring to the \"thread pool\" there leaks internal details that do not help the user understand what happened nor what to do next.\r\n\r\n> (I was experimenting with changing ThreadPool::Submit() to enforce the queue depth by itself, which would be another potential reason for it to fail).\r\n\r\nI briefly thought about this and ended up discarding the idea because there is no other known use-case that requires it for now. Capping the pool is required when the pool faces user's requests, and all other applications we have for it are purely internal (parallel index sync, block inputs fetching, wallet rescan, kernel validation signals, etc). Ideally, we should only generalize features into the thread pool class only when we plan to use them in more than one place.",
      "created_at": "2026-02-13T21:14:21Z",
      "updated_at": "2026-02-13T21:14:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2806122394",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806122394"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806173647",
      "pull_request_review_id": 3799640701,
      "id": 2806173647,
      "node_id": "PRRC_kwDOABII586nQs_P",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "We currently don't have a simple way to detect shutdown from within the libevent request callback to be able to differentiate between states, and we shouldn't pollute code just because of this. Submission can only fail because of a shutdown atm.\r\nWe will be able to access more information from within this function after the libevent removal path, as the new server provides better encapsulation.",
      "created_at": "2026-02-13T21:28:05Z",
      "updated_at": "2026-02-13T21:36:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2806173647",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806173647"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806210585",
      "pull_request_review_id": 3799692564,
      "id": 2806210585,
      "node_id": "PRRC_kwDOABII586nQ2AZ",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yeah, I can agree on not being to specific with the internals in user-facing messages and omitting thread pool.\r\n```suggestion\r\n        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\r\n            LogWarning(\"Request rejected by thread pool: %s\", res.error());\r\n            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected, probably due to server shutdown\");\r\n            return;\r\n        }\r\n```\r\nIf you want to keep the current very assertive wording \"Request rejected during server shutdown\" I would suggest returning a one-value error `enum` instead of the `std::string` in `util::Expected` and having:\r\n\r\n```suggestion\r\n        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\r\n            switch (res.error()) {\r\n            case ThreadPool::SubmitError::Interrupted:\r\n                LogWarning(\"Request rejected during server shutdown\");\r\n                hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\r\n                return;\r\n            } // no default case, so the compiler can warn about missing cases\r\n        }\r\n```",
      "created_at": "2026-02-13T21:37:54Z",
      "updated_at": "2026-02-13T21:37:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2806210585",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806210585"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806233905",
      "pull_request_review_id": 3799723551,
      "id": 2806233905,
      "node_id": "PRRC_kwDOABII586nQ7sx",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> I briefly thought about this and ended up discarding the idea because there is no other known use-case that requires it for now. Capping the pool is required when the pool faces user's requests, and all other applications we have for it are purely internal (parallel index sync, block inputs fetching, wallet rescan, kernel validation signals, etc). Ideally, we should only generalize features into the thread pool class only when we plan to use them in more than one place.\r\n\r\nI was worried about multiple threads calling `Submit()` and doing the queue depth check on the outside in a racy way where they both pass and then both `Submit()` and exceed the depth by one. But libevent probably only calls `http_request_cb()` from one thread so we should be fine right now. Thanks for laying out your reasoning, makes sense.",
      "created_at": "2026-02-13T21:44:50Z",
      "updated_at": "2026-02-13T21:44:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2806233905",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806233905"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806257320",
      "pull_request_review_id": 3799754229,
      "id": 2806257320,
      "node_id": "PRRC_kwDOABII586nRBao",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> If you want to keep the current very assertive wording \"Request rejected during server shutdown\" I would suggest returning a one-value error enum instead of the std::string in util::Expected\r\n\r\nI'm not convinced we should add an error code enum when weâ€™re not expecting to expand it anytime soon. It would force everyone using the pool to add a bunch of boilerplate code for no real gain.\r\nWe could differentiate states now, without waiting for the post-libevent encapsulation, by checking whether the pool was interrupted too. Still, it feels like overthinking this for no real reason.\r\nI would focus on fixing the issue here and keep the code simple for now. We can always adapt/modify it when more pool use-cases get merged.",
      "created_at": "2026-02-13T21:51:59Z",
      "updated_at": "2026-02-13T21:54:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2806257320",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806257320"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806291786",
      "pull_request_review_id": 3799807774,
      "id": 2806291786,
      "node_id": "PRRC_kwDOABII586nRJ1K",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "True, I am probably somewhat biased by my earlier experiments. Maybe it would be cleaner for `Submit()` to return `std::optional<std::future<std::invoke_result_t<F>>>` instead of `util::Expected<std::future<std::invoke_result_t<F>>, std::string>` after all - as long as there is only one single cause of failure?",
      "created_at": "2026-02-13T22:03:30Z",
      "updated_at": "2026-02-13T22:03:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2806291786",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806291786"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806459577",
      "pull_request_review_id": 3800073205,
      "id": 2806459577,
      "node_id": "PRRC_kwDOABII586nRyy5",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Maybe it would be cleaner for `Submit()` to return `std::optional<std::future<std::invoke_result_t<F>>>` instead of `util::Expected<std::future<std::invoke_result_t<F>>, std::string>` after all - as long as there is only one single cause of failure?\r\n\r\nHmm, good observation. Thinking further.. there are currently two possible errors during submission that are currently under the same error message: 1) a non-started pool and 2) an interrupted pool. The first one is actually a logical error rather than one during runtime, and we should probably assert/assume that cannot happen. Will think more about this.",
      "created_at": "2026-02-13T23:14:02Z",
      "updated_at": "2026-02-14T01:17:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2806459577",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2806459577"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2809534130",
      "pull_request_review_id": 3805060200,
      "id": 2809534130,
      "node_id": "PRRC_kwDOABII586ndhay",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think `Expected` is the appropriate return value here. It is an unexpected failure to submit a task, rather than the result being \"not found\" or \"not existing\" as a `nullopt` would imply.",
      "created_at": "2026-02-15T15:11:03Z",
      "updated_at": "2026-02-15T15:11:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2809534130",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2809534130"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2811317674",
      "pull_request_review_id": 3807383837,
      "id": 2811317674,
      "node_id": "PRRC_kwDOABII586nkU2q",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`optional` doesn't strictly mean \"found/not found\", IMO it's closer to \"may be set or not\". `Submit()` is not a query type function, we are submitting to a thread pool and should be getting a `std::future` back.\r\n\r\nThe user-code and messages here immediately draw the conclusion that failure to submit means we are shutting down, so it is not *that* unexpected. Having a string as the error approaches stringly typed coding which should also be avoided (potentially returning different strings for different error conditions makes user code worse).\r\n\r\nAs long as we only have one combined error condition (not started *or* interrupted), I think `optional` makes the most sense. If we separate the two I think `util::Unexpected{enum SubmitError { NotStarted, Interrupted }}` makes more sense.\r\n\r\nPS. I'm sorry if this feels nit-picky, I would probably let it slide if it was more of a leaf-type component.",
      "created_at": "2026-02-16T08:59:35Z",
      "updated_at": "2026-02-16T09:06:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2811317674",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2811317674"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813012276",
      "pull_request_review_id": 3809291766,
      "id": 2813012276,
      "node_id": "PRRC_kwDOABII586nqyk0",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I went one step back and asked myself why added the submission exception in the first place (3.5 years ago). Should have remembered the reasoning sooner and not gotten obnubilated by our new shiny `util::Expected` toy.. sorry.\r\n\r\nThread pools are a well-studied structure, and most languages and libraries handle submission errors in the same way:\r\n* Java's ExecutorService throws `RejectedExecutionException` after shutdown().\r\n* Python's `ThreadPoolExecutor` raises a `RuntimeError` after shutdown().\r\n* Boost.Asio treats submission after stop or shutdown as misuse.\r\n\r\nSo, the principle is the same everywhere: a thread pool is a resource with a lifecycle. Once you cross the shutdown boundary, submitting work isn't normal control flow anymore, and it should be treated differently.\r\n\r\nFor us, that means:\r\n* \"Pool not started\": that's a bug in the calling code. We can either Assume it or throw a `logic_error`. Callers can't recover from this anyway.\r\n* \"Pool interrupted\": is a hard lifecycle boundary. Submitting after `Interrupt()` should throw a dedicated `interrupted_exception`. Not everyone has to worry about this.\r\n* Otherwise: strong guarantee. If you get a future back, your task will run.\r\n\r\nWill re-accommodate the code to follow this principles again. I'm inclined towards being consistent with existing libraries and not reinvent the wheel.\r\n\r\nLet me know if you guys have any reservation about this.",
      "created_at": "2026-02-16T15:36:58Z",
      "updated_at": "2026-02-16T15:37:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2813012276",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813012276"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813039981",
      "pull_request_review_id": 3809321408,
      "id": 2813039981,
      "node_id": "PRRC_kwDOABII586nq5Vt",
      "diff_hunk": "@@ -17,6 +18,7 @@\n #include <queue>\n #include <stdexcept>\n #include <thread>\n+#include <type_traits>\n #include <utility>\n #include <vector>\n ",
      "path": "src/util/threadpool.h",
      "position": 17,
      "original_position": 15,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "818e2edadc11dca226539ddee945f0acf6e53814",
      "in_reply_to_id": null,
      "user": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In \"threadpool: make Submit return Expected instead of throwing\" 818e2edadc11dca226539ddee945f0acf6e53814\n\nThis introduces inconsistency. In `Start`, we throw a runtime error as a result of multiple calls to `Start`, or possibly an exception could occur when thread creation fails for some reason. \n\n I'm also a bit conflicted here. Why are we using `util::Expected`? Shouldn't the client be patched to handle throws when interacting with the thread pool? It's likely that we throw for some cases, and still back to an issue like the unclean shutdown we are fixing here?\n",
      "created_at": "2026-02-16T15:42:43Z",
      "updated_at": "2026-02-16T15:44:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2813039981",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813039981"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 23,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813062353",
      "pull_request_review_id": 3809346741,
      "id": 2813062353,
      "node_id": "PRRC_kwDOABII586nq-zR",
      "diff_hunk": "@@ -17,6 +18,7 @@\n #include <queue>\n #include <stdexcept>\n #include <thread>\n+#include <type_traits>\n #include <utility>\n #include <vector>\n ",
      "path": "src/util/threadpool.h",
      "position": 17,
      "original_position": 15,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "818e2edadc11dca226539ddee945f0acf6e53814",
      "in_reply_to_id": 2813039981,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes. Please see https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2813012276. Same conclusion there. I'm changing the current PR approach now. I shouldn't have gotten obnubilated by our shiny new `util::Expected` toy.",
      "created_at": "2026-02-16T15:47:20Z",
      "updated_at": "2026-02-16T15:54:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2813062353",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813062353"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 23,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813096660",
      "pull_request_review_id": 3809383901,
      "id": 2813096660,
      "node_id": "PRRC_kwDOABII586nrHLU",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think the way Java and Python throw exceptions is dated. It's what got us into the situation with this PR in the first place, returning an error by value is a safer pattern IMO. That's why Rust opted to not support exceptions.",
      "created_at": "2026-02-16T15:55:13Z",
      "updated_at": "2026-02-16T15:55:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2813096660",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813096660"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813111158",
      "pull_request_review_id": 3809401258,
      "id": 2813111158,
      "node_id": "PRRC_kwDOABII586nrKt2",
      "diff_hunk": "@@ -17,6 +18,7 @@\n #include <queue>\n #include <stdexcept>\n #include <thread>\n+#include <type_traits>\n #include <utility>\n #include <vector>\n ",
      "path": "src/util/threadpool.h",
      "position": 17,
      "original_position": 15,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "818e2edadc11dca226539ddee945f0acf6e53814",
      "in_reply_to_id": 2813039981,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`Start()` could probably `Assume()` or `assert()` instead of throw, it seems to be a bit of a logic error to `Start()` twice without stopping.",
      "created_at": "2026-02-16T15:58:47Z",
      "updated_at": "2026-02-16T15:58:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2813111158",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813111158"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 23,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813190132",
      "pull_request_review_id": 3809484395,
      "id": 2813190132,
      "node_id": "PRRC_kwDOABII586nrd_0",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> I think the way Java and Python throw exceptions is dated. It's what got us into the situation with this PR in the first place, returning an error by value is a safer pattern IMO. That's why Rust opted to not support exceptions.\r\n\r\nIt seems low-level Rust panics/aborts when submitting a task to an interrupted pool. What they have is a `try_spawn` wrapper (`TrySubmit` for us) that behaves in the way you describe. See [rusty_pool](https://docs.rs/rusty_pool/latest/rusty_pool/struct.ThreadPool.html#method.spawn) or [tokio-threadpool](https://docs.rs/tokio-threadpool/latest/tokio_threadpool/struct.ThreadPool.html#method.spawn).\r\n\r\n>  It's what got us into the situation with this PR in the first place\r\n\r\nWell, realistically speaking, the race was already there. We were returning the wrong error message before. The exception actually helped us catch it.",
      "created_at": "2026-02-16T16:18:22Z",
      "updated_at": "2026-02-16T16:29:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2813190132",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813190132"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813299121",
      "pull_request_review_id": 3809597779,
      "id": 2813299121,
      "node_id": "PRRC_kwDOABII586nr4mx",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Agree with @hodlinator. Changing to exceptions is a step backwards. Modern error handling should use `std::expected`, which we can't use yet.\r\nAlso agree to use an enum for the different error cases, instead of using a std::optional. It's ok if we don't check the value yet in production code, but we can update the test cases to assert the proper error.",
      "created_at": "2026-02-16T16:46:51Z",
      "updated_at": "2026-02-16T16:46:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2813299121",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813299121"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813307479",
      "pull_request_review_id": 3809607457,
      "id": 2813307479,
      "node_id": "PRRC_kwDOABII586nr6pX",
      "diff_hunk": "@@ -17,6 +18,7 @@\n #include <queue>\n #include <stdexcept>\n #include <thread>\n+#include <type_traits>\n #include <utility>\n #include <vector>\n ",
      "path": "src/util/threadpool.h",
      "position": 17,
      "original_position": 15,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "818e2edadc11dca226539ddee945f0acf6e53814",
      "in_reply_to_id": 2813039981,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> obnubilated\r\n\r\nlol\r\n\r\nThrowing exceptions should be deprecated IMO, and we should aim to use the more modern `Expected` approach for errors. If an error is unrecoverable, `abort` instead of throwing an exception.",
      "created_at": "2026-02-16T16:48:54Z",
      "updated_at": "2026-02-16T16:48:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2813307479",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813307479"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 23,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813382892",
      "pull_request_review_id": 3809686328,
      "id": 2813382892,
      "node_id": "PRRC_kwDOABII586nsNDs",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Well, realistically speaking, the race was already there. We were returning the wrong error message before. The exception actually helped us catch it.\r\n\r\nThe previous race would return an error to the caller. The exception caused the node to crash. Using `Expected` prevents this kind of error from occurring because the caller is forced to handle the error instead of forgetting to wrap in try/catch.",
      "created_at": "2026-02-16T17:10:29Z",
      "updated_at": "2026-02-16T17:10:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2813382892",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813382892"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813492557",
      "pull_request_review_id": 3809834071,
      "id": 2813492557,
      "node_id": "PRRC_kwDOABII586nsn1N",
      "diff_hunk": "@@ -17,6 +18,7 @@\n #include <queue>\n #include <stdexcept>\n #include <thread>\n+#include <type_traits>\n #include <utility>\n #include <vector>\n ",
      "path": "src/util/threadpool.h",
      "position": 17,
      "original_position": 15,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "818e2edadc11dca226539ddee945f0acf6e53814",
      "in_reply_to_id": 2813039981,
      "user": {
        "login": "sedited",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sedited",
        "html_url": "https://github.com/sedited",
        "followers_url": "https://api.github.com/users/sedited/followers",
        "following_url": "https://api.github.com/users/sedited/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sedited/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sedited/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sedited/subscriptions",
        "organizations_url": "https://api.github.com/users/sedited/orgs",
        "repos_url": "https://api.github.com/users/sedited/repos",
        "events_url": "https://api.github.com/users/sedited/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sedited/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Throwing exceptions should be deprecated IMO\n\nI disagree with this as a general statement. For example, throwing an exception is the standard way to indicate an error in a constructor, as utilized all over the standard library. We also use the standard library very extensively, which makes extensive use of exceptions, and will require us to handle them for as long as we use it.",
      "created_at": "2026-02-16T17:45:24Z",
      "updated_at": "2026-02-16T17:45:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2813492557",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2813492557"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 23,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2814200745",
      "pull_request_review_id": 3810703337,
      "id": 2814200745,
      "node_id": "PRRC_kwDOABII586nvUup",
      "diff_hunk": "@@ -17,6 +18,7 @@\n #include <queue>\n #include <stdexcept>\n #include <thread>\n+#include <type_traits>\n #include <utility>\n #include <vector>\n ",
      "path": "src/util/threadpool.h",
      "position": 17,
      "original_position": 15,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "818e2edadc11dca226539ddee945f0acf6e53814",
      "in_reply_to_id": 2813039981,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Right, we can't return an `Expected` from a constructor like we can return a `Result` in Rust when creating an object. Other than that, though, I don't think there's a need to throw an exception. We still need to catch exceptions, of course. I didn't suggest we stop doing that!",
      "created_at": "2026-02-16T22:15:37Z",
      "updated_at": "2026-02-16T22:15:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2814200745",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2814200745"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 23,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2814519485",
      "pull_request_review_id": 3811097297,
      "id": 2814519485,
      "node_id": "PRRC_kwDOABII586nwii9",
      "diff_hunk": "@@ -276,7 +276,11 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+            LogWarning(\"Request rejected during server shutdown\");\n+            hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n+            return;\n+        }",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "b95e40359568d964c0ed1341c91ce8ed97c78d62",
      "in_reply_to_id": 2806053342,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> The previous race would return an error to the caller. The exception caused the node to crash. Using Expected prevents this kind of error from occurring because the caller is forced to handle the error instead of forgetting to wrap in try/catch.\r\n\r\nYes, thatâ€™s pretty much the PR description. What I meant above is that itâ€™s great weâ€™re here, because it means weâ€™ve caught something new. That comment at least wasn't a pro exceptions argument. It was a pro thread pool inclusion argument really.",
      "created_at": "2026-02-17T00:50:05Z",
      "updated_at": "2026-02-17T00:50:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2814519485",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2814519485"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": 279,
      "original_start_line": 279,
      "start_side": "RIGHT",
      "line": 285,
      "original_line": 283,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2815635246",
      "pull_request_review_id": 3812447114,
      "id": 2815635246,
      "node_id": "PRRC_kwDOABII586n0y8u",
      "diff_hunk": "@@ -208,4 +223,15 @@ class ThreadPool\n     }\n };\n \n+static constexpr std::string_view SubmitErrorString(ThreadPool::SubmitError err) noexcept {",
      "path": "src/util/threadpool.h",
      "position": 1,
      "original_position": 93,
      "commit_id": "881568b39b686f0a418e02972c28c050c76de059",
      "original_commit_id": "881568b39b686f0a418e02972c28c050c76de059",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`static` on a free function means that it should be local to the translation unit without any exported symbols. AFAIK we only use it for functions in .CPP files. `inline` would make more sense, but is already implied by `constexpr`.\n\n```suggestion\nconstexpr std::string_view SubmitErrorString(ThreadPool::SubmitError err) noexcept {\n```",
      "created_at": "2026-02-17T08:38:31Z",
      "updated_at": "2026-02-17T11:36:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2815635246",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2815635246"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 226,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2816415742",
      "pull_request_review_id": 3812447114,
      "id": 2816415742,
      "node_id": "PRRC_kwDOABII586n3xf-",
      "diff_hunk": "",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "881568b39b686f0a418e02972c28c050c76de059",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "IMO stopping the `ThreadPool` before we stop the libevent [dispatch loop](https://libevent.org/libevent-book/Ref3_eventloop.html) is the wrong order. Would ideally do something like the following patch:\n\n<details><summary>Patch for HTTP shutdown order</summary>\n\n```diff\nhttp: Correct shutdown order of libevent vs ThreadPool\n\ng_threadpool_http is initialized before the libevent dispatch loop in g_thread_http,\nso it should be deinitialized in the reverse order. Exit the event loop first so\nthat we stop trying to Submit() new tasks to the pool before stopping it. (We will\nstill interrupt the pool earlier on, so submission-attempts can still fail).\n\nAlso:\n* Delete the accept sockets before exiting the loop.\n* Free eventHTTP from our own thread as events are no longer processed (this also fixes a frequent memory leak where eventHTTP would not be freed).\n\ndiff --git a/src/httpserver.cpp b/src/httpserver.cpp\nindex 578c4ec693..ec821dd0b0 100644\n--- a/src/httpserver.cpp\n+++ b/src/httpserver.cpp\n@@ -457,15 +457,20 @@ void StopHTTPServer()\n {\n     LogDebug(BCLog::HTTP, \"Stopping HTTP server\\n\");\n \n-    LogDebug(BCLog::HTTP, \"Waiting for HTTP worker threads to exit\\n\");\n-    g_threadpool_http.Stop();\n-\n-    // Unlisten sockets, these are what make the event loop running, which means\n-    // that after this and all connections are closed the event loop will quit.\n+    // Unlisten sockets\n     for (evhttp_bound_socket *socket : boundSockets) {\n         evhttp_del_accept_socket(eventHTTP, socket);\n     }\n     boundSockets.clear();\n+\n+    if (eventBase) {\n+        LogDebug(BCLog::HTTP, \"Finishing processing of event loop callbacks\\n\");\n+        event_base_loopexit(eventBase, nullptr);\n+    }\n+\n+    LogDebug(BCLog::HTTP, \"Waiting for HTTP worker threads to exit\\n\");\n+    g_threadpool_http.Stop();\n+\n     {\n         if (const auto n_connections{g_requests.CountActiveConnections()}; n_connections != 0) {\n             LogDebug(BCLog::HTTP, \"Waiting for %d connections to stop HTTP server\\n\", n_connections);\n@@ -473,13 +478,8 @@ void StopHTTPServer()\n         g_requests.WaitUntilEmpty();\n     }\n     if (eventHTTP) {\n-        // Schedule a callback to call evhttp_free in the event base thread, so\n-        // that evhttp_free does not need to be called again after the handling\n-        // of unfinished request connections that follows.\n-        event_base_once(eventBase, -1, EV_TIMEOUT, [](evutil_socket_t, short, void*) {\n-            evhttp_free(eventHTTP);\n-            eventHTTP = nullptr;\n-        }, nullptr, nullptr);\n+        evhttp_free(eventHTTP);\n+        eventHTTP = nullptr;\n     }\n     if (eventBase) {\n         LogDebug(BCLog::HTTP, \"Waiting for HTTP event thread to exit\\n\");\n```\n\n</details>\n\nDoing the above allows for merging the `ThreadPool`'s constructor with `Start()` and merging the destructor with `Stop()`.\n* This follows from not allowing calling `Start()` twice, which is implicit in a constructor. The new assert in `Start()` becomes unnecessary.\n* Having `Stop()` logic only happen during destruction also implies that only a single thread should have access to the `ThreadPool` instance at that time. This would prevent the potential race condition I found here: https://github.com/bitcoin/bitcoin/pull/34562#discussion_r2800811310\n\n<details><summary>Patch to merge ThreadPool ctor with Start() and dtor with Stop()</summary>\n\n```diff\nutil: Merge ThreadPool ctor with Start(), and ThreadPool dtor with Stop().\n\nHTTP now wraps the pool in std::optional.\n\ndiff --git a/src/httpserver.cpp b/src/httpserver.cpp\nindex ec821dd0b0..8ca5b7771e 100644\n--- a/src/httpserver.cpp\n+++ b/src/httpserver.cpp\n@@ -75,7 +75,7 @@ static std::vector<HTTPPathHandler> pathHandlers GUARDED_BY(g_httppathhandlers_m\n //! Bound listening sockets\n static std::vector<evhttp_bound_socket *> boundSockets;\n //! Http thread pool - future: encapsulate in HttpContext\n-static ThreadPool g_threadpool_http(\"http\");\n+static std::optional<ThreadPool> g_threadpool_http;\n static int g_max_queue_depth{100};\n \n /**\n@@ -252,7 +252,7 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n \n     // Dispatch to worker thread\n     if (i != iend) {\n-        if (static_cast<int>(g_threadpool_http.WorkQueueSize()) >= g_max_queue_depth) {\n+        if (static_cast<int>(g_threadpool_http->WorkQueueSize()) >= g_max_queue_depth) {\n             LogWarning(\"Request rejected because http work queue depth exceeded, it can be increased with the -rpcworkqueue= setting\");\n             hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Work queue depth exceeded\");\n             return;\n@@ -276,7 +276,7 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {\n+        if (auto res = g_threadpool_http->Submit(std::move(item)); !res.has_value()) {\n             // Both SubmitError::Inactive and SubmitError::Interrupted mean shutdown\n             LogWarning(\"HTTP request rejected during server shutdown: '%s'\", SubmitErrorString(res.error()));\n             hreq->WriteReply(HTTP_SERVICE_UNAVAILABLE, \"Request rejected during server shutdown\");\n@@ -438,7 +438,7 @@ void StartHTTPServer()\n {\n     int rpcThreads = std::max((long)gArgs.GetIntArg(\"-rpcthreads\", DEFAULT_HTTP_THREADS), 1L);\n     LogInfo(\"Starting HTTP server with %d worker threads\\n\", rpcThreads);\n-    g_threadpool_http.Start(rpcThreads);\n+    g_threadpool_http.emplace(\"http\", rpcThreads);\n     g_thread_http = std::thread(ThreadHTTP, eventBase);\n }\n \n@@ -450,7 +450,7 @@ void InterruptHTTPServer()\n         evhttp_set_gencb(eventHTTP, http_reject_request_cb, nullptr);\n     }\n     // Interrupt pool after disabling requests\n-    g_threadpool_http.Interrupt();\n+    g_threadpool_http->Interrupt();\n }\n \n void StopHTTPServer()\n@@ -469,7 +469,7 @@ void StopHTTPServer()\n     }\n \n     LogDebug(BCLog::HTTP, \"Waiting for HTTP worker threads to exit\\n\");\n-    g_threadpool_http.Stop();\n+    g_threadpool_http.reset();\n \n     {\n         if (const auto n_connections{g_requests.CountActiveConnections()}; n_connections != 0) {\ndiff --git a/src/util/threadpool.h b/src/util/threadpool.h\nindex e1f2d86ed0..7a3d77e453 100644\n--- a/src/util/threadpool.h\n+++ b/src/util/threadpool.h\n@@ -87,13 +87,6 @@ private:\n     }\n \n public:\n-    explicit ThreadPool(const std::string& name) : m_name(name) {}\n-\n-    ~ThreadPool()\n-    {\n-        Stop(); // In case it hasn't been stopped.\n-    }\n-\n     /**\n      * @brief Start worker threads.\n      *\n@@ -104,12 +97,11 @@ public:\n      * initialization and idle shutdown patterns, callers must provide their\n      * own synchronization.\n      */\n-    void Start(const int num_workers) noexcept EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    explicit ThreadPool(const std::string& name, const int num_workers) noexcept EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+        : m_name(name)\n     {\n         assert(num_workers > 0);\n         LOCK(m_mutex);\n-        assert(m_workers.empty());\n-        m_interrupt = false; // Reset\n \n         // Create workers\n         m_workers.reserve(num_workers);\n@@ -126,7 +118,7 @@ public:\n      *\n      * Must be called from a controller (non-worker) thread.\n      */\n-    void Stop() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    ~ThreadPool() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n     {\n         // Notify workers and join them\n         std::vector<std::thread> threads_to_join;\n```\n\n</details>\n\nCurious to hear what others think. This is not blocking for me within this PR. I haven't thoroughly tested the libevent change beyond running functional tests and I can understand not wanting to touch libevent behavior. Maybe the change to `ThreadPool` should wait until #32061 lands.",
      "created_at": "2026-02-17T11:04:00Z",
      "updated_at": "2026-02-17T11:36:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2816415742",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2816415742"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 462,
      "original_line": 461,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2817779345",
      "pull_request_review_id": 3814808618,
      "id": 2817779345,
      "node_id": "PRRC_kwDOABII586n8-aR",
      "diff_hunk": "",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "881568b39b686f0a418e02972c28c050c76de059",
      "in_reply_to_id": 2816415742,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> IMO stopping the `ThreadPool` before we stop the libevent [dispatch loop](https://libevent.org/libevent-book/Ref3_eventloop.html) is the wrong order\r\n\r\nJust to be precise with this, the ordering is wrong but it is not really an issue, because (1) `InterruptHTTPServer` replaces the handler for one that rejects all incoming requests. And (2) even if we would be handling requests, the pool would just reject the work and we would return a clear error message now.\r\n\r\nI agree with the first patch, but I think we should limit ourselves to refactoring libevent code while trying to avoid behavior changes at this point (unless we see a very clear benefit behind them). Modifications there require additional research time for an unmaintained library.\r\n\r\nMoving the pool shutdown to the end of the function should give us the same behavior without touching the libevent code.\r\n\r\n> Doing the above allows for merging the ThreadPool's constructor with Start() and merging the destructor with Stop().\r\n\r\nRAII the pool was brought up a few times before; I implemented it too. Itâ€™s not a bad idea, but Iâ€™ve been trying not to introduce it too early and first gather more use cases. Mainly because it would make lazy startup and idle shutdown patterns harder to implement. It would also require pool configurations to be stored in a separate structure and dup them when the pool gets constructed.",
      "created_at": "2026-02-17T15:54:34Z",
      "updated_at": "2026-02-17T15:54:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2817779345",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2817779345"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 462,
      "original_line": 461,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2817782369",
      "pull_request_review_id": 3814812510,
      "id": 2817782369,
      "node_id": "PRRC_kwDOABII586n8_Jh",
      "diff_hunk": "@@ -208,4 +223,15 @@ class ThreadPool\n     }\n };\n \n+static constexpr std::string_view SubmitErrorString(ThreadPool::SubmitError err) noexcept {",
      "path": "src/util/threadpool.h",
      "position": 1,
      "original_position": 93,
      "commit_id": "881568b39b686f0a418e02972c28c050c76de059",
      "original_commit_id": "881568b39b686f0a418e02972c28c050c76de059",
      "in_reply_to_id": 2815635246,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Sure. Done. The `static` was moved from when this was a class method.",
      "created_at": "2026-02-17T15:55:05Z",
      "updated_at": "2026-02-17T15:55:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2817782369",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2817782369"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 226,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2818852355",
      "pull_request_review_id": 3816030938,
      "id": 2818852355,
      "node_id": "PRRC_kwDOABII586oBEYD",
      "diff_hunk": "@@ -17,6 +18,7 @@\n #include <queue>\n #include <stdexcept>\n #include <thread>\n+#include <type_traits>\n #include <utility>\n #include <vector>\n ",
      "path": "src/util/threadpool.h",
      "position": 17,
      "original_position": 15,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "818e2edadc11dca226539ddee945f0acf6e53814",
      "in_reply_to_id": 2813039981,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Updated. Got convinced keeping the `Expected` approach here is the best path to follow. Thanks everyone for the discussion!",
      "created_at": "2026-02-17T20:07:56Z",
      "updated_at": "2026-02-17T20:07:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2818852355",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2818852355"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 23,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2823753211",
      "pull_request_review_id": 3821353750,
      "id": 2823753211,
      "node_id": "PRRC_kwDOABII586oTw37",
      "diff_hunk": "",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "881568b39b686f0a418e02972c28c050c76de059",
      "in_reply_to_id": 2816415742,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Mainly because it would make lazy startup and idle shutdown patterns harder to implement.\r\n\r\nYup, it took me a little while to figure out I needed to use `optional::emplace()` to in-place construct the pool in my suggested patch. Probably first time I used that in code I wrote.\r\n\r\n> It would also require pool configurations to be stored in a separate structure and dup them when the pool gets constructed.\r\n\r\nDidn't run into such issues in this instance FWIW.\r\n\r\n---\r\n\r\nInteresting that more RAII style was brought up earlier, it does feel like a natural fit if we didn't have libevent to navigate. Anyway, I'm happy we have this primitive now, sorry I didn't have bandwidth to review it earlier.",
      "created_at": "2026-02-18T18:12:03Z",
      "updated_at": "2026-02-18T18:16:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2823753211",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2823753211"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 462,
      "original_line": 461,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2823913435",
      "pull_request_review_id": 3821639028,
      "id": 2823913435,
      "node_id": "PRRC_kwDOABII586oUX_b",
      "diff_hunk": "",
      "path": "src/httpserver.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "881568b39b686f0a418e02972c28c050c76de059",
      "in_reply_to_id": 2816415742,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Interesting that more RAII style was brought up earlier, it does feel like a natural fit if we didn't have libevent to navigate\r\n\r\nwe have some enthusiastic RAII fans around here.",
      "created_at": "2026-02-18T18:51:37Z",
      "updated_at": "2026-02-18T18:51:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2823913435",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2823913435"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 462,
      "original_line": 461,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2824481723",
      "pull_request_review_id": 3822255955,
      "id": 2824481723,
      "node_id": "PRRC_kwDOABII586oWiu7",
      "diff_hunk": "@@ -276,7 +276,12 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {",
      "path": "src/httpserver.cpp",
      "position": 23,
      "original_position": 23,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "379a9201b1aabffe5f19dbabf1fe4fd57e8fefba",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "379a9201b1aabffe5f19dbabf1fe4fd57e8fefba\n\nI'm also interested in trying to save `unique_ptr` for `hreq` and tried some hacks like @hodlinator but nothing great came out of that. If nothing else could we `Assume(hreq.use_count() == 1)` in this block and also below where we send `404`? This would just clarify that we don't reply to a request outside a worker thread unless we're sure the worker thread is nonexistent. ",
      "created_at": "2026-02-18T21:09:45Z",
      "updated_at": "2026-02-18T21:09:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2824481723",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2824481723"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 279,
      "original_line": 279,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2824708091",
      "pull_request_review_id": 3822487527,
      "id": 2824708091,
      "node_id": "PRRC_kwDOABII586oXZ_7",
      "diff_hunk": "@@ -276,7 +276,12 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n             req->WriteReply(HTTP_INTERNAL_SERVER_ERROR, err_msg);\n         };\n \n-        [[maybe_unused]] auto _{g_threadpool_http.Submit(std::move(item))};\n+        if (auto res = g_threadpool_http.Submit(std::move(item)); !res.has_value()) {",
      "path": "src/httpserver.cpp",
      "position": 23,
      "original_position": 23,
      "commit_id": "726b3663cc8e2164d4e9452f12f5866f5e8f6f1a",
      "original_commit_id": "379a9201b1aabffe5f19dbabf1fe4fd57e8fefba",
      "in_reply_to_id": 2824481723,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done as suggested. Thanks.",
      "created_at": "2026-02-18T22:12:12Z",
      "updated_at": "2026-02-18T22:12:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2824708091",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2824708091"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 279,
      "original_line": 279,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2827872800",
      "pull_request_review_id": 3825895791,
      "id": 2827872800,
      "node_id": "PRRC_kwDOABII586ojeog",
      "diff_hunk": "@@ -97,15 +97,17 @@ class ThreadPool\n      * @brief Start worker threads.\n      *\n      * Creates and launches `num_workers` threads that begin executing tasks\n-     * from the queue. If the pool is already started, throws.\n+     * from the queue.\n      *\n-     * Must be called from a controller (non-worker) thread.\n+     * Calling Start() on an already-running pool is a logic error. For lazy\n+     * initialization and idle shutdown patterns, callers must provide their\n+     * own synchronization.\n      */\n-    void Start(int num_workers) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    void Start(const int num_workers) noexcept EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)",
      "path": "src/util/threadpool.h",
      "position": 1,
      "original_position": 13,
      "commit_id": "a6fc8a43f3f5b7605ebcd24212e01524c86a9189",
      "original_commit_id": "a6fc8a43f3f5b7605ebcd24212e01524c86a9189",
      "in_reply_to_id": null,
      "user": {
        "login": "sedited",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sedited",
        "html_url": "https://github.com/sedited",
        "followers_url": "https://api.github.com/users/sedited/followers",
        "following_url": "https://api.github.com/users/sedited/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sedited/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sedited/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sedited/subscriptions",
        "organizations_url": "https://api.github.com/users/sedited/orgs",
        "repos_url": "https://api.github.com/users/sedited/repos",
        "events_url": "https://api.github.com/users/sedited/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sedited/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Not sure about marking this as `noexcept`. Exceptions here would be caught by `AppInit` and we'd shutdown gracefully. There a bunch of functions that do still throw here, e.g. std::system_error when spawning the thread fails. Do we really gain anything by terminating immediately?",
      "created_at": "2026-02-19T13:21:49Z",
      "updated_at": "2026-02-19T13:21:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2827872800",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2827872800"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 106,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2828661015",
      "pull_request_review_id": 3826776969,
      "id": 2828661015,
      "node_id": "PRRC_kwDOABII586omfEX",
      "diff_hunk": "@@ -97,15 +97,17 @@ class ThreadPool\n      * @brief Start worker threads.\n      *\n      * Creates and launches `num_workers` threads that begin executing tasks\n-     * from the queue. If the pool is already started, throws.\n+     * from the queue.\n      *\n-     * Must be called from a controller (non-worker) thread.\n+     * Calling Start() on an already-running pool is a logic error. For lazy\n+     * initialization and idle shutdown patterns, callers must provide their\n+     * own synchronization.\n      */\n-    void Start(int num_workers) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    void Start(const int num_workers) noexcept EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)",
      "path": "src/util/threadpool.h",
      "position": 1,
      "original_position": 13,
      "commit_id": "a6fc8a43f3f5b7605ebcd24212e01524c86a9189",
      "original_commit_id": "a6fc8a43f3f5b7605ebcd24212e01524c86a9189",
      "in_reply_to_id": 2827872800,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Agree on removing `noexcept`.\r\n\r\nAnd this is probably a good moment to align on the broader design philosophy so we have some common foundations going forward.\r\n\r\nThe way I'm seeing it after some back and forth: there are two fundamentally different kinds of failures, and they deserve different treatment. Plus we have a special third rule that is even more important to us than any design decision.\r\n\r\nThe first is environment related failures: things like an allocation failure, IO error, thread spawning failing due to the OS is out of resources, etc. These can happen even in perfectly correct code. For these, throwing makes sense. Even if the caller can't fully recover, it at least gets the chance to shut down gracefully, flush state, log something useful. Hard termination throws all of that away.\r\n\r\nThe second kind is logic errors: things that cannot happen if the code is correct. A double `Start()` call is a good example of this. That's not the OS misbehaving, that's a bug in the caller. Throwing a `std::runtime_error` implies the caller might catch it and carry on, when really we want to say \"this shouldn't happen, and if it does, something is just wrong\". An assertion is more direct here. It's not an error to be handled, it's a violation of the API contract.\r\n\r\nThe third rule that applies only to us (Bitcoin-Core) is that we want to minimize assertions in code that can be accessed through the P2P layer. We don't want to be logically honest here, we want to guard against someone triggering a crash remotely.\r\n\r\n----------\r\n\r\nMaybe if we agree on this, we could add it to one of our .md guidelines. So we don't have to revive this type of discussions every time someone suggests to add a `noexcept` or to change an exception for an assertion in risky places.\r\n\r\nThoughts?",
      "created_at": "2026-02-19T15:52:38Z",
      "updated_at": "2026-02-19T15:52:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2828661015",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2828661015"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 106,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2829848524",
      "pull_request_review_id": 3828174966,
      "id": 2829848524,
      "node_id": "PRRC_kwDOABII586orA_M",
      "diff_hunk": "@@ -97,15 +97,17 @@ class ThreadPool\n      * @brief Start worker threads.\n      *\n      * Creates and launches `num_workers` threads that begin executing tasks\n-     * from the queue. If the pool is already started, throws.\n+     * from the queue.\n      *\n-     * Must be called from a controller (non-worker) thread.\n+     * Calling Start() on an already-running pool is a logic error. For lazy\n+     * initialization and idle shutdown patterns, callers must provide their\n+     * own synchronization.\n      */\n-    void Start(int num_workers) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+    void Start(const int num_workers) noexcept EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)",
      "path": "src/util/threadpool.h",
      "position": 1,
      "original_position": 13,
      "commit_id": "a6fc8a43f3f5b7605ebcd24212e01524c86a9189",
      "original_commit_id": "a6fc8a43f3f5b7605ebcd24212e01524c86a9189",
      "in_reply_to_id": 2827872800,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> The first is environment related failures: things like an allocation failure, IO error, thread spawning failing due to the OS is out of resources, etc. These can happen even in perfectly correct code. For these, throwing makes sense. Even if the caller can't fully recover, it at least gets the chance to shut down gracefully, flush state, log something useful. Hard termination throws all of that away.\r\n\r\nI think it's fairly hard to recover from OOM, IO errors or failing to spawn threads, so wouldn't aim to use exceptions in this case. Exiting with a clear error in the log/stderr and/or crash dump seems realistic and sufficient.\r\n\r\nAgree it would be good to document, if we can agree. ;)\r\n\r\nSome compilers/stdlibs allow for disabling exceptions btw. Not advocating for it in this project, just FYI. I guess one gets a hard crash instead of stack unwinding when throwing from constructors etc.",
      "created_at": "2026-02-19T19:51:45Z",
      "updated_at": "2026-02-19T19:51:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34577#discussion_r2829848524",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2829848524"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34577"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 106,
      "side": "RIGHT"
    }
  ]
}