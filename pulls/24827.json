{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24827",
    "id": 906199936,
    "node_id": "PR_kwDOABII5842A4OA",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/24827",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/24827.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/24827.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24827/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24827/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/0b3ad721462ed060fae991d8ad1510cd92a69bfb",
    "number": 24827,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "net: Fix undefined behavior in socket address handling",
    "user": {
      "login": "Adlai-Holler",
      "id": 2466893,
      "node_id": "MDQ6VXNlcjI0NjY4OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Adlai-Holler",
      "html_url": "https://github.com/Adlai-Holler",
      "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
      "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
      "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
      "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
      "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "Fixes #22613\r\n\r\nThe fix is pretty simple – it's legal to `memcpy` between these types, you just can't dereference members after a `reinterpret_cast`. The `memcpys` will be optimised away in any half decent compiler.\r\n\r\nI chose to switch `GetSockAddr/SetSockAddr` to accept `sockaddr_storage` rather than `sockaddr` so we can be sure we're never reading/writing out of bounds. Essentially, `struct sockaddr*` is old junk that we never want to deal with. Only hand those to the C APIs.",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      },
      {
        "id": 955867938,
        "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
        "name": "Needs rebase",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2022-04-11T16:09:55Z",
    "updated_at": "2025-10-21T14:12:25Z",
    "closed_at": "2022-11-10T17:13:47Z",
    "mergeable": false,
    "mergeable_state": "dirty",
    "merged": false,
    "merge_commit_sha": "e0d4fb7cdc796d04141d7a2a1b379c8de597e448",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "Adlai-Holler:fix_sock_ub",
      "ref": "fix_sock_ub",
      "sha": "0b3ad721462ed060fae991d8ad1510cd92a69bfb",
      "user": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 378497431,
        "node_id": "MDEwOlJlcG9zaXRvcnkzNzg0OTc0MzE=",
        "name": "bitcoin",
        "full_name": "Adlai-Holler/bitcoin",
        "owner": {
          "login": "Adlai-Holler",
          "id": 2466893,
          "node_id": "MDQ6VXNlcjI0NjY4OTM=",
          "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/Adlai-Holler",
          "html_url": "https://github.com/Adlai-Holler",
          "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
          "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
          "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
          "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
          "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/Adlai-Holler/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/Adlai-Holler/bitcoin",
        "archive_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/events",
        "forks_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/Adlai-Holler/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:Adlai-Holler/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/Adlai-Holler/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/hooks",
        "svn_url": "https://github.com/Adlai-Holler/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 207600,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2022-05-03T13:31:54Z",
        "created_at": "2021-06-19T20:15:33Z",
        "updated_at": "2022-04-11T16:08:59Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "29d540b7ada890dd588c4825d40c27c5e6f20061",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38057,
        "stargazers_count": 86328,
        "watchers_count": 86328,
        "size": 295077,
        "default_branch": "master",
        "open_issues_count": 797,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-10-21T14:37:10Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-10-21T14:46:46Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24827"
      }
    },
    "author_association": "NONE",
    "draft": false,
    "additions": 99,
    "deletions": 41,
    "changed_files": 6,
    "commits": 1,
    "review_comments": 1,
    "comments": 17
  },
  "events": [
    {
      "event": "renamed",
      "id": 6410481358,
      "node_id": "RTE_lADOABII585HiZm6zwAAAAF-GC7O",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6410481358",
      "actor": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-11T16:11:15Z",
      "rename": {
        "from": "Fix undefined behavior in socket address handling",
        "to": "net: Fix undefined behavior in socket address handling"
      }
    },
    {
      "event": "labeled",
      "id": 6410589321,
      "node_id": "LE_lADOABII585HiZm6zwAAAAF-GdSJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6410589321",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-11T16:25:52Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "commented",
      "id": 1095354491,
      "node_id": "IC_kwDOABII585BSch7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1095354491",
      "actor": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-11T17:53:10Z",
      "updated_at": "2022-04-11T17:53:10Z",
      "author_association": "NONE",
      "body": "CI failure looks unrelated - a timeout occurred in fee_estimator test. Can we kick the CI again?",
      "user": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1095354491",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "commented",
      "id": 1095373490,
      "node_id": "IC_kwDOABII585BShKy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1095373490",
      "actor": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-11T18:07:48Z",
      "updated_at": "2022-04-11T18:07:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Can we kick the CI again?\r\n\r\nI think you can do it yourself, `git commit --amend` and then `git push --force`.",
      "user": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1095373490",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6411937209,
      "node_id": "HRFPE_lADOABII585HiZm6zwAAAAF-LmW5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6411937209",
      "actor": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "f488d2e3da7425ee548ae1628b573ad7eecf77d2",
      "commit_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/commits/f488d2e3da7425ee548ae1628b573ad7eecf77d2",
      "created_at": "2022-04-11T19:56:51Z"
    },
    {
      "event": "commented",
      "id": 1095599003,
      "node_id": "IC_kwDOABII585BTYOb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1095599003",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-11T21:46:28Z",
      "updated_at": "2022-05-24T01:06:14Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25172](https://github.com/bitcoin/bitcoin/pull/25172) (refactor: use std:: prefix for std lib funcs by fanquake)\n* [#24464](https://github.com/bitcoin/bitcoin/pull/24464) (logging: Add severity level to logs by klementtan)\n* [#23531](https://github.com/bitcoin/bitcoin/pull/23531) (Add Yggdrasil support by prusnak)\n* [#21878](https://github.com/bitcoin/bitcoin/pull/21878) (Make all networking code mockable by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1095599003",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6412546236,
      "node_id": "HRFPE_lADOABII585HiZm6zwAAAAF-N7C8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6412546236",
      "actor": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "77f0208cf912389c88415e8efc80af06ec7616e1",
      "commit_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/commits/77f0208cf912389c88415e8efc80af06ec7616e1",
      "created_at": "2022-04-11T21:46:40Z"
    },
    {
      "event": "commented",
      "id": 1098453110,
      "node_id": "IC_kwDOABII585BeRB2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1098453110",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-13T20:24:23Z",
      "updated_at": "2022-04-13T20:25:19Z",
      "author_association": "MEMBER",
      "body": "Concept ACK, I agree this is UB and it should be fixed. `memcpy` is notoriously dangerous though, this will have to be carefully checked to not introduce any subtle bugs, especially to make sure the right lengths are used everywhere.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1098453110",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "commented",
      "id": 1098601226,
      "node_id": "IC_kwDOABII585Be1MK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1098601226",
      "actor": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-14T00:39:06Z",
      "updated_at": "2022-04-14T00:39:06Z",
      "author_association": "NONE",
      "body": "In terms of lengths, and for more general context on this issue so that reviewers can avoid duplicating work:\r\n\r\n- `struct sockaddr` is an old 1980's generic socket address type, (made with IPv4 in mind). It's like a base class.\r\n- `struct sockaddr_in` (\"internet\") is the IPv4 \"subclass.\"\r\n  - It has a size that fits within `sockaddr` and its layout is such that the two can be cast back & forth. In C. In C++ it's UB to manipulate aliased unrelated types like that.\r\n- `struct sockaddr_in6` is the IPv6 \"subclass.\"\r\n  - It is larger than `sockaddr`\r\n  - But the API still works with `sockaddr*`. It's up to you and the API to cast the pointer to the appropriate \"subclass\" once you know which protocol you're dealing with.\r\n- `struct sockaddr_storage` was added along with `sockaddr_in6` as a \"catch-all\" opaque blob that is large enough to hold either one. The only field defined on the struct is the `ss_family` field (i.e. is this IPv4 or IPv6?). That field is guaranteed to map to the field in all the other versions so it's \"sort of\" castable.\r\n\r\nSo, in this PR here's the strategy:\r\n- On our side, if we need a socket address type that is protocol-independent, make it `sockaddr_storage` instead of `sockaddr`. Makes sure we have a big enough chunk of memory to work with, and it removes some internal casting.\r\n- For writing to out-variables of `sockaddr_storage*`, first we zero all the memory of the out-variable to get a clean slate, then create a protocol-specific local variable e.g. `sockaddr_in` and populate it, then memcpy the smaller subclass variable into the zero'd storage variable.\r\n- Replace downcasts of `sockaddr*` -> e.g. `sockaddr_in*` with creating a local variable of the appropriate type and memcpy'ing using the \"subclass\" length. This looks like a read out of bounds but it's no more out-of-bounds than casting the smaller struct pointer to the larger one was. It's the same thing really.",
      "user": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1098601226",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "reviewed",
      "id": 942829501,
      "node_id": "PRR_kwDOABII5844Mm-9",
      "url": null,
      "actor": null,
      "commit_id": "77f0208cf912389c88415e8efc80af06ec7616e1",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2022-04-14T21:37:51Z",
      "author_association": "CONTRIBUTOR",
      "body": "mostly-ACK 77f0208cf912389c88415e8efc80af06ec7616e1 ([`jamesob/ackr/24827.1.Adlai-Holler.net_fix_undefined_behavi`](https://github.com/jamesob/bitcoin/tree/ackr/24827.1.Adlai-Holler.net_fix_undefined_behavi))\r\n\r\nBuilt, tested locally. \r\n\r\nI'm still spotting some `reinterpret_cast<struct sockaddr*>` calls in e.g.\r\n\r\n- [ ] `ConnectSocketDirectly`\r\n- [ ] `TorControlConnection::Connect`\r\n- [ ] `GetBindAddress`\r\n- [ ] `CConman::AcceptConnection`\r\n- [ ] [some others in net.cpp...]\r\n- [ ] `randomenv.cpp:AddSockaddr` (not sure if this one matters much)\r\n\r\nso I'm not sure this change resolves all of the UB related to sockaddr use.\r\nCasting from `sockaddr_storage*` -> `sockaddr*` seems precarious, since they're\r\ndifferent sizes, but is there some reason you avoided touching those here as\r\nwell?\r\n\r\nAll memcpy invocations look safe to me. Obviously the code will require care\r\nwhen modified though. I wonder if we could consolidate the memcpy calls to a \r\n(templated?) function to cut down the risk.\r\n\r\nLongterm it may make sense to move to some kind of polymorphic union that can\r\nencompass both `sockaddr_in` and `sockaddr_in6` and doesn't require all the\r\nip4/6 case handling, but that's speculative and in any case the avoidance of UB\r\nseems like a strict improvement here.\r\n\r\n<details><summary>Show signature data</summary>\r\n<p>\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nACK 77f0208cf912389c88415e8efc80af06ec7616e1 ([`jamesob/ackr/24827.1.Adlai-Holler.net_fix_undefined_behavi`](https://github.com/jamesob/bitcoin/tree/ackr/24827.1.Adlai-Holler.net_fix_undefined_behavi))\r\n\r\nBuilt, tested locally. \r\n\r\nI'm still spotting some `reinterpret_cast<struct sockaddr*>` calls in e.g.\r\n\r\n- - [ ] `ConnectSocketDirectly`\r\n- - [ ] `TorControlConnection::Connect`\r\n- - [ ] `GetBindAddress`\r\n- - [ ] `CConman::AcceptConnection`\r\n- - [ ] [some others in net.cpp...]\r\n- - [ ] `randomenv.cpp:AddSockaddr` (not sure if this one matters much)\r\n\r\nso I'm not sure this change resolves all of the UB related to sockaddr use.\r\nCasting from `sockaddr_storage*` -> `sockaddr*` seems precarious, since they're\r\ndifferent sizes, but is there some reason you avoided touching those here as\r\nwell?\r\n\r\nAll memcpy invocations look safe to me. Obviously the code will require care\r\nwhen modified though. I wonder if we could consolidate the memcpy calls to a \r\n(templated?) function to cut down the risk.\r\n\r\nLongterm it may make sense to move to some kind of polymorphic union that can\r\nencompass both `sockaddr_in` and `sockaddr_in6` and doesn't require all the\r\nip4/6 case handling, but that's speculative and in any case the avoidance of UB\r\nseems like a strict improvement here.\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQIzBAEBCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmJYlAUACgkQepNdrbLE\r\nTwVGxg/+NwnQ9FbaWInxv54qFF+X4QWYiOA1JAzPpGBv/Rf0KMbSz/enSsAax0j6\r\nYxwXyXXOMkL0CR//PzCMZqEBpqydOZcSnAE3elINlhySWMhpz0iXxz0SNuCyTnSp\r\nfMl/5RKTvkPvWqYCgHCqM0HmUPwdkSEFi+BHT+B8+kZBZcNgegbXEPiRcQqG6JEJ\r\nqs9Ro0dP9J3oH9khpxfucTkRerHSY3QmL7ZZIbzSazQnhmo/yUP1Q5zZHBsT3hZP\r\nRcDzp0T6RX94/vhT2gSaGRKCYasUbiJ07puEj6q/lfVWwzCBewvR/PseMS3Q5GWF\r\nCj6WpTRiCetq6yeKDkGId4tgGqLEHk1RHpbtzOLbzoJMMR0sclbQjPEkHQy2/qXJ\r\nAsrvh39zWhCZU83KMTxY5tzP66XGtxgXcCmtFjxBjwBa4YcgGezpKYylUVwje7uT\r\nHw2Z+MAZJTgjCyYIhdITs89fcJSbdoSuEekuPXtIgKAAvGmmFGFfGGoM60GonWVY\r\n00PHDw8eKluGMe7cG1PvQI58jWAForZEu9rqfyspBZcbG/l+VVOoKK/EfYnmDcQ1\r\noFJppPouXvX/btgk5uRuNVCrzETlaxCcyRAekdKXh4IC6JmyV9pbS1f+brvOejLx\r\nk+5uV4d8FzkXFQkoOMcrfukQzLq063XROF9oyN/jKww/ojSnSjE=\r\n=kbVB\r\n-----END PGP SIGNATURE-----\r\n\r\n```\r\n\r\n</p></details>\r\n\r\n<details><summary>Show platform data</summary>\r\n<p>\r\n\r\n```\r\nTested on Linux-5.10.0-11-amd64-x86_64-with-glibc2.31\r\n\r\nConfigured with ./configure LDFLAGS=-L/home/james/src/bitcoin/db4/lib/ CPPFLAGS=-I/home/james/src/bitcoin/db4/include/ CXXFLAGS=-fPIE -pipe -O2 -g -Wthread-safety-analysis -Wall -Werror=sign-compare -Wsign-compare -Werror=thread-safety-analysis --enable-wallet --enable-debug --with-daemon --enable-natpmp-default\r\n\r\nCompiled with /usr/bin/ccache /usr/local/bin/clang++ -std=c++17 -mavx -mavx2 -mpclmul -fPIE -pipe -O2 -g -Wthread-safety-analysis -Wall -Werror=sign-compare -Wsign-compare -Werror=thread-safety-analysis -O0 -g3 -ftrapv -fdebug-prefix-map=$(abs_top_srcdir)=.  -Wstack-protector -fstack-protector-all -fcf-protection=full -fstack-clash-protection -msse4.1 -msse4.2 -msse4 -msha  i\r\n\r\nCompiler version: Debian clang version 13.0.1-++20220126092033+75e33f71c2da-1~exp1~20220126212112.63\r\n```\r\n\r\n</p></details>\r\n\r\n",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#pullrequestreview-942829501",
      "submitted_at": "2022-04-14T21:37:51Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24827"
    },
    {
      "event": "commented",
      "id": 1099650812,
      "node_id": "IC_kwDOABII585Bi1b8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1099650812",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-14T21:38:15Z",
      "updated_at": "2022-04-14T21:38:15Z",
      "author_association": "CONTRIBUTOR",
      "body": "By the way, welcome to the project and thanks for the great write-up!",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1099650812",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "commented",
      "id": 1099654795,
      "node_id": "IC_kwDOABII585Bi2aL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1099654795",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-14T21:44:47Z",
      "updated_at": "2022-04-14T21:44:47Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Casting from sockaddr_storage* -> sockaddr* seems precarious, since they're different sizes, but is there some reason you avoided touching those here as well?\r\n\r\nI guess since we're essentially \"upcasting\" in this case (i.e. the mem allocation referenced by `sockaddr_storage` is larger than `sockaddr`, so the cast pointer will never run into unclaimed memory) it's okay to do this cast. Is that right?",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1099654795",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6438289865,
      "node_id": "HRFPE_lADOABII585HiZm6zwAAAAF_wIHJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6438289865",
      "actor": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "e34c6221e1375a94984326679c2a2c88e4441d8a",
      "commit_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/commits/e34c6221e1375a94984326679c2a2c88e4441d8a",
      "created_at": "2022-04-15T02:18:53Z"
    },
    {
      "event": "commented",
      "id": 1099791554,
      "node_id": "IC_kwDOABII585BjXzC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1099791554",
      "actor": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-15T02:23:42Z",
      "updated_at": "2022-04-15T02:23:42Z",
      "author_association": "NONE",
      "body": "The remaining casts to `sockaddr*` are unavoidable and safe because we are calling into the external C APIs which expect us to do that cast.\r\n\r\nGood call on some wrapper functions. I wrote them and I'm a lot happier with the result. Templating didn't work out because  (1) in the load functions I ended up needing to check the protocol type for safety and (2) in general I didn't want to be memcpy'ing into templated types.\r\n\r\nWe'll see how the CI does but I'm really happy with the new state of the PR, think we're in good shape.",
      "user": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1099791554",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6438330630,
      "node_id": "HRFPE_lADOABII585HiZm6zwAAAAF_wSEG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6438330630",
      "actor": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "a8538949fc8c139e181cac2cc4772f15f5e3e165",
      "commit_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/commits/a8538949fc8c139e181cac2cc4772f15f5e3e165",
      "created_at": "2022-04-15T02:34:41Z"
    },
    {
      "event": "commented",
      "id": 1108507849,
      "node_id": "IC_kwDOABII585CEnzJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1108507849",
      "actor": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-25T12:28:35Z",
      "updated_at": "2022-04-25T12:28:35Z",
      "author_association": "NONE",
      "body": "Ping – I know reviewers are busy but it seems like we're really close! 🙏  I just swapped the direct `memcpy`'s out for function wrappers so it's more of a drop-in replacement.",
      "user": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1108507849",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "reviewed",
      "id": 959595146,
      "node_id": "PRR_kwDOABII5845MkKK",
      "url": null,
      "actor": null,
      "commit_id": "a8538949fc8c139e181cac2cc4772f15f5e3e165",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2022-05-02T21:43:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "Looking good, nice changes. I think the new functions you've introduced should help to reduce @laanwj's concerns about `memset`. We could play some code-golf with the patch below to cut down on the number of separate `memset`s, but I think what you have right now in HEAD is a big improvement on the status quo with or without the patch.\r\n\r\n```diff\r\ndiff --git a/src/netaddress.cpp b/src/netaddress.cpp\r\nindex 2569e9e71f..11929f5394 100644\r\n--- a/src/netaddress.cpp\r\n+++ b/src/netaddress.cpp\r\n@@ -1241,52 +1241,34 @@ bool operator<(const CSubNet& a, const CSubNet& b)\r\n     return (a.network < b.network || (a.network == b.network && memcmp(a.netmask, b.netmask, 16) < 0));\r\n }\r\n \r\n-sockaddr_in LoadSockaddrIPv4(const sockaddr& src) {\r\n-    assert(src.sa_family == AF_INET);\r\n+template <typename T>\r\n+static sockaddr_in LoadSockaddrIPv4Internal(const T& src) {\r\n     sockaddr_in s4;\r\n     std::memcpy(&s4, &src, sizeof(s4));\r\n     return s4;\r\n }\r\n+\r\n+sockaddr_in LoadSockaddrIPv4(const sockaddr& src) {\r\n+    assert(src.sa_family == AF_INET);\r\n+    return LoadSockaddrIPv4Internal(src);\r\n+}\r\n sockaddr_in LoadSockaddrIPv4(const sockaddr_storage& src) {\r\n     assert(src.ss_family == AF_INET);\r\n-    sockaddr_in s4;\r\n-    std::memcpy(&s4, &src, sizeof(s4));\r\n-    return s4;\r\n+    return LoadSockaddrIPv4Internal(src);\r\n }\r\n \r\n-sockaddr_in6 LoadSockaddrIPv6(const sockaddr& src) {\r\n-    assert(src.sa_family == AF_INET6);\r\n-    sockaddr_in6 s6;\r\n-    std::memcpy(&s6, &src, sizeof(s6));\r\n-    return s6;\r\n-}\r\n-sockaddr_in6 LoadSockaddrIPv6(const sockaddr_storage& src) {\r\n-    assert(src.ss_family == AF_INET6);\r\n+template <typename T>\r\n+sockaddr_in6 LoadSockaddrIPv6Internal(const T& src) {\r\n     sockaddr_in6 s6;\r\n     std::memcpy(&s6, &src, sizeof(s6));\r\n     return s6;\r\n }\r\n \r\n-void StoreSockaddrIPv4(const sockaddr_in& src, sockaddr* ptr, socklen_t *addrlen) {\r\n-    constexpr size_t sz4 = sizeof(sockaddr_in);\r\n-    assert(*addrlen >= sz4);\r\n-    *addrlen = sz4;\r\n-    std::memcpy(ptr, &src, sz4);\r\n-}\r\n-void StoreSockaddrIPv4(const sockaddr_in& src, sockaddr_storage* ptr, socklen_t *addrlen) {\r\n-    constexpr size_t sz4 = sizeof(sockaddr_in);\r\n-    *addrlen = sz4;\r\n-    std::memcpy(ptr, &src, sz4);\r\n-}\r\n-\r\n-void StoreSockaddrIPv6(const sockaddr_in6& src, sockaddr* ptr, socklen_t *addrlen) {\r\n-    constexpr size_t sz6 = sizeof(sockaddr_in6);\r\n-    assert(*addrlen >= sz6);\r\n-    *addrlen = sz6;\r\n-    std::memcpy(ptr, &src, sz6);\r\n+sockaddr_in6 LoadSockaddrIPv6(const sockaddr& src) {\r\n+    assert(src.sa_family == AF_INET6);\r\n+    return LoadSockaddrIPv6Internal(src);\r\n }\r\n-void StoreSockaddrIPv6(const sockaddr_in6& src, sockaddr_storage* ptr, socklen_t *addrlen) {\r\n-    constexpr size_t sz6 = sizeof(sockaddr_in6);\r\n-    *addrlen = sz6;\r\n-    std::memcpy(ptr, &src, sz6);\r\n+sockaddr_in6 LoadSockaddrIPv6(const sockaddr_storage& src) {\r\n+    assert(src.ss_family == AF_INET6);\r\n+    return LoadSockaddrIPv6Internal(src);\r\n }\r\ndiff --git a/src/netaddress.h b/src/netaddress.h\r\nindex 171653bdbc..254c92e86f 100644\r\n--- a/src/netaddress.h\r\n+++ b/src/netaddress.h\r\n@@ -596,9 +596,25 @@ sockaddr_in6 LoadSockaddrIPv6(const sockaddr_storage& src);\r\n  * Overwrite the provided generic sockaddr struct safely. Use these\r\n  * instead of casting the src and dereferencing it.\r\n  */\r\n-void StoreSockaddrIPv4(const sockaddr_in& src, sockaddr* ptr, socklen_t *addrlen);\r\n-void StoreSockaddrIPv4(const sockaddr_in& src, sockaddr_storage* ptr, socklen_t *addrlen);\r\n-void StoreSockaddrIPv6(const sockaddr_in6& src, sockaddr* ptr, socklen_t *addrlen);\r\n-void StoreSockaddrIPv6(const sockaddr_in6& src, sockaddr_storage* ptr, socklen_t *addrlen);\r\n+template <typename T>\r\n+void StoreSockaddrIPv4(const sockaddr_in& src, T* ptr, socklen_t *addrlen) {\r\n+    constexpr size_t sz4 = sizeof(sockaddr_in);\r\n+\r\n+    if (typeid(T) == typeid(sockaddr)) {\r\n+        assert(*addrlen >= sz4);\r\n+    }\r\n+    *addrlen = sz4;\r\n+    std::memcpy(ptr, &src, sz4);\r\n+}\r\n+\r\n+template <typename T>\r\n+void StoreSockaddrIPv6(const sockaddr_in6& src, T* ptr, socklen_t *addrlen) {\r\n+    constexpr size_t sz6 = sizeof(sockaddr_in6);\r\n+    if (typeid(T) == typeid(sockaddr)) {\r\n+        assert(*addrlen >= sz6);\r\n+    }\r\n+    *addrlen = sz6;\r\n+    std::memcpy(ptr, &src, sz6);\r\n+}\r\n \r\n #endif // BITCOIN_NETADDRESS_H\r\n```",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#pullrequestreview-959595146",
      "submitted_at": "2022-05-02T21:43:33Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24827"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6540692633,
      "node_id": "HRFPE_lADOABII585HiZm6zwAAAAGF2wyZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6540692633",
      "actor": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "5c8ad641cceec2b8e775f4ee96fa9a5a918c38b2",
      "commit_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/commits/5c8ad641cceec2b8e775f4ee96fa9a5a918c38b2",
      "created_at": "2022-05-03T13:23:37Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBiM2FkNzIxNDYyZWQwNjBmYWU5OTFkOGFkMTUxMGNkOTJhNjliZmI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0b3ad721462ed060fae991d8ad1510cd92a69bfb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0b3ad721462ed060fae991d8ad1510cd92a69bfb",
      "tree": {
        "sha": "6f7cba167ed77120430cebb743e1f44472e8bff4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6f7cba167ed77120430cebb743e1f44472e8bff4"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/12455acca2c3adf5c88ae9c1a02a7c192fe0f53b",
          "sha": "12455acca2c3adf5c88ae9c1a02a7c192fe0f53b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/12455acca2c3adf5c88ae9c1a02a7c192fe0f53b"
        }
      ],
      "message": "Fix undefined behavior in socket address handling\n\nFixes #22613\n\nThe fix is pretty simple – it's legal to memcpy between these types, you just can't reference members after a reinterpret_cast. The memcpys will be optimised away in any half decent compiler.\n\nI chose to switch GetSockAddr/SetSockAddr to work with sockaddr_storage so we can be sure we're never reading/writing out of bounds. Essentially, `struct sockaddr*` is old junk that we never want to deal with. Only hand those to the C APIs.",
      "committer": {
        "name": "Adlai Holler",
        "email": "adlai@google.com",
        "date": "2022-05-03T13:31:43Z"
      },
      "author": {
        "name": "Adlai Holler",
        "email": "adlai@google.com",
        "date": "2022-04-11T16:05:24Z"
      },
      "sha": "0b3ad721462ed060fae991d8ad1510cd92a69bfb"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6540757957,
      "node_id": "HRFPE_lADOABII585HiZm6zwAAAAGF3AvF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6540757957",
      "actor": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0b3ad721462ed060fae991d8ad1510cd92a69bfb",
      "commit_url": "https://api.github.com/repos/Adlai-Holler/bitcoin/commits/0b3ad721462ed060fae991d8ad1510cd92a69bfb",
      "created_at": "2022-05-03T13:32:11Z"
    },
    {
      "event": "commented",
      "id": 1116108420,
      "node_id": "IC_kwDOABII585ChnaE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1116108420",
      "actor": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-03T13:37:47Z",
      "updated_at": "2022-05-03T13:37:47Z",
      "author_association": "NONE",
      "body": "Good call @jamesob! I applied your patch and made a few readability changes to keep the diff minimal.",
      "user": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1116108420",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "mentioned",
      "id": 6540805720,
      "node_id": "MEE_lADOABII585HiZm6zwAAAAGF3MZY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6540805720",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-03T13:37:47Z"
    },
    {
      "event": "subscribed",
      "id": 6540805730,
      "node_id": "SE_lADOABII585HiZm6zwAAAAGF3MZi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6540805730",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-03T13:37:47Z"
    },
    {
      "event": "reviewed",
      "id": 982310905,
      "node_id": "PRR_kwDOABII5846jN_5",
      "url": null,
      "actor": null,
      "commit_id": "0b3ad721462ed060fae991d8ad1510cd92a69bfb",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2022-05-24T13:44:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK 0b3ad721462ed060fae991d8ad1510cd92a69bfb ([`jamesob/ackr/24827.3.Adlai-Holler.net_fix_undefined_behavi`](https://github.com/jamesob/bitcoin/tree/ackr/24827.3.Adlai-Holler.net_fix_undefined_behavi))\r\n\r\nReviewed, ran functional tests locally. Seems like a clear win to avoid UB, and probably improves readability too.\r\n\r\n<details><summary>Show signature data</summary>\r\n<p>\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nACK 0b3ad721462ed060fae991d8ad1510cd92a69bfb ([`jamesob/ackr/24827.3.Adlai-Holler.net_fix_undefined_behavi`](https://github.com/jamesob/bitcoin/tree/ackr/24827.3.Adlai-Holler.net_fix_undefined_behavi))\r\n\r\nReviewed, ran functional tests locally. Seems like a clear win to avoid UB, and probably readability too.\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQIzBAEBCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmKM4SgACgkQepNdrbLE\r\nTwUcqw/7BsjxUtnuJOQm3Lrev+KaKWgPVkPEgCammTzG9j+DwHiRnByEGxIKnWHF\r\nGwhqiK3asXhokUH6wtmEyCdoAFzad3IYkbMOGIL6vX+2RR3mAPlP6arCcZ4goHz6\r\ncP0m/IIHhhoMVL2wT72puQgWXH5bQJPxRxq/W6GWIs+xHt5BJCPmCg9EAPfchWNu\r\niJMy1nJGHrktKAMQXNAxhMUy33rhyfang1s9LgGmOJt3NV1QGW5rCope0YgyWyQX\r\nZZTAJpp1F56SYfldDbSwxoZ7HyIsn0GBxQe+kUIyA8P37QKWx8seQo4mF7MT7c+g\r\nitZePca2ztFVg7PXRqyAeV2qCBIDXJFlCTWFWKP+0Qv9daRMHuuLqywM6/njinJN\r\ntQ1Dr6zaeCytvO+B3TSF98uq/GnGdzBSpEWzywGYEiL8xI4O9s/63QASUr/Fs3tE\r\nxwwenHpASN0mCBkndmnBs5Ec3+rE5RYRdxh2XPhH0N5A0y7E2L76os+tlbstXxeX\r\n/GFaP5ebxfPzpEU+CEzScmSWL/vVI5H3oS6LTHr8pZucYmrD2WO9YBOx74oE1asP\r\nOT0IOsLmhpaEDcq62IarscW36S+nMYBx77T1wF18l0jgX9kr467P7Z7o1DFMYrJI\r\nXvyi3GzFx5Dh4IKDca34K3lXlFIo60VQqWEwpNW3byvxWyRzyOk=\r\n=NNys\r\n-----END PGP SIGNATURE-----\r\n\r\n```\r\n\r\n</p></details>\r\n\r\n<details><summary>Show platform data</summary>\r\n<p>\r\n\r\n```\r\nTested on Linux-5.10.0-11-amd64-x86_64-with-glibc2.31\r\n\r\nConfigured with ./configure LDFLAGS=-L/home/james/src/bitcoin/db4/lib/ CPPFLAGS=-I/home/james/src/bitcoin/db4/include/ CXXFLAGS=-fPIE -pipe -O2 -g -Wthread-safety-analysis -Wall -Werror=sign-compare -Wsign-compare -Werror=thread-safety-analysis --enable-wallet --enable-debug --with-daemon --enable-natpmp-default CXX=/usr/local/bin/clang++ CC=/usr/local/bin/clang PYTHONPATH= --disable-shared --with-pic --enable-benchmark=no --enable-module-recovery --enable-module-schnorrsig --disable-shared --with-pic --enable-benchmark=no --enable-module-recovery --enable-module-schnorrsig --no-create --no-recursion\r\n\r\nCompiled with /usr/bin/ccache /usr/local/bin/clang++ -std=c++17 -mavx -mavx2 -mpclmul -fPIE -pipe -O2 -g -Wthread-safety-analysis -Wall -Werror=sign-compare -Wsign-compare -Werror=thread-safety-analysis -O0 -g3 -ftrapv -fdebug-prefix-map=$(abs_top_srcdir)=.  -Wstack-protector -fstack-protector-all -fcf-protection=full -fstack-clash-protection -msse4.1 -msse4.2 -msse4 -msha  i\r\n\r\nCompiler version: Debian clang version 13.0.1-++20220126092033+75e33f71c2da-1~exp1~20220126212112.63\r\n```\r\n\r\n</p></details>\r\n\r\n",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#pullrequestreview-982310905",
      "submitted_at": "2022-05-24T13:44:46Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24827"
    },
    {
      "event": "commented",
      "id": 1136259385,
      "node_id": "IC_kwDOABII585DufE5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1136259385",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-24T17:49:33Z",
      "updated_at": "2022-05-24T17:49:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\n🐙 This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1136259385",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "labeled",
      "id": 6671242895,
      "node_id": "LE_lADOABII585HiZm6zwAAAAGNoxaP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6671242895",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-24T17:49:33Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1181979058,
      "node_id": "IC_kwDOABII585Gc5Gy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181979058",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-12T16:21:30Z",
      "updated_at": "2022-07-12T16:21:30Z",
      "author_association": "CONTRIBUTOR",
      "body": "What about using _placement new_ to change the dynamic type of the object?\r\n\r\nCorrect me if I am wrong, if we have:\r\n\r\n```cpp\r\nstruct S1 {\r\n    int x;\r\n};\r\n\r\nstruct S2 {\r\n    int x;\r\n};\r\n\r\nS1 s1;\r\nS2* s2_ptr = reinterpret_cast<S2*>(&s1);\r\ns2_ptr->x = 5; // UB because the S1 object is accessed as S2\r\n```\r\n\r\nbut the following is ok because it changes the dynamic type of the object to S2:\r\n\r\n```cpp\r\nS1 s1;\r\nS2* s2_ptr = new (&s1) S2;\r\ns2_ptr->x = 5; // ok\r\n```\r\n\r\nHere is an alternative patch that uses that approach. It is much smaller because it just replaces e.g. `(sockaddr_in*)foo` with `SockAddrCast<sockaddr_in>(foo)`:\r\n\r\n<details>\r\n<summary>[patch] placement new typecast</summary>\r\n\r\n```diff\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex c37d90519c..b3265dc5dc 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -427,13 +427,13 @@ static CAddress GetBindAddress(const Sock& sock)\r\n {\r\n     CAddress addr_bind;\r\n     struct sockaddr_storage sockaddr_bind;\r\n     socklen_t sockaddr_bind_len = sizeof(sockaddr_bind);\r\n     if (sock.Get() != INVALID_SOCKET) {\r\n         if (!sock.GetSockName((struct sockaddr*)&sockaddr_bind, &sockaddr_bind_len)) {\r\n-            addr_bind.SetSockAddr((const struct sockaddr*)&sockaddr_bind);\r\n+            addr_bind.SetSockAddr(sockaddr_bind);\r\n         } else {\r\n             LogPrintLevel(BCLog::NET, BCLog::Level::Warning, \"getsockname failed\\n\");\r\n         }\r\n     }\r\n     return addr_bind;\r\n }\r\n@@ -920,13 +920,13 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\r\n         if (nErr != WSAEWOULDBLOCK) {\r\n             LogPrintf(\"socket error accept failed: %s\\n\", NetworkErrorString(nErr));\r\n         }\r\n         return;\r\n     }\r\n \r\n-    if (!addr.SetSockAddr((const struct sockaddr*)&sockaddr)) {\r\n+    if (!addr.SetSockAddr(sockaddr)) {\r\n         LogPrintLevel(BCLog::NET, BCLog::Level::Warning, \"Unknown socket family\\n\");\r\n     } else {\r\n         addr = CAddress{MaybeFlipIPv6toCJDNS(addr), NODE_NONE};\r\n     }\r\n \r\n     const CAddress addr_bind{MaybeFlipIPv6toCJDNS(GetBindAddress(*sock)), NODE_NONE};\r\n@@ -2056,13 +2056,13 @@ bool CConnman::BindListenPort(const CService& addrBind, bilingual_str& strError,\r\n {\r\n     int nOne = 1;\r\n \r\n     // Create socket for listening for incoming connections\r\n     struct sockaddr_storage sockaddr;\r\n     socklen_t len = sizeof(sockaddr);\r\n-    if (!addrBind.GetSockAddr((struct sockaddr*)&sockaddr, &len))\r\n+    if (!addrBind.GetSockAddr(&sockaddr, &len))\r\n     {\r\n         strError = strprintf(Untranslated(\"Bind address family for %s not supported\"), addrBind.ToString());\r\n         LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"%s\\n\", strError.original);\r\n         return false;\r\n     }\r\n \r\n@@ -2151,21 +2151,19 @@ void Discover()\r\n             if (ifa->ifa_addr == nullptr) continue;\r\n             if ((ifa->ifa_flags & IFF_UP) == 0) continue;\r\n             if (strcmp(ifa->ifa_name, \"lo\") == 0) continue;\r\n             if (strcmp(ifa->ifa_name, \"lo0\") == 0) continue;\r\n             if (ifa->ifa_addr->sa_family == AF_INET)\r\n             {\r\n-                struct sockaddr_in* s4 = (struct sockaddr_in*)(ifa->ifa_addr);\r\n-                CNetAddr addr(s4->sin_addr);\r\n+                CNetAddr addr(SockAddrCast<sockaddr_in>(ifa->ifa_addr)->sin_addr);\r\n                 if (AddLocal(addr, LOCAL_IF))\r\n                     LogPrintf(\"%s: IPv4 %s: %s\\n\", __func__, ifa->ifa_name, addr.ToString());\r\n             }\r\n             else if (ifa->ifa_addr->sa_family == AF_INET6)\r\n             {\r\n-                struct sockaddr_in6* s6 = (struct sockaddr_in6*)(ifa->ifa_addr);\r\n-                CNetAddr addr(s6->sin6_addr);\r\n+                CNetAddr addr(SockAddrCast<sockaddr_in6>(ifa->ifa_addr)->sin6_addr);\r\n                 if (AddLocal(addr, LOCAL_IF))\r\n                     LogPrintf(\"%s: IPv6 %s: %s\\n\", __func__, ifa->ifa_name, addr.ToString());\r\n             }\r\n         }\r\n         freeifaddrs(myaddrs);\r\n     }\r\ndiff --git a/src/netaddress.cpp b/src/netaddress.cpp\r\nindex ca148bfa51..b997dc6ee9 100644\r\n--- a/src/netaddress.cpp\r\n+++ b/src/netaddress.cpp\r\n@@ -831,20 +831,20 @@ CService::CService(const struct sockaddr_in& addr) : CNetAddr(addr.sin_addr), po\r\n \r\n CService::CService(const struct sockaddr_in6 &addr) : CNetAddr(addr.sin6_addr, addr.sin6_scope_id), port(ntohs(addr.sin6_port))\r\n {\r\n    assert(addr.sin6_family == AF_INET6);\r\n }\r\n \r\n-bool CService::SetSockAddr(const struct sockaddr *paddr)\r\n+bool CService::SetSockAddr(const sockaddr_storage& addr)\r\n {\r\n-    switch (paddr->sa_family) {\r\n+    switch (addr.ss_family) {\r\n     case AF_INET:\r\n-        *this = CService(*(const struct sockaddr_in*)paddr);\r\n+        *this = CService(*SockAddrCast<sockaddr_in>(&addr));\r\n         return true;\r\n     case AF_INET6:\r\n-        *this = CService(*(const struct sockaddr_in6*)paddr);\r\n+        *this = CService(*SockAddrCast<sockaddr_in6>(&addr));\r\n         return true;\r\n     default:\r\n         return false;\r\n     }\r\n }\r\n \r\n@@ -872,32 +872,32 @@ bool operator<(const CService& a, const CService& b)\r\n  *                        parameter might change after calling this function if\r\n  *                        the size of the corresponding address structure\r\n  *                        changed.\r\n  *\r\n  * @returns Whether or not the operation was successful.\r\n  */\r\n-bool CService::GetSockAddr(struct sockaddr* paddr, socklen_t *addrlen) const\r\n+bool CService::GetSockAddr(struct sockaddr_storage* paddr, socklen_t* addrlen) const\r\n {\r\n+    memset(paddr, 0x0, *addrlen);\r\n+\r\n     if (IsIPv4()) {\r\n         if (*addrlen < (socklen_t)sizeof(struct sockaddr_in))\r\n             return false;\r\n         *addrlen = sizeof(struct sockaddr_in);\r\n-        struct sockaddr_in *paddrin = (struct sockaddr_in*)paddr;\r\n-        memset(paddrin, 0, *addrlen);\r\n+        sockaddr_in* paddrin = SockAddrCast<sockaddr_in>(paddr);\r\n         if (!GetInAddr(&paddrin->sin_addr))\r\n             return false;\r\n         paddrin->sin_family = AF_INET;\r\n         paddrin->sin_port = htons(port);\r\n         return true;\r\n     }\r\n     if (IsIPv6() || IsCJDNS()) {\r\n         if (*addrlen < (socklen_t)sizeof(struct sockaddr_in6))\r\n             return false;\r\n         *addrlen = sizeof(struct sockaddr_in6);\r\n-        struct sockaddr_in6 *paddrin6 = (struct sockaddr_in6*)paddr;\r\n-        memset(paddrin6, 0, *addrlen);\r\n+        sockaddr_in6* paddrin6 = SockAddrCast<sockaddr_in6>(paddr);\r\n         if (!GetIn6Addr(&paddrin6->sin6_addr))\r\n             return false;\r\n         paddrin6->sin6_scope_id = m_scope_id;\r\n         paddrin6->sin6_family = AF_INET6;\r\n         paddrin6->sin6_port = htons(port);\r\n         return true;\r\ndiff --git a/src/netaddress.h b/src/netaddress.h\r\nindex 47ba045334..e286b93a41 100644\r\n--- a/src/netaddress.h\r\n+++ b/src/netaddress.h\r\n@@ -525,14 +525,14 @@ protected:\r\n public:\r\n     CService();\r\n     CService(const CNetAddr& ip, uint16_t port);\r\n     CService(const struct in_addr& ipv4Addr, uint16_t port);\r\n     explicit CService(const struct sockaddr_in& addr);\r\n     uint16_t GetPort() const;\r\n-    bool GetSockAddr(struct sockaddr* paddr, socklen_t* addrlen) const;\r\n-    bool SetSockAddr(const struct sockaddr* paddr);\r\n+    bool GetSockAddr(sockaddr_storage* paddr, socklen_t* addrlen) const;\r\n+    bool SetSockAddr(const sockaddr_storage& addr);\r\n     friend bool operator==(const CService& a, const CService& b);\r\n     friend bool operator!=(const CService& a, const CService& b) { return !(a == b); }\r\n     friend bool operator<(const CService& a, const CService& b);\r\n     std::vector<unsigned char> GetKey() const;\r\n     std::string ToString() const;\r\n     std::string ToStringPort() const;\r\n@@ -573,7 +573,36 @@ public:\r\n \r\n private:\r\n     const uint64_t m_salt_k0;\r\n     const uint64_t m_salt_k1;\r\n };\r\n \r\n+/**\r\n+ * Cast sockaddr or sockaddr_storage to sockaddr_in or sockaddr_in6.\r\n+ * This is as safe as the traditional typecast:\r\n+ * @code{.cpp}\r\n+ * sockaddr_storage from;\r\n+ * sockaddr_in* to_ptr = (sockaddr_in*)&from;\r\n+ * to_ptr->sin_family = ...\r\n+ * @endcode\r\n+ * except that it avoids the undefined behavior of the last line above by not\r\n+ * breaking the strict aliasing rules.\r\n+ * Placement new changes the dynamic type of the object to `To`, so that it is\r\n+ * safe to access it as `To` afterwards.\r\n+ */\r\n+template <typename To, typename From>\r\n+static inline To* SockAddrCast(const From* ptr)\r\n+{\r\n+    // Make sure nobody abuses this function for other types.\r\n+    static_assert(\r\n+        std::is_same<From, sockaddr>::value ||\r\n+        std::is_same<From, sockaddr_storage>::value);\r\n+    static_assert(\r\n+        std::is_same<To, sockaddr_in>::value ||\r\n+        std::is_same<To, sockaddr_in6>::value);\r\n+    // Make sure that the placement new will not modify the memory pointed by `ptr`.\r\n+    static_assert(std::is_trivially_default_constructible<To>::value);\r\n+\r\n+    return new (const_cast<From*>(ptr)) To;\r\n+}\r\n+\r\n #endif // BITCOIN_NETADDRESS_H\r\ndiff --git a/src/netbase.cpp b/src/netbase.cpp\r\nindex 030f462ed9..ca59230034 100644\r\n--- a/src/netbase.cpp\r\n+++ b/src/netbase.cpp\r\n@@ -65,17 +65,17 @@ std::vector<CNetAddr> WrappedGetAddrInfo(const std::string& name, bool allow_loo\r\n     // Traverse the linked list starting with ai_trav.\r\n     addrinfo* ai_trav{ai_res};\r\n     std::vector<CNetAddr> resolved_addresses;\r\n     while (ai_trav != nullptr) {\r\n         if (ai_trav->ai_family == AF_INET) {\r\n             assert(ai_trav->ai_addrlen >= sizeof(sockaddr_in));\r\n-            resolved_addresses.emplace_back(reinterpret_cast<sockaddr_in*>(ai_trav->ai_addr)->sin_addr);\r\n+            resolved_addresses.emplace_back(SockAddrCast<sockaddr_in>(ai_trav->ai_addr)->sin_addr);\r\n         }\r\n         if (ai_trav->ai_family == AF_INET6) {\r\n             assert(ai_trav->ai_addrlen >= sizeof(sockaddr_in6));\r\n-            const sockaddr_in6* s6{reinterpret_cast<sockaddr_in6*>(ai_trav->ai_addr)};\r\n+            const sockaddr_in6* s6 = SockAddrCast<sockaddr_in6>(ai_trav->ai_addr);\r\n             resolved_addresses.emplace_back(s6->sin6_addr, s6->sin6_scope_id);\r\n         }\r\n         ai_trav = ai_trav->ai_next;\r\n     }\r\n     freeaddrinfo(ai_res);\r\n \r\n@@ -485,13 +485,13 @@ bool Socks5(const std::string& strDest, uint16_t port, const ProxyCredentials* a\r\n \r\n std::unique_ptr<Sock> CreateSockTCP(const CService& address_family)\r\n {\r\n     // Create a sockaddr from the specified service.\r\n     struct sockaddr_storage sockaddr;\r\n     socklen_t len = sizeof(sockaddr);\r\n-    if (!address_family.GetSockAddr((struct sockaddr*)&sockaddr, &len)) {\r\n+    if (!address_family.GetSockAddr(&sockaddr, &len)) {\r\n         LogPrintf(\"Cannot create socket for %s: unsupported network\\n\", address_family.ToString());\r\n         return nullptr;\r\n     }\r\n \r\n     // Create a TCP socket in the address family of the specified service.\r\n     SOCKET hSocket = socket(((struct sockaddr*)&sockaddr)->sa_family, SOCK_STREAM, IPPROTO_TCP);\r\n@@ -550,13 +550,13 @@ bool ConnectSocketDirectly(const CService &addrConnect, const Sock& sock, int nT\r\n     struct sockaddr_storage sockaddr;\r\n     socklen_t len = sizeof(sockaddr);\r\n     if (sock.Get() == INVALID_SOCKET) {\r\n         LogPrintf(\"Cannot connect to %s: invalid socket\\n\", addrConnect.ToString());\r\n         return false;\r\n     }\r\n-    if (!addrConnect.GetSockAddr((struct sockaddr*)&sockaddr, &len)) {\r\n+    if (!addrConnect.GetSockAddr(&sockaddr, &len)) {\r\n         LogPrintf(\"Cannot connect to %s: unsupported network\\n\", addrConnect.ToString());\r\n         return false;\r\n     }\r\n \r\n     // Connect to the addrConnect service on the hSocket socket.\r\n     if (sock.Connect(reinterpret_cast<struct sockaddr*>(&sockaddr), len) == SOCKET_ERROR) {\r\ndiff --git a/src/test/util/net.h b/src/test/util/net.h\r\nindex 34ab9958c6..eb4c283cf8 100644\r\n--- a/src/test/util/net.h\r\n+++ b/src/test/util/net.h\r\n@@ -132,13 +132,13 @@ public:\r\n         if (addr != nullptr) {\r\n             // Pretend all connections come from 5.5.5.5:6789\r\n             memset(addr, 0x00, *addr_len);\r\n             const socklen_t write_len = static_cast<socklen_t>(sizeof(sockaddr_in));\r\n             if (*addr_len >= write_len) {\r\n                 *addr_len = write_len;\r\n-                sockaddr_in* addr_in = reinterpret_cast<sockaddr_in*>(addr);\r\n+                sockaddr_in* addr_in = SockAddrCast<sockaddr_in>(addr);\r\n                 addr_in->sin_family = AF_INET;\r\n                 memset(&addr_in->sin_addr, 0x05, sizeof(addr_in->sin_addr));\r\n                 addr_in->sin_port = htons(6789);\r\n             }\r\n         }\r\n         return std::make_unique<StaticContentsSock>(\"\");\r\ndiff --git a/src/torcontrol.cpp b/src/torcontrol.cpp\r\nindex d6e792a55f..c9b6fc289f 100644\r\n--- a/src/torcontrol.cpp\r\n+++ b/src/torcontrol.cpp\r\n@@ -137,13 +137,13 @@ bool TorControlConnection::Connect(const std::string& tor_control_center, const\r\n         LogPrintf(\"tor: Failed to look up control center %s\\n\", tor_control_center);\r\n         return false;\r\n     }\r\n \r\n     struct sockaddr_storage control_address;\r\n     socklen_t control_address_len = sizeof(control_address);\r\n-    if (!control_service.GetSockAddr(reinterpret_cast<struct sockaddr*>(&control_address), &control_address_len)) {\r\n+    if (!control_service.GetSockAddr(&control_address, &control_address_len)) {\r\n         LogPrintf(\"tor: Error parsing socket address %s\\n\", tor_control_center);\r\n         return false;\r\n     }\r\n \r\n     // Create a new socket, set up callbacks and enable notification bits\r\n     b_conn = bufferevent_socket_new(base, -1, BEV_OPT_CLOSE_ON_FREE);\r\n```\r\n\r\n</details>\r\n",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1181979058",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "commented",
      "id": 1184196333,
      "node_id": "IC_kwDOABII585GlWbt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1184196333",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-14T09:09:58Z",
      "updated_at": "2022-07-14T09:13:31Z",
      "author_association": "CONTRIBUTOR",
      "body": "> The remaining casts to `sockaddr*` are unavoidable and safe because we are calling into the external C APIs which expect us to do that cast.\r\n\r\nI understand the \"unavoidable\" but I don't understand the \"safe\". Do you mean that it is safe just because it goes to external C API? I made the following experiment which shows the opposite (both with gcc 12 and clang 15):\r\n\r\n* `s.h`\r\n```cpp\r\nstruct S1 {\r\n    int x;\r\n};\r\n\r\nstruct S2 {\r\n    int x;\r\n};\r\n```\r\n\r\n* `f.c`\r\n```c\r\n#include \"s.h\"\r\n\r\nint f(struct S1* s1, struct S2* s2)\r\n{\r\n    s1->x = 5;\r\n    s2->x = 6;\r\n    return s1->x;\r\n}\r\n```\r\n\r\n* `main.cc`\r\n```cpp\r\n#include \"s.h\"\r\n\r\nextern \"C\" int f(S1*, S2*);\r\n\r\nint main(int, char**)\r\n{\r\n    S1 s1;\r\n    std::cout << f(&s1, (S2*)&s1) << std::endl;\r\n    return 0;\r\n}\r\n```\r\n\r\nCompile with `-O3` and `5` is printed. Change the type of the second argument to `S1` and `6` is printed.\r\n\r\nI think the `bind(2)` API, strictly speaking implies UB, but it is safe because the `bind()` function never does something like the above, nor we do before passing it the argument.\r\n\r\nThere is an example in [`bind(2)`](https://linux.die.net/man/2/bind) which interprets `sockaddr_un` as `sockaddr` - that is also UB according to the standard of strict aliasing rules<sup>[1](https://gist.github.com/shafik/848ae25ee209f698763cffee272a58f8)</sup> <sup>[2](https://developers.redhat.com/blog/2020/06/02/the-joys-and-perils-of-c-and-c-aliasing-part-1)</sup>, right? What about `memcpy()` where we cast anything to `void*`, also UB?\r\n",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1184196333",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "commented",
      "id": 1206480120,
      "node_id": "IC_kwDOABII585H6Wz4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1206480120",
      "actor": {
        "login": "adamjonas",
        "id": 755825,
        "node_id": "MDQ6VXNlcjc1NTgyNQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/755825?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adamjonas",
        "html_url": "https://github.com/adamjonas",
        "followers_url": "https://api.github.com/users/adamjonas/followers",
        "following_url": "https://api.github.com/users/adamjonas/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/adamjonas/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/adamjonas/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/adamjonas/subscriptions",
        "organizations_url": "https://api.github.com/users/adamjonas/orgs",
        "repos_url": "https://api.github.com/users/adamjonas/repos",
        "events_url": "https://api.github.com/users/adamjonas/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/adamjonas/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-05T13:49:07Z",
      "updated_at": "2022-08-05T13:49:07Z",
      "author_association": "MEMBER",
      "body": "@Adlai-Holler mind rebasing?",
      "user": {
        "login": "adamjonas",
        "id": 755825,
        "node_id": "MDQ6VXNlcjc1NTgyNQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/755825?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adamjonas",
        "html_url": "https://github.com/adamjonas",
        "followers_url": "https://api.github.com/users/adamjonas/followers",
        "following_url": "https://api.github.com/users/adamjonas/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/adamjonas/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/adamjonas/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/adamjonas/subscriptions",
        "organizations_url": "https://api.github.com/users/adamjonas/orgs",
        "repos_url": "https://api.github.com/users/adamjonas/repos",
        "events_url": "https://api.github.com/users/adamjonas/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/adamjonas/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1206480120",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "mentioned",
      "id": 7136085819,
      "node_id": "MEE_lADOABII585HiZm6zwAAAAGpWAc7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7136085819",
      "actor": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-05T13:49:07Z"
    },
    {
      "event": "subscribed",
      "id": 7136085827,
      "node_id": "SE_lADOABII585HiZm6zwAAAAGpWAdD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7136085827",
      "actor": {
        "login": "Adlai-Holler",
        "id": 2466893,
        "node_id": "MDQ6VXNlcjI0NjY4OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2466893?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Adlai-Holler",
        "html_url": "https://github.com/Adlai-Holler",
        "followers_url": "https://api.github.com/users/Adlai-Holler/followers",
        "following_url": "https://api.github.com/users/Adlai-Holler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Adlai-Holler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Adlai-Holler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Adlai-Holler/subscriptions",
        "organizations_url": "https://api.github.com/users/Adlai-Holler/orgs",
        "repos_url": "https://api.github.com/users/Adlai-Holler/repos",
        "events_url": "https://api.github.com/users/Adlai-Holler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Adlai-Holler/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-05T13:49:08Z"
    },
    {
      "event": "commented",
      "id": 1206489590,
      "node_id": "IC_kwDOABII585H6ZH2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1206489590",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-05T13:58:53Z",
      "updated_at": "2022-08-05T13:58:53Z",
      "author_association": "MEMBER",
      "body": "Concept ACK on fixing UB here (and getting rid of these reinterpret_casts).",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1206489590",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "commented",
      "id": 1276621345,
      "node_id": "IC_kwDOABII585MF7Ih",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1276621345",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-12T19:10:03Z",
      "updated_at": "2022-10-12T19:10:03Z",
      "author_association": "MEMBER",
      "body": "Are you still working on this?",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1276621345",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "commented",
      "id": 1310621396,
      "node_id": "IC_kwDOABII585OHn7U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1310621396",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-10T17:13:47Z",
      "updated_at": "2022-11-10T17:13:47Z",
      "author_association": "MEMBER",
      "body": "Closing this as it has not had any activity in a while. If you are interested in continuing work on this, please leave a comment so that it can be reopened.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#issuecomment-1310621396",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24827"
    },
    {
      "event": "closed",
      "id": 7785420836,
      "node_id": "CE_lADOABII585HiZm6zwAAAAHQDBgk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7785420836",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-10T17:13:47Z"
    },
    {
      "event": "labeled",
      "id": 8719600932,
      "node_id": "LE_lADOABII585HiZm6zwAAAAIHuo0k",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8719600932",
      "actor": {
        "login": "adamjonas",
        "id": 755825,
        "node_id": "MDQ6VXNlcjc1NTgyNQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/755825?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adamjonas",
        "html_url": "https://github.com/adamjonas",
        "followers_url": "https://api.github.com/users/adamjonas/followers",
        "following_url": "https://api.github.com/users/adamjonas/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/adamjonas/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/adamjonas/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/adamjonas/subscriptions",
        "organizations_url": "https://api.github.com/users/adamjonas/orgs",
        "repos_url": "https://api.github.com/users/adamjonas/repos",
        "events_url": "https://api.github.com/users/adamjonas/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/adamjonas/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-10T15:58:12Z",
      "label": {
        "name": "Up for grabs",
        "color": "99a810"
      }
    },
    {
      "event": "locked",
      "id": 12063079737,
      "node_id": "LOE_lADOABII585HiZm6zwAAAALPA_05",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12063079737",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-09T12:37:35Z"
    },
    {
      "event": "unlabeled",
      "id": 20406281311,
      "node_id": "UNLE_lADOABII585HiZm6zwAAAATATyRf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20406281311",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-21T14:12:25Z",
      "label": {
        "name": "Up for grabs",
        "color": "99a810"
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/879840712",
      "pull_request_review_id": 982310905,
      "id": 879840712,
      "node_id": "PRRC_kwDOABII5840cU3I",
      "diff_hunk": "@@ -68,12 +68,13 @@ std::vector<CNetAddr> WrappedGetAddrInfo(const std::string& name, bool allow_loo\n     while (ai_trav != nullptr) {\n         if (ai_trav->ai_family == AF_INET) {\n             assert(ai_trav->ai_addrlen >= sizeof(sockaddr_in));\n-            resolved_addresses.emplace_back(reinterpret_cast<sockaddr_in*>(ai_trav->ai_addr)->sin_addr);\n+            struct sockaddr_in s4 = LoadSockaddrIPv4(*ai_trav->ai_addr);\n+            resolved_addresses.emplace_back(s4.sin_addr);\n         }\n         if (ai_trav->ai_family == AF_INET6) {\n             assert(ai_trav->ai_addrlen >= sizeof(sockaddr_in6));\n-            const sockaddr_in6* s6{reinterpret_cast<sockaddr_in6*>(ai_trav->ai_addr)};\n-            resolved_addresses.emplace_back(s6->sin6_addr, s6->sin6_scope_id);\n+            struct sockaddr_in6 s6 = LoadSockaddrIPv6(*ai_trav->ai_addr);",
      "path": "src/netbase.cpp",
      "position": 12,
      "original_position": 12,
      "commit_id": "0b3ad721462ed060fae991d8ad1510cd92a69bfb",
      "original_commit_id": "0b3ad721462ed060fae991d8ad1510cd92a69bfb",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Could be marked const.",
      "created_at": "2022-05-23T20:28:17Z",
      "updated_at": "2022-05-24T13:44:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24827#discussion_r879840712",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/879840712"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24827"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 76,
      "original_line": 76,
      "side": "RIGHT"
    }
  ]
}