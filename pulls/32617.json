{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32617",
    "id": 2543342215,
    "node_id": "PR_kwDOABII586XmFKH",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/32617",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/32617.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/32617.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32617",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32617/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32617/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32617/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/49358730b1d862f1d470dcabd0e8900fc7ef1775",
    "number": 32617,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "[Draft/POC] Add secp256k1-based HPKE (Hybrid Public Key Encryption) For Payjoin v2",
    "user": {
      "login": "w0xlt",
      "id": 94266259,
      "node_id": "U_kgDOBZ5jkw",
      "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/w0xlt",
      "html_url": "https://github.com/w0xlt",
      "followers_url": "https://api.github.com/users/w0xlt/followers",
      "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
      "organizations_url": "https://api.github.com/users/w0xlt/orgs",
      "repos_url": "https://api.github.com/users/w0xlt/repos",
      "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/w0xlt/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "This PR introduces an implementation of Hybrid Public Key Encryption (HPKE) using a secp256k1-based Diffie-Hellman KEM (per RFC 9180 and \"secp256k1-based DHKEM for HPKE\" specification). It provides the core cryptographic component needed to enable the Payjoin v2 protocol.\r\n\r\nThis is an exploratory PR intended to kickstart discussion on adding Payjoin v2 support to Bitcoin Core â€“ feedback and reviews are very welcome.\r\n\r\nPayjoin v2 makes use of a protocol called Oblivious HTTP (OHTTP) to strip client-identifying metadata from the request. This protocol use a binary-encoded HTTP message encapsulated through HPKE.\r\n\r\nThe core implementation is contained in the new files `src/dhkem_secp256k1.h` and `src/dhkem_secp256k1.cpp`:\r\n\r\n* Full HPKE Modes: All four HPKE modes are supported â€“ `Base`, `PSK`, `Auth`, and `AuthPSK`.\r\n* Secp256k1 DHKEM: Uses secp256k1 for Diffie-Hellman key exchange. The `Encap()` and `Decap()` functions perform the base mode KEM (ephemeral ECDH using the receiverâ€™s public key), while `AuthEncap()` and `AuthDecap()` extend this to authenticated mode (including the senderâ€™s static key in the shared secret derivation). Internally, the shared secret is derived as specified by HPKE using HKDF (SHA256) extraction and expansion.\r\n* Key Schedule & Nonce Derivation: After KEM, the implementation runs the HPKE key schedule to derive the `encryption key`, `base nonce`, and `exporter secret`. It follows RFC 9180 Â§7.1, hashing the `info` and `psk_id` contexts and deriving the AEAD key and nonce. Per-message nonces are computed by XOR-ing the base nonce with a message sequence number as specified in RFC 9180 Â§5.2.\r\n* AEAD Encryption (ChaCha20-Poly1305): The HPKE context uses `ChaCha20-Poly1305` as the authenticated encryption scheme. The code provides `Seal()` and `Open()` functions to encrypt and decrypt data using the derived context key and a given nonce. It uses Bitcoin Coreâ€™s existing ChaCha20Poly1305 implementation.\r\n\r\nThe test file validates all the functions mentioned above: Encapsulation/Decapsulation, Encryption/Decryption, Nonce and Key Schedule Logic. This uses the PDK (Payjoin Dev Kit) test vectors. The tests also show how to use the HPKE functions.\r\n\r\nThis implementation only uses HKDF-SHA256 as Key Derivation Functions and ChaCha20-Poly1305 as AEAD, since these already exist in the Bitcoin Core codebase. It does not support other KDFs (such as HKDF-SHA384 and HKDF-SHA512) or other AEADs (such as AES-128-GCM and AES-256-GCM).\r\n\r\nTo run the tests:\r\n`build/bin/test_bitcoin --log_level=all --run_test=dhkem_secp256k1_tests`",
    "labels": [],
    "created_at": "2025-05-26T08:04:21Z",
    "updated_at": "2026-01-14T16:38:09Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "4da8b6fc8abf4c7d99b37019ee8d10ef701cfc55",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "w0xlt:secp256k1_hpke",
      "ref": "secp256k1_hpke",
      "sha": "49358730b1d862f1d470dcabd0e8900fc7ef1775",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 427811926,
        "node_id": "R_kgDOGX_kVg",
        "name": "bitcoin",
        "full_name": "w0xlt/bitcoin",
        "owner": {
          "login": "w0xlt",
          "id": 94266259,
          "node_id": "U_kgDOBZ5jkw",
          "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/w0xlt",
          "html_url": "https://github.com/w0xlt",
          "followers_url": "https://api.github.com/users/w0xlt/followers",
          "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
          "organizations_url": "https://api.github.com/users/w0xlt/orgs",
          "repos_url": "https://api.github.com/users/w0xlt/repos",
          "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/w0xlt/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/w0xlt/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/w0xlt/bitcoin",
        "archive_url": "https://api.github.com/repos/w0xlt/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/w0xlt/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/w0xlt/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/w0xlt/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/w0xlt/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/w0xlt/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/w0xlt/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/w0xlt/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/w0xlt/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/w0xlt/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/w0xlt/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/w0xlt/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/w0xlt/bitcoin/events",
        "forks_url": "https://api.github.com/repos/w0xlt/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/w0xlt/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/w0xlt/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/w0xlt/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/w0xlt/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/w0xlt/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/w0xlt/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/w0xlt/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/w0xlt/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/w0xlt/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/w0xlt/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/w0xlt/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/w0xlt/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/w0xlt/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/w0xlt/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/w0xlt/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:w0xlt/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/w0xlt/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/w0xlt/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/w0xlt/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/w0xlt/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/w0xlt/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/w0xlt/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/w0xlt/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/w0xlt/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/w0xlt/bitcoin/hooks",
        "svn_url": "https://github.com/w0xlt/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 2,
        "stargazers_count": 5,
        "watchers_count": 5,
        "size": 292699,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-13T21:56:15Z",
        "created_at": "2021-11-14T01:34:01Z",
        "updated_at": "2026-01-07T21:47:03Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "af78d36512999be0ea59715ac5de8cb8d0b3d004",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38704,
        "stargazers_count": 87650,
        "watchers_count": 87650,
        "size": 301722,
        "default_branch": "master",
        "open_issues_count": 745,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-14T16:52:44Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2026-01-14T16:52:54Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32617"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": true,
    "additions": 7447,
    "deletions": 1,
    "changed_files": 7,
    "commits": 1,
    "review_comments": 3,
    "comments": 10
  },
  "events": [
    {
      "event": "convert_to_draft",
      "id": 17810049481,
      "node_id": "CTDE_lADOABII5864M2stzwAAAAQlj8nJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17810049481",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-26T08:04:39Z"
    },
    {
      "event": "commented",
      "id": 2908909445,
      "node_id": "IC_kwDOABII586tYm-F",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2908909445",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-26T08:04:47Z",
      "updated_at": "2026-01-14T16:38:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32617.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#28690](https://github.com/bitcoin/bitcoin/pull/28690) (build: Introduce internal kernel library by sedited)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (âœ¨ experimental)\n\nPossible typos and grammar issues:\n\n- draft-wahby-cfrg-hpke-kem-secp256k1-01^2 -> draft-wahby-cfrg-hpke-kem-secp256k1-01 [remove stray superscript] [the caret+number looks like a footnote marker and breaks the name]\n- (skE * pkR)^17 -> (skE * pkR) [remove stray superscript] [the caret+number after the expression is an unclear footnote marker]\n- \"HKDF-Extract & Expand(dh, \"shared secret\")^18.\" -> \"HKDF-Extract & Expand(dh, \\\"shared secret\\\").\" [remove stray superscript]\n\n<sup>drahtbot_id_5_m</sup>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32617#issuecomment-2908909445",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32617"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17811033526,
      "node_id": "HRFPE_lADOABII5864M2stzwAAAAQlns22",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17811033526",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "65acaaafb3d034e05c34f8d4fc147d7b023c0a48",
      "commit_url": "https://api.github.com/repos/w0xlt/bitcoin/commits/65acaaafb3d034e05c34f8d4fc147d7b023c0a48",
      "created_at": "2025-05-26T09:23:47Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17811158299,
      "node_id": "HRFPE_lADOABII5864M2stzwAAAAQloLUb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17811158299",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "9183a8e8b7210a1d209ff9af11427866076de878",
      "commit_url": "https://api.github.com/repos/w0xlt/bitcoin/commits/9183a8e8b7210a1d209ff9af11427866076de878",
      "created_at": "2025-05-26T09:34:03Z"
    },
    {
      "event": "labeled",
      "id": 17811163489,
      "node_id": "LE_lADOABII5864M2stzwAAAAQloMlh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17811163489",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-26T09:34:22Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2909065140,
      "node_id": "IC_kwDOABII586tZM-0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2909065140",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-26T09:34:24Z",
      "updated_at": "2025-05-26T09:34:24Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/runs/42885844689</sub>\n<sub>LLM reason (âœ¨ experimental): The CI failure is due to a lint check raising an error over missing include guards in the header file.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32617#issuecomment-2909065140",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32617"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17811222400,
      "node_id": "HRFPE_lADOABII5864M2stzwAAAAQloa-A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17811222400",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "588c67869f5dcb3f97f621ba1e98ab89cd1d9361",
      "commit_url": "https://api.github.com/repos/w0xlt/bitcoin/commits/588c67869f5dcb3f97f621ba1e98ab89cd1d9361",
      "created_at": "2025-05-26T09:38:09Z"
    },
    {
      "event": "unlabeled",
      "id": 17812362578,
      "node_id": "UNLE_lADOABII5864M2stzwAAAAQlsxVS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17812362578",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-26T10:49:58Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2909433769,
      "node_id": "IC_kwDOABII586tam-p",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2909433769",
      "actor": {
        "login": "1440000bytes",
        "id": 147166694,
        "node_id": "U_kgDOCMWV5g",
        "avatar_url": "https://avatars.githubusercontent.com/u/147166694?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/1440000bytes",
        "html_url": "https://github.com/1440000bytes",
        "followers_url": "https://api.github.com/users/1440000bytes/followers",
        "following_url": "https://api.github.com/users/1440000bytes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/1440000bytes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/1440000bytes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/1440000bytes/subscriptions",
        "organizations_url": "https://api.github.com/users/1440000bytes/orgs",
        "repos_url": "https://api.github.com/users/1440000bytes/repos",
        "events_url": "https://api.github.com/users/1440000bytes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/1440000bytes/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-26T11:42:00Z",
      "updated_at": "2025-07-31T19:15:36Z",
      "author_association": "NONE",
      "body": "If [`rust-payjoin`](https://github.com/payjoin/rust-payjoin/tree/master/payjoin-cli) already works with bitcoin core wallet, why do we need to add anything in bitcoin core for payjoin?\r\n\r\n",
      "user": {
        "login": "1440000bytes",
        "id": 147166694,
        "node_id": "U_kgDOCMWV5g",
        "avatar_url": "https://avatars.githubusercontent.com/u/147166694?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/1440000bytes",
        "html_url": "https://github.com/1440000bytes",
        "followers_url": "https://api.github.com/users/1440000bytes/followers",
        "following_url": "https://api.github.com/users/1440000bytes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/1440000bytes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/1440000bytes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/1440000bytes/subscriptions",
        "organizations_url": "https://api.github.com/users/1440000bytes/orgs",
        "repos_url": "https://api.github.com/users/1440000bytes/repos",
        "events_url": "https://api.github.com/users/1440000bytes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/1440000bytes/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32617#issuecomment-2909433769",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32617"
    },
    {
      "event": "commented",
      "id": 2910492898,
      "node_id": "IC_kwDOABII586tepji",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2910492898",
      "actor": {
        "login": "DanGould",
        "id": 8525467,
        "node_id": "MDQ6VXNlcjg1MjU0Njc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8525467?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DanGould",
        "html_url": "https://github.com/DanGould",
        "followers_url": "https://api.github.com/users/DanGould/followers",
        "following_url": "https://api.github.com/users/DanGould/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DanGould/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DanGould/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DanGould/subscriptions",
        "organizations_url": "https://api.github.com/users/DanGould/orgs",
        "repos_url": "https://api.github.com/users/DanGould/repos",
        "events_url": "https://api.github.com/users/DanGould/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DanGould/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-26T19:13:53Z",
      "updated_at": "2025-05-26T19:14:26Z",
      "author_association": "NONE",
      "body": "The main reason for the Bitcoin Core wallet to support payjoin directly is to reduce the number of necessary dependencies for those already using the core wallet. In particular rust-payjoin requires TLS (which is optional for the protocol) and rust implementations of cryptographic primatives that core could avoid with a bespoke implementation.",
      "user": {
        "login": "DanGould",
        "id": 8525467,
        "node_id": "MDQ6VXNlcjg1MjU0Njc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8525467?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DanGould",
        "html_url": "https://github.com/DanGould",
        "followers_url": "https://api.github.com/users/DanGould/followers",
        "following_url": "https://api.github.com/users/DanGould/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DanGould/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DanGould/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DanGould/subscriptions",
        "organizations_url": "https://api.github.com/users/DanGould/orgs",
        "repos_url": "https://api.github.com/users/DanGould/repos",
        "events_url": "https://api.github.com/users/DanGould/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DanGould/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32617#issuecomment-2910492898",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32617"
    },
    {
      "event": "subscribed",
      "id": 17820643292,
      "node_id": "SE_lADOABII5864M2stzwAAAAQmMW_c",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17820643292",
      "actor": {
        "login": "spacebear21",
        "id": 144076611,
        "node_id": "U_kgDOCJZvQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/144076611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/spacebear21",
        "html_url": "https://github.com/spacebear21",
        "followers_url": "https://api.github.com/users/spacebear21/followers",
        "following_url": "https://api.github.com/users/spacebear21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/spacebear21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/spacebear21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/spacebear21/subscriptions",
        "organizations_url": "https://api.github.com/users/spacebear21/orgs",
        "repos_url": "https://api.github.com/users/spacebear21/repos",
        "events_url": "https://api.github.com/users/spacebear21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/spacebear21/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-27T00:58:47Z"
    },
    {
      "event": "commented",
      "id": 2935923079,
      "node_id": "IC_kwDOABII586u_qGH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2935923079",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-03T15:19:41Z",
      "updated_at": "2025-06-03T15:19:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "Fore more context to reviewers, could add a link to [BIP 77](https://github.com/bitcoin/bips/blob/master/bip-0077.md) in the PR description, particularly to the cryptography part: https://github.com/bitcoin/bips/blob/master/bip-0077.md#secp256k1-hybrid-public-key-encryption\r\n\r\n> Full HPKE Modes: All four HPKE modes are supported â€“ Base, PSK, Auth, and AuthPSK.\r\n\r\nDo we need all of the four modes for Payjoin v2 support? Didn't look in-depth yet, but at least BIP77 contains only the two modes \"Base\" and \"Auth\" explicitly (and no mentions of \"PSK\"):\r\nhttps://github.com/bitcoin/bips/blob/72af87fc72999e3f0a26a06e6e0a7f3134236337/bip-0077.md?plain=1#L286-L287\r\nhttps://github.com/bitcoin/bips/blob/72af87fc72999e3f0a26a06e6e0a7f3134236337/bip-0077.md?plain=1#L376-L378",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32617#issuecomment-2935923079",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32617"
    },
    {
      "event": "commented",
      "id": 2941016820,
      "node_id": "IC_kwDOABII586vTFr0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2941016820",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-04T18:33:45Z",
      "updated_at": "2025-06-04T18:33:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "> at least BIP77 contains only the two modes \"Base\" and \"Auth\" explicitly (and no mentions of \"PSK\"):\r\n\r\nGood catch. I still need to verify whether `PSK` is used by OHTTP in the Payjoin v2 protocol, but since the https://github.com/payjoin/bitcoin-hpke project used by PDK implements and has test vectors for `PSK`, I added the `PSK` and `AuthPSK` modes here as well.",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32617#issuecomment-2941016820",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32617"
    },
    {
      "event": "commented",
      "id": 2956505713,
      "node_id": "IC_kwDOABII586wOLJx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2956505713",
      "actor": {
        "login": "nothingmuch",
        "id": 14242,
        "node_id": "MDQ6VXNlcjE0MjQy",
        "avatar_url": "https://avatars.githubusercontent.com/u/14242?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nothingmuch",
        "html_url": "https://github.com/nothingmuch",
        "followers_url": "https://api.github.com/users/nothingmuch/followers",
        "following_url": "https://api.github.com/users/nothingmuch/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nothingmuch/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nothingmuch/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nothingmuch/subscriptions",
        "organizations_url": "https://api.github.com/users/nothingmuch/orgs",
        "repos_url": "https://api.github.com/users/nothingmuch/repos",
        "events_url": "https://api.github.com/users/nothingmuch/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nothingmuch/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-09T17:50:00Z",
      "updated_at": "2025-06-09T17:50:00Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Good catch. I still need to verify whether `PSK` is used by OHTTP in the Payjoin v2 protocol,\r\n\r\nI can confirm that neither BIP 77 nor the rust-payjoin implementations depend on the PSK functionality. There are ideas for future extensions that might make use of that, but they are only ideas at this point and would not be a part of BIP 77 itself.",
      "user": {
        "login": "nothingmuch",
        "id": 14242,
        "node_id": "MDQ6VXNlcjE0MjQy",
        "avatar_url": "https://avatars.githubusercontent.com/u/14242?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nothingmuch",
        "html_url": "https://github.com/nothingmuch",
        "followers_url": "https://api.github.com/users/nothingmuch/followers",
        "following_url": "https://api.github.com/users/nothingmuch/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nothingmuch/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nothingmuch/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nothingmuch/subscriptions",
        "organizations_url": "https://api.github.com/users/nothingmuch/orgs",
        "repos_url": "https://api.github.com/users/nothingmuch/repos",
        "events_url": "https://api.github.com/users/nothingmuch/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nothingmuch/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32617#issuecomment-2956505713",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32617"
    },
    {
      "event": "labeled",
      "id": 19010847634,
      "node_id": "LE_lADOABII5864M2stzwAAAARtIoOS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19010847634",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-06T11:10:08Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "subscribed",
      "id": 19552609403,
      "node_id": "SE_lADOABII5864M2stzwAAAASNbSR7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19552609403",
      "actor": {
        "login": "nervana21",
        "id": 205626986,
        "node_id": "U_kgDODEGeag",
        "avatar_url": "https://avatars.githubusercontent.com/u/205626986?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nervana21",
        "html_url": "https://github.com/nervana21",
        "followers_url": "https://api.github.com/users/nervana21/followers",
        "following_url": "https://api.github.com/users/nervana21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nervana21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nervana21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nervana21/subscriptions",
        "organizations_url": "https://api.github.com/users/nervana21/orgs",
        "repos_url": "https://api.github.com/users/nervana21/repos",
        "events_url": "https://api.github.com/users/nervana21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nervana21/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-07T22:22:22Z"
    },
    {
      "event": "commented",
      "id": 3432866273,
      "node_id": "IC_kwDOABII587MnWHh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3432866273",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-22T15:04:55Z",
      "updated_at": "2025-10-22T15:04:55Z",
      "author_association": "MEMBER",
      "body": "Are you still working on this?",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32617#issuecomment-3432866273",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32617"
    },
    {
      "event": "review_requested",
      "id": 20433628807,
      "node_id": "RRE_lADOABII5864M2stzwAAAATB8G6H",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20433628807",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-22T15:05:29Z",
      "requested_reviewer": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 20433628838,
      "node_id": "RRE_lADOABII5864M2stzwAAAATB8G6m",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20433628838",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-22T15:05:29Z",
      "requested_reviewer": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 20433628857,
      "node_id": "RRE_lADOABII5864M2stzwAAAATB8G65",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20433628857",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-22T15:05:29Z",
      "requested_reviewer": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 20433635728,
      "node_id": "RRE_lADOABII5864M2stzwAAAATB8ImQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20433635728",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-22T15:05:47Z",
      "requested_reviewer": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 20433635766,
      "node_id": "RRE_lADOABII5864M2stzwAAAATB8Im2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20433635766",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-22T15:05:47Z",
      "requested_reviewer": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20465752577,
      "node_id": "HRFPE_lADOABII5864M2stzwAAAATD2poB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20465752577",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "ea45ac991df7f3fd7591f029b06467cbe4021c43",
      "commit_url": "https://api.github.com/repos/w0xlt/bitcoin/commits/ea45ac991df7f3fd7591f029b06467cbe4021c43",
      "created_at": "2025-10-23T20:42:33Z"
    },
    {
      "event": "unlabeled",
      "id": 20466373776,
      "node_id": "UNLE_lADOABII5864M2stzwAAAATD5BSQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20466373776",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-23T21:11:26Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQ5MzU4NzMwYjFkODYyZjFkNDcwZGNhYmQwZTg5MDBmYzdlZjE3NzU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/49358730b1d862f1d470dcabd0e8900fc7ef1775",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/49358730b1d862f1d470dcabd0e8900fc7ef1775",
      "tree": {
        "sha": "1ab51aec4a678b3509d0f0045d9a9f11e1496949",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1ab51aec4a678b3509d0f0045d9a9f11e1496949"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/161864a038ea345968bec8850caa8dbccae8ae69",
          "sha": "161864a038ea345968bec8850caa8dbccae8ae69",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/161864a038ea345968bec8850caa8dbccae8ae69"
        }
      ],
      "message": "crypto: Add secp256k1-based DHKEM for HPKE (Hybrid Public Key Encryption)",
      "committer": {
        "name": "w0xlt",
        "email": "94266259+w0xlt@users.noreply.github.com",
        "date": "2025-10-24T07:06:38Z"
      },
      "author": {
        "name": "w0xlt",
        "email": "94266259+w0xlt@users.noreply.github.com",
        "date": "2025-10-23T20:42:05Z"
      },
      "sha": "49358730b1d862f1d470dcabd0e8900fc7ef1775"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20474930022,
      "node_id": "HRFPE_lADOABII5864M2stzwAAAATEZqNm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20474930022",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "49358730b1d862f1d470dcabd0e8900fc7ef1775",
      "commit_url": "https://api.github.com/repos/w0xlt/bitcoin/commits/49358730b1d862f1d470dcabd0e8900fc7ef1775",
      "created_at": "2025-10-24T07:07:08Z"
    },
    {
      "event": "commented",
      "id": 3441441134,
      "node_id": "IC_kwDOABII587NIDlu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3441441134",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-24T07:11:05Z",
      "updated_at": "2025-10-24T07:11:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "PSK functionality removed.\r\nThanks for the suggestion @theStack and @nothingmuch ",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32617#issuecomment-3441441134",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32617"
    },
    {
      "event": "mentioned",
      "id": 20475019537,
      "node_id": "MEE_lADOABII5864M2stzwAAAATEaAER",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20475019537",
      "actor": {
        "login": "nothingmuch",
        "id": 14242,
        "node_id": "MDQ6VXNlcjE0MjQy",
        "avatar_url": "https://avatars.githubusercontent.com/u/14242?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nothingmuch",
        "html_url": "https://github.com/nothingmuch",
        "followers_url": "https://api.github.com/users/nothingmuch/followers",
        "following_url": "https://api.github.com/users/nothingmuch/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nothingmuch/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nothingmuch/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nothingmuch/subscriptions",
        "organizations_url": "https://api.github.com/users/nothingmuch/orgs",
        "repos_url": "https://api.github.com/users/nothingmuch/repos",
        "events_url": "https://api.github.com/users/nothingmuch/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nothingmuch/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-24T07:11:06Z"
    },
    {
      "event": "subscribed",
      "id": 20475019563,
      "node_id": "SE_lADOABII5864M2stzwAAAATEaAEr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20475019563",
      "actor": {
        "login": "nothingmuch",
        "id": 14242,
        "node_id": "MDQ6VXNlcjE0MjQy",
        "avatar_url": "https://avatars.githubusercontent.com/u/14242?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nothingmuch",
        "html_url": "https://github.com/nothingmuch",
        "followers_url": "https://api.github.com/users/nothingmuch/followers",
        "following_url": "https://api.github.com/users/nothingmuch/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nothingmuch/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nothingmuch/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nothingmuch/subscriptions",
        "organizations_url": "https://api.github.com/users/nothingmuch/orgs",
        "repos_url": "https://api.github.com/users/nothingmuch/repos",
        "events_url": "https://api.github.com/users/nothingmuch/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nothingmuch/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-24T07:11:06Z"
    },
    {
      "event": "mentioned",
      "id": 20475019589,
      "node_id": "MEE_lADOABII5864M2stzwAAAATEaAFF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20475019589",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-24T07:11:06Z"
    },
    {
      "event": "subscribed",
      "id": 20475019630,
      "node_id": "SE_lADOABII5864M2stzwAAAATEaAFu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20475019630",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-24T07:11:06Z"
    },
    {
      "event": "reviewed",
      "id": 3396562602,
      "node_id": "PRR_kwDOABII587Kc26q",
      "url": null,
      "actor": null,
      "commit_id": "49358730b1d862f1d470dcabd0e8900fc7ef1775",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-10-29T23:57:21Z",
      "author_association": "CONTRIBUTOR",
      "body": "Just skimmed a bit to start. Before spending significant time on reviewing this, I think it would be great if this could be cleaned up to the point that it can be taken out of draft status. Potentially also consider splitting it into multiple commits.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32617#pullrequestreview-3396562602",
      "submitted_at": "2025-10-29T23:57:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32617"
    },
    {
      "event": "commented",
      "id": 3467100580,
      "node_id": "IC_kwDOABII587Op8Gk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3467100580",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-30T10:03:38Z",
      "updated_at": "2025-10-30T10:03:38Z",
      "author_association": "MEMBER",
      "body": "It seems a bit premature to be doing code review or merging anything here, until some discussion has played out in #33684 in regards to approach, and implementation details (can you link to it from the PR description). There still seem to be high-level questions that need answering/agreement on.",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32617#issuecomment-3467100580",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32617"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2475734567",
      "pull_request_review_id": 3396562602,
      "id": 2475734567,
      "node_id": "PRRC_kwDOABII586TkLYn",
      "diff_hunk": "@@ -0,0 +1,524 @@\n+// Copyright (c) 2018-present The Bitcoin Core developers",
      "path": "src/dhkem_secp256k1.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "49358730b1d862f1d470dcabd0e8900fc7ef1775",
      "original_commit_id": "49358730b1d862f1d470dcabd0e8900fc7ef1775",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "2018?",
      "created_at": "2025-10-29T22:15:28Z",
      "updated_at": "2025-10-29T23:57:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32617#discussion_r2475734567",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2475734567"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32617"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2475742295",
      "pull_request_review_id": 3396562602,
      "id": 2475742295,
      "node_id": "PRRC_kwDOABII586TkNRX",
      "diff_hunk": "@@ -0,0 +1,524 @@\n+// Copyright (c) 2018-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <dhkem_secp256k1.h>\n+\n+#include <crypto/hmac_sha256.h>\n+#include <random.h>\n+#include <secp256k1_ecdh.h>\n+#include <span>\n+#include <array>\n+#include <cassert>\n+#include <cstring>\n+#include <support/allocators/secure.h>\n+#include <optional>\n+#include <crypto/chacha20poly1305.h>\n+#include <mutex>\n+#include <support/cleanse.h>\n+\n+namespace dhkem_secp256k1 {\n+\n+static secp256k1_context* g_secp256k1_ctx = nullptr;\n+static std::once_flag g_ctx_init_flag;\n+\n+/** Ensure global secp256k1 context is initialized (call InitContext() before use). */\n+static void InitCtx() {\n+    std::call_once(g_ctx_init_flag, [](){\n+        // Create context (no need for signing in this usage, verification is implicit in pubkey parsing)\n+        g_secp256k1_ctx = secp256k1_context_create(SECP256K1_CONTEXT_NONE);\n+        assert(g_secp256k1_ctx != nullptr);\n+        // Randomize the secp256k1 context with a blinding seed\n+        std::vector<uint8_t, secure_allocator<uint8_t>> vseed(32);\n+        GetRandBytes(vseed);\n+        bool ret = secp256k1_context_randomize(g_secp256k1_ctx, vseed.data());\n+        assert(ret);\n+    });\n+}\n+\n+void InitContext() {\n+    InitCtx();\n+}\n+\n+// Basic HKDF (SHA-256) functions\n+void HKDF_Extract(const uint8_t* salt, size_t salt_len,\n+                  const uint8_t* ikm, size_t ikm_len,\n+                  uint8_t out_prk[32]) {\n+    // If no salt, use a 32-byte array of zeroes (per RFC5869) instead of nullptr.\n+    static const uint8_t zero_salt[32] = {0};\n+    const uint8_t*  hmac_key    = salt_len > 0 ? salt : zero_salt;\n+    size_t          hmac_keylen = salt_len > 0 ? salt_len : 32;\n+    CHMAC_SHA256 hmac(hmac_key, hmac_keylen);\n+    hmac.Write(ikm, ikm_len);\n+    hmac.Finalize(out_prk);\n+}\n+\n+void HKDF_Expand32(const uint8_t prk[32], const uint8_t* info_data, size_t info_len,\n+                   uint8_t out_okm[], size_t L) {\n+    // Only a single round is needed since L <= 32 bytes\n+    unsigned char counter = 0x01;\n+    CHMAC_SHA256 hmac(prk, 32);\n+    hmac.Write(info_data, info_len);\n+    hmac.Write(&counter, 1);\n+    unsigned char output_block[32];\n+    hmac.Finalize(output_block);\n+    std::memcpy(out_okm, output_block, L);\n+}\n+\n+// -------------------- Static Helpers for Clarity and Reuse --------------------\n+\n+static const uint8_t KEM_SUITE_ID[] = {'K','E','M', 0x00, 0x16};  // Suite ID for secp256k1 KEM\n+\n+// ECDH hash function that outputs the 32-byte X coordinate (ignoring Y)\n+static int EcdhHashFunctionRaw(unsigned char* output, const unsigned char* x32, const unsigned char* /*y32*/, void* /*data*/) {\n+    memcpy(output, x32, 32);\n+    return 1;\n+}\n+\n+// Compute the 32-byte X-coordinate shared secret for ECDH (priv * pub)\n+static bool EcdhXCoordinate(const secp256k1_pubkey& pub, const uint8_t priv[32], uint8_t out_shared[32]) {\n+    return secp256k1_ecdh(g_secp256k1_ctx, out_shared, &pub, priv, EcdhHashFunctionRaw, nullptr) == 1;\n+}\n+\n+// Compute a secp256k1 public key (65-byte uncompressed) from a 32-byte private key\n+static bool ComputePublicKey(const uint8_t priv_key[32], uint8_t out_pubkey[65]) {\n+    if (secp256k1_ec_seckey_verify(g_secp256k1_ctx, priv_key) != 1) {\n+        return false;\n+    }\n+    secp256k1_pubkey pub;\n+    if (secp256k1_ec_pubkey_create(g_secp256k1_ctx, &pub, priv_key) != 1) {\n+        return false;\n+    }\n+    size_t pub_len = 65;\n+    secp256k1_ec_pubkey_serialize(g_secp256k1_ctx, out_pubkey, &pub_len, &pub, SECP256K1_EC_UNCOMPRESSED);\n+    assert(pub_len == 65);\n+    return true;\n+}\n+\n+// Build KEM context for Base mode: kem_context = enc || pkR (130 bytes total)\n+static void BuildKemContext(const uint8_t enc[65], const uint8_t pkR[65], uint8_t out_context[130]) {\n+    memcpy(out_context,       enc, 65);\n+    memcpy(out_context + 65,  pkR, 65);\n+}\n+\n+// Build KEM context for Auth modes: kem_context = enc || pkR || pkS (195 bytes total)\n+static void BuildKemContext(const uint8_t enc[65], const uint8_t pkR[65], const uint8_t pkS[65], uint8_t out_context[195]) {\n+    memcpy(out_context,        enc, 65);\n+    memcpy(out_context + 65,   pkR, 65);\n+    memcpy(out_context + 130,  pkS, 65);\n+}\n+\n+// LabeledExtract: HKDF-Extract with salt=\"\", labeled IKM = \"HPKE-v1\" || KEM_SUITE_ID || label || ikm\n+static void LabeledExtract(const char* label, const uint8_t* ikm, size_t ikm_len, uint8_t out_prk[32]) {\n+    // Build labeled IKM\n+    size_t prefix_len = sizeof(LABEL_PREFIX);    // \"HPKE-v1\" (7 bytes)\n+    size_t suite_len  = sizeof(KEM_SUITE_ID);    // \"KEM<id>\" (5 bytes)\n+    size_t label_len  = std::strlen(label);\n+    std::vector<uint8_t> labeled_ikm;\n+    labeled_ikm.reserve(prefix_len + suite_len + label_len + ikm_len);\n+    labeled_ikm.insert(labeled_ikm.end(), LABEL_PREFIX, LABEL_PREFIX + prefix_len);\n+    labeled_ikm.insert(labeled_ikm.end(), KEM_SUITE_ID, KEM_SUITE_ID + suite_len);\n+    labeled_ikm.insert(labeled_ikm.end(), reinterpret_cast<const uint8_t*>(label), reinterpret_cast<const uint8_t*>(label) + label_len);\n+    labeled_ikm.insert(labeled_ikm.end(), ikm, ikm + ikm_len);\n+    // HKDF-Extract with empty salt\n+    HKDF_Extract(nullptr, 0, labeled_ikm.data(), labeled_ikm.size(), out_prk);\n+}\n+\n+// LabeledExpand: HKDF-Expand to length out_len with info = length||\"HPKE-v1\"||KEM_SUITE_ID||label||info_data\n+static void LabeledExpand(const uint8_t prk[32], const char* label, const uint8_t* info, size_t info_len, uint8_t out[], size_t out_len) {\n+    // Build labeled info\n+    uint8_t length_bytes[2] = { static_cast<uint8_t>((out_len >> 8) & 0xFF), static_cast<uint8_t>(out_len & 0xFF) };\n+    size_t prefix_len = sizeof(LABEL_PREFIX);\n+    size_t suite_len  = sizeof(KEM_SUITE_ID);\n+    size_t label_len  = std::strlen(label);\n+    std::vector<uint8_t> labeled_info;\n+    labeled_info.reserve(2 + prefix_len + suite_len + label_len + info_len);\n+    labeled_info.insert(labeled_info.end(), length_bytes, length_bytes + 2);\n+    labeled_info.insert(labeled_info.end(), LABEL_PREFIX, LABEL_PREFIX + prefix_len);\n+    labeled_info.insert(labeled_info.end(), KEM_SUITE_ID, KEM_SUITE_ID + suite_len);\n+    labeled_info.insert(labeled_info.end(), reinterpret_cast<const uint8_t*>(label), reinterpret_cast<const uint8_t*>(label) + label_len);\n+    labeled_info.insert(labeled_info.end(), info, info + info_len);\n+    // HKDF-Expand (single-block, since out_len <= 32)\n+    HKDF_Expand32(prk, labeled_info.data(), labeled_info.size(), out, out_len);\n+}\n+\n+// DeriveSharedSecret: derive the 32-byte KEM shared secret from ECDH output and kem_context\n+// (uses HKDF-Extract \"eae_prk\" and HKDF-Expand \"shared_secret\" as defined in RFC 9180)\n+static std::array<uint8_t, 32> DeriveSharedSecret(const uint8_t* dh, size_t dh_len,\n+                                                 const uint8_t* kem_context, size_t kem_context_len) {\n+    uint8_t prk_eae[32];\n+    LabeledExtract(\"eae_prk\", dh, dh_len, prk_eae);\n+    std::array<uint8_t, 32> shared;\n+    LabeledExpand(prk_eae, \"shared_secret\", kem_context, kem_context_len, shared.data(), shared.size());\n+    memory_cleanse(prk_eae, 32);\n+    return shared;\n+}\n+\n+// -------------------- Public API Functions --------------------\n+\n+bool DeriveKeyPair(std::span<const uint8_t> ikm,\n+                   std::array<uint8_t, 32>& outPrivKey,\n+                   std::array<uint8_t, 65>& outPubKey)\n+{\n+    // Domain-separate the input keying material (label \"dkp_prk\") and derive a valid secp256k1 key pair (RFC 9180 Â§7.1.3)\n+    uint8_t prk[32];\n+    LabeledExtract(\"dkp_prk\", ikm.data(), ikm.size(), prk);\n+    const char* candidate_label = \"candidate\";\n+    uint8_t candidate[32];\n+    // Try up to 256 candidates by expanding \"candidate\" with a counter until a valid secret scalar is found (rejection sampling)\n+    bool success = false;\n+    for (int counter = 0; counter < 256; ++counter) {\n+        uint8_t ctr = static_cast<uint8_t>(counter);\n+        LabeledExpand(prk, candidate_label, &ctr, 1, candidate, 32);\n+        candidate[0] &= 0xFF; // Masking (no effect for 0xFF, included for spec completeness)\n+        if (ComputePublicKey(candidate, outPubKey.data())) {\n+            // Found a valid secret scalar; output the private key and corresponding public key\n+            std::memcpy(outPrivKey.data(), candidate, 32);\n+            success = true;\n+            break;\n+        }\n+    }\n+    memory_cleanse(prk, 32);\n+    memory_cleanse(candidate, 32);\n+    return success;\n+}\n+\n+std::optional<std::array<uint8_t, 32>>\n+Encap(std::span<const uint8_t> pkR, const std::array<uint8_t, 32>& skE, const std::array<uint8_t, 65>& enc) {\n+    if (pkR.size() != NPK) {\n+        return std::nullopt; // Recipient public key must be 65 bytes (uncompressed)\n+    }\n+    InitCtx();\n+    // Note: Using provided ephemeral key pair (skE, enc); no new random key is generated here.\n+\n+    // 1. Parse the recipient's public key bytes into a secp256k1_pubkey object\n+    secp256k1_pubkey pubR;\n+    if (!secp256k1_ec_pubkey_parse(g_secp256k1_ctx, &pubR, pkR.data(), pkR.size())) {\n+        return std::nullopt; // Invalid recipient public key format\n+    }\n+\n+    // 1.5. Validate that enc corresponds to skE\n+    std::array<uint8_t, 65> comp_enc;\n+    if (!ComputePublicKey(skE.data(), comp_enc.data())) {\n+        return std::nullopt; // Invalid ephemeral private key\n+    }\n+    if (std::memcmp(comp_enc.data(), enc.data(), NENC) != 0) {\n+        return std::nullopt; // Ephemeral pubkey mismatch\n+    }\n+\n+    // 2. Compute ECDH shared secret: dh = x-coordinate of (skE * pkR)\n+    std::array<uint8_t, 32> dh;\n+    if (!EcdhXCoordinate(pubR, skE.data(), dh.data())) {\n+        return std::nullopt; // ECDH failed (unexpected if inputs are valid)\n+    }\n+\n+    // 3. Build KEM context = enc || pkR (130 bytes)\n+    uint8_t kem_context[130];\n+    BuildKemContext(enc.data(), pkR.data(), kem_context);\n+\n+    // 4. Derive the 32-byte shared secret via HKDF\n+    std::array<uint8_t, 32> shared_secret = DeriveSharedSecret(dh.data(), dh.size(), kem_context, sizeof(kem_context));\n+    memory_cleanse(dh.data(), dh.size());\n+    return shared_secret;\n+}\n+\n+std::optional<std::array<uint8_t, 32>>\n+Decap(std::span<const uint8_t> enc, std::span<const uint8_t> skR) {\n+    if (enc.size() != NENC || skR.size() != NSK) {\n+        return std::nullopt; // Inputs must be 65-byte enc and 32-byte skR\n+    }\n+    InitCtx();\n+\n+    // 1. Parse the encapsulated ephemeral public key\n+    secp256k1_pubkey pubE;\n+    if (!secp256k1_ec_pubkey_parse(g_secp256k1_ctx, &pubE, enc.data(), enc.size())) {\n+        return std::nullopt; // Invalid ephemeral public key\n+    }\n+\n+    // 2. Verify recipient's private key (skR) is valid\n+    if (secp256k1_ec_seckey_verify(g_secp256k1_ctx, skR.data()) != 1) {\n+        return std::nullopt; // Invalid recipient private key\n+    }\n+\n+    // 3. Compute ECDH shared secret: dh = x-coordinate of (skR * pubE)\n+    std::array<uint8_t, 32> dh;\n+    if (!EcdhXCoordinate(pubE, skR.data(), dh.data())) {\n+        return std::nullopt; // ECDH failed (invalid inputs)\n+    }\n+\n+    // 4. Derive pkR (recipient's public key) from skR for KEM context\n+    std::array<uint8_t, 65> pkR_bytes;\n+    if (!ComputePublicKey(skR.data(), pkR_bytes.data())) {\n+        return std::nullopt; // Should not happen if skR is valid\n+    }\n+\n+    // 5. Build KEM context = enc || pkR (130 bytes total)\n+    uint8_t kem_context[130];\n+    BuildKemContext(enc.data(), pkR_bytes.data(), kem_context);\n+\n+    // 6. Derive the 32-byte shared secret via HKDF\n+    std::array<uint8_t, 32> shared_secret = DeriveSharedSecret(dh.data(), dh.size(), kem_context, sizeof(kem_context));\n+    memory_cleanse(dh.data(), dh.size());\n+    return shared_secret;\n+}\n+\n+std::vector<uint8_t> LabeledExpand(const std::vector<uint8_t>& prk,\n+                                   const std::vector<uint8_t>& label,\n+                                   const std::vector<uint8_t>& info,\n+                                   size_t L)\n+{\n+    // 1. Construct labeled_info = length (2 bytes, big-endian) || label_prefix || suite_id || label || info\n+    uint8_t length_bytes[2];\n+    length_bytes[0] = static_cast<uint8_t>((L >> 8) & 0xff);\n+    length_bytes[1] = static_cast<uint8_t>(L & 0xff);\n+\n+    std::vector<uint8_t> labeled_info;\n+    labeled_info.insert(labeled_info.end(), length_bytes, length_bytes + 2);\n+    labeled_info.insert(labeled_info.end(), std::begin(LABEL_PREFIX), std::end(LABEL_PREFIX));\n+    labeled_info.insert(labeled_info.end(), std::begin(SUITE_ID), std::end(SUITE_ID));\n+    labeled_info.insert(labeled_info.end(), label.begin(), label.end());\n+    labeled_info.insert(labeled_info.end(), info.begin(), info.end());\n+\n+    // 2. Expand to L bytes\n+    std::vector<uint8_t> out_okm(L);\n+    HKDF_Expand32(prk.data(), labeled_info.data(), labeled_info.size(), out_okm.data(), L);\n+    return out_okm;\n+}\n+\n+std::vector<uint8_t> LabeledExtract(const std::vector<uint8_t>& salt,\n+                                    const std::vector<uint8_t>& label,\n+                                    const std::vector<uint8_t>& ikm)\n+{\n+    // 1. Construct labeled_ikm = label_prefix || suite_id || label || ikm\n+    std::vector<uint8_t> labeled_ikm;\n+    labeled_ikm.insert(labeled_ikm.end(), std::begin(LABEL_PREFIX), std::end(LABEL_PREFIX));\n+    labeled_ikm.insert(labeled_ikm.end(), std::begin(SUITE_ID), std::end(SUITE_ID));\n+    labeled_ikm.insert(labeled_ikm.end(), label.begin(), label.end());\n+    labeled_ikm.insert(labeled_ikm.end(), ikm.begin(), ikm.end());\n+\n+    // 2. Extract to obtain PRK\n+    uint8_t out_prk[32];\n+    HKDF_Extract(salt.data(), salt.size(), labeled_ikm.data(), labeled_ikm.size(), out_prk);\n+    // 3. Return the PRK as a 32-byte vector\n+    return std::vector<uint8_t>(out_prk, out_prk + 32);\n+}\n+\n+std::optional<std::array<uint8_t, 32>>\n+AuthEncap(const std::array<uint8_t, 65>& pkR,\n+          const std::array<uint8_t, 32>& skS,\n+          const std::array<uint8_t, 32>& skE,\n+          const std::array<uint8_t, 65>& enc)\n+{\n+    InitCtx();\n+    // Authenticated KEM Encapsulation (Auth mode) - uses static sender key and ephemeral key\n+\n+    // 1. Parse recipient's public key (pkR) into secp256k1_pubkey\n+    secp256k1_pubkey pubR;\n+    if (!secp256k1_ec_pubkey_parse(g_secp256k1_ctx, &pubR, pkR.data(), pkR.size())) {\n+        return std::nullopt; // Invalid recipient public key\n+    }\n+\n+    // 2. Compute sender's public key (pkS) from sender's private key (skS)\n+    std::array<uint8_t, 65> pkS_bytes;\n+    if (!ComputePublicKey(skS.data(), pkS_bytes.data())) {\n+        return std::nullopt; // Invalid sender private key\n+    }\n+\n+    // 2.5. Verify that enc matches skE",
      "path": "src/dhkem_secp256k1.cpp",
      "position": 327,
      "original_position": 327,
      "commit_id": "49358730b1d862f1d470dcabd0e8900fc7ef1775",
      "original_commit_id": "49358730b1d862f1d470dcabd0e8900fc7ef1775",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "There is a 2.5 but no 3?",
      "created_at": "2025-10-29T22:18:14Z",
      "updated_at": "2025-10-29T23:57:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32617#discussion_r2475742295",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2475742295"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32617"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 327,
      "original_line": 327,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2475743528",
      "pull_request_review_id": 3396562602,
      "id": 2475743528,
      "node_id": "PRRC_kwDOABII586TkNko",
      "diff_hunk": "@@ -0,0 +1,524 @@\n+// Copyright (c) 2018-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <dhkem_secp256k1.h>\n+\n+#include <crypto/hmac_sha256.h>\n+#include <random.h>\n+#include <secp256k1_ecdh.h>\n+#include <span>\n+#include <array>\n+#include <cassert>\n+#include <cstring>\n+#include <support/allocators/secure.h>\n+#include <optional>\n+#include <crypto/chacha20poly1305.h>\n+#include <mutex>\n+#include <support/cleanse.h>\n+\n+namespace dhkem_secp256k1 {\n+\n+static secp256k1_context* g_secp256k1_ctx = nullptr;\n+static std::once_flag g_ctx_init_flag;\n+\n+/** Ensure global secp256k1 context is initialized (call InitContext() before use). */\n+static void InitCtx() {\n+    std::call_once(g_ctx_init_flag, [](){\n+        // Create context (no need for signing in this usage, verification is implicit in pubkey parsing)\n+        g_secp256k1_ctx = secp256k1_context_create(SECP256K1_CONTEXT_NONE);\n+        assert(g_secp256k1_ctx != nullptr);\n+        // Randomize the secp256k1 context with a blinding seed\n+        std::vector<uint8_t, secure_allocator<uint8_t>> vseed(32);\n+        GetRandBytes(vseed);\n+        bool ret = secp256k1_context_randomize(g_secp256k1_ctx, vseed.data());\n+        assert(ret);\n+    });\n+}\n+\n+void InitContext() {\n+    InitCtx();\n+}\n+\n+// Basic HKDF (SHA-256) functions\n+void HKDF_Extract(const uint8_t* salt, size_t salt_len,\n+                  const uint8_t* ikm, size_t ikm_len,\n+                  uint8_t out_prk[32]) {\n+    // If no salt, use a 32-byte array of zeroes (per RFC5869) instead of nullptr.\n+    static const uint8_t zero_salt[32] = {0};\n+    const uint8_t*  hmac_key    = salt_len > 0 ? salt : zero_salt;\n+    size_t          hmac_keylen = salt_len > 0 ? salt_len : 32;\n+    CHMAC_SHA256 hmac(hmac_key, hmac_keylen);\n+    hmac.Write(ikm, ikm_len);\n+    hmac.Finalize(out_prk);\n+}\n+\n+void HKDF_Expand32(const uint8_t prk[32], const uint8_t* info_data, size_t info_len,\n+                   uint8_t out_okm[], size_t L) {\n+    // Only a single round is needed since L <= 32 bytes\n+    unsigned char counter = 0x01;\n+    CHMAC_SHA256 hmac(prk, 32);\n+    hmac.Write(info_data, info_len);\n+    hmac.Write(&counter, 1);\n+    unsigned char output_block[32];\n+    hmac.Finalize(output_block);\n+    std::memcpy(out_okm, output_block, L);\n+}\n+\n+// -------------------- Static Helpers for Clarity and Reuse --------------------\n+\n+static const uint8_t KEM_SUITE_ID[] = {'K','E','M', 0x00, 0x16};  // Suite ID for secp256k1 KEM\n+\n+// ECDH hash function that outputs the 32-byte X coordinate (ignoring Y)\n+static int EcdhHashFunctionRaw(unsigned char* output, const unsigned char* x32, const unsigned char* /*y32*/, void* /*data*/) {\n+    memcpy(output, x32, 32);\n+    return 1;\n+}\n+\n+// Compute the 32-byte X-coordinate shared secret for ECDH (priv * pub)\n+static bool EcdhXCoordinate(const secp256k1_pubkey& pub, const uint8_t priv[32], uint8_t out_shared[32]) {\n+    return secp256k1_ecdh(g_secp256k1_ctx, out_shared, &pub, priv, EcdhHashFunctionRaw, nullptr) == 1;\n+}\n+\n+// Compute a secp256k1 public key (65-byte uncompressed) from a 32-byte private key\n+static bool ComputePublicKey(const uint8_t priv_key[32], uint8_t out_pubkey[65]) {\n+    if (secp256k1_ec_seckey_verify(g_secp256k1_ctx, priv_key) != 1) {\n+        return false;\n+    }\n+    secp256k1_pubkey pub;\n+    if (secp256k1_ec_pubkey_create(g_secp256k1_ctx, &pub, priv_key) != 1) {\n+        return false;\n+    }\n+    size_t pub_len = 65;\n+    secp256k1_ec_pubkey_serialize(g_secp256k1_ctx, out_pubkey, &pub_len, &pub, SECP256K1_EC_UNCOMPRESSED);\n+    assert(pub_len == 65);\n+    return true;\n+}\n+\n+// Build KEM context for Base mode: kem_context = enc || pkR (130 bytes total)\n+static void BuildKemContext(const uint8_t enc[65], const uint8_t pkR[65], uint8_t out_context[130]) {\n+    memcpy(out_context,       enc, 65);\n+    memcpy(out_context + 65,  pkR, 65);\n+}\n+\n+// Build KEM context for Auth modes: kem_context = enc || pkR || pkS (195 bytes total)\n+static void BuildKemContext(const uint8_t enc[65], const uint8_t pkR[65], const uint8_t pkS[65], uint8_t out_context[195]) {\n+    memcpy(out_context,        enc, 65);\n+    memcpy(out_context + 65,   pkR, 65);\n+    memcpy(out_context + 130,  pkS, 65);\n+}\n+\n+// LabeledExtract: HKDF-Extract with salt=\"\", labeled IKM = \"HPKE-v1\" || KEM_SUITE_ID || label || ikm\n+static void LabeledExtract(const char* label, const uint8_t* ikm, size_t ikm_len, uint8_t out_prk[32]) {\n+    // Build labeled IKM\n+    size_t prefix_len = sizeof(LABEL_PREFIX);    // \"HPKE-v1\" (7 bytes)\n+    size_t suite_len  = sizeof(KEM_SUITE_ID);    // \"KEM<id>\" (5 bytes)\n+    size_t label_len  = std::strlen(label);\n+    std::vector<uint8_t> labeled_ikm;\n+    labeled_ikm.reserve(prefix_len + suite_len + label_len + ikm_len);\n+    labeled_ikm.insert(labeled_ikm.end(), LABEL_PREFIX, LABEL_PREFIX + prefix_len);\n+    labeled_ikm.insert(labeled_ikm.end(), KEM_SUITE_ID, KEM_SUITE_ID + suite_len);\n+    labeled_ikm.insert(labeled_ikm.end(), reinterpret_cast<const uint8_t*>(label), reinterpret_cast<const uint8_t*>(label) + label_len);\n+    labeled_ikm.insert(labeled_ikm.end(), ikm, ikm + ikm_len);\n+    // HKDF-Extract with empty salt\n+    HKDF_Extract(nullptr, 0, labeled_ikm.data(), labeled_ikm.size(), out_prk);\n+}\n+\n+// LabeledExpand: HKDF-Expand to length out_len with info = length||\"HPKE-v1\"||KEM_SUITE_ID||label||info_data\n+static void LabeledExpand(const uint8_t prk[32], const char* label, const uint8_t* info, size_t info_len, uint8_t out[], size_t out_len) {\n+    // Build labeled info\n+    uint8_t length_bytes[2] = { static_cast<uint8_t>((out_len >> 8) & 0xFF), static_cast<uint8_t>(out_len & 0xFF) };\n+    size_t prefix_len = sizeof(LABEL_PREFIX);\n+    size_t suite_len  = sizeof(KEM_SUITE_ID);\n+    size_t label_len  = std::strlen(label);\n+    std::vector<uint8_t> labeled_info;\n+    labeled_info.reserve(2 + prefix_len + suite_len + label_len + info_len);\n+    labeled_info.insert(labeled_info.end(), length_bytes, length_bytes + 2);\n+    labeled_info.insert(labeled_info.end(), LABEL_PREFIX, LABEL_PREFIX + prefix_len);\n+    labeled_info.insert(labeled_info.end(), KEM_SUITE_ID, KEM_SUITE_ID + suite_len);\n+    labeled_info.insert(labeled_info.end(), reinterpret_cast<const uint8_t*>(label), reinterpret_cast<const uint8_t*>(label) + label_len);\n+    labeled_info.insert(labeled_info.end(), info, info + info_len);\n+    // HKDF-Expand (single-block, since out_len <= 32)\n+    HKDF_Expand32(prk, labeled_info.data(), labeled_info.size(), out, out_len);\n+}\n+\n+// DeriveSharedSecret: derive the 32-byte KEM shared secret from ECDH output and kem_context\n+// (uses HKDF-Extract \"eae_prk\" and HKDF-Expand \"shared_secret\" as defined in RFC 9180)\n+static std::array<uint8_t, 32> DeriveSharedSecret(const uint8_t* dh, size_t dh_len,\n+                                                 const uint8_t* kem_context, size_t kem_context_len) {\n+    uint8_t prk_eae[32];\n+    LabeledExtract(\"eae_prk\", dh, dh_len, prk_eae);\n+    std::array<uint8_t, 32> shared;\n+    LabeledExpand(prk_eae, \"shared_secret\", kem_context, kem_context_len, shared.data(), shared.size());\n+    memory_cleanse(prk_eae, 32);\n+    return shared;\n+}\n+\n+// -------------------- Public API Functions --------------------\n+\n+bool DeriveKeyPair(std::span<const uint8_t> ikm,\n+                   std::array<uint8_t, 32>& outPrivKey,\n+                   std::array<uint8_t, 65>& outPubKey)\n+{\n+    // Domain-separate the input keying material (label \"dkp_prk\") and derive a valid secp256k1 key pair (RFC 9180 Â§7.1.3)\n+    uint8_t prk[32];\n+    LabeledExtract(\"dkp_prk\", ikm.data(), ikm.size(), prk);\n+    const char* candidate_label = \"candidate\";\n+    uint8_t candidate[32];\n+    // Try up to 256 candidates by expanding \"candidate\" with a counter until a valid secret scalar is found (rejection sampling)\n+    bool success = false;\n+    for (int counter = 0; counter < 256; ++counter) {\n+        uint8_t ctr = static_cast<uint8_t>(counter);\n+        LabeledExpand(prk, candidate_label, &ctr, 1, candidate, 32);\n+        candidate[0] &= 0xFF; // Masking (no effect for 0xFF, included for spec completeness)\n+        if (ComputePublicKey(candidate, outPubKey.data())) {\n+            // Found a valid secret scalar; output the private key and corresponding public key\n+            std::memcpy(outPrivKey.data(), candidate, 32);\n+            success = true;\n+            break;\n+        }\n+    }\n+    memory_cleanse(prk, 32);\n+    memory_cleanse(candidate, 32);\n+    return success;\n+}\n+\n+std::optional<std::array<uint8_t, 32>>\n+Encap(std::span<const uint8_t> pkR, const std::array<uint8_t, 32>& skE, const std::array<uint8_t, 65>& enc) {\n+    if (pkR.size() != NPK) {\n+        return std::nullopt; // Recipient public key must be 65 bytes (uncompressed)\n+    }\n+    InitCtx();\n+    // Note: Using provided ephemeral key pair (skE, enc); no new random key is generated here.\n+\n+    // 1. Parse the recipient's public key bytes into a secp256k1_pubkey object\n+    secp256k1_pubkey pubR;\n+    if (!secp256k1_ec_pubkey_parse(g_secp256k1_ctx, &pubR, pkR.data(), pkR.size())) {\n+        return std::nullopt; // Invalid recipient public key format\n+    }\n+\n+    // 1.5. Validate that enc corresponds to skE\n+    std::array<uint8_t, 65> comp_enc;\n+    if (!ComputePublicKey(skE.data(), comp_enc.data())) {\n+        return std::nullopt; // Invalid ephemeral private key\n+    }\n+    if (std::memcmp(comp_enc.data(), enc.data(), NENC) != 0) {\n+        return std::nullopt; // Ephemeral pubkey mismatch\n+    }\n+\n+    // 2. Compute ECDH shared secret: dh = x-coordinate of (skE * pkR)\n+    std::array<uint8_t, 32> dh;\n+    if (!EcdhXCoordinate(pubR, skE.data(), dh.data())) {\n+        return std::nullopt; // ECDH failed (unexpected if inputs are valid)\n+    }\n+\n+    // 3. Build KEM context = enc || pkR (130 bytes)\n+    uint8_t kem_context[130];\n+    BuildKemContext(enc.data(), pkR.data(), kem_context);\n+\n+    // 4. Derive the 32-byte shared secret via HKDF\n+    std::array<uint8_t, 32> shared_secret = DeriveSharedSecret(dh.data(), dh.size(), kem_context, sizeof(kem_context));\n+    memory_cleanse(dh.data(), dh.size());\n+    return shared_secret;\n+}\n+\n+std::optional<std::array<uint8_t, 32>>\n+Decap(std::span<const uint8_t> enc, std::span<const uint8_t> skR) {\n+    if (enc.size() != NENC || skR.size() != NSK) {\n+        return std::nullopt; // Inputs must be 65-byte enc and 32-byte skR\n+    }\n+    InitCtx();\n+\n+    // 1. Parse the encapsulated ephemeral public key\n+    secp256k1_pubkey pubE;\n+    if (!secp256k1_ec_pubkey_parse(g_secp256k1_ctx, &pubE, enc.data(), enc.size())) {\n+        return std::nullopt; // Invalid ephemeral public key\n+    }\n+\n+    // 2. Verify recipient's private key (skR) is valid\n+    if (secp256k1_ec_seckey_verify(g_secp256k1_ctx, skR.data()) != 1) {\n+        return std::nullopt; // Invalid recipient private key\n+    }\n+\n+    // 3. Compute ECDH shared secret: dh = x-coordinate of (skR * pubE)\n+    std::array<uint8_t, 32> dh;\n+    if (!EcdhXCoordinate(pubE, skR.data(), dh.data())) {\n+        return std::nullopt; // ECDH failed (invalid inputs)\n+    }\n+\n+    // 4. Derive pkR (recipient's public key) from skR for KEM context\n+    std::array<uint8_t, 65> pkR_bytes;\n+    if (!ComputePublicKey(skR.data(), pkR_bytes.data())) {\n+        return std::nullopt; // Should not happen if skR is valid\n+    }\n+\n+    // 5. Build KEM context = enc || pkR (130 bytes total)\n+    uint8_t kem_context[130];\n+    BuildKemContext(enc.data(), pkR_bytes.data(), kem_context);\n+\n+    // 6. Derive the 32-byte shared secret via HKDF\n+    std::array<uint8_t, 32> shared_secret = DeriveSharedSecret(dh.data(), dh.size(), kem_context, sizeof(kem_context));\n+    memory_cleanse(dh.data(), dh.size());\n+    return shared_secret;\n+}\n+\n+std::vector<uint8_t> LabeledExpand(const std::vector<uint8_t>& prk,\n+                                   const std::vector<uint8_t>& label,\n+                                   const std::vector<uint8_t>& info,\n+                                   size_t L)\n+{\n+    // 1. Construct labeled_info = length (2 bytes, big-endian) || label_prefix || suite_id || label || info\n+    uint8_t length_bytes[2];\n+    length_bytes[0] = static_cast<uint8_t>((L >> 8) & 0xff);\n+    length_bytes[1] = static_cast<uint8_t>(L & 0xff);\n+\n+    std::vector<uint8_t> labeled_info;\n+    labeled_info.insert(labeled_info.end(), length_bytes, length_bytes + 2);\n+    labeled_info.insert(labeled_info.end(), std::begin(LABEL_PREFIX), std::end(LABEL_PREFIX));\n+    labeled_info.insert(labeled_info.end(), std::begin(SUITE_ID), std::end(SUITE_ID));\n+    labeled_info.insert(labeled_info.end(), label.begin(), label.end());\n+    labeled_info.insert(labeled_info.end(), info.begin(), info.end());\n+\n+    // 2. Expand to L bytes\n+    std::vector<uint8_t> out_okm(L);\n+    HKDF_Expand32(prk.data(), labeled_info.data(), labeled_info.size(), out_okm.data(), L);\n+    return out_okm;\n+}\n+\n+std::vector<uint8_t> LabeledExtract(const std::vector<uint8_t>& salt,\n+                                    const std::vector<uint8_t>& label,\n+                                    const std::vector<uint8_t>& ikm)\n+{\n+    // 1. Construct labeled_ikm = label_prefix || suite_id || label || ikm\n+    std::vector<uint8_t> labeled_ikm;\n+    labeled_ikm.insert(labeled_ikm.end(), std::begin(LABEL_PREFIX), std::end(LABEL_PREFIX));\n+    labeled_ikm.insert(labeled_ikm.end(), std::begin(SUITE_ID), std::end(SUITE_ID));\n+    labeled_ikm.insert(labeled_ikm.end(), label.begin(), label.end());\n+    labeled_ikm.insert(labeled_ikm.end(), ikm.begin(), ikm.end());\n+\n+    // 2. Extract to obtain PRK\n+    uint8_t out_prk[32];\n+    HKDF_Extract(salt.data(), salt.size(), labeled_ikm.data(), labeled_ikm.size(), out_prk);\n+    // 3. Return the PRK as a 32-byte vector\n+    return std::vector<uint8_t>(out_prk, out_prk + 32);\n+}\n+\n+std::optional<std::array<uint8_t, 32>>\n+AuthEncap(const std::array<uint8_t, 65>& pkR,\n+          const std::array<uint8_t, 32>& skS,\n+          const std::array<uint8_t, 32>& skE,\n+          const std::array<uint8_t, 65>& enc)\n+{\n+    InitCtx();\n+    // Authenticated KEM Encapsulation (Auth mode) - uses static sender key and ephemeral key\n+\n+    // 1. Parse recipient's public key (pkR) into secp256k1_pubkey\n+    secp256k1_pubkey pubR;\n+    if (!secp256k1_ec_pubkey_parse(g_secp256k1_ctx, &pubR, pkR.data(), pkR.size())) {\n+        return std::nullopt; // Invalid recipient public key\n+    }\n+\n+    // 2. Compute sender's public key (pkS) from sender's private key (skS)\n+    std::array<uint8_t, 65> pkS_bytes;\n+    if (!ComputePublicKey(skS.data(), pkS_bytes.data())) {\n+        return std::nullopt; // Invalid sender private key\n+    }\n+\n+    // 2.5. Verify that enc matches skE\n+    std::array<uint8_t, 65> comp_enc;\n+    if (!ComputePublicKey(skE.data(), comp_enc.data())) {\n+        return std::nullopt;\n+    }\n+    if (std::memcmp(comp_enc.data(), enc.data(), NENC) != 0) {\n+        return std::nullopt; // Provided enc does not correspond to skE\n+    }\n+\n+    // 4. Compute two ECDH shared secrets:\n+    //    DH1 = x-coordinate of (skE * pkR), DH2 = x-coordinate of (skS * pkR)\n+    std::array<uint8_t, 32> dh1, dh2;\n+    if (!EcdhXCoordinate(pubR, skE.data(), dh1.data())) {\n+        return std::nullopt;\n+    }\n+    if (!EcdhXCoordinate(pubR, skS.data(), dh2.data())) {\n+        return std::nullopt;\n+    }\n+\n+    // 5. Concatenate DH1 || DH2 (64 bytes total)\n+    uint8_t dh_concat[64];\n+    std::memcpy(dh_concat,      dh1.data(), 32);\n+    std::memcpy(dh_concat + 32, dh2.data(), 32);\n+\n+    // 6. Assemble HPKE KEM context: enc || pkR || pkS (195 bytes)\n+    uint8_t kem_context[65 * 3];\n+    BuildKemContext(enc.data(), pkR.data(), pkS_bytes.data(), kem_context);\n+\n+    // 7. Derive the shared secret via HKDF (using dh_concat and kem_context)\n+    std::array<uint8_t, 32> shared = DeriveSharedSecret(dh_concat, sizeof(dh_concat), kem_context, sizeof(kem_context));\n+    memory_cleanse(dh1.data(), dh1.size());\n+    memory_cleanse(dh2.data(), dh2.size());\n+    memory_cleanse(dh_concat, 64);\n+    return shared;\n+}\n+\n+std::optional<std::array<uint8_t, 32>>\n+AuthDecap(const std::array<uint8_t, 65>& enc,\n+          const std::array<uint8_t, 32>& skR,\n+          const std::array<uint8_t, 65>& pkS)\n+{\n+    InitCtx();\n+    // Authenticated KEM Decapsulation (Auth mode) - uses sender's static public key\n+\n+    // 1. Parse sender's static public key (pkS) and encapsulated ephemeral public key (enc)\n+    secp256k1_pubkey pubS, pubE;\n+    if (!secp256k1_ec_pubkey_parse(g_secp256k1_ctx, &pubS, pkS.data(), pkS.size())) {\n+        return std::nullopt; // Invalid sender public key\n+    }\n+    if (!secp256k1_ec_pubkey_parse(g_secp256k1_ctx, &pubE, enc.data(), enc.size())) {\n+        return std::nullopt; // Invalid encapsulated public key\n+    }\n+\n+    // 2. Verify receiver's private key (skR) is valid\n+    if (secp256k1_ec_seckey_verify(g_secp256k1_ctx, skR.data()) != 1) {\n+        return std::nullopt; // Invalid receiver private key\n+    }\n+\n+    // 2. Perform two ECDH operations with receiver's private key (skR):",
      "path": "src/dhkem_secp256k1.cpp",
      "position": 385,
      "original_position": 385,
      "commit_id": "49358730b1d862f1d470dcabd0e8900fc7ef1775",
      "original_commit_id": "49358730b1d862f1d470dcabd0e8900fc7ef1775",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "There are two 2s here",
      "created_at": "2025-10-29T22:18:37Z",
      "updated_at": "2025-10-29T23:57:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32617#discussion_r2475743528",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2475743528"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32617"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 385,
      "original_line": 385,
      "side": "RIGHT"
    }
  ]
}