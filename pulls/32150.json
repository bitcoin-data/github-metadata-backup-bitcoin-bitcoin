{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150",
    "id": 2420947155,
    "node_id": "PR_kwDOABII586QTLjT",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/32150",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/32150.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/32150.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32150",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32150/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
    "number": 32150,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "coinselection: Optimize BnB exploration",
    "user": {
      "login": "murchandamus",
      "id": 4060799,
      "node_id": "MDQ6VXNlcjQwNjA3OTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/murchandamus",
      "html_url": "https://github.com/murchandamus",
      "followers_url": "https://api.github.com/users/murchandamus/followers",
      "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
      "organizations_url": "https://api.github.com/users/murchandamus/orgs",
      "repos_url": "https://api.github.com/users/murchandamus/repos",
      "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/murchandamus/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "This PR rewrites the implementation of the BnB coinselection algorithm\r\nto skip the duplicate evaluation of previously visited input selections.\r\n\r\nIn the original implementation of BnB, the state of the search is\r\nbacktracked by explicitly walking back to the omission branch and then\r\ntesting again. This retests an equivalent candidate set as before, e.g.,\r\nafter backtracking from {ABC}, it would evaluate {AB_}, before trying\r\n{AB_D}, but {AB_} is equivalent to {AB} which was tested before.\r\n\r\nCoinGrinder tracks the state of the search instead by remembering which\r\nUTXO was last added and explicitly shifting from that UTXO directly to\r\nthe next, so after {ABC}, it will immediately move on to {AB_D}. We\r\nreplicate this approach here.\r\n\r\nAs fewer nodes are visited, this approach will enumerate more possible\r\ncombinations than the original implementation given the same limit for \r\niterations.",
    "labels": [
      {
        "id": 135961,
        "node_id": "MDU6TGFiZWwxMzU5NjE=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
        "name": "Refactoring",
        "color": "E6F6D6",
        "default": false
      }
    ],
    "created_at": "2025-03-27T02:33:51Z",
    "updated_at": "2025-06-20T18:56:40Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "7c6c44a7cd1fb21ad9f48f0f1d485d674389a321",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "murchandamus:2025-03-rewrite-BnB",
      "ref": "2025-03-rewrite-BnB",
      "sha": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 23979970,
        "node_id": "MDEwOlJlcG9zaXRvcnkyMzk3OTk3MA==",
        "name": "bitcoin",
        "full_name": "murchandamus/bitcoin",
        "owner": {
          "login": "murchandamus",
          "id": 4060799,
          "node_id": "MDQ6VXNlcjQwNjA3OTk=",
          "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/murchandamus",
          "html_url": "https://github.com/murchandamus",
          "followers_url": "https://api.github.com/users/murchandamus/followers",
          "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
          "organizations_url": "https://api.github.com/users/murchandamus/orgs",
          "repos_url": "https://api.github.com/users/murchandamus/repos",
          "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/murchandamus/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/murchandamus/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/murchandamus/bitcoin",
        "archive_url": "https://api.github.com/repos/murchandamus/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/murchandamus/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/murchandamus/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/murchandamus/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/murchandamus/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/murchandamus/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/murchandamus/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/murchandamus/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/murchandamus/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/murchandamus/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/murchandamus/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/murchandamus/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/murchandamus/bitcoin/events",
        "forks_url": "https://api.github.com/repos/murchandamus/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/murchandamus/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/murchandamus/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/murchandamus/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/murchandamus/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/murchandamus/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/murchandamus/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/murchandamus/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/murchandamus/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/murchandamus/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/murchandamus/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/murchandamus/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/murchandamus/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/murchandamus/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/murchandamus/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/murchandamus/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:murchandamus/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/murchandamus/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/murchandamus/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/murchandamus/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/murchandamus/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/murchandamus/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/murchandamus/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/murchandamus/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/murchandamus/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/murchandamus/bitcoin/hooks",
        "svn_url": "https://github.com/murchandamus/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 2,
        "stargazers_count": 2,
        "watchers_count": 2,
        "size": 246121,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-06-13T00:35:51Z",
        "created_at": "2014-09-12T23:11:53Z",
        "updated_at": "2025-05-23T21:07:37Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "5757de4ddd37f9321ee6b338b40888fd3561fc00",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 37404,
        "stargazers_count": 84250,
        "watchers_count": 84250,
        "size": 284318,
        "default_branch": "master",
        "open_issues_count": 756,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-06-19T15:46:09Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-06-20T16:44:51Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 188,
    "deletions": 102,
    "changed_files": 3,
    "commits": 7,
    "review_comments": 29,
    "comments": 11
  },
  "events": [
    {
      "event": "commented",
      "id": 2756305237,
      "node_id": "IC_kwDOABII586kSeFV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2756305237",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-27T02:33:54Z",
      "updated_at": "2025-06-14T02:59:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32150.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [achow101](https://github.com/bitcoin/bitcoin/pull/32150#issuecomment-2972167678) |\n| Concept ACK | [yancyribbens](https://github.com/bitcoin/bitcoin/pull/32150#issuecomment-2758592756) |\n\nIf your review is incorrectly listed, please react with üëé to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (‚ú® experimental)\n\nPossible typos and grammar issues:\n\n- ‚Äúals well as‚Äù ‚Üí ‚Äúas well as‚Äù [typo in ‚Äúals‚Äù]  \n- ‚Äúmatches the the effective value‚Äù ‚Üí ‚Äúmatches the effective value‚Äù [duplicated ‚Äúthe‚Äù]  \n- ‚Äúsolution is chosen by minimal waste score‚Äù ‚Üí ‚ÄúThe solution is chosen by minimal waste score‚Äù [missing article ‚ÄúThe‚Äù]\n\n<sup>drahtbot_id_4_m</sup>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#issuecomment-2756305237",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32150"
    },
    {
      "event": "labeled",
      "id": 17003394747,
      "node_id": "LE_lADOABII586v6UtWzwAAAAP1eza7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17003394747",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-27T02:33:57Z",
      "label": {
        "name": "Refactoring",
        "color": "E6F6D6"
      }
    },
    {
      "event": "convert_to_draft",
      "id": 17003398361,
      "node_id": "CTDE_lADOABII586v6UtWzwAAAAP1e0TZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17003398361",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-27T02:34:29Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17013761145,
      "node_id": "HRFPE_lADOABII586v6UtWzwAAAAP2GWR5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17013761145",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "613df18b00c6a5b23d829738892438ce64be27f3",
      "commit_url": "https://api.github.com/repos/murchandamus/bitcoin/commits/613df18b00c6a5b23d829738892438ce64be27f3",
      "created_at": "2025-03-27T13:35:36Z"
    },
    {
      "event": "commented",
      "id": 2758592756,
      "node_id": "IC_kwDOABII586kbMj0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2758592756",
      "actor": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-27T16:05:49Z",
      "updated_at": "2025-03-27T16:05:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#issuecomment-2758592756",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32150"
    },
    {
      "event": "commented",
      "id": 2758612172,
      "node_id": "IC_kwDOABII586kbRTM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2758612172",
      "actor": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-27T16:12:30Z",
      "updated_at": "2025-03-27T16:12:30Z",
      "author_association": "CONTRIBUTOR",
      "body": "I ran benchmarking on master and benchmarking on this branch since it's fairly large change.\r\n\r\nmaster:\r\n```\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|       43,633,696.00 |               22.92 |    0.1% |      0.48 | `CoinSelection`\r\n```\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/32150/commits/e2a4d86131e8f1661eb450c50b8072147965b111:\r\n```\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|       40,433,894.00 |               24.73 |    0.1% |      0.44 | `CoinSelection`\r\n```\r\n\r\nlooks like a marginal improvement in bechmarked performance.\r\n",
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#issuecomment-2758612172",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32150"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17065461357,
      "node_id": "HRFPE_lADOABII586v6UtWzwAAAAP5LkZt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17065461357",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "5ac0d02b3a7e678a0cf206ad676b6de0b215787c",
      "commit_url": "https://api.github.com/repos/murchandamus/bitcoin/commits/5ac0d02b3a7e678a0cf206ad676b6de0b215787c",
      "created_at": "2025-04-01T00:04:33Z"
    },
    {
      "event": "commented",
      "id": 2767684548,
      "node_id": "IC_kwDOABII586k94PE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2767684548",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-01T00:05:57Z",
      "updated_at": "2025-04-01T00:05:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased on #29532",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#issuecomment-2767684548",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32150"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17065491779,
      "node_id": "HRFPE_lADOABII586v6UtWzwAAAAP5Lr1D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17065491779",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "44bab80284f3710ee30805ec3c5da06dd06d4d71",
      "commit_url": "https://api.github.com/repos/murchandamus/bitcoin/commits/44bab80284f3710ee30805ec3c5da06dd06d4d71",
      "created_at": "2025-04-01T00:08:48Z"
    },
    {
      "event": "reviewed",
      "id": 2733815682,
      "node_id": "PRR_kwDOABII586i8reC",
      "url": null,
      "actor": null,
      "commit_id": "d765ba9ae567cf3192706223d873d041f71f9c82",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#pullrequestreview-2733815682",
      "submitted_at": "2025-04-01T19:12:26Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
    },
    {
      "event": "renamed",
      "id": 17082914103,
      "node_id": "RTE_lADOABII586v6UtWzwAAAAP6OJU3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17082914103",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-01T21:32:10Z",
      "rename": {
        "from": "refactor: Optimize BnB exploration",
        "to": "coinselection: Optimize BnB exploration"
      }
    },
    {
      "event": "commented",
      "id": 2773089158,
      "node_id": "IC_kwDOABII586lSfuG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2773089158",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-02T16:14:13Z",
      "updated_at": "2025-04-02T16:14:13Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I ran benchmarking on master and benchmarking on this branch since it's fairly large change.\r\n\r\nIf I remember right the Coin Selection benchmark is rather non-representative. I have a todo to update it somewhere in my backlog.",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#issuecomment-2773089158",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32150"
    },
    {
      "event": "commented",
      "id": 2776283405,
      "node_id": "IC_kwDOABII586lerkN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2776283405",
      "actor": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T16:04:18Z",
      "updated_at": "2025-04-03T16:04:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "> If I remember right the Coin Selection benchmark is rather non-representative. I have a todo to update it somewhere in my backlog.\r\n\r\nGood point.  I took a quick look, and the current benchmark runs BnB for only `4` iterations.  there are `1,000` clones and one non clone so most of the work is done by skipping clones which isn't very representative as you say.\r\n\r\nInstead of keeping this in your backlog, shouldn't there be an issue opened so it doesn't get overlooked?  Maybe someone else has the bandwidth to pick it up.  Possibly I could but I also have a large backlog of I'd like to work on.\r\n\r\nAlso, I note there is also `BnBExhaustion(benchmark::Bench& bench)` which is probably more \"representative\" although it also looks like you have a [TODO](https://github.com/bitcoin/bitcoin/pull/29532/files#diff-36ddaeb9e3a5c1aaaccd6b1ed6c770e8344e33dbfd4876b5f0726d84ab47cbab) to re-write that as well:\r\n\r\n> Worth noting that src/bench/coin_selection.cpp makes a copy of the make_hard_case function (commenting as such), so removal here may lead to confusion unless that benchmark is also updated.\r\n",
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#issuecomment-2776283405",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32150"
    },
    {
      "event": "labeled",
      "id": 17448870241,
      "node_id": "LE_lADOABII586v6UtWzwAAAAQQCKFh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17448870241",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-29T06:36:52Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 17499936110,
      "node_id": "UNLE_lADOABII586v6UtWzwAAAAQTE9Vu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17499936110",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-02T13:21:26Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17503548696,
      "node_id": "HRFPE_lADOABII586v6UtWzwAAAAQTSvUY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17503548696",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "9cfab3be80f0b6c927f780d0470b030a6068135c",
      "commit_url": "https://api.github.com/repos/murchandamus/bitcoin/commits/9cfab3be80f0b6c927f780d0470b030a6068135c",
      "created_at": "2025-05-02T18:43:55Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17506356821,
      "node_id": "HRFPE_lADOABII586v6UtWzwAAAAQTdc5V",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17506356821",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "155d6d926a044826f18be4d2ad8be2dfe463eb41",
      "commit_url": "https://api.github.com/repos/murchandamus/bitcoin/commits/155d6d926a044826f18be4d2ad8be2dfe463eb41",
      "created_at": "2025-05-03T01:43:12Z"
    },
    {
      "event": "ready_for_review",
      "id": 17546393666,
      "node_id": "RFRE_lADOABII586v6UtWzwAAAAQV2LhC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17546393666",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-06T23:35:32Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17581090335,
      "node_id": "HRFPE_lADOABII586v6UtWzwAAAAQX6iYf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17581090335",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "447551732c999ace9587fe5462305ef1f5bb4fce",
      "commit_url": "https://api.github.com/repos/murchandamus/bitcoin/commits/447551732c999ace9587fe5462305ef1f5bb4fce",
      "created_at": "2025-05-08T21:57:03Z"
    },
    {
      "event": "commented",
      "id": 2864494772,
      "node_id": "IC_kwDOABII586qvLi0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2864494772",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-08T21:57:54Z",
      "updated_at": "2025-05-08T21:57:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "The preceding PR https://github.com/bitcoin/bitcoin/pull/29532 got merged, so this is now ready for review.",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#issuecomment-2864494772",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32150"
    },
    {
      "event": "reviewed",
      "id": 2918338099,
      "node_id": "PRR_kwDOABII586t8k4z",
      "url": null,
      "actor": null,
      "commit_id": "df20dd4f905a0d04e48bfe20919cccaff11b9b30",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#pullrequestreview-2918338099",
      "submitted_at": "2025-06-11T18:48:31Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
    },
    {
      "event": "reviewed",
      "id": 2918347276,
      "node_id": "PRR_kwDOABII586t8nIM",
      "url": null,
      "actor": null,
      "commit_id": "447551732c999ace9587fe5462305ef1f5bb4fce",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "I think the last 2 commits \"opt: Skip evaluation of equivalent input sets\" and \"opt: Skip evaluation of equivalent input sets\" could be combined. The change the last commit makes is to the comment introduced in the commit before it, and removing a line introduced in the commit before it. We generally don't want to add code just to immediately remove it, so I think these can be squashed together.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#pullrequestreview-2918347276",
      "submitted_at": "2025-06-11T20:22:44Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDYwY2I2YTA3OGQxMTg4NGZiNDNjYzM1ZDg4ZDQzYmUzMDc5OGU5ZjU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/60cb6a078d11884fb43cc35d88d43be30798e9f5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/60cb6a078d11884fb43cc35d88d43be30798e9f5",
      "tree": {
        "sha": "b2fcd577d2e368e270e83026469b67175685ad4e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b2fcd577d2e368e270e83026469b67175685ad4e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree b2fcd577d2e368e270e83026469b67175685ad4e\nparent ad5cd129f3cc72f2d2b140e182781bf3bb5dbacc\nauthor Murch <murch@murch.one> 1743028363 -0700\ncommitter Murch <murch@murch.one> 1749687489 -0700\n\ncoinselection: Track BnB iteration count in result\n\nThe expected iteration count demonstrates how the following improvements\nreduce iterations will help catch any regressions in the future.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEENfStpiPrn+OjvH72e6A1yluQFxMFAmhKHMMQHG11cmNoQG11\ncmNoLm9uZQAKCRB7oDXKW5AXE8VWEACD2iAgezHazj9fQYnKFHuJWBTmFgsw/l8+\nNBT9JQ3nyk5NM4uAIUluQFKCPAqpt0sJSA7FkbBNOWH4KmanN6CQNS7L0s7A6etn\nG+LIKxuwqvJ4Wqho589ekLKd0MZI/4SeVjuL04V3BFDPgQK/4vf0YgRIEynd5XEK\ni5PG/roe09omO1J4vLi320qjZLuKIv7PIWBus/4Qr7rQ9kjay1Z9bWIa4C1Er5/t\nCqQDPFc7YW68fZjHCuleYKYdopwkEslqhgdeO3C7i8Z5ll/PyKAyA02+cQS46xyj\nSJEHTijvJsdgxVGh/j7cXXGBejnTWca1AEyc1at4WC5BsP7o2EbAvWZ2GgH1/CFt\nLoiy90GrpjamUhjhv27CkwmZZN3Ie+N791Y6gA7g38O/sWZvzOx+NpIuAzlgpDqv\n98/4s0WbMaNmOWOIjHNyOIKK/o+Z7tCfw0PIA8UqAAhMqrckt4/CEfYv557yW0Ld\nUmLxz0XeYo4+Nsfab5FwjUcw5JDf2raJvmbaRJkHqthcL2f2SZXuY7wemq8PzeL9\nRQE1etBteYAu5TzJ5g6p+x1SaYD3q8O5R7QR+3+zjD/PYB1K+ATGHAHOLRMzQBLI\nwH8LAnI/UDhQOOpKUDyNhNT3qt+pDT8cAG/Gan75N2WRwpAbQZWBOyccGr0/BZAs\ncActrhF3HA==\n=IjkR\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ad5cd129f3cc72f2d2b140e182781bf3bb5dbacc",
          "sha": "ad5cd129f3cc72f2d2b140e182781bf3bb5dbacc",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ad5cd129f3cc72f2d2b140e182781bf3bb5dbacc"
        }
      ],
      "message": "coinselection: Track BnB iteration count in result\n\nThe expected iteration count demonstrates how the following improvements\nreduce iterations will help catch any regressions in the future.",
      "committer": {
        "name": "Murch",
        "email": "murch@murch.one",
        "date": "2025-06-12T00:18:09Z"
      },
      "author": {
        "name": "Murch",
        "email": "murch@murch.one",
        "date": "2025-03-26T22:32:43Z"
      },
      "sha": "60cb6a078d11884fb43cc35d88d43be30798e9f5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRiZTQ3ZTU4YmRmNTMwMzUxYTdiYzgxYWU5NjFhZDBhNzI3N2ZiOWI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4be47e58bdf530351a7bc81ae961ad0a7277fb9b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4be47e58bdf530351a7bc81ae961ad0a7277fb9b",
      "tree": {
        "sha": "479b6d082c6d10a06ba9e9387aafb7c53ef849fc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/479b6d082c6d10a06ba9e9387aafb7c53ef849fc"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 479b6d082c6d10a06ba9e9387aafb7c53ef849fc\nparent 60cb6a078d11884fb43cc35d88d43be30798e9f5\nauthor Murch <murch@murch.one> 1743031081 -0700\ncommitter Murch <murch@murch.one> 1749687498 -0700\n\ncoinselection: rewrite BnB in CoinGrinder-style\n\nIn the original implementation of BnB, the state of the search is\nbacktracked by explicitly walking back to the omission branch and then\ntesting again. This retests an equivalent candidate set as before, e.g.,\nafter backtracking from {ABC}, it would evaluate {AB_}, before trying\n{AB_D}, but {AB_} is equivalent to {AB} which was tested before.\n\nCoinGrinder tracks the state of the search instead by remembering which\nUTXO was last added and explicitly shifting from that UTXO directly to\nthe next, so after {ABC}, it will immediately move on to {AB_D}. We\nreplicate this approach here.\n\nThe description of the two optimizations is removed from the\ndocumentation as they will only be implented in a later commit.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEENfStpiPrn+OjvH72e6A1yluQFxMFAmhKHMoQHG11cmNoQG11\ncmNoLm9uZQAKCRB7oDXKW5AXE4bqEAC2simwAZ9AtDOPWYWn9AQ/U2qaVp5tcTD/\ntoEmYYa+FLXQL5//j/yiZ/4etl7R4nwNz1x/m9ZNqDgWdcecxFT7iLnPtSUbbgZk\n5WNNOC1o8D6pzQXiAkhv23IerPW2l0jKZ6w/1Z1G4vjgYayBLsg5b4h9+3mnWjLq\nCuqACZj9oeoT3lDQP2fwAv7+fVVj0C98FK+Ql4MRtvvlfHJhOBIgHYrSSm3WL/hh\n+93tHodcPazZtDcyt+2ucBlNcoFBxz6l73tRLSSseiHodYqQBo54kXXrGO5nr8KP\ntCgTt/UWXgrwfbhK+RDY1mwYACTBufSrE+FLS5x1xt81ABRM1IZbcr6++c7IyrXm\n2MGztppM0/kXK8WHChAkUS3K3glcLV/0Sfrln3Xtqj7tREb/BBN58diLyxZm+/+3\netJTMvwny+7QZuEFOkTpARk8U8kigbncjCr1IiemgTYyfp+NRy9nIfJRETTX+UEK\nKbCPLnaPANE/FMt9a5vprhDHRoikxNHO6BREhuNrWGiuIsOH0C8OQPxIUGDyfZUH\nTnpCS+v+nlY/NX5AfasTGhtjoS7iyd5atOr1tSdkPEa7XdN1NQZ+PZ+SdC0eNW3M\nlJ9bzyXLi6KdO8YsYLCDOH6m8dwkhMIuRNoMHeCqzJK1AGnZe3mwIig4aHraP5qA\nNednCUgmDw==\n=q4mw\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/60cb6a078d11884fb43cc35d88d43be30798e9f5",
          "sha": "60cb6a078d11884fb43cc35d88d43be30798e9f5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/60cb6a078d11884fb43cc35d88d43be30798e9f5"
        }
      ],
      "message": "coinselection: rewrite BnB in CoinGrinder-style\n\nIn the original implementation of BnB, the state of the search is\nbacktracked by explicitly walking back to the omission branch and then\ntesting again. This retests an equivalent candidate set as before, e.g.,\nafter backtracking from {ABC}, it would evaluate {AB_}, before trying\n{AB_D}, but {AB_} is equivalent to {AB} which was tested before.\n\nCoinGrinder tracks the state of the search instead by remembering which\nUTXO was last added and explicitly shifting from that UTXO directly to\nthe next, so after {ABC}, it will immediately move on to {AB_D}. We\nreplicate this approach here.\n\nThe description of the two optimizations is removed from the\ndocumentation as they will only be implented in a later commit.",
      "committer": {
        "name": "Murch",
        "email": "murch@murch.one",
        "date": "2025-06-12T00:18:18Z"
      },
      "author": {
        "name": "Murch",
        "email": "murch@murch.one",
        "date": "2025-03-26T23:18:01Z"
      },
      "sha": "4be47e58bdf530351a7bc81ae961ad0a7277fb9b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQ3MDRkOTdlZDI5M2ZmZmZkZWU3Y2RlMjE5ZjQxYmUzNzc4MzYzODE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d704d97ed293ffffdee7cde219f41be377836381",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d704d97ed293ffffdee7cde219f41be377836381",
      "tree": {
        "sha": "69b0a1d410ea8facd1395f2f716cdb7d5de1aa55",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/69b0a1d410ea8facd1395f2f716cdb7d5de1aa55"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 69b0a1d410ea8facd1395f2f716cdb7d5de1aa55\nparent 4be47e58bdf530351a7bc81ae961ad0a7277fb9b\nauthor Murch <murch@murch.one> 1743034698 -0700\ncommitter Murch <murch@murch.one> 1749687500 -0700\n\ncoinselection: Track whether BnB completed\n\nBnB may not be able to exhaustively search all potentially interesting\ncombinations for large UTXO pools, so we keep track of whether the\nsearch was terminated by the iteration limit.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEENfStpiPrn+OjvH72e6A1yluQFxMFAmhKHMwQHG11cmNoQG11\ncmNoLm9uZQAKCRB7oDXKW5AXExqoEADEs1GpVTDJH8N3S1IfuPJO/9COWEWiky4H\nxerBf5x1dVoUqT+74h/sBa1Z1ppgkdrNN30UcddQKlfpkeqTJmwtiTXf3QzC/xhj\n+IBICUWTfytWkqo8k+sMllHOmqjGp+qJp2ef7GgeH8NthQv70XjD+VFTxe/Qq+tg\n53F77kAX5WIOwoGw2KcGZoSxKOhCvAzvsQKWZhQK/AiXl7aJPquLmvWGdqfC9jbE\nfGITwSqZexLSajejAT4jpZGzYc8lcLEUfDOk7MXOKlyrHkGKoWDEoqMHiDUpAhEG\nm3oocwAlrWL6gzr7g1CPX1EIZGxScEI2nvORd7m+yp/6ZgbQjrsiKkMxZ/dO5mew\nFMEbrko267veED6G37kvGgv9ujEcvPtkfgbhwy5lPOkD6TBxznOA6Kj1QKWPzek2\n1NKT8V2m4QAGV+0twuG/v4LjEJ9BRHlCVBGjjiBDRMnXk/NAO1rtiOaOkZADn+aH\nvM44o2Jp+vGb0u6QvVGOr95nP/KacMVgMJpN0amkp2Y9sHa55I4uIKUb0ID9T2CK\nRVQ1Rv9sg+kGRBukdq7zqOMxVvB6fA9BfK4/DqXqRqymI8rgKgsq514ob6ndkICd\ne1Nndmv8sKjpOROtf+3+9QpVLWEnx0ojL/oA9XKFpp7WAAe2dmOX5PN8fXT05ovE\nL3GwLngX5Q==\n=GMc1\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4be47e58bdf530351a7bc81ae961ad0a7277fb9b",
          "sha": "4be47e58bdf530351a7bc81ae961ad0a7277fb9b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4be47e58bdf530351a7bc81ae961ad0a7277fb9b"
        }
      ],
      "message": "coinselection: Track whether BnB completed\n\nBnB may not be able to exhaustively search all potentially interesting\ncombinations for large UTXO pools, so we keep track of whether the\nsearch was terminated by the iteration limit.",
      "committer": {
        "name": "Murch",
        "email": "murch@murch.one",
        "date": "2025-06-12T00:18:20Z"
      },
      "author": {
        "name": "Murch",
        "email": "murch@murch.one",
        "date": "2025-03-27T00:18:18Z"
      },
      "sha": "d704d97ed293ffffdee7cde219f41be377836381"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZiMWZhOTU0ZjYwOTZlMTg5Y2MyZWFiNzg4NjBhYzEwYzNkYzE5ZmE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fb1fa954f6096e189cc2eab78860ac10c3dc19fa",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/fb1fa954f6096e189cc2eab78860ac10c3dc19fa",
      "tree": {
        "sha": "d02e151ae7ac6fc7b92eb6fb0d5209d3ff76d191",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d02e151ae7ac6fc7b92eb6fb0d5209d3ff76d191"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree d02e151ae7ac6fc7b92eb6fb0d5209d3ff76d191\nparent d704d97ed293ffffdee7cde219f41be377836381\nauthor Murch <murch@murch.one> 1743038247 -0700\ncommitter Murch <murch@murch.one> 1749687503 -0700\n\ncoinselection: BnB skip exploring high waste\n\nAt high feerates adding more inputs will increase the waste score. If\nthe current waste is already higher than the best selection‚Äôs we cannot\nimprove upon the best selection. All solutions that include the current\nselection with more additional inputs must be worse than the best\nselection so far: SHIFT\n\nThis optimization only works at high feerates, because at low feerates,\nadding more inputs decreases waste, so this condition would exit\nprematurely. We would never attempt input sets with higher weight than\nthe prior best selection, even though we would prefer those at low\nfeerates.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEENfStpiPrn+OjvH72e6A1yluQFxMFAmhKHM8QHG11cmNoQG11\ncmNoLm9uZQAKCRB7oDXKW5AXE+epD/0dgpX/SGNh/8ThFHQpQ8YguoDCGCGJB5Mz\n08XSvhNKO61sIKTR9Cyvm264CIdB8o0NtEncgDCW4u5VGNStCYQ0cTy3lJsvvQ+M\nLJHg+Z/ZXH1iInKgBIAYxyJjaDkQz2+CVIZ+osSoZk66Y9wl0xgS9zGA4AEZ/E+6\nzsBhuWj15Jf7oduearidDXVqk/0L4qliDHhZb9F/h57LgxUULYJ8oB79YVJf1OHH\nwjIupacOD2ZKNdzV2exPLEAVc2bsaAfGEni91UTV2DrEWnGMQexOnMft5/8qnd5V\nSys00IIL87Sksj6dImIsEbUC2+JPCf42Q5OAquOWrWDmW+vKRHuQpKVluRHtSLq2\n8Sghg2yAO9dU7C3ChcYdqKeALKZmYv6mZA8vqLi4oVa3csEMv3PGx8LDCYdrqC5j\nwvjICVx1lL/5MnbZjcyau8jLY+CBMBLjuHAvIy9UoL08pLlFtppuHUCxXv2KmPz4\nuvgC5+LXX3Txy828VRmcTKy3Kcs+9IZAhAj0gbfMiAItt74hR0f2B6LLUCiWjsh5\nVzihrAR0GrgdHc4BJsVNGeiu43d2HWUj6AgSlkPvd6F1n2npDqFR0r3q7ZrVhZSR\nrEizSckjZlROHteCB67jWpMRiGbVIyMc3h7ypKiAtycvMc0pwOHYtkcCkNLdkY76\nK09sYM3klA==\n=TTwv\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d704d97ed293ffffdee7cde219f41be377836381",
          "sha": "d704d97ed293ffffdee7cde219f41be377836381",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d704d97ed293ffffdee7cde219f41be377836381"
        }
      ],
      "message": "coinselection: BnB skip exploring high waste\n\nAt high feerates adding more inputs will increase the waste score. If\nthe current waste is already higher than the best selection‚Äôs we cannot\nimprove upon the best selection. All solutions that include the current\nselection with more additional inputs must be worse than the best\nselection so far: SHIFT\n\nThis optimization only works at high feerates, because at low feerates,\nadding more inputs decreases waste, so this condition would exit\nprematurely. We would never attempt input sets with higher weight than\nthe prior best selection, even though we would prefer those at low\nfeerates.",
      "committer": {
        "name": "Murch",
        "email": "murch@murch.one",
        "date": "2025-06-12T00:18:23Z"
      },
      "author": {
        "name": "Murch",
        "email": "murch@murch.one",
        "date": "2025-03-27T01:17:27Z"
      },
      "sha": "fb1fa954f6096e189cc2eab78860ac10c3dc19fa"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGRlOGJjYjA0M2RjOGFjOWNhNGMzZmE5N2YyNmI4Mjk3YWNkZmRlYTk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/de8bcb043dc8ac9ca4c3fa97f26b8297acdfdea9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/de8bcb043dc8ac9ca4c3fa97f26b8297acdfdea9",
      "tree": {
        "sha": "2f179961449be8a6c2096e1a044bc47763249822",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2f179961449be8a6c2096e1a044bc47763249822"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 2f179961449be8a6c2096e1a044bc47763249822\nparent fb1fa954f6096e189cc2eab78860ac10c3dc19fa\nauthor Murch <murch@murch.one> 1743038662 -0700\ncommitter Murch <murch@murch.one> 1749687505 -0700\n\ncoinselection: Track effective_value lookahead\n\nIntroduces a dedicated data structure to track the total\neffective_value available in the remaining UTXOs at each index of the\nUTXO pool. In contrast to the original approach in BnB, this allows us\nto immediately jump to a lower index instead of visiting every UTXO to\nadd back their eff_value to the lookahead.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEENfStpiPrn+OjvH72e6A1yluQFxMFAmhKHNEQHG11cmNoQG11\ncmNoLm9uZQAKCRB7oDXKW5AXE/0cD/9UTQC/+JXgXkfARibBf1PJwTJWFC0ef1hb\nIpJIR2QtzwQqsKcJqCoqvrQ6zSzv9zfG3jkbQkXy5ULoJ0zLkKJNhST4vYUV0xfD\nZpXnvlaLs+F9ta72K0TMTXutfSWspLKeq0AVmhAPb34P843118CL+8/3bP8srKvf\nnzLo78aGASsehuDOSKTKIsw5DlFBvpZWhi8nRZph9SJ9+LF+56ATGm9ObBH/OQyl\no0zAgIaikZpT1DLch6/2m4oM1ps/8iajGnJ5sHEYgzfJsLfu1kwqSc33SUkbHxcM\nyn3FUQVH85jV3uefzQcsIxyyIyCE+oJp40bKpsTEe7+ZDqAdxzo472usqcFtj3Nj\n2eHSbkX1LFMx3o+Js7PQUrHP7eiB7tmb07knuUup5t+cOoDVhCVx5n0g3kHrwy/f\nmrLNEUYOCaFDzUcFQVEDYxEqHU/hD4zxwkTygfKu5UB1B6VfsnNIfet0JRuJKRW9\nitRu3GGMXgEt9kCInFqUnKvSLHX+gMcufcJGKs0DfQPQBRuawjFgCGT9cUaBDqr+\nBFfJvxre1okDaffs7zfpbnI+oYm3VXMYEw8rTGFT3ew6mLZfzqq6KTmC3/1fHxuT\nmJW2BvTIaEm1VkewyFRzxar3YPx1ODuOO+voq2ruozihpcfyvynAfk37WwamCNTj\nAKNBtp5azw==\n=eFnY\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fb1fa954f6096e189cc2eab78860ac10c3dc19fa",
          "sha": "fb1fa954f6096e189cc2eab78860ac10c3dc19fa",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/fb1fa954f6096e189cc2eab78860ac10c3dc19fa"
        }
      ],
      "message": "coinselection: Track effective_value lookahead\n\nIntroduces a dedicated data structure to track the total\neffective_value available in the remaining UTXOs at each index of the\nUTXO pool. In contrast to the original approach in BnB, this allows us\nto immediately jump to a lower index instead of visiting every UTXO to\nadd back their eff_value to the lookahead.",
      "committer": {
        "name": "Murch",
        "email": "murch@murch.one",
        "date": "2025-06-12T00:18:25Z"
      },
      "author": {
        "name": "Murch",
        "email": "murch@murch.one",
        "date": "2025-03-27T01:24:22Z"
      },
      "sha": "de8bcb043dc8ac9ca4c3fa97f26b8297acdfdea9"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDYwMmJjMTY1MDYwMjMwYjI0NGQyOWNkZTNhNWExY2NmNDYxNDZlOTM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/602bc165060230b244d29cde3a5a1ccf46146e93",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/602bc165060230b244d29cde3a5a1ccf46146e93",
      "tree": {
        "sha": "db76b56ca1fa84d1f522256969e4f9cfe281ff2e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/db76b56ca1fa84d1f522256969e4f9cfe281ff2e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree db76b56ca1fa84d1f522256969e4f9cfe281ff2e\nparent de8bcb043dc8ac9ca4c3fa97f26b8297acdfdea9\nauthor Murch <murch@murch.one> 1743039981 -0700\ncommitter Murch <murch@murch.one> 1749687506 -0700\n\nopt: Skip evaluation of equivalent input sets\n\nWhen two successive UTXOs match in effective value and weight, we can\nskip the second if the prior is not selected: adding it would create an\nequivalent input set to a previously evaluated.\n\nE.g. if we have three UTXOs with effective values {5, 3, 3} of the same\nweight each, we want to evaluate\n{5, _, _}, {5, 3, _}, {5, 3, 3}, {_, 3, _}, {_, 3, 3},\nbut skip {5, _, 3}, and {_, _, 3}, because the first 3 is not selected,\nand we therefore do not need to evaluate the second 3 at the same\nposition in the input set.\n\nIf we reach the end of the branch, we must SHIFT the previously selected\nUTXO group instead.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEENfStpiPrn+OjvH72e6A1yluQFxMFAmhKHNIQHG11cmNoQG11\ncmNoLm9uZQAKCRB7oDXKW5AXE8tMD/94Ni6dBYKAdhZeAPM7AOFE/JMoBUjozXPP\nLqLAlwQ4VcwRcW5/0RqlL/Jak1ZOXOOnIPiKu+Mkvxx4K387MZHnE7/DjfSSaJAp\nkZfsg8bvCofjGBSMHnEdGT0N1DoyhJMLUPl13uspq+6P4nDtFH1Do35SVcDsOGoX\npFvIgMKyl7OMMfE0xLV06Y7KDXwpcYiufGo+w7nw3cX6sKKJEEG4dsOMG45qxx1N\n91baljP1oQNMXAoS7+9k4zOpEcoJ8e55LYGX3HfHZTGy34IrIaKiCSf3iZ6vEwzZ\nmnZ88wlVzoByT9qc3NSq7tnY68/ovrLv2VZIZSh1p2uuBQkmaLFB6Y9xeN7hQL38\nY6lUkitlrEP5z+Cugh0xhIloBpImPz67ZqR6vsr0BI5k983yIYXr1fkVq/cLlEPb\nAAid5+KMo9gKGEUKqrRDzvLucfKeIP4jkWoYNb3dxBtqbtFlrtn3QsHrs0tjWYC7\nd9nz1DkdyJejxka6R1j3FwErlfdI2U1KgAtBx05Eb+beZrLV1VoXXZlVCVUmx85n\nUSdTMGqRDNXhMYVKtFnATPQuyfwrqCKTzoxPfVbE/RyP88u/kSE/JXo+tTdY8Iph\nV697c1G5YRQasKLq1qn9vR1OKYyVLw1nI6lbLtxfee9i0NLjK7/JE6JPueWHnPB7\nbhDgkv36BA==\n=qftR\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/de8bcb043dc8ac9ca4c3fa97f26b8297acdfdea9",
          "sha": "de8bcb043dc8ac9ca4c3fa97f26b8297acdfdea9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/de8bcb043dc8ac9ca4c3fa97f26b8297acdfdea9"
        }
      ],
      "message": "opt: Skip evaluation of equivalent input sets\n\nWhen two successive UTXOs match in effective value and weight, we can\nskip the second if the prior is not selected: adding it would create an\nequivalent input set to a previously evaluated.\n\nE.g. if we have three UTXOs with effective values {5, 3, 3} of the same\nweight each, we want to evaluate\n{5, _, _}, {5, 3, _}, {5, 3, 3}, {_, 3, _}, {_, 3, 3},\nbut skip {5, _, 3}, and {_, _, 3}, because the first 3 is not selected,\nand we therefore do not need to evaluate the second 3 at the same\nposition in the input set.\n\nIf we reach the end of the branch, we must SHIFT the previously selected\nUTXO group instead.",
      "committer": {
        "name": "Murch",
        "email": "murch@murch.one",
        "date": "2025-06-12T00:18:26Z"
      },
      "author": {
        "name": "Murch",
        "email": "murch@murch.one",
        "date": "2025-03-27T01:46:21Z"
      },
      "sha": "602bc165060230b244d29cde3a5a1ccf46146e93"
    },
    {
      "event": "reviewed",
      "id": 2918744321,
      "node_id": "PRR_kwDOABII586t-IEB",
      "url": null,
      "actor": null,
      "commit_id": "447551732c999ace9587fe5462305ef1f5bb4fce",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "I think I addressed everything, except the issue for the follow-up.",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#pullrequestreview-2918744321",
      "submitted_at": "2025-06-12T00:36:41Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18103685884,
      "node_id": "HRFPE_lADOABII586v6UtWzwAAAAQ3EFL8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18103685884",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "51ae8024175a75ff0d194d23c2e602b74bec73e1",
      "commit_url": "https://api.github.com/repos/murchandamus/bitcoin/commits/51ae8024175a75ff0d194d23c2e602b74bec73e1",
      "created_at": "2025-06-12T00:37:10Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNmMzZkMWFmMThmMWZkYjJmOTg0NjYzNDAzMmY0NjhkMDBkN2RkZmI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "tree": {
        "sha": "bf7758ba333b5afc24b58254df988af7f0c7148a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bf7758ba333b5afc24b58254df988af7f0c7148a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree bf7758ba333b5afc24b58254df988af7f0c7148a\nparent 602bc165060230b244d29cde3a5a1ccf46146e93\nauthor Murch <murch@murch.one> 1743040770 -0700\ncommitter Murch <murch@murch.one> 1749753252 -0700\n\nopt: Skip UTXOs with worse waste, same eff_value\n\nWhen two successive UTXOs differ in waste but match in effective value,\nwe can skip the second if the first is not selected, because all input\nsets we can generate by swapping out a less wasteful UTXOs with a more\nwastefull UTXO of matching effective value would be strictly worse.\n\nAlso expand documentation of Branch and Bound.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJEBAABCgAuFiEENfStpiPrn+OjvH72e6A1yluQFxMFAmhLHbcQHG11cmNoQG11\ncmNoLm9uZQAKCRB7oDXKW5AXEw5kD/4rel4dT0ZW/EM4LhhRyq6aYglVEWFhEj9i\nIIcFjdgpEpSx6kIv6Aw8IUKftU9rGDJQlAiZVJeX10ue5aHyI86NymibIqmp04wt\nz34tMbPLQRhgZAy2sos+QAc5DuHj5dW+MW5H47ylIZgyFF9oLOF6gtaHYQ4B3C1R\nAcTGlrlTkSseqEaDOTxc8wrB5lMiy8OwDL4ESwzkDhXc20sDF2nWHMiVH9l+w/kE\nnnrJISxFRyvE8Q8xgoXOVvcDk+4BwqdZzMEqTZhEPHNS2l5Z1ijF1ve70xTDIIj4\nKypiuDMyWsKAgyOOkapGXZFyuDcWNXf/l4dn52GiTluycF+P7+J/bpWB7dZYC07L\nQxcg5ppzmr80pTIs4uojRo7iaRIk1/m+QiLECkoes07l+qF2Oj6+egXZsfDaO3wI\nyEivv1nU/9THAM+FYMihpjrneALR7Up2BO/JOw4uYiHuRNKabfA032tye6x1Dc6L\n5XNuzmRcAW0tnRcW6JXeUhRMXR6OWHGtudt8l7KcjoyeX+fRO52w7fSpl6xvbhWt\ng0vIsad7VS84Y7t2nSy3vbvhjOHGC5J29nrS0dky5Q/m1TM1THa77yAKT3V4N/nc\ntbKUXlwjTLJ8ocQ54GYK1m/pex8kcidpn8j1aHU+aiCSHZiql4BvRA619rRmOYSd\nwZCuhIwUpg==\n=JUDQ\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/602bc165060230b244d29cde3a5a1ccf46146e93",
          "sha": "602bc165060230b244d29cde3a5a1ccf46146e93",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/602bc165060230b244d29cde3a5a1ccf46146e93"
        }
      ],
      "message": "opt: Skip UTXOs with worse waste, same eff_value\n\nWhen two successive UTXOs differ in waste but match in effective value,\nwe can skip the second if the first is not selected, because all input\nsets we can generate by swapping out a less wasteful UTXOs with a more\nwastefull UTXO of matching effective value would be strictly worse.\n\nAlso expand documentation of Branch and Bound.",
      "committer": {
        "name": "Murch",
        "email": "murch@murch.one",
        "date": "2025-06-12T18:34:12Z"
      },
      "author": {
        "name": "Murch",
        "email": "murch@murch.one",
        "date": "2025-03-27T01:59:30Z"
      },
      "sha": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18120966542,
      "node_id": "HRFPE_lADOABII586v6UtWzwAAAAQ4GAGO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18120966542",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "commit_url": "https://api.github.com/repos/murchandamus/bitcoin/commits/cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "created_at": "2025-06-12T18:35:39Z"
    },
    {
      "event": "commented",
      "id": 2967888161,
      "node_id": "IC_kwDOABII586w5mEh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2967888161",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-12T19:12:54Z",
      "updated_at": "2025-06-12T19:12:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "Ready for Review",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#issuecomment-2967888161",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32150"
    },
    {
      "event": "commented",
      "id": 2972164440,
      "node_id": "IC_kwDOABII586xJ6FY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2972164440",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-14T02:58:14Z",
      "updated_at": "2025-06-14T02:58:14Z",
      "author_association": "CONTRIBUTOR",
      "body": "Sorry, I forgot to reply to this comment:\r\n\r\n> I think the last 2 commits \"opt: Skip evaluation of equivalent input sets\" and \"opt: Skip evaluation of equivalent input sets\" could be combined. The change the last commit makes is to the comment introduced in the commit before it, and removing a line introduced in the commit before it. We generally don't want to add code just to immediately remove it, so I think these can be squashed together.\r\n\r\nI think of the last two commits as two separate optimizations. The idea that you only have to explore all combinations with the first of several clones in itself can use explaining. The separate step to present the realization that we can skip any UTXO that ties the predecessor on effective value due to the way the UTXO sorting is tie-broken by minimal waste seemed easier to review. The second commit also adds six more lines of documentation and shows per the test that the iteration count is further reduced. I prefer to keep them as two commits.",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#issuecomment-2972164440",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32150"
    },
    {
      "event": "commented",
      "id": 2972167678,
      "node_id": "IC_kwDOABII586xJ63-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2972167678",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-14T02:59:56Z",
      "updated_at": "2025-06-14T02:59:56Z",
      "author_association": "MEMBER",
      "body": "ACK cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#issuecomment-2972167678",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32150"
    },
    {
      "event": "review_requested",
      "id": 18144440863,
      "node_id": "RRE_lADOABII586v6UtWzwAAAAQ5fjIf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18144440863",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-14T03:00:00Z",
      "requested_reviewer": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 2943855318,
      "node_id": "PRR_kwDOABII586vd6rW",
      "url": null,
      "actor": null,
      "commit_id": "4be47e58bdf530351a7bc81ae961ad0a7277fb9b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#pullrequestreview-2943855318",
      "submitted_at": "2025-06-19T19:12:06Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
    },
    {
      "event": "review_requested",
      "id": 18235165678,
      "node_id": "RRE_lADOABII586v6UtWzwAAAAQ-5ovu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18235165678",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-19T19:12:08Z",
      "requested_reviewer": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 2943879965,
      "node_id": "PRR_kwDOABII586veAsd",
      "url": null,
      "actor": null,
      "commit_id": "4be47e58bdf530351a7bc81ae961ad0a7277fb9b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#pullrequestreview-2943879965",
      "submitted_at": "2025-06-19T19:27:49Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
    },
    {
      "event": "review_requested",
      "id": 18235303427,
      "node_id": "RRE_lADOABII586v6UtWzwAAAAQ-6KYD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18235303427",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-19T19:27:52Z",
      "requested_reviewer": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "commented",
      "id": 2988989766,
      "node_id": "IC_kwDOABII586yKF1G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2988989766",
      "actor": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-19T19:37:15Z",
      "updated_at": "2025-06-19T19:37:15Z",
      "author_association": "CONTRIBUTOR",
      "body": "I think DrahtBot has had too much caffine, he keeps pinging me to review.",
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#issuecomment-2988989766",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32150"
    },
    {
      "event": "reviewed",
      "id": 2947044312,
      "node_id": "PRR_kwDOABII586vqFPY",
      "url": null,
      "actor": null,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for your review, @yancyribbens. I think @DrahtBot treats \"Concept ACK\" as a signal that the reviewer intends to later do a full review and will automatically ping reviewers when PRs are updated. I have no idea why it pinged you multiple times, though.",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#pullrequestreview-2947044312",
      "submitted_at": "2025-06-20T18:56:40Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2023537613",
      "pull_request_review_id": 2733815682,
      "id": 2023537613,
      "node_id": "PRRC_kwDOABII5854nLvN",
      "diff_hunk": "@@ -130,14 +130,14 @@ BOOST_AUTO_TEST_CASE(bnb_test)\n     AddCoins(utxo_pool, {1 * CENT, 3 * CENT, 5 * CENT});\n \n     // Simple success cases\n-    TestBnBSuccess(\"Select smallest UTXO\", utxo_pool, /*selection_target=*/1 * CENT, /*expected_input_amounts=*/{1 * CENT}, /*expected_attempts=*/6);\n-    TestBnBSuccess(\"Select middle UTXO\", utxo_pool, /*selection_target=*/3 * CENT, /*expected_input_amounts=*/{3 * CENT}, /*expected_attempts=*/4);\n-    TestBnBSuccess(\"Select biggest UTXO\", utxo_pool, /*selection_target=*/5 * CENT, /*expected_input_amounts=*/{5 * CENT}, /*expected_attempts=*/2);\n-    TestBnBSuccess(\"Select two UTXOs\", utxo_pool, /*selection_target=*/4 * CENT, /*expected_input_amounts=*/{1 * CENT, 3 * CENT}, /*expected_attempts=*/6);\n-    TestBnBSuccess(\"Select all UTXOs\", utxo_pool, /*selection_target=*/9 * CENT, /*expected_input_amounts=*/{1 * CENT, 3 * CENT, 5 * CENT}, /*expected_attempts=*/6);\n+    TestBnBSuccess(\"Select smallest UTXO\", utxo_pool, /*selection_target=*/1 * CENT, /*expected_input_amounts=*/{1 * CENT}, /*expected_attempts=*/3);",
      "path": "src/wallet/test/coinselection_tests.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "d765ba9ae567cf3192706223d873d041f71f9c82",
      "in_reply_to_id": null,
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Nice, it looks like the backtrack iterations are no longer recorded which effectively makes this probably more of an optimization than a refactor.  Now it's possible more solutions can be found since the number of times the loop will run is effectively more improving search resolution.  May be worth adding a note of that to the commit message.",
      "created_at": "2025-04-01T19:12:26Z",
      "updated_at": "2025-04-01T19:12:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2023537613",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2023537613"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 133,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2023709366",
      "pull_request_review_id": 2734099039,
      "id": 2023709366,
      "node_id": "PRRC_kwDOABII5854n1q2",
      "diff_hunk": "@@ -130,14 +130,14 @@ BOOST_AUTO_TEST_CASE(bnb_test)\n     AddCoins(utxo_pool, {1 * CENT, 3 * CENT, 5 * CENT});\n \n     // Simple success cases\n-    TestBnBSuccess(\"Select smallest UTXO\", utxo_pool, /*selection_target=*/1 * CENT, /*expected_input_amounts=*/{1 * CENT}, /*expected_attempts=*/6);\n-    TestBnBSuccess(\"Select middle UTXO\", utxo_pool, /*selection_target=*/3 * CENT, /*expected_input_amounts=*/{3 * CENT}, /*expected_attempts=*/4);\n-    TestBnBSuccess(\"Select biggest UTXO\", utxo_pool, /*selection_target=*/5 * CENT, /*expected_input_amounts=*/{5 * CENT}, /*expected_attempts=*/2);\n-    TestBnBSuccess(\"Select two UTXOs\", utxo_pool, /*selection_target=*/4 * CENT, /*expected_input_amounts=*/{1 * CENT, 3 * CENT}, /*expected_attempts=*/6);\n-    TestBnBSuccess(\"Select all UTXOs\", utxo_pool, /*selection_target=*/9 * CENT, /*expected_input_amounts=*/{1 * CENT, 3 * CENT, 5 * CENT}, /*expected_attempts=*/6);\n+    TestBnBSuccess(\"Select smallest UTXO\", utxo_pool, /*selection_target=*/1 * CENT, /*expected_input_amounts=*/{1 * CENT}, /*expected_attempts=*/3);",
      "path": "src/wallet/test/coinselection_tests.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "d765ba9ae567cf3192706223d873d041f71f9c82",
      "in_reply_to_id": 2023537613,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Thanks, I renamed the PR and added more explanation to the opening comment.",
      "created_at": "2025-04-01T21:35:46Z",
      "updated_at": "2025-04-01T21:35:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2023709366",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2023709366"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 133,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140854993",
      "pull_request_review_id": 2918338099,
      "id": 2140854993,
      "node_id": "PRRC_kwDOABII585_mtrR",
      "diff_hunk": "@@ -210,6 +211,9 @@ BOOST_AUTO_TEST_CASE(bnb_search_test)\n         const auto result9 = SelectCoinsBnB(GroupCoins(available_coins.All()), 1 * CENT, coin_selection_params_bnb.m_cost_of_change);\n         BOOST_CHECK(result9);\n         BOOST_CHECK_EQUAL(result9->GetSelectedValue(), 1 * CENT);\n+        // Demonstrate how following improvements reduce iteration count and catch any regressions in the future.",
      "path": "src/wallet/test/coinselector_tests.cpp",
      "position": null,
      "original_position": 12,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "df20dd4f905a0d04e48bfe20919cccaff11b9b30",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In df20dd4f905a0d04e48bfe20919cccaff11b9b30 \"coinselection: Track BnB iteration count in result\"\r\n\r\nThis kind of comment belongs in the commit message, not the code.",
      "created_at": "2025-06-11T18:48:31Z",
      "updated_at": "2025-06-11T18:48:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2140854993",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140854993"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140860995",
      "pull_request_review_id": 2918347276,
      "id": 2140860995,
      "node_id": "PRRC_kwDOABII585_mvJD",
      "diff_hunk": "@@ -93,114 +93,129 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;\n     for (const OutputGroup& utxo : utxo_pool) {\n-        // Assert that this utxo is not negative. It should never be negative,\n-        // effective value calculation should have removed it\n-        assert(utxo.GetSelectionAmount() > 0);\n-        curr_available_value += utxo.GetSelectionAmount();\n+        // Assert UTXOs with non-positive effective value have been filtered\n+        Assume(utxo.GetSelectionAmount() > 0);\n+        total_available += utxo.GetSelectionAmount();\n     }\n-    if (curr_available_value < selection_target) {\n+\n+    if (total_available < selection_target) {\n+        // Insufficient funds\n         return util::Error();\n     }\n \n-    // Sort the utxo_pool\n     std::sort(utxo_pool.begin(), utxo_pool.end(), descending);\n \n-    CAmount curr_waste = 0;\n+    // The current selection and the best input set found so far, stored as the utxo_pool indices of the UTXOs forming them\n+    std::vector<size_t> curr_selection;\n     std::vector<size_t> best_selection;\n+\n+    // The currently selected effective amount\n+    CAmount curr_amount = 0;\n+\n+    // The waste score of the current section, and the best waste score so far",
      "path": "src/wallet/coinselection.cpp",
      "position": null,
      "original_position": 66,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "9580c0e49030f13fe57603521b59b96e6e50cf82",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In 9580c0e49030f13fe57603521b59b96e6e50cf82 \"coinselection: rewrite BnB in CoinGrinder-style\"\r\n\r\ns/section/selection",
      "created_at": "2025-06-11T18:52:12Z",
      "updated_at": "2025-06-11T20:22:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2140860995",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140860995"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 118,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140951729",
      "pull_request_review_id": 2918347276,
      "id": 2140951729,
      "node_id": "PRRC_kwDOABII585_nFSx",
      "diff_hunk": "@@ -93,114 +93,129 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;\n     for (const OutputGroup& utxo : utxo_pool) {\n-        // Assert that this utxo is not negative. It should never be negative,\n-        // effective value calculation should have removed it\n-        assert(utxo.GetSelectionAmount() > 0);\n-        curr_available_value += utxo.GetSelectionAmount();\n+        // Assert UTXOs with non-positive effective value have been filtered\n+        Assume(utxo.GetSelectionAmount() > 0);\n+        total_available += utxo.GetSelectionAmount();\n     }\n-    if (curr_available_value < selection_target) {\n+\n+    if (total_available < selection_target) {\n+        // Insufficient funds\n         return util::Error();\n     }\n \n-    // Sort the utxo_pool\n     std::sort(utxo_pool.begin(), utxo_pool.end(), descending);\n \n-    CAmount curr_waste = 0;\n+    // The current selection and the best input set found so far, stored as the utxo_pool indices of the UTXOs forming them\n+    std::vector<size_t> curr_selection;\n     std::vector<size_t> best_selection;\n+\n+    // The currently selected effective amount\n+    CAmount curr_amount = 0;\n+\n+    // The waste score of the current section, and the best waste score so far\n+    CAmount curr_selection_waste = 0;\n     CAmount best_waste = MAX_MONEY;\n \n-    bool is_feerate_high = utxo_pool.at(0).fee > utxo_pool.at(0).long_term_fee;\n+    // The weight of the currently selected input set\n+    int curr_weight = 0;\n+\n+    // Whether the input sets generated during this search have exceeded the maximum transaction weight at any point\n     bool max_tx_weight_exceeded = false;\n \n-    // Depth First search loop for choosing the UTXOs\n-    for (size_t curr_try = 0, utxo_pool_index = 0; curr_try < TOTAL_TRIES; ++curr_try, ++utxo_pool_index) {\n-        result.SetSelectionsEvaluated(curr_try);\n-        // Conditions for starting a backtrack\n-        bool backtrack = false;\n-        if (curr_value + curr_available_value < selection_target || // Cannot possibly reach target with the amount remaining in the curr_available_value.\n-            curr_value > selection_target + cost_of_change || // Selected value is out of range, go back and try other branch\n-            (curr_waste > best_waste && is_feerate_high)) { // Don't select things which we know will be more wasteful if the waste is increasing\n-            backtrack = true;\n-        } else if (curr_selection_weight > max_selection_weight) { // Selected UTXOs weight exceeds the maximum weight allowed, cannot find more solutions by adding more inputs\n-            max_tx_weight_exceeded = true; // at least one selection attempt exceeded the max weight\n-            backtrack = true;\n-        } else if (curr_value >= selection_target) {       // Selected value is within range\n-            curr_waste += (curr_value - selection_target); // This is the excess value which is added to the waste for the below comparison\n-            // Adding another UTXO after this check could bring the waste down if the long term fee is higher than the current fee.\n-            // However we are not going to explore that because this optimization for the waste is only done when we have hit our target\n-            // value. Adding any more UTXOs will be just burning the UTXO; it will go entirely to fees. Thus we aren't going to\n-            // explore any more UTXOs to avoid burning money like that.\n+    // Index of the next UTXO to consider in utxo_pool\n+    size_t next_utxo = 0;\n+\n+    auto deselect_last = [&]() {\n+        OutputGroup& utxo = utxo_pool[curr_selection.back()];\n+        curr_amount -= utxo.GetSelectionAmount();\n+        curr_weight -= utxo.m_weight;\n+        curr_selection_waste -= utxo.fee - utxo.long_term_fee;\n+        curr_selection.pop_back();\n+    };\n+\n+    size_t curr_try = 0;\n+    while (true) {\n+        bool should_shift{false}, should_cut{false};\n+        // Select `next_utxo`\n+        OutputGroup& utxo = utxo_pool[next_utxo];\n+        curr_amount += utxo.GetSelectionAmount();\n+        curr_weight += utxo.m_weight;\n+        curr_selection_waste += utxo.fee - utxo.long_term_fee;\n+        curr_selection.push_back(next_utxo);\n+        ++next_utxo;\n+        ++curr_try;\n+\n+        // EVALUATE current selection: check for solutions and see whether we can CUT or SHIFT before EXPLORING further\n+        if (curr_weight > max_selection_weight) {\n+            // max_weight exceeded: SHIFT\n+            max_tx_weight_exceeded = true;\n+            should_shift  = true;\n+        } else if (curr_amount > selection_target + cost_of_change) {\n+            // Overshot target range: SHIFT\n+            should_shift = true;\n+        } else if (curr_amount >= selection_target) {\n+            // Selection is within target window: potential solution\n+            // Adding more UTXOs only increases fees and cannot be better: SHIFT\n+            should_shift  = true;\n+            // The amount exceeding the selection_target (the \"excess\"), would be dropped to the fees: it is waste.\n+            CAmount curr_excess = curr_amount - selection_target;\n+            CAmount curr_waste = curr_selection_waste + curr_excess;\n             if (curr_waste <= best_waste) {\n+                // New best solution\n                 best_selection = curr_selection;\n                 best_waste = curr_waste;\n             }\n-            curr_waste -= (curr_value - selection_target); // Remove the excess value as we will be selecting different coins now\n-            backtrack = true;\n         }\n \n-        if (backtrack) { // Backtracking, moving backwards\n-            if (curr_selection.empty()) { // We have walked back to the first utxo and no branch is untraversed. All solutions searched\n-                break;\n-            }\n+        if (curr_try >= TOTAL_TRIES) {\n+            // Solution is not guaranteed to be optimal if `curr_try` hit TOTAL_TRIES\n+            break;\n+        }\n \n-            // Add omitted UTXOs back to lookahead before traversing the omission branch of last included UTXO.\n-            for (--utxo_pool_index; utxo_pool_index > curr_selection.back(); --utxo_pool_index) {\n-                curr_available_value += utxo_pool.at(utxo_pool_index).GetSelectionAmount();\n-            }\n+        if (next_utxo == utxo_pool.size()) {\n+            // Last added UTXO was end of UTXO pool, nothing left to add on inclusion or omission branch: CUT\n+            should_cut = true;\n+        }\n \n-            // Output was included on previous iterations, try excluding now.\n-            assert(utxo_pool_index == curr_selection.back());\n-            OutputGroup& utxo = utxo_pool.at(utxo_pool_index);\n-            curr_value -= utxo.GetSelectionAmount();\n-            curr_waste -= utxo.fee - utxo.long_term_fee;\n-            curr_selection_weight -= utxo.m_weight;\n-            curr_selection.pop_back();\n-        } else { // Moving forwards, continuing down this branch\n-            OutputGroup& utxo = utxo_pool.at(utxo_pool_index);\n-\n-            // Remove this utxo from the curr_available_value utxo amount\n-            curr_available_value -= utxo.GetSelectionAmount();\n-\n-            if (curr_selection.empty() ||\n-                // The previous index is included and therefore not relevant for exclusion shortcut\n-                (utxo_pool_index - 1) == curr_selection.back() ||\n-                // Avoid searching a branch if the previous UTXO has the same value and same waste and was excluded.\n-                // Since the ratio of fee to long term fee is the same, we only need to check if one of those values match in order to know that the waste is the same.\n-                utxo.GetSelectionAmount() != utxo_pool.at(utxo_pool_index - 1).GetSelectionAmount() ||\n-                utxo.fee != utxo_pool.at(utxo_pool_index - 1).fee)\n-            {\n-                // Inclusion branch first (Largest First Exploration)\n-                curr_selection.push_back(utxo_pool_index);\n-                curr_value += utxo.GetSelectionAmount();\n-                curr_waste += utxo.fee - utxo.long_term_fee;\n-                curr_selection_weight += utxo.m_weight;\n+        if (should_cut) {\n+            // Neither adding to the current selection nor exploring the omission branch of the last selected UTXO can\n+            // find any solutions. Redirect to exploring the Omission branch of the penultimate selected UTXO (i.e.\n+            // set `next_utxo` to one after the penultimate selected, then deselect the last two selected UTXOs)\n+            should_cut = false;",
      "path": "src/wallet/coinselection.cpp",
      "position": null,
      "original_position": 190,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "9580c0e49030f13fe57603521b59b96e6e50cf82",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In 9580c0e49030f13fe57603521b59b96e6e50cf82 \"coinselection: rewrite BnB in CoinGrinder-style\"\r\n\r\n`should_cut` is not used after this, there is no need to reset it.",
      "created_at": "2025-06-11T19:54:09Z",
      "updated_at": "2025-06-11T20:22:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2140951729",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140951729"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 187,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140952030",
      "pull_request_review_id": 2918347276,
      "id": 2140952030,
      "node_id": "PRRC_kwDOABII585_nFXe",
      "diff_hunk": "@@ -93,114 +93,129 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;\n     for (const OutputGroup& utxo : utxo_pool) {\n-        // Assert that this utxo is not negative. It should never be negative,\n-        // effective value calculation should have removed it\n-        assert(utxo.GetSelectionAmount() > 0);\n-        curr_available_value += utxo.GetSelectionAmount();\n+        // Assert UTXOs with non-positive effective value have been filtered\n+        Assume(utxo.GetSelectionAmount() > 0);\n+        total_available += utxo.GetSelectionAmount();\n     }\n-    if (curr_available_value < selection_target) {\n+\n+    if (total_available < selection_target) {\n+        // Insufficient funds\n         return util::Error();\n     }\n \n-    // Sort the utxo_pool\n     std::sort(utxo_pool.begin(), utxo_pool.end(), descending);\n \n-    CAmount curr_waste = 0;\n+    // The current selection and the best input set found so far, stored as the utxo_pool indices of the UTXOs forming them\n+    std::vector<size_t> curr_selection;\n     std::vector<size_t> best_selection;\n+\n+    // The currently selected effective amount\n+    CAmount curr_amount = 0;\n+\n+    // The waste score of the current section, and the best waste score so far\n+    CAmount curr_selection_waste = 0;\n     CAmount best_waste = MAX_MONEY;\n \n-    bool is_feerate_high = utxo_pool.at(0).fee > utxo_pool.at(0).long_term_fee;\n+    // The weight of the currently selected input set\n+    int curr_weight = 0;\n+\n+    // Whether the input sets generated during this search have exceeded the maximum transaction weight at any point\n     bool max_tx_weight_exceeded = false;\n \n-    // Depth First search loop for choosing the UTXOs\n-    for (size_t curr_try = 0, utxo_pool_index = 0; curr_try < TOTAL_TRIES; ++curr_try, ++utxo_pool_index) {\n-        result.SetSelectionsEvaluated(curr_try);\n-        // Conditions for starting a backtrack\n-        bool backtrack = false;\n-        if (curr_value + curr_available_value < selection_target || // Cannot possibly reach target with the amount remaining in the curr_available_value.\n-            curr_value > selection_target + cost_of_change || // Selected value is out of range, go back and try other branch\n-            (curr_waste > best_waste && is_feerate_high)) { // Don't select things which we know will be more wasteful if the waste is increasing\n-            backtrack = true;\n-        } else if (curr_selection_weight > max_selection_weight) { // Selected UTXOs weight exceeds the maximum weight allowed, cannot find more solutions by adding more inputs\n-            max_tx_weight_exceeded = true; // at least one selection attempt exceeded the max weight\n-            backtrack = true;\n-        } else if (curr_value >= selection_target) {       // Selected value is within range\n-            curr_waste += (curr_value - selection_target); // This is the excess value which is added to the waste for the below comparison\n-            // Adding another UTXO after this check could bring the waste down if the long term fee is higher than the current fee.\n-            // However we are not going to explore that because this optimization for the waste is only done when we have hit our target\n-            // value. Adding any more UTXOs will be just burning the UTXO; it will go entirely to fees. Thus we aren't going to\n-            // explore any more UTXOs to avoid burning money like that.\n+    // Index of the next UTXO to consider in utxo_pool\n+    size_t next_utxo = 0;\n+\n+    auto deselect_last = [&]() {\n+        OutputGroup& utxo = utxo_pool[curr_selection.back()];\n+        curr_amount -= utxo.GetSelectionAmount();\n+        curr_weight -= utxo.m_weight;\n+        curr_selection_waste -= utxo.fee - utxo.long_term_fee;\n+        curr_selection.pop_back();\n+    };\n+\n+    size_t curr_try = 0;\n+    while (true) {\n+        bool should_shift{false}, should_cut{false};\n+        // Select `next_utxo`\n+        OutputGroup& utxo = utxo_pool[next_utxo];\n+        curr_amount += utxo.GetSelectionAmount();\n+        curr_weight += utxo.m_weight;\n+        curr_selection_waste += utxo.fee - utxo.long_term_fee;\n+        curr_selection.push_back(next_utxo);\n+        ++next_utxo;\n+        ++curr_try;\n+\n+        // EVALUATE current selection: check for solutions and see whether we can CUT or SHIFT before EXPLORING further\n+        if (curr_weight > max_selection_weight) {\n+            // max_weight exceeded: SHIFT\n+            max_tx_weight_exceeded = true;\n+            should_shift  = true;\n+        } else if (curr_amount > selection_target + cost_of_change) {\n+            // Overshot target range: SHIFT\n+            should_shift = true;\n+        } else if (curr_amount >= selection_target) {\n+            // Selection is within target window: potential solution\n+            // Adding more UTXOs only increases fees and cannot be better: SHIFT\n+            should_shift  = true;\n+            // The amount exceeding the selection_target (the \"excess\"), would be dropped to the fees: it is waste.\n+            CAmount curr_excess = curr_amount - selection_target;\n+            CAmount curr_waste = curr_selection_waste + curr_excess;\n             if (curr_waste <= best_waste) {\n+                // New best solution\n                 best_selection = curr_selection;\n                 best_waste = curr_waste;\n             }\n-            curr_waste -= (curr_value - selection_target); // Remove the excess value as we will be selecting different coins now\n-            backtrack = true;\n         }\n \n-        if (backtrack) { // Backtracking, moving backwards\n-            if (curr_selection.empty()) { // We have walked back to the first utxo and no branch is untraversed. All solutions searched\n-                break;\n-            }\n+        if (curr_try >= TOTAL_TRIES) {\n+            // Solution is not guaranteed to be optimal if `curr_try` hit TOTAL_TRIES\n+            break;\n+        }\n \n-            // Add omitted UTXOs back to lookahead before traversing the omission branch of last included UTXO.\n-            for (--utxo_pool_index; utxo_pool_index > curr_selection.back(); --utxo_pool_index) {\n-                curr_available_value += utxo_pool.at(utxo_pool_index).GetSelectionAmount();\n-            }\n+        if (next_utxo == utxo_pool.size()) {\n+            // Last added UTXO was end of UTXO pool, nothing left to add on inclusion or omission branch: CUT\n+            should_cut = true;\n+        }\n \n-            // Output was included on previous iterations, try excluding now.\n-            assert(utxo_pool_index == curr_selection.back());\n-            OutputGroup& utxo = utxo_pool.at(utxo_pool_index);\n-            curr_value -= utxo.GetSelectionAmount();\n-            curr_waste -= utxo.fee - utxo.long_term_fee;\n-            curr_selection_weight -= utxo.m_weight;\n-            curr_selection.pop_back();\n-        } else { // Moving forwards, continuing down this branch\n-            OutputGroup& utxo = utxo_pool.at(utxo_pool_index);\n-\n-            // Remove this utxo from the curr_available_value utxo amount\n-            curr_available_value -= utxo.GetSelectionAmount();\n-\n-            if (curr_selection.empty() ||\n-                // The previous index is included and therefore not relevant for exclusion shortcut\n-                (utxo_pool_index - 1) == curr_selection.back() ||\n-                // Avoid searching a branch if the previous UTXO has the same value and same waste and was excluded.\n-                // Since the ratio of fee to long term fee is the same, we only need to check if one of those values match in order to know that the waste is the same.\n-                utxo.GetSelectionAmount() != utxo_pool.at(utxo_pool_index - 1).GetSelectionAmount() ||\n-                utxo.fee != utxo_pool.at(utxo_pool_index - 1).fee)\n-            {\n-                // Inclusion branch first (Largest First Exploration)\n-                curr_selection.push_back(utxo_pool_index);\n-                curr_value += utxo.GetSelectionAmount();\n-                curr_waste += utxo.fee - utxo.long_term_fee;\n-                curr_selection_weight += utxo.m_weight;\n+        if (should_cut) {\n+            // Neither adding to the current selection nor exploring the omission branch of the last selected UTXO can\n+            // find any solutions. Redirect to exploring the Omission branch of the penultimate selected UTXO (i.e.\n+            // set `next_utxo` to one after the penultimate selected, then deselect the last two selected UTXOs)\n+            should_cut = false;\n+            deselect_last();\n+            should_shift  = true;\n+        }\n+\n+        if (should_shift) {\n+            // Set `next_utxo` to one after last selected, then deselect last selected UTXO\n+            if (curr_selection.empty()) {\n+                // Exhausted search space before running into attempt limit\n+                break;\n             }\n+            next_utxo = curr_selection.back() + 1;\n+            deselect_last();\n+            should_shift  = false;",
      "path": "src/wallet/coinselection.cpp",
      "position": 230,
      "original_position": 203,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "9580c0e49030f13fe57603521b59b96e6e50cf82",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In 9580c0e49030f13fe57603521b59b96e6e50cf82 \"coinselection: rewrite BnB in CoinGrinder-style\"\r\n\r\n`should_shift` is not used after this, there is no need to reset it.",
      "created_at": "2025-06-11T19:54:21Z",
      "updated_at": "2025-06-11T20:22:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2140952030",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140952030"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 241,
      "original_line": 241,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140957548",
      "pull_request_review_id": 2918347276,
      "id": 2140957548,
      "node_id": "PRRC_kwDOABII585_nGts",
      "diff_hunk": "@@ -93,114 +93,129 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;\n     for (const OutputGroup& utxo : utxo_pool) {\n-        // Assert that this utxo is not negative. It should never be negative,\n-        // effective value calculation should have removed it\n-        assert(utxo.GetSelectionAmount() > 0);\n-        curr_available_value += utxo.GetSelectionAmount();\n+        // Assert UTXOs with non-positive effective value have been filtered\n+        Assume(utxo.GetSelectionAmount() > 0);\n+        total_available += utxo.GetSelectionAmount();\n     }\n-    if (curr_available_value < selection_target) {\n+\n+    if (total_available < selection_target) {\n+        // Insufficient funds\n         return util::Error();\n     }\n \n-    // Sort the utxo_pool\n     std::sort(utxo_pool.begin(), utxo_pool.end(), descending);\n \n-    CAmount curr_waste = 0;\n+    // The current selection and the best input set found so far, stored as the utxo_pool indices of the UTXOs forming them\n+    std::vector<size_t> curr_selection;\n     std::vector<size_t> best_selection;\n+\n+    // The currently selected effective amount\n+    CAmount curr_amount = 0;\n+\n+    // The waste score of the current section, and the best waste score so far\n+    CAmount curr_selection_waste = 0;\n     CAmount best_waste = MAX_MONEY;\n \n-    bool is_feerate_high = utxo_pool.at(0).fee > utxo_pool.at(0).long_term_fee;\n+    // The weight of the currently selected input set\n+    int curr_weight = 0;\n+\n+    // Whether the input sets generated during this search have exceeded the maximum transaction weight at any point\n     bool max_tx_weight_exceeded = false;\n \n-    // Depth First search loop for choosing the UTXOs\n-    for (size_t curr_try = 0, utxo_pool_index = 0; curr_try < TOTAL_TRIES; ++curr_try, ++utxo_pool_index) {\n-        result.SetSelectionsEvaluated(curr_try);\n-        // Conditions for starting a backtrack\n-        bool backtrack = false;\n-        if (curr_value + curr_available_value < selection_target || // Cannot possibly reach target with the amount remaining in the curr_available_value.\n-            curr_value > selection_target + cost_of_change || // Selected value is out of range, go back and try other branch\n-            (curr_waste > best_waste && is_feerate_high)) { // Don't select things which we know will be more wasteful if the waste is increasing\n-            backtrack = true;\n-        } else if (curr_selection_weight > max_selection_weight) { // Selected UTXOs weight exceeds the maximum weight allowed, cannot find more solutions by adding more inputs\n-            max_tx_weight_exceeded = true; // at least one selection attempt exceeded the max weight\n-            backtrack = true;\n-        } else if (curr_value >= selection_target) {       // Selected value is within range\n-            curr_waste += (curr_value - selection_target); // This is the excess value which is added to the waste for the below comparison\n-            // Adding another UTXO after this check could bring the waste down if the long term fee is higher than the current fee.\n-            // However we are not going to explore that because this optimization for the waste is only done when we have hit our target\n-            // value. Adding any more UTXOs will be just burning the UTXO; it will go entirely to fees. Thus we aren't going to\n-            // explore any more UTXOs to avoid burning money like that.\n+    // Index of the next UTXO to consider in utxo_pool\n+    size_t next_utxo = 0;\n+\n+    auto deselect_last = [&]() {\n+        OutputGroup& utxo = utxo_pool[curr_selection.back()];\n+        curr_amount -= utxo.GetSelectionAmount();\n+        curr_weight -= utxo.m_weight;\n+        curr_selection_waste -= utxo.fee - utxo.long_term_fee;\n+        curr_selection.pop_back();\n+    };\n+\n+    size_t curr_try = 0;\n+    while (true) {\n+        bool should_shift{false}, should_cut{false};\n+        // Select `next_utxo`\n+        OutputGroup& utxo = utxo_pool[next_utxo];\n+        curr_amount += utxo.GetSelectionAmount();\n+        curr_weight += utxo.m_weight;\n+        curr_selection_waste += utxo.fee - utxo.long_term_fee;\n+        curr_selection.push_back(next_utxo);\n+        ++next_utxo;\n+        ++curr_try;\n+\n+        // EVALUATE current selection: check for solutions and see whether we can CUT or SHIFT before EXPLORING further\n+        if (curr_weight > max_selection_weight) {\n+            // max_weight exceeded: SHIFT\n+            max_tx_weight_exceeded = true;\n+            should_shift  = true;\n+        } else if (curr_amount > selection_target + cost_of_change) {\n+            // Overshot target range: SHIFT\n+            should_shift = true;\n+        } else if (curr_amount >= selection_target) {\n+            // Selection is within target window: potential solution\n+            // Adding more UTXOs only increases fees and cannot be better: SHIFT\n+            should_shift  = true;\n+            // The amount exceeding the selection_target (the \"excess\"), would be dropped to the fees: it is waste.\n+            CAmount curr_excess = curr_amount - selection_target;\n+            CAmount curr_waste = curr_selection_waste + curr_excess;\n             if (curr_waste <= best_waste) {\n+                // New best solution\n                 best_selection = curr_selection;\n                 best_waste = curr_waste;\n             }\n-            curr_waste -= (curr_value - selection_target); // Remove the excess value as we will be selecting different coins now\n-            backtrack = true;\n         }\n \n-        if (backtrack) { // Backtracking, moving backwards\n-            if (curr_selection.empty()) { // We have walked back to the first utxo and no branch is untraversed. All solutions searched\n-                break;\n-            }\n+        if (curr_try >= TOTAL_TRIES) {\n+            // Solution is not guaranteed to be optimal if `curr_try` hit TOTAL_TRIES\n+            break;\n+        }\n \n-            // Add omitted UTXOs back to lookahead before traversing the omission branch of last included UTXO.\n-            for (--utxo_pool_index; utxo_pool_index > curr_selection.back(); --utxo_pool_index) {\n-                curr_available_value += utxo_pool.at(utxo_pool_index).GetSelectionAmount();\n-            }\n+        if (next_utxo == utxo_pool.size()) {\n+            // Last added UTXO was end of UTXO pool, nothing left to add on inclusion or omission branch: CUT\n+            should_cut = true;\n+        }\n \n-            // Output was included on previous iterations, try excluding now.\n-            assert(utxo_pool_index == curr_selection.back());\n-            OutputGroup& utxo = utxo_pool.at(utxo_pool_index);\n-            curr_value -= utxo.GetSelectionAmount();\n-            curr_waste -= utxo.fee - utxo.long_term_fee;\n-            curr_selection_weight -= utxo.m_weight;\n-            curr_selection.pop_back();\n-        } else { // Moving forwards, continuing down this branch\n-            OutputGroup& utxo = utxo_pool.at(utxo_pool_index);\n-\n-            // Remove this utxo from the curr_available_value utxo amount\n-            curr_available_value -= utxo.GetSelectionAmount();\n-\n-            if (curr_selection.empty() ||\n-                // The previous index is included and therefore not relevant for exclusion shortcut\n-                (utxo_pool_index - 1) == curr_selection.back() ||\n-                // Avoid searching a branch if the previous UTXO has the same value and same waste and was excluded.\n-                // Since the ratio of fee to long term fee is the same, we only need to check if one of those values match in order to know that the waste is the same.\n-                utxo.GetSelectionAmount() != utxo_pool.at(utxo_pool_index - 1).GetSelectionAmount() ||\n-                utxo.fee != utxo_pool.at(utxo_pool_index - 1).fee)\n-            {\n-                // Inclusion branch first (Largest First Exploration)\n-                curr_selection.push_back(utxo_pool_index);\n-                curr_value += utxo.GetSelectionAmount();\n-                curr_waste += utxo.fee - utxo.long_term_fee;\n-                curr_selection_weight += utxo.m_weight;\n+        if (should_cut) {\n+            // Neither adding to the current selection nor exploring the omission branch of the last selected UTXO can\n+            // find any solutions. Redirect to exploring the Omission branch of the penultimate selected UTXO (i.e.\n+            // set `next_utxo` to one after the penultimate selected, then deselect the last two selected UTXOs)\n+            should_cut = false;\n+            deselect_last();\n+            should_shift  = true;\n+        }\n+\n+        if (should_shift) {\n+            // Set `next_utxo` to one after last selected, then deselect last selected UTXO",
      "path": "src/wallet/coinselection.cpp",
      "position": null,
      "original_position": 196,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "9580c0e49030f13fe57603521b59b96e6e50cf82",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In 9580c0e49030f13fe57603521b59b96e6e50cf82 \"coinselection: rewrite BnB in CoinGrinder-style\"\r\n\r\nThis comment should be after the `if`",
      "created_at": "2025-06-11T19:58:28Z",
      "updated_at": "2025-06-11T20:22:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2140957548",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140957548"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 193,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140964773",
      "pull_request_review_id": 2918347276,
      "id": 2140964773,
      "node_id": "PRRC_kwDOABII585_nIel",
      "diff_hunk": "@@ -93,114 +93,129 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;\n     for (const OutputGroup& utxo : utxo_pool) {\n-        // Assert that this utxo is not negative. It should never be negative,\n-        // effective value calculation should have removed it\n-        assert(utxo.GetSelectionAmount() > 0);\n-        curr_available_value += utxo.GetSelectionAmount();\n+        // Assert UTXOs with non-positive effective value have been filtered\n+        Assume(utxo.GetSelectionAmount() > 0);\n+        total_available += utxo.GetSelectionAmount();\n     }\n-    if (curr_available_value < selection_target) {\n+\n+    if (total_available < selection_target) {\n+        // Insufficient funds\n         return util::Error();\n     }\n \n-    // Sort the utxo_pool\n     std::sort(utxo_pool.begin(), utxo_pool.end(), descending);\n \n-    CAmount curr_waste = 0;\n+    // The current selection and the best input set found so far, stored as the utxo_pool indices of the UTXOs forming them\n+    std::vector<size_t> curr_selection;\n     std::vector<size_t> best_selection;\n+\n+    // The currently selected effective amount\n+    CAmount curr_amount = 0;\n+\n+    // The waste score of the current section, and the best waste score so far\n+    CAmount curr_selection_waste = 0;\n     CAmount best_waste = MAX_MONEY;\n \n-    bool is_feerate_high = utxo_pool.at(0).fee > utxo_pool.at(0).long_term_fee;\n+    // The weight of the currently selected input set\n+    int curr_weight = 0;\n+\n+    // Whether the input sets generated during this search have exceeded the maximum transaction weight at any point\n     bool max_tx_weight_exceeded = false;\n \n-    // Depth First search loop for choosing the UTXOs\n-    for (size_t curr_try = 0, utxo_pool_index = 0; curr_try < TOTAL_TRIES; ++curr_try, ++utxo_pool_index) {\n-        result.SetSelectionsEvaluated(curr_try);\n-        // Conditions for starting a backtrack\n-        bool backtrack = false;\n-        if (curr_value + curr_available_value < selection_target || // Cannot possibly reach target with the amount remaining in the curr_available_value.\n-            curr_value > selection_target + cost_of_change || // Selected value is out of range, go back and try other branch\n-            (curr_waste > best_waste && is_feerate_high)) { // Don't select things which we know will be more wasteful if the waste is increasing\n-            backtrack = true;\n-        } else if (curr_selection_weight > max_selection_weight) { // Selected UTXOs weight exceeds the maximum weight allowed, cannot find more solutions by adding more inputs\n-            max_tx_weight_exceeded = true; // at least one selection attempt exceeded the max weight\n-            backtrack = true;\n-        } else if (curr_value >= selection_target) {       // Selected value is within range\n-            curr_waste += (curr_value - selection_target); // This is the excess value which is added to the waste for the below comparison\n-            // Adding another UTXO after this check could bring the waste down if the long term fee is higher than the current fee.\n-            // However we are not going to explore that because this optimization for the waste is only done when we have hit our target\n-            // value. Adding any more UTXOs will be just burning the UTXO; it will go entirely to fees. Thus we aren't going to\n-            // explore any more UTXOs to avoid burning money like that.\n+    // Index of the next UTXO to consider in utxo_pool\n+    size_t next_utxo = 0;\n+\n+    auto deselect_last = [&]() {\n+        OutputGroup& utxo = utxo_pool[curr_selection.back()];\n+        curr_amount -= utxo.GetSelectionAmount();\n+        curr_weight -= utxo.m_weight;\n+        curr_selection_waste -= utxo.fee - utxo.long_term_fee;\n+        curr_selection.pop_back();\n+    };\n+\n+    size_t curr_try = 0;\n+    while (true) {\n+        bool should_shift{false}, should_cut{false};\n+        // Select `next_utxo`\n+        OutputGroup& utxo = utxo_pool[next_utxo];\n+        curr_amount += utxo.GetSelectionAmount();\n+        curr_weight += utxo.m_weight;\n+        curr_selection_waste += utxo.fee - utxo.long_term_fee;\n+        curr_selection.push_back(next_utxo);\n+        ++next_utxo;\n+        ++curr_try;\n+\n+        // EVALUATE current selection: check for solutions and see whether we can CUT or SHIFT before EXPLORING further\n+        if (curr_weight > max_selection_weight) {\n+            // max_weight exceeded: SHIFT\n+            max_tx_weight_exceeded = true;\n+            should_shift  = true;\n+        } else if (curr_amount > selection_target + cost_of_change) {\n+            // Overshot target range: SHIFT\n+            should_shift = true;\n+        } else if (curr_amount >= selection_target) {\n+            // Selection is within target window: potential solution\n+            // Adding more UTXOs only increases fees and cannot be better: SHIFT\n+            should_shift  = true;\n+            // The amount exceeding the selection_target (the \"excess\"), would be dropped to the fees: it is waste.\n+            CAmount curr_excess = curr_amount - selection_target;\n+            CAmount curr_waste = curr_selection_waste + curr_excess;\n             if (curr_waste <= best_waste) {\n+                // New best solution\n                 best_selection = curr_selection;\n                 best_waste = curr_waste;\n             }\n-            curr_waste -= (curr_value - selection_target); // Remove the excess value as we will be selecting different coins now\n-            backtrack = true;\n         }\n \n-        if (backtrack) { // Backtracking, moving backwards\n-            if (curr_selection.empty()) { // We have walked back to the first utxo and no branch is untraversed. All solutions searched\n-                break;\n-            }\n+        if (curr_try >= TOTAL_TRIES) {\n+            // Solution is not guaranteed to be optimal if `curr_try` hit TOTAL_TRIES\n+            break;\n+        }\n \n-            // Add omitted UTXOs back to lookahead before traversing the omission branch of last included UTXO.\n-            for (--utxo_pool_index; utxo_pool_index > curr_selection.back(); --utxo_pool_index) {\n-                curr_available_value += utxo_pool.at(utxo_pool_index).GetSelectionAmount();\n-            }\n+        if (next_utxo == utxo_pool.size()) {\n+            // Last added UTXO was end of UTXO pool, nothing left to add on inclusion or omission branch: CUT\n+            should_cut = true;\n+        }\n \n-            // Output was included on previous iterations, try excluding now.\n-            assert(utxo_pool_index == curr_selection.back());\n-            OutputGroup& utxo = utxo_pool.at(utxo_pool_index);\n-            curr_value -= utxo.GetSelectionAmount();\n-            curr_waste -= utxo.fee - utxo.long_term_fee;\n-            curr_selection_weight -= utxo.m_weight;\n-            curr_selection.pop_back();\n-        } else { // Moving forwards, continuing down this branch\n-            OutputGroup& utxo = utxo_pool.at(utxo_pool_index);\n-\n-            // Remove this utxo from the curr_available_value utxo amount\n-            curr_available_value -= utxo.GetSelectionAmount();\n-\n-            if (curr_selection.empty() ||\n-                // The previous index is included and therefore not relevant for exclusion shortcut\n-                (utxo_pool_index - 1) == curr_selection.back() ||\n-                // Avoid searching a branch if the previous UTXO has the same value and same waste and was excluded.\n-                // Since the ratio of fee to long term fee is the same, we only need to check if one of those values match in order to know that the waste is the same.\n-                utxo.GetSelectionAmount() != utxo_pool.at(utxo_pool_index - 1).GetSelectionAmount() ||\n-                utxo.fee != utxo_pool.at(utxo_pool_index - 1).fee)\n-            {\n-                // Inclusion branch first (Largest First Exploration)\n-                curr_selection.push_back(utxo_pool_index);\n-                curr_value += utxo.GetSelectionAmount();\n-                curr_waste += utxo.fee - utxo.long_term_fee;\n-                curr_selection_weight += utxo.m_weight;\n+        if (should_cut) {\n+            // Neither adding to the current selection nor exploring the omission branch of the last selected UTXO can\n+            // find any solutions. Redirect to exploring the Omission branch of the penultimate selected UTXO (i.e.\n+            // set `next_utxo` to one after the penultimate selected, then deselect the last two selected UTXOs)\n+            should_cut = false;\n+            deselect_last();\n+            should_shift  = true;\n+        }\n+\n+        if (should_shift) {\n+            // Set `next_utxo` to one after last selected, then deselect last selected UTXO\n+            if (curr_selection.empty()) {\n+                // Exhausted search space before running into attempt limit\n+                break;\n             }\n+            next_utxo = curr_selection.back() + 1;\n+            deselect_last();\n+            should_shift  = false;\n         }\n     }\n \n-    // Check for solution\n+    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n+    result.SetSelectionsEvaluated(curr_try);\n+\n     if (best_selection.empty()) {\n         return max_tx_weight_exceeded ? ErrorMaxWeightExceeded() : util::Error();\n     }\n \n-    // Set output set\n     for (const size_t& i : best_selection) {\n         result.AddInput(utxo_pool.at(i));\n     }\n-    result.RecalculateWaste(cost_of_change, cost_of_change, CAmount{0});\n-    assert(best_waste == result.GetWaste());",
      "path": "src/wallet/coinselection.cpp",
      "position": 288,
      "original_position": 220,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "9580c0e49030f13fe57603521b59b96e6e50cf82",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In 9580c0e49030f13fe57603521b59b96e6e50cf82 \"coinselection: rewrite BnB in CoinGrinder-style\"\r\n\r\nWhy is the waste calculation being dropped? `result` will be returned with an incorrect waste value.",
      "created_at": "2025-06-11T20:03:42Z",
      "updated_at": "2025-06-11T20:22:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2140964773",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140964773"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": 197,
      "original_start_line": 198,
      "start_side": "LEFT",
      "line": 198,
      "original_line": 198,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140968745",
      "pull_request_review_id": 2918347276,
      "id": 2140968745,
      "node_id": "PRRC_kwDOABII585_nJcp",
      "diff_hunk": "@@ -157,6 +158,9 @@ util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool\n         } else if (curr_amount > selection_target + cost_of_change) {\n             // Overshot target range: SHIFT\n             should_shift = true;\n+        } else if (is_feerate_high && curr_selection_waste > best_waste) {",
      "path": "src/wallet/coinselection.cpp",
      "position": 171,
      "original_position": 12,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "813ac54726866b1051c502fe8bfef3b279af890f",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In 813ac54726866b1051c502fe8bfef3b279af890f \"coinselection: BnB skip exploring high waste\"\r\n\r\nWhy does this optimization only work at high feerates?",
      "created_at": "2025-06-11T20:06:38Z",
      "updated_at": "2025-06-11T20:22:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2140968745",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140968745"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 191,
      "original_line": 191,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140974454",
      "pull_request_review_id": 2918347276,
      "id": 2140974454,
      "node_id": "PRRC_kwDOABII585_nK12",
      "diff_hunk": "@@ -93,20 +93,25 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    // Check that there are sufficient funds\n+    std::sort(utxo_pool.begin(), utxo_pool.end(), descending);\n+    // The sum of UTXO amounts after this UTXO index, e.g. lookahead[5] = Œ£(UTXO[6+].amount)\n+    std::vector<CAmount> lookahead(utxo_pool.size());\n+\n+    // Calculate lookahead values, and check that there are sufficient funds\n     CAmount total_available = 0;\n-    for (const OutputGroup& utxo : utxo_pool) {\n-        // Assert UTXOs with non-positive effective value have been filtered\n-        Assume(utxo.GetSelectionAmount() > 0);\n-        total_available += utxo.GetSelectionAmount();\n+    for (size_t i = 0; i < utxo_pool.size(); ++i) {\n+        size_t index = utxo_pool.size() - 1 - i; // Loop over every element in reverse order",
      "path": "src/wallet/coinselection.cpp",
      "position": null,
      "original_position": 25,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "6ff6e98000792f715324c513fd9eb83440929d0e",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In 6ff6e98000792f715324c513fd9eb83440929d0e \"coinselection: Track effective_value lookahead\"\r\n\r\nDo the reversing in the `for`\r\n\r\n```suggestion\r\n    for (size_t i = utxo_pool.size() - 1; i >= 0; --i) {\r\n```",
      "created_at": "2025-06-11T20:10:26Z",
      "updated_at": "2025-06-11T20:22:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2140974454",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140974454"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": 102,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 103,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140979272",
      "pull_request_review_id": 2918347276,
      "id": 2140979272,
      "node_id": "PRRC_kwDOABII585_nMBI",
      "diff_hunk": "@@ -68,9 +68,9 @@ struct {\n  *\n  * waste = selectionTotal - target + inputs √ó (currentFeeRate - longTermFeeRate)\n  *\n- * The algorithm uses two additional optimizations. A lookahead keeps track of the total value of\n+ * The algorithm uses two additional optimizations. A lookahead (tk) keeps track of the total value of",
      "path": "src/wallet/coinselection.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "9580c0e49030f13fe57603521b59b96e6e50cf82",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In 9580c0e49030f13fe57603521b59b96e6e50cf82 \"coinselection: rewrite BnB in CoinGrinder-style\"\r\n\r\nWhat is `(tk)` mean?",
      "created_at": "2025-06-11T20:13:47Z",
      "updated_at": "2025-06-11T20:22:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2140979272",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140979272"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 71,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140979521",
      "pull_request_review_id": 2918347276,
      "id": 2140979521,
      "node_id": "PRRC_kwDOABII585_nMFB",
      "diff_hunk": "@@ -68,9 +68,9 @@ struct {\n  *\n  * waste = selectionTotal - target + inputs √ó (currentFeeRate - longTermFeeRate)\n  *\n- * The algorithm uses two additional optimizations. A lookahead keeps track of the total value of\n+ * The algorithm uses two additional optimizations. A lookahead (tk) keeps track of the total value of\n  * the unexplored UTXOs. A subtree is not explored if the lookahead indicates that the target range\n- * cannot be reached. Further, it is unnecessary to test equivalent combinations. This allows us\n+ * cannot be reached. Further, it is unnecessary to test equivalent combinations (tk). This allows us",
      "path": "src/wallet/coinselection.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "9580c0e49030f13fe57603521b59b96e6e50cf82",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In 9580c0e49030f13fe57603521b59b96e6e50cf82 \"coinselection: rewrite BnB in CoinGrinder-style\"\r\n\r\nWhat is `(tk)` mean?",
      "created_at": "2025-06-11T20:13:57Z",
      "updated_at": "2025-06-11T20:22:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2140979521",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140979521"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 73,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140980302",
      "pull_request_review_id": 2918347276,
      "id": 2140980302,
      "node_id": "PRRC_kwDOABII585_nMRO",
      "diff_hunk": "@@ -68,7 +68,7 @@ struct {\n  *\n  * waste = selectionTotal - target + inputs √ó (currentFeeRate - longTermFeeRate)\n  *\n- * The algorithm uses two additional optimizations. A lookahead (tk) keeps track of the total value of",
      "path": "src/wallet/coinselection.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "6ff6e98000792f715324c513fd9eb83440929d0e",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In 6ff6e98000792f715324c513fd9eb83440929d0e \"coinselection: Track effective_value lookahead\"\r\n\r\nThis should be squashed into 9580c0e49030f13fe57603521b59b96e6e50cf82 \"coinselection: rewrite BnB in CoinGrinder-style\"",
      "created_at": "2025-06-11T20:14:26Z",
      "updated_at": "2025-06-11T20:22:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2140980302",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140980302"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 71,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140980901",
      "pull_request_review_id": 2918347276,
      "id": 2140980901,
      "node_id": "PRRC_kwDOABII585_nMal",
      "diff_hunk": "@@ -70,7 +70,7 @@ struct {\n  *\n  * The algorithm uses two additional optimizations. A lookahead keeps track of the total value of\n  * the unexplored UTXOs. A subtree is not explored if the lookahead indicates that the target range\n- * cannot be reached. Further, it is unnecessary to test equivalent combinations (tk). This allows us",
      "path": "src/wallet/coinselection.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "ee103e5df91ecd8aa80da7da709b7d51eee65738",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In 9580c0e49030f13fe57603521b59b96e6e50cf82 \"coinselection: rewrite BnB in CoinGrinder-style\"\r\n\r\nThis should be squashed into 9580c0e49030f13fe57603521b59b96e6e50cf82 \"coinselection: rewrite BnB in CoinGrinder-style\"",
      "created_at": "2025-06-11T20:14:48Z",
      "updated_at": "2025-06-11T20:22:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2140980901",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2140980901"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 73,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141115258",
      "pull_request_review_id": 2918744321,
      "id": 2141115258,
      "node_id": "PRRC_kwDOABII585_ntN6",
      "diff_hunk": "@@ -210,6 +211,9 @@ BOOST_AUTO_TEST_CASE(bnb_search_test)\n         const auto result9 = SelectCoinsBnB(GroupCoins(available_coins.All()), 1 * CENT, coin_selection_params_bnb.m_cost_of_change);\n         BOOST_CHECK(result9);\n         BOOST_CHECK_EQUAL(result9->GetSelectedValue(), 1 * CENT);\n+        // Demonstrate how following improvements reduce iteration count and catch any regressions in the future.",
      "path": "src/wallet/test/coinselector_tests.cpp",
      "position": null,
      "original_position": 12,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "df20dd4f905a0d04e48bfe20919cccaff11b9b30",
      "in_reply_to_id": 2140854993,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Thanks, I removed the repeated comment and added an explanation to the commit message instead.",
      "created_at": "2025-06-11T21:06:59Z",
      "updated_at": "2025-06-12T00:36:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2141115258",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141115258"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141138034",
      "pull_request_review_id": 2918744321,
      "id": 2141138034,
      "node_id": "PRRC_kwDOABII585_nyxy",
      "diff_hunk": "@@ -68,9 +68,9 @@ struct {\n  *\n  * waste = selectionTotal - target + inputs √ó (currentFeeRate - longTermFeeRate)\n  *\n- * The algorithm uses two additional optimizations. A lookahead keeps track of the total value of\n+ * The algorithm uses two additional optimizations. A lookahead (tk) keeps track of the total value of",
      "path": "src/wallet/coinselection.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "9580c0e49030f13fe57603521b59b96e6e50cf82",
      "in_reply_to_id": 2140979272,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "\"tk\" is a symbol for \"to come\" in drafting articles. My idea was to express that these two optimizations are not in this first commit, but will be implemented in the coming PRs. On second thought, I removed these sentences and will reintroduce with the commits that introduce the described optimizations.",
      "created_at": "2025-06-11T21:20:16Z",
      "updated_at": "2025-06-12T00:36:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2141138034",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141138034"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 71,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141161172",
      "pull_request_review_id": 2918744321,
      "id": 2141161172,
      "node_id": "PRRC_kwDOABII585_n4bU",
      "diff_hunk": "@@ -68,9 +68,9 @@ struct {\n  *\n  * waste = selectionTotal - target + inputs √ó (currentFeeRate - longTermFeeRate)\n  *\n- * The algorithm uses two additional optimizations. A lookahead keeps track of the total value of\n+ * The algorithm uses two additional optimizations. A lookahead (tk) keeps track of the total value of\n  * the unexplored UTXOs. A subtree is not explored if the lookahead indicates that the target range\n- * cannot be reached. Further, it is unnecessary to test equivalent combinations. This allows us\n+ * cannot be reached. Further, it is unnecessary to test equivalent combinations (tk). This allows us",
      "path": "src/wallet/coinselection.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "9580c0e49030f13fe57603521b59b96e6e50cf82",
      "in_reply_to_id": 2140979521,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Responded above.",
      "created_at": "2025-06-11T21:40:30Z",
      "updated_at": "2025-06-12T00:36:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2141161172",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141161172"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 73,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141164370",
      "pull_request_review_id": 2918744321,
      "id": 2141164370,
      "node_id": "PRRC_kwDOABII585_n5NS",
      "diff_hunk": "@@ -93,114 +93,129 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;\n     for (const OutputGroup& utxo : utxo_pool) {\n-        // Assert that this utxo is not negative. It should never be negative,\n-        // effective value calculation should have removed it\n-        assert(utxo.GetSelectionAmount() > 0);\n-        curr_available_value += utxo.GetSelectionAmount();\n+        // Assert UTXOs with non-positive effective value have been filtered\n+        Assume(utxo.GetSelectionAmount() > 0);\n+        total_available += utxo.GetSelectionAmount();\n     }\n-    if (curr_available_value < selection_target) {\n+\n+    if (total_available < selection_target) {\n+        // Insufficient funds\n         return util::Error();\n     }\n \n-    // Sort the utxo_pool\n     std::sort(utxo_pool.begin(), utxo_pool.end(), descending);\n \n-    CAmount curr_waste = 0;\n+    // The current selection and the best input set found so far, stored as the utxo_pool indices of the UTXOs forming them\n+    std::vector<size_t> curr_selection;\n     std::vector<size_t> best_selection;\n+\n+    // The currently selected effective amount\n+    CAmount curr_amount = 0;\n+\n+    // The waste score of the current section, and the best waste score so far\n+    CAmount curr_selection_waste = 0;\n     CAmount best_waste = MAX_MONEY;\n \n-    bool is_feerate_high = utxo_pool.at(0).fee > utxo_pool.at(0).long_term_fee;\n+    // The weight of the currently selected input set\n+    int curr_weight = 0;\n+\n+    // Whether the input sets generated during this search have exceeded the maximum transaction weight at any point\n     bool max_tx_weight_exceeded = false;\n \n-    // Depth First search loop for choosing the UTXOs\n-    for (size_t curr_try = 0, utxo_pool_index = 0; curr_try < TOTAL_TRIES; ++curr_try, ++utxo_pool_index) {\n-        result.SetSelectionsEvaluated(curr_try);\n-        // Conditions for starting a backtrack\n-        bool backtrack = false;\n-        if (curr_value + curr_available_value < selection_target || // Cannot possibly reach target with the amount remaining in the curr_available_value.\n-            curr_value > selection_target + cost_of_change || // Selected value is out of range, go back and try other branch\n-            (curr_waste > best_waste && is_feerate_high)) { // Don't select things which we know will be more wasteful if the waste is increasing\n-            backtrack = true;\n-        } else if (curr_selection_weight > max_selection_weight) { // Selected UTXOs weight exceeds the maximum weight allowed, cannot find more solutions by adding more inputs\n-            max_tx_weight_exceeded = true; // at least one selection attempt exceeded the max weight\n-            backtrack = true;\n-        } else if (curr_value >= selection_target) {       // Selected value is within range\n-            curr_waste += (curr_value - selection_target); // This is the excess value which is added to the waste for the below comparison\n-            // Adding another UTXO after this check could bring the waste down if the long term fee is higher than the current fee.\n-            // However we are not going to explore that because this optimization for the waste is only done when we have hit our target\n-            // value. Adding any more UTXOs will be just burning the UTXO; it will go entirely to fees. Thus we aren't going to\n-            // explore any more UTXOs to avoid burning money like that.\n+    // Index of the next UTXO to consider in utxo_pool\n+    size_t next_utxo = 0;\n+\n+    auto deselect_last = [&]() {\n+        OutputGroup& utxo = utxo_pool[curr_selection.back()];\n+        curr_amount -= utxo.GetSelectionAmount();\n+        curr_weight -= utxo.m_weight;\n+        curr_selection_waste -= utxo.fee - utxo.long_term_fee;\n+        curr_selection.pop_back();\n+    };\n+\n+    size_t curr_try = 0;\n+    while (true) {\n+        bool should_shift{false}, should_cut{false};\n+        // Select `next_utxo`\n+        OutputGroup& utxo = utxo_pool[next_utxo];\n+        curr_amount += utxo.GetSelectionAmount();\n+        curr_weight += utxo.m_weight;\n+        curr_selection_waste += utxo.fee - utxo.long_term_fee;\n+        curr_selection.push_back(next_utxo);\n+        ++next_utxo;\n+        ++curr_try;\n+\n+        // EVALUATE current selection: check for solutions and see whether we can CUT or SHIFT before EXPLORING further\n+        if (curr_weight > max_selection_weight) {\n+            // max_weight exceeded: SHIFT\n+            max_tx_weight_exceeded = true;\n+            should_shift  = true;\n+        } else if (curr_amount > selection_target + cost_of_change) {\n+            // Overshot target range: SHIFT\n+            should_shift = true;\n+        } else if (curr_amount >= selection_target) {\n+            // Selection is within target window: potential solution\n+            // Adding more UTXOs only increases fees and cannot be better: SHIFT\n+            should_shift  = true;\n+            // The amount exceeding the selection_target (the \"excess\"), would be dropped to the fees: it is waste.\n+            CAmount curr_excess = curr_amount - selection_target;\n+            CAmount curr_waste = curr_selection_waste + curr_excess;\n             if (curr_waste <= best_waste) {\n+                // New best solution\n                 best_selection = curr_selection;\n                 best_waste = curr_waste;\n             }\n-            curr_waste -= (curr_value - selection_target); // Remove the excess value as we will be selecting different coins now\n-            backtrack = true;\n         }\n \n-        if (backtrack) { // Backtracking, moving backwards\n-            if (curr_selection.empty()) { // We have walked back to the first utxo and no branch is untraversed. All solutions searched\n-                break;\n-            }\n+        if (curr_try >= TOTAL_TRIES) {\n+            // Solution is not guaranteed to be optimal if `curr_try` hit TOTAL_TRIES\n+            break;\n+        }\n \n-            // Add omitted UTXOs back to lookahead before traversing the omission branch of last included UTXO.\n-            for (--utxo_pool_index; utxo_pool_index > curr_selection.back(); --utxo_pool_index) {\n-                curr_available_value += utxo_pool.at(utxo_pool_index).GetSelectionAmount();\n-            }\n+        if (next_utxo == utxo_pool.size()) {\n+            // Last added UTXO was end of UTXO pool, nothing left to add on inclusion or omission branch: CUT\n+            should_cut = true;\n+        }\n \n-            // Output was included on previous iterations, try excluding now.\n-            assert(utxo_pool_index == curr_selection.back());\n-            OutputGroup& utxo = utxo_pool.at(utxo_pool_index);\n-            curr_value -= utxo.GetSelectionAmount();\n-            curr_waste -= utxo.fee - utxo.long_term_fee;\n-            curr_selection_weight -= utxo.m_weight;\n-            curr_selection.pop_back();\n-        } else { // Moving forwards, continuing down this branch\n-            OutputGroup& utxo = utxo_pool.at(utxo_pool_index);\n-\n-            // Remove this utxo from the curr_available_value utxo amount\n-            curr_available_value -= utxo.GetSelectionAmount();\n-\n-            if (curr_selection.empty() ||\n-                // The previous index is included and therefore not relevant for exclusion shortcut\n-                (utxo_pool_index - 1) == curr_selection.back() ||\n-                // Avoid searching a branch if the previous UTXO has the same value and same waste and was excluded.\n-                // Since the ratio of fee to long term fee is the same, we only need to check if one of those values match in order to know that the waste is the same.\n-                utxo.GetSelectionAmount() != utxo_pool.at(utxo_pool_index - 1).GetSelectionAmount() ||\n-                utxo.fee != utxo_pool.at(utxo_pool_index - 1).fee)\n-            {\n-                // Inclusion branch first (Largest First Exploration)\n-                curr_selection.push_back(utxo_pool_index);\n-                curr_value += utxo.GetSelectionAmount();\n-                curr_waste += utxo.fee - utxo.long_term_fee;\n-                curr_selection_weight += utxo.m_weight;\n+        if (should_cut) {\n+            // Neither adding to the current selection nor exploring the omission branch of the last selected UTXO can\n+            // find any solutions. Redirect to exploring the Omission branch of the penultimate selected UTXO (i.e.\n+            // set `next_utxo` to one after the penultimate selected, then deselect the last two selected UTXOs)\n+            should_cut = false;",
      "path": "src/wallet/coinselection.cpp",
      "position": null,
      "original_position": 190,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "9580c0e49030f13fe57603521b59b96e6e50cf82",
      "in_reply_to_id": 2140951729,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Removed",
      "created_at": "2025-06-11T21:43:17Z",
      "updated_at": "2025-06-12T00:36:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2141164370",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141164370"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 187,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141164846",
      "pull_request_review_id": 2918744321,
      "id": 2141164846,
      "node_id": "PRRC_kwDOABII585_n5Uu",
      "diff_hunk": "@@ -93,114 +93,129 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;\n     for (const OutputGroup& utxo : utxo_pool) {\n-        // Assert that this utxo is not negative. It should never be negative,\n-        // effective value calculation should have removed it\n-        assert(utxo.GetSelectionAmount() > 0);\n-        curr_available_value += utxo.GetSelectionAmount();\n+        // Assert UTXOs with non-positive effective value have been filtered\n+        Assume(utxo.GetSelectionAmount() > 0);\n+        total_available += utxo.GetSelectionAmount();\n     }\n-    if (curr_available_value < selection_target) {\n+\n+    if (total_available < selection_target) {\n+        // Insufficient funds\n         return util::Error();\n     }\n \n-    // Sort the utxo_pool\n     std::sort(utxo_pool.begin(), utxo_pool.end(), descending);\n \n-    CAmount curr_waste = 0;\n+    // The current selection and the best input set found so far, stored as the utxo_pool indices of the UTXOs forming them\n+    std::vector<size_t> curr_selection;\n     std::vector<size_t> best_selection;\n+\n+    // The currently selected effective amount\n+    CAmount curr_amount = 0;\n+\n+    // The waste score of the current section, and the best waste score so far\n+    CAmount curr_selection_waste = 0;\n     CAmount best_waste = MAX_MONEY;\n \n-    bool is_feerate_high = utxo_pool.at(0).fee > utxo_pool.at(0).long_term_fee;\n+    // The weight of the currently selected input set\n+    int curr_weight = 0;\n+\n+    // Whether the input sets generated during this search have exceeded the maximum transaction weight at any point\n     bool max_tx_weight_exceeded = false;\n \n-    // Depth First search loop for choosing the UTXOs\n-    for (size_t curr_try = 0, utxo_pool_index = 0; curr_try < TOTAL_TRIES; ++curr_try, ++utxo_pool_index) {\n-        result.SetSelectionsEvaluated(curr_try);\n-        // Conditions for starting a backtrack\n-        bool backtrack = false;\n-        if (curr_value + curr_available_value < selection_target || // Cannot possibly reach target with the amount remaining in the curr_available_value.\n-            curr_value > selection_target + cost_of_change || // Selected value is out of range, go back and try other branch\n-            (curr_waste > best_waste && is_feerate_high)) { // Don't select things which we know will be more wasteful if the waste is increasing\n-            backtrack = true;\n-        } else if (curr_selection_weight > max_selection_weight) { // Selected UTXOs weight exceeds the maximum weight allowed, cannot find more solutions by adding more inputs\n-            max_tx_weight_exceeded = true; // at least one selection attempt exceeded the max weight\n-            backtrack = true;\n-        } else if (curr_value >= selection_target) {       // Selected value is within range\n-            curr_waste += (curr_value - selection_target); // This is the excess value which is added to the waste for the below comparison\n-            // Adding another UTXO after this check could bring the waste down if the long term fee is higher than the current fee.\n-            // However we are not going to explore that because this optimization for the waste is only done when we have hit our target\n-            // value. Adding any more UTXOs will be just burning the UTXO; it will go entirely to fees. Thus we aren't going to\n-            // explore any more UTXOs to avoid burning money like that.\n+    // Index of the next UTXO to consider in utxo_pool\n+    size_t next_utxo = 0;\n+\n+    auto deselect_last = [&]() {\n+        OutputGroup& utxo = utxo_pool[curr_selection.back()];\n+        curr_amount -= utxo.GetSelectionAmount();\n+        curr_weight -= utxo.m_weight;\n+        curr_selection_waste -= utxo.fee - utxo.long_term_fee;\n+        curr_selection.pop_back();\n+    };\n+\n+    size_t curr_try = 0;\n+    while (true) {\n+        bool should_shift{false}, should_cut{false};\n+        // Select `next_utxo`\n+        OutputGroup& utxo = utxo_pool[next_utxo];\n+        curr_amount += utxo.GetSelectionAmount();\n+        curr_weight += utxo.m_weight;\n+        curr_selection_waste += utxo.fee - utxo.long_term_fee;\n+        curr_selection.push_back(next_utxo);\n+        ++next_utxo;\n+        ++curr_try;\n+\n+        // EVALUATE current selection: check for solutions and see whether we can CUT or SHIFT before EXPLORING further\n+        if (curr_weight > max_selection_weight) {\n+            // max_weight exceeded: SHIFT\n+            max_tx_weight_exceeded = true;\n+            should_shift  = true;\n+        } else if (curr_amount > selection_target + cost_of_change) {\n+            // Overshot target range: SHIFT\n+            should_shift = true;\n+        } else if (curr_amount >= selection_target) {\n+            // Selection is within target window: potential solution\n+            // Adding more UTXOs only increases fees and cannot be better: SHIFT\n+            should_shift  = true;\n+            // The amount exceeding the selection_target (the \"excess\"), would be dropped to the fees: it is waste.\n+            CAmount curr_excess = curr_amount - selection_target;\n+            CAmount curr_waste = curr_selection_waste + curr_excess;\n             if (curr_waste <= best_waste) {\n+                // New best solution\n                 best_selection = curr_selection;\n                 best_waste = curr_waste;\n             }\n-            curr_waste -= (curr_value - selection_target); // Remove the excess value as we will be selecting different coins now\n-            backtrack = true;\n         }\n \n-        if (backtrack) { // Backtracking, moving backwards\n-            if (curr_selection.empty()) { // We have walked back to the first utxo and no branch is untraversed. All solutions searched\n-                break;\n-            }\n+        if (curr_try >= TOTAL_TRIES) {\n+            // Solution is not guaranteed to be optimal if `curr_try` hit TOTAL_TRIES\n+            break;\n+        }\n \n-            // Add omitted UTXOs back to lookahead before traversing the omission branch of last included UTXO.\n-            for (--utxo_pool_index; utxo_pool_index > curr_selection.back(); --utxo_pool_index) {\n-                curr_available_value += utxo_pool.at(utxo_pool_index).GetSelectionAmount();\n-            }\n+        if (next_utxo == utxo_pool.size()) {\n+            // Last added UTXO was end of UTXO pool, nothing left to add on inclusion or omission branch: CUT\n+            should_cut = true;\n+        }\n \n-            // Output was included on previous iterations, try excluding now.\n-            assert(utxo_pool_index == curr_selection.back());\n-            OutputGroup& utxo = utxo_pool.at(utxo_pool_index);\n-            curr_value -= utxo.GetSelectionAmount();\n-            curr_waste -= utxo.fee - utxo.long_term_fee;\n-            curr_selection_weight -= utxo.m_weight;\n-            curr_selection.pop_back();\n-        } else { // Moving forwards, continuing down this branch\n-            OutputGroup& utxo = utxo_pool.at(utxo_pool_index);\n-\n-            // Remove this utxo from the curr_available_value utxo amount\n-            curr_available_value -= utxo.GetSelectionAmount();\n-\n-            if (curr_selection.empty() ||\n-                // The previous index is included and therefore not relevant for exclusion shortcut\n-                (utxo_pool_index - 1) == curr_selection.back() ||\n-                // Avoid searching a branch if the previous UTXO has the same value and same waste and was excluded.\n-                // Since the ratio of fee to long term fee is the same, we only need to check if one of those values match in order to know that the waste is the same.\n-                utxo.GetSelectionAmount() != utxo_pool.at(utxo_pool_index - 1).GetSelectionAmount() ||\n-                utxo.fee != utxo_pool.at(utxo_pool_index - 1).fee)\n-            {\n-                // Inclusion branch first (Largest First Exploration)\n-                curr_selection.push_back(utxo_pool_index);\n-                curr_value += utxo.GetSelectionAmount();\n-                curr_waste += utxo.fee - utxo.long_term_fee;\n-                curr_selection_weight += utxo.m_weight;\n+        if (should_cut) {\n+            // Neither adding to the current selection nor exploring the omission branch of the last selected UTXO can\n+            // find any solutions. Redirect to exploring the Omission branch of the penultimate selected UTXO (i.e.\n+            // set `next_utxo` to one after the penultimate selected, then deselect the last two selected UTXOs)\n+            should_cut = false;\n+            deselect_last();\n+            should_shift  = true;\n+        }\n+\n+        if (should_shift) {\n+            // Set `next_utxo` to one after last selected, then deselect last selected UTXO\n+            if (curr_selection.empty()) {\n+                // Exhausted search space before running into attempt limit\n+                break;\n             }\n+            next_utxo = curr_selection.back() + 1;\n+            deselect_last();\n+            should_shift  = false;",
      "path": "src/wallet/coinselection.cpp",
      "position": 230,
      "original_position": 203,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "9580c0e49030f13fe57603521b59b96e6e50cf82",
      "in_reply_to_id": 2140952030,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Removed",
      "created_at": "2025-06-11T21:43:38Z",
      "updated_at": "2025-06-12T00:36:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2141164846",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141164846"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 241,
      "original_line": 241,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141269177",
      "pull_request_review_id": 2918744321,
      "id": 2141269177,
      "node_id": "PRRC_kwDOABII585_oSy5",
      "diff_hunk": "@@ -157,6 +158,9 @@ util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool\n         } else if (curr_amount > selection_target + cost_of_change) {\n             // Overshot target range: SHIFT\n             should_shift = true;\n+        } else if (is_feerate_high && curr_selection_waste > best_waste) {",
      "path": "src/wallet/coinselection.cpp",
      "position": 171,
      "original_position": 12,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "813ac54726866b1051c502fe8bfef3b279af890f",
      "in_reply_to_id": 2140968745,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "At high feerates adding more inputs will increase the waste score. If the current waste is already worse than the best selection‚Äôs while we have insufficient funds, we cannot beat the best selection by adding more inputs: SHIFT\r\n\r\nAt low feerates, adding more inputs decreases waste, so we would exit prematurely.",
      "created_at": "2025-06-11T23:38:47Z",
      "updated_at": "2025-06-12T00:36:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2141269177",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141269177"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 191,
      "original_line": 191,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141280726",
      "pull_request_review_id": 2918744321,
      "id": 2141280726,
      "node_id": "PRRC_kwDOABII585_oVnW",
      "diff_hunk": "@@ -93,20 +93,25 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    // Check that there are sufficient funds\n+    std::sort(utxo_pool.begin(), utxo_pool.end(), descending);\n+    // The sum of UTXO amounts after this UTXO index, e.g. lookahead[5] = Œ£(UTXO[6+].amount)\n+    std::vector<CAmount> lookahead(utxo_pool.size());\n+\n+    // Calculate lookahead values, and check that there are sufficient funds\n     CAmount total_available = 0;\n-    for (const OutputGroup& utxo : utxo_pool) {\n-        // Assert UTXOs with non-positive effective value have been filtered\n-        Assume(utxo.GetSelectionAmount() > 0);\n-        total_available += utxo.GetSelectionAmount();\n+    for (size_t i = 0; i < utxo_pool.size(); ++i) {\n+        size_t index = utxo_pool.size() - 1 - i; // Loop over every element in reverse order",
      "path": "src/wallet/coinselection.cpp",
      "position": null,
      "original_position": 25,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "6ff6e98000792f715324c513fd9eb83440929d0e",
      "in_reply_to_id": 2140974454,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Taken with minor adjustments.",
      "created_at": "2025-06-11T23:55:09Z",
      "updated_at": "2025-06-12T00:36:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2141280726",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141280726"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": 102,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 103,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141309011",
      "pull_request_review_id": 2918744321,
      "id": 2141309011,
      "node_id": "PRRC_kwDOABII585_ochT",
      "diff_hunk": "@@ -93,114 +93,129 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;\n     for (const OutputGroup& utxo : utxo_pool) {\n-        // Assert that this utxo is not negative. It should never be negative,\n-        // effective value calculation should have removed it\n-        assert(utxo.GetSelectionAmount() > 0);\n-        curr_available_value += utxo.GetSelectionAmount();\n+        // Assert UTXOs with non-positive effective value have been filtered\n+        Assume(utxo.GetSelectionAmount() > 0);\n+        total_available += utxo.GetSelectionAmount();\n     }\n-    if (curr_available_value < selection_target) {\n+\n+    if (total_available < selection_target) {\n+        // Insufficient funds\n         return util::Error();\n     }\n \n-    // Sort the utxo_pool\n     std::sort(utxo_pool.begin(), utxo_pool.end(), descending);\n \n-    CAmount curr_waste = 0;\n+    // The current selection and the best input set found so far, stored as the utxo_pool indices of the UTXOs forming them\n+    std::vector<size_t> curr_selection;\n     std::vector<size_t> best_selection;\n+\n+    // The currently selected effective amount\n+    CAmount curr_amount = 0;\n+\n+    // The waste score of the current section, and the best waste score so far\n+    CAmount curr_selection_waste = 0;\n     CAmount best_waste = MAX_MONEY;\n \n-    bool is_feerate_high = utxo_pool.at(0).fee > utxo_pool.at(0).long_term_fee;\n+    // The weight of the currently selected input set\n+    int curr_weight = 0;\n+\n+    // Whether the input sets generated during this search have exceeded the maximum transaction weight at any point\n     bool max_tx_weight_exceeded = false;\n \n-    // Depth First search loop for choosing the UTXOs\n-    for (size_t curr_try = 0, utxo_pool_index = 0; curr_try < TOTAL_TRIES; ++curr_try, ++utxo_pool_index) {\n-        result.SetSelectionsEvaluated(curr_try);\n-        // Conditions for starting a backtrack\n-        bool backtrack = false;\n-        if (curr_value + curr_available_value < selection_target || // Cannot possibly reach target with the amount remaining in the curr_available_value.\n-            curr_value > selection_target + cost_of_change || // Selected value is out of range, go back and try other branch\n-            (curr_waste > best_waste && is_feerate_high)) { // Don't select things which we know will be more wasteful if the waste is increasing\n-            backtrack = true;\n-        } else if (curr_selection_weight > max_selection_weight) { // Selected UTXOs weight exceeds the maximum weight allowed, cannot find more solutions by adding more inputs\n-            max_tx_weight_exceeded = true; // at least one selection attempt exceeded the max weight\n-            backtrack = true;\n-        } else if (curr_value >= selection_target) {       // Selected value is within range\n-            curr_waste += (curr_value - selection_target); // This is the excess value which is added to the waste for the below comparison\n-            // Adding another UTXO after this check could bring the waste down if the long term fee is higher than the current fee.\n-            // However we are not going to explore that because this optimization for the waste is only done when we have hit our target\n-            // value. Adding any more UTXOs will be just burning the UTXO; it will go entirely to fees. Thus we aren't going to\n-            // explore any more UTXOs to avoid burning money like that.\n+    // Index of the next UTXO to consider in utxo_pool\n+    size_t next_utxo = 0;\n+\n+    auto deselect_last = [&]() {\n+        OutputGroup& utxo = utxo_pool[curr_selection.back()];\n+        curr_amount -= utxo.GetSelectionAmount();\n+        curr_weight -= utxo.m_weight;\n+        curr_selection_waste -= utxo.fee - utxo.long_term_fee;\n+        curr_selection.pop_back();\n+    };\n+\n+    size_t curr_try = 0;\n+    while (true) {\n+        bool should_shift{false}, should_cut{false};\n+        // Select `next_utxo`\n+        OutputGroup& utxo = utxo_pool[next_utxo];\n+        curr_amount += utxo.GetSelectionAmount();\n+        curr_weight += utxo.m_weight;\n+        curr_selection_waste += utxo.fee - utxo.long_term_fee;\n+        curr_selection.push_back(next_utxo);\n+        ++next_utxo;\n+        ++curr_try;\n+\n+        // EVALUATE current selection: check for solutions and see whether we can CUT or SHIFT before EXPLORING further\n+        if (curr_weight > max_selection_weight) {\n+            // max_weight exceeded: SHIFT\n+            max_tx_weight_exceeded = true;\n+            should_shift  = true;\n+        } else if (curr_amount > selection_target + cost_of_change) {\n+            // Overshot target range: SHIFT\n+            should_shift = true;\n+        } else if (curr_amount >= selection_target) {\n+            // Selection is within target window: potential solution\n+            // Adding more UTXOs only increases fees and cannot be better: SHIFT\n+            should_shift  = true;\n+            // The amount exceeding the selection_target (the \"excess\"), would be dropped to the fees: it is waste.\n+            CAmount curr_excess = curr_amount - selection_target;\n+            CAmount curr_waste = curr_selection_waste + curr_excess;\n             if (curr_waste <= best_waste) {\n+                // New best solution\n                 best_selection = curr_selection;\n                 best_waste = curr_waste;\n             }\n-            curr_waste -= (curr_value - selection_target); // Remove the excess value as we will be selecting different coins now\n-            backtrack = true;\n         }\n \n-        if (backtrack) { // Backtracking, moving backwards\n-            if (curr_selection.empty()) { // We have walked back to the first utxo and no branch is untraversed. All solutions searched\n-                break;\n-            }\n+        if (curr_try >= TOTAL_TRIES) {\n+            // Solution is not guaranteed to be optimal if `curr_try` hit TOTAL_TRIES\n+            break;\n+        }\n \n-            // Add omitted UTXOs back to lookahead before traversing the omission branch of last included UTXO.\n-            for (--utxo_pool_index; utxo_pool_index > curr_selection.back(); --utxo_pool_index) {\n-                curr_available_value += utxo_pool.at(utxo_pool_index).GetSelectionAmount();\n-            }\n+        if (next_utxo == utxo_pool.size()) {\n+            // Last added UTXO was end of UTXO pool, nothing left to add on inclusion or omission branch: CUT\n+            should_cut = true;\n+        }\n \n-            // Output was included on previous iterations, try excluding now.\n-            assert(utxo_pool_index == curr_selection.back());\n-            OutputGroup& utxo = utxo_pool.at(utxo_pool_index);\n-            curr_value -= utxo.GetSelectionAmount();\n-            curr_waste -= utxo.fee - utxo.long_term_fee;\n-            curr_selection_weight -= utxo.m_weight;\n-            curr_selection.pop_back();\n-        } else { // Moving forwards, continuing down this branch\n-            OutputGroup& utxo = utxo_pool.at(utxo_pool_index);\n-\n-            // Remove this utxo from the curr_available_value utxo amount\n-            curr_available_value -= utxo.GetSelectionAmount();\n-\n-            if (curr_selection.empty() ||\n-                // The previous index is included and therefore not relevant for exclusion shortcut\n-                (utxo_pool_index - 1) == curr_selection.back() ||\n-                // Avoid searching a branch if the previous UTXO has the same value and same waste and was excluded.\n-                // Since the ratio of fee to long term fee is the same, we only need to check if one of those values match in order to know that the waste is the same.\n-                utxo.GetSelectionAmount() != utxo_pool.at(utxo_pool_index - 1).GetSelectionAmount() ||\n-                utxo.fee != utxo_pool.at(utxo_pool_index - 1).fee)\n-            {\n-                // Inclusion branch first (Largest First Exploration)\n-                curr_selection.push_back(utxo_pool_index);\n-                curr_value += utxo.GetSelectionAmount();\n-                curr_waste += utxo.fee - utxo.long_term_fee;\n-                curr_selection_weight += utxo.m_weight;\n+        if (should_cut) {\n+            // Neither adding to the current selection nor exploring the omission branch of the last selected UTXO can\n+            // find any solutions. Redirect to exploring the Omission branch of the penultimate selected UTXO (i.e.\n+            // set `next_utxo` to one after the penultimate selected, then deselect the last two selected UTXOs)\n+            should_cut = false;\n+            deselect_last();\n+            should_shift  = true;\n+        }\n+\n+        if (should_shift) {\n+            // Set `next_utxo` to one after last selected, then deselect last selected UTXO\n+            if (curr_selection.empty()) {\n+                // Exhausted search space before running into attempt limit\n+                break;\n             }\n+            next_utxo = curr_selection.back() + 1;\n+            deselect_last();\n+            should_shift  = false;\n         }\n     }\n \n-    // Check for solution\n+    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n+    result.SetSelectionsEvaluated(curr_try);\n+\n     if (best_selection.empty()) {\n         return max_tx_weight_exceeded ? ErrorMaxWeightExceeded() : util::Error();\n     }\n \n-    // Set output set\n     for (const size_t& i : best_selection) {\n         result.AddInput(utxo_pool.at(i));\n     }\n-    result.RecalculateWaste(cost_of_change, cost_of_change, CAmount{0});\n-    assert(best_waste == result.GetWaste());",
      "path": "src/wallet/coinselection.cpp",
      "position": 288,
      "original_position": 220,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "9580c0e49030f13fe57603521b59b96e6e50cf82",
      "in_reply_to_id": 2140964773,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "The waste calculation here is semantically incorrect and it is unnecessary, because the waste of all coin selection results is recalculated after they are collected, before they are compared to correctly assess bump fees.\r\n\r\nI don‚Äôt think we want to pull the bump fee calculation into each coin selection algorithm, but maybe we can pass the entire coin selection parameters object, so that we can calculate a semantically correct waste score for coin selection results, although it may still need to be amended for bump fees afterwards.\r\n\r\nLet‚Äôs fix this in a follow-up properly. And also add some tests for the waste results of coin selection algorithms.",
      "created_at": "2025-06-12T00:35:18Z",
      "updated_at": "2025-06-12T00:36:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2141309011",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2141309011"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": 197,
      "original_start_line": 198,
      "start_side": "LEFT",
      "line": 198,
      "original_line": 198,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2157539079",
      "pull_request_review_id": 2943855318,
      "id": 2157539079,
      "node_id": "PRRC_kwDOABII586AmW8H",
      "diff_hunk": "@@ -93,114 +87,127 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;",
      "path": "src/wallet/coinselection.cpp",
      "position": 81,
      "original_position": 39,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "4be47e58bdf530351a7bc81ae961ad0a7277fb9b",
      "in_reply_to_id": null,
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Is there some rhyme or reason behind the refactor of the variable name here?  I probably would have put that into a different commit personally.  I prefer also just dropping `curr_` although I notice this is done seemingly at random since there are other variables such as `curr_selection_waste` where the original name was maintained?",
      "created_at": "2025-06-19T19:12:05Z",
      "updated_at": "2025-06-19T19:12:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2157539079",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2157539079"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 123,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2157541925",
      "pull_request_review_id": 2943859675,
      "id": 2157541925,
      "node_id": "PRRC_kwDOABII586AmXol",
      "diff_hunk": "@@ -93,114 +87,127 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;",
      "path": "src/wallet/coinselection.cpp",
      "position": 81,
      "original_position": 39,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "4be47e58bdf530351a7bc81ae961ad0a7277fb9b",
      "in_reply_to_id": 2157539079,
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "To be clear, I'm commenting on the apparent rename from `curr_available_value` to `total_available`.",
      "created_at": "2025-06-19T19:14:40Z",
      "updated_at": "2025-06-19T19:14:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2157541925",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2157541925"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 123,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2157543064",
      "pull_request_review_id": 2943861298,
      "id": 2157543064,
      "node_id": "PRRC_kwDOABII586AmX6Y",
      "diff_hunk": "@@ -93,114 +87,127 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;",
      "path": "src/wallet/coinselection.cpp",
      "position": 81,
      "original_position": 39,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "4be47e58bdf530351a7bc81ae961ad0a7277fb9b",
      "in_reply_to_id": 2157539079,
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I also think `available_value` is perfectly fine as well.",
      "created_at": "2025-06-19T19:16:04Z",
      "updated_at": "2025-06-19T19:16:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2157543064",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2157543064"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 123,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2157556966",
      "pull_request_review_id": 2943879965,
      "id": 2157556966,
      "node_id": "PRRC_kwDOABII586AmbTm",
      "diff_hunk": "@@ -93,114 +87,127 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;\n     for (const OutputGroup& utxo : utxo_pool) {\n-        // Assert that this utxo is not negative. It should never be negative,\n-        // effective value calculation should have removed it\n-        assert(utxo.GetSelectionAmount() > 0);\n-        curr_available_value += utxo.GetSelectionAmount();\n+        // Assert UTXOs with non-positive effective value have been filtered\n+        Assume(utxo.GetSelectionAmount() > 0);\n+        total_available += utxo.GetSelectionAmount();\n     }\n-    if (curr_available_value < selection_target) {\n+\n+    if (total_available < selection_target) {\n+        // Insufficient funds\n         return util::Error();\n     }\n \n-    // Sort the utxo_pool\n     std::sort(utxo_pool.begin(), utxo_pool.end(), descending);\n \n-    CAmount curr_waste = 0;\n+    // The current selection and the best input set found so far, stored as the utxo_pool indices of the UTXOs forming them\n+    std::vector<size_t> curr_selection;\n     std::vector<size_t> best_selection;\n+\n+    // The currently selected effective amount\n+    CAmount curr_amount = 0;\n+\n+    // The waste score of the current selection, and the best waste score so far\n+    CAmount curr_selection_waste = 0;\n     CAmount best_waste = MAX_MONEY;\n \n-    bool is_feerate_high = utxo_pool.at(0).fee > utxo_pool.at(0).long_term_fee;\n+    // The weight of the currently selected input set\n+    int curr_weight = 0;",
      "path": "src/wallet/coinselection.cpp",
      "position": 112,
      "original_position": 73,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "4be47e58bdf530351a7bc81ae961ad0a7277fb9b",
      "in_reply_to_id": null,
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This isn't mentioned in the comit message, so I'll ask since It's not apparent on first glance.  Why is `curr_weight` being added here?  I though bnb was agnostic to the weight, only selecting by effective_value().",
      "created_at": "2025-06-19T19:27:49Z",
      "updated_at": "2025-06-19T19:27:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2157556966",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2157556966"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 149,
      "original_line": 117,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2157558861",
      "pull_request_review_id": 2943882790,
      "id": 2157558861,
      "node_id": "PRRC_kwDOABII586AmbxN",
      "diff_hunk": "@@ -93,114 +87,127 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;\n     for (const OutputGroup& utxo : utxo_pool) {\n-        // Assert that this utxo is not negative. It should never be negative,\n-        // effective value calculation should have removed it\n-        assert(utxo.GetSelectionAmount() > 0);\n-        curr_available_value += utxo.GetSelectionAmount();\n+        // Assert UTXOs with non-positive effective value have been filtered\n+        Assume(utxo.GetSelectionAmount() > 0);\n+        total_available += utxo.GetSelectionAmount();\n     }\n-    if (curr_available_value < selection_target) {\n+\n+    if (total_available < selection_target) {\n+        // Insufficient funds\n         return util::Error();\n     }\n \n-    // Sort the utxo_pool\n     std::sort(utxo_pool.begin(), utxo_pool.end(), descending);\n \n-    CAmount curr_waste = 0;\n+    // The current selection and the best input set found so far, stored as the utxo_pool indices of the UTXOs forming them\n+    std::vector<size_t> curr_selection;\n     std::vector<size_t> best_selection;\n+\n+    // The currently selected effective amount\n+    CAmount curr_amount = 0;\n+\n+    // The waste score of the current selection, and the best waste score so far\n+    CAmount curr_selection_waste = 0;\n     CAmount best_waste = MAX_MONEY;\n \n-    bool is_feerate_high = utxo_pool.at(0).fee > utxo_pool.at(0).long_term_fee;\n+    // The weight of the currently selected input set\n+    int curr_weight = 0;",
      "path": "src/wallet/coinselection.cpp",
      "position": 112,
      "original_position": 73,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "4be47e58bdf530351a7bc81ae961ad0a7277fb9b",
      "in_reply_to_id": 2157556966,
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Sorry, my understanding of this is stale.  It looks like `max_tx_weight_exceeded` was added sometime recently which I missed.",
      "created_at": "2025-06-19T19:30:07Z",
      "updated_at": "2025-06-19T19:30:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2157558861",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2157558861"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 149,
      "original_line": 117,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2159514805",
      "pull_request_review_id": 2947044312,
      "id": 2159514805,
      "node_id": "PRRC_kwDOABII586At5S1",
      "diff_hunk": "@@ -93,114 +87,127 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;",
      "path": "src/wallet/coinselection.cpp",
      "position": 81,
      "original_position": 39,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "4be47e58bdf530351a7bc81ae961ad0a7277fb9b",
      "in_reply_to_id": 2157539079,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "`curr_available_value` was used to track the available funds in the remaining undecided UTXOs during our search. While we were exploring the search tree, we would reduce it each time we descended further in the tree, and then we had to increment it again when we ascended back to earlier UTXOs.\r\n\r\n`total_available` on the other hand is only summed up once and then refers to the total sum of available funds in our UTXO pool. While we are summing it up, we store the available funds for each depth in the `lookahead` vector. This allows us to look up the remaining funds at each depth directly and we no longer have to traverse every UTXO when we backtrack to increment the `curr_available_value` but allows us to skip back up multiple steps at once.",
      "created_at": "2025-06-20T18:48:01Z",
      "updated_at": "2025-06-20T18:56:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2159514805",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2159514805"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 123,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2159522378",
      "pull_request_review_id": 2947044312,
      "id": 2159522378,
      "node_id": "PRRC_kwDOABII586At7JK",
      "diff_hunk": "@@ -93,114 +87,127 @@ static const size_t TOTAL_TRIES = 100000;\n util::Result<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_pool, const CAmount& selection_target, const CAmount& cost_of_change,\n                                              int max_selection_weight)\n {\n-    SelectionResult result(selection_target, SelectionAlgorithm::BNB);\n-    CAmount curr_value = 0;\n-    std::vector<size_t> curr_selection; // selected utxo indexes\n-    int curr_selection_weight = 0; // sum of selected utxo weight\n-\n-    // Calculate curr_available_value\n-    CAmount curr_available_value = 0;\n+    // Check that there are sufficient funds\n+    CAmount total_available = 0;\n     for (const OutputGroup& utxo : utxo_pool) {\n-        // Assert that this utxo is not negative. It should never be negative,\n-        // effective value calculation should have removed it\n-        assert(utxo.GetSelectionAmount() > 0);\n-        curr_available_value += utxo.GetSelectionAmount();\n+        // Assert UTXOs with non-positive effective value have been filtered\n+        Assume(utxo.GetSelectionAmount() > 0);\n+        total_available += utxo.GetSelectionAmount();\n     }\n-    if (curr_available_value < selection_target) {\n+\n+    if (total_available < selection_target) {\n+        // Insufficient funds\n         return util::Error();\n     }\n \n-    // Sort the utxo_pool\n     std::sort(utxo_pool.begin(), utxo_pool.end(), descending);\n \n-    CAmount curr_waste = 0;\n+    // The current selection and the best input set found so far, stored as the utxo_pool indices of the UTXOs forming them\n+    std::vector<size_t> curr_selection;\n     std::vector<size_t> best_selection;\n+\n+    // The currently selected effective amount\n+    CAmount curr_amount = 0;\n+\n+    // The waste score of the current selection, and the best waste score so far\n+    CAmount curr_selection_waste = 0;\n     CAmount best_waste = MAX_MONEY;\n \n-    bool is_feerate_high = utxo_pool.at(0).fee > utxo_pool.at(0).long_term_fee;\n+    // The weight of the currently selected input set\n+    int curr_weight = 0;",
      "path": "src/wallet/coinselection.cpp",
      "position": 112,
      "original_position": 73,
      "commit_id": "cf36d1af18f1fdb2f9846634032f468d00d7ddfb",
      "original_commit_id": "4be47e58bdf530351a7bc81ae961ad0a7277fb9b",
      "in_reply_to_id": 2157556966,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "As you mention, `curr_weight` is necessary to test whether we have exceeded the `max_selection_weight`. While we could previously bump into unhandled failure cases where we exceeded the maximum weight for standard transactions, being able to handle smaller transaction weight limits has become even more relevant especially, because we want to be able to reliably create TRUC transactions that are limited to 1000 vB if they have a parent.",
      "created_at": "2025-06-20T18:54:28Z",
      "updated_at": "2025-06-20T18:56:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32150#discussion_r2159522378",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2159522378"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32150"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 149,
      "original_line": 117,
      "side": "RIGHT"
    }
  ]
}