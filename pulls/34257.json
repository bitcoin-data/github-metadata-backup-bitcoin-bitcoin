{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257",
    "id": 3164120126,
    "node_id": "PR_kwDOABII5868mKQ-",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/34257",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/34257.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/34257.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
    "number": 34257,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "txgraph: deterministic optimal transaction order",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "Part of #30289.\r\n\r\nTxGraph's fundamental responsibility is deciding the order of transactions in the mempool. It relies on the `cluster_linearize.h` code to optimize it, but there can and often will be many different orderings that are essentially equivalent from a quality perspective, so we have to pick one. At a high level, the solution will involve one or more of:\r\n* Deciding based on **internal identifiers** (`Cluster::m_sequence`, `DepGraphIndex`). This is very simple, but risks leaking information about transaction receive order.\r\n* Deciding **randomly**, which is private, but may interfere with relay expectations, block propagation, and ability to monitor network behavior.\r\n* Deciding **based on txid**, which is private and deterministic, but risks incentivizing grinding to get an edge (though we haven't really seen such behavior).\r\n* Deciding **based on size** (e.g. prefer smaller transactions), which is somewhat related to quality, but not unconditionally (depending on mempool layout, the ideal ordering might call for smaller transactions first, last, or anywhere in between). It's also not a strong ordering as there can be many identically-sized transactions. However, if it were to encourage grinding behavior, incentivizing smaller transactions is probably not a bad thing.\r\n\r\nAs of #32545, the current behavior is primarily picking randomly, though inconsistently, as some code paths also use internal identifiers and size. #33335 sought to change it to use random (preferring size in a few places), with the downsides listed above.\r\n\r\nThis PR is an alternative to that, which changes the order to tie-break based on size everywhere possible, and use lowest-txid-first as final fallback. This is fully deterministic: for any given set of mempool transactions, if all linearized optimally, the transaction order exposed by TxGraph is deterministic.\r\n\r\nThe transactions within a chunk are sorted according to:\r\n1. The output of `PostLinearize` (which improves sub-chunk order), using an initial linearization created using the rules 2-4 below.\r\n2. Individual transaction feerate (high to low)\r\n3. Individual transaction weight (small to large)\r\n4. Txid (low to high txid)\r\n\r\nThe chunks within a cluster are sorted according to:\r\n1. Chunk feerate (high to low)\r\n2. Chunk weight (small to large)\r\n3. Max-txid (chunk with lowest maximum-txid first)\r\n\r\nThe chunks across clusters are sorted according to:\r\n1. Feerate (high to low)\r\n2. Equal-feerate-chunk-prefix weight (small to large)\r\n3. Max-txid (chunk with lowest maximum-txid first)\r\n\r\nThe equal-feerate-chunk-prefix weight of a chunk C is defined as the sum of the weights of all chunks in the same cluster as C, with the same feerate as C, up to and including C itself, in linearization order (but excluding such chunks that appear after C). This is a well-defined approximation of sorting chunks from small to large across clusters, while remaining consistent with intra-cluster linearization order.\r\n",
    "labels": [],
    "milestone": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/74",
      "html_url": "https://github.com/bitcoin/bitcoin/milestone/74",
      "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/74/labels",
      "id": 12610874,
      "node_id": "MI_kwDOABII584AwG06",
      "number": 74,
      "state": "open",
      "title": "31.0",
      "creator": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "open_issues": 18,
      "closed_issues": 38,
      "created_at": "2025-03-25T18:44:16Z",
      "updated_at": "2026-02-09T15:44:48Z"
    },
    "created_at": "2026-01-11T23:56:09Z",
    "updated_at": "2026-02-09T19:29:21Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "c0e18c6e4d1997e7731781273c00534fc15b5c54",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "sipa:202601_det_mempool_order",
      "ref": "202601_det_mempool_order",
      "sha": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1458655,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDU4NjU1",
        "name": "bitcoin",
        "full_name": "sipa/bitcoin",
        "owner": {
          "login": "sipa",
          "id": 548488,
          "node_id": "MDQ6VXNlcjU0ODQ4OA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/sipa",
          "html_url": "https://github.com/sipa",
          "followers_url": "https://api.github.com/users/sipa/followers",
          "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
          "organizations_url": "https://api.github.com/users/sipa/orgs",
          "repos_url": "https://api.github.com/users/sipa/repos",
          "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/sipa/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/sipa/bitcoin",
        "description": "Bitcoin integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/sipa/bitcoin",
        "archive_url": "https://api.github.com/repos/sipa/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/sipa/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/sipa/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/sipa/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/sipa/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/sipa/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/sipa/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/sipa/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/sipa/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/sipa/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/sipa/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/sipa/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/sipa/bitcoin/events",
        "forks_url": "https://api.github.com/repos/sipa/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/sipa/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/sipa/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/sipa/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/sipa/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/sipa/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/sipa/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/sipa/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/sipa/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/sipa/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/sipa/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/sipa/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/sipa/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/sipa/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/sipa/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/sipa/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:sipa/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/sipa/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/sipa/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/sipa/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/sipa/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/sipa/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/sipa/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/sipa/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/sipa/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/sipa/bitcoin/hooks",
        "svn_url": "https://github.com/sipa/bitcoin",
        "homepage": "http://www.bitcoin.org",
        "language": "TypeScript",
        "forks_count": 22,
        "stargazers_count": 93,
        "watchers_count": 93,
        "size": 312896,
        "default_branch": "lows",
        "open_issues_count": 17,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-02-09T16:44:01Z",
        "created_at": "2011-03-09T10:46:59Z",
        "updated_at": "2026-02-03T05:22:28Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "6d625af2831b7c36d59f245a65df3f70f2110f69",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38878,
        "stargazers_count": 88039,
        "watchers_count": 88039,
        "size": 303366,
        "default_branch": "master",
        "open_issues_count": 720,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-02-09T19:06:11Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2026-02-09T19:20:58Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 826,
    "deletions": 396,
    "changed_files": 20,
    "commits": 10,
    "review_comments": 23,
    "comments": 13
  },
  "events": [
    {
      "event": "commented",
      "id": 3736425770,
      "node_id": "IC_kwDOABII587etVUq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3736425770",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-11T23:56:16Z",
      "updated_at": "2026-02-09T19:29:20Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34257.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [ajtowns](https://github.com/bitcoin/bitcoin/pull/34257#pullrequestreview-3770859417) |\n| Concept ACK | [instagibbs](https://github.com/bitcoin/bitcoin/pull/34257#pullrequestreview-3763603098) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#34138](https://github.com/bitcoin/bitcoin/pull/34138) (Cluster mempool: more accurate cost model for SFL by sipa)\n* [#34023](https://github.com/bitcoin/bitcoin/pull/34023) (Optimized SFL cluster linearization by sipa)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (âœ¨ experimental)\n\n\n\nPossible places where named args for integral literals may be used (e.g. `func(x, /*named_arg=*/0)` in C++, and `func(x, named_arg=0)` in Python):\n\n- [Linearize(..., rng_seed ^ 0x1337, ...)] in src/test/fuzz/cluster_linearize.cpp\n\n\n\n<sup>2026-02-08 23:08:01</sup>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3736425770",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257"
    },
    {
      "event": "labeled",
      "id": 21978759101,
      "node_id": "LE_lADOABII587ioq3GzwAAAAUeCT-9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21978759101",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-12T01:29:24Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3736607007,
      "node_id": "IC_kwDOABII587euBkf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3736607007",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-12T01:29:29Z",
      "updated_at": "2026-01-12T01:29:29Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Task `fuzzer,address,undefined,integer`: https://github.com/bitcoin/bitcoin/actions/runs/20904012857/job/60054281786</sub>\n<sub>LLM reason (âœ¨ experimental): UndefinedBehaviorSanitizer detected an unsigned integer overflow in the fuzz target cluster_linearize.cpp, causing the CI failure.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3736607007",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21990192883,
      "node_id": "HRFPE_lADOABII587ioq3GzwAAAAUet7bz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21990192883",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "963f8fd70d77cc84e055d79c4574c1df213299be",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/963f8fd70d77cc84e055d79c4574c1df213299be",
      "created_at": "2026-01-12T13:53:06Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21992124125,
      "node_id": "HRFPE_lADOABII587ioq3GzwAAAAUe1S7d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21992124125",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "7516b1f13eaad5f356d586b9d1b5ffe0516f6022",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/7516b1f13eaad5f356d586b9d1b5ffe0516f6022",
      "created_at": "2026-01-12T15:08:43Z"
    },
    {
      "event": "unlabeled",
      "id": 21995189142,
      "node_id": "UNLE_lADOABII587ioq3GzwAAAAUfA_OW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21995189142",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-12T17:17:12Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22001170747,
      "node_id": "HRFPE_lADOABII587ioq3GzwAAAAUfXzk7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22001170747",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "04eaf80bda3a5dbc85e04ab7398d4545f1712709",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/04eaf80bda3a5dbc85e04ab7398d4545f1712709",
      "created_at": "2026-01-12T22:21:38Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22019519623,
      "node_id": "HRFPE_lADOABII587ioq3GzwAAAAUgdzSH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22019519623",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "a215f40a6c1532f1e82d1c460facf78711685e54",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/a215f40a6c1532f1e82d1c460facf78711685e54",
      "created_at": "2026-01-13T15:06:03Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22020243859,
      "node_id": "HRFPE_lADOABII587ioq3GzwAAAAUggkGT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22020243859",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "f938e0b25b22dc969172f4e72f8c84e592303509",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/f938e0b25b22dc969172f4e72f8c84e592303509",
      "created_at": "2026-01-13T15:31:59Z"
    },
    {
      "event": "labeled",
      "id": 22020279819,
      "node_id": "LE_lADOABII587ioq3GzwAAAAUggs4L",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22020279819",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-13T15:33:15Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 22022546572,
      "node_id": "UNLE_lADOABII587ioq3GzwAAAAUgpWSM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22022546572",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-13T17:05:35Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22055512012,
      "node_id": "HRFPE_lADOABII587ioq3GzwAAAAUinGfM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22055512012",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "77d68ea7a20f4f862f211142512d54d8ed99998a",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/77d68ea7a20f4f862f211142512d54d8ed99998a",
      "created_at": "2026-01-14T22:48:26Z"
    },
    {
      "event": "commented",
      "id": 3752093400,
      "node_id": "IC_kwDOABII587fpGbY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3752093400",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-14T23:00:01Z",
      "updated_at": "2026-01-14T23:00:01Z",
      "author_association": "MEMBER",
      "body": "I have a few changes to comments and tests. Most importantly, the optimal linearization unit tests now compare with an exact known-correct optimal linearization. To generate those, I have updated https://github.com/sipa/pyclusterlin to construct the same deterministic linearization order (if optimal).",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3752093400",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257"
    },
    {
      "event": "labeled",
      "id": 22068111138,
      "node_id": "LE_lADOABII587ioq3GzwAAAAUjXKci",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22068111138",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T12:09:35Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22070427492,
      "node_id": "HRFPE_lADOABII587ioq3GzwAAAAUjf_9k",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22070427492",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "dda519c8c06cf1044e6b2d7f3c091ccedb09d91a",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/dda519c8c06cf1044e6b2d7f3c091ccedb09d91a",
      "created_at": "2026-01-15T13:48:11Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22070456873,
      "node_id": "HRFPE_lADOABII587ioq3GzwAAAAUjgHIp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22070456873",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "8104ced4b23ae60568a8cc20e8a770da041d3e63",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/8104ced4b23ae60568a8cc20e8a770da041d3e63",
      "created_at": "2026-01-15T13:49:32Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22070859074,
      "node_id": "HRFPE_lADOABII587ioq3GzwAAAAUjhpVC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22070859074",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b1aaedc92d53027587e45eaf821fa411f4f0991d",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/b1aaedc92d53027587e45eaf821fa411f4f0991d",
      "created_at": "2026-01-15T14:05:48Z"
    },
    {
      "event": "labeled",
      "id": 22070888234,
      "node_id": "LE_lADOABII587ioq3GzwAAAAUjhwcq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22070888234",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T14:07:02Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 22071542256,
      "node_id": "UNLE_lADOABII587ioq3GzwAAAAUjkQHw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22071542256",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T14:36:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 22075590410,
      "node_id": "UNLE_lADOABII587ioq3GzwAAAAUjzscK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22075590410",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T17:30:52Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3757899547,
      "node_id": "IC_kwDOABII587f_P8b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3757899547",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-16T03:07:20Z",
      "updated_at": "2026-02-02T15:03:59Z",
      "author_association": "MEMBER",
      "body": "Both @darosior ([here](https://bitcoin-irc.chaincode.com/bitcoin-core-dev/2026-01-15#1187022;)) and @ajtowns ([here](https://github.com/bitcoin/bitcoin/pull/33335#issuecomment-3757246246)) suggested preferring larger size over smaller size instead. I agree that this is also fine from an incentives perspective, because nobody is going to deliberately construct larger transactions at the same feerate - that's just paying more. If that is acceptable to you, you're better off just paying a higher feerate.\r\n\r\nFor ordering chunks across clusters, when combined with a greedy block building algorithm, larger first may have a slight advantage, because skipping a larger chunk still allows the smaller chunk to be considered. This does not work for chunks within a cluster, or transactions within a chunk. I don't think it matters much, but this could be simulated if we care.\r\n\r\n~~Practically however, I don't really see how to achieve this. For ordering chunks across clusters, we need some kind of function that maps chunks to a sorting key, with the property that it must map equal-feerate chunks within a cluster to increasing keys. The cross-cluster chunk ordering then boils down to sorting by increasing key. The PR here currently uses *(equal-feerate-chunk-prefix size, maximum txid within cluster)*, which will approximately prioritize smaller chunks (but it's a little murky when there are multiple equal-feerate chunks from the same cluster). I guess it's possible to use a key like sum of **inverses** of the sizes of all equal-feerate chunks in the same cluster, but that seems extremely ugly and only very approximate anyway.~~ EDIT: this is actually doable, see better idea [below](https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3760826877).\r\n\r\nFor ordering chunks within a cluster, or (if we ever consider a tx-granularity based block building algorithm rather than chunk-granularity) ordering transactions within a chunk, it occurs to me that we really want uniformity - get the chunk/tx boundaries density as uniform as possible, because realistically, every byte position has equal probability of ending up being a block limit, and we want to minimize the gap. This actually calls for something (pseudo)random, or maybe alternating between smallest and largest.\r\n\r\nThe only (very weak) argument in favor of smaller first that I know of, is that in a regime where mempools are reliably full, and transactions regularly get dropped/replaced, it may be better to have higher chunk/tx boundary density near the beginning, because the end has a non-negligible probability of never being mined at all, so it may pay off to deprioritize it.\r\n\r\nOverall, it is unlikely to matter I think, and having something is better than nothing. Remember that this is all just tie-breaking, which can't really guarantee any objective quality - that comes through chunking and linearizations that maximize feerates.\r\n\r\n---\r\n\r\nRe @ajtowns's comment there about grinding: I think it really boils down to me having a (perhaps irrational) dislike of using txid or any other not-objectively-relevant criterion in the sort order. It feels arbitrary, and possibly brittle if there ever is an incentive for something else equally arbitrary. It's setting a convention that at least in theory will have winners and losers, unlike feerate which is directly incentive-related, and even unlike size which at least intimately affects block building even if so in a rather chaotic way.\r\n\r\nSo I like having a size-based criterion in there first, because it reduces the impact of txid on the order to places where we're talking about equal-fee and equal-size transactions/chunks. But maybe it doesn't really matter...\r\n\r\nThoughts?",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3757899547",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257"
    },
    {
      "event": "mentioned",
      "id": 22084675696,
      "node_id": "MEE_lADOABII587ioq3GzwAAAAUkWWhw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22084675696",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-16T03:07:21Z"
    },
    {
      "event": "subscribed",
      "id": 22084675810,
      "node_id": "SE_lADOABII587ioq3GzwAAAAUkWWji",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22084675810",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-16T03:07:21Z"
    },
    {
      "event": "mentioned",
      "id": 22084675895,
      "node_id": "MEE_lADOABII587ioq3GzwAAAAUkWWk3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22084675895",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-16T03:07:21Z"
    },
    {
      "event": "subscribed",
      "id": 22084675946,
      "node_id": "SE_lADOABII587ioq3GzwAAAAUkWWlq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22084675946",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-16T03:07:21Z"
    },
    {
      "event": "commented",
      "id": 3758725269,
      "node_id": "IC_kwDOABII587gCZiV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3758725269",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-16T08:21:04Z",
      "updated_at": "2026-01-16T08:21:04Z",
      "author_association": "CONTRIBUTOR",
      "body": "I also liked having neutral or positive criteria ahead of the arbitrary one-- also making your txn smaller (at equal feerate) already increases your odds of being included because you're more likely to successfully pack, and if doing so as a tie breaker causes people to grind or whatnot to further reduce their transaction sizes then that seems good to me.  Those were the points that came to mind when I considered the alternative 'wouldn't larger be better'-- though mostly in the sense of \"prefer the transaction that pays the greater absolute fees, among transactions at the same feerate\" which amounts to a prefer larger policy.\r\n\r\nI think a prior comment of mine pointed out that you could stick other criteria in ahead of the arbitrary one--  Total bitcoin being spent? the old priority metric? net change in utxo set size?  I don't have strong opinions.   These metrics, unlike grinding are kind of naturally self limiting. one only has so much bitcoin to spend, and so on.",
      "user": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3758725269",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257"
    },
    {
      "event": "commented",
      "id": 3760826877,
      "node_id": "IC_kwDOABII587gKan9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3760826877",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-16T16:24:31Z",
      "updated_at": "2026-01-16T16:30:00Z",
      "author_association": "MEMBER",
      "body": "The following approach could be used to get an approximate big-to-small chunk ordering.\r\n\r\nRather than summing the sizes of all equal-feerate chunks in a given cluster, **up to** the one under consideration, sum all of them **starting from** the one under consideration. Then sort by that metric decreasing.\r\n\r\nIt also doesn't need consistency with intra-cluster chunk order, or intra-chunk tx order. Those could still be small-to-large, though the effect of such a suffix-size based inter-chunk order is probably larger (if it is anything at all) if it's consistent with intra-cluster order.\r\n\r\n---\r\n\r\nAdding additional criteria, after size (whether that's small first, or large first) is actually not hard with the approach used in this PR, because the fallback tiebreak after feerate and size is abstracted behind a \"fallback compare two transactions\" function provided by the mempool. Currently, that function compares txids, but it could be changed to compare other things like input amounts, input count, output count, age of inputs, ...\r\n",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3760826877",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257"
    },
    {
      "event": "commented",
      "id": 3774314568,
      "node_id": "IC_kwDOABII587g93hI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3774314568",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-20T18:20:27Z",
      "updated_at": "2026-02-03T16:21:43Z",
      "author_association": "MEMBER",
      "body": "Happy to hear comments on what to do here, but I'm not convinced anything is needed right now.\r\n\r\nAll of these things are easily and independently doable, though:\r\n* Switch from min-size to max size:\r\n  * Use max-size-first inside chunk instead of min-size-first.\r\n  * Use max-chunk-size-first for chunks within a cluster instead of min-chunk-size-first.\r\n  * Use max-equal-feerate-suffix-size-first instead of min-equal-feerate-prefix-size-first for sorting chunks across clusters.\r\n    * EDIT: maybe undesirable, it leads to the ability to \"bump\" chunks by attaching equal-feerate dependent chunks.\r\n* Add a tiebreak based on any easily-computable (or compactly-cachable) property of a mempool transaction:\r\n  * Fewer outputs first (very cheap, but unlikely to matter if sizes are already equal)\r\n  * More inputs first (very cheap, but unlike to matter if sizes are already equal)\r\n  * Lowest sigops first (very cheap, unlikely to matter in general)\r\n  * Oldest absolute locktime first (very cheap, unlikely to matter in general)\r\n  * ~~Lowest maximum spent UTXO creation height (would need caching, so adds 4-8 B memory per tx).~~\r\n    * EDIT: hard to deal with unconfirmed inputs, which would mean transaction order can change when dependencies confirm.\r\n  * Highest sum of UTXO value spent (would need caching, so adds 8 B memory per tx).\r\n  * ~~Lowest value-weighted average spent UTXO creation height (e.g. store `2^20 * sum(txin.height * txin.value) / sum(txin.value)`, which should fit in a uint64_t, adds 8 B memory per tx).~~\r\n    * EDIT: hard to deal with unconfirmed inputs, which would mean transaction order can change when dependencies confirm.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3774314568",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257"
    },
    {
      "event": "commented",
      "id": 3774431362,
      "node_id": "IC_kwDOABII587g-UCC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3774431362",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-20T18:50:02Z",
      "updated_at": "2026-01-20T18:50:02Z",
      "author_association": "MEMBER",
      "body": "> Happy to hear comments on what to do here\r\n\r\nI don't think there is anything to do here. I also didn't mean my comment to indicate a preference for a maximum-size tie-breaker. I just read the thread as considering a size-based tie-breaker would necessarily pick smaller first, and couldn't find a good answer for \"why not higher absolute fees (larger size) instead?\". From the little understanding i have of cluster mempool i don't think it matters and i don't think it's necessary to change this PR.",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3774431362",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22501820210,
      "node_id": "HRFPE_lADOABII587ioq3GzwAAAAU9Nocy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22501820210",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "9a8e6cd5fe0631cedc38c0245b2cdc7686d7f2b6",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/9a8e6cd5fe0631cedc38c0245b2cdc7686d7f2b6",
      "created_at": "2026-02-03T16:04:31Z"
    },
    {
      "event": "commented",
      "id": 3842226978,
      "node_id": "IC_kwDOABII587lA7si",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3842226978",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T16:08:48Z",
      "updated_at": "2026-02-03T16:08:48Z",
      "author_association": "MEMBER",
      "body": "Should fix IWYU (https://github.com/bitcoin/bitcoin/actions/runs/21637603999/job/62367547796?pr=34257):\r\n```diff\r\n--- a/src/primitives/transaction_identifier.h\r\n+++ b/src/primitives/transaction_identifier.h\r\n@@ -9,6 +9,7 @@\r\n #include <uint256.h>\r\n #include <util/types.h>\r\n \r\n+#include <compare>\r\n #include <cstddef>\r\n```",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3842226978",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22501972518,
      "node_id": "HRFPE_lADOABII587ioq3GzwAAAAU9ONom",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22501972518",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "8db16f3ce9dff079c404a5ecb026bce62d33fab7",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/8db16f3ce9dff079c404a5ecb026bce62d33fab7",
      "created_at": "2026-02-03T16:10:04Z"
    },
    {
      "event": "labeled",
      "id": 22502033073,
      "node_id": "LE_lADOABII587ioq3GzwAAAAU9Ocax",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22502033073",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T16:12:14Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3842247797,
      "node_id": "IC_kwDOABII587lBAx1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3842247797",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T16:12:37Z",
      "updated_at": "2026-02-03T16:12:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Task `iwyu`: https://github.com/bitcoin/bitcoin/actions/runs/21637603999/job/62367547796</sub>\n<sub>LLM reason (âœ¨ experimental): IWYU flagged and fixed an include problem in transaction_identifier.h, causing the CI test script to fail.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3842247797",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257"
    },
    {
      "event": "commented",
      "id": 3842253111,
      "node_id": "IC_kwDOABII587lBCE3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3842253111",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T16:13:35Z",
      "updated_at": "2026-02-03T16:13:35Z",
      "author_association": "MEMBER",
      "body": "I considered switching from smallest-equal-feerate-prefix to largest-equal-feerate-suffix, but realized it would mean someone can bump a chunk by attaching an equal-feerate dependent chunk. Not harmful, but it feels unintuitive and strange.\r\n\r\nI also considered adding a value-weighted average input height as tie-break before txid, but realized it's annoying to deal with transactions with unconfirmed inputs, and the fact that their order might change when their dependencies confirm.\r\n\r\nSo, no changes. The above push is just some comment improvements.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3842253111",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22503057506,
      "node_id": "HRFPE_lADOABII587ioq3GzwAAAAU9SWhi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22503057506",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "1926c14682ceced0b0eb9cc54728d6b8cfe9789f",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/1926c14682ceced0b0eb9cc54728d6b8cfe9789f",
      "created_at": "2026-02-03T16:49:45Z"
    },
    {
      "event": "unlabeled",
      "id": 22505382948,
      "node_id": "UNLE_lADOABII587ioq3GzwAAAAU9bOQk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22505382948",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T18:18:58Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22506162833,
      "node_id": "HRFPE_lADOABII587ioq3GzwAAAAU9eMqR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22506162833",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "5084095e5a3c46a371c75118feaf60942021b22d",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/5084095e5a3c46a371c75118feaf60942021b22d",
      "created_at": "2026-02-03T18:51:04Z"
    },
    {
      "event": "milestoned",
      "id": 22563386552,
      "node_id": "MIE_lADOABII587ioq3GzwAAAAVA4fS4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22563386552",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T16:04:41Z",
      "milestone": {
        "title": "31.0"
      }
    },
    {
      "event": "commented",
      "id": 3854945004,
      "node_id": "IC_kwDOABII587lxcrs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3854945004",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T17:00:50Z",
      "updated_at": "2026-02-05T17:00:50Z",
      "author_association": "MEMBER",
      "body": "> The order of chunks within a cluster is tie-broken using:\r\n\r\n> Chunk feerate (high to low)\r\n\r\nfor here and the inter-cluster context, what does this mean? if a chunk is higher feerate, it'll necessary already be considered better and not need tiebreaking?",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3854945004",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257"
    },
    {
      "event": "commented",
      "id": 3855398409,
      "node_id": "IC_kwDOABII587lzLYJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3855398409",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T18:22:35Z",
      "updated_at": "2026-02-05T18:22:35Z",
      "author_association": "MEMBER",
      "body": "> for here and the inter-cluster context, what does this mean? if a chunk is higher feerate, it'll necessary already be considered better and not need tiebreaking?\r\n\r\nYeah, it doesn't mean anything; it's arguably not a tie-breaking rule, but inherent to what chunks are. I just added here for completeness, because chunk feerate is the primary thing to sort by (obviously, or not).",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3855398409",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34257"
    },
    {
      "event": "reviewed",
      "id": 3770550800,
      "node_id": "PRR_kwDOABII587gvgoQ",
      "url": null,
      "actor": null,
      "commit_id": "5084095e5a3c46a371c75118feaf60942021b22d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-08T22:45:13Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#pullrequestreview-3770550800",
      "submitted_at": "2026-02-08T22:45:13Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDdhZDI2ZGZmYzU2MzVmMTIyY2MwMDA2NjdlNmRkOGNjOGMxNGZjMjI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7ad26dffc5635f122cc000667e6dd8cc8c14fc22",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7ad26dffc5635f122cc000667e6dd8cc8c14fc22",
      "tree": {
        "sha": "6bee620cfb93de76833810a6a1c10f7ad73c4fd0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6bee620cfb93de76833810a6a1c10f7ad73c4fd0"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6d625af2831b7c36d59f245a65df3f70f2110f69",
          "sha": "6d625af2831b7c36d59f245a65df3f70f2110f69",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6d625af2831b7c36d59f245a65df3f70f2110f69"
        }
      ],
      "message": "txgraph: initialize Ref in AddTransaction (preparation)\n\nInstead of returning a TxGraph::Ref from TxGraph::AddTransaction(),\npass in a TxGraph::Ref& which is updated to refer to the new transaction\nin that graph.\n\nThis cleans up the usage somewhat, avoiding the need for dummy Refs in\nCTxMemPoolEntry constructor calls, but the motivation is that a future\ncommit will allow a callback to passed to MakeTxGraph to define a\nfallback order on the transaction objects. This does not when a Ref is\ncreated separately from the CTxMemPoolEntry it ends up living in, as\npassing the newly-created Ref to the callback would be UB before it's\nemplaced in its final CTxMemPoolEntry.",
      "committer": {
        "name": "Pieter Wuille",
        "email": "bitcoin-dev@wuille.net",
        "date": "2026-02-08T22:53:20Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2026-01-10T18:03:36Z"
      },
      "sha": "7ad26dffc5635f122cc000667e6dd8cc8c14fc22"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGExNzM1MDA4NTA2OTcxZjY0NTc5OGZjNTM4NWQyNWY4OGNlNjQ2NDA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a1735008506971f645798fc5385d25f88ce64640",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a1735008506971f645798fc5385d25f88ce64640",
      "tree": {
        "sha": "62e914ef59723d425d9c9963b7706916197480e5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/62e914ef59723d425d9c9963b7706916197480e5"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7ad26dffc5635f122cc000667e6dd8cc8c14fc22",
          "sha": "7ad26dffc5635f122cc000667e6dd8cc8c14fc22",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7ad26dffc5635f122cc000667e6dd8cc8c14fc22"
        }
      ],
      "message": "txgraph: update chunk index on Compact (preparation)\n\nThis makes TxGraphImpl::Compact() invoke Cluster::Updated() on all\naffected clusters, in case they have internal GraphIndex values stored\nthat may have become outdated with the renumbering of GraphIndex values\nthat Compact() caused.\n\nThis is necessary as preparation for a future commit in which chunk data\nwill gain a reference to the maximal-fallback transaction within the\nchunk.",
      "committer": {
        "name": "Pieter Wuille",
        "email": "bitcoin-dev@wuille.net",
        "date": "2026-02-08T22:53:20Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2026-01-10T23:07:30Z"
      },
      "sha": "a1735008506971f645798fc5385d25f88ce64640"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGRlYzk5MzRmOTI0YTYxNDExNTU4YWYwMzQxZjUwYTA0OTA3ZmU3Zjk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dec9934f924a61411558af0341f50a04907fe7f9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/dec9934f924a61411558af0341f50a04907fe7f9",
      "tree": {
        "sha": "3409de494f6c4fe53dc1bfc41b263b39abfa3600",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3409de494f6c4fe53dc1bfc41b263b39abfa3600"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a1735008506971f645798fc5385d25f88ce64640",
          "sha": "a1735008506971f645798fc5385d25f88ce64640",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a1735008506971f645798fc5385d25f88ce64640"
        }
      ],
      "message": "txgraph: clear cluster's chunk index in ~Ref (preparation)\n\nWhenever a TxGraph::Ref is destroyed, if it by then still appears inside\nmain-level clusters, wipe the chunk index entries for those clusters, to\nprevent having lingering indexes for transactions without Ref.\n\nThis is preparation for enabling a callback being passed to MakeTxGraph\nto define a fallback order on objects. Once the Ref for a transaction is\ngone, it is not possible to invoke the callback anymore. To prevent the\nindex becoming inconsistent, we need to immediately get rid of the index\nentries when the Ref disappears.\n\nThis is not a problem, because such destructions necessarily will\ntrigger a relinearization of the cluster (assuming there are\ntransactions in it left) before becoming acceptable again, and the chunk\nordering is not observable (through CompareMainOrder, or through the\nBlockBuilder interface) until that point. However, the index itself\nneeds to remain consistent in the mean time, even if not meaningful.",
      "committer": {
        "name": "Pieter Wuille",
        "email": "bitcoin-dev@wuille.net",
        "date": "2026-02-08T22:53:20Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2026-01-10T23:42:50Z"
      },
      "sha": "dec9934f924a61411558af0341f50a04907fe7f9"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc2MDExOTZjMmJlNjgxNDFkYmQzYmNlNWFiZWE1NzE2YzA2YWUxZTI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7601196c2be68141dbd3bce5abea5716c06ae1e2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7601196c2be68141dbd3bce5abea5716c06ae1e2",
      "tree": {
        "sha": "83d5a4e7c9156487eae0c782745112d44f57dcd8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/83d5a4e7c9156487eae0c782745112d44f57dcd8"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dec9934f924a61411558af0341f50a04907fe7f9",
          "sha": "dec9934f924a61411558af0341f50a04907fe7f9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/dec9934f924a61411558af0341f50a04907fe7f9"
        }
      ],
      "message": "clusterlin: sort tx in chunk by feerate and size (feature)\n\nThis changes the order of transactions within a chunk to be:\n1. Topology (parents before children)\n2. Individual transaction feerate (high to low)\n3. Individual transaction weight (small to large)\n4. Random tiebreak (will be changed in a future commit)\n\nTo do so, use a heap of topology-ready transactions within\nGetLinearization(), sorted by (2), (3), and (4).\n\nThis is analogous to the order of chunks within a cluster, which is\nunchanged:\n1. Topology (chunks before chunks they depend on)\n2. Chunk feerate (high to low)\n3. Chunk weight (small to large)\n4. Random tiebreak (will be changed in a future commit)",
      "committer": {
        "name": "Pieter Wuille",
        "email": "bitcoin-dev@wuille.net",
        "date": "2026-02-08T22:53:20Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2026-01-07T15:36:03Z"
      },
      "sha": "7601196c2be68141dbd3bce5abea5716c06ae1e2"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNhMGFlOTMwNWUxZGYwZDIxMDY3YTVlNTBiZDVjZjYxM2VjNDRjZWY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ca0ae9305e1df0d21067a5e50bd5cf613ec44cef",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ca0ae9305e1df0d21067a5e50bd5cf613ec44cef",
      "tree": {
        "sha": "ee0839ee508ed9de0ce2ee12a5adf9887c5db5db",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ee0839ee508ed9de0ce2ee12a5adf9887c5db5db"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7601196c2be68141dbd3bce5abea5716c06ae1e2",
          "sha": "7601196c2be68141dbd3bce5abea5716c06ae1e2",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7601196c2be68141dbd3bce5abea5716c06ae1e2"
        }
      ],
      "message": "txgraph: sort chunks by equal-feerate-prefix size (feature)\n\nThis makes TxGraph track the equal-feerate-prefix size of all chunks in\nall clusters in the main graph, and uses it to sort chunks coming from\ndistinct clusters.\n\nThe order of chunks across clusters becomes:\n1. Feerate (high to low)\n2. Equal-feerate-chunk-prefix (small to large)\n3. Cluster sequence number (old to new); this will be changed later.\n\nThe equal-feerate-chunk-prefix size of a chunk C is defined as the sum\nof the weights of all chunks in the same cluster as C, with the same\nfeerate as C, up to and including C itself, in linearization order (but\nexcluding such chunks that appear after C).\n\nThis is an approximation of sorting chunks from small to large across\nclusters, while remaining consistent with intra-cluster linearization\norder.",
      "committer": {
        "name": "Pieter Wuille",
        "email": "bitcoin-dev@wuille.net",
        "date": "2026-02-08T22:53:20Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2026-01-07T15:59:24Z"
      },
      "sha": "ca0ae9305e1df0d21067a5e50bd5cf613ec44cef"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGYzYjI0YTZkNDZlMzY4ZmM1YTdhMGUwMTA1MzM2MTNlZWZlZGYyZGE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f3b24a6d46e368fc5a7a0e010533613eefedf2da",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f3b24a6d46e368fc5a7a0e010533613eefedf2da",
      "tree": {
        "sha": "38295e65b8687a556df739aae558281fffcbfcf2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/38295e65b8687a556df739aae558281fffcbfcf2"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ca0ae9305e1df0d21067a5e50bd5cf613ec44cef",
          "sha": "ca0ae9305e1df0d21067a5e50bd5cf613ec44cef",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ca0ae9305e1df0d21067a5e50bd5cf613ec44cef"
        }
      ],
      "message": "clusterlin: make optimal linearizations deterministic (feature)\n\nThis allows passing in a fallback order comparator to Linearize(), which\nis used as final tiebreak when deciding the order of chunks and\ntransactions within a chunk, rather than a random tiebreak.\n\nThe order of transactions within a chunk becomes:\n1. Topology (parents before children)\n2. Individual transaction feerate (high to low)\n3. Weight (small to large)\n4. Fallback (low to high fallback order)\n\nThe order of chunks within a cluster becomes:\n1. Topology (chunks after their dependencies)\n2. Feerate (high to low)\n3. Weight (small to large)\n4. Max-fallback (chunk with lowest maximum-fallback-tx first)\n\nFor now, txgraph passes a naive comparator to Linearize(), which makes\nthe cluster order deterministic when treating the input transactions as\nidentified by the DepGraphIndex. However, since DepGraphIndexes are the\nresult of possibly-randomized operations inside txgraph, this doesn't\nactually make txgraph's per-cluster ordering deterministic. That will be\nchanged in a later commit, by using a txid-based fallback instead.",
      "committer": {
        "name": "Pieter Wuille",
        "email": "bitcoin-dev@wuille.net",
        "date": "2026-02-08T22:53:20Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2026-01-07T20:02:02Z"
      },
      "sha": "f3b24a6d46e368fc5a7a0e010533613eefedf2da"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDNkZjY5Y2QyYzMzNGRmMDA3ZjBjNzZmYzg2MWIwY2JmZTUyMWQxNWU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3df69cd2c334df007f0c76fc861b0cbfe521d15e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/3df69cd2c334df007f0c76fc861b0cbfe521d15e",
      "tree": {
        "sha": "cdbb17c426295674e0617a73cde7ce91d3e2e178",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cdbb17c426295674e0617a73cde7ce91d3e2e178"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f3b24a6d46e368fc5a7a0e010533613eefedf2da",
          "sha": "f3b24a6d46e368fc5a7a0e010533613eefedf2da",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f3b24a6d46e368fc5a7a0e010533613eefedf2da"
        }
      ],
      "message": "txgraph test: subclass TxGraph::Ref like mempool does (preparation)\n\nThis is a small change to the txgraph fuzz test to make it used objects\nderived from TxGraph::Ref (SimTxObject) rather than TxGraph::Ref\ndirectly. This matches how the mempool uses CTxMemPoolEntry, which\nderives from TxGraph::Ref.\n\nThis is preparation for a future commit which will introduce simulated\ntxids to the transactions in this fuzz test, to be used as falllback\norder.",
      "committer": {
        "name": "Pieter Wuille",
        "email": "bitcoin-dev@wuille.net",
        "date": "2026-02-08T22:53:20Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2026-01-07T22:17:16Z"
      },
      "sha": "3df69cd2c334df007f0c76fc861b0cbfe521d15e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDAwZTUwZjc3MjdiMDI2MDk0OWZkNjlhMzBmN2JhNzY5Yjg3MGQ4YmI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/00e50f7727b0260949fd69a30f7ba769b870d8bb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/00e50f7727b0260949fd69a30f7ba769b870d8bb",
      "tree": {
        "sha": "53bf5743888c04f1048435eb501192bbf849da3a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/53bf5743888c04f1048435eb501192bbf849da3a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3df69cd2c334df007f0c76fc861b0cbfe521d15e",
          "sha": "3df69cd2c334df007f0c76fc861b0cbfe521d15e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/3df69cd2c334df007f0c76fc861b0cbfe521d15e"
        }
      ],
      "message": "txgraph: pass fallback_order to TxGraph (preparation)\n\nThis adds an std::function<strong_ordering(Ref&,Ref&)> argument to the\nMakeTxGraph function, which can be used by the caller (e.g., mempool\ncode) to provide a fallback order to TxGraph.\n\nThis is just preparation; TxGraph does not yet use this fallback order\nfor anything.",
      "committer": {
        "name": "Pieter Wuille",
        "email": "bitcoin-dev@wuille.net",
        "date": "2026-02-08T22:53:20Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2026-01-08T20:17:28Z"
      },
      "sha": "00e50f7727b0260949fd69a30f7ba769b870d8bb"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDUzNmYwYzliMTNjMTAxMjgzYTQxMzdlZTgwNWUyZDMyMWExNjIxMGY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/536f0c9b13c101283a4137ee805e2d321a16210f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/536f0c9b13c101283a4137ee805e2d321a16210f",
      "tree": {
        "sha": "36e868ce4ea6ec09647c297368a8e7233433a692",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/36e868ce4ea6ec09647c297368a8e7233433a692"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/00e50f7727b0260949fd69a30f7ba769b870d8bb",
          "sha": "00e50f7727b0260949fd69a30f7ba769b870d8bb",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/00e50f7727b0260949fd69a30f7ba769b870d8bb"
        }
      ],
      "message": "txgraph: use fallback order when linearizing (feature)\n\nAdd glue to make TxGraph use the fallback order provided to it, in the\nfallback comparator it provides to the cluster linearization code.\n\nThe order of chunks within a cluster becomes:\n1. Topology (chunks after their dependencies)\n2. Feerate (high to low)\n3. Weight (small to large)\n4. Max-txid (chunk with lowest maximum-txid first)\n\nThe order of transactions within a chunk becomes:\n1. Topology (parents before children)\n2. Individual transaction feerate (high to low)\n3. Weight (small to large)\n4. Txid (low to high txid)\n\nThis makes optimal cluster linearization, both the order of chunks\nwithin a chunk, and the order of transactions within those chunks,\ncompletely deterministic.",
      "committer": {
        "name": "Pieter Wuille",
        "email": "bitcoin-dev@wuille.net",
        "date": "2026-02-08T22:53:20Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2026-01-11T04:28:00Z"
      },
      "sha": "536f0c9b13c101283a4137ee805e2d321a16210f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDI2YjcxYjNiMzBmMWZjMGNhNTRkYmI1MjliYjc4N2IwOTRiNGUzMjI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "tree": {
        "sha": "430088a849a8e318ee0b2245baade1daf0bc4e3d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/430088a849a8e318ee0b2245baade1daf0bc4e3d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/536f0c9b13c101283a4137ee805e2d321a16210f",
          "sha": "536f0c9b13c101283a4137ee805e2d321a16210f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/536f0c9b13c101283a4137ee805e2d321a16210f"
        }
      ],
      "message": "txgraph: use fallback order to sort chunks (feature)\n\nThis makes TxGraph also use the fallback order to decide the order of\nchunks from distinct clusters.\n\nThe order of chunks across clusters becomes:\n1. Feerate (high to low)\n2. Equal-feerate-chunk-prefix (small to large)\n3. Max-txid (chunk with lowest maximum-txid first)\n\nThis makes the full TxGraph ordering fully deterministic as long as all\nclusters in it are optimally linearized.",
      "committer": {
        "name": "Pieter Wuille",
        "email": "bitcoin-dev@wuille.net",
        "date": "2026-02-08T23:06:46Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2026-01-11T04:28:14Z"
      },
      "sha": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22628646721,
      "node_id": "HRFPE_lADOABII587ioq3GzwAAAAVExb9B",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22628646721",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "created_at": "2026-02-08T23:06:58Z"
    },
    {
      "event": "reviewed",
      "id": 3763603098,
      "node_id": "PRR_kwDOABII587gVAaa",
      "url": null,
      "actor": null,
      "commit_id": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-09T18:57:21Z",
      "author_association": "MEMBER",
      "body": "concept ACK 26b71b3b30f1fc0ca54dbb529bb787b094b4e322\n\ncode seems to make sense and behavior matches expectations\n\nIIUC you could have a weird \"reverse CPFP\" where by someone extends the same-feerate prefix in a cluster to \"downgrade it\" compared to another same-feerate prefix target in another cluster (that had a worse txid?). I don't see any meaningful games, I think the set of metrics is fine.\n\nwill do a final pass soon",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#pullrequestreview-3763603098",
      "submitted_at": "2026-02-09T18:57:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
    },
    {
      "event": "reviewed",
      "id": 3770859417,
      "node_id": "PRR_kwDOABII587gwr-Z",
      "url": null,
      "actor": null,
      "commit_id": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-09T19:05:34Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK 26b71b3b30f1fc0ca54dbb529bb787b094b4e322\n\nJust nits/questions/suggestions. Overall, I concur with https://github.com/bitcoin/bitcoin/pull/34257#issuecomment-3774431362 -- the ordering rationale seems sound to me.",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#pullrequestreview-3770859417",
      "submitted_at": "2026-02-09T19:05:34Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
    },
    {
      "event": "review_requested",
      "id": 22652396521,
      "node_id": "RRE_lADOABII587ioq3GzwAAAAVGMCPp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22652396521",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-09T19:29:21Z",
      "requested_reviewer": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2774592190",
      "pull_request_review_id": 3763603098,
      "id": 2774592190,
      "node_id": "PRRC_kwDOABII586lYOq-",
      "diff_hunk": "@@ -182,8 +182,11 @@ class Cluster\n     virtual int GetLevel(const TxGraphImpl& graph) const noexcept = 0;\n     /** Only called by TxGraphImpl::SwapIndexes. */\n     virtual void UpdateMapping(DepGraphIndex cluster_idx, GraphIndex graph_idx) noexcept = 0;",
      "path": "src/txgraph.cpp",
      "position": 3,
      "original_position": 3,
      "commit_id": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "original_commit_id": "0ac92f06e774be9c1c506e802baa1e3d57017ca8",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "0ac92f06e774be9c1c506e802baa1e3d57017ca8\n\ncommit message referencing a yet-undefined \"maximal-fallback\" isn't very helpful for understanding",
      "created_at": "2026-02-06T15:00:25Z",
      "updated_at": "2026-02-09T18:57:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2774592190",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2774592190"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 184,
      "original_line": 184,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2774652335",
      "pull_request_review_id": 3763603098,
      "id": 2774652335,
      "node_id": "PRRC_kwDOABII586lYdWv",
      "diff_hunk": "@@ -1007,22 +1011,22 @@ void TxGraphImpl::ClearLocator(int level, GraphIndex idx, bool oversized_tx) noe\n     if (level == 0) ClearChunkData(entry);\n }\n \n-void GenericClusterImpl::Updated(TxGraphImpl& graph, int level) noexcept\n+void GenericClusterImpl::Updated(TxGraphImpl& graph, int level, bool rename) noexcept\n {\n     // Update all the Locators for this Cluster's Entry objects.\n     for (DepGraphIndex idx : m_linearization) {\n         auto& entry = graph.m_entries[m_mapping[idx]];\n         // Discard any potential ChunkData prior to modifying the Cluster (as that could\n         // invalidate its ordering).\n-        if (level == 0) graph.ClearChunkData(entry);\n+        if (level == 0 && !rename) graph.ClearChunkData(entry);\n         entry.m_locator[level].SetPresent(this, idx);\n     }\n     // If this is for the main graph (level = 0), and the Cluster's quality is ACCEPTABLE or\n     // OPTIMAL, compute its chunking and store its information in the Entry's m_main_lin_index\n     // and m_main_chunk_feerate. These fields are only accessed after making the entire graph\n     // ACCEPTABLE, so it is pointless to compute these if we haven't reached that quality level\n     // yet.\n-    if (level == 0 && IsAcceptable()) {\n+    if (level == 0 && (rename || IsAcceptable())) {",
      "path": "src/txgraph.cpp",
      "position": 201,
      "original_position": 66,
      "commit_id": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "original_commit_id": "0ac92f06e774be9c1c506e802baa1e3d57017ca8",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "0ac92f06e774be9c1c506e802baa1e3d57017ca8\r\n\r\ncomment above is now out of date? ",
      "created_at": "2026-02-06T15:14:23Z",
      "updated_at": "2026-02-09T18:57:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2774652335",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2774652335"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1087,
      "original_line": 1087,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2774801850",
      "pull_request_review_id": 3763603098,
      "id": 2774801850,
      "node_id": "PRRC_kwDOABII586lZB26",
      "diff_hunk": "@@ -2774,14 +2798,16 @@ void GenericClusterImpl::SanityCheck(const TxGraphImpl& graph, int level) const\n             assert(entry.m_main_chunk_feerate == linchunking[chunk_num].feerate);\n             // Verify that an entry in the chunk index exists for every chunk-ending transaction.\n             ++chunk_pos;\n-            bool is_chunk_end = (chunk_pos == linchunking[chunk_num].transactions.Count());\n-            assert((entry.m_main_chunkindex_iterator != graph.m_main_chunkindex.end()) == is_chunk_end);\n-            if (is_chunk_end) {\n-                auto& chunk_data = *entry.m_main_chunkindex_iterator;\n-                if (m_done == m_depgraph.Positions() && chunk_pos == 1) {\n-                    assert(chunk_data.m_chunk_count == LinearizationIndex(-1));\n-                } else {\n-                    assert(chunk_data.m_chunk_count == chunk_pos);\n+            if (graph.m_main_clusterset.m_to_remove.empty()) {",
      "path": "src/txgraph.cpp",
      "position": 538,
      "original_position": 71,
      "commit_id": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "original_commit_id": "fa86fb6ed2c5f9a551e83bb7562c73dade6e551e",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "fa86fb6ed2c5f9a551e83bb7562c73dade6e551e\n\nIIUC now chunk data can be wiped but the actual transactions haven't been removed from the graph, so now we have to wrap these checks to make sure removals have been applied.",
      "created_at": "2026-02-06T15:49:51Z",
      "updated_at": "2026-02-09T18:57:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2774801850",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2774801850"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2876,
      "original_line": 2876,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2774902803",
      "pull_request_review_id": 3763603098,
      "id": 2774902803,
      "node_id": "PRRC_kwDOABII586lZagT",
      "diff_hunk": "@@ -1082,6 +1082,53 @@ FUZZ_TARGET(clusterlin_linearize)\n         auto read_chunking = ChunkLinearization(depgraph, read);\n         auto cmp_read = CompareChunks(chunking, read_chunking);\n         assert(cmp_read >= 0);\n+\n+        // Verify that within every chunk, the transactions are in a valid order. For any pair of\n+        // transactions, it should not be possible to swap them; either due to a missing\n+        // dependency, or because the order would be inconsistent with decreasing feerate and\n+        // increasing size.\n+        auto chunking_info = ChunkLinearizationInfo(depgraph, linearization);\n+        TestBitSet done;\n+        unsigned pos{0};\n+        for (const auto& chunk : chunking_info) {\n+            auto chunk_start = pos;\n+            auto chunk_end = pos + chunk.transactions.Count() - 1;\n+            // Go over all pairs of transactions. done is the set of transactions seen before pos1.\n+            for (unsigned pos1 = chunk_start; pos1 <= chunk_end; ++pos1) {\n+                auto tx1 = linearization[pos1];\n+                for (unsigned pos2 = pos1 + 1; pos2 <= chunk_end; ++pos2) {\n+                    auto tx2 = linearization[pos2];\n+                    if ((depgraph.Ancestors(tx2) - done).Count() == 1) {",
      "path": "src/test/fuzz/cluster_linearize.cpp",
      "position": 38,
      "original_position": 20,
      "commit_id": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "original_commit_id": "a31777c11c0cbb452d501f314190151c3ba2ad95",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "a31777c11c0cbb452d501f314190151c3ba2ad95\r\n\r\nnote: `done` at this point does not include pos1, so it's a check essentially it doesn't depend on tx1. I found the accumulation loop a little subtle.",
      "created_at": "2026-02-06T16:13:18Z",
      "updated_at": "2026-02-09T18:57:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2774902803",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2774902803"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1101,
      "original_line": 1101,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2775101187",
      "pull_request_review_id": 3763603098,
      "id": 2775101187,
      "node_id": "PRRC_kwDOABII586laK8D",
      "diff_hunk": "@@ -497,6 +497,12 @@ class TxGraphImpl final : public TxGraph\n         auto feerate_cmp = FeeRateCompare(entry_b.m_main_chunk_feerate, entry_a.m_main_chunk_feerate);\n         if (feerate_cmp < 0) return std::strong_ordering::less;\n         if (feerate_cmp > 0) return std::strong_ordering::greater;\n+        // Compare equal-feerate chunk prefix size for comparing equal chunk feerates. This does two\n+        // things: it catches equal-feerate chunks within the same cluster (because later ones will\n+        // always have a higher prefix size), and it may catch equal-feerate chunks across clusters.\n+        if (entry_a.m_main_equal_feerate_chunk_prefix_size != entry_b.m_main_equal_feerate_chunk_prefix_size) {",
      "path": "src/txgraph.cpp",
      "position": 61,
      "original_position": 7,
      "commit_id": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "original_commit_id": "fb6f3026edddd07e868ed52fe3fe4d77c9d40d1b",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "fb6f3026edddd07e868ed52fe3fe4d77c9d40d1b\r\n\r\nnote to self: The final tie-breaker in this function is still useful for intra-chunk calls, such as CompareMainOrder\r\n\r\nupdate: this was made clear in the final commit of the PR",
      "created_at": "2026-02-06T16:55:02Z",
      "updated_at": "2026-02-09T18:57:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2775101187",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2775101187"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 506,
      "original_line": 506,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2779990879",
      "pull_request_review_id": 3770550800,
      "id": 2779990879,
      "node_id": "PRRC_kwDOABII586ls0tf",
      "diff_hunk": "@@ -1066,10 +1094,116 @@ FUZZ_TARGET(txgraph)\n         // that calling Linearize on it does not improve it further.\n         if (sims[0].real_is_optimal) {\n             auto real_diagram = ChunkLinearization(sims[0].graph, vec1);\n-            auto [sim_lin, _optimal, _cost] = Linearize(sims[0].graph, 300000, rng.rand64(), vec1);\n+            auto fallback_order_sim = [&](DepGraphIndex a, DepGraphIndex b) noexcept {\n+                auto txid_a = sims[0].GetRef(a)->m_txid;\n+                auto txid_b = sims[0].GetRef(b)->m_txid;\n+                return txid_a <=> txid_b;\n+            };\n+            auto [sim_lin, sim_optimal, _cost] = Linearize(sims[0].graph, 300000, rng.rand64(), fallback_order_sim, vec1);\n+            PostLinearize(sims[0].graph, sim_lin);\n             auto sim_diagram = ChunkLinearization(sims[0].graph, sim_lin);\n             auto cmp = CompareChunks(real_diagram, sim_diagram);\n             assert(cmp == 0);\n+\n+            // Verify consistency of cross-cluster chunk ordering with tie-break (equal-feerate\n+            // prefix size).\n+            auto real_chunking = ChunkLinearizationInfo(sims[0].graph, vec1);\n+            /** Map with one entry per component of the sim main graph. Key is the first Pos of the\n+             *  component. Value is the sum of all chunk sizes from that component seen\n+             *  already, at the current chunk feerate. */\n+            std::map<SimTxGraph::Pos, int32_t> comp_prefix_sizes;\n+            /** Current chunk feerate. */\n+            FeeFrac last_chunk_feerate;\n+            /** Largest seen (equal-feerate chunk prefix size, max txid).  */\n+            std::pair<int32_t, uint64_t> max_chunk_tiebreak{0, 0};\n+            for (const auto& chunk : real_chunking) {\n+                // If this is the first chunk with a strictly lower feerate, reset.\n+                if (chunk.feerate << last_chunk_feerate) {\n+                    comp_prefix_sizes.clear();\n+                    max_chunk_tiebreak = {0, 0};\n+                }\n+                last_chunk_feerate = chunk.feerate;\n+                // Find which sim component this chunk belongs to.\n+                auto component = sims[0].graph.GetConnectedComponent(sims[0].graph.Positions(), chunk.transactions.First());\n+                assert(chunk.transactions.IsSubsetOf(component));\n+                auto comp_key = component.First();\n+                auto& comp_prefix_size = comp_prefix_sizes[comp_key];\n+                comp_prefix_size += chunk.feerate.size;\n+                // Determine the chunk's max txid.\n+                uint64_t chunk_max_txid{0};\n+                for (auto tx : chunk.transactions) {\n+                    auto txid = sims[0].GetRef(tx)->m_txid;\n+                    chunk_max_txid = std::max(txid, chunk_max_txid);\n+                }\n+                // Verify consistency: within each group of equal-feerate chunks, the\n+                // (equal-feerate chunk prefix size, max txid) must be increasing.\n+                std::pair<int32_t, uint64_t> chunk_tiebreak{comp_prefix_size, chunk_max_txid};\n+                assert(chunk_tiebreak > max_chunk_tiebreak);\n+                max_chunk_tiebreak = chunk_tiebreak;\n+            }\n+\n+            // Verify that within each cluster, the internal ordering matches that of the\n+            // simulation if that is optimal too, since per-cluster optimal orderings are\n+            // deterministic.\n+            if (sim_optimal) {\n+                for (const auto& component : sims[0].GetComponents()) {\n+                    std::vector<DepGraphIndex> sim_chunk_lin;\n+                    for (auto i : sim_lin) {\n+                        if (component[i]) sim_chunk_lin.push_back(i);\n+                    }\n+                    std::vector<DepGraphIndex> real_chunk_lin;\n+                    for (auto i : vec1) {\n+                        if (component[i]) real_chunk_lin.push_back(i);\n+                    }\n+                    assert(sim_chunk_lin == real_chunk_lin);\n+                }\n+            }\n+\n+            // Verify that a fresh TxGraph, with the same transactions and txids, but constructed\n+            // in a different order, and with a different RNG state, recreates the exact same\n+            // ordering, showing that for optimal graphs, the full mempool ordering is\n+            // deterministic.\n+            auto real_redo = MakeTxGraph(\n+                /*max_cluster_count=*/max_cluster_count,\n+                /*max_cluster_size=*/max_cluster_size,\n+                /*acceptable_iters=*/acceptable_iters,\n+                /*fallback_order=*/fallback_order);\n+            /** Vector (indexed by SimTxGraph::Pos) of TxObjects in real_redo). */\n+            std::vector<std::optional<SimTxObject>> txobjects_redo;\n+            txobjects_redo.resize(sims[0].graph.PositionRange());\n+            // Recreate the graph's transactions with same feerate and txid.\n+            std::vector<DepGraphIndex> positions;\n+            for (auto i : sims[0].graph.Positions()) positions.push_back(i);\n+            std::shuffle(positions.begin(), positions.end(), rng);\n+            for (auto i : positions) {\n+                txobjects_redo[i].emplace(sims[0].GetRef(i)->m_txid);\n+                real_redo->AddTransaction(*txobjects_redo[i], FeePerWeight::FromFeeFrac(sims[0].graph.FeeRate(i)));\n+            }\n+            // Recreate the graph's dependencies.\n+            std::vector<std::pair<DepGraphIndex, DepGraphIndex>> deps;\n+            for (auto i : sims[0].graph.Positions()) {\n+                for (auto j : sims[0].graph.GetReducedParents(i)) {\n+                    deps.emplace_back(j, i);\n+                }\n+            }\n+            std::shuffle(deps.begin(), deps.end(), rng);\n+            for (auto [parent, child] : deps) {\n+                real_redo->AddDependency(*txobjects_redo[parent], *txobjects_redo[child]);\n+            }\n+            // Do work to reach optimality.\n+            if (!real_redo->DoWork(300000)) {",
      "path": "src/test/fuzz/txgraph.cpp",
      "position": 1,
      "original_position": 234,
      "commit_id": "5084095e5a3c46a371c75118feaf60942021b22d",
      "original_commit_id": "5084095e5a3c46a371c75118feaf60942021b22d",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This test is inverted (and the code within the if isn't actually executed for any of the fuzz corpus examples in qa-assets).",
      "created_at": "2026-02-08T22:45:13Z",
      "updated_at": "2026-02-08T22:45:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2779990879",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2779990879"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1194,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780018812",
      "pull_request_review_id": 3770579543,
      "id": 2780018812,
      "node_id": "PRRC_kwDOABII586ls7h8",
      "diff_hunk": "@@ -1066,10 +1094,116 @@ FUZZ_TARGET(txgraph)\n         // that calling Linearize on it does not improve it further.\n         if (sims[0].real_is_optimal) {\n             auto real_diagram = ChunkLinearization(sims[0].graph, vec1);\n-            auto [sim_lin, _optimal, _cost] = Linearize(sims[0].graph, 300000, rng.rand64(), vec1);\n+            auto fallback_order_sim = [&](DepGraphIndex a, DepGraphIndex b) noexcept {\n+                auto txid_a = sims[0].GetRef(a)->m_txid;\n+                auto txid_b = sims[0].GetRef(b)->m_txid;\n+                return txid_a <=> txid_b;\n+            };\n+            auto [sim_lin, sim_optimal, _cost] = Linearize(sims[0].graph, 300000, rng.rand64(), fallback_order_sim, vec1);\n+            PostLinearize(sims[0].graph, sim_lin);\n             auto sim_diagram = ChunkLinearization(sims[0].graph, sim_lin);\n             auto cmp = CompareChunks(real_diagram, sim_diagram);\n             assert(cmp == 0);\n+\n+            // Verify consistency of cross-cluster chunk ordering with tie-break (equal-feerate\n+            // prefix size).\n+            auto real_chunking = ChunkLinearizationInfo(sims[0].graph, vec1);\n+            /** Map with one entry per component of the sim main graph. Key is the first Pos of the\n+             *  component. Value is the sum of all chunk sizes from that component seen\n+             *  already, at the current chunk feerate. */\n+            std::map<SimTxGraph::Pos, int32_t> comp_prefix_sizes;\n+            /** Current chunk feerate. */\n+            FeeFrac last_chunk_feerate;\n+            /** Largest seen (equal-feerate chunk prefix size, max txid).  */\n+            std::pair<int32_t, uint64_t> max_chunk_tiebreak{0, 0};\n+            for (const auto& chunk : real_chunking) {\n+                // If this is the first chunk with a strictly lower feerate, reset.\n+                if (chunk.feerate << last_chunk_feerate) {\n+                    comp_prefix_sizes.clear();\n+                    max_chunk_tiebreak = {0, 0};\n+                }\n+                last_chunk_feerate = chunk.feerate;\n+                // Find which sim component this chunk belongs to.\n+                auto component = sims[0].graph.GetConnectedComponent(sims[0].graph.Positions(), chunk.transactions.First());\n+                assert(chunk.transactions.IsSubsetOf(component));\n+                auto comp_key = component.First();\n+                auto& comp_prefix_size = comp_prefix_sizes[comp_key];\n+                comp_prefix_size += chunk.feerate.size;\n+                // Determine the chunk's max txid.\n+                uint64_t chunk_max_txid{0};\n+                for (auto tx : chunk.transactions) {\n+                    auto txid = sims[0].GetRef(tx)->m_txid;\n+                    chunk_max_txid = std::max(txid, chunk_max_txid);\n+                }\n+                // Verify consistency: within each group of equal-feerate chunks, the\n+                // (equal-feerate chunk prefix size, max txid) must be increasing.\n+                std::pair<int32_t, uint64_t> chunk_tiebreak{comp_prefix_size, chunk_max_txid};\n+                assert(chunk_tiebreak > max_chunk_tiebreak);\n+                max_chunk_tiebreak = chunk_tiebreak;\n+            }\n+\n+            // Verify that within each cluster, the internal ordering matches that of the\n+            // simulation if that is optimal too, since per-cluster optimal orderings are\n+            // deterministic.\n+            if (sim_optimal) {\n+                for (const auto& component : sims[0].GetComponents()) {\n+                    std::vector<DepGraphIndex> sim_chunk_lin;\n+                    for (auto i : sim_lin) {\n+                        if (component[i]) sim_chunk_lin.push_back(i);\n+                    }\n+                    std::vector<DepGraphIndex> real_chunk_lin;\n+                    for (auto i : vec1) {\n+                        if (component[i]) real_chunk_lin.push_back(i);\n+                    }\n+                    assert(sim_chunk_lin == real_chunk_lin);\n+                }\n+            }\n+\n+            // Verify that a fresh TxGraph, with the same transactions and txids, but constructed\n+            // in a different order, and with a different RNG state, recreates the exact same\n+            // ordering, showing that for optimal graphs, the full mempool ordering is\n+            // deterministic.\n+            auto real_redo = MakeTxGraph(\n+                /*max_cluster_count=*/max_cluster_count,\n+                /*max_cluster_size=*/max_cluster_size,\n+                /*acceptable_iters=*/acceptable_iters,\n+                /*fallback_order=*/fallback_order);\n+            /** Vector (indexed by SimTxGraph::Pos) of TxObjects in real_redo). */\n+            std::vector<std::optional<SimTxObject>> txobjects_redo;\n+            txobjects_redo.resize(sims[0].graph.PositionRange());\n+            // Recreate the graph's transactions with same feerate and txid.\n+            std::vector<DepGraphIndex> positions;\n+            for (auto i : sims[0].graph.Positions()) positions.push_back(i);\n+            std::shuffle(positions.begin(), positions.end(), rng);\n+            for (auto i : positions) {\n+                txobjects_redo[i].emplace(sims[0].GetRef(i)->m_txid);\n+                real_redo->AddTransaction(*txobjects_redo[i], FeePerWeight::FromFeeFrac(sims[0].graph.FeeRate(i)));\n+            }\n+            // Recreate the graph's dependencies.\n+            std::vector<std::pair<DepGraphIndex, DepGraphIndex>> deps;\n+            for (auto i : sims[0].graph.Positions()) {\n+                for (auto j : sims[0].graph.GetReducedParents(i)) {\n+                    deps.emplace_back(j, i);\n+                }\n+            }\n+            std::shuffle(deps.begin(), deps.end(), rng);\n+            for (auto [parent, child] : deps) {\n+                real_redo->AddDependency(*txobjects_redo[parent], *txobjects_redo[child]);\n+            }\n+            // Do work to reach optimality.\n+            if (!real_redo->DoWork(300000)) {",
      "path": "src/test/fuzz/txgraph.cpp",
      "position": 1,
      "original_position": 234,
      "commit_id": "5084095e5a3c46a371c75118feaf60942021b22d",
      "original_commit_id": "5084095e5a3c46a371c75118feaf60942021b22d",
      "in_reply_to_id": 2779990879,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Wow, good catch. Fixed, and verified it is executed with the fuzz corpus.",
      "created_at": "2026-02-08T23:07:14Z",
      "updated_at": "2026-02-08T23:07:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2780018812",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780018812"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1194,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780275557",
      "pull_request_review_id": 3770859417,
      "id": 2780275557,
      "node_id": "PRRC_kwDOABII586lt6Nl",
      "diff_hunk": "@@ -67,12 +67,14 @@ class TxGraph\n \n     /** Virtual destructor, so inheriting is safe. */\n     virtual ~TxGraph() = default;\n-    /** Construct a new transaction with the specified feerate, and return a Ref to it.\n+    /** Initialize arg (which must be an empty Ref) to refer to a new transaction in this graph\n+     *  with the specified feerate.\n+     *\n      *  If a staging graph exists, the new transaction is only created there. feerate.size must be\n-     *  strictly positive. In all further calls, only Refs created by AddTransaction() are allowed\n+     *  strictly positive. In all further calls, only Refs passed to AddTransaction() are allowed\n      *  to be passed to this TxGraph object (or empty Ref objects). Ref objects may outlive the\n-     *  TxGraph they were created for. */\n-    [[nodiscard]] virtual Ref AddTransaction(const FeePerWeight& feerate) noexcept = 0;\n+     *  TxGraph they were added to. */\n+    virtual void AddTransaction(Ref& arg, const FeePerWeight& feerate) noexcept = 0;",
      "path": "src/txgraph.h",
      "position": 15,
      "original_position": 15,
      "commit_id": "7ad26dffc5635f122cc000667e6dd8cc8c14fc22",
      "original_commit_id": "7ad26dffc5635f122cc000667e6dd8cc8c14fc22",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Commit message for the first commit is missing a verb: \"This does not when a Ref is\". \"does not work\" maybe?",
      "created_at": "2026-02-09T02:06:52Z",
      "updated_at": "2026-02-09T19:05:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2780275557",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780275557"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 77,
      "original_line": 77,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780337010",
      "pull_request_review_id": 3770859417,
      "id": 2780337010,
      "node_id": "PRRC_kwDOABII586luJNy",
      "diff_hunk": "@@ -1718,10 +1723,20 @@ void TxGraphImpl::Compact() noexcept\n         }\n \n         // Move the entry to the end.\n-        if (idx != m_entries.size() - 1) SwapIndexes(idx, m_entries.size() - 1);\n+        if (idx != m_entries.size() - 1) SwapIndexes(idx, m_entries.size() - 1, affected_main);\n         // Drop the entry for idx, now that it is at the end.\n         m_entries.pop_back();\n     }\n+\n+    // In a future commit, chunk information will end up containing a GraphIndex of the",
      "path": "src/txgraph.cpp",
      "position": 222,
      "original_position": 222,
      "commit_id": "a1735008506971f645798fc5385d25f88ce64640",
      "original_commit_id": "a1735008506971f645798fc5385d25f88ce64640",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Nit: Feels a bit like this could have been done in the future commit where it's actually used, by:\n\n * renaming `Updated` to `UpdatedOrCompacted` and adding the `bool rename` param\n * adding an `Updated() { return UpdateOrCompacted(/*rename=*/ false); }` inline in the base class\n * updating `Compact()` to call `UpdatedOrCompacted(/*rename=*/ true);`",
      "created_at": "2026-02-09T02:38:08Z",
      "updated_at": "2026-02-09T19:05:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2780337010",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780337010"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1731,
      "original_line": 1731,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780367843",
      "pull_request_review_id": 3770859417,
      "id": 2780367843,
      "node_id": "PRRC_kwDOABII586luQvj",
      "diff_hunk": "@@ -1082,6 +1082,53 @@ FUZZ_TARGET(clusterlin_linearize)\n         auto read_chunking = ChunkLinearization(depgraph, read);\n         auto cmp_read = CompareChunks(chunking, read_chunking);\n         assert(cmp_read >= 0);\n+\n+        // Verify that within every chunk, the transactions are in a valid order. For any pair of",
      "path": "src/test/fuzz/cluster_linearize.cpp",
      "position": 5,
      "original_position": 5,
      "commit_id": "7601196c2be68141dbd3bce5abea5716c06ae1e2",
      "original_commit_id": "7601196c2be68141dbd3bce5abea5716c06ae1e2",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The commit message here seems backwards: `1. Topology (chunks before chunks they depend on)` should be `chunks before chunks that depend on them`, I think?",
      "created_at": "2026-02-09T02:56:20Z",
      "updated_at": "2026-02-09T19:05:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2780367843",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780367843"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1086,
      "original_line": 1086,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780389943",
      "pull_request_review_id": 3770859417,
      "id": 2780389943,
      "node_id": "PRRC_kwDOABII586luWI3",
      "diff_hunk": "@@ -1267,16 +1273,35 @@ class SpanningForestState\n                 chunk_deps[chl_chunk_rep].first += (par_chunk_rep != chl_chunk_rep);\n             }\n         }\n+        /** Comparison function for the transaction heap. Note that it is a max-heap, so this\n+         *  implements the reverse order of what we want in the linearization. */",
      "path": "src/cluster_linearize.h",
      "position": 54,
      "original_position": 54,
      "commit_id": "7601196c2be68141dbd3bce5abea5716c06ae1e2",
      "original_commit_id": "7601196c2be68141dbd3bce5abea5716c06ae1e2",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "A max-heap will give us the max feerate first, if we define an `operator<` like function, so this doesn't entirely feel like we're implementing the reverse order of what we want?",
      "created_at": "2026-02-09T03:10:15Z",
      "updated_at": "2026-02-09T19:05:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2780389943",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780389943"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1277,
      "original_line": 1277,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780427051",
      "pull_request_review_id": 3770859417,
      "id": 2780427051,
      "node_id": "PRRC_kwDOABII586lufMr",
      "diff_hunk": "@@ -497,6 +497,12 @@ class TxGraphImpl final : public TxGraph\n         auto feerate_cmp = FeeRateCompare(entry_b.m_main_chunk_feerate, entry_a.m_main_chunk_feerate);\n         if (feerate_cmp < 0) return std::strong_ordering::less;\n         if (feerate_cmp > 0) return std::strong_ordering::greater;\n+        // Compare equal-feerate chunk prefix size for comparing equal chunk feerates. This does two",
      "path": "src/txgraph.cpp",
      "position": 4,
      "original_position": 4,
      "commit_id": "ca0ae9305e1df0d21067a5e50bd5cf613ec44cef",
      "original_commit_id": "ca0ae9305e1df0d21067a5e50bd5cf613ec44cef",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "It might be good to emphasise (particularly in the commit title) that this is for comparing chunks from different clusters. At least, I had a *wtf* moment when skimming the commit description.\n\nFWIW, \"equal-feerate chunk prefix\" initially read to me as \"the total weight of the txs within a chunk that all have the same feerate as the first tx in the chunk's linearization\". I'm not sure if there's any better way to write it though, and obviously the actual meaning is already explained.",
      "created_at": "2026-02-09T03:33:39Z",
      "updated_at": "2026-02-09T19:05:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2780427051",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780427051"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 500,
      "original_line": 500,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780434198",
      "pull_request_review_id": 3770859417,
      "id": 2780434198,
      "node_id": "PRRC_kwDOABII586lug8W",
      "diff_hunk": "@@ -497,6 +497,12 @@ class TxGraphImpl final : public TxGraph\n         auto feerate_cmp = FeeRateCompare(entry_b.m_main_chunk_feerate, entry_a.m_main_chunk_feerate);\n         if (feerate_cmp < 0) return std::strong_ordering::less;\n         if (feerate_cmp > 0) return std::strong_ordering::greater;\n+        // Compare equal-feerate chunk prefix size for comparing equal chunk feerates. This does two\n+        // things: it catches equal-feerate chunks within the same cluster (because later ones will\n+        // always have a higher prefix size), and it may catch equal-feerate chunks across clusters.",
      "path": "src/txgraph.cpp",
      "position": 6,
      "original_position": 6,
      "commit_id": "ca0ae9305e1df0d21067a5e50bd5cf613ec44cef",
      "original_commit_id": "ca0ae9305e1df0d21067a5e50bd5cf613ec44cef",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Might be better to say \"it (may) distinguish(es)\" rather than \"it (may) catch(es)\" ?",
      "created_at": "2026-02-09T03:37:39Z",
      "updated_at": "2026-02-09T19:05:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2780434198",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780434198"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 502,
      "original_line": 502,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780475893",
      "pull_request_review_id": 3770859417,
      "id": 2780475893,
      "node_id": "PRRC_kwDOABII586lurH1",
      "diff_hunk": "@@ -1053,18 +1066,27 @@ void GenericClusterImpl::Updated(TxGraphImpl& graph, int level, bool rename) noe\n     if (level == 0 && (rename || IsAcceptable())) {\n         auto chunking = ChunkLinearizationInfo(m_depgraph, m_linearization);\n         LinearizationIndex lin_idx{0};\n+        /** The sum of all chunk feerate FeeFracs with the same feerate as the current chunk,\n+         *  up to and including the current chunk. */\n+        FeeFrac equal_feerate_chunk_feerate;\n         // Iterate over the chunks.\n         for (unsigned chunk_idx = 0; chunk_idx < chunking.size(); ++chunk_idx) {\n             auto& chunk = chunking[chunk_idx];\n             auto chunk_count = chunk.transactions.Count();\n             Assume(chunk_count > 0);\n+            if (chunk.feerate << equal_feerate_chunk_feerate) {",
      "path": "src/txgraph.cpp",
      "position": 39,
      "original_position": 39,
      "commit_id": "ca0ae9305e1df0d21067a5e50bd5cf613ec44cef",
      "original_commit_id": "ca0ae9305e1df0d21067a5e50bd5cf613ec44cef",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The `operator<<` with it's weird precedence/associativity makes me feel a bit uncomfortable. Did you consider a helper like the following?\n\n```c++\nstruct FeeRateCmp {\n    const FeeFrac& ff;\n    FeeRateCmp(const FeeFrac& ff) : ff{ff} { }\n    friend inline std::strong_ordering operator<=>(const FeeRateCmp& a, const FeeRateCmp& b) noexcept\n    {\n        auto cross_a = Mul(a.ff.fee, b.ff.size), cross_b = Mul(b.ff.fee, a.ff.size);\n        return cross_a <=> cross_b;\n    }\n};\n\nif (FeeRateCmp(chunk.feerate) < equal_feerate_chunk_feerate) {\n```",
      "created_at": "2026-02-09T04:00:04Z",
      "updated_at": "2026-02-09T19:05:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2780475893",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780475893"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1077,
      "original_line": 1077,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780501584",
      "pull_request_review_id": 3770859417,
      "id": 2780501584,
      "node_id": "PRRC_kwDOABII586luxZQ",
      "diff_hunk": "@@ -1053,18 +1066,27 @@ void GenericClusterImpl::Updated(TxGraphImpl& graph, int level, bool rename) noe\n     if (level == 0 && (rename || IsAcceptable())) {\n         auto chunking = ChunkLinearizationInfo(m_depgraph, m_linearization);\n         LinearizationIndex lin_idx{0};\n+        /** The sum of all chunk feerate FeeFracs with the same feerate as the current chunk,\n+         *  up to and including the current chunk. */\n+        FeeFrac equal_feerate_chunk_feerate;\n         // Iterate over the chunks.\n         for (unsigned chunk_idx = 0; chunk_idx < chunking.size(); ++chunk_idx) {\n             auto& chunk = chunking[chunk_idx];\n             auto chunk_count = chunk.transactions.Count();\n             Assume(chunk_count > 0);\n+            if (chunk.feerate << equal_feerate_chunk_feerate) {\n+                equal_feerate_chunk_feerate = chunk.feerate;\n+            } else {\n+                equal_feerate_chunk_feerate += chunk.feerate;",
      "path": "src/txgraph.cpp",
      "position": 42,
      "original_position": 42,
      "commit_id": "ca0ae9305e1df0d21067a5e50bd5cf613ec44cef",
      "original_commit_id": "ca0ae9305e1df0d21067a5e50bd5cf613ec44cef",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think it's a little misleading to call these things feerates: if you have a feerate of 300 sats and 100vb (3 sat/vb) and another of 100 sats and 100vb (1sat/vb), then I think \"adding the feerates\" would intuitively be expected to give you 4sat/vb, rather than the more useful 400sats/200vb = 2sat/vb. Probably not worth improving though.",
      "created_at": "2026-02-09T04:15:04Z",
      "updated_at": "2026-02-09T19:05:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2780501584",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2780501584"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1080,
      "original_line": 1080,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2783723131",
      "pull_request_review_id": 3763603098,
      "id": 2783723131,
      "node_id": "PRRC_kwDOABII586l7D57",
      "diff_hunk": "@@ -1094,11 +1095,28 @@ FUZZ_TARGET(txgraph)\n                 auto comp_key = component.First();\n                 auto& comp_prefix_size = comp_prefix_sizes[comp_key];\n                 comp_prefix_size += chunk.feerate.size;\n-                // Verify consistency: within each component (= cluster in txgraph), the\n-                // equal-feerate chunk prefix size must be monotonically increasing.\n+                // Verify consistency: within each group of equal-feerate chunks, the equal-feerate\n+                // chunk prefix size must be monotonically increasing.\n                 assert(comp_prefix_size >= max_chunk_prefix_size);\n                 max_chunk_prefix_size = comp_prefix_size;\n             }\n+\n+            // Verify that within each cluster, the internal ordering matches that of the\n+            // simulation if that is optimal too, since per-cluster optimal orderings are\n+            // deterministic.",
      "path": "src/test/fuzz/txgraph.cpp",
      "position": 24,
      "original_position": 24,
      "commit_id": "f3b24a6d46e368fc5a7a0e010533613eefedf2da",
      "original_commit_id": "f3b24a6d46e368fc5a7a0e010533613eefedf2da",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "3749c666fb9513bb81dc2ce72a5690bd3ba0c1a275ae6943984daca4ff991645\n\nmight just mention that PostLinearization was called on both in the comment",
      "created_at": "2026-02-09T17:28:52Z",
      "updated_at": "2026-02-09T18:57:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2783723131",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2783723131"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1106,
      "original_line": 1106,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2783735609",
      "pull_request_review_id": 3770859417,
      "id": 2783735609,
      "node_id": "PRRC_kwDOABII586l7G85",
      "diff_hunk": "@@ -1240,15 +1250,30 @@ class SpanningForestState\n     }\n \n     /** Construct a topologically-valid linearization from the current forest state. Must be\n-     *  topological. */\n-    std::vector<DepGraphIndex> GetLinearization() noexcept\n+     *  topological. fallback_order is a comparator that defines a strong order for DepGraphIndexes\n+     *  in this cluster, used to order equal-feerate transactions and chunks.\n+     *\n+     * Specifically, the resulting order consists of:\n+     * - The chunks of the current SFL state, sorted by (in decreasing order of priority):\n+     *   - topology (parents before children)\n+     *   - highest chunk feerate first\n+     *   - smallest chunk size first\n+     *   - the chunk with the lowest maximum transaction, by fallback_order, first",
      "path": "src/cluster_linearize.h",
      "position": 40,
      "original_position": 40,
      "commit_id": "f3b24a6d46e368fc5a7a0e010533613eefedf2da",
      "original_commit_id": "f3b24a6d46e368fc5a7a0e010533613eefedf2da",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think this produces a tiny bias towards fewer-tx chunks (assuming a sufficiently adversarial scenario where anyone cares about ordering at this point) -- if you have 1 tx, you do K work to reduce the fallback order below T; but if you have N txs, you have to do KN work to get each tx's fallback order below T. Just having it be \"the chunk with the lowest transaction, by fallback_order\" seems like it would be fine here. I don't think it makes the code any simpler though, so unlikely to be worth changing?\n\n(You can't add a tx to a chunk to manipulate this rule as adding a tx will change the chunk's size, which is a higer priority factor to the ordering)",
      "created_at": "2026-02-09T17:31:38Z",
      "updated_at": "2026-02-09T19:05:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2783735609",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2783735609"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1261,
      "original_line": 1261,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2783770592",
      "pull_request_review_id": 3770859417,
      "id": 2783770592,
      "node_id": "PRRC_kwDOABII586l7Pfg",
      "diff_hunk": "@@ -1273,27 +1298,45 @@ class SpanningForestState\n                 chunk_deps[chl_chunk_rep].first += (par_chunk_rep != chl_chunk_rep);\n             }\n         }\n+        /** Function to compute the highest element of a chunk, by fallback_order. */\n+        auto max_fallback_fn = [&](TxIdx chunk_rep) noexcept {",
      "path": "src/cluster_linearize.h",
      "position": 77,
      "original_position": 77,
      "commit_id": "f3b24a6d46e368fc5a7a0e010533613eefedf2da",
      "original_commit_id": "f3b24a6d46e368fc5a7a0e010533613eefedf2da",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "It's not being passed as an argument, just called directly, so the `_fn` seems unnecesary fwiw.",
      "created_at": "2026-02-09T17:39:34Z",
      "updated_at": "2026-02-09T19:05:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2783770592",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2783770592"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1302,
      "original_line": 1302,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2783823523",
      "pull_request_review_id": 3770859417,
      "id": 2783823523,
      "node_id": "PRRC_kwDOABII586l7caj",
      "diff_hunk": "@@ -42,14 +46,14 @@ struct SimTxGraph\n     /** The dependency graph (for all transactions in the simulation, regardless of\n      *  connectivity/clustering). */\n     DepGraph<SetType> graph;\n-    /** For each position in graph, which TxGraph::Ref it corresponds with (if any). Use shared_ptr\n+    /** For each position in graph, which SimTxObject it corresponds with (if any). Use shared_ptr",
      "path": "src/test/fuzz/txgraph.cpp",
      "position": 16,
      "original_position": 16,
      "commit_id": "3df69cd2c334df007f0c76fc861b0cbfe521d15e",
      "original_commit_id": "3df69cd2c334df007f0c76fc861b0cbfe521d15e",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Commit message for \"subclass TxGraph::Ref like mempool does\" doesn't need to spell `falllback` like the coder is actually fallllllling.",
      "created_at": "2026-02-09T17:52:07Z",
      "updated_at": "2026-02-09T19:05:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2783823523",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2783823523"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 49,
      "original_line": 49,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2783938894",
      "pull_request_review_id": 3770859417,
      "id": 2783938894,
      "node_id": "PRRC_kwDOABII586l74lO",
      "diff_hunk": "@@ -239,9 +239,8 @@ def run_test(self):\n         self.generate(self.nodes[0], 1)\n         self.trigger_reorg(fork_blocks, self.nodes[0])\n \n-        # Check if the txs are returned to the mempool (though the transaction ordering may\n-        # change as it is non-deterministic).\n-        assert_equal(set(self.nodes[0].getrawmempool()), set(mempool0))\n+        # Check if the txs are returned to the mempool.",
      "path": "test/functional/mempool_packages.py",
      "position": 7,
      "original_position": 7,
      "commit_id": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "original_commit_id": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "\"Check that the txs are returned to the mempool, and that transaction ordering is unchanged, as it is deterministic.\" ?",
      "created_at": "2026-02-09T18:17:10Z",
      "updated_at": "2026-02-09T19:05:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2783938894",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2783938894"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 242,
      "original_line": 242,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2784022577",
      "pull_request_review_id": 3770859417,
      "id": 2784022577,
      "node_id": "PRRC_kwDOABII586l8NAx",
      "diff_hunk": "@@ -187,6 +187,8 @@ class Cluster\n      *  when called from Compact, to recompute after GraphIndexes may have changed; in this case,\n      *  no chunk index objects are removed or created either. */\n     virtual void Updated(TxGraphImpl& graph, int level, bool rename) noexcept = 0;\n+    /** Remove all chunk index entries for this cluster (level=0 only). */\n+    virtual void RemoveChunkData(TxGraphImpl& graph) noexcept = 0;",
      "path": "src/txgraph.cpp",
      "position": 5,
      "original_position": 5,
      "commit_id": "dec9934f924a61411558af0341f50a04907fe7f9",
      "original_commit_id": "dec9934f924a61411558af0341f50a04907fe7f9",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The commit description says \"However, the index itself needs to remain consistent in the mean time, even if not meaningful.\" I believe that means \"It is better if the index itself remains consistent in the meantime, even if it is not meaningful/useful\" -- at the end of this PR, if this work wasn't done, there wouldn't be a bug, it's just that it would be harder to understand the live data structures when debugging, and much easier to introduce a bug in future. Please correct me if I'm wrong.",
      "created_at": "2026-02-09T18:36:04Z",
      "updated_at": "2026-02-09T19:05:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2784022577",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2784022577"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 191,
      "original_line": 191,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2784036441",
      "pull_request_review_id": 3763603098,
      "id": 2784036441,
      "node_id": "PRRC_kwDOABII586l8QZZ",
      "diff_hunk": "@@ -2646,6 +2670,10 @@ void TxGraphImpl::CommitStaging() noexcept\n     // Staging must exist.\n     Assume(m_staging_clusterset.has_value());\n     Assume(m_main_chunkindex_observers == 0);\n+    // Get rid of removed transactions in staging before moving to main, to avoid the need to add\n+    // them to the chunk index (which may be problematic if they were unlinked and thus have no Ref\n+    // to use in fallback comparisons).\n+    ApplyRemovals(/*up_to_level=*/1);",
      "path": "src/txgraph.cpp",
      "position": 105,
      "original_position": 105,
      "commit_id": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "original_commit_id": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322\n\nCould the comment be made to seem more urgent? Sounded almost optional to me, when it turns out it's crucial.",
      "created_at": "2026-02-09T18:38:47Z",
      "updated_at": "2026-02-09T18:57:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2784036441",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2784036441"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2676,
      "original_line": 2676,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2784169817",
      "pull_request_review_id": 3774928010,
      "id": 2784169817,
      "node_id": "PRRC_kwDOABII586l8w9Z",
      "diff_hunk": "@@ -2774,14 +2798,16 @@ void GenericClusterImpl::SanityCheck(const TxGraphImpl& graph, int level) const\n             assert(entry.m_main_chunk_feerate == linchunking[chunk_num].feerate);\n             // Verify that an entry in the chunk index exists for every chunk-ending transaction.\n             ++chunk_pos;\n-            bool is_chunk_end = (chunk_pos == linchunking[chunk_num].transactions.Count());\n-            assert((entry.m_main_chunkindex_iterator != graph.m_main_chunkindex.end()) == is_chunk_end);\n-            if (is_chunk_end) {\n-                auto& chunk_data = *entry.m_main_chunkindex_iterator;\n-                if (m_done == m_depgraph.Positions() && chunk_pos == 1) {\n-                    assert(chunk_data.m_chunk_count == LinearizationIndex(-1));\n-                } else {\n-                    assert(chunk_data.m_chunk_count == chunk_pos);\n+            if (graph.m_main_clusterset.m_to_remove.empty()) {",
      "path": "src/txgraph.cpp",
      "position": 538,
      "original_position": 71,
      "commit_id": "26b71b3b30f1fc0ca54dbb529bb787b094b4e322",
      "original_commit_id": "fa86fb6ed2c5f9a551e83bb7562c73dade6e551e",
      "in_reply_to_id": 2774801850,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Right, exactly. We need to deal with a situation where there are to-be-applied removals still, in which case the chunk information may be outdated/meaningless. But this is not a problem either, because in this state the chunk information isn't observable anyway.",
      "created_at": "2026-02-09T19:29:15Z",
      "updated_at": "2026-02-09T19:29:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34257#discussion_r2784169817",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2784169817"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34257"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2876,
      "original_line": 2876,
      "side": "RIGHT"
    }
  ]
}