{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34424",
    "id": 3216159492,
    "node_id": "PR_kwDOABII586_srME",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/34424",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/34424.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/34424.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34424",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34424/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34424/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34424/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/bbbed4182d873017be1fd64537e20da2592e008e",
    "number": 34424,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "[RFC] CChain Concurrency Improvement (Base + Tail Architecture)",
    "user": {
      "login": "alexanderwiederin",
      "id": 37130778,
      "node_id": "MDQ6VXNlcjM3MTMwNzc4",
      "avatar_url": "https://avatars.githubusercontent.com/u/37130778?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexanderwiederin",
      "html_url": "https://github.com/alexanderwiederin",
      "followers_url": "https://api.github.com/users/alexanderwiederin/followers",
      "following_url": "https://api.github.com/users/alexanderwiederin/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/alexanderwiederin/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/alexanderwiederin/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/alexanderwiederin/subscriptions",
      "organizations_url": "https://api.github.com/users/alexanderwiederin/orgs",
      "repos_url": "https://api.github.com/users/alexanderwiederin/repos",
      "events_url": "https://api.github.com/users/alexanderwiederin/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/alexanderwiederin/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "## RFC: CChain Concurrency Improvement\r\n\r\nThis PR implements a copy-on-write based CChain design to enable concurrent access.\r\n\r\n### Motivation\r\n\r\nCurrent CChain uses a single vector protected by `cs_main`, creating bottlenecks for multi-threaded access. This PR lays the groundwork for removing `cs_main` locks by enabling consistent snapshots without holding locks.\r\n\r\n### Design\r\n\r\nSee full design document: [CChain Concurrency](https://github.com/alexanderwiederin/bitcoinkernel-proposals/blob/master/cchain-concurrency.md)\r\n\r\n**TL;DR:** Split chain into base (bulk of history) + tail (recent ~1,000 blocks). Use nested `stlab::copy_on_write` so updates copy only tail, keeping base shared.\r\n\r\n*Thanks to @purplekarrot for pointing me to `stlab::copy_on_write` and making design suggestions.*\r\n\r\n### Changes\r\n\r\n- Implements copy-on-write based CChain with value semantics\r\n- Removes `cs_main` locks from RPC methods (where possible)\r\n- All validation locks remain in place (`cs_main` still held during validation)\r\n- API unchanged - backward compatible\r\n\r\n### Request for Comments\r\n\r\n1. Is the nested copy-on-write architecture sound?\r\n2. Is `MAX_TAIL_SIZE = 1000` reasonable?\r\n3. What are the concerns for future lock removal?\n4. Is the added complexity worth the benefit?",
    "labels": [],
    "created_at": "2026-01-27T20:44:43Z",
    "updated_at": "2026-01-28T16:33:27Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "33b9ec1721826ce835e9587063c6aac448c40ccd",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "alexanderwiederin:chain-concurrency-enhancement",
      "ref": "chain-concurrency-enhancement",
      "sha": "bbbed4182d873017be1fd64537e20da2592e008e",
      "user": {
        "login": "alexanderwiederin",
        "id": 37130778,
        "node_id": "MDQ6VXNlcjM3MTMwNzc4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37130778?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alexanderwiederin",
        "html_url": "https://github.com/alexanderwiederin",
        "followers_url": "https://api.github.com/users/alexanderwiederin/followers",
        "following_url": "https://api.github.com/users/alexanderwiederin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/alexanderwiederin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/alexanderwiederin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/alexanderwiederin/subscriptions",
        "organizations_url": "https://api.github.com/users/alexanderwiederin/orgs",
        "repos_url": "https://api.github.com/users/alexanderwiederin/repos",
        "events_url": "https://api.github.com/users/alexanderwiederin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/alexanderwiederin/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 622579500,
        "node_id": "R_kgDOJRvPLA",
        "name": "bitcoin",
        "full_name": "alexanderwiederin/bitcoin",
        "owner": {
          "login": "alexanderwiederin",
          "id": 37130778,
          "node_id": "MDQ6VXNlcjM3MTMwNzc4",
          "avatar_url": "https://avatars.githubusercontent.com/u/37130778?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/alexanderwiederin",
          "html_url": "https://github.com/alexanderwiederin",
          "followers_url": "https://api.github.com/users/alexanderwiederin/followers",
          "following_url": "https://api.github.com/users/alexanderwiederin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/alexanderwiederin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/alexanderwiederin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/alexanderwiederin/subscriptions",
          "organizations_url": "https://api.github.com/users/alexanderwiederin/orgs",
          "repos_url": "https://api.github.com/users/alexanderwiederin/repos",
          "events_url": "https://api.github.com/users/alexanderwiederin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/alexanderwiederin/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/alexanderwiederin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/alexanderwiederin/bitcoin",
        "archive_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/alexanderwiederin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:alexanderwiederin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/alexanderwiederin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/hooks",
        "svn_url": "https://github.com/alexanderwiederin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 273818,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-28T16:25:45Z",
        "created_at": "2023-04-02T14:31:22Z",
        "updated_at": "2026-01-27T16:52:18Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "a7460b992884d2964df30c7b3aa7ce7f6e6cec4c",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38812,
        "stargazers_count": 87799,
        "watchers_count": 87799,
        "size": 302434,
        "default_branch": "master",
        "open_issues_count": 745,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-28T16:31:45Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2026-01-28T16:31:57Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34424"
      }
    },
    "author_association": "NONE",
    "draft": true,
    "additions": 462,
    "deletions": 54,
    "changed_files": 7,
    "commits": 5,
    "review_comments": 9,
    "comments": 2
  },
  "events": [
    {
      "event": "mentioned",
      "id": 22328119931,
      "node_id": "MEE_lADOABII587mNxVczwAAAAUy3BJ7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22328119931",
      "actor": {
        "login": "purpleKarrot",
        "id": 185240,
        "node_id": "MDQ6VXNlcjE4NTI0MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/185240?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/purpleKarrot",
        "html_url": "https://github.com/purpleKarrot",
        "followers_url": "https://api.github.com/users/purpleKarrot/followers",
        "following_url": "https://api.github.com/users/purpleKarrot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/purpleKarrot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/purpleKarrot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/purpleKarrot/subscriptions",
        "organizations_url": "https://api.github.com/users/purpleKarrot/orgs",
        "repos_url": "https://api.github.com/users/purpleKarrot/repos",
        "events_url": "https://api.github.com/users/purpleKarrot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/purpleKarrot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T20:44:45Z"
    },
    {
      "event": "subscribed",
      "id": 22328119961,
      "node_id": "SE_lADOABII587mNxVczwAAAAUy3BKZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22328119961",
      "actor": {
        "login": "purpleKarrot",
        "id": 185240,
        "node_id": "MDQ6VXNlcjE4NTI0MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/185240?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/purpleKarrot",
        "html_url": "https://github.com/purpleKarrot",
        "followers_url": "https://api.github.com/users/purpleKarrot/followers",
        "following_url": "https://api.github.com/users/purpleKarrot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/purpleKarrot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/purpleKarrot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/purpleKarrot/subscriptions",
        "organizations_url": "https://api.github.com/users/purpleKarrot/orgs",
        "repos_url": "https://api.github.com/users/purpleKarrot/repos",
        "events_url": "https://api.github.com/users/purpleKarrot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/purpleKarrot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T20:44:45Z"
    },
    {
      "event": "commented",
      "id": 3807446235,
      "node_id": "IC_kwDOABII587i8QTb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3807446235",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T20:44:53Z",
      "updated_at": "2026-01-28T14:02:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34424.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [ismaelsadeeq](https://github.com/bitcoin/bitcoin/pull/34424#pullrequestreview-3716804020) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34424#issuecomment-3807446235",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34424"
    },
    {
      "event": "renamed",
      "id": 22328165511,
      "node_id": "RTE_lADOABII587mNxVczwAAAAUy3MSH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22328165511",
      "actor": {
        "login": "alexanderwiederin",
        "id": 37130778,
        "node_id": "MDQ6VXNlcjM3MTMwNzc4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37130778?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alexanderwiederin",
        "html_url": "https://github.com/alexanderwiederin",
        "followers_url": "https://api.github.com/users/alexanderwiederin/followers",
        "following_url": "https://api.github.com/users/alexanderwiederin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/alexanderwiederin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/alexanderwiederin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/alexanderwiederin/subscriptions",
        "organizations_url": "https://api.github.com/users/alexanderwiederin/orgs",
        "repos_url": "https://api.github.com/users/alexanderwiederin/repos",
        "events_url": "https://api.github.com/users/alexanderwiederin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/alexanderwiederin/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T20:46:58Z",
      "rename": {
        "from": "[RFC] Chain Concurrency Improvement",
        "to": "[RFC] Chain Concurrency Improvement (Base + Tail Architecture)"
      }
    },
    {
      "event": "renamed",
      "id": 22328261447,
      "node_id": "RTE_lADOABII587mNxVczwAAAAUy3jtH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22328261447",
      "actor": {
        "login": "alexanderwiederin",
        "id": 37130778,
        "node_id": "MDQ6VXNlcjM3MTMwNzc4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37130778?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alexanderwiederin",
        "html_url": "https://github.com/alexanderwiederin",
        "followers_url": "https://api.github.com/users/alexanderwiederin/followers",
        "following_url": "https://api.github.com/users/alexanderwiederin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/alexanderwiederin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/alexanderwiederin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/alexanderwiederin/subscriptions",
        "organizations_url": "https://api.github.com/users/alexanderwiederin/orgs",
        "repos_url": "https://api.github.com/users/alexanderwiederin/repos",
        "events_url": "https://api.github.com/users/alexanderwiederin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/alexanderwiederin/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T20:52:02Z",
      "rename": {
        "from": "[RFC] Chain Concurrency Improvement (Base + Tail Architecture)",
        "to": "[RFC] CChain Concurrency Improvement (Base + Tail Architecture)"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22332962070,
      "node_id": "HRFPE_lADOABII587mNxVczwAAAAUzJfUW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22332962070",
      "actor": {
        "login": "alexanderwiederin",
        "id": 37130778,
        "node_id": "MDQ6VXNlcjM3MTMwNzc4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37130778?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alexanderwiederin",
        "html_url": "https://github.com/alexanderwiederin",
        "followers_url": "https://api.github.com/users/alexanderwiederin/followers",
        "following_url": "https://api.github.com/users/alexanderwiederin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/alexanderwiederin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/alexanderwiederin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/alexanderwiederin/subscriptions",
        "organizations_url": "https://api.github.com/users/alexanderwiederin/orgs",
        "repos_url": "https://api.github.com/users/alexanderwiederin/repos",
        "events_url": "https://api.github.com/users/alexanderwiederin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/alexanderwiederin/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "a26ce373542997b28dbe8fa036e7ba176f447f2b",
      "commit_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/commits/a26ce373542997b28dbe8fa036e7ba176f447f2b",
      "created_at": "2026-01-28T02:00:58Z"
    },
    {
      "event": "reviewed",
      "id": 3716804020,
      "node_id": "PRR_kwDOABII587die20",
      "url": null,
      "actor": null,
      "commit_id": "a26ce373542997b28dbe8fa036e7ba176f447f2b",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-28T14:02:47Z",
      "author_association": "MEMBER",
      "body": "Concept ACK on this.\n\n Looks simpler than I thought.\n\nA few comments after a quick skim through the PR",
      "user": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34424#pullrequestreview-3716804020",
      "submitted_at": "2026-01-28T14:02:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34424"
    },
    {
      "event": "commented",
      "id": 3812007621,
      "node_id": "IC_kwDOABII587jNp7F",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3812007621",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-28T15:35:51Z",
      "updated_at": "2026-01-28T15:35:51Z",
      "author_association": "MEMBER",
      "body": "> ### Design\r\n> \r\n> See full design document: [CChain Concurrency](https://github.com/alexanderwiederin/bitcoinkernel-proposals/blob/master/cchain-concurrency.md)\r\n\r\nIn the design section you describe the initial state with a single block in the tail, but a merge operation empties it. It seems nicer for those to be consistent?\r\n\r\n> Is `MAX_TAIL_SIZE = 1000` reasonable?\r\n\r\nI guess you could go an order of magnitude lower and match the coinbase maturity, if we need to rewrite the chain this deep we have bigger problems than a large amount of copies?",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34424#issuecomment-3812007621",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34424"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGJjYTQ5OTQ0NzhkMzM2YzUwMzM1ZmEyMTNjMDdlNzFkZTUzNWM4OGM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bca4994478d336c50335fa213c07e71de535c88c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/bca4994478d336c50335fa213c07e71de535c88c",
      "tree": {
        "sha": "b3271851e40b9e2375fd13fcd2dc9f919772440e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b3271851e40b9e2375fd13fcd2dc9f919772440e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree b3271851e40b9e2375fd13fcd2dc9f919772440e\nparent 27aeeff630147cca35488752c01aaf5750b69fbc\nauthor alexanderwiederin <alex@wiederin.xyz> 1769181247 +0100\ncommitter alexanderwiederin <alex@wiederin.xyz> 1769617107 +0100\n\nutil: add copy-on-write smart pointer\n\nIntroduce copy-on-write wrapper from stlab library to enable efficient\nvalue semantics with shared ownership. Uses atomic reference counting to\nshare instances and only copies on modification when non-unique.\n\nBased on Adobe's stlab library, distributed under Boost Software License\n1.0\n\nOriginal source: https://github.com/stlab/stlab-copy-on-write/tree/abb4445\n\nCo-authored-by: janb84 <608446+janb84@users.noreply.github.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYKAB0WIQTXj1XDjxogVDD8upVm26ILw3hRfwUCaXo3QwAKCRBm26ILw3hR\nf1kLAP4n0cpen1h2iQTJdZLOHQBWTWyg0JS5AFIk9c7o80vUxwEAkuyfz+stFBkb\nshZkW6gNSoFa4TuhNN0KX4t3QuUWXgw=\n=9dZM\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/27aeeff630147cca35488752c01aaf5750b69fbc",
          "sha": "27aeeff630147cca35488752c01aaf5750b69fbc",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/27aeeff630147cca35488752c01aaf5750b69fbc"
        }
      ],
      "message": "util: add copy-on-write smart pointer\n\nIntroduce copy-on-write wrapper from stlab library to enable efficient\nvalue semantics with shared ownership. Uses atomic reference counting to\nshare instances and only copies on modification when non-unique.\n\nBased on Adobe's stlab library, distributed under Boost Software License\n1.0\n\nOriginal source: https://github.com/stlab/stlab-copy-on-write/tree/abb4445\n\nCo-authored-by: janb84 <608446+janb84@users.noreply.github.com>",
      "committer": {
        "name": "alexanderwiederin",
        "email": "alex@wiederin.xyz",
        "date": "2026-01-28T16:18:27Z"
      },
      "author": {
        "name": "alexanderwiederin",
        "email": "alex@wiederin.xyz",
        "date": "2026-01-23T15:14:07Z"
      },
      "sha": "bca4994478d336c50335fa213c07e71de535c88c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDcyZDJmN2RkOTZhM2Q4MDk4MTM2ZWNiNzMzOWViNTc1Yzg4NWI2ZDA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/72d2f7dd96a3d8098136ecb7339eb575c885b6d0",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/72d2f7dd96a3d8098136ecb7339eb575c885b6d0",
      "tree": {
        "sha": "e3364bda59fffeef2b1aac51e2b5f51c669c4f9c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e3364bda59fffeef2b1aac51e2b5f51c669c4f9c"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree e3364bda59fffeef2b1aac51e2b5f51c669c4f9c\nparent bca4994478d336c50335fa213c07e71de535c88c\nauthor alexanderwiederin <alex@wiederin.xyz> 1764860710 +0100\ncommitter alexanderwiederin <alex@wiederin.xyz> 1769617219 +0100\n\nrefactor: Implement copy-on-write semantics for CChain\n\nRefactor CChain into a regular type with copy-on-write semantics, using\na split base/tail architecture to enable snapshots.\n\nKey changes:\n- Make CChain a regular type supporting copy construction/assignment\n- Introduce COW Impl struct holding base (COW vector) and tail (mutable\n  vector)\n- Optimize sequential appends by accumulating in tail until\n  MAX_TAIL_SIZE\n- Merge tail into base only when size threshold is reached\n- Handle reorgs by rebuilding base and clearing tail\n- Update all methods (FindFork, FindEarliestAtLeast, etx.) for split\n  storage\n- Add thread safety via mutex for write operations\n\nThis allows creating chain snapshots via simple copy while sharing the\nbulk of the data. Copies only occur on modification.\n\nCo-authored-by: janb84 <608446+janb84@users.noreply.github.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYKAB0WIQTXj1XDjxogVDD8upVm26ILw3hRfwUCaXo3QwAKCRBm26ILw3hR\nfz+zAQDRAiuMQaRBqvb4ODZYkXwA4pjaanUlSudN9oHktLlKTQEA/XP7Du04Ag0q\nNU/E9rAzeg6Lc8+8/d/AeUdPY7tSaQg=\n=pCKB\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bca4994478d336c50335fa213c07e71de535c88c",
          "sha": "bca4994478d336c50335fa213c07e71de535c88c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/bca4994478d336c50335fa213c07e71de535c88c"
        }
      ],
      "message": "refactor: Implement copy-on-write semantics for CChain\n\nRefactor CChain into a regular type with copy-on-write semantics, using\na split base/tail architecture to enable snapshots.\n\nKey changes:\n- Make CChain a regular type supporting copy construction/assignment\n- Introduce COW Impl struct holding base (COW vector) and tail (mutable\n  vector)\n- Optimize sequential appends by accumulating in tail until\n  MAX_TAIL_SIZE\n- Merge tail into base only when size threshold is reached\n- Handle reorgs by rebuilding base and clearing tail\n- Update all methods (FindFork, FindEarliestAtLeast, etx.) for split\n  storage\n- Add thread safety via mutex for write operations\n\nThis allows creating chain snapshots via simple copy while sharing the\nbulk of the data. Copies only occur on modification.\n\nCo-authored-by: janb84 <608446+janb84@users.noreply.github.com>",
      "committer": {
        "name": "alexanderwiederin",
        "email": "alex@wiederin.xyz",
        "date": "2026-01-28T16:20:19Z"
      },
      "author": {
        "name": "alexanderwiederin",
        "email": "alex@wiederin.xyz",
        "date": "2025-12-04T15:05:10Z"
      },
      "sha": "72d2f7dd96a3d8098136ecb7339eb575c885b6d0"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDM5ZWFiZDQwYWI1MTMxYzYzN2Q3ZGNhNGE5ODE5OTIyOGRkZjU1YTc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/39eabd40ab5131c637d7dca4a98199228ddf55a7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/39eabd40ab5131c637d7dca4a98199228ddf55a7",
      "tree": {
        "sha": "f188dd6d8fb2a0c40db99233c0fc850fbd2f44fa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f188dd6d8fb2a0c40db99233c0fc850fbd2f44fa"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree f188dd6d8fb2a0c40db99233c0fc850fbd2f44fa\nparent 72d2f7dd96a3d8098136ecb7339eb575c885b6d0\nauthor alexanderwiederin <alex@wiederin.xyz> 1769184490 +0100\ncommitter alexanderwiederin <alex@wiederin.xyz> 1769617220 +0100\n\nvalidation: add ActiveChainSnapshot() method\n\nAdd ActiveChainSnapshot() to ChainstateManager to enable lock-free\naccess to the active chain. Unlike ActiveChain() which requires holding\ncs_main, this methods acquires the lock internally and returns a\ncopy-on-write snapshot of the chain.\n\nThis allows RPC methods and other consumers to work with a consistent\nview of the chain without holding cs_main for extended periods, reducing\nlock contention.\n\nCo-authored-by: janb84 <608446+janb84@users.noreply.github.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYKAB0WIQTXj1XDjxogVDD8upVm26ILw3hRfwUCaXo3RAAKCRBm26ILw3hR\nfwulAQCKe12R3R/+BYwY6dNhzrSYqTG/hLNwsiPCwiSFDuafRQEA9XdtinZXGaiT\nAib8oT0HC3HcRMs9XE94FBJBil15jA8=\n=ukU8\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/72d2f7dd96a3d8098136ecb7339eb575c885b6d0",
          "sha": "72d2f7dd96a3d8098136ecb7339eb575c885b6d0",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/72d2f7dd96a3d8098136ecb7339eb575c885b6d0"
        }
      ],
      "message": "validation: add ActiveChainSnapshot() method\n\nAdd ActiveChainSnapshot() to ChainstateManager to enable lock-free\naccess to the active chain. Unlike ActiveChain() which requires holding\ncs_main, this methods acquires the lock internally and returns a\ncopy-on-write snapshot of the chain.\n\nThis allows RPC methods and other consumers to work with a consistent\nview of the chain without holding cs_main for extended periods, reducing\nlock contention.\n\nCo-authored-by: janb84 <608446+janb84@users.noreply.github.com>",
      "committer": {
        "name": "alexanderwiederin",
        "email": "alex@wiederin.xyz",
        "date": "2026-01-28T16:20:20Z"
      },
      "author": {
        "name": "alexanderwiederin",
        "email": "alex@wiederin.xyz",
        "date": "2026-01-23T16:08:10Z"
      },
      "sha": "39eabd40ab5131c637d7dca4a98199228ddf55a7"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDU5ZTQ5NTJjMmQ0MmU0ZTBiNDllMzRkY2MyZjU3ZTUzZjg1NmZkZjE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/59e4952c2d42e4e0b49e34dcc2f57e53f856fdf1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/59e4952c2d42e4e0b49e34dcc2f57e53f856fdf1",
      "tree": {
        "sha": "133e98f85803d894281da6f79276bc9af599eb6f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/133e98f85803d894281da6f79276bc9af599eb6f"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 133e98f85803d894281da6f79276bc9af599eb6f\nparent 39eabd40ab5131c637d7dca4a98199228ddf55a7\nauthor alexanderwiederin <alex@wiederin.xyz> 1768997563 +0100\ncommitter alexanderwiederin <alex@wiederin.xyz> 1769617220 +0100\n\nrpc: use chain snapshot in mining RPC\n\nReplace cs_main-locked chain access with ActiveChainSnapshot() in\ngetnetworkhashps to reduce lock contention.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYKAB0WIQTXj1XDjxogVDD8upVm26ILw3hRfwUCaXo3RAAKCRBm26ILw3hR\nf3ueAQCVLZZkDYvf8vsIiu9+k2BQzYbdJXXLf4ZgI8Thi7pWRQEAoe5ZCtbNcmLI\nZ1zq37vF7Xy/uWEHmyoewbVfCCIF2Qk=\n=LmQq\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/39eabd40ab5131c637d7dca4a98199228ddf55a7",
          "sha": "39eabd40ab5131c637d7dca4a98199228ddf55a7",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/39eabd40ab5131c637d7dca4a98199228ddf55a7"
        }
      ],
      "message": "rpc: use chain snapshot in mining RPC\n\nReplace cs_main-locked chain access with ActiveChainSnapshot() in\ngetnetworkhashps to reduce lock contention.",
      "committer": {
        "name": "alexanderwiederin",
        "email": "alex@wiederin.xyz",
        "date": "2026-01-28T16:20:20Z"
      },
      "author": {
        "name": "alexanderwiederin",
        "email": "alex@wiederin.xyz",
        "date": "2026-01-21T12:12:43Z"
      },
      "sha": "59e4952c2d42e4e0b49e34dcc2f57e53f856fdf1"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGJiYmVkNDE4MmQ4NzMwMTdiZTFmZDY0NTM3ZTIwZGEyNTkyZTAwOGU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bbbed4182d873017be1fd64537e20da2592e008e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/bbbed4182d873017be1fd64537e20da2592e008e",
      "tree": {
        "sha": "ccfbe597e14f45c4c9eaa784f201cda037efd290",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ccfbe597e14f45c4c9eaa784f201cda037efd290"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree ccfbe597e14f45c4c9eaa784f201cda037efd290\nparent 59e4952c2d42e4e0b49e34dcc2f57e53f856fdf1\nauthor alexanderwiederin <alex@wiederin.xyz> 1769002311 +0100\ncommitter alexanderwiederin <alex@wiederin.xyz> 1769617220 +0100\n\nrpc: use chain snapshots in blockchain RPCs\n\nReplace cs_main-locked chain access with ActiveChainSnapshot() in\nblockchain RPC methods to reduce lock contention. The snapshot it\nacquried once at the start of each RPOC call, providing a consistent\nview of the chain without holdin cs_main throughout.\n\nFor RPCs that also need BlockIndex lookups, cs_main is still acquired\nbut only for the BlockIndex access, not for chain queries.\n\nUpdated RPCs:\n- getblock, getblockheader: snapshot for tip, cs_main for block lookup\n- getchaintips: snapshot for active chain, cs_main for BlockIndex\n  iteration\n- getblockcount, getbestblockhash: snapshot only no cs_main needed\n- geblockhash, getdifficulty: snapshot only via ParseHashOrHeight\n- pruneblockchain: snapshot for height calculation, cs_main for pruning\n- getchaintxstats: snapshot for tip and Contains check\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYKAB0WIQTXj1XDjxogVDD8upVm26ILw3hRfwUCaXo3RAAKCRBm26ILw3hR\nfy1/AQCt1FnLFnlEI7SkFt7cHHvp+AG4zmF483IPDFznAwECJgEAuPRwcg9ISK3Q\nut62LI10yMI1wbRMqDEh4grnLpV5Uw0=\n=sDSv\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/59e4952c2d42e4e0b49e34dcc2f57e53f856fdf1",
          "sha": "59e4952c2d42e4e0b49e34dcc2f57e53f856fdf1",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/59e4952c2d42e4e0b49e34dcc2f57e53f856fdf1"
        }
      ],
      "message": "rpc: use chain snapshots in blockchain RPCs\n\nReplace cs_main-locked chain access with ActiveChainSnapshot() in\nblockchain RPC methods to reduce lock contention. The snapshot it\nacquried once at the start of each RPOC call, providing a consistent\nview of the chain without holdin cs_main throughout.\n\nFor RPCs that also need BlockIndex lookups, cs_main is still acquired\nbut only for the BlockIndex access, not for chain queries.\n\nUpdated RPCs:\n- getblock, getblockheader: snapshot for tip, cs_main for block lookup\n- getchaintips: snapshot for active chain, cs_main for BlockIndex\n  iteration\n- getblockcount, getbestblockhash: snapshot only no cs_main needed\n- geblockhash, getdifficulty: snapshot only via ParseHashOrHeight\n- pruneblockchain: snapshot for height calculation, cs_main for pruning\n- getchaintxstats: snapshot for tip and Contains check",
      "committer": {
        "name": "alexanderwiederin",
        "email": "alex@wiederin.xyz",
        "date": "2026-01-28T16:20:20Z"
      },
      "author": {
        "name": "alexanderwiederin",
        "email": "alex@wiederin.xyz",
        "date": "2026-01-21T13:31:51Z"
      },
      "sha": "bbbed4182d873017be1fd64537e20da2592e008e"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22350750623,
      "node_id": "HRFPE_lADOABII587mNxVczwAAAAU0NWOf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22350750623",
      "actor": {
        "login": "alexanderwiederin",
        "id": 37130778,
        "node_id": "MDQ6VXNlcjM3MTMwNzc4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37130778?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alexanderwiederin",
        "html_url": "https://github.com/alexanderwiederin",
        "followers_url": "https://api.github.com/users/alexanderwiederin/followers",
        "following_url": "https://api.github.com/users/alexanderwiederin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/alexanderwiederin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/alexanderwiederin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/alexanderwiederin/subscriptions",
        "organizations_url": "https://api.github.com/users/alexanderwiederin/orgs",
        "repos_url": "https://api.github.com/users/alexanderwiederin/repos",
        "events_url": "https://api.github.com/users/alexanderwiederin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/alexanderwiederin/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "bbbed4182d873017be1fd64537e20da2592e008e",
      "commit_url": "https://api.github.com/repos/alexanderwiederin/bitcoin/commits/bbbed4182d873017be1fd64537e20da2592e008e",
      "created_at": "2026-01-28T16:25:47Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736725247",
      "pull_request_review_id": 3716804020,
      "id": 2736725247,
      "node_id": "PRRC_kwDOABII586jHxz_",
      "diff_hunk": "@@ -1153,6 +1153,10 @@ class ChainstateManager\n     //! @{",
      "path": "src/validation.h",
      "position": 1,
      "original_position": 1,
      "commit_id": "bbbed4182d873017be1fd64537e20da2592e008e",
      "original_commit_id": "6b4db9640550b8f4cacc8debdb6eaf5a941885c9",
      "in_reply_to_id": null,
      "user": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In \"validation: add ActiveChainSnapshot() method\" 6b4db9640550b8f4cacc8debdb6eaf5a941885c9\n\n\nnit: In commit message body s/acwuires/acquires",
      "created_at": "2026-01-28T13:48:18Z",
      "updated_at": "2026-01-28T14:02:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34424#discussion_r2736725247",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736725247"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34424"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1153,
      "original_line": 1153,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736742493",
      "pull_request_review_id": 3716804020,
      "id": 2736742493,
      "node_id": "PRRC_kwDOABII586jH2Bd",
      "diff_hunk": "@@ -0,0 +1,260 @@\n+// Copyright (c) 2013 Adobe\n+// Copyright (c) 2025-present The Bitcoin Core developers",
      "path": "src/util/copy_on_write.h",
      "position": 2,
      "original_position": 2,
      "commit_id": "bbbed4182d873017be1fd64537e20da2592e008e",
      "original_commit_id": "490324dd7a07dfc44bfbc06b57b0c36df29581eb",
      "in_reply_to_id": null,
      "user": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In \"util: add copy-on-write smart pointer\"  490324dd7a07dfc44bfbc06b57b0c36df29581eb\n\n\nIs this a direct copy? Or has modifications, perhaps add a link in the commit message to the reference implementation.\n\nI also think we should have a basic unit test for this utility.",
      "created_at": "2026-01-28T13:52:31Z",
      "updated_at": "2026-01-28T14:02:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34424#discussion_r2736742493",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736742493"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34424"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2,
      "original_line": 2,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736746649",
      "pull_request_review_id": 3716804020,
      "id": 2736746649,
      "node_id": "PRRC_kwDOABII586jH3CZ",
      "diff_hunk": "@@ -15,12 +19,25 @@ std::string CBlockIndex::ToString() const\n \n void CChain::SetTip(CBlockIndex& block)\n {\n-    CBlockIndex* pindex = &block;\n-    vChain.resize(pindex->nHeight + 1);\n-    while (pindex && vChain[pindex->nHeight] != pindex) {\n-        vChain[pindex->nHeight] = pindex;\n-        pindex = pindex->pprev;\n+    std::lock_guard<std::mutex> lock(m_write_mutex);",
      "path": "src/chain.cpp",
      "position": 1,
      "original_position": 20,
      "commit_id": "be06d774f34d05c7089fc388f7407331b54eb46a",
      "original_commit_id": "be06d774f34d05c7089fc388f7407331b54eb46a",
      "in_reply_to_id": null,
      "user": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In \"refactor: Implement copy-on-write semantics for CChain\" be06d774f34d05c7089fc388f7407331b54eb46a\n\nWhy are you not using our `LOCK` macro?",
      "created_at": "2026-01-28T13:53:32Z",
      "updated_at": "2026-01-28T14:02:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34424#discussion_r2736746649",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736746649"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34424"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736780498",
      "pull_request_review_id": 3716804020,
      "id": 2736780498,
      "node_id": "PRRC_kwDOABII586jH_TS",
      "diff_hunk": "@@ -1153,6 +1153,10 @@ class ChainstateManager\n     //! @{\n     Chainstate& ActiveChainstate() const;\n     CChain& ActiveChain() const EXCLUSIVE_LOCKS_REQUIRED(GetMutex()) { return ActiveChainstate().m_chain; }\n+    CChain ActiveChainSnapshot() const {",
      "path": "src/validation.h",
      "position": 4,
      "original_position": 4,
      "commit_id": "bbbed4182d873017be1fd64537e20da2592e008e",
      "original_commit_id": "6b4db9640550b8f4cacc8debdb6eaf5a941885c9",
      "in_reply_to_id": null,
      "user": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In \"validation: add ActiveChainSnapshot() method\"  6b4db9640550b8f4cacc8debdb6eaf5a941885c9\n\nIt reduces lock contention, indeed, but one downside is that it can be inconvenient for someone who just wants to know, e.g., the chain tip to get height or hash in a concurrent way. They have to copy the whole chain.\n\nWe should also support copying the chain tip, and returning the latest block index in the chain, not copying the whole chain.",
      "created_at": "2026-01-28T14:00:49Z",
      "updated_at": "2026-01-28T14:02:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34424#discussion_r2736780498",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736780498"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34424"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1156,
      "original_line": 1156,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736877649",
      "pull_request_review_id": 3716988785,
      "id": 2736877649,
      "node_id": "PRRC_kwDOABII586jIXBR",
      "diff_hunk": "@@ -1153,6 +1153,10 @@ class ChainstateManager\n     //! @{\n     Chainstate& ActiveChainstate() const;\n     CChain& ActiveChain() const EXCLUSIVE_LOCKS_REQUIRED(GetMutex()) { return ActiveChainstate().m_chain; }\n+    CChain ActiveChainSnapshot() const {",
      "path": "src/validation.h",
      "position": 4,
      "original_position": 4,
      "commit_id": "bbbed4182d873017be1fd64537e20da2592e008e",
      "original_commit_id": "6b4db9640550b8f4cacc8debdb6eaf5a941885c9",
      "in_reply_to_id": 2736780498,
      "user": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Of course, they can use the old `ActiveChain`, lock and make a copy, but in my opinion, we should strive to make the locking of `cs_main` internal to `ChainstateManager` and simply return copies of these values. Future code should only handle locks directly in performance-critical paths where making a copy is too expensive, or in synchronous contexts where the caller already holds the lock.",
      "created_at": "2026-01-28T14:22:08Z",
      "updated_at": "2026-01-28T14:22:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34424#discussion_r2736877649",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736877649"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34424"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1156,
      "original_line": 1156,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736892071",
      "pull_request_review_id": 3717004103,
      "id": 2736892071,
      "node_id": "PRRC_kwDOABII586jIain",
      "diff_hunk": "@@ -1153,6 +1153,10 @@ class ChainstateManager\n     //! @{\n     Chainstate& ActiveChainstate() const;\n     CChain& ActiveChain() const EXCLUSIVE_LOCKS_REQUIRED(GetMutex()) { return ActiveChainstate().m_chain; }\n+    CChain ActiveChainSnapshot() const {",
      "path": "src/validation.h",
      "position": 4,
      "original_position": 4,
      "commit_id": "bbbed4182d873017be1fd64537e20da2592e008e",
      "original_commit_id": "6b4db9640550b8f4cacc8debdb6eaf5a941885c9",
      "in_reply_to_id": 2736780498,
      "user": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "For this RFC we chose to do a limited feature set. I agree that the end goal is something like you are describing. ",
      "created_at": "2026-01-28T14:25:19Z",
      "updated_at": "2026-01-28T14:25:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34424#discussion_r2736892071",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2736892071"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34424"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1156,
      "original_line": 1156,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2737460674",
      "pull_request_review_id": 3717699226,
      "id": 2737460674,
      "node_id": "PRRC_kwDOABII586jKlXC",
      "diff_hunk": "@@ -1153,6 +1153,10 @@ class ChainstateManager\n     //! @{",
      "path": "src/validation.h",
      "position": 1,
      "original_position": 1,
      "commit_id": "bbbed4182d873017be1fd64537e20da2592e008e",
      "original_commit_id": "6b4db9640550b8f4cacc8debdb6eaf5a941885c9",
      "in_reply_to_id": 2736725247,
      "user": {
        "login": "alexanderwiederin",
        "id": 37130778,
        "node_id": "MDQ6VXNlcjM3MTMwNzc4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37130778?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alexanderwiederin",
        "html_url": "https://github.com/alexanderwiederin",
        "followers_url": "https://api.github.com/users/alexanderwiederin/followers",
        "following_url": "https://api.github.com/users/alexanderwiederin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/alexanderwiederin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/alexanderwiederin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/alexanderwiederin/subscriptions",
        "organizations_url": "https://api.github.com/users/alexanderwiederin/orgs",
        "repos_url": "https://api.github.com/users/alexanderwiederin/repos",
        "events_url": "https://api.github.com/users/alexanderwiederin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/alexanderwiederin/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Thanks!",
      "created_at": "2026-01-28T16:27:22Z",
      "updated_at": "2026-01-28T16:27:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34424#discussion_r2737460674",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2737460674"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34424"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1153,
      "original_line": 1153,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2737462903",
      "pull_request_review_id": 3717702031,
      "id": 2737462903,
      "node_id": "PRRC_kwDOABII586jKl53",
      "diff_hunk": "@@ -15,12 +19,25 @@ std::string CBlockIndex::ToString() const\n \n void CChain::SetTip(CBlockIndex& block)\n {\n-    CBlockIndex* pindex = &block;\n-    vChain.resize(pindex->nHeight + 1);\n-    while (pindex && vChain[pindex->nHeight] != pindex) {\n-        vChain[pindex->nHeight] = pindex;\n-        pindex = pindex->pprev;\n+    std::lock_guard<std::mutex> lock(m_write_mutex);",
      "path": "src/chain.cpp",
      "position": 1,
      "original_position": 20,
      "commit_id": "be06d774f34d05c7089fc388f7407331b54eb46a",
      "original_commit_id": "be06d774f34d05c7089fc388f7407331b54eb46a",
      "in_reply_to_id": 2736746649,
      "user": {
        "login": "alexanderwiederin",
        "id": 37130778,
        "node_id": "MDQ6VXNlcjM3MTMwNzc4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37130778?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alexanderwiederin",
        "html_url": "https://github.com/alexanderwiederin",
        "followers_url": "https://api.github.com/users/alexanderwiederin/followers",
        "following_url": "https://api.github.com/users/alexanderwiederin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/alexanderwiederin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/alexanderwiederin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/alexanderwiederin/subscriptions",
        "organizations_url": "https://api.github.com/users/alexanderwiederin/orgs",
        "repos_url": "https://api.github.com/users/alexanderwiederin/repos",
        "events_url": "https://api.github.com/users/alexanderwiederin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/alexanderwiederin/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Implemented `LOCK` now. Thanks!",
      "created_at": "2026-01-28T16:27:46Z",
      "updated_at": "2026-01-28T16:27:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34424#discussion_r2737462903",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2737462903"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34424"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2737492299",
      "pull_request_review_id": 3717740204,
      "id": 2737492299,
      "node_id": "PRRC_kwDOABII586jKtFL",
      "diff_hunk": "@@ -0,0 +1,260 @@\n+// Copyright (c) 2013 Adobe\n+// Copyright (c) 2025-present The Bitcoin Core developers",
      "path": "src/util/copy_on_write.h",
      "position": 2,
      "original_position": 2,
      "commit_id": "bbbed4182d873017be1fd64537e20da2592e008e",
      "original_commit_id": "490324dd7a07dfc44bfbc06b57b0c36df29581eb",
      "in_reply_to_id": 2736742493,
      "user": {
        "login": "alexanderwiederin",
        "id": 37130778,
        "node_id": "MDQ6VXNlcjM3MTMwNzc4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37130778?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alexanderwiederin",
        "html_url": "https://github.com/alexanderwiederin",
        "followers_url": "https://api.github.com/users/alexanderwiederin/followers",
        "following_url": "https://api.github.com/users/alexanderwiederin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/alexanderwiederin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/alexanderwiederin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/alexanderwiederin/subscriptions",
        "organizations_url": "https://api.github.com/users/alexanderwiederin/orgs",
        "repos_url": "https://api.github.com/users/alexanderwiederin/repos",
        "events_url": "https://api.github.com/users/alexanderwiederin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/alexanderwiederin/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "It's practically a direct copy. I removed the comments, documentation and deprecated fields and methods to keep it minimal. I also left a link to https://github.com/stlab/stlab-copy-on-write on the file header and just added `Original source: https://github.com/stlab/stlab-copy-on-write/tree/abb4445` to the commit message. \r\n\r\nAgree on the unit tests for this!",
      "created_at": "2026-01-28T16:33:27Z",
      "updated_at": "2026-01-28T16:36:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34424#discussion_r2737492299",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2737492299"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34424"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2,
      "original_line": 2,
      "side": "RIGHT"
    }
  ]
}