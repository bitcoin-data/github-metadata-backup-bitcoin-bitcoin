{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661",
    "id": 2929620815,
    "node_id": "PR_kwDOABII586unndP",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/33661",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/33661.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/33661.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33661",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33661/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
    "number": 33661,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "test: Add test on skip heights in CBlockIndex",
    "user": {
      "login": "optout21",
      "id": 13562139,
      "node_id": "MDQ6VXNlcjEzNTYyMTM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/optout21",
      "html_url": "https://github.com/optout21",
      "followers_url": "https://api.github.com/users/optout21/followers",
      "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
      "organizations_url": "https://api.github.com/users/optout21/orgs",
      "repos_url": "https://api.github.com/users/optout21/repos",
      "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/optout21/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "The skip height values, used by `CBlockIndex::BuildSkip()` and `GetSkipHeight` are not tested and not well documented. (noticed while reviewing #33515, recently merged).\r\n\r\nThe motivation is to document the skip value computation through a test.\r\n\r\nThe first commit adds a test for the properties of the distribution of skip values, namely that they have non-uniform distribution: most values are small but there are some large ones as well.\r\n\r\nThe second commit adds low-level tests to the `GetSkipHeight()` internal method. The tests are low level, thus of limited value, and the commit also touches the non-test code minimally (to make the method accessible). Therefore this commit has lower priority.\r\n",
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      }
    ],
    "created_at": "2025-10-20T12:08:37Z",
    "updated_at": "2025-11-03T16:25:08Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "3e7be49a1b6d9c8c3e039f8122ad7f3f2b5822b3",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "optout21:skip-height-test2",
      "ref": "skip-height-test2",
      "sha": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1072154294,
        "node_id": "R_kgDOP-fGtg",
        "name": "bitcoin",
        "full_name": "optout21/bitcoin",
        "owner": {
          "login": "optout21",
          "id": 13562139,
          "node_id": "MDQ6VXNlcjEzNTYyMTM5",
          "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/optout21",
          "html_url": "https://github.com/optout21",
          "followers_url": "https://api.github.com/users/optout21/followers",
          "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
          "organizations_url": "https://api.github.com/users/optout21/orgs",
          "repos_url": "https://api.github.com/users/optout21/repos",
          "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/optout21/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/optout21/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/optout21/bitcoin",
        "archive_url": "https://api.github.com/repos/optout21/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/optout21/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/optout21/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/optout21/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/optout21/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/optout21/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/optout21/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/optout21/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/optout21/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/optout21/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/optout21/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/optout21/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/optout21/bitcoin/events",
        "forks_url": "https://api.github.com/repos/optout21/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/optout21/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/optout21/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/optout21/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/optout21/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/optout21/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/optout21/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/optout21/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/optout21/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/optout21/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/optout21/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/optout21/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/optout21/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/optout21/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/optout21/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/optout21/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:optout21/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/optout21/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/optout21/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/optout21/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/optout21/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/optout21/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/optout21/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/optout21/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/optout21/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/optout21/bitcoin/hooks",
        "svn_url": "https://github.com/optout21/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 251857,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-03T14:56:02Z",
        "created_at": "2025-10-08T10:33:29Z",
        "updated_at": "2025-10-08T10:33:29Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "746d36cc80f03c655f38620f55e6573daf13a3b1",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38149,
        "stargazers_count": 86595,
        "watchers_count": 86595,
        "size": 295526,
        "default_branch": "master",
        "open_issues_count": 737,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-03T16:37:47Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-11-03T16:37:58Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
      }
    },
    "author_association": "NONE",
    "draft": false,
    "additions": 88,
    "deletions": 1,
    "changed_files": 2,
    "commits": 2,
    "review_comments": 26,
    "comments": 5
  },
  "events": [
    {
      "event": "labeled",
      "id": 20378762485,
      "node_id": "LE_lADOABII587SiRz0zwAAAAS-qzz1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20378762485",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-20T12:08:41Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "commented",
      "id": 3421799444,
      "node_id": "IC_kwDOABII587L9IQU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3421799444",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-20T12:08:43Z",
      "updated_at": "2025-11-03T14:56:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33661.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [l0rinc](https://github.com/bitcoin/bitcoin/pull/33661#pullrequestreview-3407000419) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (âœ¨ experimental)\n\nPossible typos and grammar issues:\n\n- variouse -> various [spelling error in test comment]\n\n<sup>drahtbot_id_5_m</sup>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#issuecomment-3421799444",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33661"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20378870736,
      "node_id": "HRFPE_lADOABII587SiRz0zwAAAAS-rOPQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20378870736",
      "actor": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "commit_url": "https://api.github.com/repos/optout21/bitcoin/commits/6a22013f5aae2312a4a67b78773108a72146bdc7",
      "created_at": "2025-10-20T12:15:02Z"
    },
    {
      "event": "commented",
      "id": 3423668761,
      "node_id": "IC_kwDOABII587MEQoZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3423668761",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-20T20:48:08Z",
      "updated_at": "2025-10-20T20:48:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK, thanks for helping with the coverage and documentation.\r\nFor reference https://maflcko.github.io/b-c-cov/test_bitcoin.coverage/src/chain.cpp.gcov.html is pretty well covered otherwise, but these tests can help with the specifics.",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#issuecomment-3423668761",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33661"
    },
    {
      "event": "commented",
      "id": 3425525600,
      "node_id": "IC_kwDOABII587MLV9g",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3425525600",
      "actor": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-21T09:04:10Z",
      "updated_at": "2025-10-21T09:04:10Z",
      "author_association": "NONE",
      "body": "> For reference https://maflcko.github.io/b-c-cov/test_bitcoin.coverage/src/chain.cpp.gcov.html is pretty well covered otherwise, but these tests can help with the specifics.\r\n\r\nThanks for the link! Indirectly it is tested extensively, as the skip mechanism is used while searching in the chain. However, there are no tests focusing on this specifically, and the why and how on the exact skip generation algorithm is not documented.",
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#issuecomment-3425525600",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33661"
    },
    {
      "event": "ready_for_review",
      "id": 20620945396,
      "node_id": "RFRE_lADOABII587SiRz0zwAAAATNGqf0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20620945396",
      "actor": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-30T22:27:53Z"
    },
    {
      "event": "reviewed",
      "id": 3407000419,
      "node_id": "PRR_kwDOABII587LErNj",
      "url": null,
      "actor": null,
      "commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-03T12:33:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK, during review I also understood this behavior better :)\r\nI have a few suggestions for simplification and am throwing you into the deep end by asking for a property based (fuzz) test as well to check certain invariants. Not a must-have, but seems simple enough. I also suggest simplifying the distribution test to just check for the median instead.",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#pullrequestreview-3407000419",
      "submitted_at": "2025-11-03T12:33:05Z",
      "state": "CHANGES_REQUESTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDFkNjBlMmRhOGM0Y2QzNjQwYjdhNjRjZWY4ODgwY2ViOTk1Y2RkZTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1d60e2da8c4cd3640b7a64cef8880ceb995cdde0",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1d60e2da8c4cd3640b7a64cef8880ceb995cdde0",
      "tree": {
        "sha": "af2838d52a6fc485999ca18ae8296623ad5fe86b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/af2838d52a6fc485999ca18ae8296623ad5fe86b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0eeae4d174a41c3fc2eae41e76b929fa3114d6f3",
          "sha": "0eeae4d174a41c3fc2eae41e76b929fa3114d6f3",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0eeae4d174a41c3fc2eae41e76b929fa3114d6f3"
        }
      ],
      "message": "Add test on skip heights in CBlockIndex\n\nAdd unit tests for the properties of the skip height in CBlockIndex.\nSkip heights are set by CBlockIndex::BuildSkip(), which internally\nuses the GetSkipHeight() and InvertLowestOne() methods.\nThese methods don't have unit tests and are only minimally documented.\nThe new unit test collects and analyses the distribution of the skip\ndifference numbers, and checks some properties:\nnon-uniform distribution with most values small but\nwith some large values as well.",
      "committer": {
        "name": "optout",
        "email": "13562139+optout21@users.noreply.github.com",
        "date": "2025-11-03T14:52:33Z"
      },
      "author": {
        "name": "optout",
        "email": "13562139+optout21@users.noreply.github.com",
        "date": "2025-10-18T07:43:19Z"
      },
      "sha": "1d60e2da8c4cd3640b7a64cef8880ceb995cdde0"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE5Yjg3YThlOTA1OGY5NDY4NWRjNjhlN2I5MDkwYzJkNmNjYjk2MGY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "tree": {
        "sha": "2f8543ad8be25b11fec49b31ccd095323f5ead94",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2f8543ad8be25b11fec49b31ccd095323f5ead94"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1d60e2da8c4cd3640b7a64cef8880ceb995cdde0",
          "sha": "1d60e2da8c4cd3640b7a64cef8880ceb995cdde0",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1d60e2da8c4cd3640b7a64cef8880ceb995cdde0"
        }
      ],
      "message": "Add low-level tests for GetSkipHeight()\n\nThis internal method in chain.cpp has low and indirect test\ncoverage, and not documented well.\nA straightforward, simple, direct unit test is added.\nThe method is changed to be not static and inline, so that\nthe test can link with it.",
      "committer": {
        "name": "optout",
        "email": "13562139+optout21@users.noreply.github.com",
        "date": "2025-11-03T14:55:35Z"
      },
      "author": {
        "name": "optout",
        "email": "13562139+optout21@users.noreply.github.com",
        "date": "2025-10-18T10:44:56Z"
      },
      "sha": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20676996208,
      "node_id": "HRFPE_lADOABII587SiRz0zwAAAATQcexw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20676996208",
      "actor": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "commit_url": "https://api.github.com/repos/optout21/bitcoin/commits/19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "created_at": "2025-11-03T14:56:04Z"
    },
    {
      "event": "commented",
      "id": 3480999335,
      "node_id": "IC_kwDOABII587Pe9Wn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3480999335",
      "actor": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-03T15:02:19Z",
      "updated_at": "2025-11-03T15:02:19Z",
      "author_association": "NONE",
      "body": "Review comments addressed, mostly minor:\r\n\r\n- Reduce the number of iterations to 10000 (from 30000), for faster test execution.\r\n- Add comments on choice of test inputs.\r\n- Use BOOST_REQUIRE_EQUAL or BOOST_CHECK_GT where possible.",
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#issuecomment-3480999335",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33661"
    },
    {
      "event": "commented",
      "id": 3481005723,
      "node_id": "IC_kwDOABII587Pe-6b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3481005723",
      "actor": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-03T15:03:47Z",
      "updated_at": "2025-11-03T15:03:47Z",
      "author_association": "NONE",
      "body": "@sipa, as this is triggered by #33515 of yours, I would kindly ask for a review.",
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#issuecomment-3481005723",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33661"
    },
    {
      "event": "mentioned",
      "id": 20677187785,
      "node_id": "MEE_lADOABII587SiRz0zwAAAATQdNjJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20677187785",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-03T15:03:48Z"
    },
    {
      "event": "subscribed",
      "id": 20677187811,
      "node_id": "SE_lADOABII587SiRz0zwAAAATQdNjj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20677187811",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-03T15:03:48Z"
    },
    {
      "event": "review_requested",
      "id": 20677932786,
      "node_id": "RRE_lADOABII587SiRz0zwAAAATQgDby",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20677932786",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-03T15:32:31Z",
      "requested_reviewer": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2483243259",
      "pull_request_review_id": 3407000419,
      "id": 2483243259,
      "node_id": "PRRC_kwDOABII586UA0j7",
      "diff_hunk": "@@ -76,7 +76,7 @@ CBlockIndex* CChain::FindEarliestAtLeast(int64_t nTime, int height) const\n int static inline InvertLowestOne(int n) { return n & (n - 1); }\n \n /** Compute what height to jump back to with the CBlockIndex::pskip pointer. */\n-int static inline GetSkipHeight(int height) {\n+int GetSkipHeight(int height) {",
      "path": "src/chain.cpp",
      "position": 5,
      "original_position": 5,
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "ðŸ‘ for the static removal, but why remove the `inline` keyword?",
      "created_at": "2025-11-01T08:50:23Z",
      "updated_at": "2025-11-03T12:33:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2483243259",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2483243259"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 79,
      "original_line": 79,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2483265868",
      "pull_request_review_id": 3407000419,
      "id": 2483265868,
      "node_id": "PRRC_kwDOABII586UA6FM",
      "diff_hunk": "@@ -41,6 +41,57 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but\n+    // with some large values as well.\n+\n+    FastRandomContext ctx;",
      "path": "src/test/chain_tests.cpp",
      "position": 1,
      "original_position": 11,
      "commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "original_commit_id": "cdffd675d526bc0e1be85cfcd6b89ad1fe46cdfc",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This seems unused",
      "created_at": "2025-11-01T09:00:48Z",
      "updated_at": "2025-11-03T12:33:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2483265868",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2483265868"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 51,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486172116",
      "pull_request_review_id": 3407000419,
      "id": 2486172116,
      "node_id": "PRRC_kwDOABII586UL_nU",
      "diff_hunk": "@@ -76,7 +76,7 @@ CBlockIndex* CChain::FindEarliestAtLeast(int64_t nTime, int height) const\n int static inline InvertLowestOne(int n) { return n & (n - 1); }\n \n /** Compute what height to jump back to with the CBlockIndex::pskip pointer. */\n-int static inline GetSkipHeight(int height) {\n+int GetSkipHeight(int height) {\n     if (height < 2)",
      "path": "src/chain.cpp",
      "position": 6,
      "original_position": 6,
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: can this be `if (height <= 2)` as well? It's likely outside the scope of the change though",
      "created_at": "2025-11-03T11:34:24Z",
      "updated_at": "2025-11-03T12:33:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486172116",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486172116"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 80,
      "original_line": 80,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486181169",
      "pull_request_review_id": 3407000419,
      "id": 2486181169,
      "node_id": "PRRC_kwDOABII586UMB0x",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);",
      "path": "src/test/chain_tests.cpp",
      "position": 1,
      "original_position": 21,
      "commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "we could add comments explaining the magic values:\n\\# height <= 2\n\\# powers of 2\n\\# odd/even heights\n\\# absurdly big values or whatever\n\nOtherwise it's not obvious why 4 is 0 and 5 is 1 and there is no 6 but 7 is 1 again...\n\nI need to understand why we chose these numbers, especially since the PR is meant to document the change",
      "created_at": "2025-11-03T11:38:11Z",
      "updated_at": "2025-11-03T12:33:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486181169",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486181169"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 54,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486186460",
      "pull_request_review_id": 3407000419,
      "id": 2486186460,
      "node_id": "PRRC_kwDOABII586UMDHc",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);",
      "path": "src/test/chain_tests.cpp",
      "position": 1,
      "original_position": 15,
      "commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I like the binary representation, but maybe we could use `BOOST_CHECK_EQUAL` insead (helps with the reason when they fail) and maybe we could align these to simplify finding the differences in their endings:\n```C++\n    BOOST_CHECK_EQUAL(GetSkipHeight(0b0001011101101000),\n                                    0b0001011101100000);\n    BOOST_CHECK_EQUAL(GetSkipHeight(0b0001011101101001),\n                                    0b0001011101000001);\n    BOOST_CHECK_EQUAL(GetSkipHeight(0b0110101101011000),\n                                    0b0110101101010000);\n    BOOST_CHECK_EQUAL(GetSkipHeight(0b0110101101011001),\n                                    0b0110101101000001);\n```\n\nAnd a short comment could help in drawing our attention to the ending",
      "created_at": "2025-11-03T11:40:35Z",
      "updated_at": "2025-11-03T12:33:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486186460",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486186460"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 48,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486188243",
      "pull_request_review_id": 3407000419,
      "id": 2486188243,
      "node_id": "PRRC_kwDOABII586UMDjT",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);\n+    BOOST_CHECK(GetSkipHeight(3) == 1);\n+    BOOST_CHECK(GetSkipHeight(4) == 0);\n+    BOOST_CHECK(GetSkipHeight(5) == 1);\n+    BOOST_CHECK(GetSkipHeight(7) == 1);\n+    BOOST_CHECK(GetSkipHeight(8) == 0);\n+    BOOST_CHECK(GetSkipHeight(15) == 9);\n+    BOOST_CHECK(GetSkipHeight(16) == 0);\n+    BOOST_CHECK(GetSkipHeight(17) == 1);\n+    BOOST_CHECK(GetSkipHeight(256) == 0);\n+    BOOST_CHECK(GetSkipHeight(65536) == 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but",
      "path": "src/test/chain_tests.cpp",
      "position": 54,
      "original_position": 38,
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "it seems to test more than non-uniformity.\nMy understanding is that you want to show that most jumps are small, right?\nIf so, maybe we don't have to be that specific, can we just check that the median jump is tiny?\n\n```C++\nBOOST_AUTO_TEST_CASE(skip_height_properties_test)\n{\n    constexpr int n{30'000};\n\n    std::vector<std::unique_ptr<CBlockIndex>> block_index;\n    block_index.push_back(std::make_unique<CBlockIndex>());\n    for(int i{0}; i < n; ++i) {\n        auto new_index{std::make_unique<CBlockIndex>()};\n        new_index->pprev = block_index.back().get();\n        new_index->nHeight = new_index->pprev->nHeight + 1;\n        new_index->BuildSkip();\n        block_index.push_back(std::move(new_index));\n    }\n\n    std::vector<int> skip_diffs;\n    skip_diffs.reserve(n);\n    for(int i{1}; i <= n; ++i) {\n        skip_diffs.push_back(i - block_index[i]->pskip->nHeight);\n    }\n\n    std::ranges::sort(skip_diffs);\n    const int median{skip_diffs[n / 2]};\n    \n    BOOST_CHECK_LT(median, 10); // Most jumps are small\n}\n```",
      "created_at": "2025-11-03T11:41:23Z",
      "updated_at": "2025-11-03T12:33:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486188243",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486188243"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 87,
      "original_line": 87,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486192203",
      "pull_request_review_id": 3407000419,
      "id": 2486192203,
      "node_id": "PRRC_kwDOABII586UMEhL",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);\n+    BOOST_CHECK(GetSkipHeight(3) == 1);\n+    BOOST_CHECK(GetSkipHeight(4) == 0);\n+    BOOST_CHECK(GetSkipHeight(5) == 1);\n+    BOOST_CHECK(GetSkipHeight(7) == 1);\n+    BOOST_CHECK(GetSkipHeight(8) == 0);\n+    BOOST_CHECK(GetSkipHeight(15) == 9);\n+    BOOST_CHECK(GetSkipHeight(16) == 0);\n+    BOOST_CHECK(GetSkipHeight(17) == 1);\n+    BOOST_CHECK(GetSkipHeight(256) == 0);\n+    BOOST_CHECK(GetSkipHeight(65536) == 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but\n+    // with some large values as well.\n+\n+    FastRandomContext ctx;\n+    std::vector<std::unique_ptr<CBlockIndex>> block_index;\n+\n+    // Create genesis block\n+    auto genesis = std::make_unique<CBlockIndex>();\n+    genesis->nHeight = 0;\n+    block_index.push_back(std::move(genesis));\n+\n+    // Build a chain\n+    const auto n{30000};\n+    for(int i = 0; i < n; ++i) {\n+        auto new_index = std::make_unique<CBlockIndex>();\n+        new_index->pprev = block_index.back().get();\n+        BOOST_CHECK(new_index->pprev);\n+        new_index->nHeight = new_index->pprev->nHeight + 1;\n+        new_index->BuildSkip();\n+        block_index.push_back(std::move(new_index));\n+    }\n+\n+    // Analyze the diff (in height) of each element and its pskip",
      "path": "src/test/chain_tests.cpp",
      "position": 73,
      "original_position": 60,
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I need more context, how did we get to these numbers exactly?\r\nDo we really need to be this precise? Wouldn't it suffice to check that their median is low enough?",
      "created_at": "2025-11-03T11:43:08Z",
      "updated_at": "2025-11-03T12:34:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486192203",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486192203"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 106,
      "original_line": 106,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486214751",
      "pull_request_review_id": 3407000419,
      "id": 2486214751,
      "node_id": "PRRC_kwDOABII586UMKBf",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);\n+    BOOST_CHECK(GetSkipHeight(3) == 1);\n+    BOOST_CHECK(GetSkipHeight(4) == 0);\n+    BOOST_CHECK(GetSkipHeight(5) == 1);\n+    BOOST_CHECK(GetSkipHeight(7) == 1);\n+    BOOST_CHECK(GetSkipHeight(8) == 0);\n+    BOOST_CHECK(GetSkipHeight(15) == 9);\n+    BOOST_CHECK(GetSkipHeight(16) == 0);\n+    BOOST_CHECK(GetSkipHeight(17) == 1);\n+    BOOST_CHECK(GetSkipHeight(256) == 0);\n+    BOOST_CHECK(GetSkipHeight(65536) == 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but\n+    // with some large values as well.\n+\n+    FastRandomContext ctx;\n+    std::vector<std::unique_ptr<CBlockIndex>> block_index;\n+\n+    // Create genesis block\n+    auto genesis = std::make_unique<CBlockIndex>();\n+    genesis->nHeight = 0;\n+    block_index.push_back(std::move(genesis));\n+\n+    // Build a chain\n+    const auto n{30000};\n+    for(int i = 0; i < n; ++i) {\n+        auto new_index = std::make_unique<CBlockIndex>();\n+        new_index->pprev = block_index.back().get();\n+        BOOST_CHECK(new_index->pprev);\n+        new_index->nHeight = new_index->pprev->nHeight + 1;\n+        new_index->BuildSkip();\n+        block_index.push_back(std::move(new_index));\n+    }\n+\n+    // Analyze the diff (in height) of each element and its pskip\n+    int count_diff_smaller_16 = 0;\n+    int max_diff = 0;\n+    int total_diff = 0;\n+    for(int i = 1; i < n; ++i) {\n+        BOOST_CHECK(block_index[i]->nHeight == i);",
      "path": "src/test/chain_tests.cpp",
      "position": 1,
      "original_position": 65,
      "commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "this sounds like a `BOOST_REQUIRE_EQUAL` instead",
      "created_at": "2025-11-03T11:52:40Z",
      "updated_at": "2025-11-03T12:33:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486214751",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486214751"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 98,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486224185",
      "pull_request_review_id": 3407000419,
      "id": 2486224185,
      "node_id": "PRRC_kwDOABII586UMMU5",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);\n+    BOOST_CHECK(GetSkipHeight(3) == 1);\n+    BOOST_CHECK(GetSkipHeight(4) == 0);\n+    BOOST_CHECK(GetSkipHeight(5) == 1);\n+    BOOST_CHECK(GetSkipHeight(7) == 1);\n+    BOOST_CHECK(GetSkipHeight(8) == 0);\n+    BOOST_CHECK(GetSkipHeight(15) == 9);\n+    BOOST_CHECK(GetSkipHeight(16) == 0);\n+    BOOST_CHECK(GetSkipHeight(17) == 1);\n+    BOOST_CHECK(GetSkipHeight(256) == 0);\n+    BOOST_CHECK(GetSkipHeight(65536) == 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but\n+    // with some large values as well.\n+\n+    FastRandomContext ctx;\n+    std::vector<std::unique_ptr<CBlockIndex>> block_index;\n+\n+    // Create genesis block\n+    auto genesis = std::make_unique<CBlockIndex>();\n+    genesis->nHeight = 0;\n+    block_index.push_back(std::move(genesis));",
      "path": "src/test/chain_tests.cpp",
      "position": 1,
      "original_position": 47,
      "commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "maybe this would also work\n```suggestion\n    std::vector<std::unique_ptr<CBlockIndex>> block_index;\n    block_index.push_back(std::make_unique<CBlockIndex>());\n```",
      "created_at": "2025-11-03T11:55:43Z",
      "updated_at": "2025-11-03T12:33:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486224185",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486224185"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": 75,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 80,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486242198",
      "pull_request_review_id": 3407000419,
      "id": 2486242198,
      "node_id": "PRRC_kwDOABII586UMQuW",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);\n+    BOOST_CHECK(GetSkipHeight(3) == 1);\n+    BOOST_CHECK(GetSkipHeight(4) == 0);\n+    BOOST_CHECK(GetSkipHeight(5) == 1);\n+    BOOST_CHECK(GetSkipHeight(7) == 1);\n+    BOOST_CHECK(GetSkipHeight(8) == 0);\n+    BOOST_CHECK(GetSkipHeight(15) == 9);\n+    BOOST_CHECK(GetSkipHeight(16) == 0);\n+    BOOST_CHECK(GetSkipHeight(17) == 1);\n+    BOOST_CHECK(GetSkipHeight(256) == 0);\n+    BOOST_CHECK(GetSkipHeight(65536) == 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but\n+    // with some large values as well.\n+\n+    FastRandomContext ctx;\n+    std::vector<std::unique_ptr<CBlockIndex>> block_index;\n+\n+    // Create genesis block\n+    auto genesis = std::make_unique<CBlockIndex>();\n+    genesis->nHeight = 0;\n+    block_index.push_back(std::move(genesis));\n+\n+    // Build a chain\n+    const auto n{30000};",
      "path": "src/test/chain_tests.cpp",
      "position": 1,
      "original_position": 50,
      "commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "was wondering how slow this is, but seems acceptable:\n```bash\ncmake -B build  -DCMAKE_BUILD_TYPE=Debug && cmake --build build && time ./build/bin/test_bitcoin --run_test=chain_tests/skip_height_properties_test\n...\n./build/bin/test_bitcoin --run_test=chain_tests/skip_height_properties_test  0.32s user 0.02s system 27% cpu 1.269 total \n```",
      "created_at": "2025-11-03T12:02:49Z",
      "updated_at": "2025-11-03T12:33:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486242198",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486242198"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 83,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486256971",
      "pull_request_review_id": 3407000419,
      "id": 2486256971,
      "node_id": "PRRC_kwDOABII586UMUVL",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);\n+    BOOST_CHECK(GetSkipHeight(3) == 1);\n+    BOOST_CHECK(GetSkipHeight(4) == 0);\n+    BOOST_CHECK(GetSkipHeight(5) == 1);\n+    BOOST_CHECK(GetSkipHeight(7) == 1);\n+    BOOST_CHECK(GetSkipHeight(8) == 0);\n+    BOOST_CHECK(GetSkipHeight(15) == 9);\n+    BOOST_CHECK(GetSkipHeight(16) == 0);\n+    BOOST_CHECK(GetSkipHeight(17) == 1);\n+    BOOST_CHECK(GetSkipHeight(256) == 0);\n+    BOOST_CHECK(GetSkipHeight(65536) == 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but\n+    // with some large values as well.\n+\n+    FastRandomContext ctx;\n+    std::vector<std::unique_ptr<CBlockIndex>> block_index;\n+\n+    // Create genesis block\n+    auto genesis = std::make_unique<CBlockIndex>();\n+    genesis->nHeight = 0;\n+    block_index.push_back(std::move(genesis));\n+\n+    // Build a chain\n+    const auto n{30000};\n+    for(int i = 0; i < n; ++i) {\n+        auto new_index = std::make_unique<CBlockIndex>();\n+        new_index->pprev = block_index.back().get();\n+        BOOST_CHECK(new_index->pprev);\n+        new_index->nHeight = new_index->pprev->nHeight + 1;\n+        new_index->BuildSkip();\n+        block_index.push_back(std::move(new_index));\n+    }\n+\n+    // Analyze the diff (in height) of each element and its pskip\n+    int count_diff_smaller_16 = 0;\n+    int max_diff = 0;\n+    int total_diff = 0;\n+    for(int i = 1; i < n; ++i) {",
      "path": "src/test/chain_tests.cpp",
      "position": 77,
      "original_position": 64,
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "how come we're iterating one less than before?\n\n```suggestion\n    for(int i = 1; i <= n; ++i) {\n```",
      "created_at": "2025-11-03T12:07:36Z",
      "updated_at": "2025-11-03T12:33:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486256971",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486256971"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 110,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486262621",
      "pull_request_review_id": 3407000419,
      "id": 2486262621,
      "node_id": "PRRC_kwDOABII586UMVtd",
      "diff_hunk": "",
      "path": "src/chain.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Can we add a fuzz test that asserts for all h > 0: `GetSkipHeight(h)` < h and [popcount](https://en.cppreference.com/w/cpp/numeric/popcount.html)(result) < [popcount](https://en.cppreference.com/w/cpp/numeric/popcount.html)(h) (and just skip 0 since that's already unit tested)?",
      "created_at": "2025-11-03T12:09:52Z",
      "updated_at": "2025-11-03T12:35:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486262621",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486262621"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 86,
      "original_line": 86,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486416019",
      "pull_request_review_id": 3410937114,
      "id": 2486416019,
      "node_id": "PRRC_kwDOABII586UM7KT",
      "diff_hunk": "@@ -76,7 +76,7 @@ CBlockIndex* CChain::FindEarliestAtLeast(int64_t nTime, int height) const\n int static inline InvertLowestOne(int n) { return n & (n - 1); }\n \n /** Compute what height to jump back to with the CBlockIndex::pskip pointer. */\n-int static inline GetSkipHeight(int height) {\n+int GetSkipHeight(int height) {\n     if (height < 2)",
      "path": "src/chain.cpp",
      "position": 6,
      "original_position": 6,
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": 2486172116,
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Indeed, the input 2 also gives 0 as result. The intent may have been that got indices 0 and 1 it makes no sense to jump, for the rest follow the computation (but 2 accidentally also gives 0).\r\nIn any case, I don't want to change product behavior to the slightest in this PR.",
      "created_at": "2025-11-03T13:01:33Z",
      "updated_at": "2025-11-03T13:01:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486416019",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486416019"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 80,
      "original_line": 80,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486699478",
      "pull_request_review_id": 3411322792,
      "id": 2486699478,
      "node_id": "PRRC_kwDOABII586UOAXW",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);\n+    BOOST_CHECK(GetSkipHeight(3) == 1);\n+    BOOST_CHECK(GetSkipHeight(4) == 0);\n+    BOOST_CHECK(GetSkipHeight(5) == 1);\n+    BOOST_CHECK(GetSkipHeight(7) == 1);\n+    BOOST_CHECK(GetSkipHeight(8) == 0);\n+    BOOST_CHECK(GetSkipHeight(15) == 9);\n+    BOOST_CHECK(GetSkipHeight(16) == 0);\n+    BOOST_CHECK(GetSkipHeight(17) == 1);\n+    BOOST_CHECK(GetSkipHeight(256) == 0);\n+    BOOST_CHECK(GetSkipHeight(65536) == 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but\n+    // with some large values as well.\n+\n+    FastRandomContext ctx;\n+    std::vector<std::unique_ptr<CBlockIndex>> block_index;\n+\n+    // Create genesis block\n+    auto genesis = std::make_unique<CBlockIndex>();\n+    genesis->nHeight = 0;\n+    block_index.push_back(std::move(genesis));\n+\n+    // Build a chain\n+    const auto n{30000};\n+    for(int i = 0; i < n; ++i) {\n+        auto new_index = std::make_unique<CBlockIndex>();\n+        new_index->pprev = block_index.back().get();\n+        BOOST_CHECK(new_index->pprev);\n+        new_index->nHeight = new_index->pprev->nHeight + 1;\n+        new_index->BuildSkip();\n+        block_index.push_back(std::move(new_index));\n+    }\n+\n+    // Analyze the diff (in height) of each element and its pskip\n+    int count_diff_smaller_16 = 0;\n+    int max_diff = 0;\n+    int total_diff = 0;\n+    for(int i = 1; i < n; ++i) {",
      "path": "src/test/chain_tests.cpp",
      "position": 77,
      "original_position": 64,
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": 2486256971,
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "It doesn't make sense to check the skip for block index 0, that's why 0 is excluded.",
      "created_at": "2025-11-03T14:34:42Z",
      "updated_at": "2025-11-03T14:34:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486699478",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486699478"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 110,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486708184",
      "pull_request_review_id": 3411334707,
      "id": 2486708184,
      "node_id": "PRRC_kwDOABII586UOCfY",
      "diff_hunk": "@@ -76,7 +76,7 @@ CBlockIndex* CChain::FindEarliestAtLeast(int64_t nTime, int height) const\n int static inline InvertLowestOne(int n) { return n & (n - 1); }\n \n /** Compute what height to jump back to with the CBlockIndex::pskip pointer. */\n-int static inline GetSkipHeight(int height) {\n+int GetSkipHeight(int height) {",
      "path": "src/chain.cpp",
      "position": 5,
      "original_position": 5,
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": 2483243259,
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "If it's inlined, it can't be used as extern from the test :(",
      "created_at": "2025-11-03T14:37:16Z",
      "updated_at": "2025-11-03T14:37:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486708184",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486708184"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 79,
      "original_line": 79,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486733227",
      "pull_request_review_id": 3411367909,
      "id": 2486733227,
      "node_id": "PRRC_kwDOABII586UOImr",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);\n+    BOOST_CHECK(GetSkipHeight(3) == 1);\n+    BOOST_CHECK(GetSkipHeight(4) == 0);\n+    BOOST_CHECK(GetSkipHeight(5) == 1);\n+    BOOST_CHECK(GetSkipHeight(7) == 1);\n+    BOOST_CHECK(GetSkipHeight(8) == 0);\n+    BOOST_CHECK(GetSkipHeight(15) == 9);\n+    BOOST_CHECK(GetSkipHeight(16) == 0);\n+    BOOST_CHECK(GetSkipHeight(17) == 1);\n+    BOOST_CHECK(GetSkipHeight(256) == 0);\n+    BOOST_CHECK(GetSkipHeight(65536) == 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but",
      "path": "src/test/chain_tests.cpp",
      "position": 54,
      "original_position": 38,
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": 2486188243,
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I check the avg, which is computationally easier to obtain. It would make sense to check the median as well, and maybe compare the median with the average. However, I prefer to avoid the O(N log N) complexity of the sorting.",
      "created_at": "2025-11-03T14:44:38Z",
      "updated_at": "2025-11-03T14:44:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486733227",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486733227"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 87,
      "original_line": 87,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486736452",
      "pull_request_review_id": 3411372069,
      "id": 2486736452,
      "node_id": "PRRC_kwDOABII586UOJZE",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);\n+    BOOST_CHECK(GetSkipHeight(3) == 1);\n+    BOOST_CHECK(GetSkipHeight(4) == 0);\n+    BOOST_CHECK(GetSkipHeight(5) == 1);\n+    BOOST_CHECK(GetSkipHeight(7) == 1);\n+    BOOST_CHECK(GetSkipHeight(8) == 0);\n+    BOOST_CHECK(GetSkipHeight(15) == 9);\n+    BOOST_CHECK(GetSkipHeight(16) == 0);\n+    BOOST_CHECK(GetSkipHeight(17) == 1);\n+    BOOST_CHECK(GetSkipHeight(256) == 0);\n+    BOOST_CHECK(GetSkipHeight(65536) == 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but\n+    // with some large values as well.\n+\n+    FastRandomContext ctx;\n+    std::vector<std::unique_ptr<CBlockIndex>> block_index;\n+\n+    // Create genesis block\n+    auto genesis = std::make_unique<CBlockIndex>();\n+    genesis->nHeight = 0;\n+    block_index.push_back(std::move(genesis));\n+\n+    // Build a chain\n+    const auto n{30000};",
      "path": "src/test/chain_tests.cpp",
      "position": 1,
      "original_position": 50,
      "commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": 2486242198,
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Yes, nontheless I reduce the count from 30000 to 10000, that's also enough for the test.",
      "created_at": "2025-11-03T14:45:32Z",
      "updated_at": "2025-11-03T14:45:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486736452",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486736452"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 83,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486781519",
      "pull_request_review_id": 3411431905,
      "id": 2486781519,
      "node_id": "PRRC_kwDOABII586UOUZP",
      "diff_hunk": "@@ -41,6 +41,57 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but\n+    // with some large values as well.\n+\n+    FastRandomContext ctx;",
      "path": "src/test/chain_tests.cpp",
      "position": 1,
      "original_position": 11,
      "commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "original_commit_id": "cdffd675d526bc0e1be85cfcd6b89ad1fe46cdfc",
      "in_reply_to_id": 2483265868,
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Removed",
      "created_at": "2025-11-03T14:58:08Z",
      "updated_at": "2025-11-03T14:58:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486781519",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486781519"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 51,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486783350",
      "pull_request_review_id": 3411434435,
      "id": 2486783350,
      "node_id": "PRRC_kwDOABII586UOU12",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);",
      "path": "src/test/chain_tests.cpp",
      "position": 1,
      "original_position": 21,
      "commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": 2486181169,
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I've adjusted the numbers used and added comments",
      "created_at": "2025-11-03T14:58:45Z",
      "updated_at": "2025-11-03T14:58:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486783350",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486783350"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 54,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486784728",
      "pull_request_review_id": 3411436566,
      "id": 2486784728,
      "node_id": "PRRC_kwDOABII586UOVLY",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);",
      "path": "src/test/chain_tests.cpp",
      "position": 1,
      "original_position": 15,
      "commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": 2486186460,
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Changed to `BOOST_CHECK_EQUAL`, added comments",
      "created_at": "2025-11-03T14:59:13Z",
      "updated_at": "2025-11-03T14:59:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486784728",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486784728"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 48,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486787928",
      "pull_request_review_id": 3411441256,
      "id": 2486787928,
      "node_id": "PRRC_kwDOABII586UOV9Y",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);\n+    BOOST_CHECK(GetSkipHeight(3) == 1);\n+    BOOST_CHECK(GetSkipHeight(4) == 0);\n+    BOOST_CHECK(GetSkipHeight(5) == 1);\n+    BOOST_CHECK(GetSkipHeight(7) == 1);\n+    BOOST_CHECK(GetSkipHeight(8) == 0);\n+    BOOST_CHECK(GetSkipHeight(15) == 9);\n+    BOOST_CHECK(GetSkipHeight(16) == 0);\n+    BOOST_CHECK(GetSkipHeight(17) == 1);\n+    BOOST_CHECK(GetSkipHeight(256) == 0);\n+    BOOST_CHECK(GetSkipHeight(65536) == 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but\n+    // with some large values as well.\n+\n+    FastRandomContext ctx;\n+    std::vector<std::unique_ptr<CBlockIndex>> block_index;\n+\n+    // Create genesis block\n+    auto genesis = std::make_unique<CBlockIndex>();\n+    genesis->nHeight = 0;\n+    block_index.push_back(std::move(genesis));",
      "path": "src/test/chain_tests.cpp",
      "position": 1,
      "original_position": 47,
      "commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": 2486224185,
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-11-03T15:00:15Z",
      "updated_at": "2025-11-03T15:00:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2486787928",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2486787928"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": 75,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 80,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2487011524",
      "pull_request_review_id": 3411731190,
      "id": 2487011524,
      "node_id": "PRRC_kwDOABII586UPMjE",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);\n+    BOOST_CHECK(GetSkipHeight(3) == 1);\n+    BOOST_CHECK(GetSkipHeight(4) == 0);\n+    BOOST_CHECK(GetSkipHeight(5) == 1);\n+    BOOST_CHECK(GetSkipHeight(7) == 1);\n+    BOOST_CHECK(GetSkipHeight(8) == 0);\n+    BOOST_CHECK(GetSkipHeight(15) == 9);\n+    BOOST_CHECK(GetSkipHeight(16) == 0);\n+    BOOST_CHECK(GetSkipHeight(17) == 1);\n+    BOOST_CHECK(GetSkipHeight(256) == 0);\n+    BOOST_CHECK(GetSkipHeight(65536) == 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but\n+    // with some large values as well.\n+\n+    FastRandomContext ctx;\n+    std::vector<std::unique_ptr<CBlockIndex>> block_index;\n+\n+    // Create genesis block\n+    auto genesis = std::make_unique<CBlockIndex>();\n+    genesis->nHeight = 0;\n+    block_index.push_back(std::move(genesis));\n+\n+    // Build a chain\n+    const auto n{30000};\n+    for(int i = 0; i < n; ++i) {\n+        auto new_index = std::make_unique<CBlockIndex>();\n+        new_index->pprev = block_index.back().get();\n+        BOOST_CHECK(new_index->pprev);\n+        new_index->nHeight = new_index->pprev->nHeight + 1;\n+        new_index->BuildSkip();\n+        block_index.push_back(std::move(new_index));\n+    }\n+\n+    // Analyze the diff (in height) of each element and its pskip\n+    int count_diff_smaller_16 = 0;\n+    int max_diff = 0;\n+    int total_diff = 0;\n+    for(int i = 1; i < n; ++i) {",
      "path": "src/test/chain_tests.cpp",
      "position": 77,
      "original_position": 64,
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": 2486256971,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "yeah, but why is n skipped (see my suggested code)",
      "created_at": "2025-11-03T16:01:23Z",
      "updated_at": "2025-11-03T16:01:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2487011524",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2487011524"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 110,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2487015862",
      "pull_request_review_id": 3411737545,
      "id": 2487015862,
      "node_id": "PRRC_kwDOABII586UPNm2",
      "diff_hunk": "@@ -76,7 +76,7 @@ CBlockIndex* CChain::FindEarliestAtLeast(int64_t nTime, int height) const\n int static inline InvertLowestOne(int n) { return n & (n - 1); }\n \n /** Compute what height to jump back to with the CBlockIndex::pskip pointer. */\n-int static inline GetSkipHeight(int height) {\n+int GetSkipHeight(int height) {",
      "path": "src/chain.cpp",
      "position": 5,
      "original_position": 5,
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": 2483243259,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "how so, what's the failure you're seeing? It was working for me locally ",
      "created_at": "2025-11-03T16:02:35Z",
      "updated_at": "2025-11-03T16:02:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2487015862",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2487015862"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 79,
      "original_line": 79,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2487024773",
      "pull_request_review_id": 3411750247,
      "id": 2487024773,
      "node_id": "PRRC_kwDOABII586UPPyF",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);\n+    BOOST_CHECK(GetSkipHeight(3) == 1);\n+    BOOST_CHECK(GetSkipHeight(4) == 0);\n+    BOOST_CHECK(GetSkipHeight(5) == 1);\n+    BOOST_CHECK(GetSkipHeight(7) == 1);\n+    BOOST_CHECK(GetSkipHeight(8) == 0);\n+    BOOST_CHECK(GetSkipHeight(15) == 9);\n+    BOOST_CHECK(GetSkipHeight(16) == 0);\n+    BOOST_CHECK(GetSkipHeight(17) == 1);\n+    BOOST_CHECK(GetSkipHeight(256) == 0);\n+    BOOST_CHECK(GetSkipHeight(65536) == 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but",
      "path": "src/test/chain_tests.cpp",
      "position": 54,
      "original_position": 38,
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": 2486188243,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "median is less sensitive to outliers  - and nlogn is fine in tests",
      "created_at": "2025-11-03T16:05:13Z",
      "updated_at": "2025-11-03T16:05:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2487024773",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2487024773"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 87,
      "original_line": 87,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2487089474",
      "pull_request_review_id": 3411848203,
      "id": 2487089474,
      "node_id": "PRRC_kwDOABII586UPflC",
      "diff_hunk": "@@ -76,7 +76,7 @@ CBlockIndex* CChain::FindEarliestAtLeast(int64_t nTime, int height) const\n int static inline InvertLowestOne(int n) { return n & (n - 1); }\n \n /** Compute what height to jump back to with the CBlockIndex::pskip pointer. */\n-int static inline GetSkipHeight(int height) {\n+int GetSkipHeight(int height) {",
      "path": "src/chain.cpp",
      "position": 5,
      "original_position": 5,
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": 2483243259,
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "If `GetSkipHeight` is `inline`, I get the error:\r\n\r\n```\r\n[ 75%] Built target bitcoin-node\r\n/usr/bin/ld: CMakeFiles/test_bitcoin.dir/chain_tests.cpp.o: in function `chain_tests::get_skip_height_test::test_method()':\r\n/home/bitcoin/bitcoin-core/build/src/test/./test/chain_tests.cpp:50:(.text+0x68b): undefined reference to `GetSkipHeight(int)'\r\n/usr/bin/ld: /home/bitcoin/bitcoin-core/build/src/test/./test/chain_tests.cpp:51:(.text+0x7cf): undefined reference to `GetSkipHeight(int)'\r\n/usr/bin/ld: /home/bitcoin/bitcoin-core/build/src/test/./test/chain_tests.cpp:52:(.text+0x90c): undefined reference to `GetSkipHeight(int)'\r\n/usr/bin/ld: /home/bitcoin/bitcoin-core/build/src/test/./test/chain_tests.cpp:53:(.text+0xa49): undefined reference to `GetSkipHeight(int)'\r\n/usr/bin/ld: /home/bitcoin/bitcoin-core/build/src/test/./test/chain_tests.cpp:54:(.text+0xb86): undefined reference to `GetSkipHeight(int)'\r\n/usr/bin/ld: CMakeFiles/test_bitcoin.dir/chain_tests.cpp.o:/home/bitcoin/bitcoin-core/build/src/test/./test/chain_tests.cpp:55: more undefined references to `GetSkipHeight(int)' follow\r\ncollect2: error: ld returned 1 exit status\r\ngmake[2]: *** [src/test/CMakeFiles/test_bitcoin.dir/build.make:2463: bin/test_bitcoin] Error 1\r\n```\r\n\r\nInlined method is not included in the obj file as a method.\r\nThe solution would be to expose it through the header file, but I did not want to make that change just for the sake of the test.",
      "created_at": "2025-11-03T16:22:07Z",
      "updated_at": "2025-11-03T16:22:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2487089474",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2487089474"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 79,
      "original_line": 79,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2487099898",
      "pull_request_review_id": 3411862703,
      "id": 2487099898,
      "node_id": "PRRC_kwDOABII586UPiH6",
      "diff_hunk": "@@ -41,6 +43,78 @@ const CBlockIndex* NaiveLastCommonAncestor(const CBlockIndex* a, const CBlockInd\n \n } // namespace\n \n+BOOST_AUTO_TEST_CASE(get_skip_height_test)\n+{\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101000) == 0b0001011101100000);\n+    BOOST_CHECK(GetSkipHeight(0b0001011101101001) == 0b0001011101000001);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011000) == 0b0110101101010000);\n+    BOOST_CHECK(GetSkipHeight(0b0110101101011001) == 0b0110101101000001);\n+    BOOST_CHECK(GetSkipHeight(0) == 0);\n+    BOOST_CHECK(GetSkipHeight(1) == 0);\n+    BOOST_CHECK(GetSkipHeight(2) == 0);\n+    BOOST_CHECK(GetSkipHeight(3) == 1);\n+    BOOST_CHECK(GetSkipHeight(4) == 0);\n+    BOOST_CHECK(GetSkipHeight(5) == 1);\n+    BOOST_CHECK(GetSkipHeight(7) == 1);\n+    BOOST_CHECK(GetSkipHeight(8) == 0);\n+    BOOST_CHECK(GetSkipHeight(15) == 9);\n+    BOOST_CHECK(GetSkipHeight(16) == 0);\n+    BOOST_CHECK(GetSkipHeight(17) == 1);\n+    BOOST_CHECK(GetSkipHeight(256) == 0);\n+    BOOST_CHECK(GetSkipHeight(65536) == 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(skip_height_properties_test)\n+{\n+    // The test collects and analyses the distribution of the\n+    // skip difference numbers, and checks some properties:\n+    // non-uniform distribution with most values small but\n+    // with some large values as well.\n+\n+    FastRandomContext ctx;\n+    std::vector<std::unique_ptr<CBlockIndex>> block_index;\n+\n+    // Create genesis block\n+    auto genesis = std::make_unique<CBlockIndex>();\n+    genesis->nHeight = 0;\n+    block_index.push_back(std::move(genesis));\n+\n+    // Build a chain\n+    const auto n{30000};\n+    for(int i = 0; i < n; ++i) {\n+        auto new_index = std::make_unique<CBlockIndex>();\n+        new_index->pprev = block_index.back().get();\n+        BOOST_CHECK(new_index->pprev);\n+        new_index->nHeight = new_index->pprev->nHeight + 1;\n+        new_index->BuildSkip();\n+        block_index.push_back(std::move(new_index));\n+    }\n+\n+    // Analyze the diff (in height) of each element and its pskip\n+    int count_diff_smaller_16 = 0;\n+    int max_diff = 0;\n+    int total_diff = 0;\n+    for(int i = 1; i < n; ++i) {",
      "path": "src/test/chain_tests.cpp",
      "position": 77,
      "original_position": 64,
      "commit_id": "19b87a8e9058f94685dc68e7b9090c2d6ccb960f",
      "original_commit_id": "6a22013f5aae2312a4a67b78773108a72146bdc7",
      "in_reply_to_id": 2486256971,
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Oh, I see. There are in fact n+1 elements. Will change.",
      "created_at": "2025-11-03T16:25:08Z",
      "updated_at": "2025-11-03T16:25:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33661#discussion_r2487099898",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2487099898"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33661"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 110,
      "original_line": 110,
      "side": "RIGHT"
    }
  ]
}