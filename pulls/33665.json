{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665",
    "id": 2932265719,
    "node_id": "PR_kwDOABII586uxtL3",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/33665",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/33665.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/33665.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33665",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33665/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/53b84813e0de9c85640cb82a85fd1fd5b0d35504",
    "number": 33665,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "wallet: refactor to remove redundant sighash calculation",
    "user": {
      "login": "rkrux",
      "id": 5960750,
      "node_id": "MDQ6VXNlcjU5NjA3NTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkrux",
      "html_url": "https://github.com/rkrux",
      "followers_url": "https://api.github.com/users/rkrux/followers",
      "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
      "organizations_url": "https://api.github.com/users/rkrux/orgs",
      "repos_url": "https://api.github.com/users/rkrux/repos",
      "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/rkrux/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "In the MuSig2 signing flow, the same sighash ends up being recalculated for all the participant public keys involved in the MuSig aggregate keys. This happens for all the three parts of the signing flow: nonce, partial sig, and aggregate sig.\r\n\r\nThe original intent of this refactor to reduce seeing duplicate code, but it should also help in improving performance of the wallet signing operations.\r\n\r\nThis was highlighted during the review of the MuSig2\r\nsigning PR: https://github.com/bitcoin/bitcoin/pull/29675#discussion_r2382674470\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      }
    ],
    "created_at": "2025-10-21T07:17:34Z",
    "updated_at": "2025-10-21T08:31:00Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "0d272506f9a84fd7faa9ebd0d66f9f550bddc9b7",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "rkrux:musig-sighash",
      "ref": "musig-sighash",
      "sha": "53b84813e0de9c85640cb82a85fd1fd5b0d35504",
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 885267588,
        "node_id": "R_kgDONMQchA",
        "name": "bitcoin",
        "full_name": "rkrux/bitcoin",
        "owner": {
          "login": "rkrux",
          "id": 5960750,
          "node_id": "MDQ6VXNlcjU5NjA3NTA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/rkrux",
          "html_url": "https://github.com/rkrux",
          "followers_url": "https://api.github.com/users/rkrux/followers",
          "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
          "organizations_url": "https://api.github.com/users/rkrux/orgs",
          "repos_url": "https://api.github.com/users/rkrux/repos",
          "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/rkrux/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/rkrux/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/rkrux/bitcoin",
        "archive_url": "https://api.github.com/repos/rkrux/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/rkrux/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/rkrux/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/rkrux/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/rkrux/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/rkrux/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/rkrux/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/rkrux/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/rkrux/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/rkrux/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/rkrux/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/rkrux/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/rkrux/bitcoin/events",
        "forks_url": "https://api.github.com/repos/rkrux/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/rkrux/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/rkrux/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/rkrux/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/rkrux/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/rkrux/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/rkrux/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/rkrux/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/rkrux/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/rkrux/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/rkrux/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/rkrux/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/rkrux/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/rkrux/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/rkrux/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/rkrux/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:rkrux/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/rkrux/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/rkrux/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/rkrux/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/rkrux/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/rkrux/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/rkrux/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/rkrux/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/rkrux/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/rkrux/bitcoin/hooks",
        "svn_url": "https://github.com/rkrux/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 251814,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-10-21T07:20:23Z",
        "created_at": "2024-11-08T09:18:33Z",
        "updated_at": "2025-10-18T07:39:46Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "0eeae4d174a41c3fc2eae41e76b929fa3114d6f3",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38056,
        "stargazers_count": 86330,
        "watchers_count": 86330,
        "size": 295074,
        "default_branch": "master",
        "open_issues_count": 816,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-10-21T08:44:17Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-10-21T08:44:28Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": true,
    "additions": 36,
    "deletions": 35,
    "changed_files": 2,
    "commits": 1,
    "review_comments": 0,
    "comments": 2
  },
  "events": [
    {
      "event": "labeled",
      "id": 20396636209,
      "node_id": "LE_lADOABII587St3rDzwAAAAS_u_gx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20396636209",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-21T07:17:38Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "commented",
      "id": 3425109961,
      "node_id": "IC_kwDOABII587MJwfJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3425109961",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-21T07:17:40Z",
      "updated_at": "2025-10-21T07:17:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33665.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3425109961",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33665"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20396688946,
      "node_id": "HRFPE_lADOABII587St3rDzwAAAAS_vMYy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20396688946",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "54a37dde6132e66c3e35829b45ebcd00234ccaee",
      "commit_url": "https://api.github.com/repos/rkrux/bitcoin/commits/54a37dde6132e66c3e35829b45ebcd00234ccaee",
      "created_at": "2025-10-21T07:19:38Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDUzYjg0ODEzZTBkZTljODU2NDBjYjgyYTg1ZmQxZmQ1YjBkMzU1MDQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/53b84813e0de9c85640cb82a85fd1fd5b0d35504",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/53b84813e0de9c85640cb82a85fd1fd5b0d35504",
      "tree": {
        "sha": "849ca6118f51d70c175b30592a464ae7e81ffa83",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/849ca6118f51d70c175b30592a464ae7e81ffa83"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 849ca6118f51d70c175b30592a464ae7e81ffa83\nparent d30f149360d10de31bd7f7369aa61ce8be0837b5\nauthor rkrux <rkrux.connect@gmail.com> 1761030651 +0530\ncommitter rkrux <rkrux.connect@gmail.com> 1761031205 +0530\n\nwallet: refactor to remove redundant sighash calculation\n\nIn the MuSig2 signing flow, the same sighash ends up being\nrecalculated for all the participant public keys involved\nin the MuSig aggregate keys. This happens for all the\nthree parts of the signing flow: nonce, partial sig, and\naggregate sig.\n\nThe original intent of this refactor to reduce seeing\nduplicate code, but it should also help in improving\nperformance of the wallet signing operations.\n\nThis was highlighted during the review of the MuSig2\nsigning PR: https://github.com/bitcoin/bitcoin/pull/29675#discussion_r2382674470\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE4A+pXu3+M+6FwdOqhhS4vS4UTG0FAmj3NDIACgkQhhS4vS4U\nTG1FuQ//cY6h9kB5XrwMhHhLdrQ/o2L5Nr7Da9Kg+RBIoDB/S54nUjcL31LPmu9v\n9REyFkiIIS9kUgPT2+nQXSh9PEWuy/kUDPk1AcvQG/tsf9dvItTXic1Wi1ZbTF7a\nZM+NOdyZymo1zkjm/jNlUOcTiCyl6IXKLEg8gHZaDnaAqPkeXqz/Xmj3SjjgzPyH\nuJQ+qpTbhc5tDPUimAEllKMePcHYLpnywYhOcAsA8wV9rEtke55aQuIe04xgWmvW\n4nRl0aAE1Q9D3bnLNgdhP1yZRkbsQALqWMGZKMlELTxOz+iJQ0lWfV6F8sOJ7L5/\nmmz0OXJQTVvmPg4V/zjoLsJPBGJK2JIDVAsdinL6BnY265BBcb+8HRWX0R7Dvo3E\nr4NWFnYGE+Raf+zXsOmrWan5I2CttmhHoEmYAUx0k3I3ihnUzwjHdP7/8WbjhDNa\nVMDrKuLWOF+BCYURCSU9qikUR4h95Fj0+3fYFEv3VjiEO0Ccb/n8/XRhZkOz5QJJ\ndYUvGjnyLkj26ErVF8At+NQCCL4Y7xjAYr/IhlO7LTrZ1G3nl08XYvqkoy7xBxKu\nrt4BuPWUfRj2mA8k09Tsz/Fsa4x8RFnyfleHHECDKyOaPOZ0oYvPilmSPjuzTLfS\nl4FU/xMtVGUPaP7Xt/deRHy3zGoM/GSs//L8jSBiIKdR+bmTMRE=\n=s/0u\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d30f149360d10de31bd7f7369aa61ce8be0837b5",
          "sha": "d30f149360d10de31bd7f7369aa61ce8be0837b5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d30f149360d10de31bd7f7369aa61ce8be0837b5"
        }
      ],
      "message": "wallet: refactor to remove redundant sighash calculation\n\nIn the MuSig2 signing flow, the same sighash ends up being\nrecalculated for all the participant public keys involved\nin the MuSig aggregate keys. This happens for all the\nthree parts of the signing flow: nonce, partial sig, and\naggregate sig.\n\nThe original intent of this refactor to reduce seeing\nduplicate code, but it should also help in improving\nperformance of the wallet signing operations.\n\nThis was highlighted during the review of the MuSig2\nsigning PR: https://github.com/bitcoin/bitcoin/pull/29675#discussion_r2382674470",
      "committer": {
        "name": "rkrux",
        "email": "rkrux.connect@gmail.com",
        "date": "2025-10-21T07:20:05Z"
      },
      "author": {
        "name": "rkrux",
        "email": "rkrux.connect@gmail.com",
        "date": "2025-10-21T07:10:51Z"
      },
      "sha": "53b84813e0de9c85640cb82a85fd1fd5b0d35504"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20396715385,
      "node_id": "HRFPE_lADOABII587St3rDzwAAAAS_vS15",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20396715385",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "53b84813e0de9c85640cb82a85fd1fd5b0d35504",
      "commit_url": "https://api.github.com/repos/rkrux/bitcoin/commits/53b84813e0de9c85640cb82a85fd1fd5b0d35504",
      "created_at": "2025-10-21T07:20:25Z"
    },
    {
      "event": "commented",
      "id": 3425407567,
      "node_id": "IC_kwDOABII587MK5JP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3425407567",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-21T08:31:00Z",
      "updated_at": "2025-10-21T08:31:00Z",
      "author_association": "MEMBER",
      "body": "https://github.com/bitcoin/bitcoin/actions/runs/18676072881/job/53246386885?pr=33665#step:9:3427:\r\n```bash\r\nRun script_sign with args ['/home/admin/actions-runner/_work/_temp/build/bin/fuzz', '-runs=1', PosixPath('/home/admin/actions-runner/_work/_temp/ci/scratch/qa-assets/fuzz_corpora/script_sign')]INFO: Running with entropic power schedule (0xFF, 100).\r\nINFO: Seed: 2902865681\r\nINFO: Loaded 1 modules   (615865 inline 8-bit counters): 615865 [0x56e10e6f9bb8, 0x56e10e790171), \r\nINFO: Loaded 1 PC tables (615865 PCs): 615865 [0x56e10e790178,0x56e10f0f5d08), \r\nINFO:     4186 files found in /home/admin/actions-runner/_work/_temp/ci/scratch/qa-assets/fuzz_corpora/script_sign\r\nINFO: -max_len is not provided; libFuzzer will not generate inputs larger than 938660 bytes\r\nINFO: seed corpus: files: 4186 min: 9b max: 938660b total: 57347949b rss: 105Mb\r\n#1024\tpulse  cov: 12906 ft: 62748 corp: 979/178Kb exec/s: 512 rss: 162Mb\r\n/home/admin/actions-runner/_work/_temp/src/script/sign.cpp:84:60: runtime error: implicit conversion from type 'int' of value -2147483648 (32-bit, signed) to type 'uint8_t' (aka 'unsigned char') changed the value to 0 (8-bit, unsigned)\r\n    #0 0x56e10bf84088 in MutableTransactionSignatureCreator::ComputeSchnorrSignatureHash(uint256 const*, SigVersion) const /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:84:60\r\n    #1 0x56e10bf9f6d7 in SignMuSig2(BaseSignatureCreator const&, SignatureData&, SigningProvider const&, std::vector<unsigned char, std::allocator<unsigned char>>&, XOnlyPubKey const&, uint256 const*, uint256 const*, SigVersion) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:285:46\r\n    #2 0x56e10bf8bdd9 in SignTaproot(SigningProvider const&, BaseSignatureCreator const&, WitnessV1Taproot const&, SignatureData&, std::vector<std::vector<unsigned char, std::allocator<unsigned char>>, std::allocator<std::vector<unsigned char, std::allocator<unsigned char>>>>&)::$_0::operator()(XOnlyPubKey const&, uint256 const*) const /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:581:17\r\n    #3 0x56e10bf8bdd9 in SignTaproot(SigningProvider const&, BaseSignatureCreator const&, WitnessV1Taproot const&, SignatureData&, std::vector<std::vector<unsigned char, std::allocator<unsigned char>>, std::allocator<std::vector<unsigned char, std::allocator<unsigned char>>>>&) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:587:13\r\n    #4 0x56e10bf8bdd9 in SignStep(SigningProvider const&, BaseSignatureCreator const&, CScript const&, std::vector<std::vector<unsigned char, std::allocator<unsigned char>>, std::allocator<std::vector<unsigned char, std::allocator<unsigned char>>>>&, TxoutType&, SigVersion, SignatureData&) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:703:16\r\n    #5 0x56e10bf86e4c in ProduceSignature(SigningProvider const&, BaseSignatureCreator const&, CScript const&, SignatureData&) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:734:19\r\n    #6 0x56e10bf956de in SignTransaction(CMutableTransaction&, SigningProvider const*, std::map<COutPoint, Coin, std::less<COutPoint>, std::allocator<std::pair<COutPoint const, Coin>>> const&, int, std::map<int, bilingual_str, std::less<int>, std::allocator<std::pair<int const, bilingual_str>>>&) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:1050:13\r\n    #7 0x56e10b9c040e in script_sign_fuzz_target(std::span<unsigned char const, 18446744073709551615ul>) /home/admin/actions-runner/_work/_temp/build/src/test/fuzz/./test/fuzz/script_sign.cpp:135:19\r\n    #8 0x56e10bc78e9e in std::function<void (std::span<unsigned char const, 18446744073709551615ul>)>::operator()(std::span<unsigned char const, 18446744073709551615ul>) const /usr/lib/gcc/x86_64-linux-gnu/13/../../../../include/c++/13/bits/std_function.h:591:9\r\n    #9 0x56e10bc78e9e in test_one_input(std::span<unsigned char const, 18446744073709551615ul>) /home/admin/actions-runner/_work/_temp/build/src/test/fuzz/util/./test/fuzz/fuzz.cpp:88:5\r\n    #10 0x56e10bc78e9e in LLVMFuzzerTestOneInput /home/admin/actions-runner/_work/_temp/build/src/test/fuzz/util/./test/fuzz/fuzz.cpp:216:5\r\n    #11 0x56e10b28521f in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1ab321f) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #12 0x56e10b284829 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1ab2829) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #13 0x56e10b286592 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1ab4592) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #14 0x56e10b286ab0 in fuzzer::Fuzzer::Loop(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1ab4ab0) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #15 0x56e10b273135 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1aa1135) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #16 0x56e10b29f4f6 in main (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1acd4f6) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #17 0x7318303981c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 274eec488d230825a136fa9c4d85370fed7a0a5e)\r\n    #18 0x73183039828a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 274eec488d230825a136fa9c4d85370fed7a0a5e)\r\n    #19 0x56e10b267704 in _start (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1a95704) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n```",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3425407567",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33665"
    }
  ],
  "comments": []
}