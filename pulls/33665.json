{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665",
    "id": 2932265719,
    "node_id": "PR_kwDOABII586uxtL3",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/33665",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/33665.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/33665.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33665",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33665/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/ac4a593ff0f1ff0482b4abf1568f495a07183741",
    "number": 33665,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "wallet: remove redundant sighash calculation in Musig2 signing flow",
    "user": {
      "login": "rkrux",
      "id": 5960750,
      "node_id": "MDQ6VXNlcjU5NjA3NTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkrux",
      "html_url": "https://github.com/rkrux",
      "followers_url": "https://api.github.com/users/rkrux/followers",
      "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
      "organizations_url": "https://api.github.com/users/rkrux/orgs",
      "repos_url": "https://api.github.com/users/rkrux/repos",
      "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/rkrux/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "In the MuSig2 signing flow, the same sighash ends up being recalculated for all the participant public keys involved in the MuSig aggregate keys. This happens for all the three parts of the signing flow: nonce, partial sig, and aggregate sig.\r\n\r\nThe original intent of this refactor to reduce seeing duplicate code, but it should also help in improving performance of the wallet signing operations.\r\n\r\nThis was highlighted during the review of the MuSig2\r\nsigning PR: https://github.com/bitcoin/bitcoin/pull/29675#discussion_r2382674470\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      }
    ],
    "created_at": "2025-10-21T07:17:34Z",
    "updated_at": "2025-11-24T14:21:42Z",
    "closed_at": "2025-11-24T14:21:41Z",
    "mergeable_state": "unknown",
    "merged": false,
    "merge_commit_sha": "2a45ab617109bbabc1e7f1070247c60f4fa4ecea",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "rkrux:musig-sighash",
      "ref": "musig-sighash",
      "sha": "ac4a593ff0f1ff0482b4abf1568f495a07183741",
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 885267588,
        "node_id": "R_kgDONMQchA",
        "name": "bitcoin",
        "full_name": "rkrux/bitcoin",
        "owner": {
          "login": "rkrux",
          "id": 5960750,
          "node_id": "MDQ6VXNlcjU5NjA3NTA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/rkrux",
          "html_url": "https://github.com/rkrux",
          "followers_url": "https://api.github.com/users/rkrux/followers",
          "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
          "organizations_url": "https://api.github.com/users/rkrux/orgs",
          "repos_url": "https://api.github.com/users/rkrux/repos",
          "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/rkrux/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/rkrux/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/rkrux/bitcoin",
        "archive_url": "https://api.github.com/repos/rkrux/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/rkrux/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/rkrux/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/rkrux/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/rkrux/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/rkrux/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/rkrux/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/rkrux/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/rkrux/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/rkrux/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/rkrux/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/rkrux/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/rkrux/bitcoin/events",
        "forks_url": "https://api.github.com/repos/rkrux/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/rkrux/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/rkrux/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/rkrux/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/rkrux/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/rkrux/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/rkrux/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/rkrux/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/rkrux/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/rkrux/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/rkrux/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/rkrux/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/rkrux/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/rkrux/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/rkrux/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/rkrux/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:rkrux/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/rkrux/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/rkrux/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/rkrux/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/rkrux/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/rkrux/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/rkrux/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/rkrux/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/rkrux/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/rkrux/bitcoin/hooks",
        "svn_url": "https://github.com/rkrux/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 251869,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-12T12:10:49Z",
        "created_at": "2024-11-08T09:18:33Z",
        "updated_at": "2025-10-18T07:39:46Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "d0da95377310852ca3f8c868c9a1a072eee17183",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38251,
        "stargazers_count": 86979,
        "watchers_count": 86979,
        "size": 296256,
        "default_branch": "master",
        "open_issues_count": 736,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-24T15:24:04Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-11-25T01:53:34Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 38,
    "deletions": 36,
    "changed_files": 2,
    "commits": 2,
    "review_comments": 9,
    "comments": 8
  },
  "events": [
    {
      "event": "labeled",
      "id": 20396636209,
      "node_id": "LE_lADOABII587St3rDzwAAAAS_u_gx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20396636209",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-21T07:17:38Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "commented",
      "id": 3425109961,
      "node_id": "IC_kwDOABII587MJwfJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3425109961",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-21T07:17:40Z",
      "updated_at": "2025-11-21T15:48:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33665.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [Raimo33](https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3431076499), [optout21](https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3475833560) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32876](https://github.com/bitcoin/bitcoin/pull/32876) (refactor: use options struct for signing and PSBT operations by Sjors)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3425109961",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33665"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20396688946,
      "node_id": "HRFPE_lADOABII587St3rDzwAAAAS_vMYy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20396688946",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "54a37dde6132e66c3e35829b45ebcd00234ccaee",
      "commit_url": "https://api.github.com/repos/rkrux/bitcoin/commits/54a37dde6132e66c3e35829b45ebcd00234ccaee",
      "created_at": "2025-10-21T07:19:38Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20396715385,
      "node_id": "HRFPE_lADOABII587St3rDzwAAAAS_vS15",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20396715385",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "53b84813e0de9c85640cb82a85fd1fd5b0d35504",
      "commit_url": "https://api.github.com/repos/rkrux/bitcoin/commits/53b84813e0de9c85640cb82a85fd1fd5b0d35504",
      "created_at": "2025-10-21T07:20:25Z"
    },
    {
      "event": "commented",
      "id": 3425407567,
      "node_id": "IC_kwDOABII587MK5JP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3425407567",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-21T08:31:00Z",
      "updated_at": "2025-10-21T08:31:00Z",
      "author_association": "MEMBER",
      "body": "https://github.com/bitcoin/bitcoin/actions/runs/18676072881/job/53246386885?pr=33665#step:9:3427:\r\n```bash\r\nRun script_sign with args ['/home/admin/actions-runner/_work/_temp/build/bin/fuzz', '-runs=1', PosixPath('/home/admin/actions-runner/_work/_temp/ci/scratch/qa-assets/fuzz_corpora/script_sign')]INFO: Running with entropic power schedule (0xFF, 100).\r\nINFO: Seed: 2902865681\r\nINFO: Loaded 1 modules   (615865 inline 8-bit counters): 615865 [0x56e10e6f9bb8, 0x56e10e790171), \r\nINFO: Loaded 1 PC tables (615865 PCs): 615865 [0x56e10e790178,0x56e10f0f5d08), \r\nINFO:     4186 files found in /home/admin/actions-runner/_work/_temp/ci/scratch/qa-assets/fuzz_corpora/script_sign\r\nINFO: -max_len is not provided; libFuzzer will not generate inputs larger than 938660 bytes\r\nINFO: seed corpus: files: 4186 min: 9b max: 938660b total: 57347949b rss: 105Mb\r\n#1024\tpulse  cov: 12906 ft: 62748 corp: 979/178Kb exec/s: 512 rss: 162Mb\r\n/home/admin/actions-runner/_work/_temp/src/script/sign.cpp:84:60: runtime error: implicit conversion from type 'int' of value -2147483648 (32-bit, signed) to type 'uint8_t' (aka 'unsigned char') changed the value to 0 (8-bit, unsigned)\r\n    #0 0x56e10bf84088 in MutableTransactionSignatureCreator::ComputeSchnorrSignatureHash(uint256 const*, SigVersion) const /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:84:60\r\n    #1 0x56e10bf9f6d7 in SignMuSig2(BaseSignatureCreator const&, SignatureData&, SigningProvider const&, std::vector<unsigned char, std::allocator<unsigned char>>&, XOnlyPubKey const&, uint256 const*, uint256 const*, SigVersion) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:285:46\r\n    #2 0x56e10bf8bdd9 in SignTaproot(SigningProvider const&, BaseSignatureCreator const&, WitnessV1Taproot const&, SignatureData&, std::vector<std::vector<unsigned char, std::allocator<unsigned char>>, std::allocator<std::vector<unsigned char, std::allocator<unsigned char>>>>&)::$_0::operator()(XOnlyPubKey const&, uint256 const*) const /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:581:17\r\n    #3 0x56e10bf8bdd9 in SignTaproot(SigningProvider const&, BaseSignatureCreator const&, WitnessV1Taproot const&, SignatureData&, std::vector<std::vector<unsigned char, std::allocator<unsigned char>>, std::allocator<std::vector<unsigned char, std::allocator<unsigned char>>>>&) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:587:13\r\n    #4 0x56e10bf8bdd9 in SignStep(SigningProvider const&, BaseSignatureCreator const&, CScript const&, std::vector<std::vector<unsigned char, std::allocator<unsigned char>>, std::allocator<std::vector<unsigned char, std::allocator<unsigned char>>>>&, TxoutType&, SigVersion, SignatureData&) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:703:16\r\n    #5 0x56e10bf86e4c in ProduceSignature(SigningProvider const&, BaseSignatureCreator const&, CScript const&, SignatureData&) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:734:19\r\n    #6 0x56e10bf956de in SignTransaction(CMutableTransaction&, SigningProvider const*, std::map<COutPoint, Coin, std::less<COutPoint>, std::allocator<std::pair<COutPoint const, Coin>>> const&, int, std::map<int, bilingual_str, std::less<int>, std::allocator<std::pair<int const, bilingual_str>>>&) /home/admin/actions-runner/_work/_temp/build/src/./script/sign.cpp:1050:13\r\n    #7 0x56e10b9c040e in script_sign_fuzz_target(std::span<unsigned char const, 18446744073709551615ul>) /home/admin/actions-runner/_work/_temp/build/src/test/fuzz/./test/fuzz/script_sign.cpp:135:19\r\n    #8 0x56e10bc78e9e in std::function<void (std::span<unsigned char const, 18446744073709551615ul>)>::operator()(std::span<unsigned char const, 18446744073709551615ul>) const /usr/lib/gcc/x86_64-linux-gnu/13/../../../../include/c++/13/bits/std_function.h:591:9\r\n    #9 0x56e10bc78e9e in test_one_input(std::span<unsigned char const, 18446744073709551615ul>) /home/admin/actions-runner/_work/_temp/build/src/test/fuzz/util/./test/fuzz/fuzz.cpp:88:5\r\n    #10 0x56e10bc78e9e in LLVMFuzzerTestOneInput /home/admin/actions-runner/_work/_temp/build/src/test/fuzz/util/./test/fuzz/fuzz.cpp:216:5\r\n    #11 0x56e10b28521f in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1ab321f) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #12 0x56e10b284829 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1ab2829) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #13 0x56e10b286592 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1ab4592) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #14 0x56e10b286ab0 in fuzzer::Fuzzer::Loop(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1ab4ab0) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #15 0x56e10b273135 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1aa1135) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #16 0x56e10b29f4f6 in main (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1acd4f6) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n    #17 0x7318303981c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 274eec488d230825a136fa9c4d85370fed7a0a5e)\r\n    #18 0x73183039828a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 274eec488d230825a136fa9c4d85370fed7a0a5e)\r\n    #19 0x56e10b267704 in _start (/home/admin/actions-runner/_work/_temp/build/bin/fuzz+0x1a95704) (BuildId: bc4e3a0200c7b1d70a19e1981b37dcb57d3b1225)\r\n```",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3425407567",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33665"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20407341295,
      "node_id": "HRFPE_lADOABII587St3rDzwAAAATAX1Dv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20407341295",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "9d80a2e242d72db405844cb9c783d3f30223d3b8",
      "commit_url": "https://api.github.com/repos/rkrux/bitcoin/commits/9d80a2e242d72db405844cb9c783d3f30223d3b8",
      "created_at": "2025-10-21T14:54:45Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20410234892,
      "node_id": "HRFPE_lADOABII587St3rDzwAAAATAi3gM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20410234892",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "000c685bcdd395d61a58ad9698563cab41e2d7d0",
      "commit_url": "https://api.github.com/repos/rkrux/bitcoin/commits/000c685bcdd395d61a58ad9698563cab41e2d7d0",
      "created_at": "2025-10-21T17:00:55Z"
    },
    {
      "event": "commented",
      "id": 3427816798,
      "node_id": "IC_kwDOABII587MUFVe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3427816798",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-21T17:01:48Z",
      "updated_at": "2025-10-21T17:01:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "Pushed the second commit to fix the fuzz test failures.",
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3427816798",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33665"
    },
    {
      "event": "ready_for_review",
      "id": 20410254294,
      "node_id": "RFRE_lADOABII587St3rDzwAAAATAi8PW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20410254294",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-21T17:01:52Z"
    },
    {
      "event": "renamed",
      "id": 20410988022,
      "node_id": "RTE_lADOABII587St3rDzwAAAATAlvX2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20410988022",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-21T17:36:03Z",
      "rename": {
        "from": "wallet: refactor to remove redundant sighash calculation",
        "to": "wallet: remove redundant sighash calculation in Musig2 signing flow"
      }
    },
    {
      "event": "commented",
      "id": 3431076499,
      "node_id": "IC_kwDOABII587MghKT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3431076499",
      "actor": {
        "login": "Raimo33",
        "id": 104778891,
        "node_id": "U_kgDOBj7Miw",
        "avatar_url": "https://avatars.githubusercontent.com/u/104778891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Raimo33",
        "html_url": "https://github.com/Raimo33",
        "followers_url": "https://api.github.com/users/Raimo33/followers",
        "following_url": "https://api.github.com/users/Raimo33/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Raimo33/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Raimo33/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Raimo33/subscriptions",
        "organizations_url": "https://api.github.com/users/Raimo33/orgs",
        "repos_url": "https://api.github.com/users/Raimo33/repos",
        "events_url": "https://api.github.com/users/Raimo33/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Raimo33/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-22T08:30:24Z",
      "updated_at": "2025-10-22T08:30:24Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "Raimo33",
        "id": 104778891,
        "node_id": "U_kgDOBj7Miw",
        "avatar_url": "https://avatars.githubusercontent.com/u/104778891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Raimo33",
        "html_url": "https://github.com/Raimo33",
        "followers_url": "https://api.github.com/users/Raimo33/followers",
        "following_url": "https://api.github.com/users/Raimo33/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Raimo33/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Raimo33/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Raimo33/subscriptions",
        "organizations_url": "https://api.github.com/users/Raimo33/orgs",
        "repos_url": "https://api.github.com/users/Raimo33/repos",
        "events_url": "https://api.github.com/users/Raimo33/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Raimo33/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3431076499",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33665"
    },
    {
      "event": "reviewed",
      "id": 3406885918,
      "node_id": "PRR_kwDOABII587LEPQe",
      "url": null,
      "actor": null,
      "commit_id": "f9362dd1359621d260ed419a8dda2f4c89325445",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-01T06:03:01Z",
      "author_association": "NONE",
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#pullrequestreview-3406885918",
      "submitted_at": "2025-11-01T06:03:01Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
    },
    {
      "event": "reviewed",
      "id": 3406888142,
      "node_id": "PRR_kwDOABII587LEPzO",
      "url": null,
      "actor": null,
      "commit_id": "000c685bcdd395d61a58ad9698563cab41e2d7d0",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-01T06:08:46Z",
      "author_association": "NONE",
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#pullrequestreview-3406888142",
      "submitted_at": "2025-11-01T06:08:46Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
    },
    {
      "event": "commented",
      "id": 3475833560,
      "node_id": "IC_kwDOABII587PLQLY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3475833560",
      "actor": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-01T06:09:50Z",
      "updated_at": "2025-11-01T06:09:50Z",
      "author_association": "NONE",
      "body": "Concept ACK 000c685bcdd395d61a58ad9698563cab41e2d7d0\r\n(more review needed)",
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3475833560",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33665"
    },
    {
      "event": "commented",
      "id": 3516135207,
      "node_id": "IC_kwDOABII587Rk_cn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3516135207",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T10:25:31Z",
      "updated_at": "2025-11-11T10:25:31Z",
      "author_association": "MEMBER",
      "body": "Each commit should leave the code in a valid state, so it would make sense to move 000c685bcdd395d61a58ad9698563cab41e2d7d0 up. ",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3516135207",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33665"
    },
    {
      "event": "reviewed",
      "id": 3447466188,
      "node_id": "PRR_kwDOABII587NfCjM",
      "url": null,
      "actor": null,
      "commit_id": "f9362dd1359621d260ed419a8dda2f4c89325445",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-11T10:54:17Z",
      "author_association": "MEMBER",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#pullrequestreview-3447466188",
      "submitted_at": "2025-11-11T10:54:17Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
    },
    {
      "event": "reviewed",
      "id": 3447473595,
      "node_id": "PRR_kwDOABII587NfEW7",
      "url": null,
      "actor": null,
      "commit_id": "f9362dd1359621d260ed419a8dda2f4c89325445",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-11T10:56:23Z",
      "author_association": "MEMBER",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#pullrequestreview-3447473595",
      "submitted_at": "2025-11-11T10:56:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDNhNGFiOGJiNzk1YWYyOGFmMjgyNjQyZjFhNDk0NTA4MWQ5NzZhNWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3a4ab8bb795af28af282642f1a4945081d976a5d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/3a4ab8bb795af28af282642f1a4945081d976a5d",
      "tree": {
        "sha": "c22dbde53bf5c9edcf1aa5aaf83b73689095b29d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c22dbde53bf5c9edcf1aa5aaf83b73689095b29d"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree c22dbde53bf5c9edcf1aa5aaf83b73689095b29d\nparent d30f149360d10de31bd7f7369aa61ce8be0837b5\nauthor rkrux <rkrux.connect@gmail.com> 1761062492 +0530\ncommitter rkrux <rkrux.connect@gmail.com> 1762948939 +0530\n\nwallet: static cast `nHashType` function argument from `int` to `uint8_t`\n\nThis is done to fix failures in the fuzz tests that occur because of implicit\nconversion of `nHashType` from `int` to `uint8_t` when ultimately passed down\n to the `SignatureHashSchnorr` function. Narrowing the type for this variable\nat this stage fixes the fuzz tests failures.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE4A+pXu3+M+6FwdOqhhS4vS4UTG0FAmkUd0sACgkQhhS4vS4U\nTG15oBAAqdLkFyOUg/tXueRLI9d4CjlZzMvwDfcChl4uf19/wa/WhTAKsgGloI7J\nUYjpBZSOdsyJC68G8sj13uH69CWxwSMpwjA9q2xS5Pq+NbP0Umz+nVCNXHOExXq9\nScA0zdxX0iQpNZZWJ8pvTSH8/lMpsE9Vlx20gH57yWgCY8144N+UeXMCznhi1gQr\n6IwxXRI7b04KQWononPatEhAIqQ0CQvU4Zjo3+vAIUvGoZdYUryN0zTH4U+iS/hq\n8foFs6QIK6OGljQlci+qX9CmI1Gi2nDBTCx4nIlZ3M3iG+QdU98rnIMBMrWUT+nt\n7UFmTw++RygJorS8kIsbRJvDCEygjY+G1S+BMB1eqKQxmE1E/dWpZAHcGIokWwlQ\npxFhvn/giofgNQE564gh4SNnCY796qTJEQZkf/+D5OsUO1jRLfxfcAEIWNEfaP5A\nE5VK9T2Mw0daI/+47UlLlNoMkozIjasHyjfBuDi0zcul/VIob65PNE4r/D/QGMvI\n7RSyrSupRvl+L3yHwFfyuBRGrN2Z355Q4Mk8vmH3sET4eDgkDtVx2chvBqrIgYEc\nkUaSIIESrm0JNnZIoAY/7ZMZ23OaRkTElq6VhxvW9cWplNcQVnxu0Au3eSUoFN+b\nHtm4tBMa6nbp0ks9WzuSk/NzsxJ31QkR9KYHJY3DeBlnHGsngfM=\n=fp4C\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d30f149360d10de31bd7f7369aa61ce8be0837b5",
          "sha": "d30f149360d10de31bd7f7369aa61ce8be0837b5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d30f149360d10de31bd7f7369aa61ce8be0837b5"
        }
      ],
      "message": "wallet: static cast `nHashType` function argument from `int` to `uint8_t`\n\nThis is done to fix failures in the fuzz tests that occur because of implicit\nconversion of `nHashType` from `int` to `uint8_t` when ultimately passed down\n to the `SignatureHashSchnorr` function. Narrowing the type for this variable\nat this stage fixes the fuzz tests failures.",
      "committer": {
        "name": "rkrux",
        "email": "rkrux.connect@gmail.com",
        "date": "2025-11-12T12:02:19Z"
      },
      "author": {
        "name": "rkrux",
        "email": "rkrux.connect@gmail.com",
        "date": "2025-10-21T16:01:32Z"
      },
      "sha": "3a4ab8bb795af28af282642f1a4945081d976a5d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGFjNGE1OTNmZjBmMWZmMDQ4MmI0YWJmMTU2OGY0OTVhMDcxODM3NDE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ac4a593ff0f1ff0482b4abf1568f495a07183741",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ac4a593ff0f1ff0482b4abf1568f495a07183741",
      "tree": {
        "sha": "3e21eecc3f9cb8ad68dbcf72aa66c0de1bb00df1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3e21eecc3f9cb8ad68dbcf72aa66c0de1bb00df1"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 3e21eecc3f9cb8ad68dbcf72aa66c0de1bb00df1\nparent 3a4ab8bb795af28af282642f1a4945081d976a5d\nauthor rkrux <rkrux.connect@gmail.com> 1761030651 +0530\ncommitter rkrux <rkrux.connect@gmail.com> 1762949123 +0530\n\nwallet: refactor to remove redundant sighash calculation\n\nIn the MuSig2 signing flow, the same sighash ends up being\nrecalculated for all the participant public keys involved\nin the MuSig aggregate keys. This happens for all the\nthree parts of the signing flow: nonce, partial sig, and\naggregate sig.\n\nThe original intent of this refactor to reduce seeing\nduplicate code, but it should also help in improving\nperformance of the wallet signing operations.\n\nThis was highlighted during the review of the MuSig2\nsigning PR 29675.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE4A+pXu3+M+6FwdOqhhS4vS4UTG0FAmkUeAgACgkQhhS4vS4U\nTG3lhBAAgOz8HzMN964CwzAlPvCeg5hG2JTvvyf+NE9RteJcgE0FwBdK+3u1Ne6t\nFlJFX67HVTyoH5vUjtMHMPfHUIwEQnU/Ox/F1TeoNhwZXMo2P+bKSe+gWRSKWfyW\nB70FTqJ+SoY1pxgnMim17qZ7NtkNeBbPuW/smJXuIKjmVfbEZF/+2rgYzlPFYJD3\nTx7+p48JUsWQWUJHwc66Zp5VyOhB9od+LZNm7g+59n5SrlgHU2i7hWZHsnO8Qry2\noF7McOnKp8EJnNxpUT1qJbQnY1y23NfXHTaTb7tTugaKNeKpsYsibp3//vJKZkcs\nJANIzTTV/i6gV/wX8EPXr6VLjo19mv7pDuBzM51DRWeObDwQEcdGWWdLnGW8ftrI\nbd/7WQoHcMdj/Zx4Znxp8NQzEVdjPE+2nw4c3YDJ7bWhHdSxr1RXI+3luno6H2Le\npCylq8IfgjCAY46QyXj4h0HO18BDwhN7ngj0YeAU+nFlEC4I08OlHxZrJPm/1cUF\nbU86jiB0ztsw1csTp6/rmGW6ulrsHQhSvYoy7eLeiaW3bIUNfGOqaQp4KXMFFSNj\nOPhiqlIG5kEphP4SYdPCqk4e8fkG2EkzqBdAtVoAe+SZDPCGFmvkbcItKyt5QfkU\nBGOrg9jpOCCwdiV1ukAlvvSrkGgNV81Bx/jYzIMaw829N1EonI8=\n=Ahuq\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3a4ab8bb795af28af282642f1a4945081d976a5d",
          "sha": "3a4ab8bb795af28af282642f1a4945081d976a5d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/3a4ab8bb795af28af282642f1a4945081d976a5d"
        }
      ],
      "message": "wallet: refactor to remove redundant sighash calculation\n\nIn the MuSig2 signing flow, the same sighash ends up being\nrecalculated for all the participant public keys involved\nin the MuSig aggregate keys. This happens for all the\nthree parts of the signing flow: nonce, partial sig, and\naggregate sig.\n\nThe original intent of this refactor to reduce seeing\nduplicate code, but it should also help in improving\nperformance of the wallet signing operations.\n\nThis was highlighted during the review of the MuSig2\nsigning PR 29675.",
      "committer": {
        "name": "rkrux",
        "email": "rkrux.connect@gmail.com",
        "date": "2025-11-12T12:05:23Z"
      },
      "author": {
        "name": "rkrux",
        "email": "rkrux.connect@gmail.com",
        "date": "2025-10-21T07:10:51Z"
      },
      "sha": "ac4a593ff0f1ff0482b4abf1568f495a07183741"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20886943579,
      "node_id": "HRFPE_lADOABII587St3rDzwAAAATc9Xdb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20886943579",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "ac4a593ff0f1ff0482b4abf1568f495a07183741",
      "commit_url": "https://api.github.com/repos/rkrux/bitcoin/commits/ac4a593ff0f1ff0482b4abf1568f495a07183741",
      "created_at": "2025-11-12T12:10:51Z"
    },
    {
      "event": "reviewed",
      "id": 3453129469,
      "node_id": "PRR_kwDOABII587N0pL9",
      "url": null,
      "actor": null,
      "commit_id": "ac4a593ff0f1ff0482b4abf1568f495a07183741",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-12T12:13:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Each commit should leave the code in a valid state, so it would make sense to move https://github.com/bitcoin/bitcoin/commit/000c685bcdd395d61a58ad9698563cab41e2d7d0 up.\n\nMakes sense, done.",
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#pullrequestreview-3453129469",
      "submitted_at": "2025-11-12T12:13:33Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
    },
    {
      "event": "commented",
      "id": 3554963168,
      "node_id": "IC_kwDOABII587T5G7g",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3554963168",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-19T22:57:16Z",
      "updated_at": "2025-11-19T22:57:16Z",
      "author_association": "MEMBER",
      "body": "> The original intent of this refactor to reduce seeing duplicate code\r\n\r\nConsidering how much extra is being changed to avoid the duplication, I don't really think this is worth it.\r\n\r\n> but it should also help in improving performance of the wallet signing operations.\r\n\r\nI don't think that's the case. The MuSig2 functions that are all recomputing the same sighash are never actually doing so in the same call to `SignMuSig2`. `CreateMuSig2AggregateSig` exits early when there aren't enough pubnonces or partial sigs, before the sighash is computed. `CreateMuSig2PartialSig` exits early when there aren't enough pubnonces. It really ends up being that the sighash is basically computed once per `SignMuSig2` call before the deduplication anyways. The only situation where it is computed multiple times is if the wallet has multiple keys in the musig, but that should rarely happen.\r\n\r\nThis change also ends up making MuSig2's behavior different from the other signing functions. The MuSig2 signing functions are the only ones which require the caller to provide the sighash. Arguably, for `TransactionSignatureCreateor`, what the sighash is is an internal implementation detail, not something that callers need to know about.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3554963168",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33665"
    },
    {
      "event": "commented",
      "id": 3571032651,
      "node_id": "IC_kwDOABII587U2aJL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3571032651",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-24T14:21:41Z",
      "updated_at": "2025-11-24T14:21:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "> The only situation where it is computed multiple times is if the wallet has multiple keys in the musig, but that should rarely happen.\r\n\r\nOne of the reasons that made me raise the PR was this case, but as highlighted it'd occur rarely.\r\n\r\nRe: https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3554963168\r\n\r\nAll these points make sense to me, thus I'm closing this PR.",
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#issuecomment-3571032651",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33665"
    },
    {
      "event": "closed",
      "id": 21140109719,
      "node_id": "CE_lADOABII587St3rDzwAAAATsDHmX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21140109719",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-24T14:21:41Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2483143005",
      "pull_request_review_id": 3406885918,
      "id": 2483143005,
      "node_id": "PRRC_kwDOABII586UAcFd",
      "diff_hunk": "@@ -291,6 +279,15 @@ static bool SignMuSig2(const BaseSignatureCreator& creator, SignatureData& sigda\n                 if (leaf_hash) it->second.first.insert(*leaf_hash);\n             }\n         }\n+    }\n+\n+    // Compute sighash",
      "path": "src/script/sign.cpp",
      "position": 103,
      "original_position": 94,
      "commit_id": "ac4a593ff0f1ff0482b4abf1568f495a07183741",
      "original_commit_id": "f9362dd1359621d260ed419a8dda2f4c89325445",
      "in_reply_to_id": null,
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Maybe this could come before the derivation-path-filling loop above. That way the early exit condition on missing sighash comes earlier, and the loop does not have to be broken into two.",
      "created_at": "2025-11-01T06:03:01Z",
      "updated_at": "2025-11-01T06:03:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#discussion_r2483143005",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2483143005"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 284,
      "original_line": 284,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2483144708",
      "pull_request_review_id": 3406888142,
      "id": 2483144708,
      "node_id": "PRRC_kwDOABII586UAcgE",
      "diff_hunk": "@@ -81,7 +81,7 @@ std::optional<uint256> MutableTransactionSignatureCreator::ComputeSchnorrSignatu\n         execdata.m_tapleaf_hash = *leaf_hash;\n     }\n     uint256 hash;\n-    if (!SignatureHashSchnorr(hash, execdata, m_txto, nIn, nHashType, sigversion, *m_txdata, MissingDataBehavior::FAIL)) return std::nullopt;\n+    if (!SignatureHashSchnorr(hash, execdata, m_txto, nIn, static_cast<uint8_t>(nHashType), sigversion, *m_txdata, MissingDataBehavior::FAIL)) return std::nullopt;",
      "path": "src/script/sign.cpp",
      "position": 5,
      "original_position": 5,
      "commit_id": "ac4a593ff0f1ff0482b4abf1568f495a07183741",
      "original_commit_id": "000c685bcdd395d61a58ad9698563cab41e2d7d0",
      "in_reply_to_id": null,
      "user": {
        "login": "optout21",
        "id": 13562139,
        "node_id": "MDQ6VXNlcjEzNTYyMTM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13562139?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/optout21",
        "html_url": "https://github.com/optout21",
        "followers_url": "https://api.github.com/users/optout21/followers",
        "following_url": "https://api.github.com/users/optout21/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/optout21/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/optout21/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/optout21/subscriptions",
        "organizations_url": "https://api.github.com/users/optout21/orgs",
        "repos_url": "https://api.github.com/users/optout21/repos",
        "events_url": "https://api.github.com/users/optout21/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/optout21/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "It seems the proper, but much higher impact solution would be to change the `nHashType` field to `uint8_t`, what do you think? Maybe create a separate issue or PR for that?",
      "created_at": "2025-11-01T06:08:46Z",
      "updated_at": "2025-11-01T06:08:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#discussion_r2483144708",
      "author_association": "NONE",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2483144708"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 84,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2513732380",
      "pull_request_review_id": 3447424783,
      "id": 2513732380,
      "node_id": "PRRC_kwDOABII586V1IMc",
      "diff_hunk": "@@ -81,7 +81,7 @@ std::optional<uint256> MutableTransactionSignatureCreator::ComputeSchnorrSignatu\n         execdata.m_tapleaf_hash = *leaf_hash;\n     }\n     uint256 hash;\n-    if (!SignatureHashSchnorr(hash, execdata, m_txto, nIn, nHashType, sigversion, *m_txdata, MissingDataBehavior::FAIL)) return std::nullopt;\n+    if (!SignatureHashSchnorr(hash, execdata, m_txto, nIn, static_cast<uint8_t>(nHashType), sigversion, *m_txdata, MissingDataBehavior::FAIL)) return std::nullopt;",
      "path": "src/script/sign.cpp",
      "position": 5,
      "original_position": 5,
      "commit_id": "ac4a593ff0f1ff0482b4abf1568f495a07183741",
      "original_commit_id": "000c685bcdd395d61a58ad9698563cab41e2d7d0",
      "in_reply_to_id": 2483144708,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "A more thorough approach would be to introduce `typedef uint8_t HashType`, but it requires changes all over the codebase.",
      "created_at": "2025-11-11T10:44:52Z",
      "updated_at": "2025-11-11T10:44:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#discussion_r2513732380",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2513732380"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 84,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2513754984",
      "pull_request_review_id": 3447454518,
      "id": 2513754984,
      "node_id": "PRRC_kwDOABII586V1Nto",
      "diff_hunk": "@@ -291,6 +279,15 @@ static bool SignMuSig2(const BaseSignatureCreator& creator, SignatureData& sigda\n                 if (leaf_hash) it->second.first.insert(*leaf_hash);\n             }\n         }\n+    }\n+\n+    // Compute sighash",
      "path": "src/script/sign.cpp",
      "position": 103,
      "original_position": 94,
      "commit_id": "ac4a593ff0f1ff0482b4abf1568f495a07183741",
      "original_commit_id": "f9362dd1359621d260ed419a8dda2f4c89325445",
      "in_reply_to_id": 2483143005,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I would also prefer not breaking up this loop.",
      "created_at": "2025-11-11T10:51:31Z",
      "updated_at": "2025-11-11T10:51:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#discussion_r2513754984",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2513754984"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 284,
      "original_line": 284,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2513763886",
      "pull_request_review_id": 3447466188,
      "id": 2513763886,
      "node_id": "PRRC_kwDOABII586V1P4u",
      "diff_hunk": "@@ -291,6 +279,15 @@ static bool SignMuSig2(const BaseSignatureCreator& creator, SignatureData& sigda\n                 if (leaf_hash) it->second.first.insert(*leaf_hash);\n             }\n         }\n+    }\n+\n+    // Compute sighash\n+    std::optional<uint256> sighash = creator.ComputeSchnorrSignatureHash(leaf_hash, sigversion);\n+    if (!sighash.has_value()) return false;",
      "path": "src/script/sign.cpp",
      "position": 1,
      "original_position": 96,
      "commit_id": "000c685bcdd395d61a58ad9698563cab41e2d7d0",
      "original_commit_id": "f9362dd1359621d260ed419a8dda2f4c89325445",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Since we do an early return here, it's nicer to make `sighash` (or `sig_hash`) not an optional, so below you don't need dereference pointers.",
      "created_at": "2025-11-11T10:54:17Z",
      "updated_at": "2025-11-11T10:54:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#discussion_r2513763886",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2513763886"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 286,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2513769931",
      "pull_request_review_id": 3447473595,
      "id": 2513769931,
      "node_id": "PRRC_kwDOABII586V1RXL",
      "diff_hunk": "@@ -966,18 +963,22 @@ class DummySignatureCreator final : public BaseSignatureCreator {\n         sig.assign(64, '\\000');\n         return true;\n     }\n-    std::vector<uint8_t> CreateMuSig2Nonce(const SigningProvider& provider, const CPubKey& aggregate_pubkey, const CPubKey& script_pubkey, const CPubKey& part_pubkey, const uint256* leaf_hash, const uint256* merkle_root, SigVersion sigversion, const SignatureData& sigdata) const override\n+    std::optional<uint256> ComputeSchnorrSignatureHash(const uint256* leaf_hash, SigVersion sigversion) const override",
      "path": "src/script/sign.cpp",
      "position": 146,
      "original_position": 136,
      "commit_id": "ac4a593ff0f1ff0482b4abf1568f495a07183741",
      "original_commit_id": "f9362dd1359621d260ed419a8dda2f4c89325445",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Why is this added?\r\n\r\nIt also makes the commit diff harder to read.",
      "created_at": "2025-11-11T10:56:23Z",
      "updated_at": "2025-11-11T10:58:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#discussion_r2513769931",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2513769931"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 967,
      "original_line": 967,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518068172",
      "pull_request_review_id": 3453129469,
      "id": 2518068172,
      "node_id": "PRRC_kwDOABII586WFqvM",
      "diff_hunk": "@@ -291,6 +279,15 @@ static bool SignMuSig2(const BaseSignatureCreator& creator, SignatureData& sigda\n                 if (leaf_hash) it->second.first.insert(*leaf_hash);\n             }\n         }\n+    }\n+\n+    // Compute sighash",
      "path": "src/script/sign.cpp",
      "position": 103,
      "original_position": 94,
      "commit_id": "ac4a593ff0f1ff0482b4abf1568f495a07183741",
      "original_commit_id": "f9362dd1359621d260ed419a8dda2f4c89325445",
      "in_reply_to_id": 2483143005,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I recall doing it intentionally based on the response I received on a similar suggestion in the MuSig2 signing PR: https://github.com/bitcoin/bitcoin/pull/29675#discussion_r2355476052.",
      "created_at": "2025-11-12T12:12:07Z",
      "updated_at": "2025-11-12T12:13:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#discussion_r2518068172",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518068172"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 284,
      "original_line": 284,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518068751",
      "pull_request_review_id": 3453129469,
      "id": 2518068751,
      "node_id": "PRRC_kwDOABII586WFq4P",
      "diff_hunk": "@@ -966,18 +963,22 @@ class DummySignatureCreator final : public BaseSignatureCreator {\n         sig.assign(64, '\\000');\n         return true;\n     }\n-    std::vector<uint8_t> CreateMuSig2Nonce(const SigningProvider& provider, const CPubKey& aggregate_pubkey, const CPubKey& script_pubkey, const CPubKey& part_pubkey, const uint256* leaf_hash, const uint256* merkle_root, SigVersion sigversion, const SignatureData& sigdata) const override\n+    std::optional<uint256> ComputeSchnorrSignatureHash(const uint256* leaf_hash, SigVersion sigversion) const override",
      "path": "src/script/sign.cpp",
      "position": 146,
      "original_position": 136,
      "commit_id": "ac4a593ff0f1ff0482b4abf1568f495a07183741",
      "original_commit_id": "f9362dd1359621d260ed419a8dda2f4c89325445",
      "in_reply_to_id": 2513769931,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`ComputeSchnorrSignatureHash` function of the class `BaseSignatureCreator` had to be made public so that it can be called from the `SignMuSig2` function that makes an implementation in the `DummySignatureCreator` class necessary.",
      "created_at": "2025-11-12T12:12:16Z",
      "updated_at": "2025-11-12T12:13:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#discussion_r2518068751",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518068751"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 967,
      "original_line": 967,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518072408",
      "pull_request_review_id": 3453129469,
      "id": 2518072408,
      "node_id": "PRRC_kwDOABII586WFrxY",
      "diff_hunk": "@@ -291,6 +279,15 @@ static bool SignMuSig2(const BaseSignatureCreator& creator, SignatureData& sigda\n                 if (leaf_hash) it->second.first.insert(*leaf_hash);\n             }\n         }\n+    }\n+\n+    // Compute sighash\n+    std::optional<uint256> sighash = creator.ComputeSchnorrSignatureHash(leaf_hash, sigversion);\n+    if (!sighash.has_value()) return false;",
      "path": "src/script/sign.cpp",
      "position": 1,
      "original_position": 96,
      "commit_id": "000c685bcdd395d61a58ad9698563cab41e2d7d0",
      "original_commit_id": "f9362dd1359621d260ed419a8dda2f4c89325445",
      "in_reply_to_id": 2513763886,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-11-12T12:13:19Z",
      "updated_at": "2025-11-12T12:13:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33665#discussion_r2518072408",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2518072408"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33665"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 286,
      "side": "RIGHT"
    }
  ]
}