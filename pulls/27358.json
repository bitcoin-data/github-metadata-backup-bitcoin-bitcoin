{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358",
    "id": 1293631789,
    "node_id": "PR_kwDOABII585NG0Et",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/27358",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/27358.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/27358.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/754fb6bb8125317575edec7c20b5617ad27a9bdd",
    "number": 27358,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "contrib: allow multi-sig binary verification v2",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Following up on #23020 from jamesob with achow101's additional features on top. \r\n\r\nBoth mentioned that they will be away for the next few weeks, so this is intended to keep review going.\r\n\r\nAll credit to the jamesob and achow101. See #23020 for the original description and [here](https://github.com/bitcoin/bitcoin/pull/23020#issuecomment-1480603300) for the added features.\r\n\r\nI squashed the last commit from https://github.com/achow101/bitcoin/tree/pr23020-direct-bins-gpg-parse into the first commit here.\r\n\r\nFetching and local verification seem to work as intended for me.",
    "labels": [
      {
        "id": 231994551,
        "node_id": "MDU6TGFiZWwyMzE5OTQ1NTE=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Scripts%20and%20tools",
        "name": "Scripts and tools",
        "color": "ffffee",
        "default": false
      }
    ],
    "milestone": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/56",
      "html_url": "https://github.com/bitcoin/bitcoin/milestone/56",
      "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/56/labels",
      "id": 7733968,
      "node_id": "MI_kwDOABII584AdgLQ",
      "number": 56,
      "state": "closed",
      "title": "25.0",
      "description": "",
      "creator": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "open_issues": 0,
      "closed_issues": 38,
      "created_at": "2022-03-03T18:51:29Z",
      "updated_at": "2023-05-25T13:24:42Z",
      "closed_at": "2023-05-25T13:24:42Z"
    },
    "created_at": "2023-03-28T21:10:12Z",
    "updated_at": "2024-04-08T12:41:54Z",
    "closed_at": "2023-04-07T07:26:59Z",
    "mergeable_state": "unknown",
    "merged_at": "2023-04-07T07:26:59Z",
    "merge_commit_sha": "db720b5a703c90625fa7a4773bd2db5672427cbe",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "theuni:achow-direct-bins-gpg-parse",
      "ref": "achow-direct-bins-gpg-parse",
      "sha": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 10302141,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMDMwMjE0MQ==",
        "name": "bitcoin",
        "full_name": "theuni/bitcoin",
        "owner": {
          "login": "theuni",
          "id": 417043,
          "node_id": "MDQ6VXNlcjQxNzA0Mw==",
          "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/theuni",
          "html_url": "https://github.com/theuni",
          "followers_url": "https://api.github.com/users/theuni/followers",
          "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
          "organizations_url": "https://api.github.com/users/theuni/orgs",
          "repos_url": "https://api.github.com/users/theuni/repos",
          "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/theuni/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/theuni/bitcoin",
        "description": "Bitcoin integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/theuni/bitcoin",
        "archive_url": "https://api.github.com/repos/theuni/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/theuni/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/theuni/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/theuni/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/theuni/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/theuni/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/theuni/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/theuni/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/theuni/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/theuni/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/theuni/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/theuni/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/theuni/bitcoin/events",
        "forks_url": "https://api.github.com/repos/theuni/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/theuni/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/theuni/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/theuni/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/theuni/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/theuni/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/theuni/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/theuni/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/theuni/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/theuni/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/theuni/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/theuni/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/theuni/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/theuni/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/theuni/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/theuni/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:theuni/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/theuni/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/theuni/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/theuni/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/theuni/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/theuni/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/theuni/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/theuni/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/theuni/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/theuni/bitcoin/hooks",
        "svn_url": "https://github.com/theuni/bitcoin",
        "homepage": "http://www.bitcoin.org",
        "language": "C++",
        "forks_count": 3,
        "stargazers_count": 3,
        "watchers_count": 3,
        "size": 241150,
        "default_branch": "trivial-next",
        "open_issues_count": 2,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-04-05T15:46:54Z",
        "created_at": "2013-05-26T18:55:06Z",
        "updated_at": "2024-02-19T15:18:09Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "5a8bd4505687a7ec76d731b1a8249ee04d641990",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35018,
        "stargazers_count": 75302,
        "watchers_count": 75302,
        "size": 254492,
        "default_branch": "master",
        "open_issues_count": 725,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-04-08T12:56:17Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-04-08T12:45:52Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 774,
    "deletions": 127,
    "changed_files": 3,
    "commits": 14,
    "review_comments": 35,
    "comments": 19
  },
  "events": [
    {
      "event": "mentioned",
      "id": 8869697606,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIQrNhG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8869697606",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-28T21:10:13Z"
    },
    {
      "event": "subscribed",
      "id": 8869697618,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIQrNhS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8869697618",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-28T21:10:13Z"
    },
    {
      "event": "mentioned",
      "id": 8869697634,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIQrNhi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8869697634",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-28T21:10:13Z"
    },
    {
      "event": "subscribed",
      "id": 8869697648,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIQrNhw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8869697648",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-28T21:10:13Z"
    },
    {
      "event": "commented",
      "id": 1487595867,
      "node_id": "IC_kwDOABII585Yqulb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1487595867",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-28T21:10:15Z",
      "updated_at": "2023-04-06T21:31:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [josibake](https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1499652736) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1487595867",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "labeled",
      "id": 8869698081,
      "node_id": "LE_lADOABII585iB4vJzwAAAAIQrNoh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8869698081",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-28T21:10:17Z",
      "label": {
        "name": "Scripts and tools",
        "color": "ffffee"
      }
    },
    {
      "event": "reviewed",
      "id": 1361927312,
      "node_id": "PRR_kwDOABII585RLVyQ",
      "url": null,
      "actor": null,
      "commit_id": "dd6b1ce5d956fe585a8f4ecab2cdda9c6aba352b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#pullrequestreview-1361927312",
      "submitted_at": "2023-03-28T21:22:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDM3YzlmYjdhNTlhMzE3OWI5MGVkMWRlYWViYWFiYjUzOTk3NjUwNGI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/37c9fb7a59a3179b90ed1deaebaabb539976504b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/37c9fb7a59a3179b90ed1deaebaabb539976504b",
      "tree": {
        "sha": "e85e9119fa8648e6966df340b658756a6809d32a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e85e9119fa8648e6966df340b658756a6809d32a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e352f5ab6b60ec1cc549997275e945238508cdee",
          "sha": "e352f5ab6b60ec1cc549997275e945238508cdee",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e352f5ab6b60ec1cc549997275e945238508cdee"
        }
      ],
      "message": "contrib: verifybinaries: allow multisig verification\n\nThis commit adds the functionality necessary to transition from\ndoing binary verification on the basis of a single signature to\nrequiring a minimum threshold of trusted signatures.\n\nA signature can appear as \"good\" from GPG output, but it may not come\nfrom an identity the user trusts. We call these \"good, untrusted\"\nsignatures.\n\nWe report bad signatures but do not necessarily fail in their presence,\nsince a bad signature might coexist with enough good, trusted signatures\nto fulfill our criteria.\n\nIf \"--import-keys\" is enabled, we will prompt the user to\noptionally try to retrieve unknown keys. Marking them as trusted locally\nis a WIP, but keys which are retrieved successfully and appear on the\nbuilder-keys list will immediately count as being useful towards\nfulfilling the threshold.\n\nLogging is improved and an option to output JSON that summarizes the\nwhole sum signature and binary verification processes has been added.\n\nCo-authored-by: Russ Yanofsky <russ@yanofsky.org>\nCo-authored-by: willcl-ark <will8clark@gmail.com>",
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-03-28T22:16:05Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-09-16T22:33:20Z"
      },
      "sha": "37c9fb7a59a3179b90ed1deaebaabb539976504b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE3NTc1YzBlZmE5NjBmZmI3NjUzOTJlMzU2NWIzODYxODQ2ZjM5OGU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/17575c0efa960ffb765392e3565b3861846f398e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/17575c0efa960ffb765392e3565b3861846f398e",
      "tree": {
        "sha": "a99739d8912f277e05e1eb4deca9e4c8d59f5c03",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a99739d8912f277e05e1eb4deca9e4c8d59f5c03"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/37c9fb7a59a3179b90ed1deaebaabb539976504b",
          "sha": "37c9fb7a59a3179b90ed1deaebaabb539976504b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/37c9fb7a59a3179b90ed1deaebaabb539976504b"
        }
      ],
      "message": "contrib: Refactor verifbinaries to support subcommands\n\nPrepares for the option to provide local binaries, sha256sums, and\nsignatures directly.",
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-03-28T22:16:05Z"
      },
      "author": {
        "name": "Andrew Chow",
        "email": "github@achow101.com",
        "date": "2023-03-23T01:15:06Z"
      },
      "sha": "17575c0efa960ffb765392e3565b3861846f398e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU0ZDU3NzgyMjgzNWQ0ODY2ZTJhZDA0NmYyM2FiNDExYjI5MTBkNTk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e4d577822835d4866e2ad046f23ab411b2910d59",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e4d577822835d4866e2ad046f23ab411b2910d59",
      "tree": {
        "sha": "3f83912f5388950972267015c5c4ea2d6c2609e8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3f83912f5388950972267015c5c4ea2d6c2609e8"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/17575c0efa960ffb765392e3565b3861846f398e",
          "sha": "17575c0efa960ffb765392e3565b3861846f398e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/17575c0efa960ffb765392e3565b3861846f398e"
        }
      ],
      "message": "contrib: Specify to GPG the SHA256SUMS file that is detached signed",
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-03-28T22:16:05Z"
      },
      "author": {
        "name": "Andrew Chow",
        "email": "github@achow101.com",
        "date": "2023-03-23T02:06:31Z"
      },
      "sha": "e4d577822835d4866e2ad046f23ab411b2910d59"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDZiMmNlYmZhMmYxNTI2ZjdlYWUzMWViNjQ1YzcxNzEyZjBhNjllOTc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6b2cebfa2f1526f7eae31eb645c71712f0a69e97",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6b2cebfa2f1526f7eae31eb645c71712f0a69e97",
      "tree": {
        "sha": "0d7c7defaadeb4a1e6ea7ac10ce22088d424ca94",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0d7c7defaadeb4a1e6ea7ac10ce22088d424ca94"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e4d577822835d4866e2ad046f23ab411b2910d59",
          "sha": "e4d577822835d4866e2ad046f23ab411b2910d59",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e4d577822835d4866e2ad046f23ab411b2910d59"
        }
      ],
      "message": "contrib: Add verifybinaries command for specifying files to verify\n\nIn addition to verifying the published releases with the `pub` command,\nthe verifybinaries script is updated to take a `bin` command where the\nuser specifies the local files, sums, and sigs to verify.",
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-03-28T22:16:05Z"
      },
      "author": {
        "name": "Andrew Chow",
        "email": "github@achow101.com",
        "date": "2023-03-23T02:07:50Z"
      },
      "sha": "6b2cebfa2f1526f7eae31eb645c71712f0a69e97"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDdhNmU3ZmZkMDY2YTQyYzVmYmI3ZDY5ZWZmYmUwNzRmYjk4MjkzNmI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "tree": {
        "sha": "ab82aff32f5222ef2df35dc7e0a1bc25a600952d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ab82aff32f5222ef2df35dc7e0a1bc25a600952d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6b2cebfa2f1526f7eae31eb645c71712f0a69e97",
          "sha": "6b2cebfa2f1526f7eae31eb645c71712f0a69e97",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6b2cebfa2f1526f7eae31eb645c71712f0a69e97"
        }
      ],
      "message": "contrib: Use machine parseable GPG output in verifybinaries\n\nGPG has an option to provide machine parseable output. Use that instead\nof trying to parse the human readable output.",
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-03-28T22:16:05Z"
      },
      "author": {
        "name": "Andrew Chow",
        "email": "github@achow101.com",
        "date": "2023-03-23T04:56:12Z"
      },
      "sha": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8870079839,
      "node_id": "HRFPE_lADOABII585iB4vJzwAAAAIQsq1f",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8870079839",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-28T22:16:27Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-29T06:30:45Z",
      "updated_at": "2023-03-29T06:30:45Z",
      "source": {
        "issue": {
          "id": 999636873,
          "node_id": "PR_kwDOABII584r57km",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23020",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23020/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23020/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23020/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/23020",
          "number": 23020,
          "state": "closed",
          "state_reason": null,
          "title": "fix: contrib: allow multi-sig binary verification",
          "body": "Related: https://github.com/bitcoin-core/bitcoincore.org/issues/793\r\n\r\nThis changeset improves the `contrib/verifybinaries/verify.py` script to account for the new binary verification procedure introduced in the 22.0 release; for details on this new process, see the note in https://github.com/bitcoin/bitcoin/issues/22634.\r\n\r\nIn short, instead of relying on a single signature from the lead maintainer attesting to the expected hashes of binary releases, this verify script now supports validating that a minimum threshold of trusted identities have signed the checksum file. \r\n\r\n![image](https://user-images.githubusercontent.com/73197/133840032-227240c1-ad12-498f-863d-5e2261f928bf.png)\r\n\r\n\r\nBoth the threshold and identities to trust are configurable by the end user, but sensible defaults are provided: identities are inferred from local GPG trust and the builder-keys file and a minimum threshold of 4 trusted signatures is configured by default. There are options for overriding these.\r\n\r\nVarious improvements have been made to the script for allow for easier programmatic use; a `--json` option is introduced and logging output is now directed to stderr. \r\n\r\n### Automatic pubkey import\r\n\r\nPubkeys that are referenced in checksum signature files can now be automatically downloaded based on a user prompt. This behavior can be disabled with the `--noninteractive` flag to support CI use.\r\n\r\nI have built in functionality for elevating local GPG trust of the imported keys, but it isn't quite working yet; I think instead of manually modifying the GPG trust database I have to use the `--sign-key` command. But this is optional functionality and fixing the broken process is the priority here, so I can enable this nicety in a follow-up.\r\n\r\n### Builder-key diffing\r\n\r\nBuilder keys (as listed in ./contrib/builder-keys/keys.txt) are used by default to establish trust in a pubkey signature. This can be disabled with `--no-builder-keys`. \r\n\r\nIf builder keys are locally supplied (by running this command from the root of the repository), they are diffed with the remote version obtained over HTTPS from Github. A diff is reported if it exists, e.g.\r\n\r\n![image](https://user-images.githubusercontent.com/73197/133835761-5fad32fd-4126-448e-bc54-f638b8b87e90.png)\r\n\r\n### Granular JSON output\r\n\r\nBecause binary verification is now a gradient on the basis of an end user's trust in a set of pubkeys, users of this script may want a granular report on which signatures were used. Stderr logging can be parsed for this information, but a convenient JSON blob is also accessible using the `--json` flag:\r\n\r\n```sh\r\n% ./contrib/verifybinaries/verify.py 22.0-x86 --noninteractive --json 2>/dev/null\r\n\r\n{\r\n  \"good_trusted_sigs\": [\r\n    \"SigData('9D3CC86A72F8494342EA5FD10A41BDC3F4FAFF1C', 'Aaron Clauson (sipsorcery) <aaron@sipsorcery.com>', trusted=False, status='unknown')\",\r\n    \"SigData('637DB1E23370F84AFF88CCE03152347D07DA627C', 'Stephan Oeste (it) <it@oeste.de>', trusted=True, status='unknown')\",\r\n    \"SigData('9DEAE0DC7063249FB05474681E4AED62986CD25D', 'Wladimir J. van der Laan <laanwj@visucore.com>', trusted=True, status='unknown')\",\r\n    \"SigData('0AD83877C1F0CD1EE9BD660AD7CC770B81FD22A8', 'Ben Carman <benthecarman@live.com>', trusted=False, status='unknown')\",\r\n    \"SigData('152812300785C96444D3334D17565732E08E5E41', 'Andrew Chow (Official New Key) <achow101@gmail.com>', trusted=True, status='expired')\",\r\n    \"SigData('D1DBF2C4B96F2DEBF4C16654410108112E7EA81F', 'Hennadii Stepanov (GitHub key) <32963518+hebasto@users.noreply.github.com>', trusted=True, status='unknown')\",\r\n    \"SigData('590B7292695AFFA5B672CBB2E13FC145CD3F4304', 'Antoine Poinsot <darosior@protonmail.com>', trusted=True, status='unknown')\"\r\n  ],\r\n  \"good_untrusted_sigs\": [\r\n    \"SigData('0CCBAAFD76A2ECE2CCD3141DE2FFD5B1D88CA97D', '.0xB10C <0xb10c@gmail.com>', trusted=False, status='unknown')\",\r\n    \"SigData('28F5900B1BB5D1A4B6B6D1A9ED357015286A333D', 'Duncan Dean <duncangleeddean@gmail.com>', trusted=False, status='unknown')\",\r\n    \"SigData('CFB16E21C950F67FA95E558F2EEB9F5CC09526C1', 'Michael Ford (bitcoin-otc) <fanquake@gmail.com>', trusted=False, status='unknown')\",\r\n    \"SigData('6E01EEC9656903B0542B8F1003DB6322267C373B', 'Oliver Gugger <gugger@gmail.com>', trusted=False, status='unknown')\",\r\n    \"SigData('74E2DEF5D77260B98BC19438099BAD163C70FBFA', 'Will Clark <will8clark@gmail.com>', trusted=False, status='unknown')\"\r\n  ],\r\n  \"unknown_sigs\": [\r\n    \"SigData('82921A4B88FD454B7EB8CE3C796C4109063D4EAF', '', trusted=False, status='')\"\r\n  ],\r\n  \"bad_sigs\": [],\r\n  \"verified_binaries\": [\r\n    \"bitcoin-22.0-x86_64-linux-gnu.tar.gz\"\r\n  ]\r\n}\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/73197/133836066-251cc628-709f-4489-8f22-7beee6d9e72e.png)\r\n\r\n\r\n### Backwards incompatibility\r\n\r\nNote that I have broken the interface; the script is no longer invoked in the same way and output differs. I initially tried to retain the old format, but I found it made less and less sense for the new signature scheme, and was not easily parsed sensibly. If there are users that rely on the old output structure, they can copy the script from an old version of the source tree.\r\n\r\n### Examples\r\n\r\nValidate releases with default settings:\r\n```sh\r\n./contrib/verifybinaries/verify.py 22.0\r\n./contrib/verifybinaries/verify.py 22.0-rc2-x86_64\r\n./contrib/verifybinaries/verify.py bitcoin-core-0.13.0-rc3\r\n```\r\n\r\nGet JSON output and don't prompt for user input (no auto key import):\r\n\r\n```sh\r\n./contrib/verifybinaries/verify.py 22.0-x86 --json --noninteractive\r\n```\r\n\r\nDon't trust builder-keys by default, and rely only on local GPG state and manually\r\nspecified keys, while requiring a threshold of at least 10 trusted signatures:\r\n```sh\r\n./contrib/verifybinaries/verify.py 22.0 \\\r\n    --no-builder-keys \\\r\n    --trusted-keys 74E2DEF5D77260B98BC19438099BAD163C70FBFA,9D3CC86A72F8494342EA5FD10A41BDC3F4FAFF1C \\\r\n    --min-trusted-sigs 10\r\n```\r\n\r\n\r\n### Followups\r\n\r\n- [x] update https://github.com/bitcoin-core/bitcoincore.org with new verification instructions\r\n    - https://github.com/bitcoin-core/bitcoincore.org/pull/803\r\n- [ ] fix local GPG trust elevation during pubkey import\r\n- [x] use `logging` facility instead of `print_*` functions\r\n- [x] write small `test.sh` exercising basic functionality with `--noninteractive`\r\n\r\n\r\n### New CLI interface\r\n\r\n```\r\n% ./contrib/verifybinaries/verify.py --help\r\n\r\nusage: verify.py [-h] [--verbose] [--cleanup] [--noninteractive]\r\n                 [--require-all-hosts] [--bitcoin-src-path [BITCOIN_SRC_PATH]]\r\n                 [--skip-import-builders]\r\n                 [--min-trusted-sigs [MIN_TRUSTED_SIGS]]\r\n                 [--keyserver [KEYSERVER]] [--trusted-keys [TRUSTED_KEYS]]\r\n                 [--no-builder-keys] [--json]\r\n                 version\r\n\r\nScript for verifying Bitcoin Core release binaries. This script attempts to\r\ndownload the sum file SHA256SUMS and corresponding signature file\r\nSHA256SUMS.asc from bitcoincore.org and bitcoin.org and compares them. The\r\nsum-signature file is signed by a number of builder keys. This script ensures\r\nthat there is a minimum threshold of signatures from pubkeys that we trust.\r\nThis trust is articulated on the basis of configuration options here, but by\r\ndefault is based upon a unionof (i) local GPG trust settings, and (ii) keys\r\nwhich appear in the builder-keys/keys.txt file. If a minimum good, trusted\r\nsignature threshold is met on the sum file, we then download the files\r\nspecified in SHA256SUMS, and check if the hashes of these files match those\r\nthat are specified. The script returns 0 if everything passes the checks. It\r\nreturns 1 if either the signature check or the hash check doesn't pass. If an\r\nerror occurs the return value is >= 2. Logging output goes to stderr and final\r\nbinary verification data goes to stdout. JSON output can by obtained by\r\nsetting env BINVERIFY_JSON=1.\r\n\r\npositional arguments:\r\n  version               version of the bitcoin release to download; of the\r\n                        format <major>.<minor>[.<patch>][-rc[0-9]][-platform].\r\n                        Example: 22.0-x86_64 or 0.21.0-rc2-osx\r\n\r\noptions:\r\n  -h, --help            show this help message and exit\r\n  --verbose\r\n  --cleanup             if specified, clean up files afterwards\r\n  --noninteractive      if specified, do not block for user input\r\n  --require-all-hosts   If set, require all hosts (https://bitcoincore.org,\r\n                        https://bitcoin.org) to provide signatures. (Sometimes\r\n                        bitcoin.org lags behind bitcoincore.org.)\r\n  --bitcoin-src-path [BITCOIN_SRC_PATH]\r\n                        specify path to bitcoin repository. Used to find\r\n                        builder keys.\r\n  --skip-import-builders\r\n                        If set, do not prompt to import builder pubkeys\r\n  --min-trusted-sigs [MIN_TRUSTED_SIGS]\r\n                        The minimum number of good signatures from recognized\r\n                        keys to require successful termination.\r\n  --keyserver [KEYSERVER]\r\n                        which keyserver to use\r\n  --trusted-keys [TRUSTED_KEYS]\r\n                        A list of trusted builder GPG keys, specified as CSV\r\n  --no-builder-keys     If set, do not trust the builder-keys from the bitcoin\r\n                        repo by default\r\n  --json                If set, output the result as JSON\r\n```",
          "user": {
            "login": "jamesob",
            "id": 73197,
            "node_id": "MDQ6VXNlcjczMTk3",
            "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jamesob",
            "html_url": "https://github.com/jamesob",
            "followers_url": "https://api.github.com/users/jamesob/followers",
            "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
            "organizations_url": "https://api.github.com/users/jamesob/orgs",
            "repos_url": "https://api.github.com/users/jamesob/repos",
            "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jamesob/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 231994551,
              "node_id": "MDU6TGFiZWwyMzE5OTQ1NTE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Scripts%20and%20tools",
              "name": "Scripts and tools",
              "color": "ffffee",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 44,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23020",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/23020",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/23020.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/23020.patch"
          },
          "closed_at": "2023-03-29T06:30:53Z",
          "created_at": "2021-09-17T18:57:50Z",
          "updated_at": "2024-03-28T12:40:31Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "milestoned",
      "id": 8872403539,
      "node_id": "MIE_lADOABII585iB4vJzwAAAAIQ1iJT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8872403539",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-29T06:31:16Z",
      "milestone": {
        "title": "25.0"
      }
    },
    {
      "event": "unsubscribed",
      "id": 8872407126,
      "node_id": "UE_lADOABII585iB4vJzwAAAAIQ1jBW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8872407126",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-29T06:31:52Z"
    },
    {
      "event": "unsubscribed",
      "id": 8872407144,
      "node_id": "UE_lADOABII585iB4vJzwAAAAIQ1jBo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8872407144",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-29T06:31:52Z"
    },
    {
      "event": "commented",
      "id": 1488142360,
      "node_id": "IC_kwDOABII585Ys0AY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1488142360",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-29T08:17:50Z",
      "updated_at": "2023-03-29T08:17:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Fetching and local verification seem to work as intended for me.\r\n\r\nCan you post your commands? Nothing is currently working as advertised in the README for me ^^.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1488142360",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "commented",
      "id": 1488262940,
      "node_id": "IC_kwDOABII585YtRcc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1488262940",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-29T09:33:18Z",
      "updated_at": "2023-03-29T09:33:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "@TheCharlatan I see it working using e.g. the `pub` subcommand. You need to choose `pub` or `bin` to verify either the publicly-hosted binaries, or `bin` for a local binary. But you are correct the docs are now outdated...\r\n\r\n```fish\r\nâ‚¿ ./contrib/verifybinaries/verify.py pub bitcoin-core-23.0-x86_64\r\n[INFO] got file https://bitcoincore.org/bin/bitcoin-core-23.0/SHA256SUMS.asc as SHA256SUMS.asc\r\n[WARNING] https://bitcoin.org failed to provide file (https://bitcoin.org/bin/bitcoin-core-23.0/SHA256SUMS.asc). Continuing based solely upon https://bitcoincore.org.\r\n[INFO] got file https://bitcoincore.org/bin/bitcoin-core-23.0/SHA256SUMS as SHA256SUMS\r\n[WARNING] https://bitcoin.org failed to provide file (https://bitcoin.org/bin/bitcoin-core-23.0/SHA256SUMS). Continuing based solely upon https://bitcoincore.org.\r\n[INFO] got 17 good signatures\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('17565732E08E5E41', 'Andrew Chow <andrew@achow101.com>', trusted=False, status='')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('D7CC770B81FD22A8', 'Ben Carman <benthecarman@live.com>', trusted=False, status='expired')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('E13FC145CD3F4304', 'Antoine Poinsot <darosior@protonmail.com>', trusted=False, status='')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('ED357015286A333D', 'Duncan Dean <duncangleeddean@gmail.com>', trusted=False, status='')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('3152347D07DA627C', 'Stephan Oeste (it) <it@oeste.de>', trusted=False, status='')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('2EEB9F5CC09526C1', 'Michael Ford (bitcoin-otc) <fanquake@gmail.com>', trusted=False, status='')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('8E4256593F177720', 'Oliver Gugger <gugger@gmail.com>', trusted=False, status='')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('410108112E7EA81F', 'Hennadii Stepanov (GitHub key) <32963518+hebasto@users.noreply.github.com>', trusted=False, status='')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('D11BD4F33F1DB499', 'jackielove4u <jackielove4u@hotmail.com>', trusted=False, status='')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('DD78544CF91B1514', 'Jonas Ott (jonas-ott) <git@jonas-ott.de>', trusted=False, status='')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('F62711DBDCA8AE56', 'Dimitri <kvaciral@protonmail.com>', trusted=False, status='')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('1E4AED62986CD25D', 'Wladimir J. van der Laan <laanwj@protonmail.com>', trusted=False, status='')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('BD02942421F4889F', 'Luke Dashjr <luke@dashjr.org>', trusted=False, status='revoked')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('0A41BDC3F4FAFF1C', 'Aaron Clauson (sipsorcery) <aaron@sipsorcery.com>', trusted=False, status='')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('7E296D555E7F63A7', 'Sjors Provoost <sjors@purpledunes.com>', trusted=False, status='')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('A7BEB2621678D37D', 'vertion <vertion@protonmail.com>', trusted=False, status='expired')\r\n[INFO] GOOD SIGNATURE (untrusted): SigData('099BAD163C70FBFA', 'Will Clark <will8clark@gmail.com>', trusted=False, status='')\r\n[WARNING] key D7CC770B81FD22A8 for Ben Carman <benthecarman@live.com> is expired\r\n[WARNING] key A7BEB2621678D37D for vertion <vertion@protonmail.com> is expired\r\n[INFO] removing *-unsigned binaries (bitcoin-23.0-arm64-apple-darwin-unsigned.dmg, bitcoin-23.0-arm64-apple-darwin-unsigned.tar.gz, bitcoin-23.0-x86_64-apple-darwin-unsigned.dmg, bitcoin-23.0-x86_64-apple-darwin-unsigned.tar.gz, bitcoin-23.0-win64-setup-unsigned.exe, bitcoin-23.0-win64-unsigned.tar.gz) from verification since https://bitcoincore.org does not host *-unsigned binaries\r\n[INFO] removing *-debug binaries (bitcoin-23.0-aarch64-linux-gnu-debug.tar.gz, bitcoin-23.0-arm-linux-gnueabihf-debug.tar.gz, bitcoin-23.0-powerpc64-linux-gnu-debug.tar.gz, bitcoin-23.0-powerpc64le-linux-gnu-debug.tar.gz, bitcoin-23.0-riscv64-linux-gnu-debug.tar.gz, bitcoin-23.0-x86_64-linux-gnu-debug.tar.gz, bitcoin-23.0-win64-debug.zip) from verification since https://bitcoincore.org does not host *-debug binaries\r\n[INFO] removing *-codesignatures binaries (bitcoin-23.0-codesignatures-e36a046909ad.tar.gz) from verification since https://bitcoincore.org does not host *-codesignatures binaries\r\n[INFO] downloading bitcoin-23.0-aarch64-linux-gnu.tar.gz\r\n [INFO] downloading bitcoin-23.0-arm-linux-gnueabihf.tar.gz\r\n[INFO] downloading bitcoin-23.0-arm64-apple-darwin.dmg\r\n[INFO] downloading bitcoin-23.0-arm64-apple-darwin.tar.gz\r\n[INFO] downloading bitcoin-23.0.tar.gz\r\n[INFO] downloading bitcoin-23.0-powerpc64-linux-gnu.tar.gz\r\n[INFO] downloading bitcoin-23.0-powerpc64le-linux-gnu.tar.gz\r\n[INFO] downloading bitcoin-23.0-riscv64-linux-gnu.tar.gz\r\n[INFO] downloading bitcoin-23.0-x86_64-apple-darwin.dmg\r\n[INFO] downloading bitcoin-23.0-x86_64-apple-darwin.tar.gz\r\n[INFO] downloading bitcoin-23.0-x86_64-linux-gnu.tar.gz\r\n[INFO] downloading bitcoin-23.0-win64-setup.exe\r\n[INFO] downloading bitcoin-23.0-win64.zip\r\n[INFO] did not clean up /tmp/bitcoin_verify_binaries.bitcoin-core-23.0-x86_64\r\nVERIFIED: bitcoin-23.0-aarch64-linux-gnu.tar.gz\r\nVERIFIED: bitcoin-23.0-arm-linux-gnueabihf.tar.gz\r\nVERIFIED: bitcoin-23.0-arm64-apple-darwin.dmg\r\nVERIFIED: bitcoin-23.0-arm64-apple-darwin.tar.gz\r\nVERIFIED: bitcoin-23.0.tar.gz\r\nVERIFIED: bitcoin-23.0-powerpc64-linux-gnu.tar.gz\r\nVERIFIED: bitcoin-23.0-powerpc64le-linux-gnu.tar.gz\r\nVERIFIED: bitcoin-23.0-riscv64-linux-gnu.tar.gz\r\nVERIFIED: bitcoin-23.0-x86_64-apple-darwin.dmg\r\nVERIFIED: bitcoin-23.0-x86_64-apple-darwin.tar.gz\r\nVERIFIED: bitcoin-23.0-x86_64-linux-gnu.tar.gz\r\nVERIFIED: bitcoin-23.0-win64-setup.exe\r\nVERIFIED: bitcoin-23.0-win64.zip\r\n```",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1488262940",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "mentioned",
      "id": 8874133616,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIQ8Ihw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8874133616",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-29T09:33:19Z"
    },
    {
      "event": "subscribed",
      "id": 8874133649,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIQ8IiR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8874133649",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-29T09:33:19Z"
    },
    {
      "event": "commented",
      "id": 1488268728,
      "node_id": "IC_kwDOABII585YtS24",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1488268728",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-29T09:37:28Z",
      "updated_at": "2023-03-29T09:37:28Z",
      "author_association": "CONTRIBUTOR",
      "body": "> @TheCharlatan I see it working using e.g. the pub subcommand. You need to choose pub or bin to verify either the publicly-hosted binaries, or bin for a local binary. But you are correct the docs are now outdated...\r\n\r\nMmh, shouldn't the sample command you posted only have verified x86_64 binaries?",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1488268728",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "mentioned",
      "id": 8874184336,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIQ8U6Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8874184336",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-29T09:37:29Z"
    },
    {
      "event": "subscribed",
      "id": 8874184355,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIQ8U6j",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8874184355",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-29T09:37:29Z"
    },
    {
      "event": "commented",
      "id": 1488270531,
      "node_id": "IC_kwDOABII585YtTTD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1488270531",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-29T09:38:46Z",
      "updated_at": "2023-03-29T09:38:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "Yes, there does seem to be quite a few other issues in testing currently. Just wanted to let you know how to get the thing running :)",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1488270531",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "reviewed",
      "id": 1362398649,
      "node_id": "PRR_kwDOABII585RNI25",
      "url": null,
      "actor": null,
      "commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#pullrequestreview-1362398649",
      "submitted_at": "2023-03-29T09:40:36Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
    },
    {
      "event": "commented",
      "id": 1490874473,
      "node_id": "IC_kwDOABII585Y3PBp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1490874473",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-30T20:02:34Z",
      "updated_at": "2023-03-30T20:02:34Z",
      "author_association": "MEMBER",
      "body": "> > @TheCharlatan I see it working using e.g. the pub subcommand. You need to choose pub or bin to verify either the publicly-hosted binaries, or bin for a local binary. But you are correct the docs are now outdated...\r\n> \r\n> Mmh, shouldn't the sample command you posted only have verified x86_64 binaries?\r\n\r\nMmm, yeah, this is awkward. @achow101's original changes forced the user to specify which binaries should be checked. I requested using the contents of the SHA256SUMS file instead.\r\n\r\nThe problem with teaching the `bin` command the version syntax from `pub` is that that syntax is pretty remote-url centric. So I'm not sure it makes sense to allow the user to use the same type of filter for `bin`.\r\n\r\nShould we just go back to requiring the user to specify the bins? Downloading to a clean dir and using a wildcard should still work for tooling I think. @TheBlueMatt ?",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1490874473",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "mentioned",
      "id": 8891395861,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIR9-8V",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8891395861",
      "actor": {
        "login": "TheBlueMatt",
        "id": 649246,
        "node_id": "MDQ6VXNlcjY0OTI0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheBlueMatt",
        "html_url": "https://github.com/TheBlueMatt",
        "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
        "following_url": "https://api.github.com/users/TheBlueMatt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheBlueMatt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheBlueMatt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
        "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
        "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
        "events_url": "https://api.github.com/users/TheBlueMatt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-30T20:02:34Z"
    },
    {
      "event": "subscribed",
      "id": 8891395874,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIR9-8i",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8891395874",
      "actor": {
        "login": "TheBlueMatt",
        "id": 649246,
        "node_id": "MDQ6VXNlcjY0OTI0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheBlueMatt",
        "html_url": "https://github.com/TheBlueMatt",
        "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
        "following_url": "https://api.github.com/users/TheBlueMatt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheBlueMatt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheBlueMatt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
        "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
        "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
        "events_url": "https://api.github.com/users/TheBlueMatt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-30T20:02:34Z"
    },
    {
      "event": "mentioned",
      "id": 8891395893,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIR9-81",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8891395893",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-30T20:02:34Z"
    },
    {
      "event": "subscribed",
      "id": 8891395909,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIR9-9F",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8891395909",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-30T20:02:35Z"
    },
    {
      "event": "mentioned",
      "id": 8891395920,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIR9-9Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8891395920",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-30T20:02:35Z"
    },
    {
      "event": "subscribed",
      "id": 8891395933,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIR9-9d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8891395933",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-30T20:02:35Z"
    },
    {
      "event": "reviewed",
      "id": 1366759702,
      "node_id": "PRR_kwDOABII585RdxkW",
      "url": null,
      "actor": null,
      "commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#pullrequestreview-1366759702",
      "submitted_at": "2023-03-31T11:25:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
    },
    {
      "event": "reviewed",
      "id": 1368737986,
      "node_id": "PRR_kwDOABII585RlUjC",
      "url": null,
      "actor": null,
      "commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#pullrequestreview-1368737986",
      "submitted_at": "2023-04-03T10:53:39Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
    },
    {
      "event": "commented",
      "id": 1494803900,
      "node_id": "IC_kwDOABII585ZGOW8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1494803900",
      "actor": {
        "login": "TheBlueMatt",
        "id": 649246,
        "node_id": "MDQ6VXNlcjY0OTI0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheBlueMatt",
        "html_url": "https://github.com/TheBlueMatt",
        "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
        "following_url": "https://api.github.com/users/TheBlueMatt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheBlueMatt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheBlueMatt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
        "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
        "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
        "events_url": "https://api.github.com/users/TheBlueMatt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-03T18:44:23Z",
      "updated_at": "2023-04-03T18:44:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Downloading to a clean dir and using a wildcard should still work for tooling I think. @TheBlueMatt ?\r\n\r\nNot sure exactly what you mean here - part of the goal is to have tooling to verify all the binaries sitting in a folder? If you can \"download\" all of them in one go from `file:///` I guess that works too?",
      "user": {
        "login": "TheBlueMatt",
        "id": 649246,
        "node_id": "MDQ6VXNlcjY0OTI0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheBlueMatt",
        "html_url": "https://github.com/TheBlueMatt",
        "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
        "following_url": "https://api.github.com/users/TheBlueMatt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheBlueMatt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheBlueMatt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
        "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
        "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
        "events_url": "https://api.github.com/users/TheBlueMatt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1494803900",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "mentioned",
      "id": 8916234109,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAITcu99",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8916234109",
      "actor": {
        "login": "TheBlueMatt",
        "id": 649246,
        "node_id": "MDQ6VXNlcjY0OTI0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheBlueMatt",
        "html_url": "https://github.com/TheBlueMatt",
        "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
        "following_url": "https://api.github.com/users/TheBlueMatt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheBlueMatt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheBlueMatt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
        "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
        "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
        "events_url": "https://api.github.com/users/TheBlueMatt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-03T18:44:23Z"
    },
    {
      "event": "subscribed",
      "id": 8916234130,
      "node_id": "SE_lADOABII585iB4vJzwAAAAITcu-S",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8916234130",
      "actor": {
        "login": "TheBlueMatt",
        "id": 649246,
        "node_id": "MDQ6VXNlcjY0OTI0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheBlueMatt",
        "html_url": "https://github.com/TheBlueMatt",
        "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
        "following_url": "https://api.github.com/users/TheBlueMatt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheBlueMatt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheBlueMatt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
        "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
        "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
        "events_url": "https://api.github.com/users/TheBlueMatt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-03T18:44:24Z"
    },
    {
      "event": "commented",
      "id": 1496637445,
      "node_id": "IC_kwDOABII585ZNOAF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1496637445",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-04T21:38:43Z",
      "updated_at": "2023-04-04T21:38:43Z",
      "author_association": "MEMBER",
      "body": "I believe I've addressed the comments here. I've chosen to add fresh comments on top rather than squashing to avoid mixing up my changes on top of @jamesob's/@achow101's.\r\n\r\nThe os/arch filters like `verify.py 22.0-osx` no longer work for me and I'm not quite sure why. Otherwise remote/local verification seem to work ok.",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1496637445",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "mentioned",
      "id": 8929070745,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIUNs6Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8929070745",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-04T21:38:43Z"
    },
    {
      "event": "subscribed",
      "id": 8929070754,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIUNs6i",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8929070754",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-04T21:38:44Z"
    },
    {
      "event": "mentioned",
      "id": 8929070772,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIUNs60",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8929070772",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-04T21:38:44Z"
    },
    {
      "event": "subscribed",
      "id": 8929070789,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIUNs7F",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8929070789",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-04T21:38:44Z"
    },
    {
      "event": "reviewed",
      "id": 1372922838,
      "node_id": "PRR_kwDOABII585R1SPW",
      "url": null,
      "actor": null,
      "commit_id": "da864a554d75ab440907fbce2476e2c8d0ac2e93",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Did some basic testing that this \"works\". I wouldn't like to hold merging this up past a good-enough state, so happy for comments/nits/follows to be addressed soon after.",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#pullrequestreview-1372922838",
      "submitted_at": "2023-04-05T13:43:10Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8936871197,
      "node_id": "HRFPE_lADOABII585iB4vJzwAAAAIUrdUd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8936871197",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-05T15:57:42Z"
    },
    {
      "event": "commented",
      "id": 1497743020,
      "node_id": "IC_kwDOABII585ZRb6s",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1497743020",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-05T15:59:52Z",
      "updated_at": "2023-04-05T22:13:05Z",
      "author_association": "MEMBER",
      "body": "Thanks for the review @fanquake, comments addressed.\r\n\r\nLMK if you'd like me to squash. I could either squash mine into the original authors' or mine all into one \"fixup\" on top of theirs.\r\n\r\nEdit: @glozow thanks for the review as well!",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1497743020",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "mentioned",
      "id": 8936895169,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIUrjLB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8936895169",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-05T15:59:52Z"
    },
    {
      "event": "subscribed",
      "id": 8936895194,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIUrjLa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8936895194",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-05T15:59:53Z"
    },
    {
      "event": "commented",
      "id": 1497757188,
      "node_id": "IC_kwDOABII585ZRfYE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1497757188",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-05T16:07:28Z",
      "updated_at": "2023-04-05T16:07:28Z",
      "author_association": "MEMBER",
      "body": "@theuni I don't particularly mind. I think the commits here look ok as-is. If you want to squash them all down into a fixup, that's probably also ok, but going to be a bit messy. Squashing all the changes back into the original commits is probably going to be more messy again.",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1497757188",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "mentioned",
      "id": 8936978813,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIUr3l9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8936978813",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-05T16:07:28Z"
    },
    {
      "event": "subscribed",
      "id": 8936978837,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIUr3mV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8936978837",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-05T16:07:29Z"
    },
    {
      "event": "mentioned",
      "id": 8939887252,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIU29qU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8939887252",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-05T22:13:06Z"
    },
    {
      "event": "subscribed",
      "id": 8939887271,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIU29qn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8939887271",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-05T22:13:06Z"
    },
    {
      "event": "reviewed",
      "id": 1374386088,
      "node_id": "PRR_kwDOABII585R63eo",
      "url": null,
      "actor": null,
      "commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#pullrequestreview-1374386088",
      "submitted_at": "2023-04-06T09:06:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
    },
    {
      "event": "reviewed",
      "id": 1374445179,
      "node_id": "PRR_kwDOABII585R7F57",
      "url": null,
      "actor": null,
      "commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK\r\n\r\nDownloading for a specific platform doesn't work, so I'd suggest we either fix it before merging or remove it from the docs. I also left a few other nits but they aren't important.",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#pullrequestreview-1374445179",
      "submitted_at": "2023-04-06T10:02:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
    },
    {
      "event": "reviewed",
      "id": 1374562702,
      "node_id": "PRR_kwDOABII585R7imO",
      "url": null,
      "actor": null,
      "commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#pullrequestreview-1374562702",
      "submitted_at": "2023-04-06T10:30:39Z",
      "state": "CHANGES_REQUESTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
    },
    {
      "event": "commented",
      "id": 1498855527,
      "node_id": "IC_kwDOABII585ZVrhn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1498855527",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-06T10:35:44Z",
      "updated_at": "2023-04-06T10:35:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "Nit: After discovering https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1159606675 I ran `mypy verify.py` and:\r\n```\r\nverify.py:129: error: Module has no attribute \"HTTPError\"\r\nverify.py:588: error: Argument 1 to \"verify_shasums_signature\" has incompatible type \"Path\"; expected \"str\"\r\nFound 2 errors in 1 file (checked 1 source file)\r\n```",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1498855527",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "reviewed",
      "id": 1374667038,
      "node_id": "PRR_kwDOABII585R78Ee",
      "url": null,
      "actor": null,
      "commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#pullrequestreview-1374667038",
      "submitted_at": "2023-04-06T11:24:10Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM0NDMyM2E3MTcwNWI2ZGY5YWFmZTkwZGYyNDA3MmU3MzVhNWMyZmY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c44323a71705b6df9aafe90df24072e735a5c2ff",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c44323a71705b6df9aafe90df24072e735a5c2ff",
      "tree": {
        "sha": "4035ab9f056fe43729c25393fb73726ddd84cf71",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4035ab9f056fe43729c25393fb73726ddd84cf71"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
          "sha": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7a6e7ffd066a42c5fbb7d69effbe074fb982936b"
        }
      ],
      "message": "verifybinaries: move all current examples to the pub subcommand",
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-06T19:13:35Z"
      },
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-04T19:45:53Z"
      },
      "sha": "c44323a71705b6df9aafe90df24072e735a5c2ff"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDZkMTE4MzAyNjU0NDgxOTI3ZTg2NGE0Mjg5NTA5NjBlMjZlYjdmNGE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6d118302654481927e864a428950960e26eb7f4a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6d118302654481927e864a428950960e26eb7f4a",
      "tree": {
        "sha": "fb18b22e82f3376073929c97df1815582dd8d6fa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fb18b22e82f3376073929c97df1815582dd8d6fa"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c44323a71705b6df9aafe90df24072e735a5c2ff",
          "sha": "c44323a71705b6df9aafe90df24072e735a5c2ff",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c44323a71705b6df9aafe90df24072e735a5c2ff"
        }
      ],
      "message": "verifybinaries: remove awkward bitcoin-core prefix handling",
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-06T19:13:35Z"
      },
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-04T20:34:58Z"
      },
      "sha": "6d118302654481927e864a428950960e26eb7f4a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQ2YzczYjU3YzY5OTMzZDdlYjUyZTI4NTk1NjA5ZTc5M2U4ZWVmNmU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/46c73b57c69933d7eb52e28595609e793e8eef6e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/46c73b57c69933d7eb52e28595609e793e8eef6e",
      "tree": {
        "sha": "ee7ebe17f3fa05a4cbfa0d6df5ea067bbfcb05b4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ee7ebe17f3fa05a4cbfa0d6df5ea067bbfcb05b4"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6d118302654481927e864a428950960e26eb7f4a",
          "sha": "6d118302654481927e864a428950960e26eb7f4a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6d118302654481927e864a428950960e26eb7f4a"
        }
      ],
      "message": "verifybinaries: README cleanups\n\n- Use correct name for verify.py\n- Add usage examples for verifybinaries bin\n- Document proper use of new cleanup option\n- Fixup broken example",
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-06T19:32:18Z"
      },
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-04T21:09:42Z"
      },
      "sha": "46c73b57c69933d7eb52e28595609e793e8eef6e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDU2NjhjNjQ3M2EwMTUyOGFjN2Q2NmIzMjViMThiMWNkMmJkOTMwNjM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5668c6473a01528ac7d66b325b18b1cd2bd93063",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5668c6473a01528ac7d66b325b18b1cd2bd93063",
      "tree": {
        "sha": "a058d864fdb92a5d450a142e9d47ddc2f88e6f3a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a058d864fdb92a5d450a142e9d47ddc2f88e6f3a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/46c73b57c69933d7eb52e28595609e793e8eef6e",
          "sha": "46c73b57c69933d7eb52e28595609e793e8eef6e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/46c73b57c69933d7eb52e28595609e793e8eef6e"
        }
      ],
      "message": "verifybinaries: Don't delete shasums file\n\nIt may be useful for local validation.",
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-06T19:32:18Z"
      },
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-04T20:36:04Z"
      },
      "sha": "5668c6473a01528ac7d66b325b18b1cd2bd93063"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRlMDM5NjgzNWRkOTMzYTI4NDQ2ODQ0ZGEyOTQwNDAzNDVmMmU2YWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4e0396835dd933a28446844da294040345f2e6ad",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4e0396835dd933a28446844da294040345f2e6ad",
      "tree": {
        "sha": "f041424a2a22554599c59b73df3311aaef9feea3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f041424a2a22554599c59b73df3311aaef9feea3"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5668c6473a01528ac7d66b325b18b1cd2bd93063",
          "sha": "5668c6473a01528ac7d66b325b18b1cd2bd93063",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5668c6473a01528ac7d66b325b18b1cd2bd93063"
        }
      ],
      "message": "verifybinaries: remove unreachable code",
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-06T19:32:18Z"
      },
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-04T21:28:14Z"
      },
      "sha": "4e0396835dd933a28446844da294040345f2e6ad"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhjZGFkZDE3Mjk3ZTVmNDQ4NzY5MmVhZTg4YjFlNjBhNDJjOGM0YjI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8cdadd17297e5f4487692eae88b1e60a42c8c4b2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8cdadd17297e5f4487692eae88b1e60a42c8c4b2",
      "tree": {
        "sha": "9cf52bec7970235853b902d0a1f045850594277b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9cf52bec7970235853b902d0a1f045850594277b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4e0396835dd933a28446844da294040345f2e6ad",
          "sha": "4e0396835dd933a28446844da294040345f2e6ad",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4e0396835dd933a28446844da294040345f2e6ad"
        }
      ],
      "message": "verifybinaries: use recommended keyserver by default",
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-06T19:32:18Z"
      },
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-05T15:48:09Z"
      },
      "sha": "8cdadd17297e5f4487692eae88b1e60a42c8c4b2"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRiMjNiNDg4ZDJjNTY2MjIxNWQ3OGU0OTYzZWY1YTJiODZiNGUyNWI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4b23b488d2c5662215d78e4963ef5a2b86b4e25b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4b23b488d2c5662215d78e4963ef5a2b86b4e25b",
      "tree": {
        "sha": "71a871eed32bc1c76e0818e46115bfb2a4c6d2c1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/71a871eed32bc1c76e0818e46115bfb2a4c6d2c1"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8cdadd17297e5f4487692eae88b1e60a42c8c4b2",
          "sha": "8cdadd17297e5f4487692eae88b1e60a42c8c4b2",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8cdadd17297e5f4487692eae88b1e60a42c8c4b2"
        }
      ],
      "message": "verifybinaries: fix OS download filter\n\nCo-authored-by: Reproducibility Matters <seb.kung@gmail.com>",
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-06T19:32:18Z"
      },
      "author": {
        "name": "Cory Fields",
        "email": "theuni@users.noreply.github.com",
        "date": "2023-04-06T19:16:28Z"
      },
      "sha": "4b23b488d2c5662215d78e4963ef5a2b86b4e25b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhhNjVlNTE0NWM0ZDEyOGJiNmMzMGM5NGU2ODQzNGRkNDgyZGI0ODk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8a65e5145c4d128bb6c30c94e68434dd482db489",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8a65e5145c4d128bb6c30c94e68434dd482db489",
      "tree": {
        "sha": "a46d0ab0fe119d90e505793200bcdd01880974d8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a46d0ab0fe119d90e505793200bcdd01880974d8"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4b23b488d2c5662215d78e4963ef5a2b86b4e25b",
          "sha": "4b23b488d2c5662215d78e4963ef5a2b86b4e25b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4b23b488d2c5662215d78e4963ef5a2b86b4e25b"
        }
      ],
      "message": "verifybinaries: catch the correct exception",
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-06T19:57:25Z"
      },
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-06T19:35:54Z"
      },
      "sha": "8a65e5145c4d128bb6c30c94e68434dd482db489"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc1NGZiNmJiODEyNTMxNzU3NWVkZWM3YzIwYjU2MTdhZDI3YTliZGQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "tree": {
        "sha": "ecc69fd3cd28ac099918a123803e04c4e16ac169",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ecc69fd3cd28ac099918a123803e04c4e16ac169"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8a65e5145c4d128bb6c30c94e68434dd482db489",
          "sha": "8a65e5145c4d128bb6c30c94e68434dd482db489",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8a65e5145c4d128bb6c30c94e68434dd482db489"
        }
      ],
      "message": "verifybinaries: fix argument type error pointed out by mypy",
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-06T19:57:25Z"
      },
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2023-04-06T19:56:50Z"
      },
      "sha": "754fb6bb8125317575edec7c20b5617ad27a9bdd"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 8949266422,
      "node_id": "HRFPE_lADOABII585iB4vJzwAAAAIVavf2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8949266422",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-06T19:58:20Z"
    },
    {
      "event": "commented",
      "id": 1499550445,
      "node_id": "IC_kwDOABII585ZYVLt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1499550445",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-06T20:02:31Z",
      "updated_at": "2023-04-06T20:02:31Z",
      "author_association": "MEMBER",
      "body": "Thanks for the review @TheCharlatan and @josibake. I've addressed most of the feedback with the exception of a few nits as I don't want this to drag out forever.\r\n\r\nI squashed some of the readme changes to keep the number of commits down. The diff from the previous changes can be seen with: `git diff 96344222f3..754fb6bb81` .",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1499550445",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "mentioned",
      "id": 8949293883,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIVa2M7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8949293883",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-06T20:02:31Z"
    },
    {
      "event": "subscribed",
      "id": 8949293893,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIVa2NF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8949293893",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-06T20:02:32Z"
    },
    {
      "event": "mentioned",
      "id": 8949293901,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIVa2NN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8949293901",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-06T20:02:32Z"
    },
    {
      "event": "subscribed",
      "id": 8949293911,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIVa2NX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8949293911",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-06T20:02:32Z"
    },
    {
      "event": "commented",
      "id": 1499652736,
      "node_id": "IC_kwDOABII585ZYuKA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1499652736",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-06T21:31:02Z",
      "updated_at": "2023-04-06T21:31:02Z",
      "author_association": "MEMBER",
      "body": "ACK https://github.com/bitcoin/bitcoin/pull/27358/commits/754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1499652736",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "commented",
      "id": 1500021194,
      "node_id": "IC_kwDOABII585ZaIHK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1500021194",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-07T07:26:32Z",
      "updated_at": "2023-04-07T07:26:32Z",
      "author_association": "MEMBER",
      "body": "We can have a followup, to address any further issues/improvements.",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1500021194",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "merged",
      "id": 8952051765,
      "node_id": "ME_lADOABII585iB4vJzwAAAAIVlXg1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8952051765",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "db720b5a703c90625fa7a4773bd2db5672427cbe",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/db720b5a703c90625fa7a4773bd2db5672427cbe",
      "created_at": "2023-04-07T07:26:59Z"
    },
    {
      "event": "closed",
      "id": 8952051796,
      "node_id": "CE_lADOABII585iB4vJzwAAAAIVlXhU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8952051796",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-07T07:26:59Z"
    },
    {
      "event": "commented",
      "id": 1500209136,
      "node_id": "IC_kwDOABII585Za1_w",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1500209136",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-07T11:38:01Z",
      "updated_at": "2023-04-07T11:39:06Z",
      "author_association": "MEMBER",
      "body": "Followup suggestions:\r\n\r\n1. allow user to specify the domain(s), e.g. `--domain=bitcoincore.org` so you don't get warnings about bitcoin.org, which only has up to version 22.0 at the moment. Conversely, it will make a future domain evacuation safer.\r\n\r\n2. \"osx\" in the documentation example should be \"macos\" (but it doesn't work either way as @theuni found)\r\n\r\n3. \"The os/arch filters like verify.py 22.0-osx no longer work for me and I'm not quite sure why.\" - would be nice to restore this, or just file a Github issue and remove it from the docs\r\n",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1500209136",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "mentioned",
      "id": 8953340314,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIVqSGa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8953340314",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-07T11:38:01Z"
    },
    {
      "event": "subscribed",
      "id": 8953340318,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIVqSGe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8953340318",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-07T11:38:01Z"
    },
    {
      "event": "commented",
      "id": 1500309723,
      "node_id": "IC_kwDOABII585ZbOjb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1500309723",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-07T13:53:04Z",
      "updated_at": "2023-04-07T13:55:54Z",
      "author_association": "MEMBER",
      "body": "@Sjors That filter problem should've been fixed by https://github.com/bitcoin/bitcoin/pull/27358/commits/4b23b488d2c5662215d78e4963ef5a2b86b4e25b, my comment was from before then. Is what's now in master still broken for you?\r\n\r\nEdit: Also, agreed on your first suggestion.",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1500309723",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "mentioned",
      "id": 8954000602,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIVszTa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8954000602",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-07T13:53:05Z"
    },
    {
      "event": "subscribed",
      "id": 8954000609,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIVszTh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8954000609",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-07T13:53:05Z"
    },
    {
      "event": "commented",
      "id": 1500348764,
      "node_id": "IC_kwDOABII585ZbYFc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1500348764",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-07T14:39:01Z",
      "updated_at": "2023-04-07T14:39:55Z",
      "author_association": "MEMBER",
      "body": "@theuni yes. On Intel macOS 13.3:\r\n\r\n```\r\n % ./contrib/verifybinaries/verify.py pub 24.0.1-osx \r\nâ€¦\r\n[ERROR] no files matched the platform specified\r\n```\r\n\r\nDitto for `24.0.1-macos`\r\n\r\nAh, `-darwin` works, so it's just a matter of updating the doc.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1500348764",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "mentioned",
      "id": 8954256720,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIVtx1Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8954256720",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-07T14:39:01Z"
    },
    {
      "event": "subscribed",
      "id": 8954256731,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIVtx1b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8954256731",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-07T14:39:01Z"
    },
    {
      "event": "commented",
      "id": 1500389847,
      "node_id": "IC_kwDOABII585ZbiHX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1500389847",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-07T15:28:30Z",
      "updated_at": "2023-04-07T15:28:30Z",
      "author_association": "MEMBER",
      "body": "@Sjors the filter works almost like a grep, so it depends on the release. Starting with v23 the apple binaries were renamed.",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1500389847",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "mentioned",
      "id": 8954559146,
      "node_id": "MEE_lADOABII585iB4vJzwAAAAIVu7qq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8954559146",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-07T15:28:30Z"
    },
    {
      "event": "subscribed",
      "id": 8954559155,
      "node_id": "SE_lADOABII585iB4vJzwAAAAIVu7qz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8954559155",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-07T15:28:30Z"
    },
    {
      "event": "referenced",
      "id": 8956690845,
      "node_id": "REFE_lADOABII585iB4vJzwAAAAIV3EGd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8956690845",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "79968d1ebcdd01cee650bf96eddcf365e7cc4bf2",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/79968d1ebcdd01cee650bf96eddcf365e7cc4bf2",
      "created_at": "2023-04-08T00:06:44Z"
    },
    {
      "event": "referenced",
      "id": 8958926623,
      "node_id": "REFE_lADOABII585iB4vJzwAAAAIV_l8f",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8958926623",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "c18f8b3b22e017fc86fbbf27cf81fe913f258f8b",
      "commit_url": "https://api.github.com/repos/fanquake/bitcoin/commits/c18f8b3b22e017fc86fbbf27cf81fe913f258f8b",
      "created_at": "2023-04-09T10:34:44Z"
    },
    {
      "event": "referenced",
      "id": 8958941554,
      "node_id": "REFE_lADOABII585iB4vJzwAAAAIV_ply",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8958941554",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "bfb0f4b3e049db37d8584679718824fe314c0b08",
      "commit_url": "https://api.github.com/repos/fanquake/bitcoin/commits/bfb0f4b3e049db37d8584679718824fe314c0b08",
      "created_at": "2023-04-09T10:49:33Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-09T10:50:12Z",
      "updated_at": "2023-04-09T10:50:12Z",
      "source": {
        "issue": {
          "id": 1659833323,
          "node_id": "PR_kwDOABII585N4uvi",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27440",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27440/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27440/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27440/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/27440",
          "number": 27440,
          "state": "closed",
          "state_reason": null,
          "title": "contrib: followups to #27358 (verify-binaries)",
          "body": "Followup to #27358, fixing up the example command docs and other requests. See https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1500389847.",
          "user": {
            "login": "fanquake",
            "id": 863730,
            "node_id": "MDQ6VXNlcjg2MzczMA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fanquake",
            "html_url": "https://github.com/fanquake",
            "followers_url": "https://api.github.com/users/fanquake/followers",
            "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
            "organizations_url": "https://api.github.com/users/fanquake/orgs",
            "repos_url": "https://api.github.com/users/fanquake/repos",
            "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/fanquake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 231994551,
              "node_id": "MDU6TGFiZWwyMzE5OTQ1NTE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Scripts%20and%20tools",
              "name": "Scripts and tools",
              "color": "ffffee",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27440",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/27440",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/27440.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/27440.patch"
          },
          "closed_at": "2023-04-11T01:19:47Z",
          "created_at": "2023-04-09T10:50:12Z",
          "updated_at": "2023-04-11T06:26:08Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1501099918,
      "node_id": "IC_kwDOABII585ZePeO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1501099918",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-04-09T10:51:18Z",
      "updated_at": "2023-04-09T10:51:18Z",
      "author_association": "MEMBER",
      "body": "Covered most of the followup requests in #27440.",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#issuecomment-1501099918",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27358"
    },
    {
      "event": "referenced",
      "id": 8958964583,
      "node_id": "REFE_lADOABII585iB4vJzwAAAAIV_vNn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8958964583",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "e2e5683afe1bd286e247288abec033ca467932bd",
      "commit_url": "https://api.github.com/repos/fanquake/bitcoin/commits/e2e5683afe1bd286e247288abec033ca467932bd",
      "created_at": "2023-04-09T11:08:58Z"
    },
    {
      "event": "referenced",
      "id": 8968422069,
      "node_id": "REFE_lADOABII585iB4vJzwAAAAIWj0K1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8968422069",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "9270a56662e19a961e2c15139db950af79d48c61",
      "commit_url": "https://api.github.com/repos/bitcoin-core/gui/commits/9270a56662e19a961e2c15139db950af79d48c61",
      "created_at": "2023-04-11T01:19:44Z"
    },
    {
      "event": "referenced",
      "id": 8968770153,
      "node_id": "REFE_lADOABII585iB4vJzwAAAAIWlJJp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/8968770153",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "e4cb1a7d096d422a3e100a015aee3548d64cbf17",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/e4cb1a7d096d422a3e100a015aee3548d64cbf17",
      "created_at": "2023-04-11T02:47:18Z"
    },
    {
      "event": "referenced",
      "id": 9356917927,
      "node_id": "REFE_lADOABII585iB4vJzwAAAAIttzyn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9356917927",
      "actor": {
        "login": "RandyMcMillan",
        "id": 152159,
        "node_id": "MDQ6VXNlcjE1MjE1OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/152159?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RandyMcMillan",
        "html_url": "https://github.com/RandyMcMillan",
        "followers_url": "https://api.github.com/users/RandyMcMillan/followers",
        "following_url": "https://api.github.com/users/RandyMcMillan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RandyMcMillan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RandyMcMillan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RandyMcMillan/subscriptions",
        "organizations_url": "https://api.github.com/users/RandyMcMillan/orgs",
        "repos_url": "https://api.github.com/users/RandyMcMillan/repos",
        "events_url": "https://api.github.com/users/RandyMcMillan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RandyMcMillan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "39751d2ee573b2c35cbf5860407e7242788a9a41",
      "commit_url": "https://api.github.com/repos/RandyMcMillan/bitcoin/commits/39751d2ee573b2c35cbf5860407e7242788a9a41",
      "created_at": "2023-05-27T11:21:59Z"
    },
    {
      "event": "locked",
      "id": 12392276428,
      "node_id": "LOE_lADOABII585iB4vJzwAAAALioyHM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12392276428",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-08T12:41:54Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1151165179",
      "pull_request_review_id": 1361927312,
      "id": 1151165179,
      "node_id": "PRRC_kwDOABII585EnWL7",
      "diff_hunk": "@@ -1,30 +1,77 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to ",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 24,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "dd6b1ce5d956fe585a8f4ecab2cdda9c6aba352b",
      "in_reply_to_id": null,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "2e187ffafc9cb0490eedd079ce1cfffafecd9dba: trailing whitespace\r\n```suggestion\r\n  - you can run the packaged `verifybinaries.py ... --import-keys` script to\r\n```",
      "created_at": "2023-03-28T21:22:48Z",
      "updated_at": "2023-03-28T21:22:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1151165179",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1151165179"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 20,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1151491320",
      "pull_request_review_id": 1362398649,
      "id": 1151491320,
      "node_id": "PRRC_kwDOABII585Eolz4",
      "diff_hunk": "@@ -0,0 +1,59 @@\n+#!/usr/bin/env python3",
      "path": "contrib/verifybinaries/test.py",
      "position": 1,
      "original_position": 1,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nittiest of nits: There already is a `verify-commits`, so I think the directory should be `verify-binaries`.",
      "created_at": "2023-03-29T07:16:46Z",
      "updated_at": "2023-03-29T09:40:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1151491320",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1151491320"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1151503567",
      "pull_request_review_id": 1362398649,
      "id": 1151503567,
      "node_id": "PRRC_kwDOABII585EoozP",
      "diff_hunk": "@@ -1,30 +1,77 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 24,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Where is this packaging step renaming `verify.py` to `verifybinaries.py` defined?",
      "created_at": "2023-03-29T07:28:22Z",
      "updated_at": "2023-03-29T09:40:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1151503567",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1151503567"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 20,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1151519024",
      "pull_request_review_id": 1362398649,
      "id": 1151519024,
      "node_id": "PRRC_kwDOABII585Eoskw",
      "diff_hunk": "@@ -1,30 +1,77 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n+```sh\n+./contrib/verifybinaries/verify.py 22.0",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 49,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "These examples lack the the `pub` or `bin` args, no?",
      "created_at": "2023-03-29T07:42:38Z",
      "updated_at": "2023-03-29T09:40:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1151519024",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1151519024"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 45,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1151524134",
      "pull_request_review_id": 1362398649,
      "id": 1151524134,
      "node_id": "PRRC_kwDOABII585Eot0m",
      "diff_hunk": "@@ -1,30 +1,77 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n+```sh\n+./contrib/verifybinaries/verify.py 22.0\n+./contrib/verifybinaries/verify.py 22.0-rc2\n+./contrib/verifybinaries/verify.py bitcoin-core-23.0",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 51,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "What is the rationale for adding the `bitcoin-core` prefix to the example?",
      "created_at": "2023-03-29T07:47:23Z",
      "updated_at": "2023-03-29T09:40:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1151524134",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1151524134"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 47,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1153728573",
      "pull_request_review_id": 1365835441,
      "id": 1153728573,
      "node_id": "PRRC_kwDOABII585ExIA9",
      "diff_hunk": "@@ -1,30 +1,77 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n+```sh\n+./contrib/verifybinaries/verify.py 22.0\n+./contrib/verifybinaries/verify.py 22.0-rc2\n+./contrib/verifybinaries/verify.py bitcoin-core-23.0",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 51,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "in_reply_to_id": 1151524134,
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This isn't clear to me either.",
      "created_at": "2023-03-30T19:57:56Z",
      "updated_at": "2023-03-30T19:57:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1153728573",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1153728573"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 47,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154356697",
      "pull_request_review_id": 1366757806,
      "id": 1154356697,
      "node_id": "PRRC_kwDOABII585EzhXZ",
      "diff_hunk": "@@ -1,30 +1,77 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n+```sh\n+./contrib/verifybinaries/verify.py 22.0\n+./contrib/verifybinaries/verify.py 22.0-rc2\n+./contrib/verifybinaries/verify.py bitcoin-core-23.0",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 51,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "in_reply_to_id": 1151524134,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "[I mentioned in the original PR, that I think this can just be dropped](https://github.com/bitcoin/bitcoin/pull/23020#discussion_r1117049036). We know we are downloading bitcoin-core, so I'm not sure why we need to support anything other than just passing in a version number.",
      "created_at": "2023-03-31T11:23:46Z",
      "updated_at": "2023-03-31T11:23:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1154356697",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154356697"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 47,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154358057",
      "pull_request_review_id": 1366759702,
      "id": 1154358057,
      "node_id": "PRRC_kwDOABII585Ezhsp",
      "diff_hunk": "@@ -1,30 +1,77 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n+```sh\n+./contrib/verifybinaries/verify.py 22.0\n+./contrib/verifybinaries/verify.py 22.0-rc2\n+./contrib/verifybinaries/verify.py bitcoin-core-23.0\n+./contrib/verifybinaries/verify.py bitcoin-core-23.0-rc1\n+```\n+\n+Get JSON output and don't prompt for user input (no auto key import):\n+\n+```sh\n+./contrib/verifybinaries/verify.py 22.0-x86 --json\n+```\n+\n+Don't trust builder-keys by default, and rely only on local GPG state and manually\n+specified keys, while requiring a threshold of at least 10 trusted signatures:\n ```sh\n-./verify.py bitcoin-core-0.11.2\n-./verify.py bitcoin-core-0.12.0\n-./verify.py bitcoin-core-0.13.0-rc3\n+./contrib/verifybinaries/verify.py 22.0-x86 \\\n+    --no-trust-builder-keys \\\n+    --trusted-keys 74E2DEF5D77260B98BC19438099BAD163C70FBFA,9D3CC86A72F8494342EA5FD10A41BDC3F4FAFF1C \\\n+    --min-trusted-sigs 10\n ```\n \n If you only want to download the binaries of certain platform, add the corresponding suffix, e.g.:\n \n ```sh\n-./verify.py bitcoin-core-0.11.2-osx\n-./verify.py 0.12.0-linux\n-./verify.py bitcoin-core-0.13.0-rc3-win64\n+./contrib/verifybinaries/verify.py bitcoin-core-22.0-osx\n+./contrib/verifybinaries/verify.py bitcoin-core-22.0-rc2-win64\n ```\n \n If you do not want to keep the downloaded binaries, specify anything as the second parameter.\n \n ```sh\n-./verify.py bitcoin-core-0.13.0 delete\n+./contrib/verifybinaries/verify.py bitcoin-core-22.0 delete",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 87,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "in_reply_to_id": null,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "From https://github.com/bitcoin/bitcoin/pull/23020#discussion_r1117050954\r\n> Should we just add an explicit `--delete` argument to the script, rather than \"append a random anything\", as was proposed in https://github.com/bitcoin/bitcoin/pull/26985.",
      "created_at": "2023-03-31T11:25:12Z",
      "updated_at": "2023-03-31T11:25:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1154358057",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154358057"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 76,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1155770419",
      "pull_request_review_id": 1368737986,
      "id": 1155770419,
      "node_id": "PRRC_kwDOABII585E46gz",
      "diff_hunk": "@@ -1,30 +1,77 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n+```sh\n+./contrib/verifybinaries/verify.py 22.0\n+./contrib/verifybinaries/verify.py 22.0-rc2\n+./contrib/verifybinaries/verify.py bitcoin-core-23.0\n+./contrib/verifybinaries/verify.py bitcoin-core-23.0-rc1",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 52,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "in_reply_to_id": null,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: it would be nice to have a `bin` example as well\r\n```suggestion\r\n./contrib/verifybinaries/verify.py pub bitcoin-core-23.0-rc1\r\n./contrib/verifybinaries/verify.py bin ~/Downloads/SHA256SUMS ~/Downloads/bitcoin-24.0.1-x86_64-linux-gnu.tar.gz\r\n```",
      "created_at": "2023-04-03T10:21:45Z",
      "updated_at": "2023-04-03T10:53:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1155770419",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1155770419"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 48,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1155785561",
      "pull_request_review_id": 1368737986,
      "id": 1155785561,
      "node_id": "PRRC_kwDOABII585E4-NZ",
      "diff_hunk": "@@ -47,136 +172,441 @@ def parse_version_string(version_str):\n     return version_base, version_rc, version_os\n \n \n-def download_with_wget(remote_file, local_file=None):\n-    if local_file:\n-        wget_args = ['wget', '-O', local_file, remote_file]\n-    else:\n-        # use timestamping mechanism if local filename is not explicitly set\n-        wget_args = ['wget', '-N', remote_file]\n-\n-    result = subprocess.run(wget_args,\n+def download_with_wget(remote_file, local_file):\n+    result = subprocess.run(['wget', '-O', local_file, remote_file],\n                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n     return result.returncode == 0, result.stdout.decode().rstrip()\n \n \n+def download_lines_with_urllib(url) -> t.Tuple[bool, t.List[str]]:\n+    \"\"\"Get (success, text lines of a file) over HTTP.\"\"\"\n+    try:\n+        return (True, [\n+            line.strip().decode() for line in urllib.request.urlopen(url).readlines()])\n+    except urllib.request.HTTPError as e:\n+        log.warning(f\"HTTP request to {url} failed (HTTPError): {e}\")\n+    except Exception as e:\n+        log.warning(f\"HTTP request to {url} failed ({e})\")\n+    return (False, [])\n+\n+\n+def verify_with_gpg(\n+    signature_filename,\n+    output_filename: t.Optional[str] = None\n+) -> t.Tuple[int, str]:\n+    args = [\n+        'gpg', '--yes', '--decrypt', '--verify-options', 'show-primary-uid-only',\n+        '--output', output_filename if output_filename else '', signature_filename]\n+\n+    env = dict(os.environ, LANGUAGE='en')\n+    result = subprocess.run(args, stderr=subprocess.STDOUT, stdout=subprocess.PIPE, env=env)\n+    log.debug(f'Result from GPG ({result.returncode}): {result.stdout}')\n+    return result.returncode, result.stdout.decode().rstrip()\n+\n+\n+def remove_files(filenames):\n+    for filename in filenames:\n+        os.remove(filename)\n+\n+\n+class SigData:\n+    \"\"\"GPG signature data as parsed from GPG stdout.\"\"\"\n+    def __init__(self, key: str, name: str, trusted: bool, status: str):\n+        self.key = key\n+        self.name = name\n+        self.trusted = trusted\n+        self.status = status\n+\n+    def __repr__(self):\n+        return (\n+            \"SigData(%r, %r, trusted=%s, status=%r)\" %\n+            (self.key, self.name, self.trusted, self.status))\n+\n+\n+def parse_gpg_result(\n+    output: t.List[str]\n+) -> t.Tuple[t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    \"\"\"Returns good, unknown, and bad signatures from GPG stdout.\"\"\"\n+    good_sigs = []\n+    unknown_sigs = []\n+    bad_sigs = []\n+    total_resolved_sigs = 0\n+    curr_key = None\n+\n+    # Ensure that all lines we match on include a prefix that prevents malicious input\n+    # from fooling the parser.\n+    def line_begins_with(patt: str, line: str) -> t.Optional[re.Match]:\n+        return re.match(r'^\\s*(gpg:)?(\\s+)' + patt, line)\n+\n+    detected_name = ''\n+\n+    for i, line in enumerate(output):\n+        if line_begins_with(r\"using (ECDSA|RSA) key (0x[0-9a-fA-F]{16}|[0-9a-fA-F]{40})$\", line):\n+            if curr_key:\n+                raise RuntimeError(\n+                    f\"WARNING: encountered a new sig without resolving the last ({curr_key}) - \"\n+                    \"this could mean we have encountered a bad signature! check GPG output!\")\n+            curr_key = line.split('key ')[-1].strip()\n+            assert len(curr_key) == 40 or (len(curr_key) == 18 and curr_key.startswith('0x'))\n+\n+        if line_begins_with(r\"Can't check signature: No public key$\", line):\n+            if not curr_key:\n+                raise RuntimeError(\"failed to detect signature being resolved\")\n+            unknown_sigs.append(SigData(curr_key, detected_name, False, ''))\n+            detected_name = ''\n+            curr_key = None\n+\n+        if line_begins_with(r'Good signature from (\".+\")(\\s+)(\\[.+\\])$', line):\n+            if not curr_key:\n+                raise RuntimeError(\"failed to detect signature being resolved\")\n+            name, status = parse_gpg_from_line(line)\n+\n+            # It's safe to index output[i + 1] because if we saw a good sig, there should\n+            # always be another line\n+            trusted = (\n+                'This key is not certified with a trusted signature' not in output[i + 1])\n+            good_sigs.append(SigData(curr_key, name, trusted, status))\n+            curr_key = None\n+\n+        if line_begins_with(\"issuer \", line):\n+            detected_name = line.split(\"issuer \")[-1].strip('\"')\n+\n+        if 'bad signature from' in line.lower():\n+            if not curr_key:\n+                raise RuntimeError(\"failed to detect signature being resolved\")\n+            name, status = parse_gpg_from_line(line)\n+            bad_sigs.append(SigData(curr_key, name, False, status))\n+            curr_key = None\n+\n+        # Track total signatures included\n+        if line_begins_with('Signature made ', line):\n+            total_resolved_sigs += 1\n+\n+    all_found = len(good_sigs + bad_sigs + unknown_sigs)\n+    if all_found != total_resolved_sigs:\n+        raise RuntimeError(\n+            f\"failed to evaluate all signatures: found {all_found} \"\n+            f\"but expected {total_resolved_sigs}\")\n+\n+    return (good_sigs, unknown_sigs, bad_sigs)\n+\n+\n+def parse_gpg_from_line(line: str) -> t.Tuple[str, str]:\n+    \"\"\"Returns name and expiration status.\"\"\"\n+    assert 'signature from' in line\n+\n+    name_end = line.split(' from ')[-1]\n+    m = re.search(r'(?P<name>\".+\") \\[(?P<status>\\w+)\\]', name_end)\n+    assert m\n+    (name, status) = m.groups()\n+    name = name.strip('\"\\'')\n+\n+    return (name, status)\n+\n+\n def files_are_equal(filename1, filename2):\n     with open(filename1, 'rb') as file1:\n         contents1 = file1.read()\n     with open(filename2, 'rb') as file2:\n         contents2 = file2.read()\n-    return contents1 == contents2\n+    eq = contents1 == contents2\n \n+    if not eq:\n+        with open(filename1, 'r', encoding='utf-8') as f1, \\\n+                open(filename2, 'r', encoding='utf-8') as f2:\n+            f1lines = f1.readlines()\n+            f2lines = f2.readlines()\n \n-def verify_with_gpg(signature_filename, output_filename):\n-    result = subprocess.run(['gpg', '--yes', '--decrypt', '--output',\n-                             output_filename, signature_filename],\n-                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n-    return result.returncode, result.stdout.decode().rstrip()\n+            diff = indent(\n+                ''.join(difflib.unified_diff(f1lines, f2lines)))\n+            log.warning(f\"found diff in files ({filename1}, {filename2}):\\n{diff}\\n\")\n \n+    return eq\n \n-def remove_files(filenames):\n-    for filename in filenames:\n-        os.remove(filename)\n+\n+def get_files_from_hosts_and_compare(\n+    hosts: t.List[str], path: str, filename: str, require_all: bool = False\n+) -> ReturnCode:\n+    \"\"\"\n+    Retrieve the same file from a number of hosts and ensure they have the same contents.\n+    The first host given will be treated as the \"primary\" host, and is required to succeed.\n+\n+    Args:\n+        filename: for writing the file locally.\n+    \"\"\"\n+    assert len(hosts) > 1\n+    primary_host = hosts[0]\n+    other_hosts = hosts[1:]\n+    got_files = []\n+\n+    def join_url(host: str) -> str:\n+        return host.rstrip('/') + '/' + path.lstrip('/')\n+\n+    url = join_url(primary_host)\n+    success, output = download_with_wget(url, filename)\n+    if not success:\n+        log.error(\n+            f\"couldn't fetch file ({url}). \"\n+            \"Have you specified the version number in the following format?\\n\"\n+            f\"[{VERSIONPREFIX}]{VERSION_FORMAT} \"\n+            f\"(example: {VERSIONPREFIX}{VERSION_EXAMPLE})\\n\"\n+            f\"wget output:\\n{indent(output)}\")\n+        return ReturnCode.FILE_GET_FAILED\n+    else:\n+        log.info(f\"got file {url} as {filename}\")\n+        got_files.append(filename)\n+\n+    for i, host in enumerate(other_hosts):\n+        url = join_url(host)\n+        fname = filename + f'.{i + 2}'\n+        success, output = download_with_wget(url, fname)\n+\n+        if require_all and not success:\n+            log.error(\n+                f\"{host} failed to provide file ({url}), but {primary_host} did?\\n\"\n+                f\"wget output:\\n{indent(output)}\")\n+            return ReturnCode.FILE_MISSING_FROM_ONE_HOST\n+        elif not success:\n+            log.warning(\n+                f\"{host} failed to provide file ({url}). \"\n+                f\"Continuing based solely upon {primary_host}.\")\n+        else:\n+            log.info(f\"got file {url} as {fname}\")\n+            got_files.append(fname)\n+\n+    for i, got_file in enumerate(got_files):\n+        if got_file == got_files[-1]:\n+            break  # break on last file, nothing after it to compare to\n+\n+        compare_to = got_files[i + 1]\n+        if not files_are_equal(got_file, compare_to):\n+            log.error(f\"files not equal: {got_file} and {compare_to}\")\n+            return ReturnCode.FILES_NOT_EQUAL\n+\n+    return ReturnCode.SUCCESS\n+\n+\n+def check_multisig(sigfilename: str, args: argparse.Namespace):\n+    # check signature\n+    #\n+    # We don't write output to a file because this command will almost certainly\n+    # fail with GPG exit code '2' (and so not writing to --output) because of the\n+    # likely presence of multiple untrusted signatures.\n+    retval, output = verify_with_gpg(sigfilename)\n+\n+    if args.verbose:\n+        log.info(f\"gpg output:\\n{indent(output)}\")\n+\n+    good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    if unknown and args.import_keys:\n+        # Retrieve unknown keys and then try GPG again.\n+        for unsig in unknown:\n+            if prompt_yn(f\" ? Retrieve key {unsig.key} ({unsig.name})? (y/N) \"):\n+                ran = subprocess.run(\n+                    [\"gpg\", \"--keyserver\", args.keyserver, \"--recv-keys\", unsig.key])\n+\n+                if ran.returncode != 0:\n+                    log.warning(f\"failed to retrieve key {unsig.key}\")\n+\n+        # Reparse the GPG output now that we have more keys\n+        retval, output = verify_with_gpg(sigfilename)\n+        good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    return retval, output, good, unknown, bad\n+\n+\n+def prompt_yn(prompt) -> bool:\n+    \"\"\"Return true if the user inputs 'y'.\"\"\"\n+    got = ''\n+    while got not in ['y', 'n']:\n+        got = input(prompt).lower()\n+    return got == 'y'\n \n \n def main(args):\n-    # sanity check\n-    if len(args) < 1:\n-        print(\"Error: need to specify a version on the command line\")\n-        return 3\n+    args = parser.parse_args()\n+    if args.quiet:\n+        log.setLevel(logging.WARNING)\n+\n+    WORKINGDIR = Path(tempfile.gettempdir()) / f\"bitcoin_verify_binaries.{args.version}\"\n+\n+    def cleanup():\n+        log.info(\"cleaning up files\")\n+        os.chdir(Path.home())\n+        shutil.rmtree(WORKINGDIR)\n \n     # determine remote dir dependent on provided version string\n-    version_base, version_rc, os_filter = parse_version_string(args[0])\n+    try:\n+        version_base, version_rc, os_filter = parse_version_string(args.version)\n+        version_tuple = [int(i) for i in version_base.split('.')]\n+    except Exception as e:\n+        log.debug(e)\n+        log.error(f\"unable to parse version; expected format is {VERSION_FORMAT}\")\n+        log.error(f\"  e.g. {VERSION_EXAMPLE}\")\n+        return ReturnCode.BAD_VERSION\n+\n     remote_dir = f\"/bin/{VERSIONPREFIX}{version_base}/\"\n     if version_rc:\n         remote_dir += f\"test.{version_rc}/\"\n-    remote_sigfile = remote_dir + SIGNATUREFILENAME\n+    remote_sigs_path = remote_dir + SIGNATUREFILENAME\n+    remote_sums_path = remote_dir + SUMS_FILENAME\n \n     # create working directory\n     os.makedirs(WORKINGDIR, exist_ok=True)\n     os.chdir(WORKINGDIR)\n \n-    # fetch first signature file\n-    sigfile1 = SIGNATUREFILENAME\n-    success, output = download_with_wget(HOST1 + remote_sigfile, sigfile1)\n-    if not success:\n-        print(\"Error: couldn't fetch signature file. \"\n-              \"Have you specified the version number in the following format?\")\n-        print(f\"[{VERSIONPREFIX}]<version>[-rc[0-9]][-platform] \"\n-              f\"(example: {VERSIONPREFIX}0.21.0-rc3-osx)\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        return 4\n-\n-    # fetch second signature file\n-    sigfile2 = SIGNATUREFILENAME + \".2\"\n-    success, output = download_with_wget(HOST2 + remote_sigfile, sigfile2)\n-    if not success:\n-        print(\"bitcoin.org failed to provide signature file, \"\n-              \"but bitcoincore.org did?\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1])\n-        return 5\n-\n-    # ensure that both signature files are equal\n-    if not files_are_equal(sigfile1, sigfile2):\n-        print(\"bitcoin.org and bitcoincore.org signature files were not equal?\")\n-        print(f\"See files {WORKINGDIR}/{sigfile1} and {WORKINGDIR}/{sigfile2}\")\n-        return 6\n-\n-    # check signature and extract data into file\n-    retval, output = verify_with_gpg(sigfile1, HASHFILE)\n-    if retval != 0:\n-        if retval == 1:\n-            print(\"Bad signature.\")\n-        elif retval == 2:\n-            print(\"gpg error. Do you have the Bitcoin Core binary release \"\n-                  \"signing key installed?\")\n-        print(\"gpg output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1, sigfile2, HASHFILE])\n-        return 1\n+    hosts = [HOST1, HOST2]\n+\n+    got_sig_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sigs_path, SIGNATUREFILENAME, args.require_all_hosts)\n+    if got_sig_status != ReturnCode.SUCCESS:\n+        return got_sig_status\n+\n+    # Multi-sig verification is available after 22.0.\n+    if version_tuple[0] >= 22:\n+        min_good_sigs = args.min_good_sigs\n+        gpg_allowed_codes = [0, 2]  # 2 is returned when untrusted signatures are present.\n+\n+        got_sums_status = get_files_from_hosts_and_compare(\n+            hosts, remote_sums_path, SUMS_FILENAME, args.require_all_hosts)\n+        if got_sums_status != ReturnCode.SUCCESS:\n+            return got_sums_status\n+\n+        gpg_retval, gpg_output, good, unknown, bad = check_multisig(SIGNATUREFILENAME, args)\n+    else:\n+        log.error(\"Version too old - single sig not supported. Use a previous \"\n+                  \"version of this script from the repo.\")\n+        return ReturnCode.BAD_VERSION\n+\n+    if gpg_retval not in gpg_allowed_codes:\n+        if gpg_retval == 1:\n+            log.critical(f\"Bad signature (code: {gpg_retval}).\")\n+        if gpg_retval == 2:\n+            log.critical(\n+                \"gpg error. Do you have the Bitcoin Core binary release \"\n+                \"signing key installed?\")",
      "path": "contrib/verifybinaries/verify.py",
      "position": null,
      "original_position": 551,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "37c9fb7a59a3179b90ed1deaebaabb539976504b",
      "in_reply_to_id": null,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: This seems like it can be deleted, since 2 is an allowed return code and missing \"the Bitcoin Core binary release signing key\" doesn't apply\r\n\r\n```suggestion\r\n```",
      "created_at": "2023-04-03T10:35:26Z",
      "updated_at": "2023-04-03T10:53:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1155785561",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1155785561"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": 485,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 488,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1157778909",
      "pull_request_review_id": 1371805525,
      "id": 1157778909,
      "node_id": "PRRC_kwDOABII585FAk3d",
      "diff_hunk": "@@ -1,30 +1,77 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 24,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "in_reply_to_id": 1151503567,
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Not sure what you mean, I think this just intends to say `verify.py` ?",
      "created_at": "2023-04-04T21:17:56Z",
      "updated_at": "2023-04-04T21:17:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1157778909",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1157778909"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 20,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1157782969",
      "pull_request_review_id": 1371811631,
      "id": 1157782969,
      "node_id": "PRRC_kwDOABII585FAl25",
      "diff_hunk": "@@ -1,30 +1,77 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n+```sh\n+./contrib/verifybinaries/verify.py 22.0\n+./contrib/verifybinaries/verify.py 22.0-rc2\n+./contrib/verifybinaries/verify.py bitcoin-core-23.0\n+./contrib/verifybinaries/verify.py bitcoin-core-23.0-rc1\n+```\n+\n+Get JSON output and don't prompt for user input (no auto key import):\n+\n+```sh\n+./contrib/verifybinaries/verify.py 22.0-x86 --json\n+```\n+\n+Don't trust builder-keys by default, and rely only on local GPG state and manually\n+specified keys, while requiring a threshold of at least 10 trusted signatures:\n ```sh\n-./verify.py bitcoin-core-0.11.2\n-./verify.py bitcoin-core-0.12.0\n-./verify.py bitcoin-core-0.13.0-rc3\n+./contrib/verifybinaries/verify.py 22.0-x86 \\\n+    --no-trust-builder-keys \\\n+    --trusted-keys 74E2DEF5D77260B98BC19438099BAD163C70FBFA,9D3CC86A72F8494342EA5FD10A41BDC3F4FAFF1C \\\n+    --min-trusted-sigs 10\n ```\n \n If you only want to download the binaries of certain platform, add the corresponding suffix, e.g.:\n \n ```sh\n-./verify.py bitcoin-core-0.11.2-osx\n-./verify.py 0.12.0-linux\n-./verify.py bitcoin-core-0.13.0-rc3-win64\n+./contrib/verifybinaries/verify.py bitcoin-core-22.0-osx\n+./contrib/verifybinaries/verify.py bitcoin-core-22.0-rc2-win64\n ```\n \n If you do not want to keep the downloaded binaries, specify anything as the second parameter.\n \n ```sh\n-./verify.py bitcoin-core-0.13.0 delete\n+./contrib/verifybinaries/verify.py bitcoin-core-22.0 delete",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 87,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "in_reply_to_id": 1154358057,
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Looks like this has been implemented as `pub --cleanup`. A quick test shows it working as intended. Will update the doc.",
      "created_at": "2023-04-04T21:22:51Z",
      "updated_at": "2023-04-04T21:22:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1157782969",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1157782969"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 76,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1158526427",
      "pull_request_review_id": 1372922838,
      "id": 1158526427,
      "node_id": "PRRC_kwDOABII585FDbXb",
      "diff_hunk": "@@ -47,137 +115,598 @@ def parse_version_string(version_str):\n     return version_base, version_rc, version_os\n \n \n-def download_with_wget(remote_file, local_file=None):\n-    if local_file:\n-        wget_args = ['wget', '-O', local_file, remote_file]\n-    else:\n-        # use timestamping mechanism if local filename is not explicitly set\n-        wget_args = ['wget', '-N', remote_file]\n-\n-    result = subprocess.run(wget_args,\n+def download_with_wget(remote_file, local_file):\n+    result = subprocess.run(['wget', '-O', local_file, remote_file],\n                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n     return result.returncode == 0, result.stdout.decode().rstrip()\n \n \n+def download_lines_with_urllib(url) -> t.Tuple[bool, t.List[str]]:\n+    \"\"\"Get (success, text lines of a file) over HTTP.\"\"\"\n+    try:\n+        return (True, [\n+            line.strip().decode() for line in urllib.request.urlopen(url).readlines()])\n+    except urllib.request.HTTPError as e:\n+        log.warning(f\"HTTP request to {url} failed (HTTPError): {e}\")\n+    except Exception as e:\n+        log.warning(f\"HTTP request to {url} failed ({e})\")\n+    return (False, [])\n+\n+\n+def verify_with_gpg(\n+    filename,\n+    signature_filename,\n+    output_filename: t.Optional[str] = None\n+) -> t.Tuple[int, str]:\n+    with tempfile.NamedTemporaryFile() as status_file:\n+        args = [\n+            'gpg', '--yes', '--verify', '--verify-options', 'show-primary-uid-only', \"--status-file\", status_file.name,\n+            '--output', output_filename if output_filename else '', signature_filename, filename]\n+\n+        env = dict(os.environ, LANGUAGE='en')\n+        result = subprocess.run(args, stderr=subprocess.STDOUT, stdout=subprocess.PIPE, env=env)\n+\n+        gpg_data = status_file.read().decode().rstrip()\n+\n+    log.debug(f'Result from GPG ({result.returncode}): {result.stdout.decode()}')\n+    log.debug(f\"{gpg_data}\")\n+    return result.returncode, gpg_data\n+\n+\n+def remove_files(filenames):\n+    for filename in filenames:\n+        os.remove(filename)\n+\n+\n+class SigData:\n+    \"\"\"GPG signature data as parsed from GPG stdout.\"\"\"\n+    def __init__(self):\n+        self.key = None\n+        self.name = \"\"\n+        self.trusted = False\n+        self.status = \"\"\n+\n+    def __bool__(self):\n+        return self.key is not None\n+\n+    def __repr__(self):\n+        return (\n+            \"SigData(%r, %r, trusted=%s, status=%r)\" %\n+            (self.key, self.name, self.trusted, self.status))\n+\n+\n+def parse_gpg_result(\n+    output: t.List[str]\n+) -> t.Tuple[t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    \"\"\"Returns good, unknown, and bad signatures from GPG stdout.\"\"\"\n+    good_sigs: t.List[SigData] = []\n+    unknown_sigs: t.List[SigData] = []\n+    bad_sigs: t.List[SigData] = []\n+    total_resolved_sigs = 0\n+\n+    # Ensure that all lines we match on include a prefix that prevents malicious input\n+    # from fooling the parser.\n+    def line_begins_with(patt: str, line: str) -> t.Optional[re.Match]:\n+        return re.match(r'^(\\[GNUPG:\\])\\s+' + patt, line)\n+\n+    curr_sigs = unknown_sigs\n+    curr_sigdata = SigData()\n+\n+    for line in output:\n+        if line_begins_with(r\"NEWSIG(?:\\s|$)\", line):\n+            total_resolved_sigs += 1\n+            if curr_sigdata:\n+                curr_sigs.append(curr_sigdata)\n+                curr_sigdata = SigData()\n+            newsig_split = line.split()\n+            if len(newsig_split) == 3:\n+                curr_sigdata.name = newsig_split[2]\n+\n+        elif line_begins_with(r\"GOODSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+\n+        elif line_begins_with(r\"EXPKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"expired\"\n+\n+        elif line_begins_with(r\"REVKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"revoked\"\n+\n+        elif line_begins_with(r\"BADSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = bad_sigs\n+\n+        elif line_begins_with(r\"ERRSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, _, _, _, _, _ = line.split()[2:8]\n+            curr_sigs = unknown_sigs\n+\n+        elif line_begins_with(r\"TRUST_(UNDEFINED|NEVER)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = False\n+\n+        elif line_begins_with(r\"TRUST_(MARGINAL|FULLY|ULTIMATE)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = True\n+\n+    # The last one won't have been added, so add it now\n+    assert curr_sigdata\n+    curr_sigs.append(curr_sigdata)\n+\n+    all_found = len(good_sigs + bad_sigs + unknown_sigs)\n+    if all_found != total_resolved_sigs:\n+        raise RuntimeError(\n+            f\"failed to evaluate all signatures: found {all_found} \"\n+            f\"but expected {total_resolved_sigs}\")\n+\n+    return (good_sigs, unknown_sigs, bad_sigs)\n+\n+\n def files_are_equal(filename1, filename2):\n     with open(filename1, 'rb') as file1:\n         contents1 = file1.read()\n     with open(filename2, 'rb') as file2:\n         contents2 = file2.read()\n-    return contents1 == contents2\n+    eq = contents1 == contents2\n \n+    if not eq:\n+        with open(filename1, 'r', encoding='utf-8') as f1, \\\n+                open(filename2, 'r', encoding='utf-8') as f2:\n+            f1lines = f1.readlines()\n+            f2lines = f2.readlines()\n \n-def verify_with_gpg(signature_filename, output_filename):\n-    result = subprocess.run(['gpg', '--yes', '--decrypt', '--output',\n-                             output_filename, signature_filename],\n-                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n-    return result.returncode, result.stdout.decode().rstrip()\n+            diff = indent(\n+                ''.join(difflib.unified_diff(f1lines, f2lines)))\n+            log.warning(f\"found diff in files ({filename1}, {filename2}):\\n{diff}\\n\")\n \n+    return eq\n \n-def remove_files(filenames):\n-    for filename in filenames:\n-        os.remove(filename)\n+\n+def get_files_from_hosts_and_compare(\n+    hosts: t.List[str], path: str, filename: str, require_all: bool = False\n+) -> ReturnCode:\n+    \"\"\"\n+    Retrieve the same file from a number of hosts and ensure they have the same contents.\n+    The first host given will be treated as the \"primary\" host, and is required to succeed.\n+\n+    Args:\n+        filename: for writing the file locally.\n+    \"\"\"\n+    assert len(hosts) > 1\n+    primary_host = hosts[0]\n+    other_hosts = hosts[1:]\n+    got_files = []\n+\n+    def join_url(host: str) -> str:\n+        return host.rstrip('/') + '/' + path.lstrip('/')\n+\n+    url = join_url(primary_host)\n+    success, output = download_with_wget(url, filename)\n+    if not success:\n+        log.error(\n+            f\"couldn't fetch file ({url}). \"\n+            \"Have you specified the version number in the following format?\\n\"\n+            f\"[{VERSIONPREFIX}]{VERSION_FORMAT} \"",
      "path": "contrib/verifybinaries/verify.py",
      "position": null,
      "original_position": 315,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "da864a554d75ab440907fbce2476e2c8d0ac2e93",
      "in_reply_to_id": null,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Can drop `VERSIONPREFIX` from this output.",
      "created_at": "2023-04-05T13:32:19Z",
      "updated_at": "2023-04-05T13:43:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1158526427",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1158526427"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 290,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1158530776",
      "pull_request_review_id": 1372922838,
      "id": 1158530776,
      "node_id": "PRRC_kwDOABII585FDcbY",
      "diff_hunk": "@@ -47,137 +115,598 @@ def parse_version_string(version_str):\n     return version_base, version_rc, version_os\n \n \n-def download_with_wget(remote_file, local_file=None):\n-    if local_file:\n-        wget_args = ['wget', '-O', local_file, remote_file]\n-    else:\n-        # use timestamping mechanism if local filename is not explicitly set\n-        wget_args = ['wget', '-N', remote_file]\n-\n-    result = subprocess.run(wget_args,\n+def download_with_wget(remote_file, local_file):\n+    result = subprocess.run(['wget', '-O', local_file, remote_file],\n                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n     return result.returncode == 0, result.stdout.decode().rstrip()\n \n \n+def download_lines_with_urllib(url) -> t.Tuple[bool, t.List[str]]:\n+    \"\"\"Get (success, text lines of a file) over HTTP.\"\"\"\n+    try:\n+        return (True, [\n+            line.strip().decode() for line in urllib.request.urlopen(url).readlines()])\n+    except urllib.request.HTTPError as e:\n+        log.warning(f\"HTTP request to {url} failed (HTTPError): {e}\")\n+    except Exception as e:\n+        log.warning(f\"HTTP request to {url} failed ({e})\")\n+    return (False, [])\n+\n+\n+def verify_with_gpg(\n+    filename,\n+    signature_filename,\n+    output_filename: t.Optional[str] = None\n+) -> t.Tuple[int, str]:\n+    with tempfile.NamedTemporaryFile() as status_file:\n+        args = [\n+            'gpg', '--yes', '--verify', '--verify-options', 'show-primary-uid-only', \"--status-file\", status_file.name,\n+            '--output', output_filename if output_filename else '', signature_filename, filename]\n+\n+        env = dict(os.environ, LANGUAGE='en')\n+        result = subprocess.run(args, stderr=subprocess.STDOUT, stdout=subprocess.PIPE, env=env)\n+\n+        gpg_data = status_file.read().decode().rstrip()\n+\n+    log.debug(f'Result from GPG ({result.returncode}): {result.stdout.decode()}')\n+    log.debug(f\"{gpg_data}\")\n+    return result.returncode, gpg_data\n+\n+\n+def remove_files(filenames):\n+    for filename in filenames:\n+        os.remove(filename)\n+\n+\n+class SigData:\n+    \"\"\"GPG signature data as parsed from GPG stdout.\"\"\"\n+    def __init__(self):\n+        self.key = None\n+        self.name = \"\"\n+        self.trusted = False\n+        self.status = \"\"\n+\n+    def __bool__(self):\n+        return self.key is not None\n+\n+    def __repr__(self):\n+        return (\n+            \"SigData(%r, %r, trusted=%s, status=%r)\" %\n+            (self.key, self.name, self.trusted, self.status))\n+\n+\n+def parse_gpg_result(\n+    output: t.List[str]\n+) -> t.Tuple[t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    \"\"\"Returns good, unknown, and bad signatures from GPG stdout.\"\"\"\n+    good_sigs: t.List[SigData] = []\n+    unknown_sigs: t.List[SigData] = []\n+    bad_sigs: t.List[SigData] = []\n+    total_resolved_sigs = 0\n+\n+    # Ensure that all lines we match on include a prefix that prevents malicious input\n+    # from fooling the parser.\n+    def line_begins_with(patt: str, line: str) -> t.Optional[re.Match]:\n+        return re.match(r'^(\\[GNUPG:\\])\\s+' + patt, line)\n+\n+    curr_sigs = unknown_sigs\n+    curr_sigdata = SigData()\n+\n+    for line in output:\n+        if line_begins_with(r\"NEWSIG(?:\\s|$)\", line):\n+            total_resolved_sigs += 1\n+            if curr_sigdata:\n+                curr_sigs.append(curr_sigdata)\n+                curr_sigdata = SigData()\n+            newsig_split = line.split()\n+            if len(newsig_split) == 3:\n+                curr_sigdata.name = newsig_split[2]\n+\n+        elif line_begins_with(r\"GOODSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+\n+        elif line_begins_with(r\"EXPKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"expired\"\n+\n+        elif line_begins_with(r\"REVKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"revoked\"\n+\n+        elif line_begins_with(r\"BADSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = bad_sigs\n+\n+        elif line_begins_with(r\"ERRSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, _, _, _, _, _ = line.split()[2:8]\n+            curr_sigs = unknown_sigs\n+\n+        elif line_begins_with(r\"TRUST_(UNDEFINED|NEVER)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = False\n+\n+        elif line_begins_with(r\"TRUST_(MARGINAL|FULLY|ULTIMATE)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = True\n+\n+    # The last one won't have been added, so add it now\n+    assert curr_sigdata\n+    curr_sigs.append(curr_sigdata)\n+\n+    all_found = len(good_sigs + bad_sigs + unknown_sigs)\n+    if all_found != total_resolved_sigs:\n+        raise RuntimeError(\n+            f\"failed to evaluate all signatures: found {all_found} \"\n+            f\"but expected {total_resolved_sigs}\")\n+\n+    return (good_sigs, unknown_sigs, bad_sigs)\n+\n+\n def files_are_equal(filename1, filename2):\n     with open(filename1, 'rb') as file1:\n         contents1 = file1.read()\n     with open(filename2, 'rb') as file2:\n         contents2 = file2.read()\n-    return contents1 == contents2\n+    eq = contents1 == contents2\n \n+    if not eq:\n+        with open(filename1, 'r', encoding='utf-8') as f1, \\\n+                open(filename2, 'r', encoding='utf-8') as f2:\n+            f1lines = f1.readlines()\n+            f2lines = f2.readlines()\n \n-def verify_with_gpg(signature_filename, output_filename):\n-    result = subprocess.run(['gpg', '--yes', '--decrypt', '--output',\n-                             output_filename, signature_filename],\n-                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n-    return result.returncode, result.stdout.decode().rstrip()\n+            diff = indent(\n+                ''.join(difflib.unified_diff(f1lines, f2lines)))\n+            log.warning(f\"found diff in files ({filename1}, {filename2}):\\n{diff}\\n\")\n \n+    return eq\n \n-def remove_files(filenames):\n-    for filename in filenames:\n-        os.remove(filename)\n+\n+def get_files_from_hosts_and_compare(\n+    hosts: t.List[str], path: str, filename: str, require_all: bool = False\n+) -> ReturnCode:\n+    \"\"\"\n+    Retrieve the same file from a number of hosts and ensure they have the same contents.\n+    The first host given will be treated as the \"primary\" host, and is required to succeed.\n+\n+    Args:\n+        filename: for writing the file locally.\n+    \"\"\"\n+    assert len(hosts) > 1\n+    primary_host = hosts[0]\n+    other_hosts = hosts[1:]\n+    got_files = []\n+\n+    def join_url(host: str) -> str:\n+        return host.rstrip('/') + '/' + path.lstrip('/')\n+\n+    url = join_url(primary_host)\n+    success, output = download_with_wget(url, filename)\n+    if not success:\n+        log.error(\n+            f\"couldn't fetch file ({url}). \"\n+            \"Have you specified the version number in the following format?\\n\"\n+            f\"[{VERSIONPREFIX}]{VERSION_FORMAT} \"\n+            f\"(example: {VERSIONPREFIX}{VERSION_EXAMPLE})\\n\"\n+            f\"wget output:\\n{indent(output)}\")\n+        return ReturnCode.FILE_GET_FAILED\n+    else:\n+        log.info(f\"got file {url} as {filename}\")\n+        got_files.append(filename)\n+\n+    for i, host in enumerate(other_hosts):\n+        url = join_url(host)\n+        fname = filename + f'.{i + 2}'\n+        success, output = download_with_wget(url, fname)\n+\n+        if require_all and not success:\n+            log.error(\n+                f\"{host} failed to provide file ({url}), but {primary_host} did?\\n\"\n+                f\"wget output:\\n{indent(output)}\")\n+            return ReturnCode.FILE_MISSING_FROM_ONE_HOST\n+        elif not success:\n+            log.warning(\n+                f\"{host} failed to provide file ({url}). \"\n+                f\"Continuing based solely upon {primary_host}.\")\n+        else:\n+            log.info(f\"got file {url} as {fname}\")\n+            got_files.append(fname)\n+\n+    for i, got_file in enumerate(got_files):\n+        if got_file == got_files[-1]:\n+            break  # break on last file, nothing after it to compare to\n+\n+        compare_to = got_files[i + 1]\n+        if not files_are_equal(got_file, compare_to):\n+            log.error(f\"files not equal: {got_file} and {compare_to}\")\n+            return ReturnCode.FILES_NOT_EQUAL\n+\n+    return ReturnCode.SUCCESS\n+\n+\n+def check_multisig(sums_file: str, sigfilename: str, args: argparse.Namespace) -> t.Tuple[int, str, t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    # check signature\n+    #\n+    # We don't write output to a file because this command will almost certainly\n+    # fail with GPG exit code '2' (and so not writing to --output) because of the\n+    # likely presence of multiple untrusted signatures.\n+    retval, output = verify_with_gpg(sums_file, sigfilename)\n+\n+    if args.verbose:\n+        log.info(f\"gpg output:\\n{indent(output)}\")\n+\n+    good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    if unknown and args.import_keys:\n+        # Retrieve unknown keys and then try GPG again.\n+        for unsig in unknown:\n+            if prompt_yn(f\" ? Retrieve key {unsig.key} ({unsig.name})? (y/N) \"):\n+                ran = subprocess.run(\n+                    [\"gpg\", \"--keyserver\", args.keyserver, \"--recv-keys\", unsig.key])\n+\n+                if ran.returncode != 0:\n+                    log.warning(f\"failed to retrieve key {unsig.key}\")\n+\n+        # Reparse the GPG output now that we have more keys\n+        retval, output = verify_with_gpg(sums_file, sigfilename)\n+        good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    return retval, output, good, unknown, bad\n \n \n-def main(args):\n-    # sanity check\n-    if len(args) < 1:\n-        print(\"Error: need to specify a version on the command line\")\n-        return 3\n+def prompt_yn(prompt) -> bool:\n+    \"\"\"Return true if the user inputs 'y'.\"\"\"\n+    got = ''\n+    while got not in ['y', 'n']:\n+        got = input(prompt).lower()\n+    return got == 'y'\n+\n+def verify_shasums_signature(\n+    signature_file_path: str, sums_file_path: str, args: argparse.Namespace\n+) -> t.Tuple[\n+   ReturnCode, t.List[SigData], t.List[SigData], t.List[SigData], t.List[SigData]\n+]:\n+    min_good_sigs = args.min_good_sigs\n+    gpg_allowed_codes = [0, 2]  # 2 is returned when untrusted signatures are present.\n+\n+    gpg_retval, gpg_output, good, unknown, bad = check_multisig(sums_file_path, signature_file_path, args)\n+\n+    if gpg_retval not in gpg_allowed_codes:\n+        if gpg_retval == 1:\n+            log.critical(f\"Bad signature (code: {gpg_retval}).\")\n+        else:\n+            log.critical(f\"unexpected GPG exit code ({gpg_retval})\")\n+\n+        log.error(f\"gpg output:\\n{indent(gpg_output)}\")\n+        return (ReturnCode.INTEGRITY_FAILURE, [], [], [], [])\n+\n+    # Decide which keys we trust, though not \"trust\" in the GPG sense, but rather\n+    # which pubkeys convince us that this sums file is legitimate. In other words,\n+    # which pubkeys within the Bitcoin community do we trust for the purposes of\n+    # binary verification?\n+    trusted_keys = set()\n+    if args.trusted_keys:\n+        trusted_keys |= set(args.trusted_keys.split(','))\n+\n+    # Tally signatures and make sure we have enough goods to fulfill\n+    # our threshold.\n+    good_trusted = [sig for sig in good if sig.trusted or sig.key in trusted_keys]\n+    good_untrusted = [sig for sig in good if sig not in good_trusted]\n+    num_trusted = len(good_trusted) + len(good_untrusted)\n+    log.info(f\"got {num_trusted} good signatures\")\n+\n+    if num_trusted < min_good_sigs:\n+        log.info(\"Maybe you need to import \"\n+                  f\"(`gpg --keyserver {args.keyserver} --recv-keys <key-id>`) \"\n+                  \"some of the following keys: \")\n+        log.info('')\n+        for sig in unknown:\n+            log.info(f\"    {sig.key} ({sig.name})\")\n+        log.info('')\n+        log.error(\n+            \"not enough trusted sigs to meet threshold \"\n+            f\"({num_trusted} vs. {min_good_sigs})\")\n+\n+        return (ReturnCode.NOT_ENOUGH_GOOD_SIGS, [], [], [], [])\n+\n+    for sig in good_trusted:\n+        log.info(f\"GOOD SIGNATURE: {sig}\")\n+\n+    for sig in good_untrusted:\n+        log.info(f\"GOOD SIGNATURE (untrusted): {sig}\")\n+\n+    for sig in [sig for sig in good if sig.status == 'expired']:\n+        log.warning(f\"key {sig.key} for {sig.name} is expired\")\n+\n+    for sig in bad:\n+        log.warning(f\"BAD SIGNATURE: {sig}\")\n+\n+    for sig in unknown:\n+        log.warning(f\"UNKNOWN SIGNATURE: {sig}\")\n+\n+    return (ReturnCode.SUCCESS, good_trusted, good_untrusted, unknown, bad)\n+\n+\n+def parse_sums_file(sums_file_path: str, filename_filter: t.List[str]) -> t.List[t.List[str]]:\n+    # extract hashes/filenames of binaries to verify from hash file;\n+    # each line has the following format: \"<hash> <binary_filename>\"\n+    with open(sums_file_path, 'r', encoding='utf8') as hash_file:\n+        return [line.split()[:2] for line in hash_file if len(filename_filter) == 0 or any(f in line for f in filename_filter)]\n+\n+\n+def verify_binary_hashes(hashes_to_verify: t.List[t.List[str]]) -> t.Tuple[ReturnCode, t.Dict[str, str]]:\n+    offending_files = []\n+    files_to_hashes = {}\n+\n+    for hash_expected, binary_filename in hashes_to_verify:\n+        with open(binary_filename, 'rb') as binary_file:\n+            hash_calculated = sha256(binary_file.read()).hexdigest()\n+        if hash_calculated != hash_expected:\n+            offending_files.append(binary_filename)\n+        else:\n+            files_to_hashes[binary_filename] = hash_calculated\n+\n+    if offending_files:\n+        joined_files = '\\n'.join(offending_files)\n+        log.critical(\n+            \"Hashes don't match.\\n\"\n+            f\"Offending files:\\n{joined_files}\")\n+        return (ReturnCode.INTEGRITY_FAILURE, files_to_hashes)\n+\n+    return (ReturnCode.SUCCESS, files_to_hashes)\n+\n+\n+def verify_published_handler(args: argparse.Namespace) -> ReturnCode:\n+    WORKINGDIR = Path(tempfile.gettempdir()) / f\"bitcoin_verify_binaries.{args.version}\"\n+\n+    def cleanup():\n+        log.info(\"cleaning up files\")\n+        os.chdir(Path.home())\n+        shutil.rmtree(WORKINGDIR)\n \n     # determine remote dir dependent on provided version string\n-    version_base, version_rc, os_filter = parse_version_string(args[0])\n+    try:\n+        version_base, version_rc, os_filter = parse_version_string(args.version)\n+        version_tuple = [int(i) for i in version_base.split('.')]\n+    except Exception as e:\n+        log.debug(e)\n+        log.error(f\"unable to parse version; expected format is {VERSION_FORMAT}\")\n+        log.error(f\"  e.g. {VERSION_EXAMPLE}\")\n+        return ReturnCode.BAD_VERSION\n+\n     remote_dir = f\"/bin/{VERSIONPREFIX}{version_base}/\"\n     if version_rc:\n         remote_dir += f\"test.{version_rc}/\"\n-    remote_sigfile = remote_dir + SIGNATUREFILENAME\n+    remote_sigs_path = remote_dir + SIGNATUREFILENAME\n+    remote_sums_path = remote_dir + SUMS_FILENAME\n \n     # create working directory\n     os.makedirs(WORKINGDIR, exist_ok=True)\n     os.chdir(WORKINGDIR)\n \n-    # fetch first signature file\n-    sigfile1 = SIGNATUREFILENAME\n-    success, output = download_with_wget(HOST1 + remote_sigfile, sigfile1)\n-    if not success:\n-        print(\"Error: couldn't fetch signature file. \"\n-              \"Have you specified the version number in the following format?\")\n-        print(f\"[{VERSIONPREFIX}]<version>[-rc[0-9]][-platform] \"\n-              f\"(example: {VERSIONPREFIX}0.21.0-rc3-osx)\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        return 4\n-\n-    # fetch second signature file\n-    sigfile2 = SIGNATUREFILENAME + \".2\"\n-    success, output = download_with_wget(HOST2 + remote_sigfile, sigfile2)\n-    if not success:\n-        print(\"bitcoin.org failed to provide signature file, \"\n-              \"but bitcoincore.org did?\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1])\n-        return 5\n-\n-    # ensure that both signature files are equal\n-    if not files_are_equal(sigfile1, sigfile2):\n-        print(\"bitcoin.org and bitcoincore.org signature files were not equal?\")\n-        print(f\"See files {WORKINGDIR}/{sigfile1} and {WORKINGDIR}/{sigfile2}\")\n-        return 6\n-\n-    # check signature and extract data into file\n-    retval, output = verify_with_gpg(sigfile1, HASHFILE)\n-    if retval != 0:\n-        if retval == 1:\n-            print(\"Bad signature.\")\n-        elif retval == 2:\n-            print(\"gpg error. Do you have the Bitcoin Core binary release \"\n-                  \"signing key installed?\")\n-        print(\"gpg output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1, sigfile2, HASHFILE])\n-        return 1\n+    hosts = [HOST1, HOST2]\n \n-    # extract hashes/filenames of binaries to verify from hash file;\n-    # each line has the following format: \"<hash> <binary_filename>\"\n-    with open(HASHFILE, 'r', encoding='utf8') as hash_file:\n-        hashes_to_verify = [\n-            line.split()[:2] for line in hash_file if os_filter in line]\n-    remove_files([HASHFILE])\n+    got_sig_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sigs_path, SIGNATUREFILENAME, args.require_all_hosts)\n+    if got_sig_status != ReturnCode.SUCCESS:\n+        return got_sig_status\n+\n+    # Multi-sig verification is available after 22.0.\n+    if version_tuple[0] < 22:\n+        log.error(\"Version too old - single sig not supported. Use a previous \"\n+                  \"version of this script from the repo.\")\n+        return ReturnCode.BAD_VERSION\n+\n+    got_sums_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sums_path, SUMS_FILENAME, args.require_all_hosts)\n+    if got_sums_status != ReturnCode.SUCCESS:\n+        return got_sums_status\n+\n+    # Verify the signature on the SHA256SUMS file\n+    sigs_status, good_trusted, good_untrusted, unknown, bad = verify_shasums_signature(SIGNATUREFILENAME, SUMS_FILENAME, args)\n+    if sigs_status != ReturnCode.SUCCESS:\n+        if sigs_status == ReturnCode.INTEGRITY_FAILURE:\n+            cleanup()\n+        return sigs_status\n+\n+    # Extract hashes and filenames\n+    hashes_to_verify = parse_sums_file(SUMS_FILENAME, os_filter)\n     if not hashes_to_verify:\n-        print(\"error: no files matched the platform specified\")\n-        return 7\n+        log.error(\"no files matched the platform specified\")\n+        return ReturnCode.NO_BINARIES_MATCH\n+\n+    # remove binaries that are known not to be hosted by bitcoincore.org\n+    fragments_to_remove = ['-unsigned', '-debug', '-codesignatures']\n+    for fragment in fragments_to_remove:\n+        nobinaries = [i for i in hashes_to_verify if fragment in i[1]]\n+        if nobinaries:\n+            remove_str = ', '.join(i[1] for i in nobinaries)\n+            log.info(\n+                f\"removing *{fragment} binaries ({remove_str}) from verification \"\n+                f\"since {HOST1} does not host *{fragment} binaries\")\n+            hashes_to_verify = [i for i in hashes_to_verify if fragment not in i[1]]\n \n     # download binaries\n     for _, binary_filename in hashes_to_verify:\n-        print(f\"Downloading {binary_filename}\")\n-        download_with_wget(HOST1 + remote_dir + binary_filename)\n+        log.info(f\"downloading {binary_filename}\")\n+        success, output = download_with_wget(\n+            HOST1 + remote_dir + binary_filename, binary_filename)\n+\n+        if not success:\n+            log.error(\n+                f\"failed to download {binary_filename}\\n\"\n+                f\"wget output:\\n{indent(output)}\")\n+            return ReturnCode.BINARY_DOWNLOAD_FAILED\n \n     # verify hashes\n-    offending_files = []\n-    for hash_expected, binary_filename in hashes_to_verify:\n-        with open(binary_filename, 'rb') as binary_file:\n-            hash_calculated = sha256(binary_file.read()).hexdigest()\n-        if hash_calculated != hash_expected:\n-            offending_files.append(binary_filename)\n-    if offending_files:\n-        print(\"Hashes don't match.\")\n-        print(\"Offending files:\")\n-        print('\\n'.join(offending_files))\n-        return 1\n-    verified_binaries = [entry[1] for entry in hashes_to_verify]\n-\n-    # clean up files if desired\n-    if len(args) >= 2:\n-        print(\"Clean up the binaries\")\n-        remove_files([sigfile1, sigfile2] + verified_binaries)\n+    hashes_status, files_to_hashes = verify_binary_hashes(hashes_to_verify)\n+    if hashes_status != ReturnCode.SUCCESS:\n+        return hashes_status\n+\n+\n+    if args.cleanup:\n+        cleanup()\n+    else:\n+        log.info(f\"did not clean up {WORKINGDIR}\")\n+\n+    if args.json:\n+        output = {\n+            'good_trusted_sigs': [str(s) for s in good_trusted],\n+            'good_untrusted_sigs': [str(s) for s in good_untrusted],\n+            'unknown_sigs': [str(s) for s in unknown],\n+            'bad_sigs': [str(s) for s in bad],\n+            'verified_binaries': files_to_hashes,\n+        }\n+        print(json.dumps(output, indent=2))\n     else:\n-        print(f\"Keep the binaries in {WORKINGDIR}\")\n+        for filename in files_to_hashes:\n+            print(f\"VERIFIED: {filename}\")\n+\n+    return ReturnCode.SUCCESS\n+\n+\n+def verify_binaries_handler(args: argparse.Namespace) -> ReturnCode:\n+    binary_to_basename = {}\n+    for file in args.binary:\n+        binary_to_basename[PurePath(file).name] = file\n+\n+    sums_sig_path = None\n+    if args.sums_sig_file:\n+        sums_sig_path = Path(args.sums_sig_file)\n+    else:\n+        log.info(f\"No signature file specified, assuming it is {args.sums_file}.asc\")\n+        sums_sig_path = Path(args.sums_file).with_suffix(\".asc\")\n+\n+    # Verify the signature on the SHA256SUMS file\n+    sigs_status, good_trusted, good_untrusted, unknown, bad = verify_shasums_signature(sums_sig_path, args.sums_file, args)\n+    if sigs_status != ReturnCode.SUCCESS:\n+        return sigs_status\n+\n+    # Extract hashes and filenames\n+    hashes_to_verify = parse_sums_file(args.sums_file, [k for k, n in binary_to_basename.items()])\n+    if not hashes_to_verify:\n+        log.error(f\"No files in {args.sums_file} match the specified binaries\")\n+        return ReturnCode.NO_BINARIES_MATCH\n+\n+    # Make sure all files are accounted for\n+    sums_file_path = Path(args.sums_file)\n+    missing_files = []\n+    files_to_hash = []\n+    if len(binary_to_basename) > 0:\n+        for file_hash, file in hashes_to_verify:\n+            files_to_hash.append([file_hash, binary_to_basename[file]])\n+            del binary_to_basename[file]\n+        if len(binary_to_basename) > 0:\n+            log.error(f\"Not all specified binaries are in {args.sums_file}\")\n+            return ReturnCode.NO_BINARIES_MATCH\n+    else:\n+        log.info(f\"No binaries specified, assuming all files specified in {args.sums_file} are located relatively\")\n+        for file_hash, file in hashes_to_verify:\n+            file_path = Path(sums_file_path.parent.joinpath(file))\n+            if file_path.exists():\n+                files_to_hash.append([file_hash, str(file_path)])\n+            else:\n+                missing_files.append(file)\n+\n+    # verify hashes\n+    hashes_status, files_to_hashes = verify_binary_hashes(files_to_hash)\n+    if hashes_status != ReturnCode.SUCCESS:\n+        return hashes_status\n+\n+    if args.json:\n+        output = {\n+            'good_trusted_sigs': [str(s) for s in good_trusted],\n+            'good_untrusted_sigs': [str(s) for s in good_untrusted],\n+            'unknown_sigs': [str(s) for s in unknown],\n+            'bad_sigs': [str(s) for s in bad],\n+            'verified_binaries': files_to_hashes,\n+            \"missing_binaries\": missing_files,\n+        }\n+        print(json.dumps(output, indent=2))\n+    else:\n+        for filename in files_to_hashes:\n+            print(f\"VERIFIED: {filename}\")\n+        for filename in missing_files:\n+            print(f\"MISSING: {filename}\")\n+\n+    return ReturnCode.SUCCESS\n+\n+\n+def main():\n+    parser = argparse.ArgumentParser(description=__doc__)\n+    parser.add_argument(\n+        '-v', '--verbose', action='store_true',\n+        default=bool_from_env('BINVERIFY_VERBOSE'),\n+    )\n+    parser.add_argument(\n+        '-q', '--quiet', action='store_true',\n+        default=bool_from_env('BINVERIFY_QUIET'),\n+    )\n+    parser.add_argument(\n+        '--import-keys', action='store_true',\n+        default=bool_from_env('BINVERIFY_IMPORTKEYS'),\n+        help='if specified, ask to import each unknown builder key'\n+    )\n+    parser.add_argument(\n+        '--min-good-sigs', type=int, action='store', nargs='?',\n+        default=int(os.environ.get('BINVERIFY_MIN_GOOD_SIGS', 3)),\n+        help=(\n+            'The minimum number of good signatures to require successful termination.'),\n+    )\n+    parser.add_argument(\n+        '--keyserver', action='store', nargs='?',\n+        default=os.environ.get('BINVERIFY_KEYSERVER', 'hkp://keyserver.ubuntu.com'),",
      "path": "contrib/verifybinaries/verify.py",
      "position": null,
      "original_position": 760,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "da864a554d75ab440907fbce2476e2c8d0ac2e93",
      "in_reply_to_id": null,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "note that the keyserver we currently \"recommend\" is `hkps://keys.openpgp.org`. See #22688, #23466.",
      "created_at": "2023-04-05T13:35:27Z",
      "updated_at": "2023-04-05T13:43:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1158530776",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1158530776"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 659,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1158537830",
      "pull_request_review_id": 1372922838,
      "id": 1158537830,
      "node_id": "PRRC_kwDOABII585FDeJm",
      "diff_hunk": "@@ -1,30 +1,89 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n ```sh\n-./verify.py bitcoin-core-0.11.2\n-./verify.py bitcoin-core-0.12.0\n-./verify.py bitcoin-core-0.13.0-rc3\n+./contrib/verifybinaries/verify.py pub 22.0\n+./contrib/verifybinaries/verify.py pub 22.0-rc2\n+```\n+\n+Get JSON output and don't prompt for user input (no auto key import):\n+\n+```sh\n+./contrib/verifybinaries/verify.py pub 22.0-x86 --json\n+```\n+\n+Don't trust builder-keys by default, and rely only on local GPG state and manually\n+specified keys, while requiring a threshold of at least 10 trusted signatures:\n+```sh\n+./contrib/verifybinaries/verify.py pub 22.0-x86 \\\n+    --no-trust-builder-keys \\",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 66,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "da864a554d75ab440907fbce2476e2c8d0ac2e93",
      "in_reply_to_id": null,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`--no-trust-builder-keys` is no-longer a thing? Arguments here need re-ordering as well.",
      "created_at": "2023-04-05T13:40:50Z",
      "updated_at": "2023-04-05T13:43:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1158537830",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1158537830"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 59,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1158540308",
      "pull_request_review_id": 1372922838,
      "id": 1158540308,
      "node_id": "PRRC_kwDOABII585FDewU",
      "diff_hunk": "@@ -1,30 +1,89 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n ```sh\n-./verify.py bitcoin-core-0.11.2\n-./verify.py bitcoin-core-0.12.0\n-./verify.py bitcoin-core-0.13.0-rc3\n+./contrib/verifybinaries/verify.py pub 22.0\n+./contrib/verifybinaries/verify.py pub 22.0-rc2\n+```\n+\n+Get JSON output and don't prompt for user input (no auto key import):\n+\n+```sh\n+./contrib/verifybinaries/verify.py pub 22.0-x86 --json\n+```\n+\n+Don't trust builder-keys by default, and rely only on local GPG state and manually\n+specified keys, while requiring a threshold of at least 10 trusted signatures:\n+```sh\n+./contrib/verifybinaries/verify.py pub 22.0-x86 \\\n+    --no-trust-builder-keys \\\n+    --trusted-keys 74E2DEF5D77260B98BC19438099BAD163C70FBFA,9D3CC86A72F8494342EA5FD10A41BDC3F4FAFF1C \\\n+    --min-trusted-sigs 10",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 68,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "da864a554d75ab440907fbce2476e2c8d0ac2e93",
      "in_reply_to_id": null,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    --min-good-sigs 10\r\n```",
      "created_at": "2023-04-05T13:42:45Z",
      "updated_at": "2023-04-05T13:43:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1158540308",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1158540308"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 61,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159499828",
      "pull_request_review_id": 1374386088,
      "id": 1159499828,
      "node_id": "PRRC_kwDOABII585FHJA0",
      "diff_hunk": "@@ -1,30 +1,88 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n ```sh\n-./verify.py bitcoin-core-0.11.2\n-./verify.py bitcoin-core-0.12.0\n-./verify.py bitcoin-core-0.13.0-rc3\n+./contrib/verifybinaries/verify.py pub 22.0\n+./contrib/verifybinaries/verify.py pub 22.0-rc2\n+```\n+\n+Get JSON output and don't prompt for user input (no auto key import):\n+\n+```sh\n+./contrib/verifybinaries/verify.py pub 22.0-x86 --json",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 59,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": null,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n./contrib/verifybinaries/verify.py --json pub 22.0-x86\r\n```\r\n\r\notherwise i get this:\r\n```\r\n$ ./contrib/verifybinaries/verify.py pub 22.0-x86 --json\r\nusage: verify.py [-h] [-v] [-q] [--import-keys] [--min-good-sigs [MIN_GOOD_SIGS]] [--keyserver [KEYSERVER]] [--trusted-keys [TRUSTED_KEYS]] [--json] {pub,bin} ...\r\nverify.py: error: unrecognized arguments: --json\r\n```",
      "created_at": "2023-04-06T09:03:52Z",
      "updated_at": "2023-04-06T09:06:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1159499828",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159499828"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159536722",
      "pull_request_review_id": 1374445179,
      "id": 1159536722,
      "node_id": "PRRC_kwDOABII585FHSBS",
      "diff_hunk": "@@ -1,30 +1,88 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n ```sh\n-./verify.py bitcoin-core-0.11.2\n-./verify.py bitcoin-core-0.12.0\n-./verify.py bitcoin-core-0.13.0-rc3\n+./contrib/verifybinaries/verify.py pub 22.0\n+./contrib/verifybinaries/verify.py pub 22.0-rc2\n+```\n+\n+Get JSON output and don't prompt for user input (no auto key import):\n+\n+```sh\n+./contrib/verifybinaries/verify.py pub 22.0-x86 --json\n+```\n+\n+Rely only on local GPG state and manually specified keys, while requiring a\n+threshold of at least 10 trusted signatures:\n+```sh\n+./contrib/verifybinaries/verify.py \\\n+    --trusted-keys 74E2DEF5D77260B98BC19438099BAD163C70FBFA,9D3CC86A72F8494342EA5FD10A41BDC3F4FAFF1C \\\n+    --min-good-sigs 10 pub 22.0-x86\n ```\n \n If you only want to download the binaries of certain platform, add the corresponding suffix, e.g.:",
      "path": "contrib/verifybinaries/README.md",
      "position": 70,
      "original_position": 70,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": null,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit:\r\n\r\n```suggestion\r\nIf you only want to download the binaries for a certain platform, add the corresponding suffix, e.g.:\r\n```",
      "created_at": "2023-04-06T09:33:35Z",
      "updated_at": "2023-04-06T10:04:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1159536722",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159536722"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 63,
      "original_line": 63,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159541958",
      "pull_request_review_id": 1374445179,
      "id": 1159541958,
      "node_id": "PRRC_kwDOABII585FHTTG",
      "diff_hunk": "@@ -0,0 +1,59 @@\n+#!/usr/bin/env python3\n+\n+import json\n+import sys\n+import subprocess\n+from pathlib import Path\n+\n+\n+def main():\n+    \"\"\"Tests ordered roughly from faster to slower.\"\"\"\n+    expect_code(run_verify(\"\", \"pub\", '0.32'), 4, \"Nonexistent version should fail\")\n+    expect_code(run_verify(\"\", \"pub\", '0.32.awefa.12f9h'), 11, \"Malformed version should fail\")\n+    expect_code(run_verify('--min-good-sigs 20', \"pub\", \"22.0\"), 9, \"--min-good-sigs 20 should fail\")\n+\n+    print(\"- testing multisig verification (22.0)\", flush=True)",
      "path": "contrib/verifybinaries/test.py",
      "position": 15,
      "original_position": 15,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": null,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: would avoid using the term multisig because of its meaning in other bitcoin contexts\r\n\r\n```suggestion\r\n    print(\"- testing verification (22.0)\", flush=True)\r\n```",
      "created_at": "2023-04-06T09:36:36Z",
      "updated_at": "2023-04-06T10:02:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1159541958",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159541958"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 15,
      "original_line": 15,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159545267",
      "pull_request_review_id": 1374445179,
      "id": 1159545267,
      "node_id": "PRRC_kwDOABII585FHUGz",
      "diff_hunk": "@@ -1,30 +1,88 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 24,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": null,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n  - you can run the packaged `verify.py ... --import-keys` script to\r\n- ```",
      "created_at": "2023-04-06T09:39:37Z",
      "updated_at": "2023-04-06T10:02:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1159545267",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159545267"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 20,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159559235",
      "pull_request_review_id": 1374445179,
      "id": 1159559235,
      "node_id": "PRRC_kwDOABII585FHXhD",
      "diff_hunk": "@@ -1,30 +1,88 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n ```sh\n-./verify.py bitcoin-core-0.11.2\n-./verify.py bitcoin-core-0.12.0\n-./verify.py bitcoin-core-0.13.0-rc3\n+./contrib/verifybinaries/verify.py pub 22.0\n+./contrib/verifybinaries/verify.py pub 22.0-rc2",
      "path": "contrib/verifybinaries/README.md",
      "position": 53,
      "original_position": 53,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": null,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "kinda weird that the scripts are relative to the root, and not the `README.md`? ",
      "created_at": "2023-04-06T09:48:50Z",
      "updated_at": "2023-04-06T10:02:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1159559235",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159559235"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": 45,
      "original_start_line": 45,
      "start_side": "RIGHT",
      "line": 46,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159566098",
      "pull_request_review_id": 1374445179,
      "id": 1159566098,
      "node_id": "PRRC_kwDOABII585FHZMS",
      "diff_hunk": "@@ -1,30 +1,88 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n ```sh\n-./verify.py bitcoin-core-0.11.2\n-./verify.py bitcoin-core-0.12.0\n-./verify.py bitcoin-core-0.13.0-rc3\n+./contrib/verifybinaries/verify.py pub 22.0\n+./contrib/verifybinaries/verify.py pub 22.0-rc2\n+```\n+\n+Get JSON output and don't prompt for user input (no auto key import):\n+\n+```sh\n+./contrib/verifybinaries/verify.py pub 22.0-x86 --json\n+```\n+\n+Rely only on local GPG state and manually specified keys, while requiring a\n+threshold of at least 10 trusted signatures:\n+```sh\n+./contrib/verifybinaries/verify.py \\\n+    --trusted-keys 74E2DEF5D77260B98BC19438099BAD163C70FBFA,9D3CC86A72F8494342EA5FD10A41BDC3F4FAFF1C \\\n+    --min-good-sigs 10 pub 22.0-x86",
      "path": "contrib/verifybinaries/README.md",
      "position": 67,
      "original_position": 67,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": null,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "when I ran this command, it still downloaded and verified everything (as opposed to just `-x86`)",
      "created_at": "2023-04-06T09:54:11Z",
      "updated_at": "2023-04-06T10:02:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1159566098",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159566098"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": 58,
      "original_start_line": 58,
      "start_side": "RIGHT",
      "line": 60,
      "original_line": 60,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159570134",
      "pull_request_review_id": 1374445179,
      "id": 1159570134,
      "node_id": "PRRC_kwDOABII585FHaLW",
      "diff_hunk": "@@ -1,30 +1,88 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n ```sh\n-./verify.py bitcoin-core-0.11.2\n-./verify.py bitcoin-core-0.12.0\n-./verify.py bitcoin-core-0.13.0-rc3\n+./contrib/verifybinaries/verify.py pub 22.0\n+./contrib/verifybinaries/verify.py pub 22.0-rc2\n+```\n+\n+Get JSON output and don't prompt for user input (no auto key import):\n+\n+```sh\n+./contrib/verifybinaries/verify.py pub 22.0-x86 --json",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 59,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": null,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "running `./verify.py --json pub 22.0-x86` downloads everything",
      "created_at": "2023-04-06T09:58:09Z",
      "updated_at": "2023-04-06T10:02:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1159570134",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159570134"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159578384",
      "pull_request_review_id": 1374510279,
      "id": 1159578384,
      "node_id": "PRRC_kwDOABII585FHcMQ",
      "diff_hunk": "@@ -1,30 +1,77 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 24,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "in_reply_to_id": 1151503567,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I was inferring that there may be some undocumented step copying and renaming this file into the distributed tar archives for verification purposes. If this is not the case, then I think this indeed should just say `verify.py`.",
      "created_at": "2023-04-06T10:04:14Z",
      "updated_at": "2023-04-06T10:04:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1159578384",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159578384"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 20,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159579891",
      "pull_request_review_id": 1374512266,
      "id": 1159579891,
      "node_id": "PRRC_kwDOABII585FHcjz",
      "diff_hunk": "@@ -0,0 +1,59 @@\n+#!/usr/bin/env python3",
      "path": "contrib/verifybinaries/test.py",
      "position": 1,
      "original_position": 1,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "in_reply_to_id": 1151491320,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "+1 ",
      "created_at": "2023-04-06T10:05:21Z",
      "updated_at": "2023-04-06T10:05:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1159579891",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159579891"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159606675",
      "pull_request_review_id": 1374562702,
      "id": 1159606675,
      "node_id": "PRRC_kwDOABII585FHjGT",
      "diff_hunk": "@@ -47,137 +115,598 @@ def parse_version_string(version_str):\n     return version_base, version_rc, version_os\n \n \n-def download_with_wget(remote_file, local_file=None):\n-    if local_file:\n-        wget_args = ['wget', '-O', local_file, remote_file]\n-    else:\n-        # use timestamping mechanism if local filename is not explicitly set\n-        wget_args = ['wget', '-N', remote_file]\n-\n-    result = subprocess.run(wget_args,\n+def download_with_wget(remote_file, local_file):\n+    result = subprocess.run(['wget', '-O', local_file, remote_file],\n                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n     return result.returncode == 0, result.stdout.decode().rstrip()\n \n \n+def download_lines_with_urllib(url) -> t.Tuple[bool, t.List[str]]:\n+    \"\"\"Get (success, text lines of a file) over HTTP.\"\"\"\n+    try:\n+        return (True, [\n+            line.strip().decode() for line in urllib.request.urlopen(url).readlines()])\n+    except urllib.request.HTTPError as e:\n+        log.warning(f\"HTTP request to {url} failed (HTTPError): {e}\")\n+    except Exception as e:\n+        log.warning(f\"HTTP request to {url} failed ({e})\")\n+    return (False, [])\n+\n+\n+def verify_with_gpg(\n+    filename,\n+    signature_filename,\n+    output_filename: t.Optional[str] = None\n+) -> t.Tuple[int, str]:\n+    with tempfile.NamedTemporaryFile() as status_file:\n+        args = [\n+            'gpg', '--yes', '--verify', '--verify-options', 'show-primary-uid-only', \"--status-file\", status_file.name,\n+            '--output', output_filename if output_filename else '', signature_filename, filename]\n+\n+        env = dict(os.environ, LANGUAGE='en')\n+        result = subprocess.run(args, stderr=subprocess.STDOUT, stdout=subprocess.PIPE, env=env)\n+\n+        gpg_data = status_file.read().decode().rstrip()\n+\n+    log.debug(f'Result from GPG ({result.returncode}): {result.stdout.decode()}')\n+    log.debug(f\"{gpg_data}\")\n+    return result.returncode, gpg_data\n+\n+\n+def remove_files(filenames):\n+    for filename in filenames:\n+        os.remove(filename)\n+\n+\n+class SigData:\n+    \"\"\"GPG signature data as parsed from GPG stdout.\"\"\"\n+    def __init__(self):\n+        self.key = None\n+        self.name = \"\"\n+        self.trusted = False\n+        self.status = \"\"\n+\n+    def __bool__(self):\n+        return self.key is not None\n+\n+    def __repr__(self):\n+        return (\n+            \"SigData(%r, %r, trusted=%s, status=%r)\" %\n+            (self.key, self.name, self.trusted, self.status))\n+\n+\n+def parse_gpg_result(\n+    output: t.List[str]\n+) -> t.Tuple[t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    \"\"\"Returns good, unknown, and bad signatures from GPG stdout.\"\"\"\n+    good_sigs: t.List[SigData] = []\n+    unknown_sigs: t.List[SigData] = []\n+    bad_sigs: t.List[SigData] = []\n+    total_resolved_sigs = 0\n+\n+    # Ensure that all lines we match on include a prefix that prevents malicious input\n+    # from fooling the parser.\n+    def line_begins_with(patt: str, line: str) -> t.Optional[re.Match]:\n+        return re.match(r'^(\\[GNUPG:\\])\\s+' + patt, line)\n+\n+    curr_sigs = unknown_sigs\n+    curr_sigdata = SigData()\n+\n+    for line in output:\n+        if line_begins_with(r\"NEWSIG(?:\\s|$)\", line):\n+            total_resolved_sigs += 1\n+            if curr_sigdata:\n+                curr_sigs.append(curr_sigdata)\n+                curr_sigdata = SigData()\n+            newsig_split = line.split()\n+            if len(newsig_split) == 3:\n+                curr_sigdata.name = newsig_split[2]\n+\n+        elif line_begins_with(r\"GOODSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+\n+        elif line_begins_with(r\"EXPKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"expired\"\n+\n+        elif line_begins_with(r\"REVKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"revoked\"\n+\n+        elif line_begins_with(r\"BADSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = bad_sigs\n+\n+        elif line_begins_with(r\"ERRSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, _, _, _, _, _ = line.split()[2:8]\n+            curr_sigs = unknown_sigs\n+\n+        elif line_begins_with(r\"TRUST_(UNDEFINED|NEVER)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = False\n+\n+        elif line_begins_with(r\"TRUST_(MARGINAL|FULLY|ULTIMATE)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = True\n+\n+    # The last one won't have been added, so add it now\n+    assert curr_sigdata\n+    curr_sigs.append(curr_sigdata)\n+\n+    all_found = len(good_sigs + bad_sigs + unknown_sigs)\n+    if all_found != total_resolved_sigs:\n+        raise RuntimeError(\n+            f\"failed to evaluate all signatures: found {all_found} \"\n+            f\"but expected {total_resolved_sigs}\")\n+\n+    return (good_sigs, unknown_sigs, bad_sigs)\n+\n+\n def files_are_equal(filename1, filename2):\n     with open(filename1, 'rb') as file1:\n         contents1 = file1.read()\n     with open(filename2, 'rb') as file2:\n         contents2 = file2.read()\n-    return contents1 == contents2\n+    eq = contents1 == contents2\n \n+    if not eq:\n+        with open(filename1, 'r', encoding='utf-8') as f1, \\\n+                open(filename2, 'r', encoding='utf-8') as f2:\n+            f1lines = f1.readlines()\n+            f2lines = f2.readlines()\n \n-def verify_with_gpg(signature_filename, output_filename):\n-    result = subprocess.run(['gpg', '--yes', '--decrypt', '--output',\n-                             output_filename, signature_filename],\n-                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n-    return result.returncode, result.stdout.decode().rstrip()\n+            diff = indent(\n+                ''.join(difflib.unified_diff(f1lines, f2lines)))\n+            log.warning(f\"found diff in files ({filename1}, {filename2}):\\n{diff}\\n\")\n \n+    return eq\n \n-def remove_files(filenames):\n-    for filename in filenames:\n-        os.remove(filename)\n+\n+def get_files_from_hosts_and_compare(\n+    hosts: t.List[str], path: str, filename: str, require_all: bool = False\n+) -> ReturnCode:\n+    \"\"\"\n+    Retrieve the same file from a number of hosts and ensure they have the same contents.\n+    The first host given will be treated as the \"primary\" host, and is required to succeed.\n+\n+    Args:\n+        filename: for writing the file locally.\n+    \"\"\"\n+    assert len(hosts) > 1\n+    primary_host = hosts[0]\n+    other_hosts = hosts[1:]\n+    got_files = []\n+\n+    def join_url(host: str) -> str:\n+        return host.rstrip('/') + '/' + path.lstrip('/')\n+\n+    url = join_url(primary_host)\n+    success, output = download_with_wget(url, filename)\n+    if not success:\n+        log.error(\n+            f\"couldn't fetch file ({url}). \"\n+            \"Have you specified the version number in the following format?\\n\"\n+            f\"{VERSION_FORMAT} \"\n+            f\"(example: {VERSION_EXAMPLE})\\n\"\n+            f\"wget output:\\n{indent(output)}\")\n+        return ReturnCode.FILE_GET_FAILED\n+    else:\n+        log.info(f\"got file {url} as {filename}\")\n+        got_files.append(filename)\n+\n+    for i, host in enumerate(other_hosts):\n+        url = join_url(host)\n+        fname = filename + f'.{i + 2}'\n+        success, output = download_with_wget(url, fname)\n+\n+        if require_all and not success:\n+            log.error(\n+                f\"{host} failed to provide file ({url}), but {primary_host} did?\\n\"\n+                f\"wget output:\\n{indent(output)}\")\n+            return ReturnCode.FILE_MISSING_FROM_ONE_HOST\n+        elif not success:\n+            log.warning(\n+                f\"{host} failed to provide file ({url}). \"\n+                f\"Continuing based solely upon {primary_host}.\")\n+        else:\n+            log.info(f\"got file {url} as {fname}\")\n+            got_files.append(fname)\n+\n+    for i, got_file in enumerate(got_files):\n+        if got_file == got_files[-1]:\n+            break  # break on last file, nothing after it to compare to\n+\n+        compare_to = got_files[i + 1]\n+        if not files_are_equal(got_file, compare_to):\n+            log.error(f\"files not equal: {got_file} and {compare_to}\")\n+            return ReturnCode.FILES_NOT_EQUAL\n+\n+    return ReturnCode.SUCCESS\n+\n+\n+def check_multisig(sums_file: str, sigfilename: str, args: argparse.Namespace) -> t.Tuple[int, str, t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    # check signature\n+    #\n+    # We don't write output to a file because this command will almost certainly\n+    # fail with GPG exit code '2' (and so not writing to --output) because of the\n+    # likely presence of multiple untrusted signatures.\n+    retval, output = verify_with_gpg(sums_file, sigfilename)\n+\n+    if args.verbose:\n+        log.info(f\"gpg output:\\n{indent(output)}\")\n+\n+    good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    if unknown and args.import_keys:\n+        # Retrieve unknown keys and then try GPG again.\n+        for unsig in unknown:\n+            if prompt_yn(f\" ? Retrieve key {unsig.key} ({unsig.name})? (y/N) \"):\n+                ran = subprocess.run(\n+                    [\"gpg\", \"--keyserver\", args.keyserver, \"--recv-keys\", unsig.key])\n+\n+                if ran.returncode != 0:\n+                    log.warning(f\"failed to retrieve key {unsig.key}\")\n+\n+        # Reparse the GPG output now that we have more keys\n+        retval, output = verify_with_gpg(sums_file, sigfilename)\n+        good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    return retval, output, good, unknown, bad\n \n \n-def main(args):\n-    # sanity check\n-    if len(args) < 1:\n-        print(\"Error: need to specify a version on the command line\")\n-        return 3\n+def prompt_yn(prompt) -> bool:\n+    \"\"\"Return true if the user inputs 'y'.\"\"\"\n+    got = ''\n+    while got not in ['y', 'n']:\n+        got = input(prompt).lower()\n+    return got == 'y'\n+\n+def verify_shasums_signature(\n+    signature_file_path: str, sums_file_path: str, args: argparse.Namespace\n+) -> t.Tuple[\n+   ReturnCode, t.List[SigData], t.List[SigData], t.List[SigData], t.List[SigData]\n+]:\n+    min_good_sigs = args.min_good_sigs\n+    gpg_allowed_codes = [0, 2]  # 2 is returned when untrusted signatures are present.\n+\n+    gpg_retval, gpg_output, good, unknown, bad = check_multisig(sums_file_path, signature_file_path, args)\n+\n+    if gpg_retval not in gpg_allowed_codes:\n+        if gpg_retval == 1:\n+            log.critical(f\"Bad signature (code: {gpg_retval}).\")\n+        else:\n+            log.critical(f\"unexpected GPG exit code ({gpg_retval})\")\n+\n+        log.error(f\"gpg output:\\n{indent(gpg_output)}\")\n+        return (ReturnCode.INTEGRITY_FAILURE, [], [], [], [])\n+\n+    # Decide which keys we trust, though not \"trust\" in the GPG sense, but rather\n+    # which pubkeys convince us that this sums file is legitimate. In other words,\n+    # which pubkeys within the Bitcoin community do we trust for the purposes of\n+    # binary verification?\n+    trusted_keys = set()\n+    if args.trusted_keys:\n+        trusted_keys |= set(args.trusted_keys.split(','))\n+\n+    # Tally signatures and make sure we have enough goods to fulfill\n+    # our threshold.\n+    good_trusted = [sig for sig in good if sig.trusted or sig.key in trusted_keys]\n+    good_untrusted = [sig for sig in good if sig not in good_trusted]\n+    num_trusted = len(good_trusted) + len(good_untrusted)\n+    log.info(f\"got {num_trusted} good signatures\")\n+\n+    if num_trusted < min_good_sigs:\n+        log.info(\"Maybe you need to import \"\n+                  f\"(`gpg --keyserver {args.keyserver} --recv-keys <key-id>`) \"\n+                  \"some of the following keys: \")\n+        log.info('')\n+        for sig in unknown:\n+            log.info(f\"    {sig.key} ({sig.name})\")\n+        log.info('')\n+        log.error(\n+            \"not enough trusted sigs to meet threshold \"\n+            f\"({num_trusted} vs. {min_good_sigs})\")\n+\n+        return (ReturnCode.NOT_ENOUGH_GOOD_SIGS, [], [], [], [])\n+\n+    for sig in good_trusted:\n+        log.info(f\"GOOD SIGNATURE: {sig}\")\n+\n+    for sig in good_untrusted:\n+        log.info(f\"GOOD SIGNATURE (untrusted): {sig}\")\n+\n+    for sig in [sig for sig in good if sig.status == 'expired']:\n+        log.warning(f\"key {sig.key} for {sig.name} is expired\")\n+\n+    for sig in bad:\n+        log.warning(f\"BAD SIGNATURE: {sig}\")\n+\n+    for sig in unknown:\n+        log.warning(f\"UNKNOWN SIGNATURE: {sig}\")\n+\n+    return (ReturnCode.SUCCESS, good_trusted, good_untrusted, unknown, bad)\n+\n+\n+def parse_sums_file(sums_file_path: str, filename_filter: t.List[str]) -> t.List[t.List[str]]:\n+    # extract hashes/filenames of binaries to verify from hash file;\n+    # each line has the following format: \"<hash> <binary_filename>\"\n+    with open(sums_file_path, 'r', encoding='utf8') as hash_file:\n+        return [line.split()[:2] for line in hash_file if len(filename_filter) == 0 or any(f in line for f in filename_filter)]\n+\n+\n+def verify_binary_hashes(hashes_to_verify: t.List[t.List[str]]) -> t.Tuple[ReturnCode, t.Dict[str, str]]:\n+    offending_files = []\n+    files_to_hashes = {}\n+\n+    for hash_expected, binary_filename in hashes_to_verify:\n+        with open(binary_filename, 'rb') as binary_file:\n+            hash_calculated = sha256(binary_file.read()).hexdigest()\n+        if hash_calculated != hash_expected:\n+            offending_files.append(binary_filename)\n+        else:\n+            files_to_hashes[binary_filename] = hash_calculated\n+\n+    if offending_files:\n+        joined_files = '\\n'.join(offending_files)\n+        log.critical(\n+            \"Hashes don't match.\\n\"\n+            f\"Offending files:\\n{joined_files}\")\n+        return (ReturnCode.INTEGRITY_FAILURE, files_to_hashes)\n+\n+    return (ReturnCode.SUCCESS, files_to_hashes)\n+\n+\n+def verify_published_handler(args: argparse.Namespace) -> ReturnCode:\n+    WORKINGDIR = Path(tempfile.gettempdir()) / f\"bitcoin_verify_binaries.{args.version}\"\n+\n+    def cleanup():\n+        log.info(\"cleaning up files\")\n+        os.chdir(Path.home())\n+        shutil.rmtree(WORKINGDIR)\n \n     # determine remote dir dependent on provided version string\n-    version_base, version_rc, os_filter = parse_version_string(args[0])\n+    try:\n+        version_base, version_rc, os_filter = parse_version_string(args.version)\n+        version_tuple = [int(i) for i in version_base.split('.')]\n+    except Exception as e:\n+        log.debug(e)\n+        log.error(f\"unable to parse version; expected format is {VERSION_FORMAT}\")\n+        log.error(f\"  e.g. {VERSION_EXAMPLE}\")\n+        return ReturnCode.BAD_VERSION\n+\n     remote_dir = f\"/bin/{VERSIONPREFIX}{version_base}/\"\n     if version_rc:\n         remote_dir += f\"test.{version_rc}/\"\n-    remote_sigfile = remote_dir + SIGNATUREFILENAME\n+    remote_sigs_path = remote_dir + SIGNATUREFILENAME\n+    remote_sums_path = remote_dir + SUMS_FILENAME\n \n     # create working directory\n     os.makedirs(WORKINGDIR, exist_ok=True)\n     os.chdir(WORKINGDIR)\n \n-    # fetch first signature file\n-    sigfile1 = SIGNATUREFILENAME\n-    success, output = download_with_wget(HOST1 + remote_sigfile, sigfile1)\n-    if not success:\n-        print(\"Error: couldn't fetch signature file. \"\n-              \"Have you specified the version number in the following format?\")\n-        print(f\"[{VERSIONPREFIX}]<version>[-rc[0-9]][-platform] \"\n-              f\"(example: {VERSIONPREFIX}0.21.0-rc3-osx)\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        return 4\n-\n-    # fetch second signature file\n-    sigfile2 = SIGNATUREFILENAME + \".2\"\n-    success, output = download_with_wget(HOST2 + remote_sigfile, sigfile2)\n-    if not success:\n-        print(\"bitcoin.org failed to provide signature file, \"\n-              \"but bitcoincore.org did?\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1])\n-        return 5\n-\n-    # ensure that both signature files are equal\n-    if not files_are_equal(sigfile1, sigfile2):\n-        print(\"bitcoin.org and bitcoincore.org signature files were not equal?\")\n-        print(f\"See files {WORKINGDIR}/{sigfile1} and {WORKINGDIR}/{sigfile2}\")\n-        return 6\n-\n-    # check signature and extract data into file\n-    retval, output = verify_with_gpg(sigfile1, HASHFILE)\n-    if retval != 0:\n-        if retval == 1:\n-            print(\"Bad signature.\")\n-        elif retval == 2:\n-            print(\"gpg error. Do you have the Bitcoin Core binary release \"\n-                  \"signing key installed?\")\n-        print(\"gpg output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1, sigfile2, HASHFILE])\n-        return 1\n+    hosts = [HOST1, HOST2]\n \n-    # extract hashes/filenames of binaries to verify from hash file;\n-    # each line has the following format: \"<hash> <binary_filename>\"\n-    with open(HASHFILE, 'r', encoding='utf8') as hash_file:\n-        hashes_to_verify = [\n-            line.split()[:2] for line in hash_file if os_filter in line]\n-    remove_files([HASHFILE])\n+    got_sig_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sigs_path, SIGNATUREFILENAME, args.require_all_hosts)\n+    if got_sig_status != ReturnCode.SUCCESS:\n+        return got_sig_status\n+\n+    # Multi-sig verification is available after 22.0.\n+    if version_tuple[0] < 22:\n+        log.error(\"Version too old - single sig not supported. Use a previous \"\n+                  \"version of this script from the repo.\")\n+        return ReturnCode.BAD_VERSION\n+\n+    got_sums_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sums_path, SUMS_FILENAME, args.require_all_hosts)\n+    if got_sums_status != ReturnCode.SUCCESS:\n+        return got_sums_status\n+\n+    # Verify the signature on the SHA256SUMS file\n+    sigs_status, good_trusted, good_untrusted, unknown, bad = verify_shasums_signature(SIGNATUREFILENAME, SUMS_FILENAME, args)\n+    if sigs_status != ReturnCode.SUCCESS:\n+        if sigs_status == ReturnCode.INTEGRITY_FAILURE:\n+            cleanup()\n+        return sigs_status\n+\n+    # Extract hashes and filenames\n+    hashes_to_verify = parse_sums_file(SUMS_FILENAME, os_filter)",
      "path": "contrib/verifybinaries/verify.py",
      "position": null,
      "original_position": 593,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    hashes_to_verify = parse_sums_file(SUMS_FILENAME, [os_filter])\r\n```\r\n",
      "created_at": "2023-04-06T10:29:12Z",
      "updated_at": "2023-04-06T10:30:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1159606675",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159606675"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 514,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159607865",
      "pull_request_review_id": 1374562702,
      "id": 1159607865,
      "node_id": "PRRC_kwDOABII585FHjY5",
      "diff_hunk": "@@ -47,137 +115,598 @@ def parse_version_string(version_str):\n     return version_base, version_rc, version_os\n \n \n-def download_with_wget(remote_file, local_file=None):\n-    if local_file:\n-        wget_args = ['wget', '-O', local_file, remote_file]\n-    else:\n-        # use timestamping mechanism if local filename is not explicitly set\n-        wget_args = ['wget', '-N', remote_file]\n-\n-    result = subprocess.run(wget_args,\n+def download_with_wget(remote_file, local_file):\n+    result = subprocess.run(['wget', '-O', local_file, remote_file],\n                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n     return result.returncode == 0, result.stdout.decode().rstrip()\n \n \n+def download_lines_with_urllib(url) -> t.Tuple[bool, t.List[str]]:\n+    \"\"\"Get (success, text lines of a file) over HTTP.\"\"\"\n+    try:\n+        return (True, [\n+            line.strip().decode() for line in urllib.request.urlopen(url).readlines()])\n+    except urllib.request.HTTPError as e:\n+        log.warning(f\"HTTP request to {url} failed (HTTPError): {e}\")\n+    except Exception as e:\n+        log.warning(f\"HTTP request to {url} failed ({e})\")\n+    return (False, [])\n+\n+\n+def verify_with_gpg(\n+    filename,\n+    signature_filename,\n+    output_filename: t.Optional[str] = None\n+) -> t.Tuple[int, str]:\n+    with tempfile.NamedTemporaryFile() as status_file:\n+        args = [\n+            'gpg', '--yes', '--verify', '--verify-options', 'show-primary-uid-only', \"--status-file\", status_file.name,\n+            '--output', output_filename if output_filename else '', signature_filename, filename]\n+\n+        env = dict(os.environ, LANGUAGE='en')\n+        result = subprocess.run(args, stderr=subprocess.STDOUT, stdout=subprocess.PIPE, env=env)\n+\n+        gpg_data = status_file.read().decode().rstrip()\n+\n+    log.debug(f'Result from GPG ({result.returncode}): {result.stdout.decode()}')\n+    log.debug(f\"{gpg_data}\")\n+    return result.returncode, gpg_data\n+\n+\n+def remove_files(filenames):\n+    for filename in filenames:\n+        os.remove(filename)\n+\n+\n+class SigData:\n+    \"\"\"GPG signature data as parsed from GPG stdout.\"\"\"\n+    def __init__(self):\n+        self.key = None\n+        self.name = \"\"\n+        self.trusted = False\n+        self.status = \"\"\n+\n+    def __bool__(self):\n+        return self.key is not None\n+\n+    def __repr__(self):\n+        return (\n+            \"SigData(%r, %r, trusted=%s, status=%r)\" %\n+            (self.key, self.name, self.trusted, self.status))\n+\n+\n+def parse_gpg_result(\n+    output: t.List[str]\n+) -> t.Tuple[t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    \"\"\"Returns good, unknown, and bad signatures from GPG stdout.\"\"\"\n+    good_sigs: t.List[SigData] = []\n+    unknown_sigs: t.List[SigData] = []\n+    bad_sigs: t.List[SigData] = []\n+    total_resolved_sigs = 0\n+\n+    # Ensure that all lines we match on include a prefix that prevents malicious input\n+    # from fooling the parser.\n+    def line_begins_with(patt: str, line: str) -> t.Optional[re.Match]:\n+        return re.match(r'^(\\[GNUPG:\\])\\s+' + patt, line)\n+\n+    curr_sigs = unknown_sigs\n+    curr_sigdata = SigData()\n+\n+    for line in output:\n+        if line_begins_with(r\"NEWSIG(?:\\s|$)\", line):\n+            total_resolved_sigs += 1\n+            if curr_sigdata:\n+                curr_sigs.append(curr_sigdata)\n+                curr_sigdata = SigData()\n+            newsig_split = line.split()\n+            if len(newsig_split) == 3:\n+                curr_sigdata.name = newsig_split[2]\n+\n+        elif line_begins_with(r\"GOODSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+\n+        elif line_begins_with(r\"EXPKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"expired\"\n+\n+        elif line_begins_with(r\"REVKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"revoked\"\n+\n+        elif line_begins_with(r\"BADSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = bad_sigs\n+\n+        elif line_begins_with(r\"ERRSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, _, _, _, _, _ = line.split()[2:8]\n+            curr_sigs = unknown_sigs\n+\n+        elif line_begins_with(r\"TRUST_(UNDEFINED|NEVER)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = False\n+\n+        elif line_begins_with(r\"TRUST_(MARGINAL|FULLY|ULTIMATE)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = True\n+\n+    # The last one won't have been added, so add it now\n+    assert curr_sigdata\n+    curr_sigs.append(curr_sigdata)\n+\n+    all_found = len(good_sigs + bad_sigs + unknown_sigs)\n+    if all_found != total_resolved_sigs:\n+        raise RuntimeError(\n+            f\"failed to evaluate all signatures: found {all_found} \"\n+            f\"but expected {total_resolved_sigs}\")\n+\n+    return (good_sigs, unknown_sigs, bad_sigs)\n+\n+\n def files_are_equal(filename1, filename2):\n     with open(filename1, 'rb') as file1:\n         contents1 = file1.read()\n     with open(filename2, 'rb') as file2:\n         contents2 = file2.read()\n-    return contents1 == contents2\n+    eq = contents1 == contents2\n \n+    if not eq:\n+        with open(filename1, 'r', encoding='utf-8') as f1, \\\n+                open(filename2, 'r', encoding='utf-8') as f2:\n+            f1lines = f1.readlines()\n+            f2lines = f2.readlines()\n \n-def verify_with_gpg(signature_filename, output_filename):\n-    result = subprocess.run(['gpg', '--yes', '--decrypt', '--output',\n-                             output_filename, signature_filename],\n-                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n-    return result.returncode, result.stdout.decode().rstrip()\n+            diff = indent(\n+                ''.join(difflib.unified_diff(f1lines, f2lines)))\n+            log.warning(f\"found diff in files ({filename1}, {filename2}):\\n{diff}\\n\")\n \n+    return eq\n \n-def remove_files(filenames):\n-    for filename in filenames:\n-        os.remove(filename)\n+\n+def get_files_from_hosts_and_compare(\n+    hosts: t.List[str], path: str, filename: str, require_all: bool = False\n+) -> ReturnCode:\n+    \"\"\"\n+    Retrieve the same file from a number of hosts and ensure they have the same contents.\n+    The first host given will be treated as the \"primary\" host, and is required to succeed.\n+\n+    Args:\n+        filename: for writing the file locally.\n+    \"\"\"\n+    assert len(hosts) > 1\n+    primary_host = hosts[0]\n+    other_hosts = hosts[1:]\n+    got_files = []\n+\n+    def join_url(host: str) -> str:\n+        return host.rstrip('/') + '/' + path.lstrip('/')\n+\n+    url = join_url(primary_host)\n+    success, output = download_with_wget(url, filename)\n+    if not success:\n+        log.error(\n+            f\"couldn't fetch file ({url}). \"\n+            \"Have you specified the version number in the following format?\\n\"\n+            f\"{VERSION_FORMAT} \"\n+            f\"(example: {VERSION_EXAMPLE})\\n\"\n+            f\"wget output:\\n{indent(output)}\")\n+        return ReturnCode.FILE_GET_FAILED\n+    else:\n+        log.info(f\"got file {url} as {filename}\")\n+        got_files.append(filename)\n+\n+    for i, host in enumerate(other_hosts):\n+        url = join_url(host)\n+        fname = filename + f'.{i + 2}'\n+        success, output = download_with_wget(url, fname)\n+\n+        if require_all and not success:\n+            log.error(\n+                f\"{host} failed to provide file ({url}), but {primary_host} did?\\n\"\n+                f\"wget output:\\n{indent(output)}\")\n+            return ReturnCode.FILE_MISSING_FROM_ONE_HOST\n+        elif not success:\n+            log.warning(\n+                f\"{host} failed to provide file ({url}). \"\n+                f\"Continuing based solely upon {primary_host}.\")\n+        else:\n+            log.info(f\"got file {url} as {fname}\")\n+            got_files.append(fname)\n+\n+    for i, got_file in enumerate(got_files):\n+        if got_file == got_files[-1]:\n+            break  # break on last file, nothing after it to compare to\n+\n+        compare_to = got_files[i + 1]\n+        if not files_are_equal(got_file, compare_to):\n+            log.error(f\"files not equal: {got_file} and {compare_to}\")\n+            return ReturnCode.FILES_NOT_EQUAL\n+\n+    return ReturnCode.SUCCESS\n+\n+\n+def check_multisig(sums_file: str, sigfilename: str, args: argparse.Namespace) -> t.Tuple[int, str, t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    # check signature\n+    #\n+    # We don't write output to a file because this command will almost certainly\n+    # fail with GPG exit code '2' (and so not writing to --output) because of the\n+    # likely presence of multiple untrusted signatures.\n+    retval, output = verify_with_gpg(sums_file, sigfilename)\n+\n+    if args.verbose:\n+        log.info(f\"gpg output:\\n{indent(output)}\")\n+\n+    good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    if unknown and args.import_keys:\n+        # Retrieve unknown keys and then try GPG again.\n+        for unsig in unknown:\n+            if prompt_yn(f\" ? Retrieve key {unsig.key} ({unsig.name})? (y/N) \"):\n+                ran = subprocess.run(\n+                    [\"gpg\", \"--keyserver\", args.keyserver, \"--recv-keys\", unsig.key])\n+\n+                if ran.returncode != 0:\n+                    log.warning(f\"failed to retrieve key {unsig.key}\")\n+\n+        # Reparse the GPG output now that we have more keys\n+        retval, output = verify_with_gpg(sums_file, sigfilename)\n+        good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    return retval, output, good, unknown, bad\n \n \n-def main(args):\n-    # sanity check\n-    if len(args) < 1:\n-        print(\"Error: need to specify a version on the command line\")\n-        return 3\n+def prompt_yn(prompt) -> bool:\n+    \"\"\"Return true if the user inputs 'y'.\"\"\"\n+    got = ''\n+    while got not in ['y', 'n']:\n+        got = input(prompt).lower()\n+    return got == 'y'\n+\n+def verify_shasums_signature(\n+    signature_file_path: str, sums_file_path: str, args: argparse.Namespace\n+) -> t.Tuple[\n+   ReturnCode, t.List[SigData], t.List[SigData], t.List[SigData], t.List[SigData]\n+]:\n+    min_good_sigs = args.min_good_sigs\n+    gpg_allowed_codes = [0, 2]  # 2 is returned when untrusted signatures are present.\n+\n+    gpg_retval, gpg_output, good, unknown, bad = check_multisig(sums_file_path, signature_file_path, args)\n+\n+    if gpg_retval not in gpg_allowed_codes:\n+        if gpg_retval == 1:\n+            log.critical(f\"Bad signature (code: {gpg_retval}).\")\n+        else:\n+            log.critical(f\"unexpected GPG exit code ({gpg_retval})\")\n+\n+        log.error(f\"gpg output:\\n{indent(gpg_output)}\")\n+        return (ReturnCode.INTEGRITY_FAILURE, [], [], [], [])\n+\n+    # Decide which keys we trust, though not \"trust\" in the GPG sense, but rather\n+    # which pubkeys convince us that this sums file is legitimate. In other words,\n+    # which pubkeys within the Bitcoin community do we trust for the purposes of\n+    # binary verification?\n+    trusted_keys = set()\n+    if args.trusted_keys:\n+        trusted_keys |= set(args.trusted_keys.split(','))\n+\n+    # Tally signatures and make sure we have enough goods to fulfill\n+    # our threshold.\n+    good_trusted = [sig for sig in good if sig.trusted or sig.key in trusted_keys]\n+    good_untrusted = [sig for sig in good if sig not in good_trusted]\n+    num_trusted = len(good_trusted) + len(good_untrusted)\n+    log.info(f\"got {num_trusted} good signatures\")\n+\n+    if num_trusted < min_good_sigs:\n+        log.info(\"Maybe you need to import \"\n+                  f\"(`gpg --keyserver {args.keyserver} --recv-keys <key-id>`) \"\n+                  \"some of the following keys: \")\n+        log.info('')\n+        for sig in unknown:\n+            log.info(f\"    {sig.key} ({sig.name})\")\n+        log.info('')\n+        log.error(\n+            \"not enough trusted sigs to meet threshold \"\n+            f\"({num_trusted} vs. {min_good_sigs})\")\n+\n+        return (ReturnCode.NOT_ENOUGH_GOOD_SIGS, [], [], [], [])\n+\n+    for sig in good_trusted:\n+        log.info(f\"GOOD SIGNATURE: {sig}\")\n+\n+    for sig in good_untrusted:\n+        log.info(f\"GOOD SIGNATURE (untrusted): {sig}\")\n+\n+    for sig in [sig for sig in good if sig.status == 'expired']:\n+        log.warning(f\"key {sig.key} for {sig.name} is expired\")\n+\n+    for sig in bad:\n+        log.warning(f\"BAD SIGNATURE: {sig}\")\n+\n+    for sig in unknown:\n+        log.warning(f\"UNKNOWN SIGNATURE: {sig}\")\n+\n+    return (ReturnCode.SUCCESS, good_trusted, good_untrusted, unknown, bad)\n+\n+\n+def parse_sums_file(sums_file_path: str, filename_filter: t.List[str]) -> t.List[t.List[str]]:\n+    # extract hashes/filenames of binaries to verify from hash file;\n+    # each line has the following format: \"<hash> <binary_filename>\"\n+    with open(sums_file_path, 'r', encoding='utf8') as hash_file:\n+        return [line.split()[:2] for line in hash_file if len(filename_filter) == 0 or any(f in line for f in filename_filter)]\n+\n+\n+def verify_binary_hashes(hashes_to_verify: t.List[t.List[str]]) -> t.Tuple[ReturnCode, t.Dict[str, str]]:\n+    offending_files = []\n+    files_to_hashes = {}\n+\n+    for hash_expected, binary_filename in hashes_to_verify:\n+        with open(binary_filename, 'rb') as binary_file:\n+            hash_calculated = sha256(binary_file.read()).hexdigest()\n+        if hash_calculated != hash_expected:\n+            offending_files.append(binary_filename)\n+        else:\n+            files_to_hashes[binary_filename] = hash_calculated\n+\n+    if offending_files:\n+        joined_files = '\\n'.join(offending_files)\n+        log.critical(\n+            \"Hashes don't match.\\n\"\n+            f\"Offending files:\\n{joined_files}\")\n+        return (ReturnCode.INTEGRITY_FAILURE, files_to_hashes)\n+\n+    return (ReturnCode.SUCCESS, files_to_hashes)\n+\n+\n+def verify_published_handler(args: argparse.Namespace) -> ReturnCode:\n+    WORKINGDIR = Path(tempfile.gettempdir()) / f\"bitcoin_verify_binaries.{args.version}\"\n+\n+    def cleanup():\n+        log.info(\"cleaning up files\")\n+        os.chdir(Path.home())\n+        shutil.rmtree(WORKINGDIR)\n \n     # determine remote dir dependent on provided version string\n-    version_base, version_rc, os_filter = parse_version_string(args[0])\n+    try:\n+        version_base, version_rc, os_filter = parse_version_string(args.version)\n+        version_tuple = [int(i) for i in version_base.split('.')]\n+    except Exception as e:\n+        log.debug(e)\n+        log.error(f\"unable to parse version; expected format is {VERSION_FORMAT}\")\n+        log.error(f\"  e.g. {VERSION_EXAMPLE}\")\n+        return ReturnCode.BAD_VERSION\n+\n     remote_dir = f\"/bin/{VERSIONPREFIX}{version_base}/\"\n     if version_rc:\n         remote_dir += f\"test.{version_rc}/\"\n-    remote_sigfile = remote_dir + SIGNATUREFILENAME\n+    remote_sigs_path = remote_dir + SIGNATUREFILENAME\n+    remote_sums_path = remote_dir + SUMS_FILENAME\n \n     # create working directory\n     os.makedirs(WORKINGDIR, exist_ok=True)\n     os.chdir(WORKINGDIR)\n \n-    # fetch first signature file\n-    sigfile1 = SIGNATUREFILENAME\n-    success, output = download_with_wget(HOST1 + remote_sigfile, sigfile1)\n-    if not success:\n-        print(\"Error: couldn't fetch signature file. \"\n-              \"Have you specified the version number in the following format?\")\n-        print(f\"[{VERSIONPREFIX}]<version>[-rc[0-9]][-platform] \"\n-              f\"(example: {VERSIONPREFIX}0.21.0-rc3-osx)\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        return 4\n-\n-    # fetch second signature file\n-    sigfile2 = SIGNATUREFILENAME + \".2\"\n-    success, output = download_with_wget(HOST2 + remote_sigfile, sigfile2)\n-    if not success:\n-        print(\"bitcoin.org failed to provide signature file, \"\n-              \"but bitcoincore.org did?\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1])\n-        return 5\n-\n-    # ensure that both signature files are equal\n-    if not files_are_equal(sigfile1, sigfile2):\n-        print(\"bitcoin.org and bitcoincore.org signature files were not equal?\")\n-        print(f\"See files {WORKINGDIR}/{sigfile1} and {WORKINGDIR}/{sigfile2}\")\n-        return 6\n-\n-    # check signature and extract data into file\n-    retval, output = verify_with_gpg(sigfile1, HASHFILE)\n-    if retval != 0:\n-        if retval == 1:\n-            print(\"Bad signature.\")\n-        elif retval == 2:\n-            print(\"gpg error. Do you have the Bitcoin Core binary release \"\n-                  \"signing key installed?\")\n-        print(\"gpg output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1, sigfile2, HASHFILE])\n-        return 1\n+    hosts = [HOST1, HOST2]\n \n-    # extract hashes/filenames of binaries to verify from hash file;\n-    # each line has the following format: \"<hash> <binary_filename>\"\n-    with open(HASHFILE, 'r', encoding='utf8') as hash_file:\n-        hashes_to_verify = [\n-            line.split()[:2] for line in hash_file if os_filter in line]\n-    remove_files([HASHFILE])\n+    got_sig_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sigs_path, SIGNATUREFILENAME, args.require_all_hosts)\n+    if got_sig_status != ReturnCode.SUCCESS:\n+        return got_sig_status\n+\n+    # Multi-sig verification is available after 22.0.\n+    if version_tuple[0] < 22:\n+        log.error(\"Version too old - single sig not supported. Use a previous \"\n+                  \"version of this script from the repo.\")\n+        return ReturnCode.BAD_VERSION\n+\n+    got_sums_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sums_path, SUMS_FILENAME, args.require_all_hosts)\n+    if got_sums_status != ReturnCode.SUCCESS:\n+        return got_sums_status\n+\n+    # Verify the signature on the SHA256SUMS file\n+    sigs_status, good_trusted, good_untrusted, unknown, bad = verify_shasums_signature(SIGNATUREFILENAME, SUMS_FILENAME, args)\n+    if sigs_status != ReturnCode.SUCCESS:\n+        if sigs_status == ReturnCode.INTEGRITY_FAILURE:\n+            cleanup()\n+        return sigs_status\n+\n+    # Extract hashes and filenames\n+    hashes_to_verify = parse_sums_file(SUMS_FILENAME, os_filter)",
      "path": "contrib/verifybinaries/verify.py",
      "position": null,
      "original_position": 593,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": 1159606675,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`parse_sums_file` expects a list of strings. This should fix the download selection filter.",
      "created_at": "2023-04-06T10:30:06Z",
      "updated_at": "2023-04-06T10:30:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1159607865",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159607865"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 514,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159666836",
      "pull_request_review_id": 1374659853,
      "id": 1159666836,
      "node_id": "PRRC_kwDOABII585FHxyU",
      "diff_hunk": "@@ -47,137 +115,598 @@ def parse_version_string(version_str):\n     return version_base, version_rc, version_os\n \n \n-def download_with_wget(remote_file, local_file=None):\n-    if local_file:\n-        wget_args = ['wget', '-O', local_file, remote_file]\n-    else:\n-        # use timestamping mechanism if local filename is not explicitly set\n-        wget_args = ['wget', '-N', remote_file]\n-\n-    result = subprocess.run(wget_args,\n+def download_with_wget(remote_file, local_file):\n+    result = subprocess.run(['wget', '-O', local_file, remote_file],\n                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n     return result.returncode == 0, result.stdout.decode().rstrip()\n \n \n+def download_lines_with_urllib(url) -> t.Tuple[bool, t.List[str]]:\n+    \"\"\"Get (success, text lines of a file) over HTTP.\"\"\"\n+    try:\n+        return (True, [\n+            line.strip().decode() for line in urllib.request.urlopen(url).readlines()])\n+    except urllib.request.HTTPError as e:\n+        log.warning(f\"HTTP request to {url} failed (HTTPError): {e}\")\n+    except Exception as e:\n+        log.warning(f\"HTTP request to {url} failed ({e})\")\n+    return (False, [])\n+\n+\n+def verify_with_gpg(\n+    filename,\n+    signature_filename,\n+    output_filename: t.Optional[str] = None\n+) -> t.Tuple[int, str]:\n+    with tempfile.NamedTemporaryFile() as status_file:\n+        args = [\n+            'gpg', '--yes', '--verify', '--verify-options', 'show-primary-uid-only', \"--status-file\", status_file.name,\n+            '--output', output_filename if output_filename else '', signature_filename, filename]\n+\n+        env = dict(os.environ, LANGUAGE='en')\n+        result = subprocess.run(args, stderr=subprocess.STDOUT, stdout=subprocess.PIPE, env=env)\n+\n+        gpg_data = status_file.read().decode().rstrip()\n+\n+    log.debug(f'Result from GPG ({result.returncode}): {result.stdout.decode()}')\n+    log.debug(f\"{gpg_data}\")\n+    return result.returncode, gpg_data\n+\n+\n+def remove_files(filenames):\n+    for filename in filenames:\n+        os.remove(filename)\n+\n+\n+class SigData:\n+    \"\"\"GPG signature data as parsed from GPG stdout.\"\"\"\n+    def __init__(self):\n+        self.key = None\n+        self.name = \"\"\n+        self.trusted = False\n+        self.status = \"\"\n+\n+    def __bool__(self):\n+        return self.key is not None\n+\n+    def __repr__(self):\n+        return (\n+            \"SigData(%r, %r, trusted=%s, status=%r)\" %\n+            (self.key, self.name, self.trusted, self.status))\n+\n+\n+def parse_gpg_result(\n+    output: t.List[str]\n+) -> t.Tuple[t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    \"\"\"Returns good, unknown, and bad signatures from GPG stdout.\"\"\"\n+    good_sigs: t.List[SigData] = []\n+    unknown_sigs: t.List[SigData] = []\n+    bad_sigs: t.List[SigData] = []\n+    total_resolved_sigs = 0\n+\n+    # Ensure that all lines we match on include a prefix that prevents malicious input\n+    # from fooling the parser.\n+    def line_begins_with(patt: str, line: str) -> t.Optional[re.Match]:\n+        return re.match(r'^(\\[GNUPG:\\])\\s+' + patt, line)\n+\n+    curr_sigs = unknown_sigs\n+    curr_sigdata = SigData()\n+\n+    for line in output:\n+        if line_begins_with(r\"NEWSIG(?:\\s|$)\", line):\n+            total_resolved_sigs += 1\n+            if curr_sigdata:\n+                curr_sigs.append(curr_sigdata)\n+                curr_sigdata = SigData()\n+            newsig_split = line.split()\n+            if len(newsig_split) == 3:\n+                curr_sigdata.name = newsig_split[2]\n+\n+        elif line_begins_with(r\"GOODSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+\n+        elif line_begins_with(r\"EXPKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"expired\"\n+\n+        elif line_begins_with(r\"REVKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"revoked\"\n+\n+        elif line_begins_with(r\"BADSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = bad_sigs\n+\n+        elif line_begins_with(r\"ERRSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, _, _, _, _, _ = line.split()[2:8]\n+            curr_sigs = unknown_sigs\n+\n+        elif line_begins_with(r\"TRUST_(UNDEFINED|NEVER)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = False\n+\n+        elif line_begins_with(r\"TRUST_(MARGINAL|FULLY|ULTIMATE)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = True\n+\n+    # The last one won't have been added, so add it now\n+    assert curr_sigdata\n+    curr_sigs.append(curr_sigdata)\n+\n+    all_found = len(good_sigs + bad_sigs + unknown_sigs)\n+    if all_found != total_resolved_sigs:\n+        raise RuntimeError(\n+            f\"failed to evaluate all signatures: found {all_found} \"\n+            f\"but expected {total_resolved_sigs}\")\n+\n+    return (good_sigs, unknown_sigs, bad_sigs)\n+\n+\n def files_are_equal(filename1, filename2):\n     with open(filename1, 'rb') as file1:\n         contents1 = file1.read()\n     with open(filename2, 'rb') as file2:\n         contents2 = file2.read()\n-    return contents1 == contents2\n+    eq = contents1 == contents2\n \n+    if not eq:\n+        with open(filename1, 'r', encoding='utf-8') as f1, \\\n+                open(filename2, 'r', encoding='utf-8') as f2:\n+            f1lines = f1.readlines()\n+            f2lines = f2.readlines()\n \n-def verify_with_gpg(signature_filename, output_filename):\n-    result = subprocess.run(['gpg', '--yes', '--decrypt', '--output',\n-                             output_filename, signature_filename],\n-                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n-    return result.returncode, result.stdout.decode().rstrip()\n+            diff = indent(\n+                ''.join(difflib.unified_diff(f1lines, f2lines)))\n+            log.warning(f\"found diff in files ({filename1}, {filename2}):\\n{diff}\\n\")\n \n+    return eq\n \n-def remove_files(filenames):\n-    for filename in filenames:\n-        os.remove(filename)\n+\n+def get_files_from_hosts_and_compare(\n+    hosts: t.List[str], path: str, filename: str, require_all: bool = False\n+) -> ReturnCode:\n+    \"\"\"\n+    Retrieve the same file from a number of hosts and ensure they have the same contents.\n+    The first host given will be treated as the \"primary\" host, and is required to succeed.\n+\n+    Args:\n+        filename: for writing the file locally.\n+    \"\"\"\n+    assert len(hosts) > 1\n+    primary_host = hosts[0]\n+    other_hosts = hosts[1:]\n+    got_files = []\n+\n+    def join_url(host: str) -> str:\n+        return host.rstrip('/') + '/' + path.lstrip('/')\n+\n+    url = join_url(primary_host)\n+    success, output = download_with_wget(url, filename)\n+    if not success:\n+        log.error(\n+            f\"couldn't fetch file ({url}). \"\n+            \"Have you specified the version number in the following format?\\n\"\n+            f\"{VERSION_FORMAT} \"\n+            f\"(example: {VERSION_EXAMPLE})\\n\"\n+            f\"wget output:\\n{indent(output)}\")\n+        return ReturnCode.FILE_GET_FAILED\n+    else:\n+        log.info(f\"got file {url} as {filename}\")\n+        got_files.append(filename)\n+\n+    for i, host in enumerate(other_hosts):\n+        url = join_url(host)\n+        fname = filename + f'.{i + 2}'\n+        success, output = download_with_wget(url, fname)\n+\n+        if require_all and not success:\n+            log.error(\n+                f\"{host} failed to provide file ({url}), but {primary_host} did?\\n\"\n+                f\"wget output:\\n{indent(output)}\")\n+            return ReturnCode.FILE_MISSING_FROM_ONE_HOST\n+        elif not success:\n+            log.warning(\n+                f\"{host} failed to provide file ({url}). \"\n+                f\"Continuing based solely upon {primary_host}.\")\n+        else:\n+            log.info(f\"got file {url} as {fname}\")\n+            got_files.append(fname)\n+\n+    for i, got_file in enumerate(got_files):\n+        if got_file == got_files[-1]:\n+            break  # break on last file, nothing after it to compare to\n+\n+        compare_to = got_files[i + 1]\n+        if not files_are_equal(got_file, compare_to):\n+            log.error(f\"files not equal: {got_file} and {compare_to}\")\n+            return ReturnCode.FILES_NOT_EQUAL\n+\n+    return ReturnCode.SUCCESS\n+\n+\n+def check_multisig(sums_file: str, sigfilename: str, args: argparse.Namespace) -> t.Tuple[int, str, t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    # check signature\n+    #\n+    # We don't write output to a file because this command will almost certainly\n+    # fail with GPG exit code '2' (and so not writing to --output) because of the\n+    # likely presence of multiple untrusted signatures.\n+    retval, output = verify_with_gpg(sums_file, sigfilename)\n+\n+    if args.verbose:\n+        log.info(f\"gpg output:\\n{indent(output)}\")\n+\n+    good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    if unknown and args.import_keys:\n+        # Retrieve unknown keys and then try GPG again.\n+        for unsig in unknown:\n+            if prompt_yn(f\" ? Retrieve key {unsig.key} ({unsig.name})? (y/N) \"):\n+                ran = subprocess.run(\n+                    [\"gpg\", \"--keyserver\", args.keyserver, \"--recv-keys\", unsig.key])\n+\n+                if ran.returncode != 0:\n+                    log.warning(f\"failed to retrieve key {unsig.key}\")\n+\n+        # Reparse the GPG output now that we have more keys\n+        retval, output = verify_with_gpg(sums_file, sigfilename)\n+        good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    return retval, output, good, unknown, bad\n \n \n-def main(args):\n-    # sanity check\n-    if len(args) < 1:\n-        print(\"Error: need to specify a version on the command line\")\n-        return 3\n+def prompt_yn(prompt) -> bool:\n+    \"\"\"Return true if the user inputs 'y'.\"\"\"\n+    got = ''\n+    while got not in ['y', 'n']:\n+        got = input(prompt).lower()\n+    return got == 'y'\n+\n+def verify_shasums_signature(\n+    signature_file_path: str, sums_file_path: str, args: argparse.Namespace\n+) -> t.Tuple[\n+   ReturnCode, t.List[SigData], t.List[SigData], t.List[SigData], t.List[SigData]\n+]:\n+    min_good_sigs = args.min_good_sigs\n+    gpg_allowed_codes = [0, 2]  # 2 is returned when untrusted signatures are present.\n+\n+    gpg_retval, gpg_output, good, unknown, bad = check_multisig(sums_file_path, signature_file_path, args)\n+\n+    if gpg_retval not in gpg_allowed_codes:\n+        if gpg_retval == 1:\n+            log.critical(f\"Bad signature (code: {gpg_retval}).\")\n+        else:\n+            log.critical(f\"unexpected GPG exit code ({gpg_retval})\")\n+\n+        log.error(f\"gpg output:\\n{indent(gpg_output)}\")\n+        return (ReturnCode.INTEGRITY_FAILURE, [], [], [], [])\n+\n+    # Decide which keys we trust, though not \"trust\" in the GPG sense, but rather\n+    # which pubkeys convince us that this sums file is legitimate. In other words,\n+    # which pubkeys within the Bitcoin community do we trust for the purposes of\n+    # binary verification?\n+    trusted_keys = set()\n+    if args.trusted_keys:\n+        trusted_keys |= set(args.trusted_keys.split(','))\n+\n+    # Tally signatures and make sure we have enough goods to fulfill\n+    # our threshold.\n+    good_trusted = [sig for sig in good if sig.trusted or sig.key in trusted_keys]\n+    good_untrusted = [sig for sig in good if sig not in good_trusted]\n+    num_trusted = len(good_trusted) + len(good_untrusted)\n+    log.info(f\"got {num_trusted} good signatures\")\n+\n+    if num_trusted < min_good_sigs:\n+        log.info(\"Maybe you need to import \"\n+                  f\"(`gpg --keyserver {args.keyserver} --recv-keys <key-id>`) \"\n+                  \"some of the following keys: \")\n+        log.info('')\n+        for sig in unknown:\n+            log.info(f\"    {sig.key} ({sig.name})\")\n+        log.info('')\n+        log.error(\n+            \"not enough trusted sigs to meet threshold \"\n+            f\"({num_trusted} vs. {min_good_sigs})\")\n+\n+        return (ReturnCode.NOT_ENOUGH_GOOD_SIGS, [], [], [], [])\n+\n+    for sig in good_trusted:\n+        log.info(f\"GOOD SIGNATURE: {sig}\")\n+\n+    for sig in good_untrusted:\n+        log.info(f\"GOOD SIGNATURE (untrusted): {sig}\")\n+\n+    for sig in [sig for sig in good if sig.status == 'expired']:\n+        log.warning(f\"key {sig.key} for {sig.name} is expired\")\n+\n+    for sig in bad:\n+        log.warning(f\"BAD SIGNATURE: {sig}\")\n+\n+    for sig in unknown:\n+        log.warning(f\"UNKNOWN SIGNATURE: {sig}\")\n+\n+    return (ReturnCode.SUCCESS, good_trusted, good_untrusted, unknown, bad)\n+\n+\n+def parse_sums_file(sums_file_path: str, filename_filter: t.List[str]) -> t.List[t.List[str]]:\n+    # extract hashes/filenames of binaries to verify from hash file;\n+    # each line has the following format: \"<hash> <binary_filename>\"\n+    with open(sums_file_path, 'r', encoding='utf8') as hash_file:\n+        return [line.split()[:2] for line in hash_file if len(filename_filter) == 0 or any(f in line for f in filename_filter)]\n+\n+\n+def verify_binary_hashes(hashes_to_verify: t.List[t.List[str]]) -> t.Tuple[ReturnCode, t.Dict[str, str]]:\n+    offending_files = []\n+    files_to_hashes = {}\n+\n+    for hash_expected, binary_filename in hashes_to_verify:\n+        with open(binary_filename, 'rb') as binary_file:\n+            hash_calculated = sha256(binary_file.read()).hexdigest()\n+        if hash_calculated != hash_expected:\n+            offending_files.append(binary_filename)\n+        else:\n+            files_to_hashes[binary_filename] = hash_calculated\n+\n+    if offending_files:\n+        joined_files = '\\n'.join(offending_files)\n+        log.critical(\n+            \"Hashes don't match.\\n\"\n+            f\"Offending files:\\n{joined_files}\")\n+        return (ReturnCode.INTEGRITY_FAILURE, files_to_hashes)\n+\n+    return (ReturnCode.SUCCESS, files_to_hashes)\n+\n+\n+def verify_published_handler(args: argparse.Namespace) -> ReturnCode:\n+    WORKINGDIR = Path(tempfile.gettempdir()) / f\"bitcoin_verify_binaries.{args.version}\"\n+\n+    def cleanup():\n+        log.info(\"cleaning up files\")\n+        os.chdir(Path.home())\n+        shutil.rmtree(WORKINGDIR)\n \n     # determine remote dir dependent on provided version string\n-    version_base, version_rc, os_filter = parse_version_string(args[0])\n+    try:\n+        version_base, version_rc, os_filter = parse_version_string(args.version)\n+        version_tuple = [int(i) for i in version_base.split('.')]\n+    except Exception as e:\n+        log.debug(e)\n+        log.error(f\"unable to parse version; expected format is {VERSION_FORMAT}\")\n+        log.error(f\"  e.g. {VERSION_EXAMPLE}\")\n+        return ReturnCode.BAD_VERSION\n+\n     remote_dir = f\"/bin/{VERSIONPREFIX}{version_base}/\"\n     if version_rc:\n         remote_dir += f\"test.{version_rc}/\"\n-    remote_sigfile = remote_dir + SIGNATUREFILENAME\n+    remote_sigs_path = remote_dir + SIGNATUREFILENAME\n+    remote_sums_path = remote_dir + SUMS_FILENAME\n \n     # create working directory\n     os.makedirs(WORKINGDIR, exist_ok=True)\n     os.chdir(WORKINGDIR)\n \n-    # fetch first signature file\n-    sigfile1 = SIGNATUREFILENAME\n-    success, output = download_with_wget(HOST1 + remote_sigfile, sigfile1)\n-    if not success:\n-        print(\"Error: couldn't fetch signature file. \"\n-              \"Have you specified the version number in the following format?\")\n-        print(f\"[{VERSIONPREFIX}]<version>[-rc[0-9]][-platform] \"\n-              f\"(example: {VERSIONPREFIX}0.21.0-rc3-osx)\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        return 4\n-\n-    # fetch second signature file\n-    sigfile2 = SIGNATUREFILENAME + \".2\"\n-    success, output = download_with_wget(HOST2 + remote_sigfile, sigfile2)\n-    if not success:\n-        print(\"bitcoin.org failed to provide signature file, \"\n-              \"but bitcoincore.org did?\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1])\n-        return 5\n-\n-    # ensure that both signature files are equal\n-    if not files_are_equal(sigfile1, sigfile2):\n-        print(\"bitcoin.org and bitcoincore.org signature files were not equal?\")\n-        print(f\"See files {WORKINGDIR}/{sigfile1} and {WORKINGDIR}/{sigfile2}\")\n-        return 6\n-\n-    # check signature and extract data into file\n-    retval, output = verify_with_gpg(sigfile1, HASHFILE)\n-    if retval != 0:\n-        if retval == 1:\n-            print(\"Bad signature.\")\n-        elif retval == 2:\n-            print(\"gpg error. Do you have the Bitcoin Core binary release \"\n-                  \"signing key installed?\")\n-        print(\"gpg output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1, sigfile2, HASHFILE])\n-        return 1\n+    hosts = [HOST1, HOST2]\n \n-    # extract hashes/filenames of binaries to verify from hash file;\n-    # each line has the following format: \"<hash> <binary_filename>\"\n-    with open(HASHFILE, 'r', encoding='utf8') as hash_file:\n-        hashes_to_verify = [\n-            line.split()[:2] for line in hash_file if os_filter in line]\n-    remove_files([HASHFILE])\n+    got_sig_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sigs_path, SIGNATUREFILENAME, args.require_all_hosts)\n+    if got_sig_status != ReturnCode.SUCCESS:\n+        return got_sig_status\n+\n+    # Multi-sig verification is available after 22.0.\n+    if version_tuple[0] < 22:\n+        log.error(\"Version too old - single sig not supported. Use a previous \"\n+                  \"version of this script from the repo.\")\n+        return ReturnCode.BAD_VERSION\n+\n+    got_sums_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sums_path, SUMS_FILENAME, args.require_all_hosts)\n+    if got_sums_status != ReturnCode.SUCCESS:\n+        return got_sums_status\n+\n+    # Verify the signature on the SHA256SUMS file\n+    sigs_status, good_trusted, good_untrusted, unknown, bad = verify_shasums_signature(SIGNATUREFILENAME, SUMS_FILENAME, args)\n+    if sigs_status != ReturnCode.SUCCESS:\n+        if sigs_status == ReturnCode.INTEGRITY_FAILURE:\n+            cleanup()\n+        return sigs_status\n+\n+    # Extract hashes and filenames\n+    hashes_to_verify = parse_sums_file(SUMS_FILENAME, os_filter)",
      "path": "contrib/verifybinaries/verify.py",
      "position": null,
      "original_position": 593,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": 1159606675,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "confirmed this does fix the download selection filter",
      "created_at": "2023-04-06T11:20:08Z",
      "updated_at": "2023-04-06T11:20:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1159666836",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159666836"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 514,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159670307",
      "pull_request_review_id": 1374667038,
      "id": 1159670307,
      "node_id": "PRRC_kwDOABII585FHyoj",
      "diff_hunk": "@@ -47,137 +115,598 @@ def parse_version_string(version_str):\n     return version_base, version_rc, version_os\n \n \n-def download_with_wget(remote_file, local_file=None):\n-    if local_file:\n-        wget_args = ['wget', '-O', local_file, remote_file]\n-    else:\n-        # use timestamping mechanism if local filename is not explicitly set\n-        wget_args = ['wget', '-N', remote_file]\n-\n-    result = subprocess.run(wget_args,\n+def download_with_wget(remote_file, local_file):\n+    result = subprocess.run(['wget', '-O', local_file, remote_file],\n                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n     return result.returncode == 0, result.stdout.decode().rstrip()\n \n \n+def download_lines_with_urllib(url) -> t.Tuple[bool, t.List[str]]:\n+    \"\"\"Get (success, text lines of a file) over HTTP.\"\"\"\n+    try:\n+        return (True, [\n+            line.strip().decode() for line in urllib.request.urlopen(url).readlines()])\n+    except urllib.request.HTTPError as e:\n+        log.warning(f\"HTTP request to {url} failed (HTTPError): {e}\")\n+    except Exception as e:\n+        log.warning(f\"HTTP request to {url} failed ({e})\")\n+    return (False, [])\n+\n+\n+def verify_with_gpg(\n+    filename,\n+    signature_filename,\n+    output_filename: t.Optional[str] = None\n+) -> t.Tuple[int, str]:\n+    with tempfile.NamedTemporaryFile() as status_file:\n+        args = [\n+            'gpg', '--yes', '--verify', '--verify-options', 'show-primary-uid-only', \"--status-file\", status_file.name,\n+            '--output', output_filename if output_filename else '', signature_filename, filename]\n+\n+        env = dict(os.environ, LANGUAGE='en')\n+        result = subprocess.run(args, stderr=subprocess.STDOUT, stdout=subprocess.PIPE, env=env)\n+\n+        gpg_data = status_file.read().decode().rstrip()\n+\n+    log.debug(f'Result from GPG ({result.returncode}): {result.stdout.decode()}')\n+    log.debug(f\"{gpg_data}\")\n+    return result.returncode, gpg_data\n+\n+\n+def remove_files(filenames):\n+    for filename in filenames:\n+        os.remove(filename)\n+\n+\n+class SigData:\n+    \"\"\"GPG signature data as parsed from GPG stdout.\"\"\"\n+    def __init__(self):\n+        self.key = None\n+        self.name = \"\"\n+        self.trusted = False\n+        self.status = \"\"\n+\n+    def __bool__(self):\n+        return self.key is not None\n+\n+    def __repr__(self):\n+        return (\n+            \"SigData(%r, %r, trusted=%s, status=%r)\" %\n+            (self.key, self.name, self.trusted, self.status))\n+\n+\n+def parse_gpg_result(\n+    output: t.List[str]\n+) -> t.Tuple[t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    \"\"\"Returns good, unknown, and bad signatures from GPG stdout.\"\"\"\n+    good_sigs: t.List[SigData] = []\n+    unknown_sigs: t.List[SigData] = []\n+    bad_sigs: t.List[SigData] = []\n+    total_resolved_sigs = 0\n+\n+    # Ensure that all lines we match on include a prefix that prevents malicious input\n+    # from fooling the parser.\n+    def line_begins_with(patt: str, line: str) -> t.Optional[re.Match]:\n+        return re.match(r'^(\\[GNUPG:\\])\\s+' + patt, line)\n+\n+    curr_sigs = unknown_sigs\n+    curr_sigdata = SigData()\n+\n+    for line in output:\n+        if line_begins_with(r\"NEWSIG(?:\\s|$)\", line):\n+            total_resolved_sigs += 1\n+            if curr_sigdata:\n+                curr_sigs.append(curr_sigdata)\n+                curr_sigdata = SigData()\n+            newsig_split = line.split()\n+            if len(newsig_split) == 3:\n+                curr_sigdata.name = newsig_split[2]\n+\n+        elif line_begins_with(r\"GOODSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+\n+        elif line_begins_with(r\"EXPKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"expired\"\n+\n+        elif line_begins_with(r\"REVKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"revoked\"\n+\n+        elif line_begins_with(r\"BADSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = bad_sigs\n+\n+        elif line_begins_with(r\"ERRSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, _, _, _, _, _ = line.split()[2:8]\n+            curr_sigs = unknown_sigs\n+\n+        elif line_begins_with(r\"TRUST_(UNDEFINED|NEVER)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = False\n+\n+        elif line_begins_with(r\"TRUST_(MARGINAL|FULLY|ULTIMATE)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = True\n+\n+    # The last one won't have been added, so add it now\n+    assert curr_sigdata\n+    curr_sigs.append(curr_sigdata)\n+\n+    all_found = len(good_sigs + bad_sigs + unknown_sigs)\n+    if all_found != total_resolved_sigs:\n+        raise RuntimeError(\n+            f\"failed to evaluate all signatures: found {all_found} \"\n+            f\"but expected {total_resolved_sigs}\")\n+\n+    return (good_sigs, unknown_sigs, bad_sigs)\n+\n+\n def files_are_equal(filename1, filename2):\n     with open(filename1, 'rb') as file1:\n         contents1 = file1.read()\n     with open(filename2, 'rb') as file2:\n         contents2 = file2.read()\n-    return contents1 == contents2\n+    eq = contents1 == contents2\n \n+    if not eq:\n+        with open(filename1, 'r', encoding='utf-8') as f1, \\\n+                open(filename2, 'r', encoding='utf-8') as f2:\n+            f1lines = f1.readlines()\n+            f2lines = f2.readlines()\n \n-def verify_with_gpg(signature_filename, output_filename):\n-    result = subprocess.run(['gpg', '--yes', '--decrypt', '--output',\n-                             output_filename, signature_filename],\n-                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n-    return result.returncode, result.stdout.decode().rstrip()\n+            diff = indent(\n+                ''.join(difflib.unified_diff(f1lines, f2lines)))\n+            log.warning(f\"found diff in files ({filename1}, {filename2}):\\n{diff}\\n\")\n \n+    return eq\n \n-def remove_files(filenames):\n-    for filename in filenames:\n-        os.remove(filename)\n+\n+def get_files_from_hosts_and_compare(\n+    hosts: t.List[str], path: str, filename: str, require_all: bool = False\n+) -> ReturnCode:\n+    \"\"\"\n+    Retrieve the same file from a number of hosts and ensure they have the same contents.\n+    The first host given will be treated as the \"primary\" host, and is required to succeed.\n+\n+    Args:\n+        filename: for writing the file locally.\n+    \"\"\"\n+    assert len(hosts) > 1\n+    primary_host = hosts[0]\n+    other_hosts = hosts[1:]\n+    got_files = []\n+\n+    def join_url(host: str) -> str:\n+        return host.rstrip('/') + '/' + path.lstrip('/')\n+\n+    url = join_url(primary_host)\n+    success, output = download_with_wget(url, filename)\n+    if not success:\n+        log.error(\n+            f\"couldn't fetch file ({url}). \"\n+            \"Have you specified the version number in the following format?\\n\"\n+            f\"{VERSION_FORMAT} \"\n+            f\"(example: {VERSION_EXAMPLE})\\n\"\n+            f\"wget output:\\n{indent(output)}\")\n+        return ReturnCode.FILE_GET_FAILED\n+    else:\n+        log.info(f\"got file {url} as {filename}\")\n+        got_files.append(filename)\n+\n+    for i, host in enumerate(other_hosts):\n+        url = join_url(host)\n+        fname = filename + f'.{i + 2}'\n+        success, output = download_with_wget(url, fname)\n+\n+        if require_all and not success:\n+            log.error(\n+                f\"{host} failed to provide file ({url}), but {primary_host} did?\\n\"\n+                f\"wget output:\\n{indent(output)}\")\n+            return ReturnCode.FILE_MISSING_FROM_ONE_HOST\n+        elif not success:\n+            log.warning(\n+                f\"{host} failed to provide file ({url}). \"\n+                f\"Continuing based solely upon {primary_host}.\")\n+        else:\n+            log.info(f\"got file {url} as {fname}\")\n+            got_files.append(fname)\n+\n+    for i, got_file in enumerate(got_files):\n+        if got_file == got_files[-1]:\n+            break  # break on last file, nothing after it to compare to\n+\n+        compare_to = got_files[i + 1]\n+        if not files_are_equal(got_file, compare_to):\n+            log.error(f\"files not equal: {got_file} and {compare_to}\")\n+            return ReturnCode.FILES_NOT_EQUAL\n+\n+    return ReturnCode.SUCCESS\n+\n+\n+def check_multisig(sums_file: str, sigfilename: str, args: argparse.Namespace) -> t.Tuple[int, str, t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    # check signature\n+    #\n+    # We don't write output to a file because this command will almost certainly\n+    # fail with GPG exit code '2' (and so not writing to --output) because of the\n+    # likely presence of multiple untrusted signatures.\n+    retval, output = verify_with_gpg(sums_file, sigfilename)\n+\n+    if args.verbose:\n+        log.info(f\"gpg output:\\n{indent(output)}\")\n+\n+    good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    if unknown and args.import_keys:\n+        # Retrieve unknown keys and then try GPG again.\n+        for unsig in unknown:\n+            if prompt_yn(f\" ? Retrieve key {unsig.key} ({unsig.name})? (y/N) \"):\n+                ran = subprocess.run(\n+                    [\"gpg\", \"--keyserver\", args.keyserver, \"--recv-keys\", unsig.key])\n+\n+                if ran.returncode != 0:\n+                    log.warning(f\"failed to retrieve key {unsig.key}\")\n+\n+        # Reparse the GPG output now that we have more keys\n+        retval, output = verify_with_gpg(sums_file, sigfilename)\n+        good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    return retval, output, good, unknown, bad\n \n \n-def main(args):\n-    # sanity check\n-    if len(args) < 1:\n-        print(\"Error: need to specify a version on the command line\")\n-        return 3\n+def prompt_yn(prompt) -> bool:\n+    \"\"\"Return true if the user inputs 'y'.\"\"\"\n+    got = ''\n+    while got not in ['y', 'n']:\n+        got = input(prompt).lower()\n+    return got == 'y'\n+\n+def verify_shasums_signature(\n+    signature_file_path: str, sums_file_path: str, args: argparse.Namespace\n+) -> t.Tuple[\n+   ReturnCode, t.List[SigData], t.List[SigData], t.List[SigData], t.List[SigData]\n+]:\n+    min_good_sigs = args.min_good_sigs\n+    gpg_allowed_codes = [0, 2]  # 2 is returned when untrusted signatures are present.\n+\n+    gpg_retval, gpg_output, good, unknown, bad = check_multisig(sums_file_path, signature_file_path, args)\n+\n+    if gpg_retval not in gpg_allowed_codes:\n+        if gpg_retval == 1:\n+            log.critical(f\"Bad signature (code: {gpg_retval}).\")\n+        else:\n+            log.critical(f\"unexpected GPG exit code ({gpg_retval})\")\n+\n+        log.error(f\"gpg output:\\n{indent(gpg_output)}\")\n+        return (ReturnCode.INTEGRITY_FAILURE, [], [], [], [])\n+\n+    # Decide which keys we trust, though not \"trust\" in the GPG sense, but rather\n+    # which pubkeys convince us that this sums file is legitimate. In other words,\n+    # which pubkeys within the Bitcoin community do we trust for the purposes of\n+    # binary verification?\n+    trusted_keys = set()\n+    if args.trusted_keys:\n+        trusted_keys |= set(args.trusted_keys.split(','))\n+\n+    # Tally signatures and make sure we have enough goods to fulfill\n+    # our threshold.\n+    good_trusted = [sig for sig in good if sig.trusted or sig.key in trusted_keys]\n+    good_untrusted = [sig for sig in good if sig not in good_trusted]\n+    num_trusted = len(good_trusted) + len(good_untrusted)\n+    log.info(f\"got {num_trusted} good signatures\")\n+\n+    if num_trusted < min_good_sigs:\n+        log.info(\"Maybe you need to import \"\n+                  f\"(`gpg --keyserver {args.keyserver} --recv-keys <key-id>`) \"\n+                  \"some of the following keys: \")\n+        log.info('')\n+        for sig in unknown:\n+            log.info(f\"    {sig.key} ({sig.name})\")\n+        log.info('')\n+        log.error(\n+            \"not enough trusted sigs to meet threshold \"\n+            f\"({num_trusted} vs. {min_good_sigs})\")\n+\n+        return (ReturnCode.NOT_ENOUGH_GOOD_SIGS, [], [], [], [])\n+\n+    for sig in good_trusted:\n+        log.info(f\"GOOD SIGNATURE: {sig}\")\n+\n+    for sig in good_untrusted:\n+        log.info(f\"GOOD SIGNATURE (untrusted): {sig}\")\n+\n+    for sig in [sig for sig in good if sig.status == 'expired']:\n+        log.warning(f\"key {sig.key} for {sig.name} is expired\")\n+\n+    for sig in bad:\n+        log.warning(f\"BAD SIGNATURE: {sig}\")\n+\n+    for sig in unknown:\n+        log.warning(f\"UNKNOWN SIGNATURE: {sig}\")\n+\n+    return (ReturnCode.SUCCESS, good_trusted, good_untrusted, unknown, bad)\n+\n+\n+def parse_sums_file(sums_file_path: str, filename_filter: t.List[str]) -> t.List[t.List[str]]:\n+    # extract hashes/filenames of binaries to verify from hash file;\n+    # each line has the following format: \"<hash> <binary_filename>\"\n+    with open(sums_file_path, 'r', encoding='utf8') as hash_file:\n+        return [line.split()[:2] for line in hash_file if len(filename_filter) == 0 or any(f in line for f in filename_filter)]\n+\n+\n+def verify_binary_hashes(hashes_to_verify: t.List[t.List[str]]) -> t.Tuple[ReturnCode, t.Dict[str, str]]:\n+    offending_files = []\n+    files_to_hashes = {}\n+\n+    for hash_expected, binary_filename in hashes_to_verify:\n+        with open(binary_filename, 'rb') as binary_file:\n+            hash_calculated = sha256(binary_file.read()).hexdigest()\n+        if hash_calculated != hash_expected:\n+            offending_files.append(binary_filename)\n+        else:\n+            files_to_hashes[binary_filename] = hash_calculated\n+\n+    if offending_files:\n+        joined_files = '\\n'.join(offending_files)\n+        log.critical(\n+            \"Hashes don't match.\\n\"\n+            f\"Offending files:\\n{joined_files}\")\n+        return (ReturnCode.INTEGRITY_FAILURE, files_to_hashes)\n+\n+    return (ReturnCode.SUCCESS, files_to_hashes)\n+\n+\n+def verify_published_handler(args: argparse.Namespace) -> ReturnCode:\n+    WORKINGDIR = Path(tempfile.gettempdir()) / f\"bitcoin_verify_binaries.{args.version}\"\n+\n+    def cleanup():\n+        log.info(\"cleaning up files\")\n+        os.chdir(Path.home())\n+        shutil.rmtree(WORKINGDIR)\n \n     # determine remote dir dependent on provided version string\n-    version_base, version_rc, os_filter = parse_version_string(args[0])\n+    try:\n+        version_base, version_rc, os_filter = parse_version_string(args.version)\n+        version_tuple = [int(i) for i in version_base.split('.')]\n+    except Exception as e:\n+        log.debug(e)\n+        log.error(f\"unable to parse version; expected format is {VERSION_FORMAT}\")\n+        log.error(f\"  e.g. {VERSION_EXAMPLE}\")\n+        return ReturnCode.BAD_VERSION\n+\n     remote_dir = f\"/bin/{VERSIONPREFIX}{version_base}/\"\n     if version_rc:\n         remote_dir += f\"test.{version_rc}/\"\n-    remote_sigfile = remote_dir + SIGNATUREFILENAME\n+    remote_sigs_path = remote_dir + SIGNATUREFILENAME\n+    remote_sums_path = remote_dir + SUMS_FILENAME\n \n     # create working directory\n     os.makedirs(WORKINGDIR, exist_ok=True)\n     os.chdir(WORKINGDIR)\n \n-    # fetch first signature file\n-    sigfile1 = SIGNATUREFILENAME\n-    success, output = download_with_wget(HOST1 + remote_sigfile, sigfile1)\n-    if not success:\n-        print(\"Error: couldn't fetch signature file. \"\n-              \"Have you specified the version number in the following format?\")\n-        print(f\"[{VERSIONPREFIX}]<version>[-rc[0-9]][-platform] \"\n-              f\"(example: {VERSIONPREFIX}0.21.0-rc3-osx)\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        return 4\n-\n-    # fetch second signature file\n-    sigfile2 = SIGNATUREFILENAME + \".2\"\n-    success, output = download_with_wget(HOST2 + remote_sigfile, sigfile2)\n-    if not success:\n-        print(\"bitcoin.org failed to provide signature file, \"\n-              \"but bitcoincore.org did?\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1])\n-        return 5\n-\n-    # ensure that both signature files are equal\n-    if not files_are_equal(sigfile1, sigfile2):\n-        print(\"bitcoin.org and bitcoincore.org signature files were not equal?\")\n-        print(f\"See files {WORKINGDIR}/{sigfile1} and {WORKINGDIR}/{sigfile2}\")\n-        return 6\n-\n-    # check signature and extract data into file\n-    retval, output = verify_with_gpg(sigfile1, HASHFILE)\n-    if retval != 0:\n-        if retval == 1:\n-            print(\"Bad signature.\")\n-        elif retval == 2:\n-            print(\"gpg error. Do you have the Bitcoin Core binary release \"\n-                  \"signing key installed?\")\n-        print(\"gpg output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1, sigfile2, HASHFILE])\n-        return 1\n+    hosts = [HOST1, HOST2]\n \n-    # extract hashes/filenames of binaries to verify from hash file;\n-    # each line has the following format: \"<hash> <binary_filename>\"\n-    with open(HASHFILE, 'r', encoding='utf8') as hash_file:\n-        hashes_to_verify = [\n-            line.split()[:2] for line in hash_file if os_filter in line]\n-    remove_files([HASHFILE])\n+    got_sig_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sigs_path, SIGNATUREFILENAME, args.require_all_hosts)\n+    if got_sig_status != ReturnCode.SUCCESS:\n+        return got_sig_status\n+\n+    # Multi-sig verification is available after 22.0.\n+    if version_tuple[0] < 22:\n+        log.error(\"Version too old - single sig not supported. Use a previous \"\n+                  \"version of this script from the repo.\")\n+        return ReturnCode.BAD_VERSION\n+\n+    got_sums_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sums_path, SUMS_FILENAME, args.require_all_hosts)\n+    if got_sums_status != ReturnCode.SUCCESS:\n+        return got_sums_status\n+\n+    # Verify the signature on the SHA256SUMS file\n+    sigs_status, good_trusted, good_untrusted, unknown, bad = verify_shasums_signature(SIGNATUREFILENAME, SUMS_FILENAME, args)\n+    if sigs_status != ReturnCode.SUCCESS:\n+        if sigs_status == ReturnCode.INTEGRITY_FAILURE:\n+            cleanup()\n+        return sigs_status\n+\n+    # Extract hashes and filenames\n+    hashes_to_verify = parse_sums_file(SUMS_FILENAME, os_filter)\n     if not hashes_to_verify:\n-        print(\"error: no files matched the platform specified\")\n-        return 7\n+        log.error(\"no files matched the platform specified\")\n+        return ReturnCode.NO_BINARIES_MATCH\n+\n+    # remove binaries that are known not to be hosted by bitcoincore.org\n+    fragments_to_remove = ['-unsigned', '-debug', '-codesignatures']\n+    for fragment in fragments_to_remove:\n+        nobinaries = [i for i in hashes_to_verify if fragment in i[1]]\n+        if nobinaries:\n+            remove_str = ', '.join(i[1] for i in nobinaries)\n+            log.info(\n+                f\"removing *{fragment} binaries ({remove_str}) from verification \"\n+                f\"since {HOST1} does not host *{fragment} binaries\")\n+            hashes_to_verify = [i for i in hashes_to_verify if fragment not in i[1]]\n \n     # download binaries\n     for _, binary_filename in hashes_to_verify:\n-        print(f\"Downloading {binary_filename}\")\n-        download_with_wget(HOST1 + remote_dir + binary_filename)\n+        log.info(f\"downloading {binary_filename}\")",
      "path": "contrib/verifybinaries/verify.py",
      "position": 616,
      "original_position": 615,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": null,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: it would be nice to have it also print out the destination, e.g \"downloading {binary_filename} to {destination}\"",
      "created_at": "2023-04-06T11:24:10Z",
      "updated_at": "2023-04-06T11:24:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1159670307",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1159670307"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 533,
      "original_line": 533,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1160166441",
      "pull_request_review_id": 1375436955,
      "id": 1160166441,
      "node_id": "PRRC_kwDOABII585FJrwp",
      "diff_hunk": "@@ -47,137 +115,598 @@ def parse_version_string(version_str):\n     return version_base, version_rc, version_os\n \n \n-def download_with_wget(remote_file, local_file=None):\n-    if local_file:\n-        wget_args = ['wget', '-O', local_file, remote_file]\n-    else:\n-        # use timestamping mechanism if local filename is not explicitly set\n-        wget_args = ['wget', '-N', remote_file]\n-\n-    result = subprocess.run(wget_args,\n+def download_with_wget(remote_file, local_file):\n+    result = subprocess.run(['wget', '-O', local_file, remote_file],\n                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n     return result.returncode == 0, result.stdout.decode().rstrip()\n \n \n+def download_lines_with_urllib(url) -> t.Tuple[bool, t.List[str]]:\n+    \"\"\"Get (success, text lines of a file) over HTTP.\"\"\"\n+    try:\n+        return (True, [\n+            line.strip().decode() for line in urllib.request.urlopen(url).readlines()])\n+    except urllib.request.HTTPError as e:\n+        log.warning(f\"HTTP request to {url} failed (HTTPError): {e}\")\n+    except Exception as e:\n+        log.warning(f\"HTTP request to {url} failed ({e})\")\n+    return (False, [])\n+\n+\n+def verify_with_gpg(\n+    filename,\n+    signature_filename,\n+    output_filename: t.Optional[str] = None\n+) -> t.Tuple[int, str]:\n+    with tempfile.NamedTemporaryFile() as status_file:\n+        args = [\n+            'gpg', '--yes', '--verify', '--verify-options', 'show-primary-uid-only', \"--status-file\", status_file.name,\n+            '--output', output_filename if output_filename else '', signature_filename, filename]\n+\n+        env = dict(os.environ, LANGUAGE='en')\n+        result = subprocess.run(args, stderr=subprocess.STDOUT, stdout=subprocess.PIPE, env=env)\n+\n+        gpg_data = status_file.read().decode().rstrip()\n+\n+    log.debug(f'Result from GPG ({result.returncode}): {result.stdout.decode()}')\n+    log.debug(f\"{gpg_data}\")\n+    return result.returncode, gpg_data\n+\n+\n+def remove_files(filenames):\n+    for filename in filenames:\n+        os.remove(filename)\n+\n+\n+class SigData:\n+    \"\"\"GPG signature data as parsed from GPG stdout.\"\"\"\n+    def __init__(self):\n+        self.key = None\n+        self.name = \"\"\n+        self.trusted = False\n+        self.status = \"\"\n+\n+    def __bool__(self):\n+        return self.key is not None\n+\n+    def __repr__(self):\n+        return (\n+            \"SigData(%r, %r, trusted=%s, status=%r)\" %\n+            (self.key, self.name, self.trusted, self.status))\n+\n+\n+def parse_gpg_result(\n+    output: t.List[str]\n+) -> t.Tuple[t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    \"\"\"Returns good, unknown, and bad signatures from GPG stdout.\"\"\"\n+    good_sigs: t.List[SigData] = []\n+    unknown_sigs: t.List[SigData] = []\n+    bad_sigs: t.List[SigData] = []\n+    total_resolved_sigs = 0\n+\n+    # Ensure that all lines we match on include a prefix that prevents malicious input\n+    # from fooling the parser.\n+    def line_begins_with(patt: str, line: str) -> t.Optional[re.Match]:\n+        return re.match(r'^(\\[GNUPG:\\])\\s+' + patt, line)\n+\n+    curr_sigs = unknown_sigs\n+    curr_sigdata = SigData()\n+\n+    for line in output:\n+        if line_begins_with(r\"NEWSIG(?:\\s|$)\", line):\n+            total_resolved_sigs += 1\n+            if curr_sigdata:\n+                curr_sigs.append(curr_sigdata)\n+                curr_sigdata = SigData()\n+            newsig_split = line.split()\n+            if len(newsig_split) == 3:\n+                curr_sigdata.name = newsig_split[2]\n+\n+        elif line_begins_with(r\"GOODSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+\n+        elif line_begins_with(r\"EXPKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"expired\"\n+\n+        elif line_begins_with(r\"REVKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"revoked\"\n+\n+        elif line_begins_with(r\"BADSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = bad_sigs\n+\n+        elif line_begins_with(r\"ERRSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, _, _, _, _, _ = line.split()[2:8]\n+            curr_sigs = unknown_sigs\n+\n+        elif line_begins_with(r\"TRUST_(UNDEFINED|NEVER)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = False\n+\n+        elif line_begins_with(r\"TRUST_(MARGINAL|FULLY|ULTIMATE)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = True\n+\n+    # The last one won't have been added, so add it now\n+    assert curr_sigdata\n+    curr_sigs.append(curr_sigdata)\n+\n+    all_found = len(good_sigs + bad_sigs + unknown_sigs)\n+    if all_found != total_resolved_sigs:\n+        raise RuntimeError(\n+            f\"failed to evaluate all signatures: found {all_found} \"\n+            f\"but expected {total_resolved_sigs}\")\n+\n+    return (good_sigs, unknown_sigs, bad_sigs)\n+\n+\n def files_are_equal(filename1, filename2):\n     with open(filename1, 'rb') as file1:\n         contents1 = file1.read()\n     with open(filename2, 'rb') as file2:\n         contents2 = file2.read()\n-    return contents1 == contents2\n+    eq = contents1 == contents2\n \n+    if not eq:\n+        with open(filename1, 'r', encoding='utf-8') as f1, \\\n+                open(filename2, 'r', encoding='utf-8') as f2:\n+            f1lines = f1.readlines()\n+            f2lines = f2.readlines()\n \n-def verify_with_gpg(signature_filename, output_filename):\n-    result = subprocess.run(['gpg', '--yes', '--decrypt', '--output',\n-                             output_filename, signature_filename],\n-                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n-    return result.returncode, result.stdout.decode().rstrip()\n+            diff = indent(\n+                ''.join(difflib.unified_diff(f1lines, f2lines)))\n+            log.warning(f\"found diff in files ({filename1}, {filename2}):\\n{diff}\\n\")\n \n+    return eq\n \n-def remove_files(filenames):\n-    for filename in filenames:\n-        os.remove(filename)\n+\n+def get_files_from_hosts_and_compare(\n+    hosts: t.List[str], path: str, filename: str, require_all: bool = False\n+) -> ReturnCode:\n+    \"\"\"\n+    Retrieve the same file from a number of hosts and ensure they have the same contents.\n+    The first host given will be treated as the \"primary\" host, and is required to succeed.\n+\n+    Args:\n+        filename: for writing the file locally.\n+    \"\"\"\n+    assert len(hosts) > 1\n+    primary_host = hosts[0]\n+    other_hosts = hosts[1:]\n+    got_files = []\n+\n+    def join_url(host: str) -> str:\n+        return host.rstrip('/') + '/' + path.lstrip('/')\n+\n+    url = join_url(primary_host)\n+    success, output = download_with_wget(url, filename)\n+    if not success:\n+        log.error(\n+            f\"couldn't fetch file ({url}). \"\n+            \"Have you specified the version number in the following format?\\n\"\n+            f\"{VERSION_FORMAT} \"\n+            f\"(example: {VERSION_EXAMPLE})\\n\"\n+            f\"wget output:\\n{indent(output)}\")\n+        return ReturnCode.FILE_GET_FAILED\n+    else:\n+        log.info(f\"got file {url} as {filename}\")\n+        got_files.append(filename)\n+\n+    for i, host in enumerate(other_hosts):\n+        url = join_url(host)\n+        fname = filename + f'.{i + 2}'\n+        success, output = download_with_wget(url, fname)\n+\n+        if require_all and not success:\n+            log.error(\n+                f\"{host} failed to provide file ({url}), but {primary_host} did?\\n\"\n+                f\"wget output:\\n{indent(output)}\")\n+            return ReturnCode.FILE_MISSING_FROM_ONE_HOST\n+        elif not success:\n+            log.warning(\n+                f\"{host} failed to provide file ({url}). \"\n+                f\"Continuing based solely upon {primary_host}.\")\n+        else:\n+            log.info(f\"got file {url} as {fname}\")\n+            got_files.append(fname)\n+\n+    for i, got_file in enumerate(got_files):\n+        if got_file == got_files[-1]:\n+            break  # break on last file, nothing after it to compare to\n+\n+        compare_to = got_files[i + 1]\n+        if not files_are_equal(got_file, compare_to):\n+            log.error(f\"files not equal: {got_file} and {compare_to}\")\n+            return ReturnCode.FILES_NOT_EQUAL\n+\n+    return ReturnCode.SUCCESS\n+\n+\n+def check_multisig(sums_file: str, sigfilename: str, args: argparse.Namespace) -> t.Tuple[int, str, t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    # check signature\n+    #\n+    # We don't write output to a file because this command will almost certainly\n+    # fail with GPG exit code '2' (and so not writing to --output) because of the\n+    # likely presence of multiple untrusted signatures.\n+    retval, output = verify_with_gpg(sums_file, sigfilename)\n+\n+    if args.verbose:\n+        log.info(f\"gpg output:\\n{indent(output)}\")\n+\n+    good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    if unknown and args.import_keys:\n+        # Retrieve unknown keys and then try GPG again.\n+        for unsig in unknown:\n+            if prompt_yn(f\" ? Retrieve key {unsig.key} ({unsig.name})? (y/N) \"):\n+                ran = subprocess.run(\n+                    [\"gpg\", \"--keyserver\", args.keyserver, \"--recv-keys\", unsig.key])\n+\n+                if ran.returncode != 0:\n+                    log.warning(f\"failed to retrieve key {unsig.key}\")\n+\n+        # Reparse the GPG output now that we have more keys\n+        retval, output = verify_with_gpg(sums_file, sigfilename)\n+        good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    return retval, output, good, unknown, bad\n \n \n-def main(args):\n-    # sanity check\n-    if len(args) < 1:\n-        print(\"Error: need to specify a version on the command line\")\n-        return 3\n+def prompt_yn(prompt) -> bool:\n+    \"\"\"Return true if the user inputs 'y'.\"\"\"\n+    got = ''\n+    while got not in ['y', 'n']:\n+        got = input(prompt).lower()\n+    return got == 'y'\n+\n+def verify_shasums_signature(\n+    signature_file_path: str, sums_file_path: str, args: argparse.Namespace\n+) -> t.Tuple[\n+   ReturnCode, t.List[SigData], t.List[SigData], t.List[SigData], t.List[SigData]\n+]:\n+    min_good_sigs = args.min_good_sigs\n+    gpg_allowed_codes = [0, 2]  # 2 is returned when untrusted signatures are present.\n+\n+    gpg_retval, gpg_output, good, unknown, bad = check_multisig(sums_file_path, signature_file_path, args)\n+\n+    if gpg_retval not in gpg_allowed_codes:\n+        if gpg_retval == 1:\n+            log.critical(f\"Bad signature (code: {gpg_retval}).\")\n+        else:\n+            log.critical(f\"unexpected GPG exit code ({gpg_retval})\")\n+\n+        log.error(f\"gpg output:\\n{indent(gpg_output)}\")\n+        return (ReturnCode.INTEGRITY_FAILURE, [], [], [], [])\n+\n+    # Decide which keys we trust, though not \"trust\" in the GPG sense, but rather\n+    # which pubkeys convince us that this sums file is legitimate. In other words,\n+    # which pubkeys within the Bitcoin community do we trust for the purposes of\n+    # binary verification?\n+    trusted_keys = set()\n+    if args.trusted_keys:\n+        trusted_keys |= set(args.trusted_keys.split(','))\n+\n+    # Tally signatures and make sure we have enough goods to fulfill\n+    # our threshold.\n+    good_trusted = [sig for sig in good if sig.trusted or sig.key in trusted_keys]\n+    good_untrusted = [sig for sig in good if sig not in good_trusted]\n+    num_trusted = len(good_trusted) + len(good_untrusted)\n+    log.info(f\"got {num_trusted} good signatures\")\n+\n+    if num_trusted < min_good_sigs:\n+        log.info(\"Maybe you need to import \"\n+                  f\"(`gpg --keyserver {args.keyserver} --recv-keys <key-id>`) \"\n+                  \"some of the following keys: \")\n+        log.info('')\n+        for sig in unknown:\n+            log.info(f\"    {sig.key} ({sig.name})\")\n+        log.info('')\n+        log.error(\n+            \"not enough trusted sigs to meet threshold \"\n+            f\"({num_trusted} vs. {min_good_sigs})\")\n+\n+        return (ReturnCode.NOT_ENOUGH_GOOD_SIGS, [], [], [], [])\n+\n+    for sig in good_trusted:\n+        log.info(f\"GOOD SIGNATURE: {sig}\")\n+\n+    for sig in good_untrusted:\n+        log.info(f\"GOOD SIGNATURE (untrusted): {sig}\")\n+\n+    for sig in [sig for sig in good if sig.status == 'expired']:\n+        log.warning(f\"key {sig.key} for {sig.name} is expired\")\n+\n+    for sig in bad:\n+        log.warning(f\"BAD SIGNATURE: {sig}\")\n+\n+    for sig in unknown:\n+        log.warning(f\"UNKNOWN SIGNATURE: {sig}\")\n+\n+    return (ReturnCode.SUCCESS, good_trusted, good_untrusted, unknown, bad)\n+\n+\n+def parse_sums_file(sums_file_path: str, filename_filter: t.List[str]) -> t.List[t.List[str]]:\n+    # extract hashes/filenames of binaries to verify from hash file;\n+    # each line has the following format: \"<hash> <binary_filename>\"\n+    with open(sums_file_path, 'r', encoding='utf8') as hash_file:\n+        return [line.split()[:2] for line in hash_file if len(filename_filter) == 0 or any(f in line for f in filename_filter)]\n+\n+\n+def verify_binary_hashes(hashes_to_verify: t.List[t.List[str]]) -> t.Tuple[ReturnCode, t.Dict[str, str]]:\n+    offending_files = []\n+    files_to_hashes = {}\n+\n+    for hash_expected, binary_filename in hashes_to_verify:\n+        with open(binary_filename, 'rb') as binary_file:\n+            hash_calculated = sha256(binary_file.read()).hexdigest()\n+        if hash_calculated != hash_expected:\n+            offending_files.append(binary_filename)\n+        else:\n+            files_to_hashes[binary_filename] = hash_calculated\n+\n+    if offending_files:\n+        joined_files = '\\n'.join(offending_files)\n+        log.critical(\n+            \"Hashes don't match.\\n\"\n+            f\"Offending files:\\n{joined_files}\")\n+        return (ReturnCode.INTEGRITY_FAILURE, files_to_hashes)\n+\n+    return (ReturnCode.SUCCESS, files_to_hashes)\n+\n+\n+def verify_published_handler(args: argparse.Namespace) -> ReturnCode:\n+    WORKINGDIR = Path(tempfile.gettempdir()) / f\"bitcoin_verify_binaries.{args.version}\"\n+\n+    def cleanup():\n+        log.info(\"cleaning up files\")\n+        os.chdir(Path.home())\n+        shutil.rmtree(WORKINGDIR)\n \n     # determine remote dir dependent on provided version string\n-    version_base, version_rc, os_filter = parse_version_string(args[0])\n+    try:\n+        version_base, version_rc, os_filter = parse_version_string(args.version)\n+        version_tuple = [int(i) for i in version_base.split('.')]\n+    except Exception as e:\n+        log.debug(e)\n+        log.error(f\"unable to parse version; expected format is {VERSION_FORMAT}\")\n+        log.error(f\"  e.g. {VERSION_EXAMPLE}\")\n+        return ReturnCode.BAD_VERSION\n+\n     remote_dir = f\"/bin/{VERSIONPREFIX}{version_base}/\"\n     if version_rc:\n         remote_dir += f\"test.{version_rc}/\"\n-    remote_sigfile = remote_dir + SIGNATUREFILENAME\n+    remote_sigs_path = remote_dir + SIGNATUREFILENAME\n+    remote_sums_path = remote_dir + SUMS_FILENAME\n \n     # create working directory\n     os.makedirs(WORKINGDIR, exist_ok=True)\n     os.chdir(WORKINGDIR)\n \n-    # fetch first signature file\n-    sigfile1 = SIGNATUREFILENAME\n-    success, output = download_with_wget(HOST1 + remote_sigfile, sigfile1)\n-    if not success:\n-        print(\"Error: couldn't fetch signature file. \"\n-              \"Have you specified the version number in the following format?\")\n-        print(f\"[{VERSIONPREFIX}]<version>[-rc[0-9]][-platform] \"\n-              f\"(example: {VERSIONPREFIX}0.21.0-rc3-osx)\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        return 4\n-\n-    # fetch second signature file\n-    sigfile2 = SIGNATUREFILENAME + \".2\"\n-    success, output = download_with_wget(HOST2 + remote_sigfile, sigfile2)\n-    if not success:\n-        print(\"bitcoin.org failed to provide signature file, \"\n-              \"but bitcoincore.org did?\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1])\n-        return 5\n-\n-    # ensure that both signature files are equal\n-    if not files_are_equal(sigfile1, sigfile2):\n-        print(\"bitcoin.org and bitcoincore.org signature files were not equal?\")\n-        print(f\"See files {WORKINGDIR}/{sigfile1} and {WORKINGDIR}/{sigfile2}\")\n-        return 6\n-\n-    # check signature and extract data into file\n-    retval, output = verify_with_gpg(sigfile1, HASHFILE)\n-    if retval != 0:\n-        if retval == 1:\n-            print(\"Bad signature.\")\n-        elif retval == 2:\n-            print(\"gpg error. Do you have the Bitcoin Core binary release \"\n-                  \"signing key installed?\")\n-        print(\"gpg output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1, sigfile2, HASHFILE])\n-        return 1\n+    hosts = [HOST1, HOST2]\n \n-    # extract hashes/filenames of binaries to verify from hash file;\n-    # each line has the following format: \"<hash> <binary_filename>\"\n-    with open(HASHFILE, 'r', encoding='utf8') as hash_file:\n-        hashes_to_verify = [\n-            line.split()[:2] for line in hash_file if os_filter in line]\n-    remove_files([HASHFILE])\n+    got_sig_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sigs_path, SIGNATUREFILENAME, args.require_all_hosts)\n+    if got_sig_status != ReturnCode.SUCCESS:\n+        return got_sig_status\n+\n+    # Multi-sig verification is available after 22.0.\n+    if version_tuple[0] < 22:\n+        log.error(\"Version too old - single sig not supported. Use a previous \"\n+                  \"version of this script from the repo.\")\n+        return ReturnCode.BAD_VERSION\n+\n+    got_sums_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sums_path, SUMS_FILENAME, args.require_all_hosts)\n+    if got_sums_status != ReturnCode.SUCCESS:\n+        return got_sums_status\n+\n+    # Verify the signature on the SHA256SUMS file\n+    sigs_status, good_trusted, good_untrusted, unknown, bad = verify_shasums_signature(SIGNATUREFILENAME, SUMS_FILENAME, args)\n+    if sigs_status != ReturnCode.SUCCESS:\n+        if sigs_status == ReturnCode.INTEGRITY_FAILURE:\n+            cleanup()\n+        return sigs_status\n+\n+    # Extract hashes and filenames\n+    hashes_to_verify = parse_sums_file(SUMS_FILENAME, os_filter)",
      "path": "contrib/verifybinaries/verify.py",
      "position": null,
      "original_position": 593,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": 1159606675,
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks!",
      "created_at": "2023-04-06T19:17:42Z",
      "updated_at": "2023-04-06T19:17:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1160166441",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1160166441"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 514,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1160167278",
      "pull_request_review_id": 1375438018,
      "id": 1160167278,
      "node_id": "PRRC_kwDOABII585FJr9u",
      "diff_hunk": "@@ -1,30 +1,88 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n ```sh\n-./verify.py bitcoin-core-0.11.2\n-./verify.py bitcoin-core-0.12.0\n-./verify.py bitcoin-core-0.13.0-rc3\n+./contrib/verifybinaries/verify.py pub 22.0\n+./contrib/verifybinaries/verify.py pub 22.0-rc2\n+```\n+\n+Get JSON output and don't prompt for user input (no auto key import):\n+\n+```sh\n+./contrib/verifybinaries/verify.py pub 22.0-x86 --json",
      "path": "contrib/verifybinaries/README.md",
      "position": null,
      "original_position": 59,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": 1159499828,
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks. I'll squashed this into another commit.",
      "created_at": "2023-04-06T19:18:33Z",
      "updated_at": "2023-04-06T19:18:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1160167278",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1160167278"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1160211457",
      "pull_request_review_id": 1375504488,
      "id": 1160211457,
      "node_id": "PRRC_kwDOABII585FJ2wB",
      "diff_hunk": "@@ -0,0 +1,59 @@\n+#!/usr/bin/env python3",
      "path": "contrib/verifybinaries/test.py",
      "position": 1,
      "original_position": 1,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "7a6e7ffd066a42c5fbb7d69effbe074fb982936b",
      "in_reply_to_id": 1151491320,
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Makes sense to me but I'd rather keep the changes down in this PR. Let's do as a follow-up?",
      "created_at": "2023-04-06T20:14:39Z",
      "updated_at": "2023-04-06T20:14:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1160211457",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1160211457"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1161264962",
      "pull_request_review_id": 1376891891,
      "id": 1161264962,
      "node_id": "PRRC_kwDOABII585FN39C",
      "diff_hunk": "@@ -1,30 +1,88 @@\n ### Verify Binaries\n \n-#### Usage:\n+#### Preparation\n \n-This script attempts to download the signature file `SHA256SUMS.asc` from https://bitcoin.org.\n+As of Bitcoin Core v22.0, releases are signed by a number of public keys on the basis\n+of the [guix.sigs repository](https://github.com/bitcoin-core/guix.sigs/). When\n+verifying binary downloads, you (the end user) decide which of these public keys you\n+trust and then use that trust model to evaluate the signature on a file that contains\n+hashes of the release binaries. The downloaded binaries are then hashed and compared to\n+the signed checksum file.\n \n-It first checks if the signature passes, and then downloads the files specified in the file, and checks if the hashes of these files match those that are specified in the signature file.\n+First, you have to figure out which public keys to recognize. Browse the [list of frequent\n+builder-keys](https://github.com/bitcoin-core/guix.sigs/tree/main/builder-keys) and\n+decide which of these keys you would like to trust. For each key you want to trust, you\n+must obtain that key for your local GPG installation.\n \n-The script returns 0 if everything passes the checks. It returns 1 if either the signature check or the hash check doesn't pass. If an error occurs the return value is 2.\n+You can obtain these keys by\n+  - through a browser using a key server (e.g. keyserver.ubuntu.com),\n+  - manually using the `gpg --keyserver <url> --recv-keys <key>` command, or\n+  - you can run the packaged `verifybinaries.py ... --import-keys` script to\n+    have it automatically retrieve unrecognized keys.\n \n+#### Usage\n \n+This script attempts to download the checksum file (`SHA256SUMS`) and corresponding\n+signature file `SHA256SUMS.asc` from https://bitcoincore.org and https://bitcoin.org.\n+\n+It first checks if the checksum file is valid based upon a plurality of signatures, and\n+then downloads the release files specified in the checksum file, and checks if the\n+hashes of the release files are as expected.\n+\n+If we encounter pubkeys in the signature file that we do not recognize, the script\n+can prompt the user as to whether they'd like to download the pubkeys. To enable\n+this behavior, use the `--import-keys` flag.\n+\n+The script returns 0 if everything passes the checks. It returns 1 if either the\n+signature check or the hash check doesn't pass. An exit code of >2 indicates an error.\n+\n+See the `Config` object for various options.\n+\n+#### Examples\n+\n+Validate releases with default settings:\n ```sh\n-./verify.py bitcoin-core-0.11.2\n-./verify.py bitcoin-core-0.12.0\n-./verify.py bitcoin-core-0.13.0-rc3\n+./contrib/verifybinaries/verify.py pub 22.0\n+./contrib/verifybinaries/verify.py pub 22.0-rc2\n+```\n+\n+Get JSON output and don't prompt for user input (no auto key import):\n+\n+```sh\n+./contrib/verifybinaries/verify.py pub 22.0-x86 --json\n+```\n+\n+Rely only on local GPG state and manually specified keys, while requiring a\n+threshold of at least 10 trusted signatures:\n+```sh\n+./contrib/verifybinaries/verify.py \\\n+    --trusted-keys 74E2DEF5D77260B98BC19438099BAD163C70FBFA,9D3CC86A72F8494342EA5FD10A41BDC3F4FAFF1C \\\n+    --min-good-sigs 10 pub 22.0-x86\n ```\n \n If you only want to download the binaries of certain platform, add the corresponding suffix, e.g.:",
      "path": "contrib/verifybinaries/README.md",
      "position": 70,
      "original_position": 70,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": 1159536722,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "See 27440.",
      "created_at": "2023-04-09T10:50:27Z",
      "updated_at": "2023-04-09T10:50:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1161264962",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1161264962"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 63,
      "original_line": 63,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1161264975",
      "pull_request_review_id": 1376891914,
      "id": 1161264975,
      "node_id": "PRRC_kwDOABII585FN39P",
      "diff_hunk": "@@ -0,0 +1,59 @@\n+#!/usr/bin/env python3\n+\n+import json\n+import sys\n+import subprocess\n+from pathlib import Path\n+\n+\n+def main():\n+    \"\"\"Tests ordered roughly from faster to slower.\"\"\"\n+    expect_code(run_verify(\"\", \"pub\", '0.32'), 4, \"Nonexistent version should fail\")\n+    expect_code(run_verify(\"\", \"pub\", '0.32.awefa.12f9h'), 11, \"Malformed version should fail\")\n+    expect_code(run_verify('--min-good-sigs 20', \"pub\", \"22.0\"), 9, \"--min-good-sigs 20 should fail\")\n+\n+    print(\"- testing multisig verification (22.0)\", flush=True)",
      "path": "contrib/verifybinaries/test.py",
      "position": 15,
      "original_position": 15,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": 1159541958,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done in 27440",
      "created_at": "2023-04-09T10:50:36Z",
      "updated_at": "2023-04-09T10:50:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1161264975",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1161264975"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 15,
      "original_line": 15,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1161264990",
      "pull_request_review_id": 1376891928,
      "id": 1161264990,
      "node_id": "PRRC_kwDOABII585FN39e",
      "diff_hunk": "@@ -47,137 +115,598 @@ def parse_version_string(version_str):\n     return version_base, version_rc, version_os\n \n \n-def download_with_wget(remote_file, local_file=None):\n-    if local_file:\n-        wget_args = ['wget', '-O', local_file, remote_file]\n-    else:\n-        # use timestamping mechanism if local filename is not explicitly set\n-        wget_args = ['wget', '-N', remote_file]\n-\n-    result = subprocess.run(wget_args,\n+def download_with_wget(remote_file, local_file):\n+    result = subprocess.run(['wget', '-O', local_file, remote_file],\n                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n     return result.returncode == 0, result.stdout.decode().rstrip()\n \n \n+def download_lines_with_urllib(url) -> t.Tuple[bool, t.List[str]]:\n+    \"\"\"Get (success, text lines of a file) over HTTP.\"\"\"\n+    try:\n+        return (True, [\n+            line.strip().decode() for line in urllib.request.urlopen(url).readlines()])\n+    except urllib.request.HTTPError as e:\n+        log.warning(f\"HTTP request to {url} failed (HTTPError): {e}\")\n+    except Exception as e:\n+        log.warning(f\"HTTP request to {url} failed ({e})\")\n+    return (False, [])\n+\n+\n+def verify_with_gpg(\n+    filename,\n+    signature_filename,\n+    output_filename: t.Optional[str] = None\n+) -> t.Tuple[int, str]:\n+    with tempfile.NamedTemporaryFile() as status_file:\n+        args = [\n+            'gpg', '--yes', '--verify', '--verify-options', 'show-primary-uid-only', \"--status-file\", status_file.name,\n+            '--output', output_filename if output_filename else '', signature_filename, filename]\n+\n+        env = dict(os.environ, LANGUAGE='en')\n+        result = subprocess.run(args, stderr=subprocess.STDOUT, stdout=subprocess.PIPE, env=env)\n+\n+        gpg_data = status_file.read().decode().rstrip()\n+\n+    log.debug(f'Result from GPG ({result.returncode}): {result.stdout.decode()}')\n+    log.debug(f\"{gpg_data}\")\n+    return result.returncode, gpg_data\n+\n+\n+def remove_files(filenames):\n+    for filename in filenames:\n+        os.remove(filename)\n+\n+\n+class SigData:\n+    \"\"\"GPG signature data as parsed from GPG stdout.\"\"\"\n+    def __init__(self):\n+        self.key = None\n+        self.name = \"\"\n+        self.trusted = False\n+        self.status = \"\"\n+\n+    def __bool__(self):\n+        return self.key is not None\n+\n+    def __repr__(self):\n+        return (\n+            \"SigData(%r, %r, trusted=%s, status=%r)\" %\n+            (self.key, self.name, self.trusted, self.status))\n+\n+\n+def parse_gpg_result(\n+    output: t.List[str]\n+) -> t.Tuple[t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    \"\"\"Returns good, unknown, and bad signatures from GPG stdout.\"\"\"\n+    good_sigs: t.List[SigData] = []\n+    unknown_sigs: t.List[SigData] = []\n+    bad_sigs: t.List[SigData] = []\n+    total_resolved_sigs = 0\n+\n+    # Ensure that all lines we match on include a prefix that prevents malicious input\n+    # from fooling the parser.\n+    def line_begins_with(patt: str, line: str) -> t.Optional[re.Match]:\n+        return re.match(r'^(\\[GNUPG:\\])\\s+' + patt, line)\n+\n+    curr_sigs = unknown_sigs\n+    curr_sigdata = SigData()\n+\n+    for line in output:\n+        if line_begins_with(r\"NEWSIG(?:\\s|$)\", line):\n+            total_resolved_sigs += 1\n+            if curr_sigdata:\n+                curr_sigs.append(curr_sigdata)\n+                curr_sigdata = SigData()\n+            newsig_split = line.split()\n+            if len(newsig_split) == 3:\n+                curr_sigdata.name = newsig_split[2]\n+\n+        elif line_begins_with(r\"GOODSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+\n+        elif line_begins_with(r\"EXPKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"expired\"\n+\n+        elif line_begins_with(r\"REVKEYSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = good_sigs\n+            curr_sigdata.status = \"revoked\"\n+\n+        elif line_begins_with(r\"BADSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, curr_sigdata.name = line.split(maxsplit=3)[2:4]\n+            curr_sigs = bad_sigs\n+\n+        elif line_begins_with(r\"ERRSIG(?:\\s|$)\", line):\n+            curr_sigdata.key, _, _, _, _, _ = line.split()[2:8]\n+            curr_sigs = unknown_sigs\n+\n+        elif line_begins_with(r\"TRUST_(UNDEFINED|NEVER)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = False\n+\n+        elif line_begins_with(r\"TRUST_(MARGINAL|FULLY|ULTIMATE)(?:\\s|$)\", line):\n+            curr_sigdata.trusted = True\n+\n+    # The last one won't have been added, so add it now\n+    assert curr_sigdata\n+    curr_sigs.append(curr_sigdata)\n+\n+    all_found = len(good_sigs + bad_sigs + unknown_sigs)\n+    if all_found != total_resolved_sigs:\n+        raise RuntimeError(\n+            f\"failed to evaluate all signatures: found {all_found} \"\n+            f\"but expected {total_resolved_sigs}\")\n+\n+    return (good_sigs, unknown_sigs, bad_sigs)\n+\n+\n def files_are_equal(filename1, filename2):\n     with open(filename1, 'rb') as file1:\n         contents1 = file1.read()\n     with open(filename2, 'rb') as file2:\n         contents2 = file2.read()\n-    return contents1 == contents2\n+    eq = contents1 == contents2\n \n+    if not eq:\n+        with open(filename1, 'r', encoding='utf-8') as f1, \\\n+                open(filename2, 'r', encoding='utf-8') as f2:\n+            f1lines = f1.readlines()\n+            f2lines = f2.readlines()\n \n-def verify_with_gpg(signature_filename, output_filename):\n-    result = subprocess.run(['gpg', '--yes', '--decrypt', '--output',\n-                             output_filename, signature_filename],\n-                             stderr=subprocess.STDOUT, stdout=subprocess.PIPE)\n-    return result.returncode, result.stdout.decode().rstrip()\n+            diff = indent(\n+                ''.join(difflib.unified_diff(f1lines, f2lines)))\n+            log.warning(f\"found diff in files ({filename1}, {filename2}):\\n{diff}\\n\")\n \n+    return eq\n \n-def remove_files(filenames):\n-    for filename in filenames:\n-        os.remove(filename)\n+\n+def get_files_from_hosts_and_compare(\n+    hosts: t.List[str], path: str, filename: str, require_all: bool = False\n+) -> ReturnCode:\n+    \"\"\"\n+    Retrieve the same file from a number of hosts and ensure they have the same contents.\n+    The first host given will be treated as the \"primary\" host, and is required to succeed.\n+\n+    Args:\n+        filename: for writing the file locally.\n+    \"\"\"\n+    assert len(hosts) > 1\n+    primary_host = hosts[0]\n+    other_hosts = hosts[1:]\n+    got_files = []\n+\n+    def join_url(host: str) -> str:\n+        return host.rstrip('/') + '/' + path.lstrip('/')\n+\n+    url = join_url(primary_host)\n+    success, output = download_with_wget(url, filename)\n+    if not success:\n+        log.error(\n+            f\"couldn't fetch file ({url}). \"\n+            \"Have you specified the version number in the following format?\\n\"\n+            f\"{VERSION_FORMAT} \"\n+            f\"(example: {VERSION_EXAMPLE})\\n\"\n+            f\"wget output:\\n{indent(output)}\")\n+        return ReturnCode.FILE_GET_FAILED\n+    else:\n+        log.info(f\"got file {url} as {filename}\")\n+        got_files.append(filename)\n+\n+    for i, host in enumerate(other_hosts):\n+        url = join_url(host)\n+        fname = filename + f'.{i + 2}'\n+        success, output = download_with_wget(url, fname)\n+\n+        if require_all and not success:\n+            log.error(\n+                f\"{host} failed to provide file ({url}), but {primary_host} did?\\n\"\n+                f\"wget output:\\n{indent(output)}\")\n+            return ReturnCode.FILE_MISSING_FROM_ONE_HOST\n+        elif not success:\n+            log.warning(\n+                f\"{host} failed to provide file ({url}). \"\n+                f\"Continuing based solely upon {primary_host}.\")\n+        else:\n+            log.info(f\"got file {url} as {fname}\")\n+            got_files.append(fname)\n+\n+    for i, got_file in enumerate(got_files):\n+        if got_file == got_files[-1]:\n+            break  # break on last file, nothing after it to compare to\n+\n+        compare_to = got_files[i + 1]\n+        if not files_are_equal(got_file, compare_to):\n+            log.error(f\"files not equal: {got_file} and {compare_to}\")\n+            return ReturnCode.FILES_NOT_EQUAL\n+\n+    return ReturnCode.SUCCESS\n+\n+\n+def check_multisig(sums_file: str, sigfilename: str, args: argparse.Namespace) -> t.Tuple[int, str, t.List[SigData], t.List[SigData], t.List[SigData]]:\n+    # check signature\n+    #\n+    # We don't write output to a file because this command will almost certainly\n+    # fail with GPG exit code '2' (and so not writing to --output) because of the\n+    # likely presence of multiple untrusted signatures.\n+    retval, output = verify_with_gpg(sums_file, sigfilename)\n+\n+    if args.verbose:\n+        log.info(f\"gpg output:\\n{indent(output)}\")\n+\n+    good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    if unknown and args.import_keys:\n+        # Retrieve unknown keys and then try GPG again.\n+        for unsig in unknown:\n+            if prompt_yn(f\" ? Retrieve key {unsig.key} ({unsig.name})? (y/N) \"):\n+                ran = subprocess.run(\n+                    [\"gpg\", \"--keyserver\", args.keyserver, \"--recv-keys\", unsig.key])\n+\n+                if ran.returncode != 0:\n+                    log.warning(f\"failed to retrieve key {unsig.key}\")\n+\n+        # Reparse the GPG output now that we have more keys\n+        retval, output = verify_with_gpg(sums_file, sigfilename)\n+        good, unknown, bad = parse_gpg_result(output.splitlines())\n+\n+    return retval, output, good, unknown, bad\n \n \n-def main(args):\n-    # sanity check\n-    if len(args) < 1:\n-        print(\"Error: need to specify a version on the command line\")\n-        return 3\n+def prompt_yn(prompt) -> bool:\n+    \"\"\"Return true if the user inputs 'y'.\"\"\"\n+    got = ''\n+    while got not in ['y', 'n']:\n+        got = input(prompt).lower()\n+    return got == 'y'\n+\n+def verify_shasums_signature(\n+    signature_file_path: str, sums_file_path: str, args: argparse.Namespace\n+) -> t.Tuple[\n+   ReturnCode, t.List[SigData], t.List[SigData], t.List[SigData], t.List[SigData]\n+]:\n+    min_good_sigs = args.min_good_sigs\n+    gpg_allowed_codes = [0, 2]  # 2 is returned when untrusted signatures are present.\n+\n+    gpg_retval, gpg_output, good, unknown, bad = check_multisig(sums_file_path, signature_file_path, args)\n+\n+    if gpg_retval not in gpg_allowed_codes:\n+        if gpg_retval == 1:\n+            log.critical(f\"Bad signature (code: {gpg_retval}).\")\n+        else:\n+            log.critical(f\"unexpected GPG exit code ({gpg_retval})\")\n+\n+        log.error(f\"gpg output:\\n{indent(gpg_output)}\")\n+        return (ReturnCode.INTEGRITY_FAILURE, [], [], [], [])\n+\n+    # Decide which keys we trust, though not \"trust\" in the GPG sense, but rather\n+    # which pubkeys convince us that this sums file is legitimate. In other words,\n+    # which pubkeys within the Bitcoin community do we trust for the purposes of\n+    # binary verification?\n+    trusted_keys = set()\n+    if args.trusted_keys:\n+        trusted_keys |= set(args.trusted_keys.split(','))\n+\n+    # Tally signatures and make sure we have enough goods to fulfill\n+    # our threshold.\n+    good_trusted = [sig for sig in good if sig.trusted or sig.key in trusted_keys]\n+    good_untrusted = [sig for sig in good if sig not in good_trusted]\n+    num_trusted = len(good_trusted) + len(good_untrusted)\n+    log.info(f\"got {num_trusted} good signatures\")\n+\n+    if num_trusted < min_good_sigs:\n+        log.info(\"Maybe you need to import \"\n+                  f\"(`gpg --keyserver {args.keyserver} --recv-keys <key-id>`) \"\n+                  \"some of the following keys: \")\n+        log.info('')\n+        for sig in unknown:\n+            log.info(f\"    {sig.key} ({sig.name})\")\n+        log.info('')\n+        log.error(\n+            \"not enough trusted sigs to meet threshold \"\n+            f\"({num_trusted} vs. {min_good_sigs})\")\n+\n+        return (ReturnCode.NOT_ENOUGH_GOOD_SIGS, [], [], [], [])\n+\n+    for sig in good_trusted:\n+        log.info(f\"GOOD SIGNATURE: {sig}\")\n+\n+    for sig in good_untrusted:\n+        log.info(f\"GOOD SIGNATURE (untrusted): {sig}\")\n+\n+    for sig in [sig for sig in good if sig.status == 'expired']:\n+        log.warning(f\"key {sig.key} for {sig.name} is expired\")\n+\n+    for sig in bad:\n+        log.warning(f\"BAD SIGNATURE: {sig}\")\n+\n+    for sig in unknown:\n+        log.warning(f\"UNKNOWN SIGNATURE: {sig}\")\n+\n+    return (ReturnCode.SUCCESS, good_trusted, good_untrusted, unknown, bad)\n+\n+\n+def parse_sums_file(sums_file_path: str, filename_filter: t.List[str]) -> t.List[t.List[str]]:\n+    # extract hashes/filenames of binaries to verify from hash file;\n+    # each line has the following format: \"<hash> <binary_filename>\"\n+    with open(sums_file_path, 'r', encoding='utf8') as hash_file:\n+        return [line.split()[:2] for line in hash_file if len(filename_filter) == 0 or any(f in line for f in filename_filter)]\n+\n+\n+def verify_binary_hashes(hashes_to_verify: t.List[t.List[str]]) -> t.Tuple[ReturnCode, t.Dict[str, str]]:\n+    offending_files = []\n+    files_to_hashes = {}\n+\n+    for hash_expected, binary_filename in hashes_to_verify:\n+        with open(binary_filename, 'rb') as binary_file:\n+            hash_calculated = sha256(binary_file.read()).hexdigest()\n+        if hash_calculated != hash_expected:\n+            offending_files.append(binary_filename)\n+        else:\n+            files_to_hashes[binary_filename] = hash_calculated\n+\n+    if offending_files:\n+        joined_files = '\\n'.join(offending_files)\n+        log.critical(\n+            \"Hashes don't match.\\n\"\n+            f\"Offending files:\\n{joined_files}\")\n+        return (ReturnCode.INTEGRITY_FAILURE, files_to_hashes)\n+\n+    return (ReturnCode.SUCCESS, files_to_hashes)\n+\n+\n+def verify_published_handler(args: argparse.Namespace) -> ReturnCode:\n+    WORKINGDIR = Path(tempfile.gettempdir()) / f\"bitcoin_verify_binaries.{args.version}\"\n+\n+    def cleanup():\n+        log.info(\"cleaning up files\")\n+        os.chdir(Path.home())\n+        shutil.rmtree(WORKINGDIR)\n \n     # determine remote dir dependent on provided version string\n-    version_base, version_rc, os_filter = parse_version_string(args[0])\n+    try:\n+        version_base, version_rc, os_filter = parse_version_string(args.version)\n+        version_tuple = [int(i) for i in version_base.split('.')]\n+    except Exception as e:\n+        log.debug(e)\n+        log.error(f\"unable to parse version; expected format is {VERSION_FORMAT}\")\n+        log.error(f\"  e.g. {VERSION_EXAMPLE}\")\n+        return ReturnCode.BAD_VERSION\n+\n     remote_dir = f\"/bin/{VERSIONPREFIX}{version_base}/\"\n     if version_rc:\n         remote_dir += f\"test.{version_rc}/\"\n-    remote_sigfile = remote_dir + SIGNATUREFILENAME\n+    remote_sigs_path = remote_dir + SIGNATUREFILENAME\n+    remote_sums_path = remote_dir + SUMS_FILENAME\n \n     # create working directory\n     os.makedirs(WORKINGDIR, exist_ok=True)\n     os.chdir(WORKINGDIR)\n \n-    # fetch first signature file\n-    sigfile1 = SIGNATUREFILENAME\n-    success, output = download_with_wget(HOST1 + remote_sigfile, sigfile1)\n-    if not success:\n-        print(\"Error: couldn't fetch signature file. \"\n-              \"Have you specified the version number in the following format?\")\n-        print(f\"[{VERSIONPREFIX}]<version>[-rc[0-9]][-platform] \"\n-              f\"(example: {VERSIONPREFIX}0.21.0-rc3-osx)\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        return 4\n-\n-    # fetch second signature file\n-    sigfile2 = SIGNATUREFILENAME + \".2\"\n-    success, output = download_with_wget(HOST2 + remote_sigfile, sigfile2)\n-    if not success:\n-        print(\"bitcoin.org failed to provide signature file, \"\n-              \"but bitcoincore.org did?\")\n-        print(\"wget output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1])\n-        return 5\n-\n-    # ensure that both signature files are equal\n-    if not files_are_equal(sigfile1, sigfile2):\n-        print(\"bitcoin.org and bitcoincore.org signature files were not equal?\")\n-        print(f\"See files {WORKINGDIR}/{sigfile1} and {WORKINGDIR}/{sigfile2}\")\n-        return 6\n-\n-    # check signature and extract data into file\n-    retval, output = verify_with_gpg(sigfile1, HASHFILE)\n-    if retval != 0:\n-        if retval == 1:\n-            print(\"Bad signature.\")\n-        elif retval == 2:\n-            print(\"gpg error. Do you have the Bitcoin Core binary release \"\n-                  \"signing key installed?\")\n-        print(\"gpg output:\")\n-        print(indent(output, '\\t'))\n-        remove_files([sigfile1, sigfile2, HASHFILE])\n-        return 1\n+    hosts = [HOST1, HOST2]\n \n-    # extract hashes/filenames of binaries to verify from hash file;\n-    # each line has the following format: \"<hash> <binary_filename>\"\n-    with open(HASHFILE, 'r', encoding='utf8') as hash_file:\n-        hashes_to_verify = [\n-            line.split()[:2] for line in hash_file if os_filter in line]\n-    remove_files([HASHFILE])\n+    got_sig_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sigs_path, SIGNATUREFILENAME, args.require_all_hosts)\n+    if got_sig_status != ReturnCode.SUCCESS:\n+        return got_sig_status\n+\n+    # Multi-sig verification is available after 22.0.\n+    if version_tuple[0] < 22:\n+        log.error(\"Version too old - single sig not supported. Use a previous \"\n+                  \"version of this script from the repo.\")\n+        return ReturnCode.BAD_VERSION\n+\n+    got_sums_status = get_files_from_hosts_and_compare(\n+        hosts, remote_sums_path, SUMS_FILENAME, args.require_all_hosts)\n+    if got_sums_status != ReturnCode.SUCCESS:\n+        return got_sums_status\n+\n+    # Verify the signature on the SHA256SUMS file\n+    sigs_status, good_trusted, good_untrusted, unknown, bad = verify_shasums_signature(SIGNATUREFILENAME, SUMS_FILENAME, args)\n+    if sigs_status != ReturnCode.SUCCESS:\n+        if sigs_status == ReturnCode.INTEGRITY_FAILURE:\n+            cleanup()\n+        return sigs_status\n+\n+    # Extract hashes and filenames\n+    hashes_to_verify = parse_sums_file(SUMS_FILENAME, os_filter)\n     if not hashes_to_verify:\n-        print(\"error: no files matched the platform specified\")\n-        return 7\n+        log.error(\"no files matched the platform specified\")\n+        return ReturnCode.NO_BINARIES_MATCH\n+\n+    # remove binaries that are known not to be hosted by bitcoincore.org\n+    fragments_to_remove = ['-unsigned', '-debug', '-codesignatures']\n+    for fragment in fragments_to_remove:\n+        nobinaries = [i for i in hashes_to_verify if fragment in i[1]]\n+        if nobinaries:\n+            remove_str = ', '.join(i[1] for i in nobinaries)\n+            log.info(\n+                f\"removing *{fragment} binaries ({remove_str}) from verification \"\n+                f\"since {HOST1} does not host *{fragment} binaries\")\n+            hashes_to_verify = [i for i in hashes_to_verify if fragment not in i[1]]\n \n     # download binaries\n     for _, binary_filename in hashes_to_verify:\n-        print(f\"Downloading {binary_filename}\")\n-        download_with_wget(HOST1 + remote_dir + binary_filename)\n+        log.info(f\"downloading {binary_filename}\")",
      "path": "contrib/verifybinaries/verify.py",
      "position": 616,
      "original_position": 615,
      "commit_id": "754fb6bb8125317575edec7c20b5617ad27a9bdd",
      "original_commit_id": "96344222f307048ef917cd3741cc12d0bd9e82ae",
      "in_reply_to_id": 1159670307,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "added to 27440.",
      "created_at": "2023-04-09T10:50:45Z",
      "updated_at": "2023-04-09T10:50:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27358#discussion_r1161264990",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1161264990"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27358"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 533,
      "original_line": 533,
      "side": "RIGHT"
    }
  ]
}