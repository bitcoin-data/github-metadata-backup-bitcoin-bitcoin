{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336",
    "id": 218475154,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MjE4NDc1MTU0",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14336",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/14336.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/14336.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/4927bf2f257ac53569978980eaf1f61c2c6b04cc",
    "number": 14336,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "net: implement poll",
    "user": {
      "login": "pstratem",
      "id": 620611,
      "node_id": "MDQ6VXNlcjYyMDYxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pstratem",
      "html_url": "https://github.com/pstratem",
      "followers_url": "https://api.github.com/users/pstratem/followers",
      "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
      "organizations_url": "https://api.github.com/users/pstratem/orgs",
      "repos_url": "https://api.github.com/users/pstratem/repos",
      "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/pstratem/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Implement poll() on systems which support it properly.\r\n\r\nThis eliminates the restriction on maximum socket descriptor number.",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "active_lock_reason": "resolved",
    "created_at": "2018-09-26T22:37:06Z",
    "updated_at": "2021-12-16T14:03:33Z",
    "closed_at": "2019-01-02T12:15:26Z",
    "mergeable_state": "unknown",
    "merged_at": "2019-01-02T12:15:26Z",
    "merge_commit_sha": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "pstratem:2018-09-24-socket-handler-poll",
      "ref": "2018-09-24-socket-handler-poll",
      "sha": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 51982177,
        "node_id": "MDEwOlJlcG9zaXRvcnk1MTk4MjE3Nw==",
        "name": "bitcoin",
        "full_name": "pstratem/bitcoin",
        "owner": {
          "login": "pstratem",
          "id": 620611,
          "node_id": "MDQ6VXNlcjYyMDYxMQ==",
          "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/pstratem",
          "html_url": "https://github.com/pstratem",
          "followers_url": "https://api.github.com/users/pstratem/followers",
          "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
          "organizations_url": "https://api.github.com/users/pstratem/orgs",
          "repos_url": "https://api.github.com/users/pstratem/repos",
          "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/pstratem/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/pstratem/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/pstratem/bitcoin",
        "archive_url": "https://api.github.com/repos/pstratem/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/pstratem/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/pstratem/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/pstratem/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/pstratem/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/pstratem/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/pstratem/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/pstratem/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/pstratem/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/pstratem/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/pstratem/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/pstratem/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/pstratem/bitcoin/events",
        "forks_url": "https://api.github.com/repos/pstratem/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/pstratem/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/pstratem/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/pstratem/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/pstratem/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/pstratem/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/pstratem/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/pstratem/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/pstratem/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/pstratem/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/pstratem/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/pstratem/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/pstratem/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/pstratem/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/pstratem/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/pstratem/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:pstratem/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/pstratem/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/pstratem/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/pstratem/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/pstratem/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/pstratem/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/pstratem/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/pstratem/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/pstratem/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/pstratem/bitcoin/hooks",
        "svn_url": "https://github.com/pstratem/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 2,
        "watchers_count": 2,
        "size": 197422,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-02-02T15:00:04Z",
        "created_at": "2016-02-18T05:39:22Z",
        "updated_at": "2023-01-17T08:20:22Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "c62b15118997030b007f04618cbca02d7abb1332",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35475,
        "stargazers_count": 70608,
        "watchers_count": 70608,
        "size": 236222,
        "default_branch": "master",
        "open_issues_count": 671,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-08-02T18:20:46Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-08-02T18:21:18Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 172,
    "deletions": 43,
    "changed_files": 5,
    "commits": 5,
    "review_comments": 66,
    "comments": 15
  },
  "events": [
    {
      "event": "labeled",
      "id": 1869717924,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDE4Njk3MTc5MjQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1869717924",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-26T23:05:41Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1869887739,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTg2OTg4NzczOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1869887739",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-27T01:37:47Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1869904856,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTg2OTkwNDg1Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1869904856",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-27T01:55:12Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1869917013,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTg2OTkxNzAxMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1869917013",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-27T02:07:17Z"
    },
    {
      "event": "commented",
      "id": 424937472,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQyNDkzNzQ3Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/424937472",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-27T02:37:31Z",
      "updated_at": "2018-12-29T17:11:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-424937472",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1869988107,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTg2OTk4ODEwNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1869988107",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-27T03:18:53Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-27T03:18:53Z",
      "updated_at": "2018-09-27T03:18:53Z",
      "source": {
        "issue": {
          "id": 353707980,
          "node_id": "MDExOlB1bGxSZXF1ZXN0MjEwNjg0OTMw",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14046",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14046/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14046/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14046/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/14046",
          "number": 14046,
          "state": "closed",
          "state_reason": null,
          "title": "net: Refactor message parsing (CNetMessage), adds flexibility",
          "body": "This refactors the code how incoming messages gets handled.\r\nIt adds flexibility for adding new transport types (encryption handshake, new message format).\r\n\r\nThis is a subset of #14032 and a pre-requirement for BIP151.",
          "user": {
            "login": "jonasschnelli",
            "id": 178464,
            "node_id": "MDQ6VXNlcjE3ODQ2NA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonasschnelli",
            "html_url": "https://github.com/jonasschnelli",
            "followers_url": "https://api.github.com/users/jonasschnelli/followers",
            "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
            "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
            "repos_url": "https://api.github.com/users/jonasschnelli/repos",
            "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 20,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14046",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/14046",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/14046.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/14046.patch"
          },
          "closed_at": "2020-05-07T07:38:26Z",
          "created_at": "2018-08-24T09:20:34Z",
          "updated_at": "2022-02-15T10:44:26Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-27T03:21:55Z",
      "updated_at": "2018-09-27T03:21:55Z",
      "source": {
        "issue": {
          "id": 353427896,
          "node_id": "MDExOlB1bGxSZXF1ZXN0MjEwNDgyNTI1",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14032",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14032/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14032/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14032/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/14032",
          "number": 14032,
          "state": "closed",
          "state_reason": null,
          "title": "Add p2p layer encryption with ECDH/ChaCha20Poly1305",
          "body": "This PR adds encryption to the p2p communication after a slightly overhauled version of BIP151 defined [here](https://gist.github.com/jonasschnelli/c530ea8421b8d0e80c51486325587c52) (there is the plan to change BIP151 or to propose this protocol in a new BIP)\r\n\r\nThe encryption is optional and by default disabled (`-netencryption`).\r\n\r\nIf enabled, a peer connecting to another peer signalling `NODE_ENCRYPTED` (or added via `-connect=`) will try to do the proposed key handshake and continue with encrypted communication.\r\n\r\nIf enabled, peers can request (and perform) encrypted communications by sending a handshake request.\r\n\r\nPeers not supporting encryption are still accepted (no option to enforce encrypted communication).\r\n\r\nThere is a plan to make the handshake quantum resistance by adding NewHope to the key handshake (https://newhopecrypto.org). But since this PR is already very large, it's unclear wether this should be an independent patch (probably another ~600 lines of code).\r\n\r\n**Out of scope:**\r\n* optimized ChaCha20 implementation (for review and security reasons, the implementation is extracted from openssh)\r\n* benchmarks added to bench (I have done comparison against the v1 protocol with dbl-SHA256 the performance seems very similar)\r\n* Please no discussion about the used crypto scheme or the [proposal](https://gist.github.com/jonasschnelli/c530ea8421b8d0e80c51486325587c52) itself (better place would be the mailing list)\r\n\r\n**TODO:**\r\n* [ ] add option to `-connect=` RPC `addnode` where it is possible to specify the expected service flags (currently `-connect=` will always try for encrypted coms).",
          "user": {
            "login": "jonasschnelli",
            "id": 178464,
            "node_id": "MDQ6VXNlcjE3ODQ2NA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonasschnelli",
            "html_url": "https://github.com/jonasschnelli",
            "followers_url": "https://api.github.com/users/jonasschnelli/followers",
            "following_url": "https://api.github.com/users/jonasschnelli/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jonasschnelli/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jonasschnelli/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
            "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
            "repos_url": "https://api.github.com/users/jonasschnelli/repos",
            "events_url": "https://api.github.com/users/jonasschnelli/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 13,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14032",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/14032",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/14032.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/14032.patch"
          },
          "closed_at": "2021-08-18T12:25:27Z",
          "created_at": "2018-08-23T15:11:14Z",
          "updated_at": "2022-08-24T09:46:33Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1870017393,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTg3MDAxNzM5Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1870017393",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-27T03:52:02Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1871876319,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTg3MTg3NjMxOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1871876319",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-27T18:54:12Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1874533064,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTg3NDUzMzA2NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1874533064",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-28T21:50:18Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1874644725,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTg3NDY0NDcyNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1874644725",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-28T23:29:52Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1874677981,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTg3NDY3Nzk4MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1874677981",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-29T00:16:38Z"
    },
    {
      "event": "commented",
      "id": 425601942,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTYwMTk0Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425601942",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-09-29T00:51:55Z",
      "updated_at": "2018-09-29T00:51:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "It seems that lots of the functional tests have races cause this pull request keeps triggering random seeming failures.",
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-425601942",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "reviewed",
      "id": 160070420,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTYwMDcwNDIw",
      "url": null,
      "actor": null,
      "commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-160070420",
      "submitted_at": "2018-09-29T07:18:27Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "reviewed",
      "id": 160070469,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTYwMDcwNDY5",
      "url": null,
      "actor": null,
      "commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-160070469",
      "submitted_at": "2018-09-29T07:20:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "reviewed",
      "id": 160070544,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTYwMDcwNTQ0",
      "url": null,
      "actor": null,
      "commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-160070544",
      "submitted_at": "2018-09-29T07:22:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "reviewed",
      "id": 160070594,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTYwMDcwNTk0",
      "url": null,
      "actor": null,
      "commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-160070594",
      "submitted_at": "2018-09-29T07:23:41Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "reviewed",
      "id": 160096136,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTYwMDk2MTM2",
      "url": null,
      "actor": null,
      "commit_id": "d9ae35592cb978a3aef6baa2ae84500790f99ae9",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-160096136",
      "submitted_at": "2018-09-29T23:39:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1877628618,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTg3NzYyODYxOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1877628618",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-01T19:37:30Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1877628992,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTg3NzYyODk5Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1877628992",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-01T19:37:43Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1877642754,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTg3NzY0Mjc1NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1877642754",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-01T19:44:28Z"
    },
    {
      "event": "commented",
      "id": 426403018,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQyNjQwMzAxOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/426403018",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-02T19:37:32Z",
      "updated_at": "2018-10-02T19:37:32Z",
      "author_association": "MEMBER",
      "body": "Concept ACK, will review in detail when my brain works again.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-426403018",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1880257458,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTg4MDI1NzQ1OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1880257458",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-02T19:43:16Z"
    },
    {
      "event": "commented",
      "id": 426415581,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQyNjQxNTU4MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/426415581",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-02T20:19:32Z",
      "updated_at": "2018-10-02T20:19:32Z",
      "author_association": "MEMBER",
      "body": "Concept ACK. Will also review shortly.",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-426415581",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-08T02:43:51Z",
      "updated_at": "2018-10-08T02:43:51Z",
      "source": {
        "issue": {
          "id": 367508378,
          "node_id": "MDExOlB1bGxSZXF1ZXN0MjIwOTE5NTQ2",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14419",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14419/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14419/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14419/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/14419",
          "number": 14419,
          "state": "closed",
          "state_reason": null,
          "title": "[tests] Remove rpc_zmq.py",
          "body": "rpc_zmq.py is racy and fails intermittently. Remove that test file and\r\nmove the getzmqnotifications RPC test into interface_zmq.py.",
          "user": {
            "login": "jnewbery",
            "id": 1063656,
            "node_id": "MDQ6VXNlcjEwNjM2NTY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jnewbery",
            "html_url": "https://github.com/jnewbery",
            "followers_url": "https://api.github.com/users/jnewbery/followers",
            "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
            "organizations_url": "https://api.github.com/users/jnewbery/orgs",
            "repos_url": "https://api.github.com/users/jnewbery/repos",
            "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jnewbery/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 9,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14419",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/14419",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/14419.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/14419.patch"
          },
          "closed_at": "2018-10-08T02:52:53Z",
          "created_at": "2018-10-07T00:33:16Z",
          "updated_at": "2021-09-08T11:58:31Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1907152643,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkwNzE1MjY0Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1907152643",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-16T15:24:06Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1907182694,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkwNzE4MjY5NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1907182694",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-16T15:34:33Z"
    },
    {
      "event": "reviewed",
      "id": 165345973,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTY1MzQ1OTcz",
      "url": null,
      "actor": null,
      "commit_id": "5f99a7861c44e7f86292a06c1f9c97dac30b7161",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Some minor comments and a question about conservatively falling back to `select` for MacOS systems. Code looks good!",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-165345973",
      "submitted_at": "2018-10-16T20:28:26Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "reviewed",
      "id": 165353430,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTY1MzUzNDMw",
      "url": null,
      "actor": null,
      "commit_id": "84fae8d4cc6a6d9f81644cef706629263e84d353",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-165353430",
      "submitted_at": "2018-10-16T20:29:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "renamed",
      "id": 1916361749,
      "node_id": "MDE3OlJlbmFtZWRUaXRsZUV2ZW50MTkxNjM2MTc0OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1916361749",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-20T19:52:32Z",
      "rename": {
        "from": "net: implement poll",
        "to": "wip: net: implement poll"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1927459919,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkyNzQ1OTkxOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1927459919",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-25T21:54:20Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1933350532,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkzMzM1MDUzMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1933350532",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-29T20:21:30Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1936362586,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkzNjM2MjU4Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1936362586",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-30T21:34:23Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1936546027,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkzNjU0NjAyNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1936546027",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-30T23:18:13Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1936547383,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkzNjU0NzM4Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1936547383",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-30T23:19:03Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1936695135,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkzNjY5NTEzNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1936695135",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-31T01:25:46Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1936781307,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkzNjc4MTMwNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1936781307",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-31T02:48:07Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1936843843,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkzNjg0Mzg0Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1936843843",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-31T03:50:28Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1936852768,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkzNjg1Mjc2OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1936852768",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-31T03:59:59Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1938549532,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkzODU0OTUzMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1938549532",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-31T17:18:34Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1938611822,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkzODYxMTgyMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1938611822",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-31T17:41:36Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1938616431,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkzODYxNjQzMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1938616431",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-31T17:43:19Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1938618649,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkzODYxODY0OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1938618649",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-31T17:44:10Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1938620040,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTkzODYyMDA0MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1938620040",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-31T17:44:38Z"
    },
    {
      "event": "renamed",
      "id": 1938731428,
      "node_id": "MDE3OlJlbmFtZWRUaXRsZUV2ZW50MTkzODczMTQyOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1938731428",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-10-31T18:28:32Z",
      "rename": {
        "from": "wip: net: implement poll",
        "to": "net: implement poll"
      }
    },
    {
      "event": "reviewed",
      "id": 170664589,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTcwNjY0NTg5",
      "url": null,
      "actor": null,
      "commit_id": "ec652e12ee32878e0f0d378375ffac0f8313c6e5",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-170664589",
      "submitted_at": "2018-11-01T12:32:00Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "reviewed",
      "id": 170671088,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTcwNjcxMDg4",
      "url": null,
      "actor": null,
      "commit_id": "ec652e12ee32878e0f0d378375ffac0f8313c6e5",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-170671088",
      "submitted_at": "2018-11-01T12:52:36Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "commented",
      "id": 435036036,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTAzNjAzNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/435036036",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-01T13:10:37Z",
      "updated_at": "2018-11-01T13:10:37Z",
      "author_association": "MEMBER",
      "body": "some minor comments but otherwise utACK from me",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-435036036",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1941169184,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk0MTE2OTE4NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1941169184",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-01T17:59:00Z"
    },
    {
      "event": "added_to_project",
      "id": 1941339923,
      "node_id": "MDE5OkFkZGVkVG9Qcm9qZWN0RXZlbnQxOTQxMzM5OTIz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1941339923",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-01T19:11:41Z",
      "project_card": {
        "id": 14440067,
        "url": "https://api.github.com/projects/columns/cards/14440067",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Blockers"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1947488079,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk0NzQ4ODA3OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1947488079",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-05T22:00:29Z"
    },
    {
      "event": "reviewed",
      "id": 171830899,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTcxODMwODk5",
      "url": null,
      "actor": null,
      "commit_id": "efb25c0a31aeccd8dbd824ad03991d3a666583b2",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "ken2812221",
        "id": 11154118,
        "node_id": "MDQ6VXNlcjExMTU0MTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ken2812221",
        "html_url": "https://github.com/ken2812221",
        "followers_url": "https://api.github.com/users/ken2812221/followers",
        "following_url": "https://api.github.com/users/ken2812221/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ken2812221/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ken2812221/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
        "organizations_url": "https://api.github.com/users/ken2812221/orgs",
        "repos_url": "https://api.github.com/users/ken2812221/repos",
        "events_url": "https://api.github.com/users/ken2812221/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ken2812221/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-171830899",
      "submitted_at": "2018-11-06T01:09:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "commented",
      "id": 436356628,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjM1NjYyOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/436356628",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-06T18:25:04Z",
      "updated_at": "2018-11-06T18:25:04Z",
      "author_association": "MEMBER",
      "body": "I haven't reviewed the code at all, but this doesn't seem to work on my mac (macos 10.13.3).  It looks like I can't maintain a connection to any peers, here's an example of debug.log output when I grep for a single peer, to show an example:\r\n\r\n```\r\n2018-11-06T18:20:54Z Added connection peer=1788\r\n2018-11-06T18:20:54Z sending version (103 bytes) peer=1788\r\n2018-11-06T18:20:54Z send version message: version 70015, blocks=549011, us=[::]:0, peer=1788\r\n2018-11-06T18:21:55Z socket no message in first 60 seconds, 0 1 from 1788\r\n2018-11-06T18:21:55Z disconnecting peer=1788\r\n2018-11-06T18:21:55Z Cleared nodestate for peer=1788\r\n```\r\n\r\nThis pattern is holding for all my peers: my node is making an outbound connection and then disconnecting after a minute.",
      "user": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-436356628",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "comment_deleted",
      "id": 1949777686,
      "node_id": "MDE5OkNvbW1lbnREZWxldGVkRXZlbnQxOTQ5Nzc3Njg2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1949777686",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-06T18:42:41Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1949856040,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk0OTg1NjA0MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1949856040",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-06T19:16:29Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1950206559,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1MDIwNjU1OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1950206559",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-06T21:57:34Z"
    },
    {
      "event": "commented",
      "id": 436446576,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjQ0NjU3Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/436446576",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-06T23:25:02Z",
      "updated_at": "2018-11-06T23:25:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "@sdaftuar the last commit insures that there is a single struct pollfd per fd and adds significantly more logging\r\n\r\ncan you give that a try, i dont have an os x system",
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-436446576",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "mentioned",
      "id": 1950370225,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MTk1MDM3MDIyNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1950370225",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-06T23:25:02Z"
    },
    {
      "event": "subscribed",
      "id": 1950370226,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDE5NTAzNzAyMjY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1950370226",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-06T23:25:02Z"
    },
    {
      "event": "labeled",
      "id": 1950375483,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDE5NTAzNzU0ODM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1950375483",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-06T23:28:28Z",
      "label": {
        "name": "Needs gitian build",
        "color": "8c9e07"
      }
    },
    {
      "event": "commented",
      "id": 436475415,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjQ3NTQxNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/436475415",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-07T01:54:13Z",
      "updated_at": "2018-11-07T01:54:13Z",
      "author_association": "MEMBER",
      "body": "@pstratem New version seems to be working, I'll let it run overnight and report back.",
      "user": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-436475415",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "mentioned",
      "id": 1950563762,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MTk1MDU2Mzc2Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1950563762",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-07T01:54:13Z"
    },
    {
      "event": "subscribed",
      "id": 1950563764,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDE5NTA1NjM3NjQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1950563764",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-07T01:54:14Z"
    },
    {
      "event": "commented",
      "id": 436715423,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjcxNTQyMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/436715423",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-07T17:51:14Z",
      "updated_at": "2018-11-07T17:51:14Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--a722867cd34abeea1fadc8d60700f111-->\nGitian builds for commit d864e45730be82879abe9c096c4d577975fdda7d (master):\n * `4d597d216dc0ed5dae23214891153729...` [bitcoin-0.17.99-aarch64-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-aarch64-linux-gnu-debug.tar.gz)\n * `574346fdb743373d59742354b44fa6eb...` [bitcoin-0.17.99-aarch64-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-aarch64-linux-gnu.tar.gz)\n * `917414332974c093e1fb03d36d35fdb5...` [bitcoin-0.17.99-arm-linux-gnueabihf-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-arm-linux-gnueabihf-debug.tar.gz)\n * `4372cf9de88a47095cb0866dac04397f...` [bitcoin-0.17.99-arm-linux-gnueabihf.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-arm-linux-gnueabihf.tar.gz)\n * `64c30780e32ebbd18ed91f046108b1c9...` [bitcoin-0.17.99-i686-pc-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-i686-pc-linux-gnu-debug.tar.gz)\n * `716ded863700852fd791ce342bd7eb64...` [bitcoin-0.17.99-i686-pc-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-i686-pc-linux-gnu.tar.gz)\n * `9c19a015c3539ced19dc25eeee429122...` [bitcoin-0.17.99-osx-unsigned.dmg](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-osx-unsigned.dmg)\n * `ea03114a99a8798350c98a2add480a4c...` [bitcoin-0.17.99-osx64.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-osx64.tar.gz)\n * `a00c10b250688578673cb6feb1c9c5a5...` [bitcoin-0.17.99-riscv64-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-riscv64-linux-gnu-debug.tar.gz)\n * `0f46798a6847cf75e15ffc306fc24a6c...` [bitcoin-0.17.99-riscv64-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-riscv64-linux-gnu.tar.gz)\n * `419ec7a32ed070ea385fc391438333e6...` [bitcoin-0.17.99-win32-debug.zip](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-win32-debug.zip)\n * `38cac7b13da79148605e1ffa2d965b88...` [bitcoin-0.17.99-win32-setup-unsigned.exe](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-win32-setup-unsigned.exe)\n * `edfde8af30b58d47b04c871be6e147b3...` [bitcoin-0.17.99-win32.zip](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-win32.zip)\n * `ccdaa8ed341aaeb4b9fbfd6b257d45c2...` [bitcoin-0.17.99-win64-debug.zip](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-win64-debug.zip)\n * `41b211f9af5270a93241c87e01eaacfb...` [bitcoin-0.17.99-win64-setup-unsigned.exe](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-win64-setup-unsigned.exe)\n * `9aa1d2e836bd5cbf67430b9b83095364...` [bitcoin-0.17.99-win64.zip](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-win64.zip)\n * `db115e1ffd79c5812374eea03f815a17...` [bitcoin-0.17.99-x86_64-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-x86_64-linux-gnu-debug.tar.gz)\n * `2dd403a3fd11d031ea1bb55b87ba99ad...` [bitcoin-0.17.99-x86_64-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99-x86_64-linux-gnu.tar.gz)\n * `3e8f143e26c8add3da4c5948fa51a12e...` [bitcoin-0.17.99.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-0.17.99.tar.gz)\n * `f6936b93cd9d332d2f410c19cce3dada...` [bitcoin-linux-0.18-res.yml](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-linux-0.18-res.yml)\n * `6c37e9b444f5fb010ebeeb0f06da281e...` [bitcoin-linux-build.log](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-linux-build.log)\n * `18db39e5556a3cd2361dddce08a018b9...` [bitcoin-osx-0.18-res.yml](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-osx-0.18-res.yml)\n * `96cc3b3dd38c2b20a4f100bd793f3d4e...` [bitcoin-osx-build.log](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-osx-build.log)\n * `a559b90ddaaf2302da8c81742383fbd9...` [bitcoin-win-0.18-res.yml](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-win-0.18-res.yml)\n * `65fe18f73672c6fa6fec1122b1c1876b...` [bitcoin-win-build.log](https://drahtbot.space/gitian/bitcoin/bitcoin/d864e45730be82879abe9c096c4d577975fdda7d/bitcoin-win-build.log)\n\n\nGitian builds for commit 66701dc4abf7c110b7048ddd5249225f8b406ac2 (master and this pull):\n * `99e6aa42d98f3e2aec6718af6dbafa67...` [bitcoin-0.17.99-aarch64-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-aarch64-linux-gnu-debug.tar.gz)\n * `31d9e44d80e9f90b64c8763e6bcb31a1...` [bitcoin-0.17.99-aarch64-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-aarch64-linux-gnu.tar.gz)\n * `e35d67fe58402668be22ec1377773eb7...` [bitcoin-0.17.99-arm-linux-gnueabihf-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-arm-linux-gnueabihf-debug.tar.gz)\n * `c68fe8e761fae31932d89783ffe5fba1...` [bitcoin-0.17.99-arm-linux-gnueabihf.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-arm-linux-gnueabihf.tar.gz)\n * `51471edabd41bb7f256b4acd37293bde...` [bitcoin-0.17.99-i686-pc-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-i686-pc-linux-gnu-debug.tar.gz)\n * `c6a18bb020a6f9e3edbaca7c37881354...` [bitcoin-0.17.99-i686-pc-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-i686-pc-linux-gnu.tar.gz)\n * `ef54fa3a12a8c87c82965e7e2a4e0321...` [bitcoin-0.17.99-osx-unsigned.dmg](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-osx-unsigned.dmg)\n * `e365b13b2a426dac778b4270b86bb843...` [bitcoin-0.17.99-osx64.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-osx64.tar.gz)\n * `a1a5f624c0316d0ae630d39f5261af8e...` [bitcoin-0.17.99-riscv64-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-riscv64-linux-gnu-debug.tar.gz)\n * `dd5546cbce433b9b3a1d21dc3cf23cc1...` [bitcoin-0.17.99-riscv64-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-riscv64-linux-gnu.tar.gz)\n * `046dd6c2667c6476a717b83f89b7dc90...` [bitcoin-0.17.99-win32-debug.zip](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-win32-debug.zip)\n * `6396d563a21f3fad234a962e9dfcf26b...` [bitcoin-0.17.99-win32-setup-unsigned.exe](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-win32-setup-unsigned.exe)\n * `56f75690f0efb752506b15280ca6a63e...` [bitcoin-0.17.99-win32.zip](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-win32.zip)\n * `a1161a97597027d3b18bc2a12bd7a450...` [bitcoin-0.17.99-win64-debug.zip](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-win64-debug.zip)\n * `3b530f6a0c4f4e5dab78c4cb0de894d8...` [bitcoin-0.17.99-win64-setup-unsigned.exe](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-win64-setup-unsigned.exe)\n * `61b470fb10300e3fecfbf441302b54dc...` [bitcoin-0.17.99-win64.zip](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-win64.zip)\n * `ad5034a3e08b08ce12763b7b2d3b4e05...` [bitcoin-0.17.99-x86_64-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-x86_64-linux-gnu-debug.tar.gz)\n * `9b7ed96dc0c838b916d3eba6bcd8ff9a...` [bitcoin-0.17.99-x86_64-linux-gnu.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99-x86_64-linux-gnu.tar.gz)\n * `9c1a23e6aa3add785bc3a109dd78c5a4...` [bitcoin-0.17.99.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-0.17.99.tar.gz)\n * `3f659f9aed59eff53e4837b1849e1a3f...` [bitcoin-linux-0.18-res.yml](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-linux-0.18-res.yml)\n * `42d88d5ab445f5a854f50e54defe9eda...` [bitcoin-linux-build.log](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-linux-build.log)\n * `795ad5e1c9832b5eb0d6986df608f23a...` [bitcoin-osx-0.18-res.yml](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-osx-0.18-res.yml)\n * `03640b8b01160cd1b400db30a302a544...` [bitcoin-osx-build.log](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-osx-build.log)\n * `784ac7bd9e2c03acfd0abe29e5855fb9...` [bitcoin-win-0.18-res.yml](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-win-0.18-res.yml)\n * `8931546da31fb2709126b32dd191e55d...` [bitcoin-win-build.log](https://drahtbot.space/gitian/bitcoin/bitcoin/66701dc4abf7c110b7048ddd5249225f8b406ac2/bitcoin-win-build.log)\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-436715423",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "unlabeled",
      "id": 1952308645,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50MTk1MjMwODY0NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1952308645",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-07T17:51:15Z",
      "label": {
        "name": "Needs gitian build",
        "color": "8c9e07"
      }
    },
    {
      "event": "commented",
      "id": 436771773,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjc3MTc3Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/436771773",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-07T20:48:25Z",
      "updated_at": "2018-11-07T20:48:25Z",
      "author_association": "CONTRIBUTOR",
      "body": "@sdaftuar that's interesting, seems there's a bug in the os x implementation of poll regarding the same fd having multiple pollfd entries",
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-436771773",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "mentioned",
      "id": 1952699931,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MTk1MjY5OTkzMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1952699931",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-07T20:48:25Z"
    },
    {
      "event": "subscribed",
      "id": 1952699934,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDE5NTI2OTk5MzQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1952699934",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-07T20:48:25Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1952820714,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1MjgyMDcxNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1952820714",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-07T21:45:46Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1955169658,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1NTE2OTY1OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1955169658",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-08T19:10:22Z"
    },
    {
      "event": "reviewed",
      "id": 173256966,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTczMjU2OTY2",
      "url": null,
      "actor": null,
      "commit_id": "44f9c1ab13487c6ecf1a2bc038720e4b1de07098",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-173256966",
      "submitted_at": "2018-11-09T02:43:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "reviewed",
      "id": 173312802,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTczMzEyODAy",
      "url": null,
      "actor": null,
      "commit_id": "44f9c1ab13487c6ecf1a2bc038720e4b1de07098",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-173312802",
      "submitted_at": "2018-11-09T08:33:24Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "commented",
      "id": 437384408,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzM4NDQwOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437384408",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-09T14:58:04Z",
      "updated_at": "2018-11-09T14:58:04Z",
      "author_association": "MEMBER",
      "body": "I've been trying to figure out why [an earlier iteration of this PR](https://github.com/pstratem/bitcoin/commit/15b9b4ddc9998400f6e2025a9956956c15435187) fails on macOS (Darwin). The earlier version passes in a separate `pollfd` struct for each (fd, event type) pair, potentially having duplicate entries for file descriptors listed in multiple `*_select_set` sets. The current version deduplicates pollfd structs across file descriptors, passing a single struct per fd which consolidates all events we're interested in.\r\n\r\nI did a little reading yesterday to try and figure out why the first approach works on some BSD platforms (per @sdaftuar's testing on FreeBSD), but not macOS. Bear with me while we briefly venture into the weeds.\r\n\r\nDarwin's poll() implementation basically wraps kqueue use; for each `pollfd` struct passed into Darwin's poll(), [3 separate `kevent_register()` calls are made](https://github.com/apple/darwin-xnu/blob/0a798f6738bc1db01281fc08ae024145e84df927/bsd/kern/sys_generic.c#L1740-L1777) and then waited upon using `kqueue_scan()` up to the timeout.\r\n\r\nI found an apparent bug in Darwin's kqueue implementation: for each kevent registered, a knote is created and [enqueued on a per-fd list on the process' file descriptor table](https://github.com/apple/darwin-xnu/blob/0a798f6738bc1db01281fc08ae024145e84df927/bsd/kern/kern_event.c#L8141-L8143).  These knotes track which events we're waiting on and are supposed to be unique per `(fd, kevent filter)` pair, where the kevent filter is either `EVFILT_READ` (for `POLLIN`) or `EVFILT_WRITE` (for `POLLOUT`), per the kqueue API. However, `knote_fdfind()` looks to be improperly implemented so that [the first knote per fd is always returned](https://github.com/apple/darwin-xnu/blob/0a798f6738bc1db01281fc08ae024145e84df927/bsd/kern/kern_event.c#L8025-L8045), effectively ignoring the difference in filter. As far as I can tell, this could result in a situation where output events are ignored for an fd also being polled for input events (because the `POLLIN` `kevent_register()` call comes before the `POLLOUT` one in `poll_nocancel()`). \r\n\r\nUnfortunately, this doesn't explain why `POLLIN` events are ignored in the previous version of this change - in @sdaftuar's logs above and in my own testing on macOS, we always disconnect peers because we think there's nothing to read on their sockets. This isn't explained by the supposed bug I note above, though my confidence in macOS' implementation of `poll()` isn't very high given the complexity of the kqueue implementation backing it.\r\n\r\nOther versions of BSD implement poll in a much simpler way, iterating through all the pollfd structs passed in and [calling a filetype-specific poll function](https://github.com/freebsd/freebsd/blob/7ee56b76a87d24a5ff8586ff8f5d888a3898dc46/sys/kern/sys_generic.c#L1539-L1540) which returns `revents` immediately without having to deal with kevents, kqueues, or callbacks. This delegation eventually reduces to a [socket-specific poll function](https://github.com/freebsd/freebsd/blob/7ee56b76a87d24a5ff8586ff8f5d888a3898dc46/sys/kern/uipc_socket.c#L3281-L3337).\r\n\r\nAnyway, this is a longwinded way of saying that macOS's poll() doesn't inspire confidence and that we should consider disabling its use on that platform. The other BSDs look okay to me.\r\n",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-437384408",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "mentioned",
      "id": 1957044848,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MTk1NzA0NDg0OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1957044848",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-09T14:58:05Z"
    },
    {
      "event": "subscribed",
      "id": 1957044852,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDE5NTcwNDQ4NTI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1957044852",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-09T14:58:05Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1957618472,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1NzYxODQ3Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1957618472",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-09T19:05:24Z"
    },
    {
      "event": "commented",
      "id": 437462592,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzQ2MjU5Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437462592",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-09T19:06:17Z",
      "updated_at": "2018-11-09T19:06:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "I've modified to not use poll() on OSX.\r\nHowever that should probably by an automake m4 of some kind, but I'm not sure how to do that.",
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-437462592",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1958536474,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1ODUzNjQ3NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1958536474",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-10T18:53:10Z"
    },
    {
      "event": "reviewed",
      "id": 173672814,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTczNjcyODE0",
      "url": null,
      "actor": null,
      "commit_id": "4963f3110e96746855686572d43a9b5b0cb44290",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-173672814",
      "submitted_at": "2018-11-10T19:44:18Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1958608440,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1ODYwODQ0MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1958608440",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-10T21:47:05Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1958608960,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1ODYwODk2MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1958608960",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-10T21:48:21Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1958609277,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1ODYwOTI3Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1958609277",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-10T21:49:13Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1958611933,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1ODYxMTkzMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1958611933",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-10T21:57:16Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1958612520,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1ODYxMjUyMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1958612520",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-10T21:59:01Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1958612999,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1ODYxMjk5OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1958612999",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-10T22:00:34Z"
    },
    {
      "event": "reviewed",
      "id": 173682772,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTczNjgyNzcy",
      "url": null,
      "actor": null,
      "commit_id": "ce79907bd75338fe125e4b73e7814d35fb6927dc",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK\r\n\r\nYou'll want to make the `maxconnections` limiting code in init.cpp:\r\n\r\n```c++\r\nnMaxConnections = std::max(std::min<int>(nMaxConnections, FD_SETSIZE - nBind - MIN_CORE_FILEDESCRIPTORS - MAX_ADDNODE_CONNECTIONS), 0);\r\n```\r\n\r\nnot depend on `FD_SETSIZE` when `USE_POLL` is enabled (just limit to 1000 or so).",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-173682772",
      "submitted_at": "2018-11-11T03:01:54Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1958709677,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1ODcwOTY3Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1958709677",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-11T04:22:20Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1958731729,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1ODczMTcyOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1958731729",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-11T06:08:01Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1959061739,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1OTA2MTczOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1959061739",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-11T21:41:27Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1959062829,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1OTA2MjgyOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1959062829",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-11T21:43:55Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1959063846,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1OTA2Mzg0Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1959063846",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-11T21:46:18Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1959064872,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk1OTA2NDg3Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1959064872",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-11T21:49:01Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1963972560,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk2Mzk3MjU2MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1963972560",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-13T19:12:04Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1970195130,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk3MDE5NTEzMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1970195130",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-16T01:47:48Z"
    },
    {
      "event": "reviewed",
      "id": 177722963,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTc3NzIyOTYz",
      "url": null,
      "actor": null,
      "commit_id": "feca5fb7e4356f68094c440a679ec382b04b0c69",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-177722963",
      "submitted_at": "2018-11-22T16:18:38Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "reviewed",
      "id": 177723964,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTc3NzIzOTY0",
      "url": null,
      "actor": null,
      "commit_id": "feca5fb7e4356f68094c440a679ec382b04b0c69",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-177723964",
      "submitted_at": "2018-11-22T16:21:33Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "reviewed",
      "id": 177727022,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTc3NzI3MDIy",
      "url": null,
      "actor": null,
      "commit_id": "feca5fb7e4356f68094c440a679ec382b04b0c69",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-177727022",
      "submitted_at": "2018-11-22T16:30:42Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "reviewed",
      "id": 177729201,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTc3NzI5MjAx",
      "url": null,
      "actor": null,
      "commit_id": "feca5fb7e4356f68094c440a679ec382b04b0c69",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-177729201",
      "submitted_at": "2018-11-22T16:37:51Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "reviewed",
      "id": 177729950,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTc3NzI5OTUw",
      "url": null,
      "actor": null,
      "commit_id": "feca5fb7e4356f68094c440a679ec382b04b0c69",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-177729950",
      "submitted_at": "2018-11-22T16:40:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "reviewed",
      "id": 177730789,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTc3NzMwNzg5",
      "url": null,
      "actor": null,
      "commit_id": "feca5fb7e4356f68094c440a679ec382b04b0c69",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-177730789",
      "submitted_at": "2018-11-22T16:43:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1996586574,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk5NjU4NjU3NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1996586574",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-29T22:32:37Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1996632385,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk5NjYzMjM4NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1996632385",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-29T22:57:44Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1996642082,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk5NjY0MjA4Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1996642082",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-29T23:03:16Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1996978866,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk5Njk3ODg2Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1996978866",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-30T03:29:05Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxZTZhZmQwZGJjMWM1ODE0MzU1ODhlMWU5YmI0MTlhMDM1YjgxMDI4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1e6afd0dbc1c581435588e1e9bb419a035b81028",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1e6afd0dbc1c581435588e1e9bb419a035b81028",
      "tree": {
        "sha": "f6ef21aa0377eb4d9112060056675a18e8e7e8c1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f6ef21aa0377eb4d9112060056675a18e8e7e8c1"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/011c42c5bd175e14b03741398f5d4f8a4cf3dee5",
          "sha": "011c42c5bd175e14b03741398f5d4f8a4cf3dee5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/011c42c5bd175e14b03741398f5d4f8a4cf3dee5"
        }
      ],
      "message": "Introduce and use constant SELECT_TIMEOUT_MILLISECONDS.",
      "committer": {
        "name": "Patrick Strateman",
        "email": "patrick.strateman@gmail.com",
        "date": "2018-11-30T23:02:51Z"
      },
      "author": {
        "name": "Patrick Strateman",
        "email": "patrick.strateman@gmail.com",
        "date": "2018-10-29T20:30:30Z"
      },
      "sha": "1e6afd0dbc1c581435588e1e9bb419a035b81028"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3ZTQwM2MwYWU3MDU0NTVhYTY2ZjdkZjlhOWE5OWY0NjJmZDRlOWE4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7e403c0ae705455aa66f7df9a9a99f462fd4e9a8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7e403c0ae705455aa66f7df9a9a99f462fd4e9a8",
      "tree": {
        "sha": "192f2071cf1808a59c64f347800c788b61c9aa7a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/192f2071cf1808a59c64f347800c788b61c9aa7a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1e6afd0dbc1c581435588e1e9bb419a035b81028",
          "sha": "1e6afd0dbc1c581435588e1e9bb419a035b81028",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1e6afd0dbc1c581435588e1e9bb419a035b81028"
        }
      ],
      "message": "Move GenerateSelectSet logic to private method.\n\nThis separates the socket event collection logic from the logic\ndeciding which events we're interested in at all.",
      "committer": {
        "name": "Patrick Strateman",
        "email": "patrick.strateman@gmail.com",
        "date": "2018-11-30T23:02:51Z"
      },
      "author": {
        "name": "Patrick Strateman",
        "email": "patrick.strateman@gmail.com",
        "date": "2018-09-25T19:32:07Z"
      },
      "sha": "7e403c0ae705455aa66f7df9a9a99f462fd4e9a8"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyODIxMWE0YmM5YzY1ODU5YjY0MWI4MWEwNTQxNzI2YTBlMDE5ODhm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/28211a4bc9c65859b641b81a0541726a0e01988f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/28211a4bc9c65859b641b81a0541726a0e01988f",
      "tree": {
        "sha": "18d635f6bf4b467c253520bf14952ae2a2bf029b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/18d635f6bf4b467c253520bf14952ae2a2bf029b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7e403c0ae705455aa66f7df9a9a99f462fd4e9a8",
          "sha": "7e403c0ae705455aa66f7df9a9a99f462fd4e9a8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7e403c0ae705455aa66f7df9a9a99f462fd4e9a8"
        }
      ],
      "message": "Move SocketEvents logic to private method.\n\nThis separates the select() logic from the socket handling logic, setting up\nfor a switch to poll().",
      "committer": {
        "name": "Patrick Strateman",
        "email": "patrick.strateman@gmail.com",
        "date": "2018-11-30T23:02:51Z"
      },
      "author": {
        "name": "Patrick Strateman",
        "email": "patrick.strateman@gmail.com",
        "date": "2018-09-27T01:51:46Z"
      },
      "sha": "28211a4bc9c65859b641b81a0541726a0e01988f"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 1999134484,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MTk5OTEzNDQ4NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1999134484",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-30T23:03:04Z"
    },
    {
      "event": "commented",
      "id": 443366339,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MzM2NjMzOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/443366339",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-11-30T23:04:01Z",
      "updated_at": "2018-12-02T00:00:28Z",
      "author_association": "CONTRIBUTOR",
      "body": "With 87 connections the effect of generating the pollfd list shows up on a profile but isn't significant.\r\n\r\nThe poll() implementation is on the order of 1000 ns slower per call than the select() implementation.\r\n\r\nI don't think that's significant.",
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-443366339",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "reviewed",
      "id": 180835685,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTgwODM1Njg1",
      "url": null,
      "actor": null,
      "commit_id": "20c9601e6b7c4297f39de149d26292c368b63ff8",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "utACK https://github.com/bitcoin/bitcoin/pull/14336/commits/20c9601e6b7c4297f39de149d26292c368b63ff8\r\n\r\nCode looks good, feel free to ignore the small comments. I'm running tests at the moment and will report back with results within the next day - testnet happy-path behavior looks good so far.",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-180835685",
      "submitted_at": "2018-12-03T16:18:34Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxMWNjNDkxYTI4OGE3M2U5MTFiZTI0YTI4NWUxMmFiZDU3ZGY3ZDA0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/11cc491a288a73e911be24a285e12abd57df7d04",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/11cc491a288a73e911be24a285e12abd57df7d04",
      "tree": {
        "sha": "b10300e0223359f4c3b0b10b5aa8ed91ffd1d1e6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b10300e0223359f4c3b0b10b5aa8ed91ffd1d1e6"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/28211a4bc9c65859b641b81a0541726a0e01988f",
          "sha": "28211a4bc9c65859b641b81a0541726a0e01988f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/28211a4bc9c65859b641b81a0541726a0e01988f"
        }
      ],
      "message": "Implement poll() on systems which support it properly.\n\nThis eliminates the restriction on maximum socket descriptor number.",
      "committer": {
        "name": "Patrick Strateman",
        "email": "patrick.strateman@gmail.com",
        "date": "2018-12-03T19:25:51Z"
      },
      "author": {
        "name": "Patrick Strateman",
        "email": "patrick.strateman@gmail.com",
        "date": "2018-09-27T01:54:52Z"
      },
      "sha": "11cc491a288a73e911be24a285e12abd57df7d04"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0OTI3YmYyZjI1N2FjNTM1Njk5Nzg5ODBlYWYxZjYxYzJjNmIwNGNj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "tree": {
        "sha": "7b99b83bc09d4d4c7f5d97a39ee5a2d7b953031c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7b99b83bc09d4d4c7f5d97a39ee5a2d7b953031c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/11cc491a288a73e911be24a285e12abd57df7d04",
          "sha": "11cc491a288a73e911be24a285e12abd57df7d04",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/11cc491a288a73e911be24a285e12abd57df7d04"
        }
      ],
      "message": "Increase maxconnections limit when using poll.",
      "committer": {
        "name": "Patrick Strateman",
        "email": "patrick.strateman@gmail.com",
        "date": "2018-12-03T19:25:55Z"
      },
      "author": {
        "name": "Patrick Strateman",
        "email": "patrick.strateman@gmail.com",
        "date": "2018-11-13T19:09:05Z"
      },
      "sha": "4927bf2f257ac53569978980eaf1f61c2c6b04cc"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 2002363404,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MjAwMjM2MzQwNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2002363404",
      "actor": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-12-03T19:26:43Z"
    },
    {
      "event": "reviewed",
      "id": 181323429,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MTgxMzIzNDI5",
      "url": null,
      "actor": null,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Tested ACK https://github.com/bitcoin/bitcoin/pull/14336/commits/4927bf2f257ac53569978980eaf1f61c2c6b04cc\r\n\r\nTested on Linux 4.15.0-39-generic and macOS 10.12.1. Tested IBD on testnet as well as tweaking `-maxconnections` and observing connections with `lsof -a -itcp -p $(pidof bitcoind)`.\r\n\r\nOnly code change since my last utACK is a [small cleanup in netbase.cpp](https://github.com/bitcoin/bitcoin/compare/20c9601e6b7c4297f39de149d26292c368b63ff8..4927bf2f257ac53569978980eaf1f61c2c6b04cc).\r\n\r\nThanks for the work here @pstratem. ",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#pullrequestreview-181323429",
      "submitted_at": "2018-12-04T15:38:54Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
    },
    {
      "event": "commented",
      "id": 447075575,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NzA3NTU3NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/447075575",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-12-13T18:41:59Z",
      "updated_at": "2018-12-13T18:41:59Z",
      "author_association": "MEMBER",
      "body": "utACK 4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-447075575",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "merged",
      "id": 2050247673,
      "node_id": "MDExOk1lcmdlZEV2ZW50MjA1MDI0NzY3Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2050247673",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "created_at": "2019-01-02T12:15:26Z"
    },
    {
      "event": "closed",
      "id": 2050247674,
      "node_id": "MDExOkNsb3NlZEV2ZW50MjA1MDI0NzY3NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2050247674",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-01-02T12:15:26Z"
    },
    {
      "event": "referenced",
      "id": 2050248100,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDIwNTAyNDgxMDA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2050248100",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "62cf608e93f99c3aefcdfa5908f998d7719198f5",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/62cf608e93f99c3aefcdfa5908f998d7719198f5",
      "created_at": "2019-01-02T12:15:44Z"
    },
    {
      "event": "removed_from_project",
      "id": 2051496423,
      "node_id": "MDIzOlJlbW92ZWRGcm9tUHJvamVjdEV2ZW50MjA1MTQ5NjQyMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2051496423",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-01-03T00:25:22Z",
      "project_card": {
        "id": 14440067,
        "url": "https://api.github.com/projects/columns/cards/14440067",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Blockers"
      }
    },
    {
      "event": "commented",
      "id": 541308094,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU0MTMwODA5NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/541308094",
      "actor": {
        "login": "BlockMechanic",
        "id": 24528627,
        "node_id": "MDQ6VXNlcjI0NTI4NjI3",
        "avatar_url": "https://avatars.githubusercontent.com/u/24528627?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BlockMechanic",
        "html_url": "https://github.com/BlockMechanic",
        "followers_url": "https://api.github.com/users/BlockMechanic/followers",
        "following_url": "https://api.github.com/users/BlockMechanic/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BlockMechanic/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BlockMechanic/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BlockMechanic/subscriptions",
        "organizations_url": "https://api.github.com/users/BlockMechanic/orgs",
        "repos_url": "https://api.github.com/users/BlockMechanic/repos",
        "events_url": "https://api.github.com/users/BlockMechanic/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BlockMechanic/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-10-12T09:47:20Z",
      "updated_at": "2019-10-12T09:47:47Z",
      "author_association": "CONTRIBUTOR",
      "body": "Crashes on android 7 8 and 9 armv7a. May need to implement a work around",
      "user": {
        "login": "BlockMechanic",
        "id": 24528627,
        "node_id": "MDQ6VXNlcjI0NTI4NjI3",
        "avatar_url": "https://avatars.githubusercontent.com/u/24528627?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BlockMechanic",
        "html_url": "https://github.com/BlockMechanic",
        "followers_url": "https://api.github.com/users/BlockMechanic/followers",
        "following_url": "https://api.github.com/users/BlockMechanic/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BlockMechanic/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BlockMechanic/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BlockMechanic/subscriptions",
        "organizations_url": "https://api.github.com/users/BlockMechanic/orgs",
        "repos_url": "https://api.github.com/users/BlockMechanic/repos",
        "events_url": "https://api.github.com/users/BlockMechanic/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BlockMechanic/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#issuecomment-541308094",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14336"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "codablock",
        "id": 1884269,
        "node_id": "MDQ6VXNlcjE4ODQyNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1884269?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/codablock",
        "html_url": "https://github.com/codablock",
        "followers_url": "https://api.github.com/users/codablock/followers",
        "following_url": "https://api.github.com/users/codablock/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/codablock/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/codablock/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/codablock/subscriptions",
        "organizations_url": "https://api.github.com/users/codablock/orgs",
        "repos_url": "https://api.github.com/users/codablock/repos",
        "events_url": "https://api.github.com/users/codablock/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/codablock/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-04-07T05:13:14Z",
      "updated_at": "2020-04-07T05:13:14Z",
      "source": {
        "issue": {
          "id": 595595986,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDAwMDQyMzUz",
          "url": "https://api.github.com/repos/dashpay/dash/issues/3396",
          "repository_url": "https://api.github.com/repos/dashpay/dash",
          "labels_url": "https://api.github.com/repos/dashpay/dash/issues/3396/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/dashpay/dash/issues/3396/comments",
          "events_url": "https://api.github.com/repos/dashpay/dash/issues/3396/events",
          "html_url": "https://github.com/dashpay/dash/pull/3396",
          "number": 3396,
          "state": "closed",
          "state_reason": null,
          "title": "Backport poll() code from Bitcoin",
          "body": "This backports bitcoin#14335 and bitcoin#14336. bitcoin#13503 is also backported to avoid a merge conflict.\r\n\r\nLong term goal is to implement epoll() in the future, which will reduce network overhead (select/poll) to basically zero (it's ~80% right now with 400 connections).",
          "user": {
            "login": "codablock",
            "id": 1884269,
            "node_id": "MDQ6VXNlcjE4ODQyNjk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1884269?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/codablock",
            "html_url": "https://github.com/codablock",
            "followers_url": "https://api.github.com/users/codablock/followers",
            "following_url": "https://api.github.com/users/codablock/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/codablock/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/codablock/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/codablock/subscriptions",
            "organizations_url": "https://api.github.com/users/codablock/orgs",
            "repos_url": "https://api.github.com/users/codablock/repos",
            "events_url": "https://api.github.com/users/codablock/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/codablock/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "NONE",
          "milestone": {
            "url": "https://api.github.com/repos/dashpay/dash/milestones/24",
            "html_url": "https://github.com/dashpay/dash/milestone/24",
            "labels_url": "https://api.github.com/repos/dashpay/dash/milestones/24/labels",
            "id": 4925122,
            "node_id": "MDk6TWlsZXN0b25lNDkyNTEyMg==",
            "number": 24,
            "state": "closed",
            "title": "16",
            "creator": {
              "login": "codablock",
              "id": 1884269,
              "node_id": "MDQ6VXNlcjE4ODQyNjk=",
              "avatar_url": "https://avatars.githubusercontent.com/u/1884269?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/codablock",
              "html_url": "https://github.com/codablock",
              "followers_url": "https://api.github.com/users/codablock/followers",
              "following_url": "https://api.github.com/users/codablock/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/codablock/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/codablock/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/codablock/subscriptions",
              "organizations_url": "https://api.github.com/users/codablock/orgs",
              "repos_url": "https://api.github.com/users/codablock/repos",
              "events_url": "https://api.github.com/users/codablock/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/codablock/received_events",
              "type": "User",
              "site_admin": false
            },
            "open_issues": 0,
            "closed_issues": 284,
            "created_at": "2019-12-12T11:04:32Z",
            "updated_at": "2021-05-15T00:02:08Z",
            "closed_at": "2021-05-15T00:02:08Z"
          },
          "locked": false,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/dashpay/dash/pulls/3396",
            "html_url": "https://github.com/dashpay/dash/pull/3396",
            "diff_url": "https://github.com/dashpay/dash/pull/3396.diff",
            "patch_url": "https://github.com/dashpay/dash/pull/3396.patch"
          },
          "closed_at": "2020-04-08T22:12:21Z",
          "created_at": "2020-04-07T05:13:14Z",
          "updated_at": "2020-04-08T22:12:27Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "referenced",
      "id": 3215440253,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDMyMTU0NDAyNTM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3215440253",
      "actor": {
        "login": "codablock",
        "id": 1884269,
        "node_id": "MDQ6VXNlcjE4ODQyNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1884269?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/codablock",
        "html_url": "https://github.com/codablock",
        "followers_url": "https://api.github.com/users/codablock/followers",
        "following_url": "https://api.github.com/users/codablock/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/codablock/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/codablock/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/codablock/subscriptions",
        "organizations_url": "https://api.github.com/users/codablock/orgs",
        "repos_url": "https://api.github.com/users/codablock/repos",
        "events_url": "https://api.github.com/users/codablock/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/codablock/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "d901baebc76fb7ad86bc4c024f940cb004c5da60",
      "commit_url": "https://api.github.com/repos/codablock/dash/commits/d901baebc76fb7ad86bc4c024f940cb004c5da60",
      "created_at": "2020-04-08T19:02:21Z"
    },
    {
      "event": "referenced",
      "id": 3215783818,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDMyMTU3ODM4MTg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3215783818",
      "actor": {
        "login": "codablock",
        "id": 1884269,
        "node_id": "MDQ6VXNlcjE4ODQyNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1884269?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/codablock",
        "html_url": "https://github.com/codablock",
        "followers_url": "https://api.github.com/users/codablock/followers",
        "following_url": "https://api.github.com/users/codablock/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/codablock/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/codablock/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/codablock/subscriptions",
        "organizations_url": "https://api.github.com/users/codablock/orgs",
        "repos_url": "https://api.github.com/users/codablock/repos",
        "events_url": "https://api.github.com/users/codablock/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/codablock/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "8481d6c110d8bf9c75549ce607b266e097cda9b8",
      "commit_url": "https://api.github.com/repos/codablock/dash/commits/8481d6c110d8bf9c75549ce607b266e097cda9b8",
      "created_at": "2020-04-08T20:44:40Z"
    },
    {
      "event": "referenced",
      "id": 3427184972,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDM0MjcxODQ5NzI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3427184972",
      "actor": {
        "login": "deadalnix",
        "id": 854121,
        "node_id": "MDQ6VXNlcjg1NDEyMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/854121?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/deadalnix",
        "html_url": "https://github.com/deadalnix",
        "followers_url": "https://api.github.com/users/deadalnix/followers",
        "following_url": "https://api.github.com/users/deadalnix/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/deadalnix/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/deadalnix/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/deadalnix/subscriptions",
        "organizations_url": "https://api.github.com/users/deadalnix/orgs",
        "repos_url": "https://api.github.com/users/deadalnix/repos",
        "events_url": "https://api.github.com/users/deadalnix/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/deadalnix/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "7ef2a7b7612c26137f038b5dc5836a255f30577b",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/7ef2a7b7612c26137f038b5dc5836a255f30577b",
      "created_at": "2020-06-09T23:20:09Z"
    },
    {
      "event": "referenced",
      "id": 3427215732,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDM0MjcyMTU3MzI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3427215732",
      "actor": {
        "login": "deadalnix",
        "id": 854121,
        "node_id": "MDQ6VXNlcjg1NDEyMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/854121?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/deadalnix",
        "html_url": "https://github.com/deadalnix",
        "followers_url": "https://api.github.com/users/deadalnix/followers",
        "following_url": "https://api.github.com/users/deadalnix/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/deadalnix/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/deadalnix/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/deadalnix/subscriptions",
        "organizations_url": "https://api.github.com/users/deadalnix/orgs",
        "repos_url": "https://api.github.com/users/deadalnix/repos",
        "events_url": "https://api.github.com/users/deadalnix/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/deadalnix/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "716ac6e899ad35fb75488583b784ac2e1cf445ce",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/716ac6e899ad35fb75488583b784ac2e1cf445ce",
      "created_at": "2020-06-09T23:35:08Z"
    },
    {
      "event": "referenced",
      "id": 3427215735,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDM0MjcyMTU3MzU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3427215735",
      "actor": {
        "login": "deadalnix",
        "id": 854121,
        "node_id": "MDQ6VXNlcjg1NDEyMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/854121?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/deadalnix",
        "html_url": "https://github.com/deadalnix",
        "followers_url": "https://api.github.com/users/deadalnix/followers",
        "following_url": "https://api.github.com/users/deadalnix/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/deadalnix/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/deadalnix/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/deadalnix/subscriptions",
        "organizations_url": "https://api.github.com/users/deadalnix/orgs",
        "repos_url": "https://api.github.com/users/deadalnix/repos",
        "events_url": "https://api.github.com/users/deadalnix/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/deadalnix/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "96827c217616abf7df7c8ee9504b61474b22dc1b",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/96827c217616abf7df7c8ee9504b61474b22dc1b",
      "created_at": "2020-06-09T23:35:08Z"
    },
    {
      "event": "referenced",
      "id": 3427243587,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDM0MjcyNDM1ODc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3427243587",
      "actor": {
        "login": "deadalnix",
        "id": 854121,
        "node_id": "MDQ6VXNlcjg1NDEyMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/854121?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/deadalnix",
        "html_url": "https://github.com/deadalnix",
        "followers_url": "https://api.github.com/users/deadalnix/followers",
        "following_url": "https://api.github.com/users/deadalnix/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/deadalnix/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/deadalnix/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/deadalnix/subscriptions",
        "organizations_url": "https://api.github.com/users/deadalnix/orgs",
        "repos_url": "https://api.github.com/users/deadalnix/repos",
        "events_url": "https://api.github.com/users/deadalnix/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/deadalnix/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "898802efaa5875884b1b9d07e132c6d30ab84eac",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/898802efaa5875884b1b9d07e132c6d30ab84eac",
      "created_at": "2020-06-09T23:50:09Z"
    },
    {
      "event": "referenced",
      "id": 3427272152,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDM0MjcyNzIxNTI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3427272152",
      "actor": {
        "login": "deadalnix",
        "id": 854121,
        "node_id": "MDQ6VXNlcjg1NDEyMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/854121?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/deadalnix",
        "html_url": "https://github.com/deadalnix",
        "followers_url": "https://api.github.com/users/deadalnix/followers",
        "following_url": "https://api.github.com/users/deadalnix/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/deadalnix/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/deadalnix/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/deadalnix/subscriptions",
        "organizations_url": "https://api.github.com/users/deadalnix/orgs",
        "repos_url": "https://api.github.com/users/deadalnix/repos",
        "events_url": "https://api.github.com/users/deadalnix/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/deadalnix/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "6f41fa19a3cac196b49f53701ded65d556887360",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/6f41fa19a3cac196b49f53701ded65d556887360",
      "created_at": "2020-06-10T00:05:08Z"
    },
    {
      "event": "referenced",
      "id": 5359574977,
      "node_id": "REFE_lADOABII584VtdpDzwAAAAE_dJ_B",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5359574977",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "ee7891a0c412728cf8bec667f25263682a9baaaf",
      "commit_url": "https://api.github.com/repos/hebasto/bitcoin/commits/ee7891a0c412728cf8bec667f25263682a9baaaf",
      "created_at": "2021-09-25T11:20:59Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-25T11:24:04Z",
      "updated_at": "2021-09-25T11:24:04Z",
      "source": {
        "issue": {
          "id": 1007060276,
          "node_id": "PR_kwDOABII584sRD_5",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23094",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23094/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23094/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23094/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/23094",
          "number": 23094,
          "state": "closed",
          "state_reason": null,
          "title": "doc: Remove outdated comments",
          "body": "The first removed comment was introduced in #5288, the second one in #13503.\r\n\r\nBoth are outdated since #14336.",
          "user": {
            "login": "hebasto",
            "id": 32963518,
            "node_id": "MDQ6VXNlcjMyOTYzNTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hebasto",
            "html_url": "https://github.com/hebasto",
            "followers_url": "https://api.github.com/users/hebasto/followers",
            "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
            "organizations_url": "https://api.github.com/users/hebasto/orgs",
            "repos_url": "https://api.github.com/users/hebasto/repos",
            "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/hebasto/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 148216,
              "node_id": "MDU6TGFiZWwxNDgyMTY=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Docs",
              "name": "Docs",
              "color": "02d7e1",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 0,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23094",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/23094",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/23094.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/23094.patch"
          },
          "closed_at": "2021-09-27T10:57:54Z",
          "created_at": "2021-09-25T11:24:04Z",
          "updated_at": "2022-10-30T19:08:19Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "referenced",
      "id": 5364723258,
      "node_id": "REFE_lADOABII584VtdpDzwAAAAE_wy46",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5364723258",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "8b523f2e55713c0093ed46931cb332bfeb1ba661",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8b523f2e55713c0093ed46931cb332bfeb1ba661",
      "created_at": "2021-09-27T10:57:47Z"
    },
    {
      "event": "referenced",
      "id": 5366319637,
      "node_id": "REFE_lADOABII584VtdpDzwAAAAE_24oV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5366319637",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "e84c3605984c2acb14a16dc4224a2c1e92b3a5d2",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/e84c3605984c2acb14a16dc4224a2c1e92b3a5d2",
      "created_at": "2021-09-27T15:04:59Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-29T08:37:03Z",
      "updated_at": "2021-09-29T08:37:03Z",
      "source": {
        "issue": {
          "id": 1010663006,
          "node_id": "PR_kwDOABII584sb5AP",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23130",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23130/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23130/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23130/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/23130",
          "number": 23130,
          "state": "closed",
          "state_reason": null,
          "title": "doc: Revert \"Remove outdated comments\" and place comment correctly",
          "body": "Unfortunately, in #23094 the assumption that #14336 makes comments outdated is wrong. As pointed in  https://github.com/bitcoin/bitcoin/pull/23094#discussion_r717226839, the #14336 just moved the relevant code a few lines down.\r\n\r\nThis PR reverts commit ee7891a0c412728cf8bec667f25263682a9baaaf, and moves the comments into the right place.\r\n\r\nI apologize about that.",
          "user": {
            "login": "hebasto",
            "id": 32963518,
            "node_id": "MDQ6VXNlcjMyOTYzNTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hebasto",
            "html_url": "https://github.com/hebasto",
            "followers_url": "https://api.github.com/users/hebasto/followers",
            "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
            "organizations_url": "https://api.github.com/users/hebasto/orgs",
            "repos_url": "https://api.github.com/users/hebasto/repos",
            "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/hebasto/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 148216,
              "node_id": "MDU6TGFiZWwxNDgyMTY=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Docs",
              "name": "Docs",
              "color": "02d7e1",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 4,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23130",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/23130",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/23130.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/23130.patch"
          },
          "closed_at": "2021-09-30T10:34:10Z",
          "created_at": "2021-09-29T08:37:03Z",
          "updated_at": "2022-10-30T19:08:04Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "referenced",
      "id": 5386703247,
      "node_id": "REFE_lADOABII584VtdpDzwAAAAFBEpGP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5386703247",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "dbbb7fbcc02ef7a667878d2e6cfad4dc985700b8",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dbbb7fbcc02ef7a667878d2e6cfad4dc985700b8",
      "created_at": "2021-09-30T10:34:07Z"
    },
    {
      "event": "referenced",
      "id": 5388150674,
      "node_id": "REFE_lADOABII584VtdpDzwAAAAFBKKeS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5388150674",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "a2b232de944f2f0effc0af12e8d5794872efcd6e",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/a2b232de944f2f0effc0af12e8d5794872efcd6e",
      "created_at": "2021-09-30T14:24:35Z"
    },
    {
      "event": "referenced",
      "id": 5459468736,
      "node_id": "REFE_lADOABII584VtdpDzwAAAAFFaOHA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5459468736",
      "actor": {
        "login": "rebroad",
        "id": 1530283,
        "node_id": "MDQ6VXNlcjE1MzAyODM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1530283?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rebroad",
        "html_url": "https://github.com/rebroad",
        "followers_url": "https://api.github.com/users/rebroad/followers",
        "following_url": "https://api.github.com/users/rebroad/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rebroad/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rebroad/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
        "organizations_url": "https://api.github.com/users/rebroad/orgs",
        "repos_url": "https://api.github.com/users/rebroad/repos",
        "events_url": "https://api.github.com/users/rebroad/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rebroad/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "147cd3022a92926a3ff79dbd7d6ec79be054655c",
      "commit_url": "https://api.github.com/repos/rebroad/bitcoin/commits/147cd3022a92926a3ff79dbd7d6ec79be054655c",
      "created_at": "2021-10-13T19:42:27Z"
    },
    {
      "event": "locked",
      "id": 5778568845,
      "node_id": "LOE_lADOABII584VtdpDzwAAAAFYbfaN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5778568845",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-12-16T14:03:33Z",
      "lock_reason": "resolved"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221419247",
      "pull_request_review_id": 160070420,
      "id": 221419247,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQxOTI0Nw==",
      "diff_hunk": "@@ -1153,310 +1153,407 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\n     }\n }\n \n-void CConnman::ThreadSocketHandler()\n+void CConnman::DisconnectNodes()\n {\n-    unsigned int nPrevNodeCount = 0;\n-    while (!interruptNet)\n     {\n-        //\n-        // Disconnect nodes\n-        //\n-        {\n-            LOCK(cs_vNodes);\n+        LOCK(cs_vNodes);\n \n-            if (!fNetworkActive) {\n-                // Disconnect any connected nodes\n-                for (CNode* pnode : vNodes) {\n-                    if (!pnode->fDisconnect) {\n-                        LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n-                        pnode->fDisconnect = true;\n-                    }\n+        if (!fNetworkActive) {\n+            // Disconnect any connected nodes\n+            for (CNode* pnode : vNodes) {\n+                if (!pnode->fDisconnect) {\n+                    LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n+                    pnode->fDisconnect = true;\n                 }\n             }\n+        }\n \n-            // Disconnect unused nodes\n-            std::vector<CNode*> vNodesCopy = vNodes;\n-            for (CNode* pnode : vNodesCopy)\n+        // Disconnect unused nodes\n+        std::vector<CNode*> vNodesCopy = vNodes;\n+        for (CNode* pnode : vNodesCopy)\n+        {\n+            if (pnode->fDisconnect)\n             {\n-                if (pnode->fDisconnect)\n-                {\n-                    // remove from vNodes\n-                    vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n+                // remove from vNodes\n+                vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n \n-                    // release outbound grant (if any)\n-                    pnode->grantOutbound.Release();\n+                // release outbound grant (if any)\n+                pnode->grantOutbound.Release();\n \n-                    // close socket and cleanup\n-                    pnode->CloseSocketDisconnect();\n+                // close socket and cleanup\n+                pnode->CloseSocketDisconnect();\n \n-                    // hold in disconnected pool until all refs are released\n-                    pnode->Release();\n-                    vNodesDisconnected.push_back(pnode);\n-                }\n+                // hold in disconnected pool until all refs are released\n+                pnode->Release();\n+                vNodesDisconnected.push_back(pnode);\n             }\n         }\n+    }\n+    {\n+        // Delete disconnected nodes\n+        std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n+        for (CNode* pnode : vNodesDisconnectedCopy)\n         {\n-            // Delete disconnected nodes\n-            std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n-            for (CNode* pnode : vNodesDisconnectedCopy)\n-            {\n-                // wait until threads are done using it\n-                if (pnode->GetRefCount() <= 0) {\n-                    bool fDelete = false;\n-                    {\n-                        TRY_LOCK(pnode->cs_inventory, lockInv);\n-                        if (lockInv) {\n-                            TRY_LOCK(pnode->cs_vSend, lockSend);\n-                            if (lockSend) {\n-                                fDelete = true;\n-                            }\n+            // wait until threads are done using it\n+            if (pnode->GetRefCount() <= 0) {\n+                bool fDelete = false;\n+                {\n+                    TRY_LOCK(pnode->cs_inventory, lockInv);\n+                    if (lockInv) {\n+                        TRY_LOCK(pnode->cs_vSend, lockSend);\n+                        if (lockSend) {\n+                            fDelete = true;\n                         }\n                     }\n-                    if (fDelete) {\n-                        vNodesDisconnected.remove(pnode);\n-                        DeleteNode(pnode);\n-                    }\n+                }\n+                if (fDelete) {\n+                    vNodesDisconnected.remove(pnode);\n+                    DeleteNode(pnode);\n                 }\n             }\n         }\n-        size_t vNodesSize;\n+    }\n+}\n+\n+void CConnman::NotifyNumConnectionsChanged()\n+{\n+    size_t vNodesSize;\n+    {\n+        LOCK(cs_vNodes);\n+        vNodesSize = vNodes.size();\n+    }\n+    if(vNodesSize != nPrevNodeCount) {\n+        nPrevNodeCount = vNodesSize;\n+        if(clientInterface)\n+            clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+    }\n+}\n+\n+void CConnman::InactivityCheck(CNode *pnode)\n+{\n+    int64_t nTime = GetSystemTimeInSeconds();\n+    if (nTime - pnode->nTimeConnected > 60)\n+    {\n+        if (pnode->nLastRecv == 0 || pnode->nLastSend == 0)\n+        {\n+            LogPrint(BCLog::NET, \"socket no message in first 60 seconds, %d %d from %d\\n\", pnode->nLastRecv != 0, pnode->nLastSend != 0, pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+        else if (nTime - pnode->nLastSend > TIMEOUT_INTERVAL)\n         {\n-            LOCK(cs_vNodes);\n-            vNodesSize = vNodes.size();\n+            LogPrintf(\"socket sending timeout: %is\\n\", nTime - pnode->nLastSend);\n+            pnode->fDisconnect = true;\n         }\n-        if(vNodesSize != nPrevNodeCount) {\n-            nPrevNodeCount = vNodesSize;\n-            if(clientInterface)\n-                clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+        else if (nTime - pnode->nLastRecv > (pnode->nVersion > BIP0031_VERSION ? TIMEOUT_INTERVAL : 90*60))\n+        {\n+            LogPrintf(\"socket receive timeout: %is\\n\", nTime - pnode->nLastRecv);\n+            pnode->fDisconnect = true;\n         }\n-\n-        //\n-        // Find which sockets have data to receive\n-        //\n-        struct timeval timeout;\n-        timeout.tv_sec  = 0;\n-        timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n-\n-        fd_set fdsetRecv;\n-        fd_set fdsetSend;\n-        fd_set fdsetError;\n-        FD_ZERO(&fdsetRecv);\n-        FD_ZERO(&fdsetSend);\n-        FD_ZERO(&fdsetError);\n-        SOCKET hSocketMax = 0;\n-        bool have_fds = false;\n-\n-        for (const ListenSocket& hListenSocket : vhListenSocket) {\n-            FD_SET(hListenSocket.socket, &fdsetRecv);\n-            hSocketMax = std::max(hSocketMax, hListenSocket.socket);\n-            have_fds = true;\n+        else if (pnode->nPingNonceSent && pnode->nPingUsecStart + TIMEOUT_INTERVAL * 1000000 < GetTimeMicros())\n+        {\n+            LogPrintf(\"ping timeout: %fs\\n\", 0.000001 * (GetTimeMicros() - pnode->nPingUsecStart));\n+            pnode->fDisconnect = true;\n         }\n+        else if (!pnode->fSuccessfullyConnected)\n+        {\n+            LogPrint(BCLog::NET, \"version handshake timeout from %d\\n\", pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+    }\n+}\n \n+void CConnman::GenerateSelectSet(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    for (const ListenSocket& hListenSocket : vhListenSocket) {\n+        recv_set.insert(hListenSocket.socket);\n+    }\n+\n+    {\n+        LOCK(cs_vNodes);\n+        for (CNode* pnode : vNodes)\n         {\n-            LOCK(cs_vNodes);\n-            for (CNode* pnode : vNodes)\n+            // Implement the following logic:\n+            // * If there is data to send, select() for sending data. As this only\n+            //   happens when optimistic write failed, we choose to first drain the\n+            //   write buffer in this case before receiving more. This avoids\n+            //   needlessly queueing received data, if the remote peer is not themselves\n+            //   receiving data. This means properly utilizing TCP flow control signalling.\n+            // * Otherwise, if there is space left in the receive buffer, select() for\n+            //   receiving data.\n+            // * Hand off all complete messages to the processor, to be handled without\n+            //   blocking here.\n+\n+            bool select_recv = !pnode->fPauseRecv;\n+            bool select_send;\n             {\n-                // Implement the following logic:\n-                // * If there is data to send, select() for sending data. As this only\n-                //   happens when optimistic write failed, we choose to first drain the\n-                //   write buffer in this case before receiving more. This avoids\n-                //   needlessly queueing received data, if the remote peer is not themselves\n-                //   receiving data. This means properly utilizing TCP flow control signalling.\n-                // * Otherwise, if there is space left in the receive buffer, select() for\n-                //   receiving data.\n-                // * Hand off all complete messages to the processor, to be handled without\n-                //   blocking here.\n-\n-                bool select_recv = !pnode->fPauseRecv;\n-                bool select_send;\n-                {\n-                    LOCK(pnode->cs_vSend);\n-                    select_send = !pnode->vSendMsg.empty();\n-                }\n-\n-                LOCK(pnode->cs_hSocket);\n-                if (pnode->hSocket == INVALID_SOCKET)\n-                    continue;\n+                LOCK(pnode->cs_vSend);\n+                select_send = !pnode->vSendMsg.empty();\n+            }\n \n-                FD_SET(pnode->hSocket, &fdsetError);\n-                hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-                have_fds = true;\n+            LOCK(pnode->cs_hSocket);\n+            if (pnode->hSocket == INVALID_SOCKET)\n+                continue;\n \n-                if (select_send) {\n-                    FD_SET(pnode->hSocket, &fdsetSend);\n-                    continue;\n-                }\n-                if (select_recv) {\n-                    FD_SET(pnode->hSocket, &fdsetRecv);\n-                }\n+            error_set.insert(pnode->hSocket);\n+            if (select_send) {\n+                send_set.insert(pnode->hSocket);\n+                continue;\n+            }\n+            if (select_recv) {\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n+    }\n+}\n \n-        int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                             &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n-        if (interruptNet)\n+#ifdef WIN32\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    //\n+    // Find which sockets have data to receive\n+    //\n+    struct timeval timeout;\n+    timeout.tv_sec  = 0;\n+    timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n+\n+    fd_set fdsetRecv;\n+    fd_set fdsetSend;\n+    fd_set fdsetError;\n+    FD_ZERO(&fdsetRecv);\n+    FD_ZERO(&fdsetSend);\n+    FD_ZERO(&fdsetError);\n+    SOCKET hSocketMax = 0;\n+\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        FD_SET(hSocket, &fdsetRecv);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        FD_SET(hSocket, &fdsetSend);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        FD_SET(hSocket, &fdsetError);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    int nSelect = select(hSocketMax + 1, &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+\n+    if (nSelect == SOCKET_ERROR)\n+    {\n+        int nErr = WSAGetLastError();\n+        LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n+        for (unsigned int i = 0; i <= hSocketMax; i++)\n+            FD_SET(i, &fdsetRecv);\n+        FD_ZERO(&fdsetSend);\n+        FD_ZERO(&fdsetError);\n+        if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n             return;\n+    }\n \n-        if (nSelect == SOCKET_ERROR)\n-        {\n-            if (have_fds)\n-            {\n-                int nErr = WSAGetLastError();\n-                LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n-                for (unsigned int i = 0; i <= hSocketMax; i++)\n-                    FD_SET(i, &fdsetRecv);\n-            }\n-            FD_ZERO(&fdsetSend);\n-            FD_ZERO(&fdsetError);\n-            if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n-                return;\n-        }\n+    for (SOCKET hSocket : recv_select_set)\n+        if(FD_ISSET(hSocket, &fdsetRecv))\n+            recv_set.insert(hSocket);\n \n-        //\n-        // Accept new connections\n-        //\n-        for (const ListenSocket& hListenSocket : vhListenSocket)\n+    for (SOCKET hSocket : send_select_set)\n+        if(FD_ISSET(hSocket, &fdsetSend))\n+            send_set.insert(hSocket);\n+\n+    for (SOCKET hSocket : error_select_set)\n+        if(FD_ISSET(hSocket, &fdsetError))\n+            error_set.insert(hSocket);\n+}\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() and error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n+    if (interruptNet)\n+        return;\n+\n+    std::vector<struct pollfd> pollfds;\n+    struct pollfd pollfd;\n+    memset(&pollfd, 0, sizeof(struct pollfd));",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 370,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "in_reply_to_id": null,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`struct pollfd pollfd = {}` instead of `memset`?",
      "created_at": "2018-09-29T07:18:27Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r221419247",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221419247"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221419285",
      "pull_request_review_id": 160070469,
      "id": 221419285,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQxOTI4NQ==",
      "diff_hunk": "@@ -1153,310 +1153,407 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\n     }\n }\n \n-void CConnman::ThreadSocketHandler()\n+void CConnman::DisconnectNodes()\n {\n-    unsigned int nPrevNodeCount = 0;\n-    while (!interruptNet)\n     {\n-        //\n-        // Disconnect nodes\n-        //\n-        {\n-            LOCK(cs_vNodes);\n+        LOCK(cs_vNodes);\n \n-            if (!fNetworkActive) {\n-                // Disconnect any connected nodes\n-                for (CNode* pnode : vNodes) {\n-                    if (!pnode->fDisconnect) {\n-                        LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n-                        pnode->fDisconnect = true;\n-                    }\n+        if (!fNetworkActive) {\n+            // Disconnect any connected nodes\n+            for (CNode* pnode : vNodes) {\n+                if (!pnode->fDisconnect) {\n+                    LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n+                    pnode->fDisconnect = true;\n                 }\n             }\n+        }\n \n-            // Disconnect unused nodes\n-            std::vector<CNode*> vNodesCopy = vNodes;\n-            for (CNode* pnode : vNodesCopy)\n+        // Disconnect unused nodes\n+        std::vector<CNode*> vNodesCopy = vNodes;\n+        for (CNode* pnode : vNodesCopy)\n+        {\n+            if (pnode->fDisconnect)\n             {\n-                if (pnode->fDisconnect)\n-                {\n-                    // remove from vNodes\n-                    vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n+                // remove from vNodes\n+                vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n \n-                    // release outbound grant (if any)\n-                    pnode->grantOutbound.Release();\n+                // release outbound grant (if any)\n+                pnode->grantOutbound.Release();\n \n-                    // close socket and cleanup\n-                    pnode->CloseSocketDisconnect();\n+                // close socket and cleanup\n+                pnode->CloseSocketDisconnect();\n \n-                    // hold in disconnected pool until all refs are released\n-                    pnode->Release();\n-                    vNodesDisconnected.push_back(pnode);\n-                }\n+                // hold in disconnected pool until all refs are released\n+                pnode->Release();\n+                vNodesDisconnected.push_back(pnode);\n             }\n         }\n+    }\n+    {\n+        // Delete disconnected nodes\n+        std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n+        for (CNode* pnode : vNodesDisconnectedCopy)\n         {\n-            // Delete disconnected nodes\n-            std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n-            for (CNode* pnode : vNodesDisconnectedCopy)\n-            {\n-                // wait until threads are done using it\n-                if (pnode->GetRefCount() <= 0) {\n-                    bool fDelete = false;\n-                    {\n-                        TRY_LOCK(pnode->cs_inventory, lockInv);\n-                        if (lockInv) {\n-                            TRY_LOCK(pnode->cs_vSend, lockSend);\n-                            if (lockSend) {\n-                                fDelete = true;\n-                            }\n+            // wait until threads are done using it\n+            if (pnode->GetRefCount() <= 0) {\n+                bool fDelete = false;\n+                {\n+                    TRY_LOCK(pnode->cs_inventory, lockInv);\n+                    if (lockInv) {\n+                        TRY_LOCK(pnode->cs_vSend, lockSend);\n+                        if (lockSend) {\n+                            fDelete = true;\n                         }\n                     }\n-                    if (fDelete) {\n-                        vNodesDisconnected.remove(pnode);\n-                        DeleteNode(pnode);\n-                    }\n+                }\n+                if (fDelete) {\n+                    vNodesDisconnected.remove(pnode);\n+                    DeleteNode(pnode);\n                 }\n             }\n         }\n-        size_t vNodesSize;\n+    }\n+}\n+\n+void CConnman::NotifyNumConnectionsChanged()\n+{\n+    size_t vNodesSize;\n+    {\n+        LOCK(cs_vNodes);\n+        vNodesSize = vNodes.size();\n+    }\n+    if(vNodesSize != nPrevNodeCount) {\n+        nPrevNodeCount = vNodesSize;\n+        if(clientInterface)\n+            clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+    }\n+}\n+\n+void CConnman::InactivityCheck(CNode *pnode)\n+{\n+    int64_t nTime = GetSystemTimeInSeconds();\n+    if (nTime - pnode->nTimeConnected > 60)\n+    {\n+        if (pnode->nLastRecv == 0 || pnode->nLastSend == 0)\n+        {\n+            LogPrint(BCLog::NET, \"socket no message in first 60 seconds, %d %d from %d\\n\", pnode->nLastRecv != 0, pnode->nLastSend != 0, pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+        else if (nTime - pnode->nLastSend > TIMEOUT_INTERVAL)\n         {\n-            LOCK(cs_vNodes);\n-            vNodesSize = vNodes.size();\n+            LogPrintf(\"socket sending timeout: %is\\n\", nTime - pnode->nLastSend);\n+            pnode->fDisconnect = true;\n         }\n-        if(vNodesSize != nPrevNodeCount) {\n-            nPrevNodeCount = vNodesSize;\n-            if(clientInterface)\n-                clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+        else if (nTime - pnode->nLastRecv > (pnode->nVersion > BIP0031_VERSION ? TIMEOUT_INTERVAL : 90*60))\n+        {\n+            LogPrintf(\"socket receive timeout: %is\\n\", nTime - pnode->nLastRecv);\n+            pnode->fDisconnect = true;\n         }\n-\n-        //\n-        // Find which sockets have data to receive\n-        //\n-        struct timeval timeout;\n-        timeout.tv_sec  = 0;\n-        timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n-\n-        fd_set fdsetRecv;\n-        fd_set fdsetSend;\n-        fd_set fdsetError;\n-        FD_ZERO(&fdsetRecv);\n-        FD_ZERO(&fdsetSend);\n-        FD_ZERO(&fdsetError);\n-        SOCKET hSocketMax = 0;\n-        bool have_fds = false;\n-\n-        for (const ListenSocket& hListenSocket : vhListenSocket) {\n-            FD_SET(hListenSocket.socket, &fdsetRecv);\n-            hSocketMax = std::max(hSocketMax, hListenSocket.socket);\n-            have_fds = true;\n+        else if (pnode->nPingNonceSent && pnode->nPingUsecStart + TIMEOUT_INTERVAL * 1000000 < GetTimeMicros())\n+        {\n+            LogPrintf(\"ping timeout: %fs\\n\", 0.000001 * (GetTimeMicros() - pnode->nPingUsecStart));\n+            pnode->fDisconnect = true;\n         }\n+        else if (!pnode->fSuccessfullyConnected)\n+        {\n+            LogPrint(BCLog::NET, \"version handshake timeout from %d\\n\", pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+    }\n+}\n \n+void CConnman::GenerateSelectSet(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    for (const ListenSocket& hListenSocket : vhListenSocket) {\n+        recv_set.insert(hListenSocket.socket);\n+    }\n+\n+    {\n+        LOCK(cs_vNodes);\n+        for (CNode* pnode : vNodes)\n         {\n-            LOCK(cs_vNodes);\n-            for (CNode* pnode : vNodes)\n+            // Implement the following logic:\n+            // * If there is data to send, select() for sending data. As this only\n+            //   happens when optimistic write failed, we choose to first drain the\n+            //   write buffer in this case before receiving more. This avoids\n+            //   needlessly queueing received data, if the remote peer is not themselves\n+            //   receiving data. This means properly utilizing TCP flow control signalling.\n+            // * Otherwise, if there is space left in the receive buffer, select() for\n+            //   receiving data.\n+            // * Hand off all complete messages to the processor, to be handled without\n+            //   blocking here.\n+\n+            bool select_recv = !pnode->fPauseRecv;\n+            bool select_send;\n             {\n-                // Implement the following logic:\n-                // * If there is data to send, select() for sending data. As this only\n-                //   happens when optimistic write failed, we choose to first drain the\n-                //   write buffer in this case before receiving more. This avoids\n-                //   needlessly queueing received data, if the remote peer is not themselves\n-                //   receiving data. This means properly utilizing TCP flow control signalling.\n-                // * Otherwise, if there is space left in the receive buffer, select() for\n-                //   receiving data.\n-                // * Hand off all complete messages to the processor, to be handled without\n-                //   blocking here.\n-\n-                bool select_recv = !pnode->fPauseRecv;\n-                bool select_send;\n-                {\n-                    LOCK(pnode->cs_vSend);\n-                    select_send = !pnode->vSendMsg.empty();\n-                }\n-\n-                LOCK(pnode->cs_hSocket);\n-                if (pnode->hSocket == INVALID_SOCKET)\n-                    continue;\n+                LOCK(pnode->cs_vSend);\n+                select_send = !pnode->vSendMsg.empty();\n+            }\n \n-                FD_SET(pnode->hSocket, &fdsetError);\n-                hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-                have_fds = true;\n+            LOCK(pnode->cs_hSocket);\n+            if (pnode->hSocket == INVALID_SOCKET)\n+                continue;\n \n-                if (select_send) {\n-                    FD_SET(pnode->hSocket, &fdsetSend);\n-                    continue;\n-                }\n-                if (select_recv) {\n-                    FD_SET(pnode->hSocket, &fdsetRecv);\n-                }\n+            error_set.insert(pnode->hSocket);\n+            if (select_send) {\n+                send_set.insert(pnode->hSocket);\n+                continue;\n+            }\n+            if (select_recv) {\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n+    }\n+}\n \n-        int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                             &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n-        if (interruptNet)\n+#ifdef WIN32\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    //\n+    // Find which sockets have data to receive\n+    //\n+    struct timeval timeout;\n+    timeout.tv_sec  = 0;\n+    timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n+\n+    fd_set fdsetRecv;\n+    fd_set fdsetSend;\n+    fd_set fdsetError;\n+    FD_ZERO(&fdsetRecv);\n+    FD_ZERO(&fdsetSend);\n+    FD_ZERO(&fdsetError);\n+    SOCKET hSocketMax = 0;\n+\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        FD_SET(hSocket, &fdsetRecv);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        FD_SET(hSocket, &fdsetSend);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        FD_SET(hSocket, &fdsetError);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    int nSelect = select(hSocketMax + 1, &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+\n+    if (nSelect == SOCKET_ERROR)\n+    {\n+        int nErr = WSAGetLastError();\n+        LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n+        for (unsigned int i = 0; i <= hSocketMax; i++)\n+            FD_SET(i, &fdsetRecv);\n+        FD_ZERO(&fdsetSend);\n+        FD_ZERO(&fdsetError);\n+        if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n             return;\n+    }\n \n-        if (nSelect == SOCKET_ERROR)\n-        {\n-            if (have_fds)\n-            {\n-                int nErr = WSAGetLastError();\n-                LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n-                for (unsigned int i = 0; i <= hSocketMax; i++)\n-                    FD_SET(i, &fdsetRecv);\n-            }\n-            FD_ZERO(&fdsetSend);\n-            FD_ZERO(&fdsetError);\n-            if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n-                return;\n-        }\n+    for (SOCKET hSocket : recv_select_set)\n+        if(FD_ISSET(hSocket, &fdsetRecv))\n+            recv_set.insert(hSocket);\n \n-        //\n-        // Accept new connections\n-        //\n-        for (const ListenSocket& hListenSocket : vhListenSocket)\n+    for (SOCKET hSocket : send_select_set)\n+        if(FD_ISSET(hSocket, &fdsetSend))\n+            send_set.insert(hSocket);\n+\n+    for (SOCKET hSocket : error_select_set)\n+        if(FD_ISSET(hSocket, &fdsetError))\n+            error_set.insert(hSocket);\n+}\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() and error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n+    if (interruptNet)\n+        return;\n+\n+    std::vector<struct pollfd> pollfds;\n+    struct pollfd pollfd;\n+    memset(&pollfd, 0, sizeof(struct pollfd));\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLIN;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLOUT;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLERR|POLLHUP;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    if(poll(&pollfds[0], pollfds.size(), 50) < 0)\n+        LogPrint(BCLog::NET, \"poll failure %d %s\\n\", errno, strerror(errno));\n+\n+    for (struct pollfd pollfd : pollfds) {\n+        if (pollfd.revents & POLLIN)\n+            recv_set.insert(pollfd.fd);\n+        if (pollfd.revents & POLLOUT)\n+            send_set.insert(pollfd.fd);\n+        if (pollfd.revents & (POLLERR|POLLHUP))\n+            error_set.insert(pollfd.fd);\n+    }\n+}\n+#endif\n+\n+void CConnman::SocketHandler()\n+{\n+    std::set<SOCKET> recv_set, send_set, error_set;\n+    SocketEvents(recv_set, send_set, error_set);\n+\n+    if (interruptNet)\n+        return;\n+\n+    //\n+    // Accept new connections\n+    //\n+    for (const ListenSocket& hListenSocket : vhListenSocket)\n+    {\n+        if (hListenSocket.socket != INVALID_SOCKET && recv_set.count(hListenSocket.socket))\n         {\n-            if (hListenSocket.socket != INVALID_SOCKET && FD_ISSET(hListenSocket.socket, &fdsetRecv))\n-            {\n-                AcceptConnection(hListenSocket);\n-            }\n+            AcceptConnection(hListenSocket);\n         }\n+    }\n+\n+    //\n+    // Service each socket\n+    //\n+    std::vector<CNode*> vNodesCopy;\n+    {\n+        LOCK(cs_vNodes);\n+        vNodesCopy = vNodes;\n+        for (CNode* pnode : vNodesCopy)\n+            pnode->AddRef();\n+    }\n+    for (CNode* pnode : vNodesCopy)\n+    {\n+        if (interruptNet)\n+            return;\n \n         //\n-        // Service each socket\n+        // Receive\n         //\n-        std::vector<CNode*> vNodesCopy;\n+        bool recvSet = false;\n+        bool sendSet = false;\n+        bool errorSet = false;\n         {\n-            LOCK(cs_vNodes);\n-            vNodesCopy = vNodes;\n-            for (CNode* pnode : vNodesCopy)\n-                pnode->AddRef();\n+            LOCK(pnode->cs_hSocket);\n+            if (pnode->hSocket == INVALID_SOCKET)\n+                continue;\n+            recvSet = recv_set.count(pnode->hSocket);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 458,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "in_reply_to_id": null,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`recvSet = recv_set.count(pnode->hSocket) > 0` to avoid implicit conversion from `unsigned long` to `bool`. Applies also to the following to lines. Explicit is better than implicit :-)",
      "created_at": "2018-09-29T07:20:21Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r221419285",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221419285"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1470,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221419345",
      "pull_request_review_id": 160070544,
      "id": 221419345,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQxOTM0NQ==",
      "diff_hunk": "@@ -1153,310 +1153,407 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\n     }\n }\n \n-void CConnman::ThreadSocketHandler()\n+void CConnman::DisconnectNodes()\n {\n-    unsigned int nPrevNodeCount = 0;\n-    while (!interruptNet)\n     {\n-        //\n-        // Disconnect nodes\n-        //\n-        {\n-            LOCK(cs_vNodes);\n+        LOCK(cs_vNodes);\n \n-            if (!fNetworkActive) {\n-                // Disconnect any connected nodes\n-                for (CNode* pnode : vNodes) {\n-                    if (!pnode->fDisconnect) {\n-                        LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n-                        pnode->fDisconnect = true;\n-                    }\n+        if (!fNetworkActive) {\n+            // Disconnect any connected nodes\n+            for (CNode* pnode : vNodes) {\n+                if (!pnode->fDisconnect) {\n+                    LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n+                    pnode->fDisconnect = true;\n                 }\n             }\n+        }\n \n-            // Disconnect unused nodes\n-            std::vector<CNode*> vNodesCopy = vNodes;\n-            for (CNode* pnode : vNodesCopy)\n+        // Disconnect unused nodes\n+        std::vector<CNode*> vNodesCopy = vNodes;\n+        for (CNode* pnode : vNodesCopy)\n+        {\n+            if (pnode->fDisconnect)\n             {\n-                if (pnode->fDisconnect)\n-                {\n-                    // remove from vNodes\n-                    vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n+                // remove from vNodes\n+                vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n \n-                    // release outbound grant (if any)\n-                    pnode->grantOutbound.Release();\n+                // release outbound grant (if any)\n+                pnode->grantOutbound.Release();\n \n-                    // close socket and cleanup\n-                    pnode->CloseSocketDisconnect();\n+                // close socket and cleanup\n+                pnode->CloseSocketDisconnect();\n \n-                    // hold in disconnected pool until all refs are released\n-                    pnode->Release();\n-                    vNodesDisconnected.push_back(pnode);\n-                }\n+                // hold in disconnected pool until all refs are released\n+                pnode->Release();\n+                vNodesDisconnected.push_back(pnode);\n             }\n         }\n+    }\n+    {\n+        // Delete disconnected nodes\n+        std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n+        for (CNode* pnode : vNodesDisconnectedCopy)\n         {\n-            // Delete disconnected nodes\n-            std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n-            for (CNode* pnode : vNodesDisconnectedCopy)\n-            {\n-                // wait until threads are done using it\n-                if (pnode->GetRefCount() <= 0) {\n-                    bool fDelete = false;\n-                    {\n-                        TRY_LOCK(pnode->cs_inventory, lockInv);\n-                        if (lockInv) {\n-                            TRY_LOCK(pnode->cs_vSend, lockSend);\n-                            if (lockSend) {\n-                                fDelete = true;\n-                            }\n+            // wait until threads are done using it\n+            if (pnode->GetRefCount() <= 0) {\n+                bool fDelete = false;\n+                {\n+                    TRY_LOCK(pnode->cs_inventory, lockInv);\n+                    if (lockInv) {\n+                        TRY_LOCK(pnode->cs_vSend, lockSend);\n+                        if (lockSend) {\n+                            fDelete = true;\n                         }\n                     }\n-                    if (fDelete) {\n-                        vNodesDisconnected.remove(pnode);\n-                        DeleteNode(pnode);\n-                    }\n+                }\n+                if (fDelete) {\n+                    vNodesDisconnected.remove(pnode);\n+                    DeleteNode(pnode);\n                 }\n             }\n         }\n-        size_t vNodesSize;\n+    }\n+}\n+\n+void CConnman::NotifyNumConnectionsChanged()\n+{\n+    size_t vNodesSize;\n+    {\n+        LOCK(cs_vNodes);\n+        vNodesSize = vNodes.size();\n+    }\n+    if(vNodesSize != nPrevNodeCount) {\n+        nPrevNodeCount = vNodesSize;\n+        if(clientInterface)\n+            clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+    }\n+}\n+\n+void CConnman::InactivityCheck(CNode *pnode)\n+{\n+    int64_t nTime = GetSystemTimeInSeconds();\n+    if (nTime - pnode->nTimeConnected > 60)\n+    {\n+        if (pnode->nLastRecv == 0 || pnode->nLastSend == 0)\n+        {\n+            LogPrint(BCLog::NET, \"socket no message in first 60 seconds, %d %d from %d\\n\", pnode->nLastRecv != 0, pnode->nLastSend != 0, pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+        else if (nTime - pnode->nLastSend > TIMEOUT_INTERVAL)\n         {\n-            LOCK(cs_vNodes);\n-            vNodesSize = vNodes.size();\n+            LogPrintf(\"socket sending timeout: %is\\n\", nTime - pnode->nLastSend);\n+            pnode->fDisconnect = true;\n         }\n-        if(vNodesSize != nPrevNodeCount) {\n-            nPrevNodeCount = vNodesSize;\n-            if(clientInterface)\n-                clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+        else if (nTime - pnode->nLastRecv > (pnode->nVersion > BIP0031_VERSION ? TIMEOUT_INTERVAL : 90*60))\n+        {\n+            LogPrintf(\"socket receive timeout: %is\\n\", nTime - pnode->nLastRecv);\n+            pnode->fDisconnect = true;\n         }\n-\n-        //\n-        // Find which sockets have data to receive\n-        //\n-        struct timeval timeout;\n-        timeout.tv_sec  = 0;\n-        timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n-\n-        fd_set fdsetRecv;\n-        fd_set fdsetSend;\n-        fd_set fdsetError;\n-        FD_ZERO(&fdsetRecv);\n-        FD_ZERO(&fdsetSend);\n-        FD_ZERO(&fdsetError);\n-        SOCKET hSocketMax = 0;\n-        bool have_fds = false;\n-\n-        for (const ListenSocket& hListenSocket : vhListenSocket) {\n-            FD_SET(hListenSocket.socket, &fdsetRecv);\n-            hSocketMax = std::max(hSocketMax, hListenSocket.socket);\n-            have_fds = true;\n+        else if (pnode->nPingNonceSent && pnode->nPingUsecStart + TIMEOUT_INTERVAL * 1000000 < GetTimeMicros())\n+        {\n+            LogPrintf(\"ping timeout: %fs\\n\", 0.000001 * (GetTimeMicros() - pnode->nPingUsecStart));\n+            pnode->fDisconnect = true;\n         }\n+        else if (!pnode->fSuccessfullyConnected)\n+        {\n+            LogPrint(BCLog::NET, \"version handshake timeout from %d\\n\", pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+    }\n+}\n \n+void CConnman::GenerateSelectSet(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    for (const ListenSocket& hListenSocket : vhListenSocket) {\n+        recv_set.insert(hListenSocket.socket);\n+    }\n+\n+    {\n+        LOCK(cs_vNodes);\n+        for (CNode* pnode : vNodes)\n         {\n-            LOCK(cs_vNodes);\n-            for (CNode* pnode : vNodes)\n+            // Implement the following logic:\n+            // * If there is data to send, select() for sending data. As this only\n+            //   happens when optimistic write failed, we choose to first drain the\n+            //   write buffer in this case before receiving more. This avoids\n+            //   needlessly queueing received data, if the remote peer is not themselves\n+            //   receiving data. This means properly utilizing TCP flow control signalling.\n+            // * Otherwise, if there is space left in the receive buffer, select() for\n+            //   receiving data.\n+            // * Hand off all complete messages to the processor, to be handled without\n+            //   blocking here.\n+\n+            bool select_recv = !pnode->fPauseRecv;\n+            bool select_send;\n             {\n-                // Implement the following logic:\n-                // * If there is data to send, select() for sending data. As this only\n-                //   happens when optimistic write failed, we choose to first drain the\n-                //   write buffer in this case before receiving more. This avoids\n-                //   needlessly queueing received data, if the remote peer is not themselves\n-                //   receiving data. This means properly utilizing TCP flow control signalling.\n-                // * Otherwise, if there is space left in the receive buffer, select() for\n-                //   receiving data.\n-                // * Hand off all complete messages to the processor, to be handled without\n-                //   blocking here.\n-\n-                bool select_recv = !pnode->fPauseRecv;\n-                bool select_send;\n-                {\n-                    LOCK(pnode->cs_vSend);\n-                    select_send = !pnode->vSendMsg.empty();\n-                }\n-\n-                LOCK(pnode->cs_hSocket);\n-                if (pnode->hSocket == INVALID_SOCKET)\n-                    continue;\n+                LOCK(pnode->cs_vSend);\n+                select_send = !pnode->vSendMsg.empty();\n+            }\n \n-                FD_SET(pnode->hSocket, &fdsetError);\n-                hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-                have_fds = true;\n+            LOCK(pnode->cs_hSocket);\n+            if (pnode->hSocket == INVALID_SOCKET)\n+                continue;\n \n-                if (select_send) {\n-                    FD_SET(pnode->hSocket, &fdsetSend);\n-                    continue;\n-                }\n-                if (select_recv) {\n-                    FD_SET(pnode->hSocket, &fdsetRecv);\n-                }\n+            error_set.insert(pnode->hSocket);\n+            if (select_send) {\n+                send_set.insert(pnode->hSocket);\n+                continue;\n+            }\n+            if (select_recv) {\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n+    }\n+}\n \n-        int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                             &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n-        if (interruptNet)\n+#ifdef WIN32\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    //\n+    // Find which sockets have data to receive\n+    //\n+    struct timeval timeout;\n+    timeout.tv_sec  = 0;\n+    timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n+\n+    fd_set fdsetRecv;\n+    fd_set fdsetSend;\n+    fd_set fdsetError;\n+    FD_ZERO(&fdsetRecv);\n+    FD_ZERO(&fdsetSend);\n+    FD_ZERO(&fdsetError);\n+    SOCKET hSocketMax = 0;\n+\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        FD_SET(hSocket, &fdsetRecv);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        FD_SET(hSocket, &fdsetSend);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        FD_SET(hSocket, &fdsetError);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    int nSelect = select(hSocketMax + 1, &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+\n+    if (nSelect == SOCKET_ERROR)\n+    {\n+        int nErr = WSAGetLastError();\n+        LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n+        for (unsigned int i = 0; i <= hSocketMax; i++)\n+            FD_SET(i, &fdsetRecv);\n+        FD_ZERO(&fdsetSend);\n+        FD_ZERO(&fdsetError);\n+        if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n             return;\n+    }\n \n-        if (nSelect == SOCKET_ERROR)\n-        {\n-            if (have_fds)\n-            {\n-                int nErr = WSAGetLastError();\n-                LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n-                for (unsigned int i = 0; i <= hSocketMax; i++)\n-                    FD_SET(i, &fdsetRecv);\n-            }\n-            FD_ZERO(&fdsetSend);\n-            FD_ZERO(&fdsetError);\n-            if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n-                return;\n-        }\n+    for (SOCKET hSocket : recv_select_set)\n+        if(FD_ISSET(hSocket, &fdsetRecv))\n+            recv_set.insert(hSocket);\n \n-        //\n-        // Accept new connections\n-        //\n-        for (const ListenSocket& hListenSocket : vhListenSocket)\n+    for (SOCKET hSocket : send_select_set)\n+        if(FD_ISSET(hSocket, &fdsetSend))\n+            send_set.insert(hSocket);\n+\n+    for (SOCKET hSocket : error_select_set)\n+        if(FD_ISSET(hSocket, &fdsetError))\n+            error_set.insert(hSocket);\n+}\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() and error_select_set.empty()) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 360,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "in_reply_to_id": null,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Use `&&` instead of `and` :-)",
      "created_at": "2018-09-29T07:22:12Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r221419345",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221419345"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1382,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221419392",
      "pull_request_review_id": 160070594,
      "id": 221419392,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQxOTM5Mg==",
      "diff_hunk": "@@ -1153,310 +1153,407 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\n     }\n }\n \n-void CConnman::ThreadSocketHandler()\n+void CConnman::DisconnectNodes()\n {\n-    unsigned int nPrevNodeCount = 0;\n-    while (!interruptNet)\n     {\n-        //\n-        // Disconnect nodes\n-        //\n-        {\n-            LOCK(cs_vNodes);\n+        LOCK(cs_vNodes);\n \n-            if (!fNetworkActive) {\n-                // Disconnect any connected nodes\n-                for (CNode* pnode : vNodes) {\n-                    if (!pnode->fDisconnect) {\n-                        LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n-                        pnode->fDisconnect = true;\n-                    }\n+        if (!fNetworkActive) {\n+            // Disconnect any connected nodes\n+            for (CNode* pnode : vNodes) {\n+                if (!pnode->fDisconnect) {\n+                    LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n+                    pnode->fDisconnect = true;\n                 }\n             }\n+        }\n \n-            // Disconnect unused nodes\n-            std::vector<CNode*> vNodesCopy = vNodes;\n-            for (CNode* pnode : vNodesCopy)\n+        // Disconnect unused nodes\n+        std::vector<CNode*> vNodesCopy = vNodes;\n+        for (CNode* pnode : vNodesCopy)\n+        {\n+            if (pnode->fDisconnect)\n             {\n-                if (pnode->fDisconnect)\n-                {\n-                    // remove from vNodes\n-                    vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n+                // remove from vNodes\n+                vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n \n-                    // release outbound grant (if any)\n-                    pnode->grantOutbound.Release();\n+                // release outbound grant (if any)\n+                pnode->grantOutbound.Release();\n \n-                    // close socket and cleanup\n-                    pnode->CloseSocketDisconnect();\n+                // close socket and cleanup\n+                pnode->CloseSocketDisconnect();\n \n-                    // hold in disconnected pool until all refs are released\n-                    pnode->Release();\n-                    vNodesDisconnected.push_back(pnode);\n-                }\n+                // hold in disconnected pool until all refs are released\n+                pnode->Release();\n+                vNodesDisconnected.push_back(pnode);\n             }\n         }\n+    }\n+    {\n+        // Delete disconnected nodes\n+        std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n+        for (CNode* pnode : vNodesDisconnectedCopy)\n         {\n-            // Delete disconnected nodes\n-            std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n-            for (CNode* pnode : vNodesDisconnectedCopy)\n-            {\n-                // wait until threads are done using it\n-                if (pnode->GetRefCount() <= 0) {\n-                    bool fDelete = false;\n-                    {\n-                        TRY_LOCK(pnode->cs_inventory, lockInv);\n-                        if (lockInv) {\n-                            TRY_LOCK(pnode->cs_vSend, lockSend);\n-                            if (lockSend) {\n-                                fDelete = true;\n-                            }\n+            // wait until threads are done using it\n+            if (pnode->GetRefCount() <= 0) {\n+                bool fDelete = false;\n+                {\n+                    TRY_LOCK(pnode->cs_inventory, lockInv);\n+                    if (lockInv) {\n+                        TRY_LOCK(pnode->cs_vSend, lockSend);\n+                        if (lockSend) {\n+                            fDelete = true;\n                         }\n                     }\n-                    if (fDelete) {\n-                        vNodesDisconnected.remove(pnode);\n-                        DeleteNode(pnode);\n-                    }\n+                }\n+                if (fDelete) {\n+                    vNodesDisconnected.remove(pnode);\n+                    DeleteNode(pnode);\n                 }\n             }\n         }\n-        size_t vNodesSize;\n+    }\n+}\n+\n+void CConnman::NotifyNumConnectionsChanged()\n+{\n+    size_t vNodesSize;\n+    {\n+        LOCK(cs_vNodes);\n+        vNodesSize = vNodes.size();\n+    }\n+    if(vNodesSize != nPrevNodeCount) {\n+        nPrevNodeCount = vNodesSize;\n+        if(clientInterface)\n+            clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+    }\n+}\n+\n+void CConnman::InactivityCheck(CNode *pnode)\n+{\n+    int64_t nTime = GetSystemTimeInSeconds();\n+    if (nTime - pnode->nTimeConnected > 60)\n+    {\n+        if (pnode->nLastRecv == 0 || pnode->nLastSend == 0)\n+        {\n+            LogPrint(BCLog::NET, \"socket no message in first 60 seconds, %d %d from %d\\n\", pnode->nLastRecv != 0, pnode->nLastSend != 0, pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+        else if (nTime - pnode->nLastSend > TIMEOUT_INTERVAL)\n         {\n-            LOCK(cs_vNodes);\n-            vNodesSize = vNodes.size();\n+            LogPrintf(\"socket sending timeout: %is\\n\", nTime - pnode->nLastSend);\n+            pnode->fDisconnect = true;\n         }\n-        if(vNodesSize != nPrevNodeCount) {\n-            nPrevNodeCount = vNodesSize;\n-            if(clientInterface)\n-                clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+        else if (nTime - pnode->nLastRecv > (pnode->nVersion > BIP0031_VERSION ? TIMEOUT_INTERVAL : 90*60))\n+        {\n+            LogPrintf(\"socket receive timeout: %is\\n\", nTime - pnode->nLastRecv);\n+            pnode->fDisconnect = true;\n         }\n-\n-        //\n-        // Find which sockets have data to receive\n-        //\n-        struct timeval timeout;\n-        timeout.tv_sec  = 0;\n-        timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n-\n-        fd_set fdsetRecv;\n-        fd_set fdsetSend;\n-        fd_set fdsetError;\n-        FD_ZERO(&fdsetRecv);\n-        FD_ZERO(&fdsetSend);\n-        FD_ZERO(&fdsetError);\n-        SOCKET hSocketMax = 0;\n-        bool have_fds = false;\n-\n-        for (const ListenSocket& hListenSocket : vhListenSocket) {\n-            FD_SET(hListenSocket.socket, &fdsetRecv);\n-            hSocketMax = std::max(hSocketMax, hListenSocket.socket);\n-            have_fds = true;\n+        else if (pnode->nPingNonceSent && pnode->nPingUsecStart + TIMEOUT_INTERVAL * 1000000 < GetTimeMicros())\n+        {\n+            LogPrintf(\"ping timeout: %fs\\n\", 0.000001 * (GetTimeMicros() - pnode->nPingUsecStart));\n+            pnode->fDisconnect = true;\n         }\n+        else if (!pnode->fSuccessfullyConnected)\n+        {\n+            LogPrint(BCLog::NET, \"version handshake timeout from %d\\n\", pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+    }\n+}\n \n+void CConnman::GenerateSelectSet(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    for (const ListenSocket& hListenSocket : vhListenSocket) {\n+        recv_set.insert(hListenSocket.socket);\n+    }\n+\n+    {\n+        LOCK(cs_vNodes);\n+        for (CNode* pnode : vNodes)\n         {\n-            LOCK(cs_vNodes);\n-            for (CNode* pnode : vNodes)\n+            // Implement the following logic:\n+            // * If there is data to send, select() for sending data. As this only\n+            //   happens when optimistic write failed, we choose to first drain the\n+            //   write buffer in this case before receiving more. This avoids\n+            //   needlessly queueing received data, if the remote peer is not themselves\n+            //   receiving data. This means properly utilizing TCP flow control signalling.\n+            // * Otherwise, if there is space left in the receive buffer, select() for\n+            //   receiving data.\n+            // * Hand off all complete messages to the processor, to be handled without\n+            //   blocking here.\n+\n+            bool select_recv = !pnode->fPauseRecv;\n+            bool select_send;\n             {\n-                // Implement the following logic:\n-                // * If there is data to send, select() for sending data. As this only\n-                //   happens when optimistic write failed, we choose to first drain the\n-                //   write buffer in this case before receiving more. This avoids\n-                //   needlessly queueing received data, if the remote peer is not themselves\n-                //   receiving data. This means properly utilizing TCP flow control signalling.\n-                // * Otherwise, if there is space left in the receive buffer, select() for\n-                //   receiving data.\n-                // * Hand off all complete messages to the processor, to be handled without\n-                //   blocking here.\n-\n-                bool select_recv = !pnode->fPauseRecv;\n-                bool select_send;\n-                {\n-                    LOCK(pnode->cs_vSend);\n-                    select_send = !pnode->vSendMsg.empty();\n-                }\n-\n-                LOCK(pnode->cs_hSocket);\n-                if (pnode->hSocket == INVALID_SOCKET)\n-                    continue;\n+                LOCK(pnode->cs_vSend);\n+                select_send = !pnode->vSendMsg.empty();\n+            }\n \n-                FD_SET(pnode->hSocket, &fdsetError);\n-                hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-                have_fds = true;\n+            LOCK(pnode->cs_hSocket);\n+            if (pnode->hSocket == INVALID_SOCKET)\n+                continue;\n \n-                if (select_send) {\n-                    FD_SET(pnode->hSocket, &fdsetSend);\n-                    continue;\n-                }\n-                if (select_recv) {\n-                    FD_SET(pnode->hSocket, &fdsetRecv);\n-                }\n+            error_set.insert(pnode->hSocket);\n+            if (select_send) {\n+                send_set.insert(pnode->hSocket);\n+                continue;\n+            }\n+            if (select_recv) {\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n+    }\n+}\n \n-        int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                             &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n-        if (interruptNet)\n+#ifdef WIN32\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    //\n+    // Find which sockets have data to receive\n+    //\n+    struct timeval timeout;\n+    timeout.tv_sec  = 0;\n+    timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n+\n+    fd_set fdsetRecv;\n+    fd_set fdsetSend;\n+    fd_set fdsetError;\n+    FD_ZERO(&fdsetRecv);\n+    FD_ZERO(&fdsetSend);\n+    FD_ZERO(&fdsetError);\n+    SOCKET hSocketMax = 0;\n+\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        FD_SET(hSocket, &fdsetRecv);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        FD_SET(hSocket, &fdsetSend);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        FD_SET(hSocket, &fdsetError);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    int nSelect = select(hSocketMax + 1, &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+\n+    if (nSelect == SOCKET_ERROR)\n+    {\n+        int nErr = WSAGetLastError();\n+        LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n+        for (unsigned int i = 0; i <= hSocketMax; i++)\n+            FD_SET(i, &fdsetRecv);\n+        FD_ZERO(&fdsetSend);\n+        FD_ZERO(&fdsetError);\n+        if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n             return;\n+    }\n \n-        if (nSelect == SOCKET_ERROR)\n-        {\n-            if (have_fds)\n-            {\n-                int nErr = WSAGetLastError();\n-                LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n-                for (unsigned int i = 0; i <= hSocketMax; i++)\n-                    FD_SET(i, &fdsetRecv);\n-            }\n-            FD_ZERO(&fdsetSend);\n-            FD_ZERO(&fdsetError);\n-            if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n-                return;\n-        }\n+    for (SOCKET hSocket : recv_select_set)\n+        if(FD_ISSET(hSocket, &fdsetRecv))\n+            recv_set.insert(hSocket);\n \n-        //\n-        // Accept new connections\n-        //\n-        for (const ListenSocket& hListenSocket : vhListenSocket)\n+    for (SOCKET hSocket : send_select_set)\n+        if(FD_ISSET(hSocket, &fdsetSend))\n+            send_set.insert(hSocket);\n+\n+    for (SOCKET hSocket : error_select_set)\n+        if(FD_ISSET(hSocket, &fdsetError))\n+            error_set.insert(hSocket);\n+}\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() and error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n+    if (interruptNet)\n+        return;\n+\n+    std::vector<struct pollfd> pollfds;\n+    struct pollfd pollfd;\n+    memset(&pollfd, 0, sizeof(struct pollfd));\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLIN;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLOUT;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLERR|POLLHUP;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    if(poll(&pollfds[0], pollfds.size(), 50) < 0)\n+        LogPrint(BCLog::NET, \"poll failure %d %s\\n\", errno, strerror(errno));\n+\n+    for (struct pollfd pollfd : pollfds) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 393,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "in_reply_to_id": null,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Use another variable name: `pollfd` shadows the already existing local variable with the same name :-)",
      "created_at": "2018-09-29T07:23:41Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r221419392",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221419392"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1424,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221442419",
      "pull_request_review_id": 160096136,
      "id": 221442419,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQ0MjQxOQ==",
      "diff_hunk": "@@ -1347,8 +1347,6 @@ void CConnman::SocketHandler()\n \n     int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n                          &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n-    if (interruptNet)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "d9ae35592cb978a3aef6baa2ae84500790f99ae9",
      "in_reply_to_id": null,
      "user": {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "~~Move this into `SocketHandler` after the `SocketEvents` call? Or this method cool return a bool, true if it completes, false if it is interrupted.~~\r\n\r\nNOTE: this was fixed in the commit `maybe fix things?`",
      "created_at": "2018-09-29T23:16:43Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r221442419",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221442419"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1326,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221442547",
      "pull_request_review_id": 160096136,
      "id": 221442547,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQ0MjU0Nw==",
      "diff_hunk": "@@ -1375,6 +1376,47 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\n         if(FD_ISSET(hSocket, &fdsetError))\n             error_set.insert(hSocket);\n }\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    std::vector<struct pollfd> pollfds;",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "5ab601601dd1c494abcfb5a71556e99c3f561bc6",
      "in_reply_to_id": null,
      "user": {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`pollfds.reserve(recv_select_set.size() + send_select_set.size() + error_select_set.size())`",
      "created_at": "2018-09-29T23:25:51Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r221442547",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221442547"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1393,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221442558",
      "pull_request_review_id": 160096136,
      "id": 221442558,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQ0MjU1OA==",
      "diff_hunk": "@@ -1375,6 +1376,47 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\n         if(FD_ISSET(hSocket, &fdsetError))\n             error_set.insert(hSocket);\n }\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    std::vector<struct pollfd> pollfds;\n+    struct pollfd pollfd;\n+    memset(&pollfd, 0, sizeof(struct pollfd));\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLIN;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLOUT;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLERR|POLLHUP;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    if(poll(&pollfds[0], pollfds.size(), 50) < 0)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 40,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "5ab601601dd1c494abcfb5a71556e99c3f561bc6",
      "in_reply_to_id": null,
      "user": {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: vectors now have `.data()`, which returns `&pollfds[0]` in a more object-oriented way.",
      "created_at": "2018-09-29T23:26:54Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r221442558",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221442558"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1424,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221442622",
      "pull_request_review_id": 160096136,
      "id": 221442622,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQ0MjYyMg==",
      "diff_hunk": "@@ -1375,6 +1376,47 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\n         if(FD_ISSET(hSocket, &fdsetError))\n             error_set.insert(hSocket);\n }\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    std::vector<struct pollfd> pollfds;\n+    struct pollfd pollfd;\n+    memset(&pollfd, 0, sizeof(struct pollfd));\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLIN;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLOUT;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLERR|POLLHUP;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    if(poll(&pollfds[0], pollfds.size(), 50) < 0)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 40,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "5ab601601dd1c494abcfb5a71556e99c3f561bc6",
      "in_reply_to_id": null,
      "user": {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: Make the 50 a named constant along with `timeout.tv_usec` in the `select` impl.",
      "created_at": "2018-09-29T23:31:14Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r221442622",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221442622"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1424,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221442660",
      "pull_request_review_id": 160096136,
      "id": 221442660,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQ0MjY2MA==",
      "diff_hunk": "@@ -1323,41 +1323,38 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\n     FD_ZERO(&fdsetSend);\n     FD_ZERO(&fdsetError);\n     SOCKET hSocketMax = 0;\n-    bool have_fds = false;\n \n     std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n     GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n \n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 10,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "in_reply_to_id": null,
      "user": {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: Replace 50 with `timeout.tv_usec/1000`",
      "created_at": "2018-09-29T23:34:39Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r221442660",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221442660"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1331,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221442700",
      "pull_request_review_id": 160096136,
      "id": 221442700,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQ0MjcwMA==",
      "diff_hunk": "@@ -1323,41 +1323,38 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\n     FD_ZERO(&fdsetSend);\n     FD_ZERO(&fdsetError);\n     SOCKET hSocketMax = 0;\n-    bool have_fds = false;\n \n     std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n     GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n \n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n     for (SOCKET hSocket : recv_select_set) {\n         FD_SET(hSocket, &fdsetRecv);\n-        have_fds = true;\n         hSocketMax = std::max(hSocketMax, hSocket);\n     }\n \n     for (SOCKET hSocket : send_select_set) {\n         FD_SET(hSocket, &fdsetSend);\n-        have_fds = true;\n         hSocketMax = std::max(hSocketMax, hSocket);\n     }\n \n     for (SOCKET hSocket : error_select_set) {\n         FD_SET(hSocket, &fdsetError);\n-        have_fds = true;\n         hSocketMax = std::max(hSocketMax, hSocket);\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    int nSelect = select(hSocketMax + 1, &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n \n     if (nSelect == SOCKET_ERROR)\n     {\n-        if (have_fds)\n-        {\n-            int nErr = WSAGetLastError();\n-            LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n-            for (unsigned int i = 0; i <= hSocketMax; i++)\n-                FD_SET(i, &fdsetRecv);\n-        }\n+        int nErr = WSAGetLastError();\n+        LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n+        for (unsigned int i = 0; i <= hSocketMax; i++)\n+            FD_SET(i, &fdsetRecv);",
      "path": "src/net.cpp",
      "position": 185,
      "original_position": 48,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "in_reply_to_id": null,
      "user": {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I see this is the same as the code currently, but it seems like this should be `fdsetError` instead of `fdsetRecv`, even though they are handled exactly the same.",
      "created_at": "2018-09-29T23:37:44Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r221442700",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221442700"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1406,
      "original_line": 1406,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221693842",
      "pull_request_review_id": 160405153,
      "id": 221693842,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTY5Mzg0Mg==",
      "diff_hunk": "@@ -1323,41 +1323,38 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\n     FD_ZERO(&fdsetSend);\n     FD_ZERO(&fdsetError);\n     SOCKET hSocketMax = 0;\n-    bool have_fds = false;\n \n     std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n     GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n \n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n     for (SOCKET hSocket : recv_select_set) {\n         FD_SET(hSocket, &fdsetRecv);\n-        have_fds = true;\n         hSocketMax = std::max(hSocketMax, hSocket);\n     }\n \n     for (SOCKET hSocket : send_select_set) {\n         FD_SET(hSocket, &fdsetSend);\n-        have_fds = true;\n         hSocketMax = std::max(hSocketMax, hSocket);\n     }\n \n     for (SOCKET hSocket : error_select_set) {\n         FD_SET(hSocket, &fdsetError);\n-        have_fds = true;\n         hSocketMax = std::max(hSocketMax, hSocket);\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    int nSelect = select(hSocketMax + 1, &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n \n     if (nSelect == SOCKET_ERROR)\n     {\n-        if (have_fds)\n-        {\n-            int nErr = WSAGetLastError();\n-            LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n-            for (unsigned int i = 0; i <= hSocketMax; i++)\n-                FD_SET(i, &fdsetRecv);\n-        }\n+        int nErr = WSAGetLastError();\n+        LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n+        for (unsigned int i = 0; i <= hSocketMax; i++)\n+            FD_SET(i, &fdsetRecv);",
      "path": "src/net.cpp",
      "position": 185,
      "original_position": 48,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "in_reply_to_id": 221442700,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't think it should be there at all really. select() failures dont mean the sockets themselves have failed, but i guess it could mean we made a mistake and called select() with a closed socket?",
      "created_at": "2018-10-01T17:35:12Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r221693842",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221693842"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1406,
      "original_line": 1406,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/222124763",
      "pull_request_review_id": 160939346,
      "id": 222124763,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMjEyNDc2Mw==",
      "diff_hunk": "@@ -1323,41 +1323,38 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\n     FD_ZERO(&fdsetSend);\n     FD_ZERO(&fdsetError);\n     SOCKET hSocketMax = 0;\n-    bool have_fds = false;\n \n     std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n     GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n \n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n     for (SOCKET hSocket : recv_select_set) {\n         FD_SET(hSocket, &fdsetRecv);\n-        have_fds = true;\n         hSocketMax = std::max(hSocketMax, hSocket);\n     }\n \n     for (SOCKET hSocket : send_select_set) {\n         FD_SET(hSocket, &fdsetSend);\n-        have_fds = true;\n         hSocketMax = std::max(hSocketMax, hSocket);\n     }\n \n     for (SOCKET hSocket : error_select_set) {\n         FD_SET(hSocket, &fdsetError);\n-        have_fds = true;\n         hSocketMax = std::max(hSocketMax, hSocket);\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    int nSelect = select(hSocketMax + 1, &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n \n     if (nSelect == SOCKET_ERROR)\n     {\n-        if (have_fds)\n-        {\n-            int nErr = WSAGetLastError();\n-            LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n-            for (unsigned int i = 0; i <= hSocketMax; i++)\n-                FD_SET(i, &fdsetRecv);\n-        }\n+        int nErr = WSAGetLastError();\n+        LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n+        for (unsigned int i = 0; i <= hSocketMax; i++)\n+            FD_SET(i, &fdsetRecv);",
      "path": "src/net.cpp",
      "position": 185,
      "original_position": 48,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "in_reply_to_id": 221442700,
      "user": {
        "login": "jimpo",
        "id": 881253,
        "node_id": "MDQ6VXNlcjg4MTI1Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jimpo",
        "html_url": "https://github.com/jimpo",
        "followers_url": "https://api.github.com/users/jimpo/followers",
        "following_url": "https://api.github.com/users/jimpo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jimpo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jimpo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
        "organizations_url": "https://api.github.com/users/jimpo/orgs",
        "repos_url": "https://api.github.com/users/jimpo/repos",
        "events_url": "https://api.github.com/users/jimpo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jimpo/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yeah, then iterating through each one and calling `recv` would identify which peer to disconnect. Though, if it's `fdsetError` and not `fdsetRecv`, it probably shouldn't disconnect when `nBytes == 0`.",
      "created_at": "2018-10-02T21:53:28Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r222124763",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/222124763"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1406,
      "original_line": 1406,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225690949",
      "pull_request_review_id": 165345973,
      "id": 225690949,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTY5MDk0OQ==",
      "diff_hunk": "@@ -1377,6 +1378,58 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\n         if(FD_ISSET(hSocket, &fdsetError))\n             error_set.insert(hSocket);\n }\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "5f99a7861c44e7f86292a06c1f9c97dac30b7161",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Could be worth having `GenerateSelectSet` return a bool that indicates whether or not the sets have any content so that we can avoid the `.empty()` checks below (and the repetition necessary for the legacy `select` impl).",
      "created_at": "2018-10-16T20:10:44Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r225690949",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225690949"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1386,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225691877",
      "pull_request_review_id": 165345973,
      "id": 225691877,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTY5MTg3Nw==",
      "diff_hunk": "@@ -1377,6 +1378,58 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\n         if(FD_ISSET(hSocket, &fdsetError))\n             error_set.insert(hSocket);\n }\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::vector<struct pollfd> pollfds;\n+    pollfds.reserve(recv_select_set.size() + send_select_set.size() + error_select_set.size());\n+\n+    {\n+        struct pollfd pollfd = {};\n+\n+        for (SOCKET hSocket : recv_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLIN;\n+            pollfds.push_back(pollfd);\n+        }\n+\n+        for (SOCKET hSocket : send_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLOUT;\n+            pollfds.push_back(pollfd);\n+        }\n+\n+        for (SOCKET hSocket : error_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLERR|POLLHUP;",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "5f99a7861c44e7f86292a06c1f9c97dac30b7161",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is ignored and reported on `revents` in any case, no? I guess no harm in being explicit.",
      "created_at": "2018-10-16T20:13:57Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r225691877",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225691877"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225693517",
      "pull_request_review_id": 165345973,
      "id": 225693517,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTY5MzUxNw==",
      "diff_hunk": "@@ -1377,6 +1378,58 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\n         if(FD_ISSET(hSocket, &fdsetError))\n             error_set.insert(hSocket);\n }\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::vector<struct pollfd> pollfds;\n+    pollfds.reserve(recv_select_set.size() + send_select_set.size() + error_select_set.size());\n+\n+    {\n+        struct pollfd pollfd = {};\n+\n+        for (SOCKET hSocket : recv_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLIN;\n+            pollfds.push_back(pollfd);\n+        }\n+\n+        for (SOCKET hSocket : send_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLOUT;\n+            pollfds.push_back(pollfd);\n+        }\n+\n+        for (SOCKET hSocket : error_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLERR|POLLHUP;\n+            pollfds.push_back(pollfd);\n+        }\n+    }\n+\n+    if(poll(pollfds.data(), pollfds.size(), 50) < 0)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 48,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "5f99a7861c44e7f86292a06c1f9c97dac30b7161",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Should we make use of `SELECT_TIMEOUT_MILLISECONDS` here?",
      "created_at": "2018-10-16T20:19:12Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r225693517",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225693517"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1417,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225693624",
      "pull_request_review_id": 165345973,
      "id": 225693624,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTY5MzYyNA==",
      "diff_hunk": "@@ -1377,6 +1378,58 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\n         if(FD_ISSET(hSocket, &fdsetError))\n             error_set.insert(hSocket);\n }\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::vector<struct pollfd> pollfds;\n+    pollfds.reserve(recv_select_set.size() + send_select_set.size() + error_select_set.size());\n+\n+    {\n+        struct pollfd pollfd = {};\n+\n+        for (SOCKET hSocket : recv_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLIN;\n+            pollfds.push_back(pollfd);\n+        }\n+\n+        for (SOCKET hSocket : send_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLOUT;\n+            pollfds.push_back(pollfd);\n+        }\n+\n+        for (SOCKET hSocket : error_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLERR|POLLHUP;\n+            pollfds.push_back(pollfd);\n+        }\n+    }\n+\n+    if(poll(pollfds.data(), pollfds.size(), 50) < 0)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 48,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "5f99a7861c44e7f86292a06c1f9c97dac30b7161",
      "in_reply_to_id": 225693517,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: space after `if` + braces",
      "created_at": "2018-10-16T20:19:32Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r225693624",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225693624"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1417,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225695613",
      "pull_request_review_id": 165345973,
      "id": 225695613,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTY5NTYxMw==",
      "diff_hunk": "@@ -1308,6 +1308,7 @@ void CConnman::GenerateSelectSet(std::set<SOCKET> &recv_set, std::set<SOCKET> &s\n     }\n }\n \n+#ifdef WIN32",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "5f99a7861c44e7f86292a06c1f9c97dac30b7161",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Apparently [`poll` has been flaky on previous versions of MacOS](https://daniel.haxx.se/blog/2016/10/11/poll-on-mac-10-12-is-broken/). Do we want to fall back to `select` on Darwin systems just to be safe?",
      "created_at": "2018-10-16T20:26:07Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r225695613",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225695613"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1311,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225696650",
      "pull_request_review_id": 165353430,
      "id": 225696650,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTY5NjY1MA==",
      "diff_hunk": "@@ -1312,46 +1296,155 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n+}\n+\n+#ifndef HAVE_POLL",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "84fae8d4cc6a6d9f81644cef706629263e84d353",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "(from a previous comment on the outdated `#ifdef WIN32`) Apparently [`poll` has been flaky on previous versions of MacOS](https://daniel.haxx.se/blog/2016/10/11/poll-on-mac-10-12-is-broken/). Do we want to fall back to select on Darwin systems just to be safe?",
      "created_at": "2018-10-16T20:29:34Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r225696650",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225696650"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1313,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226500199",
      "pull_request_review_id": 166338356,
      "id": 226500199,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjUwMDE5OQ==",
      "diff_hunk": "@@ -1308,6 +1308,7 @@ void CConnman::GenerateSelectSet(std::set<SOCKET> &recv_set, std::set<SOCKET> &s\n     }\n }\n \n+#ifdef WIN32",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "5f99a7861c44e7f86292a06c1f9c97dac30b7161",
      "in_reply_to_id": 225695613,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm avoiding using poll() or select() to sleep specifically because of this class of bug.",
      "created_at": "2018-10-18T23:53:59Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r226500199",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226500199"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1311,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226500376",
      "pull_request_review_id": 166338581,
      "id": 226500376,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjUwMDM3Ng==",
      "diff_hunk": "@@ -1377,6 +1378,58 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\n         if(FD_ISSET(hSocket, &fdsetError))\n             error_set.insert(hSocket);\n }\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::vector<struct pollfd> pollfds;\n+    pollfds.reserve(recv_select_set.size() + send_select_set.size() + error_select_set.size());\n+\n+    {\n+        struct pollfd pollfd = {};\n+\n+        for (SOCKET hSocket : recv_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLIN;\n+            pollfds.push_back(pollfd);\n+        }\n+\n+        for (SOCKET hSocket : send_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLOUT;\n+            pollfds.push_back(pollfd);\n+        }\n+\n+        for (SOCKET hSocket : error_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLERR|POLLHUP;",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "5f99a7861c44e7f86292a06c1f9c97dac30b7161",
      "in_reply_to_id": 225691877,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm reusing the `struct pollfd` so it's necessary to overwrite the previous value.",
      "created_at": "2018-10-18T23:55:06Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r226500376",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226500376"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226500409",
      "pull_request_review_id": 166338623,
      "id": 226500409,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjUwMDQwOQ==",
      "diff_hunk": "@@ -1377,6 +1378,58 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\n         if(FD_ISSET(hSocket, &fdsetError))\n             error_set.insert(hSocket);\n }\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::vector<struct pollfd> pollfds;\n+    pollfds.reserve(recv_select_set.size() + send_select_set.size() + error_select_set.size());\n+\n+    {\n+        struct pollfd pollfd = {};\n+\n+        for (SOCKET hSocket : recv_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLIN;\n+            pollfds.push_back(pollfd);\n+        }\n+\n+        for (SOCKET hSocket : send_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLOUT;\n+            pollfds.push_back(pollfd);\n+        }\n+\n+        for (SOCKET hSocket : error_select_set) {\n+            pollfd.fd = hSocket;\n+            pollfd.events = POLLERR|POLLHUP;\n+            pollfds.push_back(pollfd);\n+        }\n+    }\n+\n+    if(poll(pollfds.data(), pollfds.size(), 50) < 0)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 48,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "5f99a7861c44e7f86292a06c1f9c97dac30b7161",
      "in_reply_to_id": 225693517,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "yeah",
      "created_at": "2018-10-18T23:55:21Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r226500409",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226500409"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1417,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226838085",
      "pull_request_review_id": 166760627,
      "id": 226838085,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjgzODA4NQ==",
      "diff_hunk": "@@ -1312,46 +1296,155 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n+}\n+\n+#ifndef HAVE_POLL",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "84fae8d4cc6a6d9f81644cef706629263e84d353",
      "in_reply_to_id": 225696650,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "i'm specifically avoiding calling poll (or select) with nothing to listen for because of that class of bugs, i'll add a comment",
      "created_at": "2018-10-20T19:53:59Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r226838085",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226838085"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1313,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230026550",
      "pull_request_review_id": 170664589,
      "id": 230026550,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDAyNjU1MA==",
      "diff_hunk": "@@ -1312,46 +1296,153 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::vector<struct pollfd> pollfds;\n+    pollfds.reserve(recv_select_set.size() + send_select_set.size() + error_select_set.size());\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        struct pollfd pollfd = {};\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLIN;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        struct pollfd pollfd = {};\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLOUT;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        struct pollfd pollfd = {};\n+        pollfd.fd = hSocket;\n+        // These flags are ignored, but we set them for clarity\n+        pollfd.events = POLLERR|POLLHUP;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    if(poll(pollfds.data(), pollfds.size(), 50) < 0)\n+        LogPrint(BCLog::NET, \"poll failure %d %s\\n\", errno, strerror(errno));\n+\n+    if (interruptNet)\n+        return;\n+\n+    for (struct pollfd pollfd : pollfds) {\n+        if (pollfd.revents & POLLIN)\n+            recv_set.insert(pollfd.fd);\n+        if (pollfd.revents & POLLOUT)\n+            send_set.insert(pollfd.fd);\n+        if (pollfd.revents & (POLLERR|POLLHUP))\n+            error_set.insert(pollfd.fd);\n+    }\n+}\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    //\n+    // Find which sockets have data to receive\n+    //\n+    struct timeval timeout;\n+    timeout.tv_sec  = 0;\n+    timeout.tv_usec = SELECT_TIMEOUT_MILLISECONDS * 1000; // frequency to poll pnode->vSend",
      "path": "src/net.cpp",
      "position": 143,
      "original_position": 129,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "ec652e12ee32878e0f0d378375ffac0f8313c6e5",
      "in_reply_to_id": null,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "don't know how long the old code waited, but isn't 50 milliseconds a bit short? if there are no events, why not sleep as long as possible? (saving CPU cycles) can you please add a comment explaining the reasoning for this specific value",
      "created_at": "2018-11-01T12:32:00Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r230026550",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230026550"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1371,
      "original_line": 1371,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230031558",
      "pull_request_review_id": 170671088,
      "id": 230031558,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDAzMTU1OA==",
      "diff_hunk": "@@ -1262,28 +1264,10 @@ void CConnman::InactivityCheck(CNode *pnode)\n     }\n }\n \n-void CConnman::SocketHandler()\n+bool CConnman::GenerateSelectSet(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)",
      "path": "src/net.cpp",
      "position": 35,
      "original_position": 14,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "ec652e12ee32878e0f0d378375ffac0f8313c6e5",
      "in_reply_to_id": null,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I guess we *want* these sets to be sorted by fd, or at least predictably sorted, as it's iterated over--so using `set` over `unordered_set` makes sense",
      "created_at": "2018-11-01T12:52:36Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r230031558",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230031558"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1269,
      "original_line": 1269,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230135886",
      "pull_request_review_id": 170804814,
      "id": 230135886,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDEzNTg4Ng==",
      "diff_hunk": "@@ -1312,46 +1296,153 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::vector<struct pollfd> pollfds;\n+    pollfds.reserve(recv_select_set.size() + send_select_set.size() + error_select_set.size());\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        struct pollfd pollfd = {};\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLIN;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        struct pollfd pollfd = {};\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLOUT;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        struct pollfd pollfd = {};\n+        pollfd.fd = hSocket;\n+        // These flags are ignored, but we set them for clarity\n+        pollfd.events = POLLERR|POLLHUP;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    if(poll(pollfds.data(), pollfds.size(), 50) < 0)\n+        LogPrint(BCLog::NET, \"poll failure %d %s\\n\", errno, strerror(errno));\n+\n+    if (interruptNet)\n+        return;\n+\n+    for (struct pollfd pollfd : pollfds) {\n+        if (pollfd.revents & POLLIN)\n+            recv_set.insert(pollfd.fd);\n+        if (pollfd.revents & POLLOUT)\n+            send_set.insert(pollfd.fd);\n+        if (pollfd.revents & (POLLERR|POLLHUP))\n+            error_set.insert(pollfd.fd);\n+    }\n+}\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    //\n+    // Find which sockets have data to receive\n+    //\n+    struct timeval timeout;\n+    timeout.tv_sec  = 0;\n+    timeout.tv_usec = SELECT_TIMEOUT_MILLISECONDS * 1000; // frequency to poll pnode->vSend",
      "path": "src/net.cpp",
      "position": 143,
      "original_position": 129,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "ec652e12ee32878e0f0d378375ffac0f8313c6e5",
      "in_reply_to_id": 230026550,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I carried over the existing value.\r\n\r\nThere are two reasons for this to be a short value:\r\n\r\n- we cant modify the list of sockets while waiting, so the sleep time is potentially the delay before a new connection is serviced at all\r\n- the disconnectnodes and inactivitychecks are time based and independent of socketevents",
      "created_at": "2018-11-01T17:52:58Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r230135886",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230135886"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1371,
      "original_line": 1371,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230136620",
      "pull_request_review_id": 170805718,
      "id": 230136620,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDEzNjYyMA==",
      "diff_hunk": "@@ -1262,28 +1264,10 @@ void CConnman::InactivityCheck(CNode *pnode)\n     }\n }\n \n-void CConnman::SocketHandler()\n+bool CConnman::GenerateSelectSet(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)",
      "path": "src/net.cpp",
      "position": 35,
      "original_position": 14,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "ec652e12ee32878e0f0d378375ffac0f8313c6e5",
      "in_reply_to_id": 230031558,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "regardless of iterating i cant imagine we'd see any change in a benchmark here",
      "created_at": "2018-11-01T17:55:06Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r230136620",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230136620"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1269,
      "original_line": 1269,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230137381",
      "pull_request_review_id": 170806585,
      "id": 230137381,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDEzNzM4MQ==",
      "diff_hunk": "@@ -1312,46 +1296,153 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::vector<struct pollfd> pollfds;\n+    pollfds.reserve(recv_select_set.size() + send_select_set.size() + error_select_set.size());\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        struct pollfd pollfd = {};\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLIN;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        struct pollfd pollfd = {};\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLOUT;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        struct pollfd pollfd = {};\n+        pollfd.fd = hSocket;\n+        // These flags are ignored, but we set them for clarity\n+        pollfd.events = POLLERR|POLLHUP;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    if(poll(pollfds.data(), pollfds.size(), 50) < 0)\n+        LogPrint(BCLog::NET, \"poll failure %d %s\\n\", errno, strerror(errno));\n+\n+    if (interruptNet)\n+        return;\n+\n+    for (struct pollfd pollfd : pollfds) {\n+        if (pollfd.revents & POLLIN)\n+            recv_set.insert(pollfd.fd);\n+        if (pollfd.revents & POLLOUT)\n+            send_set.insert(pollfd.fd);\n+        if (pollfd.revents & (POLLERR|POLLHUP))\n+            error_set.insert(pollfd.fd);\n+    }\n+}\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    //\n+    // Find which sockets have data to receive\n+    //\n+    struct timeval timeout;\n+    timeout.tv_sec  = 0;\n+    timeout.tv_usec = SELECT_TIMEOUT_MILLISECONDS * 1000; // frequency to poll pnode->vSend",
      "path": "src/net.cpp",
      "position": 143,
      "original_position": 129,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "ec652e12ee32878e0f0d378375ffac0f8313c6e5",
      "in_reply_to_id": 230026550,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "i just checked and this is the value from satoshi, so im sure it was entirely arbitrarily chosen",
      "created_at": "2018-11-01T17:57:02Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r230137381",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230137381"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1371,
      "original_line": 1371,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230971331",
      "pull_request_review_id": 171830899,
      "id": 230971331,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDk3MTMzMQ==",
      "diff_hunk": "@@ -102,12 +102,12 @@ typedef void* sockopt_arg_type;\n typedef char* sockopt_arg_type;\n #endif\n \n+#if not defined WIN32",
      "path": "src/compat.h",
      "position": null,
      "original_position": 4,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "efb25c0a31aeccd8dbd824ad03991d3a666583b2",
      "in_reply_to_id": null,
      "user": {
        "login": "ken2812221",
        "id": 11154118,
        "node_id": "MDQ6VXNlcjExMTU0MTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ken2812221",
        "html_url": "https://github.com/ken2812221",
        "followers_url": "https://api.github.com/users/ken2812221/followers",
        "following_url": "https://api.github.com/users/ken2812221/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ken2812221/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ken2812221/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
        "organizations_url": "https://api.github.com/users/ken2812221/orgs",
        "repos_url": "https://api.github.com/users/ken2812221/repos",
        "events_url": "https://api.github.com/users/ken2812221/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ken2812221/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: MSVC does not like this. I would suggest to use `#ifndef`",
      "created_at": "2018-11-06T01:09:02Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r230971331",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230971331"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 105,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231014724",
      "pull_request_review_id": 171883088,
      "id": 231014724,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMTAxNDcyNA==",
      "diff_hunk": "@@ -102,12 +102,12 @@ typedef void* sockopt_arg_type;\n typedef char* sockopt_arg_type;\n #endif\n \n+#if not defined WIN32",
      "path": "src/compat.h",
      "position": null,
      "original_position": 4,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "efb25c0a31aeccd8dbd824ad03991d3a666583b2",
      "in_reply_to_id": 230971331,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think the official syntax, which works with any C++ compiler, is\r\n```c++\r\n#if !defined(WIN32)\r\n```",
      "created_at": "2018-11-06T07:02:59Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r231014724",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231014724"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 105,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232128578",
      "pull_request_review_id": 173256966,
      "id": 232128578,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjEyODU3OA==",
      "diff_hunk": "@@ -1312,46 +1298,149 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLIN;\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[hSocket].events |= POLLERR|POLLHUP;\n+    }\n+\n+    std::vector<struct pollfd> vpollfds;",
      "path": "src/net.cpp",
      "position": 113,
      "original_position": 94,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "44f9c1ab13487c6ecf1a2bc038720e4b1de07098",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`vpollfds.reserve(pollfds.size())`?",
      "created_at": "2018-11-09T02:42:40Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232128578",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232128578"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1341,
      "original_line": 1341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232128628",
      "pull_request_review_id": 173256966,
      "id": 232128628,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjEyODYyOA==",
      "diff_hunk": "@@ -1312,46 +1298,149 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLIN;\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[hSocket].events |= POLLERR|POLLHUP;\n+    }\n+\n+    std::vector<struct pollfd> vpollfds;\n+    for(auto it : pollfds)\n+        vpollfds.push_back(it.second);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 96,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "44f9c1ab13487c6ecf1a2bc038720e4b1de07098",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": " `.push_back(std::move(it.second))`? ",
      "created_at": "2018-11-09T02:42:55Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232128628",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232128628"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1343,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232128989",
      "pull_request_review_id": 173257454,
      "id": 232128989,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjEyODk4OQ==",
      "diff_hunk": "@@ -1312,46 +1298,149 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLIN;\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[hSocket].events |= POLLERR|POLLHUP;\n+    }\n+\n+    std::vector<struct pollfd> vpollfds;",
      "path": "src/net.cpp",
      "position": 113,
      "original_position": 94,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "44f9c1ab13487c6ecf1a2bc038720e4b1de07098",
      "in_reply_to_id": 232128578,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "i believe std::map::size is o(n)",
      "created_at": "2018-11-09T02:45:39Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232128989",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232128989"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1341,
      "original_line": 1341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232129158",
      "pull_request_review_id": 173257668,
      "id": 232129158,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjEyOTE1OA==",
      "diff_hunk": "@@ -1312,46 +1298,149 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLIN;\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[hSocket].events |= POLLERR|POLLHUP;\n+    }\n+\n+    std::vector<struct pollfd> vpollfds;",
      "path": "src/net.cpp",
      "position": 113,
      "original_position": 94,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "44f9c1ab13487c6ecf1a2bc038720e4b1de07098",
      "in_reply_to_id": 232128578,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nope, guaranteed to be O(1). https://en.cppreference.com/w/cpp/container/map/size",
      "created_at": "2018-11-09T02:46:50Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232129158",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232129158"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1341,
      "original_line": 1341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232173803",
      "pull_request_review_id": 173312802,
      "id": 232173803,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjE3MzgwMw==",
      "diff_hunk": "@@ -1312,46 +1298,149 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLIN;\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[hSocket].events |= POLLERR|POLLHUP;\n+    }\n+\n+    std::vector<struct pollfd> vpollfds;\n+    for(auto it : pollfds)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 95,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "44f9c1ab13487c6ecf1a2bc038720e4b1de07098",
      "in_reply_to_id": null,
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "~~Could use `std::transform`?~~",
      "created_at": "2018-11-09T08:33:24Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232173803",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232173803"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1343,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232289036",
      "pull_request_review_id": 173456510,
      "id": 232289036,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjI4OTAzNg==",
      "diff_hunk": "@@ -1312,46 +1298,149 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLIN;\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[hSocket].events |= POLLERR|POLLHUP;\n+    }\n+\n+    std::vector<struct pollfd> vpollfds;\n+    for(auto it : pollfds)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 95,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "44f9c1ab13487c6ecf1a2bc038720e4b1de07098",
      "in_reply_to_id": 232173803,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Transform looks overly complicated for this: https://stackoverflow.com/a/771482",
      "created_at": "2018-11-09T15:21:06Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232289036",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232289036"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1343,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232354883",
      "pull_request_review_id": 173542010,
      "id": 232354883,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjM1NDg4Mw==",
      "diff_hunk": "@@ -1312,46 +1298,149 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLIN;\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[hSocket].events |= POLLERR|POLLHUP;\n+    }\n+\n+    std::vector<struct pollfd> vpollfds;",
      "path": "src/net.cpp",
      "position": 113,
      "original_position": 94,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "44f9c1ab13487c6ecf1a2bc038720e4b1de07098",
      "in_reply_to_id": 232128578,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ok changing now",
      "created_at": "2018-11-09T18:48:42Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232354883",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232354883"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1341,
      "original_line": 1341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232463506",
      "pull_request_review_id": 173672814,
      "id": 232463506,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ2MzUwNg==",
      "diff_hunk": "@@ -1262,28 +1264,10 @@ void CConnman::InactivityCheck(CNode *pnode)\n     }\n }\n \n-void CConnman::SocketHandler()\n+bool CConnman::GenerateSelectSet(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)",
      "path": "src/net.cpp",
      "position": 35,
      "original_position": 14,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "ec652e12ee32878e0f0d378375ffac0f8313c6e5",
      "in_reply_to_id": 230031558,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It's probably slightly more efficient to return sorted vectors, and use `std::binary_search` to look up things in it (as `std::map` needs one allocation per element), but agree that it is unlikely to matter here.",
      "created_at": "2018-11-10T19:35:58Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232463506",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232463506"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1269,
      "original_line": 1269,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232463540",
      "pull_request_review_id": 173672814,
      "id": 232463540,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ2MzU0MA==",
      "diff_hunk": "@@ -1312,46 +1298,150 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET hSocket : recv_select_set) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 78,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "4963f3110e96746855686572d43a9b5b0cb44290",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Tiny nit: variable naming style for `hSocket`.",
      "created_at": "2018-11-10T19:37:12Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232463540",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232463540"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1325,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232463550",
      "pull_request_review_id": 173672814,
      "id": 232463550,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ2MzU1MA==",
      "diff_hunk": "@@ -1312,46 +1298,150 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLIN;\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[hSocket].events |= POLLERR|POLLHUP;\n+    }\n+\n+    std::vector<struct pollfd> vpollfds;\n+    vpollfds.reserve(pollfds.size());\n+    for(auto it : pollfds)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 96,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "4963f3110e96746855686572d43a9b5b0cb44290",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Tiny nit: space after `for` (and after `if` further).",
      "created_at": "2018-11-10T19:37:30Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232463550",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232463550"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1343,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232463592",
      "pull_request_review_id": 173672814,
      "id": 232463592,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ2MzU5Mg==",
      "diff_hunk": "@@ -1312,46 +1298,150 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLIN;\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[hSocket].events |= POLLERR|POLLHUP;\n+    }\n+\n+    std::vector<struct pollfd> vpollfds;\n+    vpollfds.reserve(pollfds.size());\n+    for(auto it : pollfds)\n+        vpollfds.push_back(std::move(it.second));\n+\n+    if(poll(vpollfds.data(), vpollfds.size(), SELECT_TIMEOUT_MILLISECONDS) < 0)\n+        return;\n+\n+    if (interruptNet)\n+        return;\n+\n+    for (struct pollfd pollfd : vpollfds) {\n+        if (pollfd.revents & POLLIN)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 106,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "4963f3110e96746855686572d43a9b5b0cb44290",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Style nit: braces whenever the next lines are indented (or put the then clause on the same line as the `if`).",
      "created_at": "2018-11-10T19:39:00Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232463592",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232463592"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1353,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232463674",
      "pull_request_review_id": 173672814,
      "id": 232463674,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ2MzY3NA==",
      "diff_hunk": "@@ -1312,46 +1298,150 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLIN;\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        pollfds[hSocket].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfds[hSocket].fd = hSocket;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[hSocket].events |= POLLERR|POLLHUP;\n+    }\n+\n+    std::vector<struct pollfd> vpollfds;\n+    vpollfds.reserve(pollfds.size());\n+    for(auto it : pollfds)\n+        vpollfds.push_back(std::move(it.second));\n+\n+    if(poll(vpollfds.data(), vpollfds.size(), SELECT_TIMEOUT_MILLISECONDS) < 0)\n+        return;\n+\n+    if (interruptNet)\n+        return;\n+\n+    for (struct pollfd pollfd : vpollfds) {\n+        if (pollfd.revents & POLLIN)\n+            recv_set.insert(pollfd.fd);\n+        if (pollfd.revents & POLLOUT)\n+            send_set.insert(pollfd.fd);\n+        if (pollfd.revents & (POLLERR|POLLHUP))\n+            error_set.insert(pollfd.fd);\n+    }\n+}\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    //\n+    // Find which sockets have data to receive\n+    //\n+    struct timeval timeout;\n+    timeout.tv_sec  = 0;\n+    timeout.tv_usec = SELECT_TIMEOUT_MILLISECONDS * 1000; // frequency to poll pnode->vSend\n+\n+    fd_set fdsetRecv;\n+    fd_set fdsetSend;\n+    fd_set fdsetError;\n+    FD_ZERO(&fdsetRecv);\n+    FD_ZERO(&fdsetSend);\n+    FD_ZERO(&fdsetError);\n+    SOCKET hSocketMax = 0;\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        FD_SET(hSocket, &fdsetRecv);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        FD_SET(hSocket, &fdsetSend);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        FD_SET(hSocket, &fdsetError);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    int nSelect = select(hSocketMax + 1, &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+\n     if (interruptNet)\n         return;\n \n     if (nSelect == SOCKET_ERROR)\n     {\n-        if (have_fds)\n-        {\n-            int nErr = WSAGetLastError();\n-            LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n-            for (unsigned int i = 0; i <= hSocketMax; i++)\n-                FD_SET(i, &fdsetRecv);\n-        }\n+        int nErr = WSAGetLastError();\n+        LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n+        for (unsigned int i = 0; i <= hSocketMax; i++)\n+            FD_SET(i, &fdsetRecv);\n         FD_ZERO(&fdsetSend);\n         FD_ZERO(&fdsetError);\n-        if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n+        if (!interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS)))\n             return;\n     }\n \n+    for (SOCKET hSocket : recv_select_set)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 178,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "4963f3110e96746855686572d43a9b5b0cb44290",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Style nit: braces when indenting, and spaces after `if`.",
      "created_at": "2018-11-10T19:42:47Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232463674",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232463674"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232463698",
      "pull_request_review_id": 173672814,
      "id": 232463698,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ2MzY5OA==",
      "diff_hunk": "@@ -17,6 +17,10 @@\n #include <string>\n #include <vector>\n \n+#ifndef WIN32",
      "path": "src/netbase.h",
      "position": null,
      "original_position": 4,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "4963f3110e96746855686572d43a9b5b0cb44290",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It doesn't seem like the current code is using `poll` on Windows.",
      "created_at": "2018-11-10T19:43:44Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232463698",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232463698"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 20,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232463705",
      "pull_request_review_id": 173672814,
      "id": 232463705,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ2MzcwNQ==",
      "diff_hunk": "@@ -31,6 +31,7 @@\n \n #ifndef WIN32\n #include <arpa/inet.h>\n+#include <poll.h>",
      "path": "src/net.h",
      "position": null,
      "original_position": 4,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "4963f3110e96746855686572d43a9b5b0cb44290",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It doesn't seem like the current code is using `poll` on Windows.",
      "created_at": "2018-11-10T19:44:02Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232463705",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232463705"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 35,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232466820",
      "pull_request_review_id": 173676132,
      "id": 232466820,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ2NjgyMA==",
      "diff_hunk": "@@ -31,6 +31,7 @@\n \n #ifndef WIN32\n #include <arpa/inet.h>\n+#include <poll.h>",
      "path": "src/net.h",
      "position": null,
      "original_position": 4,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "4963f3110e96746855686572d43a9b5b0cb44290",
      "in_reply_to_id": 232463705,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "it isnt?",
      "created_at": "2018-11-10T21:36:09Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232466820",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232466820"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 35,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232466827",
      "pull_request_review_id": 173676138,
      "id": 232466827,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ2NjgyNw==",
      "diff_hunk": "@@ -17,6 +17,10 @@\n #include <string>\n #include <vector>\n \n+#ifndef WIN32",
      "path": "src/netbase.h",
      "position": null,
      "original_position": 4,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "4963f3110e96746855686572d43a9b5b0cb44290",
      "in_reply_to_id": 232463698,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "it isnt?",
      "created_at": "2018-11-10T21:36:21Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232466827",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232466827"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 20,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232466869",
      "pull_request_review_id": 173676186,
      "id": 232466869,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ2Njg2OQ==",
      "diff_hunk": "@@ -17,6 +17,10 @@\n #include <string>\n #include <vector>\n \n+#ifndef WIN32",
      "path": "src/netbase.h",
      "position": null,
      "original_position": 4,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "4963f3110e96746855686572d43a9b5b0cb44290",
      "in_reply_to_id": 232463698,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```c++\r\n#if defined(__linux__)\r\n#define USE_POLL\r\n#endif\r\n```\r\n",
      "created_at": "2018-11-10T21:38:00Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232466869",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232466869"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 20,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232466883",
      "pull_request_review_id": 173676198,
      "id": 232466883,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ2Njg4Mw==",
      "diff_hunk": "@@ -17,6 +17,10 @@\n #include <string>\n #include <vector>\n \n+#ifndef WIN32",
      "path": "src/netbase.h",
      "position": null,
      "original_position": 4,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "4963f3110e96746855686572d43a9b5b0cb44290",
      "in_reply_to_id": 232463698,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Oh, damn, I misread if**n**def.",
      "created_at": "2018-11-10T21:38:30Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232466883",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232466883"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 20,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232472956",
      "pull_request_review_id": 173682772,
      "id": 232472956,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ3Mjk1Ng==",
      "diff_hunk": "@@ -102,8 +102,12 @@ typedef void* sockopt_arg_type;\n typedef char* sockopt_arg_type;\n #endif\n \n+#if defined(__linux__)",
      "path": "src/compat.h",
      "position": 7,
      "original_position": 4,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "ce79907bd75338fe125e4b73e7814d35fb6927dc",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Perhaps add a comment here listen the reason for excluding every platform not included here, so it is easy to re-asses later.",
      "created_at": "2018-11-11T02:54:41Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232472956",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232472956"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 98,
      "original_line": 98,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232472974",
      "pull_request_review_id": 173682772,
      "id": 232472974,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ3Mjk3NA==",
      "diff_hunk": "@@ -1310,6 +1312,49 @@ bool CConnman::GenerateSelectSet(std::set<SOCKET> &recv_set, std::set<SOCKET> &s\n     return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n }\n \n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET socket_id : recv_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        pollfds[socket_id].events |= POLLIN;\n+    }\n+\n+    for (SOCKET socket_id : send_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        pollfds[socket_id].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET socket_id : error_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[socket_id].events |= POLLERR|POLLHUP;\n+    }\n+\n+    std::vector<struct pollfd> vpollfds;\n+    vpollfds.reserve(pollfds.size());\n+    for (auto it : pollfds) {\n+        vpollfds.push_back(std::move(it.second));\n+    }\n+\n+    if (poll(vpollfds.data(), vpollfds.size(), SELECT_TIMEOUT_MILLISECONDS) < 0) return;\n+\n+    if (interruptNet) return;\n+\n+    for (struct pollfd pollfd : vpollfds) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "ce79907bd75338fe125e4b73e7814d35fb6927dc",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```\r\nnet.cpp: In member function void CConnman::SocketEvents(std::set<unsigned int>&, std::set<unsigned int>&, std::set<unsigned int>&):\r\nnet.cpp:1351:10: warning: types may not be defined in a for-range-declaration\r\n     for (struct pollfd pollfd : vpollfds) {\r\n          ^~~~~~\r\n```",
      "created_at": "2018-11-11T02:57:28Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232472974",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232472974"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1351,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232473557",
      "pull_request_review_id": 173683620,
      "id": 232473557,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ3MzU1Nw==",
      "diff_hunk": "@@ -1153,310 +1153,407 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\n     }\n }\n \n-void CConnman::ThreadSocketHandler()\n+void CConnman::DisconnectNodes()\n {\n-    unsigned int nPrevNodeCount = 0;\n-    while (!interruptNet)\n     {\n-        //\n-        // Disconnect nodes\n-        //\n-        {\n-            LOCK(cs_vNodes);\n+        LOCK(cs_vNodes);\n \n-            if (!fNetworkActive) {\n-                // Disconnect any connected nodes\n-                for (CNode* pnode : vNodes) {\n-                    if (!pnode->fDisconnect) {\n-                        LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n-                        pnode->fDisconnect = true;\n-                    }\n+        if (!fNetworkActive) {\n+            // Disconnect any connected nodes\n+            for (CNode* pnode : vNodes) {\n+                if (!pnode->fDisconnect) {\n+                    LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n+                    pnode->fDisconnect = true;\n                 }\n             }\n+        }\n \n-            // Disconnect unused nodes\n-            std::vector<CNode*> vNodesCopy = vNodes;\n-            for (CNode* pnode : vNodesCopy)\n+        // Disconnect unused nodes\n+        std::vector<CNode*> vNodesCopy = vNodes;\n+        for (CNode* pnode : vNodesCopy)\n+        {\n+            if (pnode->fDisconnect)\n             {\n-                if (pnode->fDisconnect)\n-                {\n-                    // remove from vNodes\n-                    vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n+                // remove from vNodes\n+                vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n \n-                    // release outbound grant (if any)\n-                    pnode->grantOutbound.Release();\n+                // release outbound grant (if any)\n+                pnode->grantOutbound.Release();\n \n-                    // close socket and cleanup\n-                    pnode->CloseSocketDisconnect();\n+                // close socket and cleanup\n+                pnode->CloseSocketDisconnect();\n \n-                    // hold in disconnected pool until all refs are released\n-                    pnode->Release();\n-                    vNodesDisconnected.push_back(pnode);\n-                }\n+                // hold in disconnected pool until all refs are released\n+                pnode->Release();\n+                vNodesDisconnected.push_back(pnode);\n             }\n         }\n+    }\n+    {\n+        // Delete disconnected nodes\n+        std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n+        for (CNode* pnode : vNodesDisconnectedCopy)\n         {\n-            // Delete disconnected nodes\n-            std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n-            for (CNode* pnode : vNodesDisconnectedCopy)\n-            {\n-                // wait until threads are done using it\n-                if (pnode->GetRefCount() <= 0) {\n-                    bool fDelete = false;\n-                    {\n-                        TRY_LOCK(pnode->cs_inventory, lockInv);\n-                        if (lockInv) {\n-                            TRY_LOCK(pnode->cs_vSend, lockSend);\n-                            if (lockSend) {\n-                                fDelete = true;\n-                            }\n+            // wait until threads are done using it\n+            if (pnode->GetRefCount() <= 0) {\n+                bool fDelete = false;\n+                {\n+                    TRY_LOCK(pnode->cs_inventory, lockInv);\n+                    if (lockInv) {\n+                        TRY_LOCK(pnode->cs_vSend, lockSend);\n+                        if (lockSend) {\n+                            fDelete = true;\n                         }\n                     }\n-                    if (fDelete) {\n-                        vNodesDisconnected.remove(pnode);\n-                        DeleteNode(pnode);\n-                    }\n+                }\n+                if (fDelete) {\n+                    vNodesDisconnected.remove(pnode);\n+                    DeleteNode(pnode);\n                 }\n             }\n         }\n-        size_t vNodesSize;\n+    }\n+}\n+\n+void CConnman::NotifyNumConnectionsChanged()\n+{\n+    size_t vNodesSize;\n+    {\n+        LOCK(cs_vNodes);\n+        vNodesSize = vNodes.size();\n+    }\n+    if(vNodesSize != nPrevNodeCount) {\n+        nPrevNodeCount = vNodesSize;\n+        if(clientInterface)\n+            clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+    }\n+}\n+\n+void CConnman::InactivityCheck(CNode *pnode)\n+{\n+    int64_t nTime = GetSystemTimeInSeconds();\n+    if (nTime - pnode->nTimeConnected > 60)\n+    {\n+        if (pnode->nLastRecv == 0 || pnode->nLastSend == 0)\n+        {\n+            LogPrint(BCLog::NET, \"socket no message in first 60 seconds, %d %d from %d\\n\", pnode->nLastRecv != 0, pnode->nLastSend != 0, pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+        else if (nTime - pnode->nLastSend > TIMEOUT_INTERVAL)\n         {\n-            LOCK(cs_vNodes);\n-            vNodesSize = vNodes.size();\n+            LogPrintf(\"socket sending timeout: %is\\n\", nTime - pnode->nLastSend);\n+            pnode->fDisconnect = true;\n         }\n-        if(vNodesSize != nPrevNodeCount) {\n-            nPrevNodeCount = vNodesSize;\n-            if(clientInterface)\n-                clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+        else if (nTime - pnode->nLastRecv > (pnode->nVersion > BIP0031_VERSION ? TIMEOUT_INTERVAL : 90*60))\n+        {\n+            LogPrintf(\"socket receive timeout: %is\\n\", nTime - pnode->nLastRecv);\n+            pnode->fDisconnect = true;\n         }\n-\n-        //\n-        // Find which sockets have data to receive\n-        //\n-        struct timeval timeout;\n-        timeout.tv_sec  = 0;\n-        timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n-\n-        fd_set fdsetRecv;\n-        fd_set fdsetSend;\n-        fd_set fdsetError;\n-        FD_ZERO(&fdsetRecv);\n-        FD_ZERO(&fdsetSend);\n-        FD_ZERO(&fdsetError);\n-        SOCKET hSocketMax = 0;\n-        bool have_fds = false;\n-\n-        for (const ListenSocket& hListenSocket : vhListenSocket) {\n-            FD_SET(hListenSocket.socket, &fdsetRecv);\n-            hSocketMax = std::max(hSocketMax, hListenSocket.socket);\n-            have_fds = true;\n+        else if (pnode->nPingNonceSent && pnode->nPingUsecStart + TIMEOUT_INTERVAL * 1000000 < GetTimeMicros())\n+        {\n+            LogPrintf(\"ping timeout: %fs\\n\", 0.000001 * (GetTimeMicros() - pnode->nPingUsecStart));\n+            pnode->fDisconnect = true;\n         }\n+        else if (!pnode->fSuccessfullyConnected)\n+        {\n+            LogPrint(BCLog::NET, \"version handshake timeout from %d\\n\", pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+    }\n+}\n \n+void CConnman::GenerateSelectSet(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    for (const ListenSocket& hListenSocket : vhListenSocket) {\n+        recv_set.insert(hListenSocket.socket);\n+    }\n+\n+    {\n+        LOCK(cs_vNodes);\n+        for (CNode* pnode : vNodes)\n         {\n-            LOCK(cs_vNodes);\n-            for (CNode* pnode : vNodes)\n+            // Implement the following logic:\n+            // * If there is data to send, select() for sending data. As this only\n+            //   happens when optimistic write failed, we choose to first drain the\n+            //   write buffer in this case before receiving more. This avoids\n+            //   needlessly queueing received data, if the remote peer is not themselves\n+            //   receiving data. This means properly utilizing TCP flow control signalling.\n+            // * Otherwise, if there is space left in the receive buffer, select() for\n+            //   receiving data.\n+            // * Hand off all complete messages to the processor, to be handled without\n+            //   blocking here.\n+\n+            bool select_recv = !pnode->fPauseRecv;\n+            bool select_send;\n             {\n-                // Implement the following logic:\n-                // * If there is data to send, select() for sending data. As this only\n-                //   happens when optimistic write failed, we choose to first drain the\n-                //   write buffer in this case before receiving more. This avoids\n-                //   needlessly queueing received data, if the remote peer is not themselves\n-                //   receiving data. This means properly utilizing TCP flow control signalling.\n-                // * Otherwise, if there is space left in the receive buffer, select() for\n-                //   receiving data.\n-                // * Hand off all complete messages to the processor, to be handled without\n-                //   blocking here.\n-\n-                bool select_recv = !pnode->fPauseRecv;\n-                bool select_send;\n-                {\n-                    LOCK(pnode->cs_vSend);\n-                    select_send = !pnode->vSendMsg.empty();\n-                }\n-\n-                LOCK(pnode->cs_hSocket);\n-                if (pnode->hSocket == INVALID_SOCKET)\n-                    continue;\n+                LOCK(pnode->cs_vSend);\n+                select_send = !pnode->vSendMsg.empty();\n+            }\n \n-                FD_SET(pnode->hSocket, &fdsetError);\n-                hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-                have_fds = true;\n+            LOCK(pnode->cs_hSocket);\n+            if (pnode->hSocket == INVALID_SOCKET)\n+                continue;\n \n-                if (select_send) {\n-                    FD_SET(pnode->hSocket, &fdsetSend);\n-                    continue;\n-                }\n-                if (select_recv) {\n-                    FD_SET(pnode->hSocket, &fdsetRecv);\n-                }\n+            error_set.insert(pnode->hSocket);\n+            if (select_send) {\n+                send_set.insert(pnode->hSocket);\n+                continue;\n+            }\n+            if (select_recv) {\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n+    }\n+}\n \n-        int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                             &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n-        if (interruptNet)\n+#ifdef WIN32\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    //\n+    // Find which sockets have data to receive\n+    //\n+    struct timeval timeout;\n+    timeout.tv_sec  = 0;\n+    timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n+\n+    fd_set fdsetRecv;\n+    fd_set fdsetSend;\n+    fd_set fdsetError;\n+    FD_ZERO(&fdsetRecv);\n+    FD_ZERO(&fdsetSend);\n+    FD_ZERO(&fdsetError);\n+    SOCKET hSocketMax = 0;\n+\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        FD_SET(hSocket, &fdsetRecv);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        FD_SET(hSocket, &fdsetSend);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        FD_SET(hSocket, &fdsetError);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    int nSelect = select(hSocketMax + 1, &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+\n+    if (nSelect == SOCKET_ERROR)\n+    {\n+        int nErr = WSAGetLastError();\n+        LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n+        for (unsigned int i = 0; i <= hSocketMax; i++)\n+            FD_SET(i, &fdsetRecv);\n+        FD_ZERO(&fdsetSend);\n+        FD_ZERO(&fdsetError);\n+        if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n             return;\n+    }\n \n-        if (nSelect == SOCKET_ERROR)\n-        {\n-            if (have_fds)\n-            {\n-                int nErr = WSAGetLastError();\n-                LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n-                for (unsigned int i = 0; i <= hSocketMax; i++)\n-                    FD_SET(i, &fdsetRecv);\n-            }\n-            FD_ZERO(&fdsetSend);\n-            FD_ZERO(&fdsetError);\n-            if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n-                return;\n-        }\n+    for (SOCKET hSocket : recv_select_set)\n+        if(FD_ISSET(hSocket, &fdsetRecv))\n+            recv_set.insert(hSocket);\n \n-        //\n-        // Accept new connections\n-        //\n-        for (const ListenSocket& hListenSocket : vhListenSocket)\n+    for (SOCKET hSocket : send_select_set)\n+        if(FD_ISSET(hSocket, &fdsetSend))\n+            send_set.insert(hSocket);\n+\n+    for (SOCKET hSocket : error_select_set)\n+        if(FD_ISSET(hSocket, &fdsetError))\n+            error_set.insert(hSocket);\n+}\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() and error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n+    if (interruptNet)\n+        return;\n+\n+    std::vector<struct pollfd> pollfds;\n+    struct pollfd pollfd;\n+    memset(&pollfd, 0, sizeof(struct pollfd));",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 370,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "in_reply_to_id": 221419247,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2018-11-11T03:50:28Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232473557",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232473557"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232473558",
      "pull_request_review_id": 173683624,
      "id": 232473558,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ3MzU1OA==",
      "diff_hunk": "@@ -1153,310 +1153,407 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\n     }\n }\n \n-void CConnman::ThreadSocketHandler()\n+void CConnman::DisconnectNodes()\n {\n-    unsigned int nPrevNodeCount = 0;\n-    while (!interruptNet)\n     {\n-        //\n-        // Disconnect nodes\n-        //\n-        {\n-            LOCK(cs_vNodes);\n+        LOCK(cs_vNodes);\n \n-            if (!fNetworkActive) {\n-                // Disconnect any connected nodes\n-                for (CNode* pnode : vNodes) {\n-                    if (!pnode->fDisconnect) {\n-                        LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n-                        pnode->fDisconnect = true;\n-                    }\n+        if (!fNetworkActive) {\n+            // Disconnect any connected nodes\n+            for (CNode* pnode : vNodes) {\n+                if (!pnode->fDisconnect) {\n+                    LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n+                    pnode->fDisconnect = true;\n                 }\n             }\n+        }\n \n-            // Disconnect unused nodes\n-            std::vector<CNode*> vNodesCopy = vNodes;\n-            for (CNode* pnode : vNodesCopy)\n+        // Disconnect unused nodes\n+        std::vector<CNode*> vNodesCopy = vNodes;\n+        for (CNode* pnode : vNodesCopy)\n+        {\n+            if (pnode->fDisconnect)\n             {\n-                if (pnode->fDisconnect)\n-                {\n-                    // remove from vNodes\n-                    vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n+                // remove from vNodes\n+                vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n \n-                    // release outbound grant (if any)\n-                    pnode->grantOutbound.Release();\n+                // release outbound grant (if any)\n+                pnode->grantOutbound.Release();\n \n-                    // close socket and cleanup\n-                    pnode->CloseSocketDisconnect();\n+                // close socket and cleanup\n+                pnode->CloseSocketDisconnect();\n \n-                    // hold in disconnected pool until all refs are released\n-                    pnode->Release();\n-                    vNodesDisconnected.push_back(pnode);\n-                }\n+                // hold in disconnected pool until all refs are released\n+                pnode->Release();\n+                vNodesDisconnected.push_back(pnode);\n             }\n         }\n+    }\n+    {\n+        // Delete disconnected nodes\n+        std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n+        for (CNode* pnode : vNodesDisconnectedCopy)\n         {\n-            // Delete disconnected nodes\n-            std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n-            for (CNode* pnode : vNodesDisconnectedCopy)\n-            {\n-                // wait until threads are done using it\n-                if (pnode->GetRefCount() <= 0) {\n-                    bool fDelete = false;\n-                    {\n-                        TRY_LOCK(pnode->cs_inventory, lockInv);\n-                        if (lockInv) {\n-                            TRY_LOCK(pnode->cs_vSend, lockSend);\n-                            if (lockSend) {\n-                                fDelete = true;\n-                            }\n+            // wait until threads are done using it\n+            if (pnode->GetRefCount() <= 0) {\n+                bool fDelete = false;\n+                {\n+                    TRY_LOCK(pnode->cs_inventory, lockInv);\n+                    if (lockInv) {\n+                        TRY_LOCK(pnode->cs_vSend, lockSend);\n+                        if (lockSend) {\n+                            fDelete = true;\n                         }\n                     }\n-                    if (fDelete) {\n-                        vNodesDisconnected.remove(pnode);\n-                        DeleteNode(pnode);\n-                    }\n+                }\n+                if (fDelete) {\n+                    vNodesDisconnected.remove(pnode);\n+                    DeleteNode(pnode);\n                 }\n             }\n         }\n-        size_t vNodesSize;\n+    }\n+}\n+\n+void CConnman::NotifyNumConnectionsChanged()\n+{\n+    size_t vNodesSize;\n+    {\n+        LOCK(cs_vNodes);\n+        vNodesSize = vNodes.size();\n+    }\n+    if(vNodesSize != nPrevNodeCount) {\n+        nPrevNodeCount = vNodesSize;\n+        if(clientInterface)\n+            clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+    }\n+}\n+\n+void CConnman::InactivityCheck(CNode *pnode)\n+{\n+    int64_t nTime = GetSystemTimeInSeconds();\n+    if (nTime - pnode->nTimeConnected > 60)\n+    {\n+        if (pnode->nLastRecv == 0 || pnode->nLastSend == 0)\n+        {\n+            LogPrint(BCLog::NET, \"socket no message in first 60 seconds, %d %d from %d\\n\", pnode->nLastRecv != 0, pnode->nLastSend != 0, pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+        else if (nTime - pnode->nLastSend > TIMEOUT_INTERVAL)\n         {\n-            LOCK(cs_vNodes);\n-            vNodesSize = vNodes.size();\n+            LogPrintf(\"socket sending timeout: %is\\n\", nTime - pnode->nLastSend);\n+            pnode->fDisconnect = true;\n         }\n-        if(vNodesSize != nPrevNodeCount) {\n-            nPrevNodeCount = vNodesSize;\n-            if(clientInterface)\n-                clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+        else if (nTime - pnode->nLastRecv > (pnode->nVersion > BIP0031_VERSION ? TIMEOUT_INTERVAL : 90*60))\n+        {\n+            LogPrintf(\"socket receive timeout: %is\\n\", nTime - pnode->nLastRecv);\n+            pnode->fDisconnect = true;\n         }\n-\n-        //\n-        // Find which sockets have data to receive\n-        //\n-        struct timeval timeout;\n-        timeout.tv_sec  = 0;\n-        timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n-\n-        fd_set fdsetRecv;\n-        fd_set fdsetSend;\n-        fd_set fdsetError;\n-        FD_ZERO(&fdsetRecv);\n-        FD_ZERO(&fdsetSend);\n-        FD_ZERO(&fdsetError);\n-        SOCKET hSocketMax = 0;\n-        bool have_fds = false;\n-\n-        for (const ListenSocket& hListenSocket : vhListenSocket) {\n-            FD_SET(hListenSocket.socket, &fdsetRecv);\n-            hSocketMax = std::max(hSocketMax, hListenSocket.socket);\n-            have_fds = true;\n+        else if (pnode->nPingNonceSent && pnode->nPingUsecStart + TIMEOUT_INTERVAL * 1000000 < GetTimeMicros())\n+        {\n+            LogPrintf(\"ping timeout: %fs\\n\", 0.000001 * (GetTimeMicros() - pnode->nPingUsecStart));\n+            pnode->fDisconnect = true;\n         }\n+        else if (!pnode->fSuccessfullyConnected)\n+        {\n+            LogPrint(BCLog::NET, \"version handshake timeout from %d\\n\", pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+    }\n+}\n \n+void CConnman::GenerateSelectSet(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    for (const ListenSocket& hListenSocket : vhListenSocket) {\n+        recv_set.insert(hListenSocket.socket);\n+    }\n+\n+    {\n+        LOCK(cs_vNodes);\n+        for (CNode* pnode : vNodes)\n         {\n-            LOCK(cs_vNodes);\n-            for (CNode* pnode : vNodes)\n+            // Implement the following logic:\n+            // * If there is data to send, select() for sending data. As this only\n+            //   happens when optimistic write failed, we choose to first drain the\n+            //   write buffer in this case before receiving more. This avoids\n+            //   needlessly queueing received data, if the remote peer is not themselves\n+            //   receiving data. This means properly utilizing TCP flow control signalling.\n+            // * Otherwise, if there is space left in the receive buffer, select() for\n+            //   receiving data.\n+            // * Hand off all complete messages to the processor, to be handled without\n+            //   blocking here.\n+\n+            bool select_recv = !pnode->fPauseRecv;\n+            bool select_send;\n             {\n-                // Implement the following logic:\n-                // * If there is data to send, select() for sending data. As this only\n-                //   happens when optimistic write failed, we choose to first drain the\n-                //   write buffer in this case before receiving more. This avoids\n-                //   needlessly queueing received data, if the remote peer is not themselves\n-                //   receiving data. This means properly utilizing TCP flow control signalling.\n-                // * Otherwise, if there is space left in the receive buffer, select() for\n-                //   receiving data.\n-                // * Hand off all complete messages to the processor, to be handled without\n-                //   blocking here.\n-\n-                bool select_recv = !pnode->fPauseRecv;\n-                bool select_send;\n-                {\n-                    LOCK(pnode->cs_vSend);\n-                    select_send = !pnode->vSendMsg.empty();\n-                }\n-\n-                LOCK(pnode->cs_hSocket);\n-                if (pnode->hSocket == INVALID_SOCKET)\n-                    continue;\n+                LOCK(pnode->cs_vSend);\n+                select_send = !pnode->vSendMsg.empty();\n+            }\n \n-                FD_SET(pnode->hSocket, &fdsetError);\n-                hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-                have_fds = true;\n+            LOCK(pnode->cs_hSocket);\n+            if (pnode->hSocket == INVALID_SOCKET)\n+                continue;\n \n-                if (select_send) {\n-                    FD_SET(pnode->hSocket, &fdsetSend);\n-                    continue;\n-                }\n-                if (select_recv) {\n-                    FD_SET(pnode->hSocket, &fdsetRecv);\n-                }\n+            error_set.insert(pnode->hSocket);\n+            if (select_send) {\n+                send_set.insert(pnode->hSocket);\n+                continue;\n+            }\n+            if (select_recv) {\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n+    }\n+}\n \n-        int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                             &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n-        if (interruptNet)\n+#ifdef WIN32\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    //\n+    // Find which sockets have data to receive\n+    //\n+    struct timeval timeout;\n+    timeout.tv_sec  = 0;\n+    timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n+\n+    fd_set fdsetRecv;\n+    fd_set fdsetSend;\n+    fd_set fdsetError;\n+    FD_ZERO(&fdsetRecv);\n+    FD_ZERO(&fdsetSend);\n+    FD_ZERO(&fdsetError);\n+    SOCKET hSocketMax = 0;\n+\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        FD_SET(hSocket, &fdsetRecv);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        FD_SET(hSocket, &fdsetSend);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        FD_SET(hSocket, &fdsetError);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    int nSelect = select(hSocketMax + 1, &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+\n+    if (nSelect == SOCKET_ERROR)\n+    {\n+        int nErr = WSAGetLastError();\n+        LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n+        for (unsigned int i = 0; i <= hSocketMax; i++)\n+            FD_SET(i, &fdsetRecv);\n+        FD_ZERO(&fdsetSend);\n+        FD_ZERO(&fdsetError);\n+        if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n             return;\n+    }\n \n-        if (nSelect == SOCKET_ERROR)\n-        {\n-            if (have_fds)\n-            {\n-                int nErr = WSAGetLastError();\n-                LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n-                for (unsigned int i = 0; i <= hSocketMax; i++)\n-                    FD_SET(i, &fdsetRecv);\n-            }\n-            FD_ZERO(&fdsetSend);\n-            FD_ZERO(&fdsetError);\n-            if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n-                return;\n-        }\n+    for (SOCKET hSocket : recv_select_set)\n+        if(FD_ISSET(hSocket, &fdsetRecv))\n+            recv_set.insert(hSocket);\n \n-        //\n-        // Accept new connections\n-        //\n-        for (const ListenSocket& hListenSocket : vhListenSocket)\n+    for (SOCKET hSocket : send_select_set)\n+        if(FD_ISSET(hSocket, &fdsetSend))\n+            send_set.insert(hSocket);\n+\n+    for (SOCKET hSocket : error_select_set)\n+        if(FD_ISSET(hSocket, &fdsetError))\n+            error_set.insert(hSocket);\n+}\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() and error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n+    if (interruptNet)\n+        return;\n+\n+    std::vector<struct pollfd> pollfds;\n+    struct pollfd pollfd;\n+    memset(&pollfd, 0, sizeof(struct pollfd));\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLIN;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLOUT;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLERR|POLLHUP;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    if(poll(&pollfds[0], pollfds.size(), 50) < 0)\n+        LogPrint(BCLog::NET, \"poll failure %d %s\\n\", errno, strerror(errno));\n+\n+    for (struct pollfd pollfd : pollfds) {\n+        if (pollfd.revents & POLLIN)\n+            recv_set.insert(pollfd.fd);\n+        if (pollfd.revents & POLLOUT)\n+            send_set.insert(pollfd.fd);\n+        if (pollfd.revents & (POLLERR|POLLHUP))\n+            error_set.insert(pollfd.fd);\n+    }\n+}\n+#endif\n+\n+void CConnman::SocketHandler()\n+{\n+    std::set<SOCKET> recv_set, send_set, error_set;\n+    SocketEvents(recv_set, send_set, error_set);\n+\n+    if (interruptNet)\n+        return;\n+\n+    //\n+    // Accept new connections\n+    //\n+    for (const ListenSocket& hListenSocket : vhListenSocket)\n+    {\n+        if (hListenSocket.socket != INVALID_SOCKET && recv_set.count(hListenSocket.socket))\n         {\n-            if (hListenSocket.socket != INVALID_SOCKET && FD_ISSET(hListenSocket.socket, &fdsetRecv))\n-            {\n-                AcceptConnection(hListenSocket);\n-            }\n+            AcceptConnection(hListenSocket);\n         }\n+    }\n+\n+    //\n+    // Service each socket\n+    //\n+    std::vector<CNode*> vNodesCopy;\n+    {\n+        LOCK(cs_vNodes);\n+        vNodesCopy = vNodes;\n+        for (CNode* pnode : vNodesCopy)\n+            pnode->AddRef();\n+    }\n+    for (CNode* pnode : vNodesCopy)\n+    {\n+        if (interruptNet)\n+            return;\n \n         //\n-        // Service each socket\n+        // Receive\n         //\n-        std::vector<CNode*> vNodesCopy;\n+        bool recvSet = false;\n+        bool sendSet = false;\n+        bool errorSet = false;\n         {\n-            LOCK(cs_vNodes);\n-            vNodesCopy = vNodes;\n-            for (CNode* pnode : vNodesCopy)\n-                pnode->AddRef();\n+            LOCK(pnode->cs_hSocket);\n+            if (pnode->hSocket == INVALID_SOCKET)\n+                continue;\n+            recvSet = recv_set.count(pnode->hSocket);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 458,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "in_reply_to_id": 221419285,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2018-11-11T03:50:35Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232473558",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232473558"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1470,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232473559",
      "pull_request_review_id": 173683626,
      "id": 232473559,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ3MzU1OQ==",
      "diff_hunk": "@@ -1153,310 +1153,407 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\n     }\n }\n \n-void CConnman::ThreadSocketHandler()\n+void CConnman::DisconnectNodes()\n {\n-    unsigned int nPrevNodeCount = 0;\n-    while (!interruptNet)\n     {\n-        //\n-        // Disconnect nodes\n-        //\n-        {\n-            LOCK(cs_vNodes);\n+        LOCK(cs_vNodes);\n \n-            if (!fNetworkActive) {\n-                // Disconnect any connected nodes\n-                for (CNode* pnode : vNodes) {\n-                    if (!pnode->fDisconnect) {\n-                        LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n-                        pnode->fDisconnect = true;\n-                    }\n+        if (!fNetworkActive) {\n+            // Disconnect any connected nodes\n+            for (CNode* pnode : vNodes) {\n+                if (!pnode->fDisconnect) {\n+                    LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n+                    pnode->fDisconnect = true;\n                 }\n             }\n+        }\n \n-            // Disconnect unused nodes\n-            std::vector<CNode*> vNodesCopy = vNodes;\n-            for (CNode* pnode : vNodesCopy)\n+        // Disconnect unused nodes\n+        std::vector<CNode*> vNodesCopy = vNodes;\n+        for (CNode* pnode : vNodesCopy)\n+        {\n+            if (pnode->fDisconnect)\n             {\n-                if (pnode->fDisconnect)\n-                {\n-                    // remove from vNodes\n-                    vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n+                // remove from vNodes\n+                vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n \n-                    // release outbound grant (if any)\n-                    pnode->grantOutbound.Release();\n+                // release outbound grant (if any)\n+                pnode->grantOutbound.Release();\n \n-                    // close socket and cleanup\n-                    pnode->CloseSocketDisconnect();\n+                // close socket and cleanup\n+                pnode->CloseSocketDisconnect();\n \n-                    // hold in disconnected pool until all refs are released\n-                    pnode->Release();\n-                    vNodesDisconnected.push_back(pnode);\n-                }\n+                // hold in disconnected pool until all refs are released\n+                pnode->Release();\n+                vNodesDisconnected.push_back(pnode);\n             }\n         }\n+    }\n+    {\n+        // Delete disconnected nodes\n+        std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n+        for (CNode* pnode : vNodesDisconnectedCopy)\n         {\n-            // Delete disconnected nodes\n-            std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n-            for (CNode* pnode : vNodesDisconnectedCopy)\n-            {\n-                // wait until threads are done using it\n-                if (pnode->GetRefCount() <= 0) {\n-                    bool fDelete = false;\n-                    {\n-                        TRY_LOCK(pnode->cs_inventory, lockInv);\n-                        if (lockInv) {\n-                            TRY_LOCK(pnode->cs_vSend, lockSend);\n-                            if (lockSend) {\n-                                fDelete = true;\n-                            }\n+            // wait until threads are done using it\n+            if (pnode->GetRefCount() <= 0) {\n+                bool fDelete = false;\n+                {\n+                    TRY_LOCK(pnode->cs_inventory, lockInv);\n+                    if (lockInv) {\n+                        TRY_LOCK(pnode->cs_vSend, lockSend);\n+                        if (lockSend) {\n+                            fDelete = true;\n                         }\n                     }\n-                    if (fDelete) {\n-                        vNodesDisconnected.remove(pnode);\n-                        DeleteNode(pnode);\n-                    }\n+                }\n+                if (fDelete) {\n+                    vNodesDisconnected.remove(pnode);\n+                    DeleteNode(pnode);\n                 }\n             }\n         }\n-        size_t vNodesSize;\n+    }\n+}\n+\n+void CConnman::NotifyNumConnectionsChanged()\n+{\n+    size_t vNodesSize;\n+    {\n+        LOCK(cs_vNodes);\n+        vNodesSize = vNodes.size();\n+    }\n+    if(vNodesSize != nPrevNodeCount) {\n+        nPrevNodeCount = vNodesSize;\n+        if(clientInterface)\n+            clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+    }\n+}\n+\n+void CConnman::InactivityCheck(CNode *pnode)\n+{\n+    int64_t nTime = GetSystemTimeInSeconds();\n+    if (nTime - pnode->nTimeConnected > 60)\n+    {\n+        if (pnode->nLastRecv == 0 || pnode->nLastSend == 0)\n+        {\n+            LogPrint(BCLog::NET, \"socket no message in first 60 seconds, %d %d from %d\\n\", pnode->nLastRecv != 0, pnode->nLastSend != 0, pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+        else if (nTime - pnode->nLastSend > TIMEOUT_INTERVAL)\n         {\n-            LOCK(cs_vNodes);\n-            vNodesSize = vNodes.size();\n+            LogPrintf(\"socket sending timeout: %is\\n\", nTime - pnode->nLastSend);\n+            pnode->fDisconnect = true;\n         }\n-        if(vNodesSize != nPrevNodeCount) {\n-            nPrevNodeCount = vNodesSize;\n-            if(clientInterface)\n-                clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+        else if (nTime - pnode->nLastRecv > (pnode->nVersion > BIP0031_VERSION ? TIMEOUT_INTERVAL : 90*60))\n+        {\n+            LogPrintf(\"socket receive timeout: %is\\n\", nTime - pnode->nLastRecv);\n+            pnode->fDisconnect = true;\n         }\n-\n-        //\n-        // Find which sockets have data to receive\n-        //\n-        struct timeval timeout;\n-        timeout.tv_sec  = 0;\n-        timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n-\n-        fd_set fdsetRecv;\n-        fd_set fdsetSend;\n-        fd_set fdsetError;\n-        FD_ZERO(&fdsetRecv);\n-        FD_ZERO(&fdsetSend);\n-        FD_ZERO(&fdsetError);\n-        SOCKET hSocketMax = 0;\n-        bool have_fds = false;\n-\n-        for (const ListenSocket& hListenSocket : vhListenSocket) {\n-            FD_SET(hListenSocket.socket, &fdsetRecv);\n-            hSocketMax = std::max(hSocketMax, hListenSocket.socket);\n-            have_fds = true;\n+        else if (pnode->nPingNonceSent && pnode->nPingUsecStart + TIMEOUT_INTERVAL * 1000000 < GetTimeMicros())\n+        {\n+            LogPrintf(\"ping timeout: %fs\\n\", 0.000001 * (GetTimeMicros() - pnode->nPingUsecStart));\n+            pnode->fDisconnect = true;\n         }\n+        else if (!pnode->fSuccessfullyConnected)\n+        {\n+            LogPrint(BCLog::NET, \"version handshake timeout from %d\\n\", pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+    }\n+}\n \n+void CConnman::GenerateSelectSet(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    for (const ListenSocket& hListenSocket : vhListenSocket) {\n+        recv_set.insert(hListenSocket.socket);\n+    }\n+\n+    {\n+        LOCK(cs_vNodes);\n+        for (CNode* pnode : vNodes)\n         {\n-            LOCK(cs_vNodes);\n-            for (CNode* pnode : vNodes)\n+            // Implement the following logic:\n+            // * If there is data to send, select() for sending data. As this only\n+            //   happens when optimistic write failed, we choose to first drain the\n+            //   write buffer in this case before receiving more. This avoids\n+            //   needlessly queueing received data, if the remote peer is not themselves\n+            //   receiving data. This means properly utilizing TCP flow control signalling.\n+            // * Otherwise, if there is space left in the receive buffer, select() for\n+            //   receiving data.\n+            // * Hand off all complete messages to the processor, to be handled without\n+            //   blocking here.\n+\n+            bool select_recv = !pnode->fPauseRecv;\n+            bool select_send;\n             {\n-                // Implement the following logic:\n-                // * If there is data to send, select() for sending data. As this only\n-                //   happens when optimistic write failed, we choose to first drain the\n-                //   write buffer in this case before receiving more. This avoids\n-                //   needlessly queueing received data, if the remote peer is not themselves\n-                //   receiving data. This means properly utilizing TCP flow control signalling.\n-                // * Otherwise, if there is space left in the receive buffer, select() for\n-                //   receiving data.\n-                // * Hand off all complete messages to the processor, to be handled without\n-                //   blocking here.\n-\n-                bool select_recv = !pnode->fPauseRecv;\n-                bool select_send;\n-                {\n-                    LOCK(pnode->cs_vSend);\n-                    select_send = !pnode->vSendMsg.empty();\n-                }\n-\n-                LOCK(pnode->cs_hSocket);\n-                if (pnode->hSocket == INVALID_SOCKET)\n-                    continue;\n+                LOCK(pnode->cs_vSend);\n+                select_send = !pnode->vSendMsg.empty();\n+            }\n \n-                FD_SET(pnode->hSocket, &fdsetError);\n-                hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-                have_fds = true;\n+            LOCK(pnode->cs_hSocket);\n+            if (pnode->hSocket == INVALID_SOCKET)\n+                continue;\n \n-                if (select_send) {\n-                    FD_SET(pnode->hSocket, &fdsetSend);\n-                    continue;\n-                }\n-                if (select_recv) {\n-                    FD_SET(pnode->hSocket, &fdsetRecv);\n-                }\n+            error_set.insert(pnode->hSocket);\n+            if (select_send) {\n+                send_set.insert(pnode->hSocket);\n+                continue;\n+            }\n+            if (select_recv) {\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n+    }\n+}\n \n-        int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                             &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n-        if (interruptNet)\n+#ifdef WIN32\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    //\n+    // Find which sockets have data to receive\n+    //\n+    struct timeval timeout;\n+    timeout.tv_sec  = 0;\n+    timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n+\n+    fd_set fdsetRecv;\n+    fd_set fdsetSend;\n+    fd_set fdsetError;\n+    FD_ZERO(&fdsetRecv);\n+    FD_ZERO(&fdsetSend);\n+    FD_ZERO(&fdsetError);\n+    SOCKET hSocketMax = 0;\n+\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        FD_SET(hSocket, &fdsetRecv);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        FD_SET(hSocket, &fdsetSend);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        FD_SET(hSocket, &fdsetError);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    int nSelect = select(hSocketMax + 1, &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+\n+    if (nSelect == SOCKET_ERROR)\n+    {\n+        int nErr = WSAGetLastError();\n+        LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n+        for (unsigned int i = 0; i <= hSocketMax; i++)\n+            FD_SET(i, &fdsetRecv);\n+        FD_ZERO(&fdsetSend);\n+        FD_ZERO(&fdsetError);\n+        if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n             return;\n+    }\n \n-        if (nSelect == SOCKET_ERROR)\n-        {\n-            if (have_fds)\n-            {\n-                int nErr = WSAGetLastError();\n-                LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n-                for (unsigned int i = 0; i <= hSocketMax; i++)\n-                    FD_SET(i, &fdsetRecv);\n-            }\n-            FD_ZERO(&fdsetSend);\n-            FD_ZERO(&fdsetError);\n-            if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n-                return;\n-        }\n+    for (SOCKET hSocket : recv_select_set)\n+        if(FD_ISSET(hSocket, &fdsetRecv))\n+            recv_set.insert(hSocket);\n \n-        //\n-        // Accept new connections\n-        //\n-        for (const ListenSocket& hListenSocket : vhListenSocket)\n+    for (SOCKET hSocket : send_select_set)\n+        if(FD_ISSET(hSocket, &fdsetSend))\n+            send_set.insert(hSocket);\n+\n+    for (SOCKET hSocket : error_select_set)\n+        if(FD_ISSET(hSocket, &fdsetError))\n+            error_set.insert(hSocket);\n+}\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() and error_select_set.empty()) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 360,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "in_reply_to_id": 221419345,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2018-11-11T03:50:41Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232473559",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232473559"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1382,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232473562",
      "pull_request_review_id": 173683629,
      "id": 232473562,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ3MzU2Mg==",
      "diff_hunk": "@@ -1153,310 +1153,407 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\n     }\n }\n \n-void CConnman::ThreadSocketHandler()\n+void CConnman::DisconnectNodes()\n {\n-    unsigned int nPrevNodeCount = 0;\n-    while (!interruptNet)\n     {\n-        //\n-        // Disconnect nodes\n-        //\n-        {\n-            LOCK(cs_vNodes);\n+        LOCK(cs_vNodes);\n \n-            if (!fNetworkActive) {\n-                // Disconnect any connected nodes\n-                for (CNode* pnode : vNodes) {\n-                    if (!pnode->fDisconnect) {\n-                        LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n-                        pnode->fDisconnect = true;\n-                    }\n+        if (!fNetworkActive) {\n+            // Disconnect any connected nodes\n+            for (CNode* pnode : vNodes) {\n+                if (!pnode->fDisconnect) {\n+                    LogPrint(BCLog::NET, \"Network not active, dropping peer=%d\\n\", pnode->GetId());\n+                    pnode->fDisconnect = true;\n                 }\n             }\n+        }\n \n-            // Disconnect unused nodes\n-            std::vector<CNode*> vNodesCopy = vNodes;\n-            for (CNode* pnode : vNodesCopy)\n+        // Disconnect unused nodes\n+        std::vector<CNode*> vNodesCopy = vNodes;\n+        for (CNode* pnode : vNodesCopy)\n+        {\n+            if (pnode->fDisconnect)\n             {\n-                if (pnode->fDisconnect)\n-                {\n-                    // remove from vNodes\n-                    vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n+                // remove from vNodes\n+                vNodes.erase(remove(vNodes.begin(), vNodes.end(), pnode), vNodes.end());\n \n-                    // release outbound grant (if any)\n-                    pnode->grantOutbound.Release();\n+                // release outbound grant (if any)\n+                pnode->grantOutbound.Release();\n \n-                    // close socket and cleanup\n-                    pnode->CloseSocketDisconnect();\n+                // close socket and cleanup\n+                pnode->CloseSocketDisconnect();\n \n-                    // hold in disconnected pool until all refs are released\n-                    pnode->Release();\n-                    vNodesDisconnected.push_back(pnode);\n-                }\n+                // hold in disconnected pool until all refs are released\n+                pnode->Release();\n+                vNodesDisconnected.push_back(pnode);\n             }\n         }\n+    }\n+    {\n+        // Delete disconnected nodes\n+        std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n+        for (CNode* pnode : vNodesDisconnectedCopy)\n         {\n-            // Delete disconnected nodes\n-            std::list<CNode*> vNodesDisconnectedCopy = vNodesDisconnected;\n-            for (CNode* pnode : vNodesDisconnectedCopy)\n-            {\n-                // wait until threads are done using it\n-                if (pnode->GetRefCount() <= 0) {\n-                    bool fDelete = false;\n-                    {\n-                        TRY_LOCK(pnode->cs_inventory, lockInv);\n-                        if (lockInv) {\n-                            TRY_LOCK(pnode->cs_vSend, lockSend);\n-                            if (lockSend) {\n-                                fDelete = true;\n-                            }\n+            // wait until threads are done using it\n+            if (pnode->GetRefCount() <= 0) {\n+                bool fDelete = false;\n+                {\n+                    TRY_LOCK(pnode->cs_inventory, lockInv);\n+                    if (lockInv) {\n+                        TRY_LOCK(pnode->cs_vSend, lockSend);\n+                        if (lockSend) {\n+                            fDelete = true;\n                         }\n                     }\n-                    if (fDelete) {\n-                        vNodesDisconnected.remove(pnode);\n-                        DeleteNode(pnode);\n-                    }\n+                }\n+                if (fDelete) {\n+                    vNodesDisconnected.remove(pnode);\n+                    DeleteNode(pnode);\n                 }\n             }\n         }\n-        size_t vNodesSize;\n+    }\n+}\n+\n+void CConnman::NotifyNumConnectionsChanged()\n+{\n+    size_t vNodesSize;\n+    {\n+        LOCK(cs_vNodes);\n+        vNodesSize = vNodes.size();\n+    }\n+    if(vNodesSize != nPrevNodeCount) {\n+        nPrevNodeCount = vNodesSize;\n+        if(clientInterface)\n+            clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+    }\n+}\n+\n+void CConnman::InactivityCheck(CNode *pnode)\n+{\n+    int64_t nTime = GetSystemTimeInSeconds();\n+    if (nTime - pnode->nTimeConnected > 60)\n+    {\n+        if (pnode->nLastRecv == 0 || pnode->nLastSend == 0)\n+        {\n+            LogPrint(BCLog::NET, \"socket no message in first 60 seconds, %d %d from %d\\n\", pnode->nLastRecv != 0, pnode->nLastSend != 0, pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+        else if (nTime - pnode->nLastSend > TIMEOUT_INTERVAL)\n         {\n-            LOCK(cs_vNodes);\n-            vNodesSize = vNodes.size();\n+            LogPrintf(\"socket sending timeout: %is\\n\", nTime - pnode->nLastSend);\n+            pnode->fDisconnect = true;\n         }\n-        if(vNodesSize != nPrevNodeCount) {\n-            nPrevNodeCount = vNodesSize;\n-            if(clientInterface)\n-                clientInterface->NotifyNumConnectionsChanged(vNodesSize);\n+        else if (nTime - pnode->nLastRecv > (pnode->nVersion > BIP0031_VERSION ? TIMEOUT_INTERVAL : 90*60))\n+        {\n+            LogPrintf(\"socket receive timeout: %is\\n\", nTime - pnode->nLastRecv);\n+            pnode->fDisconnect = true;\n         }\n-\n-        //\n-        // Find which sockets have data to receive\n-        //\n-        struct timeval timeout;\n-        timeout.tv_sec  = 0;\n-        timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n-\n-        fd_set fdsetRecv;\n-        fd_set fdsetSend;\n-        fd_set fdsetError;\n-        FD_ZERO(&fdsetRecv);\n-        FD_ZERO(&fdsetSend);\n-        FD_ZERO(&fdsetError);\n-        SOCKET hSocketMax = 0;\n-        bool have_fds = false;\n-\n-        for (const ListenSocket& hListenSocket : vhListenSocket) {\n-            FD_SET(hListenSocket.socket, &fdsetRecv);\n-            hSocketMax = std::max(hSocketMax, hListenSocket.socket);\n-            have_fds = true;\n+        else if (pnode->nPingNonceSent && pnode->nPingUsecStart + TIMEOUT_INTERVAL * 1000000 < GetTimeMicros())\n+        {\n+            LogPrintf(\"ping timeout: %fs\\n\", 0.000001 * (GetTimeMicros() - pnode->nPingUsecStart));\n+            pnode->fDisconnect = true;\n         }\n+        else if (!pnode->fSuccessfullyConnected)\n+        {\n+            LogPrint(BCLog::NET, \"version handshake timeout from %d\\n\", pnode->GetId());\n+            pnode->fDisconnect = true;\n+        }\n+    }\n+}\n \n+void CConnman::GenerateSelectSet(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    for (const ListenSocket& hListenSocket : vhListenSocket) {\n+        recv_set.insert(hListenSocket.socket);\n+    }\n+\n+    {\n+        LOCK(cs_vNodes);\n+        for (CNode* pnode : vNodes)\n         {\n-            LOCK(cs_vNodes);\n-            for (CNode* pnode : vNodes)\n+            // Implement the following logic:\n+            // * If there is data to send, select() for sending data. As this only\n+            //   happens when optimistic write failed, we choose to first drain the\n+            //   write buffer in this case before receiving more. This avoids\n+            //   needlessly queueing received data, if the remote peer is not themselves\n+            //   receiving data. This means properly utilizing TCP flow control signalling.\n+            // * Otherwise, if there is space left in the receive buffer, select() for\n+            //   receiving data.\n+            // * Hand off all complete messages to the processor, to be handled without\n+            //   blocking here.\n+\n+            bool select_recv = !pnode->fPauseRecv;\n+            bool select_send;\n             {\n-                // Implement the following logic:\n-                // * If there is data to send, select() for sending data. As this only\n-                //   happens when optimistic write failed, we choose to first drain the\n-                //   write buffer in this case before receiving more. This avoids\n-                //   needlessly queueing received data, if the remote peer is not themselves\n-                //   receiving data. This means properly utilizing TCP flow control signalling.\n-                // * Otherwise, if there is space left in the receive buffer, select() for\n-                //   receiving data.\n-                // * Hand off all complete messages to the processor, to be handled without\n-                //   blocking here.\n-\n-                bool select_recv = !pnode->fPauseRecv;\n-                bool select_send;\n-                {\n-                    LOCK(pnode->cs_vSend);\n-                    select_send = !pnode->vSendMsg.empty();\n-                }\n-\n-                LOCK(pnode->cs_hSocket);\n-                if (pnode->hSocket == INVALID_SOCKET)\n-                    continue;\n+                LOCK(pnode->cs_vSend);\n+                select_send = !pnode->vSendMsg.empty();\n+            }\n \n-                FD_SET(pnode->hSocket, &fdsetError);\n-                hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-                have_fds = true;\n+            LOCK(pnode->cs_hSocket);\n+            if (pnode->hSocket == INVALID_SOCKET)\n+                continue;\n \n-                if (select_send) {\n-                    FD_SET(pnode->hSocket, &fdsetSend);\n-                    continue;\n-                }\n-                if (select_recv) {\n-                    FD_SET(pnode->hSocket, &fdsetRecv);\n-                }\n+            error_set.insert(pnode->hSocket);\n+            if (select_send) {\n+                send_set.insert(pnode->hSocket);\n+                continue;\n+            }\n+            if (select_recv) {\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n+    }\n+}\n \n-        int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                             &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n-        if (interruptNet)\n+#ifdef WIN32\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    //\n+    // Find which sockets have data to receive\n+    //\n+    struct timeval timeout;\n+    timeout.tv_sec  = 0;\n+    timeout.tv_usec = 50000; // frequency to poll pnode->vSend\n+\n+    fd_set fdsetRecv;\n+    fd_set fdsetSend;\n+    fd_set fdsetError;\n+    FD_ZERO(&fdsetRecv);\n+    FD_ZERO(&fdsetSend);\n+    FD_ZERO(&fdsetError);\n+    SOCKET hSocketMax = 0;\n+\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() && error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        FD_SET(hSocket, &fdsetRecv);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        FD_SET(hSocket, &fdsetSend);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        FD_SET(hSocket, &fdsetError);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    int nSelect = select(hSocketMax + 1, &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+\n+    if (nSelect == SOCKET_ERROR)\n+    {\n+        int nErr = WSAGetLastError();\n+        LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n+        for (unsigned int i = 0; i <= hSocketMax; i++)\n+            FD_SET(i, &fdsetRecv);\n+        FD_ZERO(&fdsetSend);\n+        FD_ZERO(&fdsetError);\n+        if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n             return;\n+    }\n \n-        if (nSelect == SOCKET_ERROR)\n-        {\n-            if (have_fds)\n-            {\n-                int nErr = WSAGetLastError();\n-                LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n-                for (unsigned int i = 0; i <= hSocketMax; i++)\n-                    FD_SET(i, &fdsetRecv);\n-            }\n-            FD_ZERO(&fdsetSend);\n-            FD_ZERO(&fdsetError);\n-            if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n-                return;\n-        }\n+    for (SOCKET hSocket : recv_select_set)\n+        if(FD_ISSET(hSocket, &fdsetRecv))\n+            recv_set.insert(hSocket);\n \n-        //\n-        // Accept new connections\n-        //\n-        for (const ListenSocket& hListenSocket : vhListenSocket)\n+    for (SOCKET hSocket : send_select_set)\n+        if(FD_ISSET(hSocket, &fdsetSend))\n+            send_set.insert(hSocket);\n+\n+    for (SOCKET hSocket : error_select_set)\n+        if(FD_ISSET(hSocket, &fdsetError))\n+            error_set.insert(hSocket);\n+}\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    GenerateSelectSet(recv_select_set, send_select_set, error_select_set);\n+\n+    if (recv_select_set.empty() && send_select_set.empty() and error_select_set.empty()) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(50));\n+        return;\n+    }\n+\n+    if (interruptNet)\n+        return;\n+\n+    std::vector<struct pollfd> pollfds;\n+    struct pollfd pollfd;\n+    memset(&pollfd, 0, sizeof(struct pollfd));\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLIN;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLOUT;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        pollfd.fd = hSocket;\n+        pollfd.events = POLLERR|POLLHUP;\n+        pollfds.push_back(pollfd);\n+    }\n+\n+    if(poll(&pollfds[0], pollfds.size(), 50) < 0)\n+        LogPrint(BCLog::NET, \"poll failure %d %s\\n\", errno, strerror(errno));\n+\n+    for (struct pollfd pollfd : pollfds) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 393,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "7fd976b2f0abab75c81ab8923daba286831d5260",
      "in_reply_to_id": 221419392,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2018-11-11T03:50:48Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r232473562",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232473562"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1424,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/235777795",
      "pull_request_review_id": 177722963,
      "id": 235777795,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNTc3Nzc5NQ==",
      "diff_hunk": "@@ -32,6 +32,7 @@\n \n #ifndef WIN32\n #include <arpa/inet.h>\n+#include <poll.h>",
      "path": "src/net.h",
      "position": null,
      "original_position": 4,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "feca5fb7e4356f68094c440a679ec382b04b0c69",
      "in_reply_to_id": null,
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Should this be behind `#ifdef USE_POLL` instead? To match the `pollfd` reference below.",
      "created_at": "2018-11-22T16:18:38Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r235777795",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/235777795"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 35,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/235778556",
      "pull_request_review_id": 177723964,
      "id": 235778556,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNTc3ODU1Ng==",
      "diff_hunk": "@@ -17,6 +17,10 @@\n #include <string>\n #include <vector>\n \n+#ifndef WIN32",
      "path": "src/netbase.h",
      "position": null,
      "original_position": 4,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "feca5fb7e4356f68094c440a679ec382b04b0c69",
      "in_reply_to_id": null,
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Seems this include should be in `netbase.cpp`, given there's no publicly exposed reference.",
      "created_at": "2018-11-22T16:21:33Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r235778556",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/235778556"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 20,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/235780957",
      "pull_request_review_id": 177727022,
      "id": 235780957,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNTc4MDk1Nw==",
      "diff_hunk": "@@ -944,8 +944,12 @@ bool AppInitParameterInteraction()\n \n     // Trim requested connection counts, to fit into system limitations\n     // <int> in std::min<int>(...) to work around FreeBSD compilation issue described in #2695\n-    nMaxConnections = std::max(std::min<int>(nMaxConnections, FD_SETSIZE - nBind - MIN_CORE_FILEDESCRIPTORS - MAX_ADDNODE_CONNECTIONS), 0);\n     nFD = RaiseFileDescriptorLimit(nMaxConnections + MIN_CORE_FILEDESCRIPTORS + MAX_ADDNODE_CONNECTIONS);\n+#ifdef USE_POLL\n+    nMaxConnections = std::max(std::min<int>(nMaxConnections, nFD - nBind - MIN_CORE_FILEDESCRIPTORS - MAX_ADDNODE_CONNECTIONS), 0);\n+#else\n+    nMaxConnections = std::max(std::min<int>(nMaxConnections, FD_SETSIZE - nBind - MIN_CORE_FILEDESCRIPTORS - MAX_ADDNODE_CONNECTIONS), 0);\n+#endif",
      "path": "src/init.cpp",
      "position": 10,
      "original_position": 10,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "feca5fb7e4356f68094c440a679ec382b04b0c69",
      "in_reply_to_id": null,
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: would be nice to avoid the duplication between these lines, something like:\r\n\r\n```C++\r\n#ifdef USE_POLL\r\n    int fd_max = nFD;\r\n#else\r\n    int fd_max = FD_SETSIZE;\r\n#endif\r\n    nMaxConnections = std::max(std::min<int>(nMaxConnections, fd_max - nBind - MIN_CORE_FILEDESCRIPTORS - MAX_ADDNODE_CONNECTIONS), 0);\r\n```",
      "created_at": "2018-11-22T16:30:41Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r235780957",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/235780957"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 960,
      "original_line": 960,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/235782693",
      "pull_request_review_id": 177729201,
      "id": 235782693,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNTc4MjY5Mw==",
      "diff_hunk": "@@ -1312,46 +1299,154 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::BuildPollfds(std::vector<struct pollfd> &vpollfds) {\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }",
      "path": "src/net.cpp",
      "position": 94,
      "original_position": 82,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "feca5fb7e4356f68094c440a679ec382b04b0c69",
      "in_reply_to_id": null,
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If this fails, we probs don't want to call `poll` in `SocketEvents`, right? Seems better to return false and handle the error in the caller.",
      "created_at": "2018-11-22T16:37:51Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r235782693",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/235782693"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1322,
      "original_line": 1322,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/235783267",
      "pull_request_review_id": 177729950,
      "id": 235783267,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNTc4MzI2Nw==",
      "diff_hunk": "@@ -1312,46 +1299,154 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::BuildPollfds(std::vector<struct pollfd> &vpollfds) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 77,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "feca5fb7e4356f68094c440a679ec382b04b0c69",
      "in_reply_to_id": null,
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This could overload `GenerateSelectSet`, maybe under a different name - e.g. `GenerateEventSet`",
      "created_at": "2018-11-22T16:40:12Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r235783267",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/235783267"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1316,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/235783932",
      "pull_request_review_id": 177730789,
      "id": 235783932,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNTc4MzkzMg==",
      "diff_hunk": "@@ -1312,46 +1299,154 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::BuildPollfds(std::vector<struct pollfd> &vpollfds) {\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::unordered_map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET socket_id : recv_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        pollfds[socket_id].events |= POLLIN;\n+    }\n+\n+    for (SOCKET socket_id : send_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        pollfds[socket_id].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET socket_id : error_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[socket_id].events |= POLLERR|POLLHUP;\n+    }\n+\n+    vpollfds.reserve(pollfds.size());\n+    for (auto it : pollfds) {\n+        vpollfds.push_back(std::move(it.second));\n+    }\n+}\n+\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::vector<struct pollfd> vpollfds;\n+    BuildPollfds(vpollfds);\n+    if (poll(vpollfds.data(), vpollfds.size(), SELECT_TIMEOUT_MILLISECONDS) < 0) return;\n+\n+    if (interruptNet) return;\n+\n+    for (struct pollfd pollfd_entry : vpollfds) {\n+        if (pollfd_entry.revents & POLLIN)            recv_set.insert(pollfd_entry.fd);\n+        if (pollfd_entry.revents & POLLOUT)           send_set.insert(pollfd_entry.fd);\n+        if (pollfd_entry.revents & (POLLERR|POLLHUP)) error_set.insert(pollfd_entry.fd);\n+    }\n+}\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    //\n+    // Find which sockets have data to receive\n+    //\n+    struct timeval timeout;\n+    timeout.tv_sec  = 0;\n+    timeout.tv_usec = SELECT_TIMEOUT_MILLISECONDS * 1000; // frequency to poll pnode->vSend\n+\n+    fd_set fdsetRecv;\n+    fd_set fdsetSend;\n+    fd_set fdsetError;\n+    FD_ZERO(&fdsetRecv);\n+    FD_ZERO(&fdsetSend);\n+    FD_ZERO(&fdsetError);\n+    SOCKET hSocketMax = 0;\n+\n+    for (SOCKET hSocket : recv_select_set) {\n+        FD_SET(hSocket, &fdsetRecv);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : send_select_set) {\n+        FD_SET(hSocket, &fdsetSend);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    for (SOCKET hSocket : error_select_set) {\n+        FD_SET(hSocket, &fdsetError);\n+        hSocketMax = std::max(hSocketMax, hSocket);\n+    }\n+\n+    int nSelect = select(hSocketMax + 1, &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+\n     if (interruptNet)\n         return;\n \n     if (nSelect == SOCKET_ERROR)\n     {\n-        if (have_fds)\n-        {\n-            int nErr = WSAGetLastError();\n-            LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n-            for (unsigned int i = 0; i <= hSocketMax; i++)\n-                FD_SET(i, &fdsetRecv);\n-        }\n+        int nErr = WSAGetLastError();\n+        LogPrintf(\"socket select error %s\\n\", NetworkErrorString(nErr));\n+        for (unsigned int i = 0; i <= hSocketMax; i++)\n+            FD_SET(i, &fdsetRecv);\n         FD_ZERO(&fdsetSend);\n         FD_ZERO(&fdsetError);\n-        if (!interruptNet.sleep_for(std::chrono::milliseconds(timeout.tv_usec/1000)))\n+        if (!interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS)))\n             return;\n     }\n \n+    for (SOCKET hSocket : recv_select_set) {\n+        if(FD_ISSET(hSocket, &fdsetRecv)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 186,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "feca5fb7e4356f68094c440a679ec382b04b0c69",
      "in_reply_to_id": null,
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "There are a few whitespace issues, could do with running clang-format.",
      "created_at": "2018-11-22T16:43:09Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r235783932",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/235783932"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1419,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/237692484",
      "pull_request_review_id": 180057479,
      "id": 237692484,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNzY5MjQ4NA==",
      "diff_hunk": "@@ -1312,46 +1299,154 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::BuildPollfds(std::vector<struct pollfd> &vpollfds) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 77,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "feca5fb7e4356f68094c440a679ec382b04b0c69",
      "in_reply_to_id": 235783267,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is really just temporary to ensure there's no performance issues, the last commit will probably be removed actually.",
      "created_at": "2018-11-29T23:02:04Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r237692484",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/237692484"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1316,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/238323382",
      "pull_request_review_id": 180835685,
      "id": 238323382,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzODMyMzM4Mg==",
      "diff_hunk": "@@ -1307,46 +1298,151 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::unordered_map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET socket_id : recv_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        pollfds[socket_id].events |= POLLIN;\n+    }\n+\n+    for (SOCKET socket_id : send_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        pollfds[socket_id].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET socket_id : error_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[socket_id].events |= POLLERR|POLLHUP;\n+    }\n+\n+    std::vector<struct pollfd> vpollfds;\n+    vpollfds.reserve(pollfds.size());\n+    for (auto it : pollfds) {\n+        vpollfds.push_back(std::move(it.second));\n+    }\n+\n+    if (poll(vpollfds.data(), vpollfds.size(), SELECT_TIMEOUT_MILLISECONDS) < 0) return;",
      "path": "src/net.cpp",
      "position": 119,
      "original_position": 119,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "20c9601e6b7c4297f39de149d26292c368b63ff8",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "(non-blocking) Wondering if it's worth logging a negative error code here, eg \r\n```patch\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex 7b8b6e5ea2..3b05aad6d1 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -1344,7 +1344,10 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\r\n         vpollfds.push_back(std::move(it.second));\r\n     }\r\n \r\n-    if (poll(vpollfds.data(), vpollfds.size(), SELECT_TIMEOUT_MILLISECONDS) < 0) return;\r\n+    if (poll(vpollfds.data(), vpollfds.size(), SELECT_TIMEOUT_MILLISECONDS) < 0) {\r\n+        LogPrint(BCLog::NET, \"Poll failed (errno %d)\\n\", WSAGetLastError());\r\n+        return;\r\n+    }\r\n \r\n     if (interruptNet) return;\r\n \r\n\r\n```",
      "created_at": "2018-12-03T15:50:52Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r238323382",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/238323382"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1347,
      "original_line": 1347,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/238325977",
      "pull_request_review_id": 180835685,
      "id": 238325977,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzODMyNTk3Nw==",
      "diff_hunk": "@@ -1307,46 +1298,151 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::unordered_map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET socket_id : recv_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        pollfds[socket_id].events |= POLLIN;\n+    }\n+\n+    for (SOCKET socket_id : send_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        pollfds[socket_id].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET socket_id : error_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[socket_id].events |= POLLERR|POLLHUP;\n+    }\n+\n+    std::vector<struct pollfd> vpollfds;\n+    vpollfds.reserve(pollfds.size());\n+    for (auto it : pollfds) {\n+        vpollfds.push_back(std::move(it.second));\n+    }\n+\n+    if (poll(vpollfds.data(), vpollfds.size(), SELECT_TIMEOUT_MILLISECONDS) < 0) return;\n+\n+    if (interruptNet) return;\n+\n+    for (struct pollfd pollfd_entry : vpollfds) {\n+        if (pollfd_entry.revents & POLLIN)            recv_set.insert(pollfd_entry.fd);\n+        if (pollfd_entry.revents & POLLOUT)           send_set.insert(pollfd_entry.fd);\n+        if (pollfd_entry.revents & (POLLERR|POLLHUP)) error_set.insert(pollfd_entry.fd);\n+    }\n+}\n+#else\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)",
      "path": "src/net.cpp",
      "position": 130,
      "original_position": 130,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "20c9601e6b7c4297f39de149d26292c368b63ff8",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "(non-blocking)\r\n```patch\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex 7b8b6e5ea2..03d165d701 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -1355,6 +1355,7 @@ void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_s\r\n     }\r\n }\r\n #else\r\n+// Use select() on platforms where poll() is unavailable.\r\n void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\r\n {\r\n     std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\r\n```",
      "created_at": "2018-12-03T15:56:50Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r238325977",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/238325977"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1358,
      "original_line": 1358,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/238330665",
      "pull_request_review_id": 180835685,
      "id": 238330665,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzODMzMDY2NQ==",
      "diff_hunk": "@@ -264,11 +268,18 @@ static IntrRecvError InterruptibleRecv(uint8_t* data, size_t len, int timeout, c\n                 if (!IsSelectableSocket(hSocket)) {\n                     return IntrRecvError::NetworkError;\n                 }\n+#ifdef USE_POLL\n+                struct pollfd pollfd = {};\n+                pollfd.fd = hSocket;\n+                pollfd.events = POLLIN | POLLOUT;\n+                int nRet = poll(&pollfd, 1, std::min(endTime - curTime, maxWait));\n+#else\n                 struct timeval tval = MillisToTimeval(std::min(endTime - curTime, maxWait));",
      "path": "src/netbase.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "20c9601e6b7c4297f39de149d26292c368b63ff8",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "(non-blocking) `std::min(endTime - curTime, maxWait)` could be deduplicated.",
      "created_at": "2018-12-03T16:07:25Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r238330665",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/238330665"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 277,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/238332711",
      "pull_request_review_id": 180835685,
      "id": 238332711,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzODMzMjcxMQ==",
      "diff_hunk": "@@ -264,11 +268,18 @@ static IntrRecvError InterruptibleRecv(uint8_t* data, size_t len, int timeout, c\n                 if (!IsSelectableSocket(hSocket)) {\n                     return IntrRecvError::NetworkError;\n                 }\n+#ifdef USE_POLL\n+                struct pollfd pollfd = {};\n+                pollfd.fd = hSocket;\n+                pollfd.events = POLLIN | POLLOUT;\n+                int nRet = poll(&pollfd, 1, std::min(endTime - curTime, maxWait));\n+#else\n                 struct timeval tval = MillisToTimeval(std::min(endTime - curTime, maxWait));\n                 fd_set fdset;\n                 FD_ZERO(&fdset);\n                 FD_SET(hSocket, &fdset);\n                 int nRet = select(hSocket + 1, &fdset, nullptr, nullptr, &tval);\n+#endif\n                 if (nRet == SOCKET_ERROR) {",
      "path": "src/netbase.cpp",
      "position": 29,
      "original_position": 27,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "20c9601e6b7c4297f39de149d26292c368b63ff8",
      "in_reply_to_id": null,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "(non-blocking) This might be academic, but since this clause is handling both `select()` and `poll()` might be safer to say `if (nRet < 0)`? Though right now there's no difference in the return value for both APIs (and I doubt that'll ever change...).",
      "created_at": "2018-12-03T16:12:13Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r238332711",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/238332711"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 284,
      "original_line": 284,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/238356672",
      "pull_request_review_id": 180878068,
      "id": 238356672,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzODM1NjY3Mg==",
      "diff_hunk": "@@ -1307,46 +1298,151 @@ void CConnman::SocketHandler()\n             if (pnode->hSocket == INVALID_SOCKET)\n                 continue;\n \n-            FD_SET(pnode->hSocket, &fdsetError);\n-            hSocketMax = std::max(hSocketMax, pnode->hSocket);\n-            have_fds = true;\n-\n+            error_set.insert(pnode->hSocket);\n             if (select_send) {\n-                FD_SET(pnode->hSocket, &fdsetSend);\n+                send_set.insert(pnode->hSocket);\n                 continue;\n             }\n             if (select_recv) {\n-                FD_SET(pnode->hSocket, &fdsetRecv);\n+                recv_set.insert(pnode->hSocket);\n             }\n         }\n     }\n \n-    int nSelect = select(have_fds ? hSocketMax + 1 : 0,\n-                         &fdsetRecv, &fdsetSend, &fdsetError, &timeout);\n+    return !recv_set.empty() || !send_set.empty() || !error_set.empty();\n+}\n+\n+#ifdef USE_POLL\n+void CConnman::SocketEvents(std::set<SOCKET> &recv_set, std::set<SOCKET> &send_set, std::set<SOCKET> &error_set)\n+{\n+    std::set<SOCKET> recv_select_set, send_select_set, error_select_set;\n+    if (!GenerateSelectSet(recv_select_set, send_select_set, error_select_set)) {\n+        interruptNet.sleep_for(std::chrono::milliseconds(SELECT_TIMEOUT_MILLISECONDS));\n+        return;\n+    }\n+\n+    std::unordered_map<SOCKET, struct pollfd> pollfds;\n+    for (SOCKET socket_id : recv_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        pollfds[socket_id].events |= POLLIN;\n+    }\n+\n+    for (SOCKET socket_id : send_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        pollfds[socket_id].events |= POLLOUT;\n+    }\n+\n+    for (SOCKET socket_id : error_select_set) {\n+        pollfds[socket_id].fd = socket_id;\n+        // These flags are ignored, but we set them for clarity\n+        pollfds[socket_id].events |= POLLERR|POLLHUP;\n+    }\n+\n+    std::vector<struct pollfd> vpollfds;\n+    vpollfds.reserve(pollfds.size());\n+    for (auto it : pollfds) {\n+        vpollfds.push_back(std::move(it.second));\n+    }\n+\n+    if (poll(vpollfds.data(), vpollfds.size(), SELECT_TIMEOUT_MILLISECONDS) < 0) return;",
      "path": "src/net.cpp",
      "position": 119,
      "original_position": 119,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "20c9601e6b7c4297f39de149d26292c368b63ff8",
      "in_reply_to_id": 238323382,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It might be, but I'd like to cleanup the error logging more in the future, the select() code randomly spams the log with EINTR errors as well, so I'd say it's a separate issue.",
      "created_at": "2018-12-03T17:09:49Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r238356672",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/238356672"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1347,
      "original_line": 1347,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/238404313",
      "pull_request_review_id": 180938087,
      "id": 238404313,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzODQwNDMxMw==",
      "diff_hunk": "@@ -264,11 +268,18 @@ static IntrRecvError InterruptibleRecv(uint8_t* data, size_t len, int timeout, c\n                 if (!IsSelectableSocket(hSocket)) {\n                     return IntrRecvError::NetworkError;\n                 }\n+#ifdef USE_POLL\n+                struct pollfd pollfd = {};\n+                pollfd.fd = hSocket;\n+                pollfd.events = POLLIN | POLLOUT;\n+                int nRet = poll(&pollfd, 1, std::min(endTime - curTime, maxWait));\n+#else\n                 struct timeval tval = MillisToTimeval(std::min(endTime - curTime, maxWait));",
      "path": "src/netbase.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "4927bf2f257ac53569978980eaf1f61c2c6b04cc",
      "original_commit_id": "20c9601e6b7c4297f39de149d26292c368b63ff8",
      "in_reply_to_id": 238330665,
      "user": {
        "login": "pstratem",
        "id": 620611,
        "node_id": "MDQ6VXNlcjYyMDYxMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pstratem",
        "html_url": "https://github.com/pstratem",
        "followers_url": "https://api.github.com/users/pstratem/followers",
        "following_url": "https://api.github.com/users/pstratem/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pstratem/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pstratem/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
        "organizations_url": "https://api.github.com/users/pstratem/orgs",
        "repos_url": "https://api.github.com/users/pstratem/repos",
        "events_url": "https://api.github.com/users/pstratem/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pstratem/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "agreed",
      "created_at": "2018-12-03T19:26:00Z",
      "updated_at": "2018-12-03T19:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/14336#discussion_r238404313",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/238404313"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14336"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 277,
      "side": "RIGHT"
    }
  ]
}