{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197",
    "id": 506815618,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NTA2ODE1NjE4",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20197",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/20197.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/20197.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
    "number": 20197,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "p2p: protect onions in AttemptToEvictConnection(), add eviction protection test coverage",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Now that #19991 and #20210 have been merged, we can determine inbound onion peers using `CNode::m_inbound_onion` and add it to the localhost peers protection in `AttemptToEvictConnection`, which was added in #19670 to address issue #19500.\r\n\r\nUpdate 28 February 2021: I've updated this to follow gmaxwell's suggestion in https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-713865992.\r\n\r\nThis branch now protects up to 1/4 onion peers (connected via our tor control service), if any, sorted by longest uptime. If any (or all) onion slots remain after that operation, they are then allocated to protect localhost peers, or a minimum of 2 localhost peers in the case that no onion slots remain and 2 or more onion peers were protected, sorted as before by longest uptime.\r\n\r\nThis patch also adds test coverage for the longest uptime, localhost, and onion peer eviction protection logic to build on the welcome initial unit testing of #20477.\r\n\r\nSuggest reviewing the commits that move code with `colorMoved = dimmed-zebra` and `colorMovedWs = allow-indentation-change`.\r\n\r\nCloses #11537.",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "active_lock_reason": "resolved",
    "created_at": "2020-10-20T13:45:48Z",
    "updated_at": "2022-08-16T17:20:54Z",
    "closed_at": "2021-03-30T14:21:20Z",
    "mergeable_state": "unknown",
    "merged_at": "2021-03-30T14:21:20Z",
    "merge_commit_sha": "dede9eb9247363aacc3816c7352494a3609fa28b",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "jonatack:AttemptToEvictConnection-identify-onions-with-m_inbound_onion",
      "ref": "AttemptToEvictConnection-identify-onions-with-m_inbound_onion",
      "sha": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 173103842,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNzMxMDM4NDI=",
        "name": "bitcoin",
        "full_name": "jonatack/bitcoin",
        "owner": {
          "login": "jonatack",
          "id": 2415484,
          "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
          "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/jonatack",
          "html_url": "https://github.com/jonatack",
          "followers_url": "https://api.github.com/users/jonatack/followers",
          "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
          "organizations_url": "https://api.github.com/users/jonatack/orgs",
          "repos_url": "https://api.github.com/users/jonatack/repos",
          "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/jonatack/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/jonatack/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/jonatack/bitcoin",
        "archive_url": "https://api.github.com/repos/jonatack/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/jonatack/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/jonatack/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/jonatack/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/jonatack/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/jonatack/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/jonatack/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/jonatack/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/jonatack/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/jonatack/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/jonatack/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/jonatack/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/jonatack/bitcoin/events",
        "forks_url": "https://api.github.com/repos/jonatack/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/jonatack/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/jonatack/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/jonatack/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/jonatack/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/jonatack/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/jonatack/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/jonatack/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/jonatack/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/jonatack/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/jonatack/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/jonatack/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/jonatack/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/jonatack/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/jonatack/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/jonatack/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:jonatack/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/jonatack/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/jonatack/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/jonatack/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/jonatack/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/jonatack/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/jonatack/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/jonatack/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/jonatack/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/jonatack/bitcoin/hooks",
        "svn_url": "https://github.com/jonatack/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 217428,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-05-31T14:39:25Z",
        "created_at": "2019-02-28T11:57:18Z",
        "updated_at": "2023-01-03T22:00:49Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "7f3fd341178f08c9ddb5b959e02676ad6bca3370",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34347,
        "stargazers_count": 69854,
        "watchers_count": 69854,
        "size": 234261,
        "default_branch": "master",
        "open_issues_count": 631,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-09T08:59:13Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-09T09:00:41Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 439,
    "deletions": 168,
    "changed_files": 6,
    "commits": 8,
    "review_comments": 33,
    "comments": 25
  },
  "events": [
    {
      "event": "labeled",
      "id": 3898831962,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDM4OTg4MzE5NjI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3898831962",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-20T13:48:41Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "commented",
      "id": 712879256,
      "node_id": "MDEyOklzc3VlQ29tbWVudDcxMjg3OTI1Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/712879256",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-20T14:07:35Z",
      "updated_at": "2020-10-20T14:07:35Z",
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-712879256",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "commented",
      "id": 712899496,
      "node_id": "MDEyOklzc3VlQ29tbWVudDcxMjg5OTQ5Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/712899496",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-20T14:35:38Z",
      "updated_at": "2021-03-30T15:59:15Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21160 (net/net processing: Move tx inventory into net_processing by jnewbery)\n* #20196 (net: fix GetListenPort() to derive the proper port by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-712899496",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "commented",
      "id": 712916354,
      "node_id": "MDEyOklzc3VlQ29tbWVudDcxMjkxNjM1NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/712916354",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-20T15:00:06Z",
      "updated_at": "2020-10-20T15:00:06Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-712916354",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "commented",
      "id": 712999337,
      "node_id": "MDEyOklzc3VlQ29tbWVudDcxMjk5OTMzNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/712999337",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-20T16:51:02Z",
      "updated_at": "2020-10-20T16:51:02Z",
      "author_association": "MEMBER",
      "body": "Concept ACK.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-712999337",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "commented",
      "id": 713464786,
      "node_id": "MDEyOklzc3VlQ29tbWVudDcxMzQ2NDc4Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/713464786",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-21T10:15:41Z",
      "updated_at": "2020-12-23T02:48:22Z",
      "author_association": "MEMBER",
      "body": "Added `CNode::m_inbound_onion` unit test coverage in #20210.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-713464786",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "commented",
      "id": 713865992,
      "node_id": "MDEyOklzc3VlQ29tbWVudDcxMzg2NTk5Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/713865992",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-21T20:43:06Z",
      "updated_at": "2020-10-21T20:43:06Z",
      "author_association": "CONTRIBUTOR",
      "body": "Sounds good, although you might want to add a couple slots for actual localhost peers. :)",
      "user": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-713865992",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "commented",
      "id": 722078028,
      "node_id": "MDEyOklzc3VlQ29tbWVudDcyMjA3ODAyOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/722078028",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-11-05T02:03:24Z",
      "updated_at": "2020-11-05T02:03:24Z",
      "author_association": "MEMBER",
      "body": "> Sounds good, although you might want to add a couple slots for actual localhost peers. :)\r\n\r\nAnyone with an old manually-configured hidden service not using the new bind style will have their inbound Tor connections not classified as such, so this may be degradation for them if there is no explicit affordance for localhost peers.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-722078028",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "commented",
      "id": 722209703,
      "node_id": "MDEyOklzc3VlQ29tbWVudDcyMjIwOTcwMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/722209703",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-11-05T07:58:10Z",
      "updated_at": "2020-11-05T07:58:10Z",
      "author_association": "MEMBER",
      "body": "Thank you for the feedback @gmaxwell and @sipa, will update soon.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-722209703",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "mentioned",
      "id": 3961033325,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50Mzk2MTAzMzMyNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3961033325",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-11-05T07:58:10Z"
    },
    {
      "event": "subscribed",
      "id": 3961033330,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM5NjEwMzMzMzA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3961033330",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-11-05T07:58:10Z"
    },
    {
      "event": "mentioned",
      "id": 3961033333,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50Mzk2MTAzMzMzMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3961033333",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-11-05T07:58:10Z"
    },
    {
      "event": "subscribed",
      "id": 3961033334,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM5NjEwMzMzMzQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3961033334",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-11-05T07:58:10Z"
    },
    {
      "event": "labeled",
      "id": 3962577533,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDM5NjI1Nzc1MzM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3962577533",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-11-05T14:09:53Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4142360649,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDE0MjM2MDY0OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4142360649",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-12-23T01:54:27Z"
    },
    {
      "event": "unlabeled",
      "id": 4142487955,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50NDE0MjQ4Nzk1NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4142487955",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-12-23T03:05:43Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 750316382,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc1MDMxNjM4Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/750316382",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-12-23T14:09:44Z",
      "updated_at": "2020-12-23T14:09:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "Now that we have unit testing of the eviction logic in `master` (see merged PR #20477): what about adding a small test for this change? :)",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-750316382",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "commented",
      "id": 750329753,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc1MDMyOTc1Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/750329753",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-12-23T14:41:55Z",
      "updated_at": "2021-03-30T13:17:07Z",
      "author_association": "MEMBER",
      "body": "Rebased, and updated to fall back to localhost if no onion peers are removed. Depending on feedback, this could go further and count onion peers removed to activate localhost if too few onion peers are removed.\r\n\r\n> Now that we have unit testing of the eviction logic in `master` (see merged PR #20477): what about adding a small test for this change? :)\r\n\r\n@practicalswift I agree and spent time yesterday writing tests after extracting some of the untested parts of `SelectNodeToEvict()` to a separate function for deterministic testability of the current code. Edit: done.\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-750329753",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "mentioned",
      "id": 4144447955,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDE0NDQ0Nzk1NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4144447955",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-12-23T14:41:55Z"
    },
    {
      "event": "subscribed",
      "id": 4144447959,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQxNDQ0NDc5NTk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4144447959",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-12-23T14:41:55Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4149300202,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDE0OTMwMDIwMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4149300202",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-12-25T23:45:24Z"
    },
    {
      "event": "commented",
      "id": 751300798,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc1MTMwMDc5OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/751300798",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-12-25T23:51:51Z",
      "updated_at": "2020-12-25T23:51:51Z",
      "author_association": "MEMBER",
      "body": "Rebased and updated after merge of #19972 that created a silent merge conflict.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-751300798",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "reviewed",
      "id": 560586885,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNTg2ODg1",
      "url": null,
      "actor": null,
      "commit_id": "0d167683b670cb2220052a7719c8ab32ce479bbd",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK c16ed372bdc71795fbebc5dbf519a1d748a136dc\r\n\r\nThe code looks ok, after some staring at it. Just some minor notes below.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#pullrequestreview-560586885",
      "submitted_at": "2021-01-01T14:59:39Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
    },
    {
      "event": "referenced",
      "id": 4161572277,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQxNjE1NzIyNzc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4161572277",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "ae8f79713543d3db24a886cc27340b1570c2657d",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ae8f79713543d3db24a886cc27340b1570c2657d",
      "created_at": "2021-01-02T08:59:58Z"
    },
    {
      "event": "referenced",
      "id": 4161833196,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQxNjE4MzMxOTY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4161833196",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "1a9cf218d68aaec113b2c8591fb9c55c4d0b12e6",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/1a9cf218d68aaec113b2c8591fb9c55c4d0b12e6",
      "created_at": "2021-01-02T16:59:03Z"
    },
    {
      "event": "referenced",
      "id": 4270038506,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQyNzAwMzg1MDY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4270038506",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "1f514332eda21ef29be9931f48390e67f7323bd6",
      "commit_url": "https://api.github.com/repos/bitcoin-core/gui/commits/1f514332eda21ef29be9931f48390e67f7323bd6",
      "created_at": "2021-01-31T07:44:47Z"
    },
    {
      "event": "referenced",
      "id": 4276666480,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQyNzY2NjY0ODA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4276666480",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "ab208da4d8c3c58465544dbaf625ea35e74cab78",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/ab208da4d8c3c58465544dbaf625ea35e74cab78",
      "created_at": "2021-02-02T01:01:19Z"
    },
    {
      "event": "commented",
      "id": 780849307,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDg0OTMwNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/780849307",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-17T20:59:26Z",
      "updated_at": "2021-02-17T20:59:26Z",
      "author_association": "MEMBER",
      "body": "> Sounds good, although you might want to add a couple slots for actual localhost peers. :)\r\n\r\nI interpreted this comment from @gmaxwell as suggesting that we should protect some actual localhost peers, even if we are also protecting some onion peers -- looks like this patch right now would only try to protect some localhost peers if there are no onion peers that we're protecting.  Any reason not to protect some of each?  I think that having more categories/metrics that we use to distinguish inbounds will make it harder for an adversary to take over all our inbound slots.",
      "user": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-780849307",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "mentioned",
      "id": 4343520706,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDM0MzUyMDcwNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4343520706",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-17T20:59:26Z"
    },
    {
      "event": "subscribed",
      "id": 4343520709,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQzNDM1MjA3MDk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4343520709",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-17T20:59:26Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4356848926,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDM1Njg0ODkyNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4356848926",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-21T22:08:51Z"
    },
    {
      "event": "renamed",
      "id": 4356851543,
      "node_id": "MDE3OlJlbmFtZWRUaXRsZUV2ZW50NDM1Njg1MTU0Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4356851543",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-21T22:11:24Z",
      "rename": {
        "from": "p2p: improve onion detection in AttemptToEvictConnection()",
        "to": "p2p: protect onions in AttemptToEvictConnection(), add eviction protection test coverage"
      }
    },
    {
      "event": "commented",
      "id": 782968703,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc4Mjk2ODcwMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/782968703",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-22T00:44:55Z",
      "updated_at": "2021-03-04T15:17:01Z",
      "author_association": "MEMBER",
      "body": "Thank you @vasild  and @sdaftuar. Updated to potentially protect up to 1/4 onion peers, independently of the existing 1/4 localhost protection, for an unchanged 1/2 of the remaining peers overall. The latest push also adds test coverage for the longest uptime, localhost, and onion peer eviction protection logic.\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-782968703",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "mentioned",
      "id": 4357031040,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDM1NzAzMTA0MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4357031040",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-22T00:44:56Z"
    },
    {
      "event": "subscribed",
      "id": 4357031046,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQzNTcwMzEwNDY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4357031046",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-22T00:44:56Z"
    },
    {
      "event": "mentioned",
      "id": 4357031049,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDM1NzAzMTA0OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4357031049",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-22T00:44:56Z"
    },
    {
      "event": "subscribed",
      "id": 4357031052,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQzNTcwMzEwNTI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4357031052",
      "actor": {
        "login": "sdaftuar",
        "id": 7463573,
        "node_id": "MDQ6VXNlcjc0NjM1NzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sdaftuar",
        "html_url": "https://github.com/sdaftuar",
        "followers_url": "https://api.github.com/users/sdaftuar/followers",
        "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
        "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
        "repos_url": "https://api.github.com/users/sdaftuar/repos",
        "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-22T00:44:56Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4360031431,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDM2MDAzMTQzMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4360031431",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-22T14:34:07Z"
    },
    {
      "event": "commented",
      "id": 783420479,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc4MzQyMDQ3OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/783420479",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-22T14:38:47Z",
      "updated_at": "2021-02-22T14:38:47Z",
      "author_association": "MEMBER",
      "body": "Improved the last test commit, adding combined onion + localhost tests.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-783420479",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4360163498,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDM2MDE2MzQ5OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4360163498",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-22T14:58:18Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4360803075,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDM2MDgwMzA3NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4360803075",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-22T16:53:44Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4360886969,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDM2MDg4Njk2OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4360886969",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-22T17:09:50Z"
    },
    {
      "event": "reviewed",
      "id": 598527516,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk4NTI3NTE2",
      "url": null,
      "actor": null,
      "commit_id": "f1c02b3ef9fa4bbd82144eebbeaf8c9c9df238c5",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Approach ACK f1c02b3ef9fa4bbd82144eebbeaf8c9c9df238c5\r\n\r\nAbout how many to protect - I do not feel strongly about it, but I think we should protect 1/4 (localhost or tor), not 1/4 localhost and 1/4 tor. Because localhost likely means a tor peer that somehow is not recognized as such. So, a tor peer is (surely recognized as tor OR unrecognized one, coming from localhost (likely)) and the original code aims to protect 1/4 tor peers and my understanding is that this PR's purpose is not to possibly extend that to 1/2 (1/4 + 1/4).\r\n\r\nJust to be explicit what I mean:\r\n<details>\r\n<summary>[patch] protect 1/4 cumulatively tor+localhost</summary>\r\n\r\n```diff\r\ndiff --git i/src/net.cpp w/src/net.cpp\r\nindex e0e0ba9d8..96a1259e7 100644\r\n--- i/src/net.cpp\r\n+++ w/src/net.cpp\r\n@@ -827,23 +827,24 @@ static bool ReverseCompareNodeMinPingTime(const NodeEvictionCandidate &a, const\r\n \r\n static bool ReverseCompareNodeTimeConnected(const NodeEvictionCandidate &a, const NodeEvictionCandidate &b)\r\n {\r\n     return a.nTimeConnected > b.nTimeConnected;\r\n }\r\n \r\n-static bool CompareLocalHostTimeConnected(const NodeEvictionCandidate &a, const NodeEvictionCandidate &b)\r\n-{\r\n-    if (a.m_is_local != b.m_is_local) return b.m_is_local;\r\n-    return a.nTimeConnected > b.nTimeConnected;\r\n-}\r\n-\r\n-static bool CompareOnionTimeConnected(const NodeEvictionCandidate& a, const NodeEvictionCandidate& b)\r\n-{\r\n-    if (a.m_is_onion != b.m_is_onion) return b.m_is_onion;\r\n-    return a.nTimeConnected > b.nTimeConnected;\r\n-}\r\n+/**\r\n+ * Compare eviction candidates in such a way, that (localhost or onion) ones are at\r\n+ * the end. Within them put the ones that have been connected longer (have smaller\r\n+ * `nTimeConnected`) at the end.\r\n+ */\r\n+static bool CompareThisIsHard(const NodeEvictionCandidate& a, const NodeEvictionCandidate& b)\r\n+{\r\n+    const bool a_is_special = a.m_is_local || a.m_is_onion;\r\n+    const bool b_is_special = b.m_is_local || b.m_is_onion;\r\n+    if (a_is_special != b_is_special) return b_is_special;\r\n+    return a.nTimeConnected > b.nTimeConnected;\r\n+}\r\n \r\n static bool CompareNetGroupKeyed(const NodeEvictionCandidate &a, const NodeEvictionCandidate &b) {\r\n     return a.nKeyedNetGroup < b.nKeyedNetGroup;\r\n }\r\n \r\n static bool CompareNodeBlockTime(const NodeEvictionCandidate &a, const NodeEvictionCandidate &b)\r\n@@ -891,21 +892,18 @@ void ProtectEvictionCandidates(std::vector<NodeEvictionCandidate>& vEvictionCand\r\n     // they're not longest-uptime overall. This helps protect tor peers, which\r\n     // tend to be otherwise disadvantaged under our eviction criteria.\r\n     const size_t initial_size = vEvictionCandidates.size();\r\n     size_t total_protect_size = initial_size / 2;\r\n     const size_t local_erase_size = total_protect_size / 2;\r\n \r\n-    // Pick out up to 1/4 peers connected via our onion service, sorted by longest uptime.\r\n-    EraseLastKElements(vEvictionCandidates, CompareOnionTimeConnected, local_erase_size,\r\n-                       [](const NodeEvictionCandidate& n) { return n.m_is_onion; });\r\n-\r\n-    // Pick out up to 1/4 peers that are localhost, sorted by longest uptime,\r\n-    // as manually configured hidden services not using `-bind=addr[:port]=onion`\r\n-    // will not be detected as inbound onion connections.\r\n-    EraseLastKElements(vEvictionCandidates, CompareLocalHostTimeConnected, local_erase_size,\r\n-                       [](const NodeEvictionCandidate& n) { return n.m_is_local; });\r\n+    // Pick out up to 1/4 localhost peers (likely they are tor ones that do not benefit from\r\n+    // `-bind=addr[:port]=onion`) or peers connected via our onion service, sorted by longest uptime.\r\n+    EraseLastKElements(vEvictionCandidates,\r\n+                       CompareThisIsHard,\r\n+                       local_erase_size,\r\n+                       [](const NodeEvictionCandidate& n) { return n.m_is_local || n.m_is_onion; });\r\n \r\n     // Calculate how many we removed, and update our total number of peers that\r\n     // we want to protect based on uptime accordingly.\r\n     total_protect_size -= initial_size - vEvictionCandidates.size();\r\n     EraseLastKElements(vEvictionCandidates, ReverseCompareNodeTimeConnected, total_protect_size);\r\n }\r\n```\r\n\r\n</details>\r\n\r\nAgain, I do not have a strong opinion on this. Curious to see what other reviewers think.\r\n",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#pullrequestreview-598527516",
      "submitted_at": "2021-02-25T14:01:41Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4386265857,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDM4NjI2NTg1Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4386265857",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-28T16:41:30Z"
    },
    {
      "event": "commented",
      "id": 787481422,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc4NzQ4MTQyMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/787481422",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-28T16:45:04Z",
      "updated_at": "2021-03-30T13:30:56Z",
      "author_association": "MEMBER",
      "body": "Thank you @vasild for your excellent review! I've taken your inline code feedback.\r\n\r\nWRT the question of \"how many to protect and how to do it,\" I think it may be best to continue picking out the onion peers and the localhost peers separately in order to strive for more peer diversity. The idea is that if we do somehow have both onion and localhost peers, it seems worthwhile to ensure we protect some of each, even if one has worse latency than the other.\r\n\r\nThus, at the cost of a wee bit more complexity, I've updated this to follow @gmaxwell's suggestion more closely.\r\n\r\nThis branch now protects up to 1/4 onion peers (connected via our tor control service), if any, sorted by longest uptime. If any (or all) onion slots remain after that operation, they are then allocated to protect localhost peers, or a minimum of 2 localhost peers in the case that no onion slots remain and 2 or more onion peers were protected, sorted as before by longest uptime.\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-787481422",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "mentioned",
      "id": 4386269154,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDM4NjI2OTE1NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4386269154",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-28T16:45:05Z"
    },
    {
      "event": "subscribed",
      "id": 4386269155,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQzODYyNjkxNTU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4386269155",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-28T16:45:05Z"
    },
    {
      "event": "mentioned",
      "id": 4386269156,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDM4NjI2OTE1Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4386269156",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-28T16:45:05Z"
    },
    {
      "event": "subscribed",
      "id": 4386269157,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQzODYyNjkxNTc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4386269157",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-28T16:45:05Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4386346890,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDM4NjM0Njg5MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4386346890",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-28T18:01:34Z"
    },
    {
      "event": "commented",
      "id": 787493363,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc4NzQ5MzM2Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/787493363",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-28T18:02:04Z",
      "updated_at": "2021-02-28T18:02:04Z",
      "author_association": "MEMBER",
      "body": "Improved the unit tests.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-787493363",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "labeled",
      "id": 4408279183,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ0MDgyNzkxODM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408279183",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T14:12:03Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4408845105,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDQwODg0NTEwNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408845105",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T15:52:40Z"
    },
    {
      "event": "commented",
      "id": 790725280,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc5MDcyNTI4MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/790725280",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T16:01:31Z",
      "updated_at": "2021-03-04T16:01:31Z",
      "author_association": "MEMBER",
      "body": "Rebased. @naumenkogs, @ariard, @jnewbery, @dongcarl, as reviewers of #19670 you might be interested in this. @practicalswift, this updates your unit tests and adds missing ones as you had requested. @wtogami, this might address the issues you discussed with me recently. ",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-790725280",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "mentioned",
      "id": 4408896318,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDQwODg5NjMxOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408896318",
      "actor": {
        "login": "wtogami",
        "id": 93665,
        "node_id": "MDQ6VXNlcjkzNjY1",
        "avatar_url": "https://avatars.githubusercontent.com/u/93665?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/wtogami",
        "html_url": "https://github.com/wtogami",
        "followers_url": "https://api.github.com/users/wtogami/followers",
        "following_url": "https://api.github.com/users/wtogami/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/wtogami/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/wtogami/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/wtogami/subscriptions",
        "organizations_url": "https://api.github.com/users/wtogami/orgs",
        "repos_url": "https://api.github.com/users/wtogami/repos",
        "events_url": "https://api.github.com/users/wtogami/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/wtogami/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T16:01:31Z"
    },
    {
      "event": "subscribed",
      "id": 4408896322,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ0MDg4OTYzMjI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408896322",
      "actor": {
        "login": "wtogami",
        "id": 93665,
        "node_id": "MDQ6VXNlcjkzNjY1",
        "avatar_url": "https://avatars.githubusercontent.com/u/93665?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/wtogami",
        "html_url": "https://github.com/wtogami",
        "followers_url": "https://api.github.com/users/wtogami/followers",
        "following_url": "https://api.github.com/users/wtogami/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/wtogami/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/wtogami/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/wtogami/subscriptions",
        "organizations_url": "https://api.github.com/users/wtogami/orgs",
        "repos_url": "https://api.github.com/users/wtogami/repos",
        "events_url": "https://api.github.com/users/wtogami/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/wtogami/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T16:01:31Z"
    },
    {
      "event": "mentioned",
      "id": 4408896329,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDQwODg5NjMyOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408896329",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T16:01:31Z"
    },
    {
      "event": "subscribed",
      "id": 4408896334,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ0MDg4OTYzMzQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408896334",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T16:01:31Z"
    },
    {
      "event": "mentioned",
      "id": 4408896339,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDQwODg5NjMzOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408896339",
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T16:01:31Z"
    },
    {
      "event": "subscribed",
      "id": 4408896341,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ0MDg4OTYzNDE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408896341",
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T16:01:32Z"
    },
    {
      "event": "mentioned",
      "id": 4408896345,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDQwODg5NjM0NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408896345",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T16:01:32Z"
    },
    {
      "event": "subscribed",
      "id": 4408896348,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ0MDg4OTYzNDg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408896348",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T16:01:32Z"
    },
    {
      "event": "mentioned",
      "id": 4408896350,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDQwODg5NjM1MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408896350",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T16:01:32Z"
    },
    {
      "event": "subscribed",
      "id": 4408896353,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ0MDg4OTYzNTM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408896353",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T16:01:32Z"
    },
    {
      "event": "mentioned",
      "id": 4408896359,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDQwODg5NjM1OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408896359",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T16:01:32Z"
    },
    {
      "event": "subscribed",
      "id": 4408896364,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ0MDg4OTYzNjQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408896364",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T16:01:32Z"
    },
    {
      "event": "unlabeled",
      "id": 4408984211,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50NDQwODk4NDIxMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4408984211",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T16:17:21Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 604282355,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjA0MjgyMzU1",
      "url": null,
      "actor": null,
      "commit_id": "ea9f19ee66ff66e1f5c384c19def994ec3037e13",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK.\r\n\r\nWhat type of localhost peers coming from automated-connections-but-manually-configured do we have right now ? I2P? Otherwise if you want to protect localhost peers from manual connections maybe better just to redirect them on a `whitebind=noban@addr` ?\r\n\r\n",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#pullrequestreview-604282355",
      "submitted_at": "2021-03-04T16:20:11Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
    },
    {
      "event": "added_to_project",
      "id": 4409806588,
      "node_id": "MDE5OkFkZGVkVG9Qcm9qZWN0RXZlbnQ0NDA5ODA2NTg4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4409806588",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-04T19:05:19Z",
      "project_card": {
        "id": 56212572,
        "url": "https://api.github.com/projects/columns/cards/56212572",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Blockers"
      }
    },
    {
      "event": "commented",
      "id": 794137318,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc5NDEzNzMxOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/794137318",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-09T16:39:09Z",
      "updated_at": "2021-03-09T16:39:09Z",
      "author_association": "MEMBER",
      "body": "https://github.com/bitcoin/bitcoin/issues/11537 is related to this PR.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-794137318",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "reviewed",
      "id": 607677148,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjA3Njc3MTQ4",
      "url": null,
      "actor": null,
      "commit_id": "ea9f19ee66ff66e1f5c384c19def994ec3037e13",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK ea9f19ee66ff66e1f5c384c19def994ec3037e13",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#pullrequestreview-607677148",
      "submitted_at": "2021-03-09T17:31:04Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
    },
    {
      "event": "commented",
      "id": 794210552,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc5NDIxMDU1Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/794210552",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-09T17:36:32Z",
      "updated_at": "2021-03-09T17:36:32Z",
      "author_association": "MEMBER",
      "body": "@ariard, I2P peers are not localhost ones. They can easily be distinguished because their address's `CNetAddr::IsI2P()` is true. The complication with Tor is because incoming tor connections come from an IP address (not from a Tor address), usually `127.0.0.1`.\r\n\r\nI am not sure what you mean by \"automated-connections-but-manually-configured\" or \"protect localhost peers from manual connections\".",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-794210552",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "mentioned",
      "id": 4430125294,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDQzMDEyNTI5NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4430125294",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-09T17:36:32Z"
    },
    {
      "event": "subscribed",
      "id": 4430125301,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ0MzAxMjUzMDE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4430125301",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-09T17:36:33Z"
    },
    {
      "event": "labeled",
      "id": 4470006305,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ0NzAwMDYzMDU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4470006305",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-17T12:45:27Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4470549416,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDQ3MDU0OTQxNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4470549416",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-17T14:21:35Z"
    },
    {
      "event": "commented",
      "id": 801123141,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgwMTEyMzE0MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/801123141",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-17T14:24:28Z",
      "updated_at": "2021-03-17T14:24:28Z",
      "author_association": "MEMBER",
      "body": "Rebased due to conflicts from the merge of #21415 --  ` git range-diff a9d1b40 ea9f19e c18fd59` ",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-801123141",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "unlabeled",
      "id": 4470723988,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50NDQ3MDcyMzk4OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4470723988",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-17T14:50:16Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 614578952,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE0NTc4OTUy",
      "url": null,
      "actor": null,
      "commit_id": "c18fd59329a855c12ba370474a3ec39032611f2b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK c18fd59329a855c12ba370474a3ec39032611f2b",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#pullrequestreview-614578952",
      "submitted_at": "2021-03-17T17:08:15Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
    },
    {
      "event": "reviewed",
      "id": 616015821,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE2MDE1ODIx",
      "url": null,
      "actor": null,
      "commit_id": "fd3cbfda2bd6d27d54aae18a657e3f15bd95748d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "utACK c18fd59329a855c12ba370474a3ec39032611f2b. I didn't review the last (unit test) commit in detail.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#pullrequestreview-616015821",
      "submitted_at": "2021-03-19T03:25:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmMTI2Y2JkNmRlNmUxYThmZWUwZTkwMGVjZmJjMTRhODhlMzYyNTQx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f126cbd6de6e1a8fee0e900ecfbc14a88e362541",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f126cbd6de6e1a8fee0e900ecfbc14a88e362541",
      "tree": {
        "sha": "67187528701f683204f0a981fcec90dee8d24500",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/67187528701f683204f0a981fcec90dee8d24500"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 67187528701f683204f0a981fcec90dee8d24500\nparent a9d1b40d53ec417eefbe767aa66701ef8e1801d5\nauthor Jon Atack <jon@atack.com> 1613940137 +0100\ncommitter Jon Atack <jon@atack.com> 1616181089 +0100\n\nExtract ProtectEvictionCandidatesByRatio from SelectNodeToEvict\n\nto allow deterministic unit testing of the ratio-based peer eviction protection\nlogic, which protects peers having longer connection times and those connected\nvia higher-latency networks.\n\nAdd documentation.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAmBU92kACgkQT1chs9Dj\nkh0lqQ/8CCMOA90pCJwkTZx0s8hn9yEu5+l5oM2HEOnI87dCS+a3dzL9HoCIkH7U\nT7OmJOl4kOZK8BPrGx64jQ3aeTzTKzhGZMRWzW1NlUcJgk97NnP83H65x7pvFU3A\n6kC8WkuBfLPWxsy5up1+6zQXtn2QkKkGoyXM6ZH2ExGK4XSbgrxXYMo8mDnPouyE\nfwWPDvBeLq2+bjBHU6yueFZq3twBIu7lwh89Xk+WOkctIupQd/ReQ87TLc2XyS2K\n8MJPSe3eGd+eryFQYeAN53MWwP7ENeul5100nc1RbylECqifxqgAYp8h3q+7WEu3\nEliZrlTFWZSqtcx2ZFtlJa/RqQOK/PoeMKq960LEa+V4GrYhHzmtZyIXzmskfSRm\n1Wvk36qCxCxzFoDZ6uphEsagaMXG5IMCe5K9jPMg/nXh0m7eSBhMEwuUzDCzHv/M\nbTHN3wMgK2y4k0LvS6hKThsNpZ8VWJrsfvnDNj7fUJIZ+AROAljIx2bgaEZgwnbB\nYrDKYuXU0DteUaPmm3jj6WxnDNGvH/4huOjAmUa1uFs24AIlVWn7+JdX2CTN+mYD\nFTJds+toZrDI+68dbVb/RiIbX1SQdLkrzwz/93FY5zKQGAg+uPo1Hgu7dMGoNIA2\n5pi4dOJ09YWk1rmGqE4VVAmjivZoyYMXJKO5NSY80djCLdaDuVM=\n=Zbrn\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIGqYL0dYEobigFhXHiXh0b3ahruqPzbYgk+3/842M00mCP/wECNMWOQmFfTY\naPcF0vLFybQI8QRgVPdq8Ag6SUzCaztJmgCD3+MNLvkMji4taHR0cHM6Ly9hbGlj\nZS5idGMuY2FsZW5kYXIub3BlbnRpbWVzdGFtcHMub3Jn//AQZURz/YivpR4ZfURW\n9ar0WQjwIGgUapnCuaA0WK3wVHaKEDsh2IXt4/Ym+ZbetzugMNMNCPAgbSIUgMwB\nwg4hsDWfOv51+Z2FVgz2JKjYqhYYEbbGPpgI8CDSxO1fasPiC+hdMlmEpbrtfsAJ\nQRFbNtDgTGiskkuPbQjwIEJI+ffsLsSmCqyf2AZ9ZhCXvJ74ilfYz/O6A1AcDKZw\nCPEEYFTplPAI0LScIJQjuqsAg9/jDS75DI4pKGh0dHBzOi8vZmlubmV5LmNhbGVu\nZGFyLmV0ZXJuaXR5d2FsbC5jb23/8BCqYFJP9wfZPFEWEDIT+Q3rCPEEYFT3avAI\niz/mC+khhEgAg9/jDS75DI4sK2h0dHBzOi8vYm9iLmJ0Yy5jYWxlbmRhci5vcGVu\ndGltZXN0YW1wcy5vcmfwEPF/eiHOC3RwwkMStU8X9QgI8QRgVPdq8Ai7ozdEh0uv\nYwCD3+MNLvkMjiMiaHR0cHM6Ly9idGMuY2FsZW5kYXIuY2F0YWxsYXh5LmNvbQ==\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a9d1b40d53ec417eefbe767aa66701ef8e1801d5",
          "sha": "a9d1b40d53ec417eefbe767aa66701ef8e1801d5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a9d1b40d53ec417eefbe767aa66701ef8e1801d5"
        }
      ],
      "message": "Extract ProtectEvictionCandidatesByRatio from SelectNodeToEvict\n\nto allow deterministic unit testing of the ratio-based peer eviction protection\nlogic, which protects peers having longer connection times and those connected\nvia higher-latency networks.\n\nAdd documentation.",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-03-19T19:11:29Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-02-21T20:42:17Z"
      },
      "sha": "f126cbd6de6e1a8fee0e900ecfbc14a88e362541"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0MWY4NGQ1ZWNjZDRjMjYyMGJmNmZlZTYxNmYyZjhmNzE3ZGJkNmY2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/41f84d5eccd4c2620bf6fee616f2f8f717dbd6f6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/41f84d5eccd4c2620bf6fee616f2f8f717dbd6f6",
      "tree": {
        "sha": "9bd01765f06218487ec47b851dacf78a34878e04",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9bd01765f06218487ec47b851dacf78a34878e04"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 9bd01765f06218487ec47b851dacf78a34878e04\nparent f126cbd6de6e1a8fee0e900ecfbc14a88e362541\nauthor Jon Atack <jon@atack.com> 1613816494 +0100\ncommitter Jon Atack <jon@atack.com> 1616181099 +0100\n\nMove peer eviction tests to a separate test file\n\nout of net_tests, because the eviction tests:\n\n- are a different domain of test coverage, with different dependencies\n\n- run more slowly than the net tests\n\n- will be growing in size, in this PR branch and in the future, as eviction\n  test coverage is improved\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAmBU92sACgkQT1chs9Dj\nkh1M7Q/+Jf3zwLPsbwJaCl24YFJNcB/OLhNfwYByq2lk8McQnht/2Hv8zCde8eXZ\nlK28Ph+44NNsGY211OyHaxRplX8/poeWEHNHzHZiSMi9L+Ktuf5hHK7F9k7OzuSD\n0YNPddzd/H5aFWMrsy6vHw31p6H0rn3uH2ii7iEvK58Ptu3LcyUHrsjrRnVV3VDE\nvSGCa2KdZsGXEbpxtQ6JHNYLugi49zm3Uvx2MMmW0S5DRty+tJgzX27vocq5TtPl\nEKVbWddNATZaGmz0Ppdydu9fny7rHWK+Bn6OCELbz5NwezNOQLlLo9SmJoTb+++J\nuiKsvREaGeQxNGcVrUzN+pea4Hacc4vyZtqOzZ30ps5A7J658aJ7Kp3zQx1MFIER\nYQRaTk+tpFl3sd/BP8OtiPQJsFE/ZhqDO715tpLOoMVqDQNOjE1jtJ+qtfm7sfvR\nK9dzFiVla0NAfUQe+VRI94veYrzkZuAj27PHgxPRpUjGlSWcvL/c7CVX8oiyWX/s\n7E6h2sbQgvuXvoYIN6Q9e2zfT58DI3dUNh+gPQVvUYdS7/GQUDNtZ+uFTnX34ULj\n+lfiSTgS6nV9Im3eYNQl7WjkczX+tYwKFFOV3Te6LBPwVX8GgM/EHmJ18MR4BXmW\nAvDxW26WdATz8Q6L2nEY+WfEx7Lw0qlo90EJg7OUioGWrDdenPk=\n=MSVP\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIJ3NAmxwqKv+04Q5KBkE0h5RVVDlzByRS/U4do6ddcztCP/wEB7b/TF32wTH\nSKCIAadnC+0I8QRgVPdt8AgQJri9rCUwZACD3+MNLvkMjiwraHR0cHM6Ly9ib2Iu\nYnRjLmNhbGVuZGFyLm9wZW50aW1lc3RhbXBzLm9yZ//wEGR6Jng7tpQqNUAMW6hH\nynEI8SBXvl9HjECR6U65lzhrvVR5LDyU3dsyZ2U0ovaIJXfMDQjxBGBU92zwCKxI\nnP4ILkGHAIPf4w0u+QyOLi1odHRwczovL2FsaWNlLmJ0Yy5jYWxlbmRhci5vcGVu\ndGltZXN0YW1wcy5vcmf/8BCJ2EFHH1XG2lKmxbegPOTaCPAglNr2wHP7TdgkTqKo\nPRMXIVz1hTAADHuC7Nkgxo5dumMI8QRgVOmW8Ah0L0mRGd+/EACD3+MNLvkMjiko\naHR0cHM6Ly9maW5uZXkuY2FsZW5kYXIuZXRlcm5pdHl3YWxsLmNvbfAQp3B4SOeF\nGl1tFhUFRm7tGgjxBGBU923wCAFWvmVPKWHZAIPf4w0u+QyOIyJodHRwczovL2J0\nYy5jYWxlbmRhci5jYXRhbGxheHkuY29t\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f126cbd6de6e1a8fee0e900ecfbc14a88e362541",
          "sha": "f126cbd6de6e1a8fee0e900ecfbc14a88e362541",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f126cbd6de6e1a8fee0e900ecfbc14a88e362541"
        }
      ],
      "message": "Move peer eviction tests to a separate test file\n\nout of net_tests, because the eviction tests:\n\n- are a different domain of test coverage, with different dependencies\n\n- run more slowly than the net tests\n\n- will be growing in size, in this PR branch and in the future, as eviction\n  test coverage is improved",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-03-19T19:11:39Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-02-20T10:21:34Z"
      },
      "sha": "41f84d5eccd4c2620bf6fee616f2f8f717dbd6f6"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjYTYzYjUzZWNkZjM3N2NlNzc3ZmQ5NTlkNDAwNzQ4OTEyMjY2NzQ4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ca63b53ecdf377ce777fd959d400748912266748",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ca63b53ecdf377ce777fd959d400748912266748",
      "tree": {
        "sha": "3bbabdb29e6487db393ac638dd63f4f808674d2b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3bbabdb29e6487db393ac638dd63f4f808674d2b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 3bbabdb29e6487db393ac638dd63f4f808674d2b\nparent 41f84d5eccd4c2620bf6fee616f2f8f717dbd6f6\nauthor Jon Atack <jon@atack.com> 1614523987 +0100\ncommitter Jon Atack <jon@atack.com> 1616181101 +0100\n\nUse std::unordered_set instead of std::vector in IsEvicted()\n\nAn unordered set can tell if an element is present in ~O(1) time (constant on\naverage, worst case linear to the size of the container), which speeds up and\nsimplifies the lookup in IsEvicted().\n\nCo-authored-by: Vasil Dimov <vd@FreeBSD.org>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAmBU920ACgkQT1chs9Dj\nkh3ciQ/9GQ2Pu/ghYZlvfC8Qa45kH4+4RGrfGjcDYPHEWjNI6sdtwSIwFc9mW/It\n675izEVrlqIx3URzzRizGSwFhE1gUKIPjZhRp19n/XVE324h/TI39595r0lRcMBz\nOpVm8PfoFGj8p74VKJQiCvAL9oeqOHiD9dOAx9j30eftr5mTyh5TuWFq0hkOJDhu\nk3hPxYuaZrYdvLwWAbqc+xsMvcU7CCQJtcFTmIVPwOzuZ7ukvqSa9I65HNtMoe5d\nMjTZB7wUe1whZd1fuaL6LR5CGC0nalQw2V1ixcZwX4qCFPEoeW7MKnm628h+/KFZ\nfl5VPeS8EaxurD1q3ZuQQUO6XzAMpCA65o2n7sL3pEz9hLTx6gB54MGayVSy8gEj\nOXGSVUt0ep5rOm8qo9LhQNM9yxs8IncR7j4eyLC6yGyAnsx0IzYvXCW1cpmDXkiG\nZd1wf4T57wJWXitXCGfGWUBboDlZW+iwkECH3F1coxxrlZGtfF0ol+2McpQKsNgD\nsfarMhgUz9D+SinutO0hRzMxD21xUuzR+atvLhWPMig4Xb3JpbS2vPgo0trqr/Dq\nST57n5w2R/MSJKiPAOTP7+Jhso2qZE/35ge4MyVCZkcn4R1lkv7ZX+ap78hBHInY\nIw1sdojj1riuBbT0BBNSBfp0SH7P5QNV54Rh9erDuR6Mnzw+Ty0=\n=2cH7\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIDbwSWhGX1n0K/dGIz2tsJMKhHYSVyVosGnZyT1aLZn/CP/wECTIBQ39LNJV\nbTJ9i2VFQzkI8CBI2HqJLkQh+9LXGgm1snUxjKDdndIsdzskPMrdvfPeigjwIJzC\nDWotzB3zb/Tq9M41oLGsAuEz2HVitsEg3OVesVkKCPEEYFT3b/AI3Aks25PGeAoA\ng9/jDS75DI4sK2h0dHBzOi8vYm9iLmJ0Yy5jYWxlbmRhci5vcGVudGltZXN0YW1w\ncy5vcmf/8BA0GeSBL0aOtTbW5iWZctcHCPEEYFTpmPAIJKtKVopjZ44Ag9/jDS75\nDI4pKGh0dHBzOi8vZmlubmV5LmNhbGVuZGFyLmV0ZXJuaXR5d2FsbC5jb23/8BBs\nVzg/4HBLYMDwlPA7PsAGCPEEYFT3b/AIAcKT8x1GxfcAg9/jDS75DI4uLWh0dHBz\nOi8vYWxpY2UuYnRjLmNhbGVuZGFyLm9wZW50aW1lc3RhbXBzLm9yZ/AQ2/wTQVlo\ndRX17ZgjMZPEcAjxBGBU92/wCIrvBIAQ060+AIPf4w0u+QyOIyJodHRwczovL2J0\nYy5jYWxlbmRhci5jYXRhbGxheHkuY29t\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/41f84d5eccd4c2620bf6fee616f2f8f717dbd6f6",
          "sha": "41f84d5eccd4c2620bf6fee616f2f8f717dbd6f6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/41f84d5eccd4c2620bf6fee616f2f8f717dbd6f6"
        }
      ],
      "message": "Use std::unordered_set instead of std::vector in IsEvicted()\n\nAn unordered set can tell if an element is present in ~O(1) time (constant on\naverage, worst case linear to the size of the container), which speeds up and\nsimplifies the lookup in IsEvicted().\n\nCo-authored-by: Vasil Dimov <vd@FreeBSD.org>",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-03-19T19:11:41Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-02-28T14:53:07Z"
      },
      "sha": "ca63b53ecdf377ce777fd959d400748912266748"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3MmUzMGU4ZTAzZjg4MGViYTRiZDFjM2ZjMThiNTU1OGQ4Y2VmNjgw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/72e30e8e03f880eba4bd1c3fc18b5558d8cef680",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/72e30e8e03f880eba4bd1c3fc18b5558d8cef680",
      "tree": {
        "sha": "31c720c7948dc3f6c19a702096884f4ee103d2ae",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/31c720c7948dc3f6c19a702096884f4ee103d2ae"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 31c720c7948dc3f6c19a702096884f4ee103d2ae\nparent ca63b53ecdf377ce777fd959d400748912266748\nauthor Jon Atack <jon@atack.com> 1613921809 +0100\ncommitter Jon Atack <jon@atack.com> 1616181103 +0100\n\nAdd unit tests for ProtectEvictionCandidatesByRatio()\n\nThank you to Vasil Dimov (vasild) for the suggestion to use std::unordered_set\nrather than std::vector for the IsProtected() peer id arguments.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAmBU928ACgkQT1chs9Dj\nkh3eGQ//T8SV2b6GprR8SL+x9Ef80pMut3NYbqx2nPmWJIrmJa9cHseJ3u9VABcy\nVC+JXNAIaUPu0rHYDLmhqwz4OImu+QHnQxkqgGkxL2bjfebUd0or8uUUK93NezOY\nVNQovBEzMj//+GZLMxJ793aPfgVyI2pn9Sw4pBKY+JL5hq4WZshxdXos/QxhL368\n3T4oUiI0YJ7Ia8Szn4RkpL4IFGp2FoaxdtY+Q5fLXo/8LdlBpZVfl9AVZIq7U1Q9\nFiVV6LymSUbebOuGuwYSCwbsQqHQr4fBrEyXz6qQtSVMIl0RalWD8xcxpdvmJJiG\ncFKOWxgK7S9GP0QJc9/TcSg1HAkeOEQ+/l33aR4Ikn1I3BMew7teq1wiU0h+7xKF\nQWpSu74npXF1h5ib7kayFGVCKppXIGpNMhh7tPV8LXF0TCNMatOfL/vtk+IvsfUQ\nCrkwkJzI0HTTtewUvTodMgG5NDTFCulEQuqgS9anVynkKva+/54hyfV/wyaerpGQ\nFuK9t61vLKkTM8DDuuoekDUZ7Ih06ky6dF2/yuySeCQ40WqeokgTr2I/j3Vjrq6h\n0gF5j8YiPfKZFYDp5ajrVZrl9uu7meK5YdEL9/ahk4AzkqL+H7VG/SKp0OWfoCL6\ndfIdHVKHDHJEK+H42Ex9ErwCuB7T5LIXclXNeDqOweYkCTZw8og=\n=jYgP\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIOPUMgeA8aFPtIdJtBIidzGoFZ9YFGQGWU+ZwYYQr5RmCP/wEBqUhRSkVk1/\nNLRyZirWoFMI8QRgVOma8AjSN+ETc6UJsgCD3+MNLvkMjikoaHR0cHM6Ly9maW5u\nZXkuY2FsZW5kYXIuZXRlcm5pdHl3YWxsLmNvbf/wED2r5HLO0S2Gl7aSxfCYgS0I\n8QRgVPdx8Ajv4g3JJjHkdACD3+MNLvkMjiwraHR0cHM6Ly9ib2IuYnRjLmNhbGVu\nZGFyLm9wZW50aW1lc3RhbXBzLm9yZ//wEJxhHdLtFn7ivsE7F9Q6+RwI8QRgVPdx\n8AjbU/4HYTtPOQCD3+MNLvkMjiMiaHR0cHM6Ly9idGMuY2FsZW5kYXIuY2F0YWxs\nYXh5LmNvbfAQuF3UqxDjZjbfAOwSZAixcAjwIMdZuefAJ33i+eqW9A1BTt3Hh+Fe\nBMLmXT847CGNhGWnCPEEYFT3cfAIeLZQmwB4iQkAg9/jDS75DI4uLWh0dHBzOi8v\nYWxpY2UuYnRjLmNhbGVuZGFyLm9wZW50aW1lc3RhbXBzLm9yZw==\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ca63b53ecdf377ce777fd959d400748912266748",
          "sha": "ca63b53ecdf377ce777fd959d400748912266748",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ca63b53ecdf377ce777fd959d400748912266748"
        }
      ],
      "message": "Add unit tests for ProtectEvictionCandidatesByRatio()\n\nThank you to Vasil Dimov (vasild) for the suggestion to use std::unordered_set\nrather than std::vector for the IsProtected() peer id arguments.",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-03-19T19:11:43Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-02-21T15:36:49Z"
      },
      "sha": "72e30e8e03f880eba4bd1c3fc18b5558d8cef680"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4YjFlMTU2MTQzNzQwYTU1NDhkYzdiNjAxZDQwZmIxNDFlNmFhZTFj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8b1e156143740a5548dc7b601d40fb141e6aae1c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8b1e156143740a5548dc7b601d40fb141e6aae1c",
      "tree": {
        "sha": "190c7430ca8c2cdf81ead7b20f718cae19ba1348",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/190c7430ca8c2cdf81ead7b20f718cae19ba1348"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 190c7430ca8c2cdf81ead7b20f718cae19ba1348\nparent 72e30e8e03f880eba4bd1c3fc18b5558d8cef680\nauthor Jon Atack <jon@atack.com> 1608936977 +0100\ncommitter Jon Atack <jon@atack.com> 1616181105 +0100\n\nAdd m_inbound_onion to AttemptToEvictConnection()\n\nand an `m_is_onion` struct member to NodeEvictionCandidate and tests.\n\nWe'll use these in the peer eviction logic to protect inbound onion peers\nin addition to the existing protection of localhost peers.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAmBU93EACgkQT1chs9Dj\nkh12NhAAxtR+edRmWu2pSG+FeLJngdg34+BiDCFCYl04Vd3C3rY3NSK1iLApjL9b\ncCsRDyrLy/DzmewyplFqqcFKVQFvOxGpGyoxpOja2a9MLwKSsGvLDsXwBNXCgGk4\nmW+Bz8Cx1SWlX60N5wa3eqU15MIIzGVwrnGYq7KyrqvcT3UAIrMWJnIGmuByvl7v\nOp0QJE0rsbSiUc9XdvCh7wmoOKpDl2Uk9YmynPHHP/pTxiwwFxLXXSA8KaJSSjEQ\nupS8G05au5sDe14vTjUHPN3N0M0QVy3GokN+8nDxTS7gxrsi9jDb/+4/fI266PlX\n3wA1raN620prqG0l5uaTLXXrS8zg+JM09frf2C4pKKfy3IG4pqlwepFNCta4wFCb\ndrvhR7OVd0iYnNW9KBRDJs+iV9M6LQKc1FwRxi56+FB3rEjIXCO+GZUCqgxxRbRb\nrL39USdwAHc9KK/Q0ZKY8EwogsHqptVingdKd4MLsPPABi3wta80H1qf87mcFMmA\ngnWgDbRZn6rfMF9tUeNi3PwmaHwVXQVZ8BJxwmVr3eD1ckizox9PsiP1nGAF8jkB\nA3sOJh1em+k5MJRoiTD0NXZf1kvB50Te+tv+dEE5Uyy5k8lqZdZwDHRMsTZAfU54\n7KNyRWcTJlg9+nyh5fCMzJdPuS46R2mHck7rnELy5DgoHdQbcTw=\n=oAfJ\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIHmvgse9fB0YRieBkX0BVu7XjGSL8qi3WdYJUXd7eta4CP/wEEmRWGo9y/h0\noQ4FrqAItl8I8QRgVOmc8AiTZSp5XCt7qwCD3+MNLvkMjikoaHR0cHM6Ly9maW5u\nZXkuY2FsZW5kYXIuZXRlcm5pdHl3YWxsLmNvbf/wEGnXHTRIQSEJNvNaA2GRtHUI\n8QRgVPdz8Aj9DD4moO1fJACD3+MNLvkMjiMiaHR0cHM6Ly9idGMuY2FsZW5kYXIu\nY2F0YWxsYXh5LmNvbf/wEHyFB5XSNWPXhtrxJOJG1ogI8QRgVPdz8AhkJdSsCm3X\nAwCD3+MNLvkMjiwraHR0cHM6Ly9ib2IuYnRjLmNhbGVuZGFyLm9wZW50aW1lc3Rh\nbXBzLm9yZ/AQkF507xzs6KnWiW4BkaFtLQjxBGBU93PwCGZh27m8ptMXAIPf4w0u\n+QyOLi1odHRwczovL2FsaWNlLmJ0Yy5jYWxlbmRhci5vcGVudGltZXN0YW1wcy5v\ncmc=\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/72e30e8e03f880eba4bd1c3fc18b5558d8cef680",
          "sha": "72e30e8e03f880eba4bd1c3fc18b5558d8cef680",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/72e30e8e03f880eba4bd1c3fc18b5558d8cef680"
        }
      ],
      "message": "Add m_inbound_onion to AttemptToEvictConnection()\n\nand an `m_is_onion` struct member to NodeEvictionCandidate and tests.\n\nWe'll use these in the peer eviction logic to protect inbound onion peers\nin addition to the existing protection of localhost peers.",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-03-19T19:11:45Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2020-12-25T22:56:17Z"
      },
      "sha": "8b1e156143740a5548dc7b601d40fb141e6aae1c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4ZjFhNTNlYjAyNzcyN2E0YzBlYWFjNmQ4MmYwYTgyNzk1NDlmNjM4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8f1a53eb027727a4c0eaac6d82f0a8279549f638",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8f1a53eb027727a4c0eaac6d82f0a8279549f638",
      "tree": {
        "sha": "29591bab4c4ef2901d6d364a9d886b20b312aeab",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/29591bab4c4ef2901d6d364a9d886b20b312aeab"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 29591bab4c4ef2901d6d364a9d886b20b312aeab\nparent 8b1e156143740a5548dc7b601d40fb141e6aae1c\nauthor Jon Atack <jon@atack.com> 1603175336 +0200\ncommitter Jon Atack <jon@atack.com> 1616181107 +0100\n\nUse EraseLastKElements() throughout SelectNodeToEvict()\n\nCo-authored-by: Vasil Dimov <vd@FreeBSD.org>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAmBU93MACgkQT1chs9Dj\nkh0hOA//bn+X4i+tBQVIvYGR9OX3creUnkVjYh3SUXj/WTESkK9JdEOnoKL2UAlz\nKAWjykbkeYv+o/5RElA5beTjkjjB3GRAxsvMCFP2RWfwkVLOpVIC6Wmoay1QgzyT\nbSM5jRPrPR6/CMLwDuEHoxYdKSKIzhXhiKtxSHwefGjrO34y5Ihcs+AxQhA6npBk\nWbn0eE6kpldL1AFUsi18wM7T29+BuIqJhrNafbzRxHefDw1WJmTveGTIXDBSDFY1\nxbKInIdevMCIdaMhG6oK/SgDoVi6LuXCnDpuYzdkyghFwASXzBs44g9qofdoSlqi\nQnqQmBd2F2szHVOjFD5Y5pIZ3HUxXDrvn/2IonzUSAPZKyRVlldlTyotmkb77SQj\nZNFx7UDHBctJENbceYPaQr+E2AiejeG3fP8eXssOg+sR3ueJew90DswvcLrgAwRf\nj+FN2yVwlMQ/i0stJhts1/T6UFFFIE0uoRbGQXj34c8T+96oGyYLnLci8ijV6nrJ\nIYcZ289Ys4HJ5R0PArtdPlEbqz4EWqkbmHyCAKuK0arDvhFKchrr18PrHoLF4ATA\nG8lnPDm6FdRzXu4mJ5e9V+Om/zbK99kv19cPlUjMBFBl7PuhHrwX81e+UBO4/Fjy\n7YER2/WrSu5xFHjmy1ZdjsaiKuLDK+NI10xo1L6yxgOCy/GR8b4=\n=4hYu\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIAceSvyeJEpQJt2kPk5IM6IM78V7tbC1Lk1Onx2f2uWACP/wEG1O7oIuD5hD\nlDWSdkyErZkI8SAdsBL+soC5A3UeL1c098jjO5xMdtC75FxWZPUsbQ5lRgjxBGBU\n6Z7wCA934UmYiGvxAIPf4w0u+QyOKShodHRwczovL2Zpbm5leS5jYWxlbmRhci5l\ndGVybml0eXdhbGwuY29t//AQiIbH39jLu6IDlwl/0JAyxwjxIPTLrSXwqypdywxY\noD1d3qFcJ76Ekqi0AbH6xecSyBlbCPEEYFT3dfAIAbp/8sQnj/IAg9/jDS75DI4j\nImh0dHBzOi8vYnRjLmNhbGVuZGFyLmNhdGFsbGF4eS5jb23/8BC97o65IO4LZvwV\nfIf+Pa9vCPEg+lvd1IEWlvcmOTPKc1y64Z0eLsXKWATozuDdlPr0OWwI8QRgVPd1\n8AgQUCKXEtOhWgCD3+MNLvkMji4taHR0cHM6Ly9hbGljZS5idGMuY2FsZW5kYXIu\nb3BlbnRpbWVzdGFtcHMub3Jn8BDsQCfUBTXQTELSOO+kkKVeCPEgmHlaSFzsBLMB\nq2FZREOZ2i2v0ORBHrcKj4+dACQ+f7YI8QRgVPd18AhVo9wNm0iwMACD3+MNLvkM\njiwraHR0cHM6Ly9ib2IuYnRjLmNhbGVuZGFyLm9wZW50aW1lc3RhbXBzLm9yZw==\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8b1e156143740a5548dc7b601d40fb141e6aae1c",
          "sha": "8b1e156143740a5548dc7b601d40fb141e6aae1c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8b1e156143740a5548dc7b601d40fb141e6aae1c"
        }
      ],
      "message": "Use EraseLastKElements() throughout SelectNodeToEvict()\n\nCo-authored-by: Vasil Dimov <vd@FreeBSD.org>",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-03-19T19:11:47Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2020-10-20T06:28:56Z"
      },
      "sha": "8f1a53eb027727a4c0eaac6d82f0a8279549f638"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjYWEyMWY1ODZmOTUxZDYyNmE2N2YzOTEwNTBjMzY0NGYxMDU3ZjU3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/caa21f586f951d626a67f391050c3644f1057f57",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/caa21f586f951d626a67f391050c3644f1057f57",
      "tree": {
        "sha": "22f586682a41742f4d39b6194981b5ae6bec4257",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/22f586682a41742f4d39b6194981b5ae6bec4257"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 22f586682a41742f4d39b6194981b5ae6bec4257\nparent 8f1a53eb027727a4c0eaac6d82f0a8279549f638\nauthor Jon Atack <jon@atack.com> 1613837846 +0100\ncommitter Jon Atack <jon@atack.com> 1616181184 +0100\n\nProtect onion+localhost peers in ProtectEvictionCandidatesByRatio()\n\nNow that we have a reliable way to detect inbound onion peers, this commit\nupdates our existing eviction protection of 1/4 localhost peers to instead\nprotect up to 1/4 onion peers (connected via our tor control service), sorted by\nlongest uptime. Any remaining slots of the 1/4 are then allocated to protect\nlocalhost peers, or 2 localhost peers if no slots remain and 2 or more onion\npeers are protected, sorted by longest uptime.\n\nThe goal is to avoid penalizing onion peers, due to their higher min ping times\nrelative to IPv4 and IPv6 peers, and improve our diversity of peer connections.\n\nThank you to Gregory Maxwell, Suhas Daftuar, Vasil Dimov and Pieter Wuille\nfor valuable review feedback that shaped the direction.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAmBU98UACgkQT1chs9Dj\nkh1hRRAAvIQb7XnWUYL/Kc+O+f/upEXIQXqdXlQANrBmhspJ+be5Z19gpsEEEyMZ\n0pDK07T90+BW087n3wkvDKUWvAi49TSVZjUUCvsLRTWvC6ow+DBbHfq/FaKDYCZK\nx9/IM/CiUfwxmkTEmkmg7mfH/DtB0H0Pmje/MqqguIKE4x0MtZ/E5qSH5fUf6eOo\nGmth2BdocLG8RnfjOabim2vtXwXzDyxhIKGglyxSuvXAVhsrqdZlRqY88rIZXr4g\nppVciirD0X8TX/zK2BJcwQauNHukikzKl6rYG0maGzmDqkuzoHDPxd4dyFAVxXVg\nTcaNJiX5ORrRca5chdbf9Vm/bKJ8geQlGUZnOvFnhcdFbT5eYNkJjztl2kIP6Roe\nWuDn/imvaUpjLHAXYRsK3Ue1HFwshqmdk/AeRyRzVVZdBIGg5LX06K758fxpx7t+\nSuIGxjJHXLhXlzkqcOCWD77JfyGJc6y1Kzxnf7tzHFsd78t9biON5MK6OH78bCMZ\nfSTVJBa74CzfSLOyFZ0akSmwkxVDlTgxkXMqBFYaIIb4UdBUq0cIqIJPH1g9tVI0\ngKzxTp5zyi1t3hZ8f42QBQw7h8KRI0NXro8ObLuE8UJNar8rVfqlRWCsfUvmGgwZ\ngRN8Y96qIW1+Xl8xWCYoUOnG41p7Djg++LpCKHUC1QQHq8ySDOw=\n=cM/8\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIMha97Jd54Md9JnrwFdh/2vq0bV8pB9+jmWX+i6td+bSCP/wEBJQXHOOFjns\ngG+aTXx681EI8SB4xl7ISm1W3Omh0GLbaUjNBNdyAb5IVK2qdKT+OI04YgjxBGBU\n98bwCPRe0vWWW28WAIPf4w0u+QyOLi1odHRwczovL2FsaWNlLmJ0Yy5jYWxlbmRh\nci5vcGVudGltZXN0YW1wcy5vcmf/8BBpgSA+OOfzJ0cMfIkrN6drCPAgXuIeNrzI\nZ4GiS7cd+zbFL6AbHzkelLad3Bqf2JByJVwI8QRgVPfH8AjNdqkA79QNEQCD3+MN\nLvkMjiMiaHR0cHM6Ly9idGMuY2FsZW5kYXIuY2F0YWxsYXh5LmNvbf/wEKBEjf/n\nL/go8t7QoM04iV8I8SCd5DpciB3fo7GbGWpFSkbQSYUr0fOw1lvG+Es5dBd/QQjx\nBGBU6fDwCF3b5DG//JOvAIPf4w0u+QyOKShodHRwczovL2Zpbm5leS5jYWxlbmRh\nci5ldGVybml0eXdhbGwuY29t8BC4hLQx7i30Ec6vaOr1EKSHCPAg7ZTGmEwwl7TP\nSuC7xlxK4gMIq2sp9lWEi4tFU0/ZzM8I8QRgVPfH8Ajwv1uy3IEFKgCD3+MNLvkM\njiwraHR0cHM6Ly9ib2IuYnRjLmNhbGVuZGFyLm9wZW50aW1lc3RhbXBzLm9yZw==\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8f1a53eb027727a4c0eaac6d82f0a8279549f638",
          "sha": "8f1a53eb027727a4c0eaac6d82f0a8279549f638",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8f1a53eb027727a4c0eaac6d82f0a8279549f638"
        }
      ],
      "message": "Protect onion+localhost peers in ProtectEvictionCandidatesByRatio()\n\nNow that we have a reliable way to detect inbound onion peers, this commit\nupdates our existing eviction protection of 1/4 localhost peers to instead\nprotect up to 1/4 onion peers (connected via our tor control service), sorted by\nlongest uptime. Any remaining slots of the 1/4 are then allocated to protect\nlocalhost peers, or 2 localhost peers if no slots remain and 2 or more onion\npeers are protected, sorted by longest uptime.\n\nThe goal is to avoid penalizing onion peers, due to their higher min ping times\nrelative to IPv4 and IPv6 peers, and improve our diversity of peer connections.\n\nThank you to Gregory Maxwell, Suhas Daftuar, Vasil Dimov and Pieter Wuille\nfor valuable review feedback that shaped the direction.",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-03-19T19:13:04Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-02-20T16:17:26Z"
      },
      "sha": "caa21f586f951d626a67f391050c3644f1057f57"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzowY2NhMDhhOGVlMzNiNGUwNWZmNTg2YWU0ZmQ5MTRmNWVhODYwY2Vh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "tree": {
        "sha": "7745ddf880dac0b7a87b435291de81f48995c44f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7745ddf880dac0b7a87b435291de81f48995c44f"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 7745ddf880dac0b7a87b435291de81f48995c44f\nparent caa21f586f951d626a67f391050c3644f1057f57\nauthor Jon Atack <jon@atack.com> 1613942562 +0100\ncommitter Jon Atack <jon@atack.com> 1616181191 +0100\n\nAdd unit test coverage for our onion peer eviction protection\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAmBU98cACgkQT1chs9Dj\nkh1FtA/9F3uMe5Wo6Y5TfjdmLfB0SpZ8t10Z0o/oyzHJKcWoRQyTWjYezFNk6f2C\n+yXbNqaoWSUikbvUWGWdbTTn3qQCik3rmiIqLSxnni/N4Z/k25tk5uzM31V/dHbl\nSMe1iC8FyejU3ZWHXI6Hf4hTWy8SQR/We3w7Ip2cHCeEWwvtAReEoU1fnOVOlSu2\nPTrKXXfvSIMvS8G3/9DaQ818roTffZQxszDRzvlk6TV1T668lbAkQosPHbGERq67\n82kjn1IBMyzxeageij9oprWaYpGBMkRk5kDEDrneaPDCeQ3ccSe5JClmAd8bw6ou\nL/4DQeTtcN2ck6aLbV5dnH4oWimAkb67eqVYED8MyqcF3HAHC4d9cgQvnq/vLgAJ\nD0sWFkkMXexGtaXq9Z2d68uQbLuycdFiRga2usTSchDXyfMKRoY44Pc6z+OtYzrD\ndAjC4aXeOOPcXasD6iVweX4QWdJrvXUiXXjXHRA16aqm9/x5EMuqK0LUj3qNk3hi\nIU1kM7bgLRZiskKofrJEEIwMvtO0SMJpL4skqVQDK3KcMjacUKCWX7o19SO+CdlG\nMS6cMzuKTpLagotQ4iL2AVPxRizyeACPMCm2GiCGbS49v77M/XUWDDiKbHpsnEpD\ndmfMV7JwJDC4XmfLyV8N9Xc0rfyosjgIGWPOeTR7NU+hL+CgseA=\n=3sY4\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIGCrQ248bHt4I5qwrmUKi8Nf/tItwYRbdnfqJJKk9QLTCP/wEAyDuXtOh6Cr\nCRUHYkTOTIUI8CD7O0V7qc4Q1VTe7N+QK4mIF36nVxGPtqYWBsG+A5H9UAjwICrq\nfzoAH47rwaNI1FPP8Jisr3NNADkWS2f+NhJwboKzCPEEYFT3yfAI6csmTAuKF4UA\ng9/jDS75DI4uLWh0dHBzOi8vYWxpY2UuYnRjLmNhbGVuZGFyLm9wZW50aW1lc3Rh\nbXBzLm9yZ//wEIhEgDlM4kKEOn4xO/fJTFMI8QRgVOny8AhyRiievZz0cACD3+MN\nLvkMjikoaHR0cHM6Ly9maW5uZXkuY2FsZW5kYXIuZXRlcm5pdHl3YWxsLmNvbf/w\nEJUMAbwizFa+1sSjzdpXxDEI8QRgVPfJ8Ag4yIeXs0aToACD3+MNLvkMjiwraHR0\ncHM6Ly9ib2IuYnRjLmNhbGVuZGFyLm9wZW50aW1lc3RhbXBzLm9yZ/AQ5Yv8mawq\nNfmTGyf1vKNziAjxBGBU98nwCEEjlnXCm6IQAIPf4w0u+QyOIyJodHRwczovL2J0\nYy5jYWxlbmRhci5jYXRhbGxheHkuY29t\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/caa21f586f951d626a67f391050c3644f1057f57",
          "sha": "caa21f586f951d626a67f391050c3644f1057f57",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/caa21f586f951d626a67f391050c3644f1057f57"
        }
      ],
      "message": "Add unit test coverage for our onion peer eviction protection",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-03-19T19:13:11Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-02-21T21:22:42Z"
      },
      "sha": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4483934493,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDQ4MzkzNDQ5Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4483934493",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-19T19:27:02Z"
    },
    {
      "event": "commented",
      "id": 803064327,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzA2NDMyNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803064327",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-19T19:30:30Z",
      "updated_at": "2021-03-19T19:30:30Z",
      "author_association": "MEMBER",
      "body": "Added documentation and renamed a function per https://github.com/bitcoin/bitcoin/pull/20197#discussion_r597365954.\r\n\r\n<details><summary><code>git diff c18fd59 0cca08a</code></summary><p>\r\n\r\n```diff\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex be93426377..66d81b115f 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -887,7 +887,7 @@ static void EraseLastKElements(\r\n     elements.erase(std::remove_if(elements.end() - eraseSize, elements.end(), predicate), elements.end());\r\n }\r\n \r\n-void ProtectEvictionCandidates(std::vector<NodeEvictionCandidate>& vEvictionCandidates)\r\n+void ProtectEvictionCandidatesByRatio(std::vector<NodeEvictionCandidate>& vEvictionCandidates)\r\n {\r\n     // Protect the half of the remaining nodes which have been connected the longest.\r\n     // This replicates the non-eviction implicit behavior, and precludes attacks that start later.\r\n@@ -945,7 +945,9 @@ void ProtectEvictionCandidates(std::vector<NodeEvictionCandidate>& vEvictionCand\r\n     // An attacker cannot manipulate this metric without performing useful work.\r\n     EraseLastKElements(vEvictionCandidates, CompareNodeBlockTime, 4);\r\n \r\n-    ProtectEvictionCandidates(vEvictionCandidates);\r\n+    // Protect some of the remaining eviction candidates by ratios of desirable\r\n+    // or disadvantaged characteristics.\r\n+    ProtectEvictionCandidatesByRatio(vEvictionCandidates);\r\n \r\n     if (vEvictionCandidates.empty()) return std::nullopt;\r\n \r\ndiff --git a/src/net.h b/src/net.h\r\nindex 449e0c54b7..eb7fa079ab 100644\r\n--- a/src/net.h\r\n+++ b/src/net.h\r\n@@ -1285,8 +1285,36 @@ struct NodeEvictionCandidate\r\n     bool m_is_onion;\r\n };\r\n \r\n-void ProtectEvictionCandidates(std::vector<NodeEvictionCandidate>& vEvictionCandidates);\r\n-\r\n+/**\r\n+ * Select an inbound peer to evict after filtering out (protecting) peers having\r\n+ * distinct, difficult-to-forge characteristics. The protection logic picks out\r\n+ * fixed numbers of desirable peers per various criteria, followed by (mostly)\r\n+ * ratios of desirable or disadvantaged peers. If any eviction candidates\r\n+ * remain, the selection logic chooses a peer to evict.\r\n+ */\r\n [[nodiscard]] std::optional<NodeId> SelectNodeToEvict(std::vector<NodeEvictionCandidate>&& vEvictionCandidates);\r\n \r\n+/** Protect desirable or disadvantaged inbound peers from eviction by ratio.\r\n+ *\r\n+ * This function protects half of the peers which have been connected the\r\n+ * longest, to replicate the non-eviction implicit behavior and preclude attacks\r\n+ * that start later.\r\n+ *\r\n+ * Half of these protected spots (1/4 of the total) are reserved for onion peers\r\n+ * connected via our tor control service, if any, sorted by longest uptime, even\r\n+ * if they're not longest uptime overall. Any remaining slots of the 1/4 are\r\n+ * then allocated to protect localhost peers, if any (or up to 2 localhost peers\r\n+ * if no slots remain and 2 or more onion peers were protected), sorted by\r\n+ * longest uptime, as manually configured hidden services not using\r\n+ * `-bind=addr[:port]=onion` will not be detected as inbound onion connections.\r\n+ *\r\n+ * This helps protect onion peers, which tend to be otherwise disadvantaged\r\n+ * under our eviction criteria for their higher min ping times relative to IPv4\r\n+ * and IPv6 peers, and favorise the diversity of peer connections.\r\n+ *\r\n+ * This function was extracted from SelectNodeToEvict() to be able to test the\r\n+ * ratio-based protection logic deterministically.\r\n+ */\r\n+void ProtectEvictionCandidatesByRatio(std::vector<NodeEvictionCandidate>& vEvictionCandidates);\r\n+\r\n #endif // BITCOIN_NET_H\r\ndiff --git a/src/test/net_peer_eviction_tests.cpp b/src/test/net_peer_eviction_tests.cpp\r\nindex 7b88a3e9b6..31d391bf7d 100644\r\n--- a/src/test/net_peer_eviction_tests.cpp\r\n+++ b/src/test/net_peer_eviction_tests.cpp\r\n@@ -43,9 +43,9 @@ std::vector<NodeEvictionCandidate> GetRandomNodeEvictionCandidates(const int n_c\r\n }\r\n \r\n // Create `num_peers` random nodes, apply setup function `candidate_setup_fn`,\r\n-// apply protection logic, and then return true if all of `protected_peer_ids`\r\n-// and none of `unprotected_peer_ids` are protected from eviction, i.e. removed\r\n-// from the eviction candidates.\r\n+// call ProtectEvictionCandidatesByRatio() to apply protection logic, and then\r\n+// return true if all of `protected_peer_ids` and none of `unprotected_peer_ids`\r\n+// are protected from eviction, i.e. removed from the eviction candidates.\r\n bool IsProtected(int num_peers,\r\n                  std::function<void(NodeEvictionCandidate&)> candidate_setup_fn,\r\n                  const std::unordered_set<NodeId>& protected_peer_ids,\r\n@@ -60,7 +60,7 @@ bool IsProtected(int num_peers,\r\n \r\n     const size_t size{candidates.size()};\r\n     const size_t expected{size - size / 2}; // Expect half the candidates will be protected.\r\n-    ProtectEvictionCandidates(candidates);\r\n+    ProtectEvictionCandidatesByRatio(candidates);\r\n     BOOST_CHECK_EQUAL(candidates.size(), expected);\r\n ```\r\n</p></details>\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-803064327",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "reviewed",
      "id": 617240758,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjE3MjQwNzU4",
      "url": null,
      "actor": null,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK 0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#pullrequestreview-617240758",
      "submitted_at": "2021-03-22T08:15:11Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
    },
    {
      "event": "commented",
      "id": 808800184,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgwODgwMDE4NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/808800184",
      "actor": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-27T20:46:23Z",
      "updated_at": "2021-03-27T20:46:23Z",
      "author_association": "NONE",
      "body": "Interesting PR. Concept ACK. Compiled successfully on Ubuntu. Tests passed.",
      "user": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-808800184",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "commented",
      "id": 810300323,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxMDMwMDMyMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/810300323",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-30T14:20:18Z",
      "updated_at": "2021-03-30T14:20:18Z",
      "author_association": "MEMBER",
      "body": "Code review ACK 0cca08a8ee33b4e05ff586ae4fd914f5ea860cea\r\nI did not do anything in terms of manual testing, but it looks like the change is well-covered by tests.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-810300323",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "merged",
      "id": 4528065087,
      "node_id": "MDExOk1lcmdlZEV2ZW50NDUyODA2NTA4Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4528065087",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "dede9eb9247363aacc3816c7352494a3609fa28b",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dede9eb9247363aacc3816c7352494a3609fa28b",
      "created_at": "2021-03-30T14:21:20Z"
    },
    {
      "event": "closed",
      "id": 4528065129,
      "node_id": "MDExOkNsb3NlZEV2ZW50NDUyODA2NTEyOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4528065129",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-30T14:21:20Z"
    },
    {
      "event": "head_ref_deleted",
      "id": 4528077524,
      "node_id": "MDE5OkhlYWRSZWZEZWxldGVkRXZlbnQ0NTI4MDc3NTI0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4528077524",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-30T14:23:03Z"
    },
    {
      "event": "reviewed",
      "id": 624445128,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjI0NDQ1MTI4",
      "url": null,
      "actor": null,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Post-Merge Comment (reviewed but didn't finish in time yesterday evening):\r\n\r\nI understand the motivation, but just noting that the fixed  `localhost_min_protect_size` in the ratio-based `ProtectEvictionCandidatesByRatio` makes things unintuitive at a lower `initial_size`:\r\n\r\nBoth cases are nicely covered by the unit tests, but it doesn't make a lot of sense to me that at 6 total peers, we'd protect 1 onion, 0 localhost and 2 by generic uptime, whereas at 8 peers, we'd protect 2 onion, 2 localhost and 0 by generic uptime (raising the percentage of potentially protected tor peers to 50% instead of the targeted 25%, so that no slots are left for protecting generic uptime peers).",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#pullrequestreview-624445128",
      "submitted_at": "2021-03-30T16:10:53Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
    },
    {
      "event": "commented",
      "id": 810406955,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxMDQwNjk1NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/810406955",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-30T16:33:58Z",
      "updated_at": "2021-03-30T16:33:58Z",
      "author_association": "MEMBER",
      "body": "Thanks for having a look! Here we have an initial improvement and unit testing in place, and in the next step in #21261 we'll re-evaluate the algorithm and ratios between onion, localhost and I2P peers (considering that other privacy networks may be added soon as well). Please do weigh in there with the ratios you would suggest.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-810406955",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "referenced",
      "id": 4529895829,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQ1Mjk4OTU4Mjk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4529895829",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "6161b6736facceda2fba2696b77977ba40774655",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/6161b6736facceda2fba2696b77977ba40774655",
      "created_at": "2021-03-30T19:27:48Z"
    },
    {
      "event": "removed_from_project",
      "id": 4531230863,
      "node_id": "MDIzOlJlbW92ZWRGcm9tUHJvamVjdEV2ZW50NDUzMTIzMDg2Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4531230863",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-31T00:57:35Z",
      "project_card": {
        "id": 56212572,
        "url": "https://api.github.com/projects/columns/cards/56212572",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Blockers"
      }
    },
    {
      "event": "commented",
      "id": 823330247,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgyMzMzMDI0Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/823330247",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-20T14:40:53Z",
      "updated_at": "2021-04-20T14:40:53Z",
      "author_association": "MEMBER",
      "body": "@mzumsande I've updated the inbound eviction protection proposal in #21261 to be generalizable to multiple networks (with I2P and CJDNS on the way) and fully ratio-based, which should address your feedback. Will be bringing it out of draft shortly.   ",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-823330247",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20197"
    },
    {
      "event": "mentioned",
      "id": 4619682394,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDYxOTY4MjM5NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4619682394",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-20T14:40:54Z"
    },
    {
      "event": "subscribed",
      "id": 4619682403,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ2MTk2ODI0MDM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4619682403",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-20T14:40:54Z"
    },
    {
      "event": "referenced",
      "id": 4885546522,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQ4ODU1NDY1MjI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4885546522",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "5c4f0c4d46f030498c222a15a0399c6e0a7d28f1",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5c4f0c4d46f030498c222a15a0399c6e0a7d28f1",
      "created_at": "2021-06-14T13:05:11Z"
    },
    {
      "event": "referenced",
      "id": 4885879693,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQ4ODU4Nzk2OTM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4885879693",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "b9e1e110ed5d58acb273bd44b33f2523305ef1ff",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/b9e1e110ed5d58acb273bd44b33f2523305ef1ff",
      "created_at": "2021-06-14T14:01:49Z"
    },
    {
      "event": "referenced",
      "id": 6008741606,
      "node_id": "REFE_lADOABII584rP-CYzwAAAAFmJh7m",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6008741606",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "831416335844a1fef53008b9bbd2b216cb7716bf",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/831416335844a1fef53008b9bbd2b216cb7716bf",
      "created_at": "2022-02-04T11:01:51Z"
    },
    {
      "event": "referenced",
      "id": 6008741616,
      "node_id": "REFE_lADOABII584rP-CYzwAAAAFmJh7w",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6008741616",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "e17e1b20619e48b568c4d47fe7b1ae088d705f1c",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/e17e1b20619e48b568c4d47fe7b1ae088d705f1c",
      "created_at": "2022-02-04T11:01:51Z"
    },
    {
      "event": "referenced",
      "id": 6008741621,
      "node_id": "REFE_lADOABII584rP-CYzwAAAAFmJh71",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6008741621",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "7128106e3b4cb8be6778169d43676b2bf366dabf",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/7128106e3b4cb8be6778169d43676b2bf366dabf",
      "created_at": "2022-02-04T11:01:51Z"
    },
    {
      "event": "referenced",
      "id": 6008741625,
      "node_id": "REFE_lADOABII584rP-CYzwAAAAFmJh75",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6008741625",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "e1af69cbcebfefac9892b6123d0ed54eaadcdb91",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/e1af69cbcebfefac9892b6123d0ed54eaadcdb91",
      "created_at": "2022-02-04T11:01:51Z"
    },
    {
      "event": "referenced",
      "id": 6008741631,
      "node_id": "REFE_lADOABII584rP-CYzwAAAAFmJh7_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6008741631",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "443b5d94aef20f2a2c217ee122022713de80952a",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/443b5d94aef20f2a2c217ee122022713de80952a",
      "created_at": "2022-02-04T11:01:51Z"
    },
    {
      "event": "referenced",
      "id": 6008741640,
      "node_id": "REFE_lADOABII584rP-CYzwAAAAFmJh8I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6008741640",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "0cc0457d68a037969d9349395af75d3dda85c8ab",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/0cc0457d68a037969d9349395af75d3dda85c8ab",
      "created_at": "2022-02-04T11:01:51Z"
    },
    {
      "event": "referenced",
      "id": 6169962387,
      "node_id": "REFE_lADOABII584rP-CYzwAAAAFvwieT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6169962387",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "8b6cd42c6226dea28c182a48a214d1c091b9b5bb",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8b6cd42c6226dea28c182a48a214d1c091b9b5bb",
      "created_at": "2022-03-02T11:01:10Z"
    },
    {
      "event": "referenced",
      "id": 7008050973,
      "node_id": "REFE_lADOABII584rP-CYzwAAAAGhtl8d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7008050973",
      "actor": {
        "login": "PastaPastaPasta",
        "id": 6443210,
        "node_id": "MDQ6VXNlcjY0NDMyMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PastaPastaPasta",
        "html_url": "https://github.com/PastaPastaPasta",
        "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
        "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
        "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
        "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
        "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "a83e04a6b090a935ef4dbb3d0445476262bffff2",
      "commit_url": "https://api.github.com/repos/PastaPastaPasta/dash/commits/a83e04a6b090a935ef4dbb3d0445476262bffff2",
      "created_at": "2022-07-17T22:51:43Z"
    },
    {
      "event": "locked",
      "id": 7199124018,
      "node_id": "LOE_lADOABII584rP-CYzwAAAAGtGeoy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7199124018",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-16T17:20:54Z",
      "lock_reason": "resolved"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550767783",
      "pull_request_review_id": 560586885,
      "id": 550767783,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc2Nzc4Mw==",
      "diff_hunk": "@@ -21,17 +21,18 @@ FUZZ_TARGET(node_eviction)\n     std::vector<NodeEvictionCandidate> eviction_candidates;\n     while (fuzzed_data_provider.ConsumeBool()) {\n         eviction_candidates.push_back({\n-            fuzzed_data_provider.ConsumeIntegral<NodeId>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeIntegral<uint64_t>(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n+            /* id */ fuzzed_data_provider.ConsumeIntegral<NodeId>(),\n+            /* nTimeConnected */ fuzzed_data_provider.ConsumeIntegral<int64_t>(),",
      "path": "src/test/fuzz/node_eviction.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "0d167683b670cb2220052a7719c8ab32ce479bbd",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "there is a nice syntax for this:\r\n\r\n```cpp\r\n{.id = 123, .nTimeConnected = 567, ...}\r\n```\r\n\r\nbut last time I tried some old version of GCC did not support it. Maybe some day...",
      "created_at": "2021-01-01T13:16:31Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550767783",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550767783"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": 24,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550768441",
      "pull_request_review_id": 560586885,
      "id": 550768441,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc2ODQ0MQ==",
      "diff_hunk": "@@ -1247,6 +1247,7 @@ struct NodeEvictionCandidate\n     uint64_t nKeyedNetGroup;\n     bool prefer_evict;\n     bool m_is_local;\n+    bool m_is_onion;",
      "path": "src/net.h",
      "position": 12,
      "original_position": 4,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "0d167683b670cb2220052a7719c8ab32ce479bbd",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The commit message reads \"p2p: add m_inbound_onion to AttemptToEvictConnection()\". Shouldn't that be `s/AttemptToEvictConnection()/NodeEvictionCandidate/`?",
      "created_at": "2021-01-01T13:25:44Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550768441",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550768441"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": 1284,
      "original_start_line": 1249,
      "start_side": "RIGHT",
      "line": 1285,
      "original_line": 1285,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550769530",
      "pull_request_review_id": 560586885,
      "id": 550769530,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc2OTUzMA==",
      "diff_hunk": "@@ -923,16 +929,25 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n \n     // Protect the half of the remaining nodes which have been connected the longest.\n     // This replicates the non-eviction implicit behavior, and precludes attacks that start later.\n-    // Reserve half of these protected spots for localhost peers, even if\n+    // Reserve half of these protected spots for onion and localhost peers, even if\n     // they're not longest-uptime overall. This helps protect tor peers, which\n     // tend to be otherwise disadvantaged under our eviction criteria.\n-    size_t initial_size = vEvictionCandidates.size();\n+    const size_t initial_size = vEvictionCandidates.size();\n     size_t total_protect_size = initial_size / 2;\n \n-    // Pick out up to 1/4 peers that are localhost, sorted by longest uptime.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareLocalHostTimeConnected);\n-    size_t local_erase_size = total_protect_size / 2;\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_local; }), vEvictionCandidates.end());\n+    // Pick out up to 1/4 peers that are connected via our tor onion service, sorted by longest uptime.\n+    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareOnionTimeConnected);\n+    const size_t local_erase_size = total_protect_size / 2;\n+    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_onion; }), vEvictionCandidates.end());\n+\n+    // If no onion peers were removed, extend the same protection to localhost peers, as manually\n+    // configured hidden services not using -bind will not be detected as inbound onion connections.",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    // configured hidden services not using -bind=addr:port=onion will not be detected as inbound onion connections.\r\n```",
      "created_at": "2021-01-01T13:39:46Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550769530",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550769530"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 944,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550774610",
      "pull_request_review_id": 560586885,
      "id": 550774610,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc3NDYxMA==",
      "diff_hunk": "@@ -923,16 +929,25 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n \n     // Protect the half of the remaining nodes which have been connected the longest.\n     // This replicates the non-eviction implicit behavior, and precludes attacks that start later.\n-    // Reserve half of these protected spots for localhost peers, even if\n+    // Reserve half of these protected spots for onion and localhost peers, even if\n     // they're not longest-uptime overall. This helps protect tor peers, which\n     // tend to be otherwise disadvantaged under our eviction criteria.\n-    size_t initial_size = vEvictionCandidates.size();\n+    const size_t initial_size = vEvictionCandidates.size();\n     size_t total_protect_size = initial_size / 2;\n \n-    // Pick out up to 1/4 peers that are localhost, sorted by longest uptime.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareLocalHostTimeConnected);\n-    size_t local_erase_size = total_protect_size / 2;\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_local; }), vEvictionCandidates.end());\n+    // Pick out up to 1/4 peers that are connected via our tor onion service, sorted by longest uptime.\n+    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareOnionTimeConnected);\n+    const size_t local_erase_size = total_protect_size / 2;\n+    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_onion; }), vEvictionCandidates.end());",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "What about extending `EraseLastKElements()` with one more argument \"predicate\" and remove elements only if it returns `true` on them (with a default that assumes `true` for any element)?\r\n\r\nThen this code would look like:\r\n\r\n```cpp\r\nEraseLastKElements(\r\n    vEvictionCandidates,\r\n    CompareOnionTimeConnected,\r\n    local_erase_size,\r\n    [](NodeEvictionCandidate const &n) { return n.m_is_onion; });\r\n```\r\n\r\nmaybe out of the scope of this PR.",
      "created_at": "2021-01-01T14:41:41Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550774610",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550774610"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 941,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550775652",
      "pull_request_review_id": 560586885,
      "id": 550775652,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc3NTY1Mg==",
      "diff_hunk": "@@ -923,16 +929,25 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n \n     // Protect the half of the remaining nodes which have been connected the longest.\n     // This replicates the non-eviction implicit behavior, and precludes attacks that start later.\n-    // Reserve half of these protected spots for localhost peers, even if\n+    // Reserve half of these protected spots for onion and localhost peers, even if\n     // they're not longest-uptime overall. This helps protect tor peers, which\n     // tend to be otherwise disadvantaged under our eviction criteria.\n-    size_t initial_size = vEvictionCandidates.size();\n+    const size_t initial_size = vEvictionCandidates.size();\n     size_t total_protect_size = initial_size / 2;\n \n-    // Pick out up to 1/4 peers that are localhost, sorted by longest uptime.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareLocalHostTimeConnected);\n-    size_t local_erase_size = total_protect_size / 2;\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_local; }), vEvictionCandidates.end());\n+    // Pick out up to 1/4 peers that are connected via our tor onion service, sorted by longest uptime.\n+    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareOnionTimeConnected);\n+    const size_t local_erase_size = total_protect_size / 2;\n+    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_onion; }), vEvictionCandidates.end());\n+\n+    // If no onion peers were removed, extend the same protection to localhost peers, as manually\n+    // configured hidden services not using -bind will not be detected as inbound onion connections.\n+    if (initial_size == vEvictionCandidates.size()) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Just to note - this assumes that if there are recognizable onion connections (via `-bind=addr:port=onion`) then there are **not** non-recognizable ones (statically/manually configured tor daemon pointing to our standard p2p port, e.g. 8333).\r\n\r\nThis assumption may not be true as there could be a node that is configured both via `-bind=addr:port=onion` (connections coming to 8334 are recognized as onion) and also a static tor config redirecting to 8333.\r\n\r\nI think the code is ok as it is because the above would be rare and maybe not worth the code complexity to tweak the eviction policy for it.",
      "created_at": "2021-01-01T14:54:19Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550775652",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550775652"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 945,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557297105",
      "pull_request_review_id": 568106998,
      "id": 557297105,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzI5NzEwNQ==",
      "diff_hunk": "@@ -21,17 +21,18 @@ FUZZ_TARGET(node_eviction)\n     std::vector<NodeEvictionCandidate> eviction_candidates;\n     while (fuzzed_data_provider.ConsumeBool()) {\n         eviction_candidates.push_back({\n-            fuzzed_data_provider.ConsumeIntegral<NodeId>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeIntegral<uint64_t>(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n+            /* id */ fuzzed_data_provider.ConsumeIntegral<NodeId>(),\n+            /* nTimeConnected */ fuzzed_data_provider.ConsumeIntegral<int64_t>(),",
      "path": "src/test/fuzz/node_eviction.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "0d167683b670cb2220052a7719c8ab32ce479bbd",
      "in_reply_to_id": 550767783,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Designated initializers are only standardized in c++20: https://en.cppreference.com/w/cpp/language/aggregate_initialization#Designated_initializers",
      "created_at": "2021-01-14T10:34:54Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r557297105",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557297105"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": 24,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/558102071",
      "pull_request_review_id": 569084962,
      "id": 558102071,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1ODEwMjA3MQ==",
      "diff_hunk": "@@ -923,16 +929,25 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n \n     // Protect the half of the remaining nodes which have been connected the longest.\n     // This replicates the non-eviction implicit behavior, and precludes attacks that start later.\n-    // Reserve half of these protected spots for localhost peers, even if\n+    // Reserve half of these protected spots for onion and localhost peers, even if\n     // they're not longest-uptime overall. This helps protect tor peers, which\n     // tend to be otherwise disadvantaged under our eviction criteria.\n-    size_t initial_size = vEvictionCandidates.size();\n+    const size_t initial_size = vEvictionCandidates.size();\n     size_t total_protect_size = initial_size / 2;\n \n-    // Pick out up to 1/4 peers that are localhost, sorted by longest uptime.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareLocalHostTimeConnected);\n-    size_t local_erase_size = total_protect_size / 2;\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_local; }), vEvictionCandidates.end());\n+    // Pick out up to 1/4 peers that are connected via our tor onion service, sorted by longest uptime.\n+    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareOnionTimeConnected);\n+    const size_t local_erase_size = total_protect_size / 2;\n+    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_onion; }), vEvictionCandidates.end());",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "in_reply_to_id": 550774610,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Something like this may work (untested, feel free to ignore):\r\n\r\n<details>\r\n<summary>[patch] EraseLastKElements() with predicate</summary>\r\n\r\n```diff\r\ndiff --git i/src/net.cpp w/src/net.cpp\r\nindex ddf33c38a..64900b8b5 100644\r\n--- i/src/net.cpp\r\n+++ w/src/net.cpp\r\n@@ -41,12 +41,13 @@\r\n // with Ubuntu 16.04 LTS and Debian 8 libminiupnpc-dev packages.\r\n static_assert(MINIUPNPC_API_VERSION >= 10, \"miniUPnPc API version >= 10 assumed\");\r\n #endif\r\n \r\n #include <algorithm>\r\n #include <cstdint>\r\n+#include <functional> /* std::function */\r\n #include <unordered_map>\r\n \r\n #include <math.h>\r\n \r\n /** Maximum number of block-relay-only anchor connections */\r\n static constexpr size_t MAX_BLOCK_RELAY_ONLY_ANCHORS = 2;\r\n@@ -893,38 +894,46 @@ static bool CompareNodeBlockRelayOnlyTime(const NodeEvictionCandidate &a, const\r\n     if (a.fRelayTxes != b.fRelayTxes) return a.fRelayTxes;\r\n     if (a.nLastBlockTime != b.nLastBlockTime) return a.nLastBlockTime < b.nLastBlockTime;\r\n     if (a.fRelevantServices != b.fRelevantServices) return b.fRelevantServices;\r\n     return a.nTimeConnected > b.nTimeConnected;\r\n }\r\n \r\n-//! Sort an array by the specified comparator, then erase the last K elements.\r\n-template<typename T, typename Comparator>\r\n-static void EraseLastKElements(std::vector<T> &elements, Comparator comparator, size_t k)\r\n+//! Sort an array by the specified comparator, then erase each one of the last K elements if\r\n+//! `pred(element)` returns true.\r\n+template <typename T, typename Comparator>\r\n+static void EraseLastKElements(\r\n+    std::vector<T>& elements,\r\n+    Comparator comparator,\r\n+    size_t k,\r\n+    std::function<bool(const T&)> pred = [](const T&) { return true; })\r\n {\r\n     std::sort(elements.begin(), elements.end(), comparator);\r\n     size_t eraseSize = std::min(k, elements.size());\r\n-    elements.erase(elements.end() - eraseSize, elements.end());\r\n+    elements.erase(std::remove_if(elements.end() - eraseSize, elements.end(), pred),\r\n+                   elements.end());\r\n }\r\n \r\n [[nodiscard]] Optional<NodeId> SelectNodeToEvict(std::vector<NodeEvictionCandidate>&& vEvictionCandidates)\r\n {\r\n     // Protect connections with certain characteristics\r\n \r\n+    std::function<bool(const NodeEvictionCandidate&)> pred;\r\n+\r\n     // Deterministically select 4 peers to protect by netgroup.\r\n     // An attacker cannot predict which netgroups will be protected\r\n     EraseLastKElements(vEvictionCandidates, CompareNetGroupKeyed, 4);\r\n     // Protect the 8 nodes with the lowest minimum ping time.\r\n     // An attacker cannot manipulate this metric without physically moving nodes closer to the target.\r\n     EraseLastKElements(vEvictionCandidates, ReverseCompareNodeMinPingTime, 8);\r\n     // Protect 4 nodes that most recently sent us novel transactions accepted into our mempool.\r\n     // An attacker cannot manipulate this metric without performing useful work.\r\n     EraseLastKElements(vEvictionCandidates, CompareNodeTXTime, 4);\r\n     // Protect up to 8 non-tx-relay peers that have sent us novel blocks.\r\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareNodeBlockRelayOnlyTime);\r\n-    size_t erase_size = std::min(size_t(8), vEvictionCandidates.size());\r\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return !n.fRelayTxes && n.fRelevantServices; }), vEvictionCandidates.end());\r\n+    const size_t erase_size = std::min(size_t(8), vEvictionCandidates.size());\r\n+    pred = [](const NodeEvictionCandidate& n) { return !n.fRelayTxes && n.fRelevantServices; };\r\n+    EraseLastKElements(vEvictionCandidates, CompareNodeBlockRelayOnlyTime, erase_size, pred);\r\n \r\n     // Protect 4 nodes that most recently sent us novel blocks.\r\n     // An attacker cannot manipulate this metric without performing useful work.\r\n     EraseLastKElements(vEvictionCandidates, CompareNodeBlockTime, 4);\r\n \r\n     // Protect the half of the remaining nodes which have been connected the longest.\r\n@@ -933,22 +942,22 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\r\n     // they're not longest-uptime overall. This helps protect tor peers, which\r\n     // tend to be otherwise disadvantaged under our eviction criteria.\r\n     const size_t initial_size = vEvictionCandidates.size();\r\n     size_t total_protect_size = initial_size / 2;\r\n \r\n     // Pick out up to 1/4 peers that are connected via our tor onion service, sorted by longest uptime.\r\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareOnionTimeConnected);\r\n     const size_t local_erase_size = total_protect_size / 2;\r\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_onion; }), vEvictionCandidates.end());\r\n+    pred = [](const NodeEvictionCandidate& n) { return n.m_is_onion; };\r\n+    EraseLastKElements(vEvictionCandidates, CompareOnionTimeConnected, local_erase_size, pred);\r\n \r\n     // If no onion peers were removed, extend the same protection to localhost peers, as manually\r\n     // configured hidden services not using -bind will not be detected as inbound onion connections.\r\n     if (initial_size == vEvictionCandidates.size()) {\r\n         // Pick out up to 1/4 peers that are localhost, sorted by longest uptime.\r\n-        std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareLocalHostTimeConnected);\r\n-        vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_local; }), vEvictionCandidates.end());\r\n+        pred = [](const NodeEvictionCandidate& n) { return n.m_is_local; };\r\n+        EraseLastKElements(vEvictionCandidates, CompareLocalHostTimeConnected, local_erase_size, pred);\r\n     }\r\n \r\n     // Calculate how many we removed, and update our total number of peers that\r\n     // we want to protect based on uptime accordingly.\r\n     total_protect_size -= initial_size - vEvictionCandidates.size();\r\n     EraseLastKElements(vEvictionCandidates, ReverseCompareNodeTimeConnected, total_protect_size);\r\n@@ -956,14 +965,15 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\r\n     if (vEvictionCandidates.empty()) return nullopt;\r\n \r\n     // If any remaining peers are preferred for eviction consider only them.\r\n     // This happens after the other preferences since if a peer is really the best by other criteria (esp relaying blocks)\r\n     //  then we probably don't want to evict it no matter what.\r\n     if (std::any_of(vEvictionCandidates.begin(),vEvictionCandidates.end(),[](NodeEvictionCandidate const &n){return n.prefer_evict;})) {\r\n-        vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.begin(),vEvictionCandidates.end(),\r\n-                                  [](NodeEvictionCandidate const &n){return !n.prefer_evict;}),vEvictionCandidates.end());\r\n+        pred = [](const NodeEvictionCandidate& n) { return !n.prefer_evict; };\r\n+        EraseLastKElements(vEvictionCandidates, ReverseCompareNodeTimeConnected,\r\n+                           vEvictionCandidates.size(), pred);\r\n     }\r\n \r\n     // Identify the network group with the most connections and youngest member.\r\n     // (vEvictionCandidates is already sorted by reverse connect time)\r\n     uint64_t naMostConnections;\r\n     unsigned int nMostConnections = 0;\r\n```\r\n</details>\r\n",
      "created_at": "2021-01-15T09:16:03Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r558102071",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/558102071"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 941,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/558126886",
      "pull_request_review_id": 569097939,
      "id": 558126886,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1ODEyNjg4Ng==",
      "diff_hunk": "@@ -923,16 +929,25 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n \n     // Protect the half of the remaining nodes which have been connected the longest.\n     // This replicates the non-eviction implicit behavior, and precludes attacks that start later.\n-    // Reserve half of these protected spots for localhost peers, even if\n+    // Reserve half of these protected spots for onion and localhost peers, even if\n     // they're not longest-uptime overall. This helps protect tor peers, which\n     // tend to be otherwise disadvantaged under our eviction criteria.\n-    size_t initial_size = vEvictionCandidates.size();\n+    const size_t initial_size = vEvictionCandidates.size();\n     size_t total_protect_size = initial_size / 2;\n \n-    // Pick out up to 1/4 peers that are localhost, sorted by longest uptime.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareLocalHostTimeConnected);\n-    size_t local_erase_size = total_protect_size / 2;\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_local; }), vEvictionCandidates.end());\n+    // Pick out up to 1/4 peers that are connected via our tor onion service, sorted by longest uptime.\n+    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareOnionTimeConnected);\n+    const size_t local_erase_size = total_protect_size / 2;\n+    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_onion; }), vEvictionCandidates.end());",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "in_reply_to_id": 550774610,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks! I started with the quick patch below on January 2, will compare with your ideas above.\r\n\r\n<details><summary>patch</summary><p>\r\n\r\n```diff\r\n-//! Sort an array by the specified comparator, then erase the last K elements.\r\n+//! Sort an array by the specified comparator, then erase the last K elements where predicate is true.\r\n template<typename T, typename Comparator>\r\n-static void EraseLastKElements(std::vector<T> &elements, Comparator comparator, size_t k)\r\n+static void EraseLastKElements(std::vector<T> &elements, Comparator comparator, size_t k, std::function<bool(const NodeEvictionCandidate&)> predicate = [](NodeEvictionCandidate const &n) { return true ;})\r\n {\r\n     std::sort(elements.begin(), elements.end(), comparator);\r\n-    size_t eraseSize = std::min(k, elements.size());\r\n-    elements.erase(elements.end() - eraseSize, elements.end());\r\n+    size_t erase_size = std::min(k, elements.size());\r\n+    elements.erase(std::remove_if(elements.end() - erase_size, elements.end(), predicate), elements.end());\r\n }\r\n \r\n [[nodiscard]] Optional<NodeId> SelectNodeToEvict(std::vector<NodeEvictionCandidate>&& vEvictionCandidates)\r\n@@ -934,16 +934,15 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\r\n     size_t total_protect_size = initial_size / 2;\r\n \r\n     // Pick out up to 1/4 peers that are connected via our tor onion service, sorted by longest uptime.\r\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareOnionTimeConnected);\r\n     const size_t local_erase_size = total_protect_size / 2;\r\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_onion; }), vEvictionCandidates.end());\r\n+    EraseLastKElements(vEvictionCandidates, CompareOnionTimeConnected, local_erase_size, [](NodeEvictionCandidate const &n) { return n.m_is_onion; });\r\n+;\r\n \r\n     // If no onion peers were removed, extend the same protection to localhost peers, as manually\r\n-    // configured hidden services not using -bind will not be detected as inbound onion connections.\r\n+    // configured hidden services not using -bind=addr:port=onion will not be detected as inbound onion connections.\r\n     if (initial_size == vEvictionCandidates.size()) {\r\n         // Pick out up to 1/4 peers that are localhost, sorted by longest uptime.\r\n-        std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareLocalHostTimeConnected);\r\n-        vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_local; }), vEvictionCandidates.end());\r\n+        EraseLastKElements(vEvictionCandidates, CompareLocalHostTimeConnected, local_erase_size, [](NodeEvictionCandidate const &n) { return n.m_is_local; });\r\n     }\r\n```\r\n</p></details>\r\n",
      "created_at": "2021-01-15T09:33:15Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r558126886",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/558126886"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 941,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/565270556",
      "pull_request_review_id": 577285983,
      "id": 565270556,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NTI3MDU1Ng==",
      "diff_hunk": "@@ -21,17 +21,18 @@ FUZZ_TARGET(node_eviction)\n     std::vector<NodeEvictionCandidate> eviction_candidates;\n     while (fuzzed_data_provider.ConsumeBool()) {\n         eviction_candidates.push_back({\n-            fuzzed_data_provider.ConsumeIntegral<NodeId>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeIntegral<uint64_t>(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n+            /* id */ fuzzed_data_provider.ConsumeIntegral<NodeId>(),\n+            /* nTimeConnected */ fuzzed_data_provider.ConsumeIntegral<int64_t>(),",
      "path": "src/test/fuzz/node_eviction.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "0d167683b670cb2220052a7719c8ab32ce479bbd",
      "in_reply_to_id": 550767783,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Already used here?\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/11d3b5833671db3b884171086489e853738e7ddd/src/test/fuzz/util.h#L272-L273",
      "created_at": "2021-01-27T12:31:19Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r565270556",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/565270556"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": 24,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/565280022",
      "pull_request_review_id": 577298543,
      "id": 565280022,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NTI4MDAyMg==",
      "diff_hunk": "@@ -21,17 +21,18 @@ FUZZ_TARGET(node_eviction)\n     std::vector<NodeEvictionCandidate> eviction_candidates;\n     while (fuzzed_data_provider.ConsumeBool()) {\n         eviction_candidates.push_back({\n-            fuzzed_data_provider.ConsumeIntegral<NodeId>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeIntegral<uint64_t>(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n+            /* id */ fuzzed_data_provider.ConsumeIntegral<NodeId>(),\n+            /* nTimeConnected */ fuzzed_data_provider.ConsumeIntegral<int64_t>(),",
      "path": "src/test/fuzz/node_eviction.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "0d167683b670cb2220052a7719c8ab32ce479bbd",
      "in_reply_to_id": 550767783,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Interesting. Are the fuzzers compiled with --std=c++2a?",
      "created_at": "2021-01-27T12:47:19Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r565280022",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/565280022"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": 24,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/565290955",
      "pull_request_review_id": 577312586,
      "id": 565290955,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NTI5MDk1NQ==",
      "diff_hunk": "@@ -21,17 +21,18 @@ FUZZ_TARGET(node_eviction)\n     std::vector<NodeEvictionCandidate> eviction_candidates;\n     while (fuzzed_data_provider.ConsumeBool()) {\n         eviction_candidates.push_back({\n-            fuzzed_data_provider.ConsumeIntegral<NodeId>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeIntegral<uint64_t>(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n+            /* id */ fuzzed_data_provider.ConsumeIntegral<NodeId>(),\n+            /* nTimeConnected */ fuzzed_data_provider.ConsumeIntegral<int64_t>(),",
      "path": "src/test/fuzz/node_eviction.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "0d167683b670cb2220052a7719c8ab32ce479bbd",
      "in_reply_to_id": 550767783,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "No. My guess is that fuzz tests are not compiled with the old compiler that chokes on this syntax and that most compilers support it even in `-std=c++17` mode.",
      "created_at": "2021-01-27T13:04:41Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r565290955",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/565290955"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": 24,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/574617967",
      "pull_request_review_id": 588713753,
      "id": 574617967,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDYxNzk2Nw==",
      "diff_hunk": "@@ -1247,6 +1247,7 @@ struct NodeEvictionCandidate\n     uint64_t nKeyedNetGroup;\n     bool prefer_evict;\n     bool m_is_local;\n+    bool m_is_onion;",
      "path": "src/net.h",
      "position": 12,
      "original_position": 4,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "0d167683b670cb2220052a7719c8ab32ce479bbd",
      "in_reply_to_id": 550768441,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Sure, I think the salient change in that commit is adding `m_inbound_onion` to `AttemptToEvictConnection` but happy to append \"and add m_is_onion to NodeEvictionCandidate\" to the commit message body.",
      "created_at": "2021-02-11T15:57:48Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r574617967",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/574617967"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": 1284,
      "original_start_line": 1249,
      "start_side": "RIGHT",
      "line": 1285,
      "original_line": 1285,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/574629036",
      "pull_request_review_id": 588729072,
      "id": 574629036,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDYyOTAzNg==",
      "diff_hunk": "@@ -1247,6 +1247,7 @@ struct NodeEvictionCandidate\n     uint64_t nKeyedNetGroup;\n     bool prefer_evict;\n     bool m_is_local;\n+    bool m_is_onion;",
      "path": "src/net.h",
      "position": 12,
      "original_position": 4,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "0d167683b670cb2220052a7719c8ab32ce479bbd",
      "in_reply_to_id": 550768441,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2021-02-11T16:11:29Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r574629036",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/574629036"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": 1284,
      "original_start_line": 1249,
      "start_side": "RIGHT",
      "line": 1285,
      "original_line": 1285,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/574631112",
      "pull_request_review_id": 588731923,
      "id": 574631112,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDYzMTExMg==",
      "diff_hunk": "@@ -923,16 +929,25 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n \n     // Protect the half of the remaining nodes which have been connected the longest.\n     // This replicates the non-eviction implicit behavior, and precludes attacks that start later.\n-    // Reserve half of these protected spots for localhost peers, even if\n+    // Reserve half of these protected spots for onion and localhost peers, even if\n     // they're not longest-uptime overall. This helps protect tor peers, which\n     // tend to be otherwise disadvantaged under our eviction criteria.\n-    size_t initial_size = vEvictionCandidates.size();\n+    const size_t initial_size = vEvictionCandidates.size();\n     size_t total_protect_size = initial_size / 2;\n \n-    // Pick out up to 1/4 peers that are localhost, sorted by longest uptime.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareLocalHostTimeConnected);\n-    size_t local_erase_size = total_protect_size / 2;\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_local; }), vEvictionCandidates.end());\n+    // Pick out up to 1/4 peers that are connected via our tor onion service, sorted by longest uptime.\n+    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareOnionTimeConnected);\n+    const size_t local_erase_size = total_protect_size / 2;\n+    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_onion; }), vEvictionCandidates.end());\n+\n+    // If no onion peers were removed, extend the same protection to localhost peers, as manually\n+    // configured hidden services not using -bind will not be detected as inbound onion connections.",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "in_reply_to_id": 550769530,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks, replaced `-bind` with `-bind=<addr>[:<port>]=onion` like the -bind help.",
      "created_at": "2021-02-11T16:14:11Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r574631112",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/574631112"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 944,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/582806300",
      "pull_request_review_id": 598527516,
      "id": 582806300,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjgwNjMwMA==",
      "diff_hunk": "@@ -0,0 +1,304 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <net.h>\n+#include <optional.h>\n+#include <test/util/setup_common.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <algorithm>\n+#include <functional>\n+#include <vector>\n+\n+BOOST_FIXTURE_TEST_SUITE(net_peer_eviction_tests, BasicTestingSetup)\n+\n+namespace {\n+constexpr int NODE_EVICTION_TEST_ROUNDS{10};\n+constexpr int NODE_EVICTION_TEST_UP_TO_N_NODES{200};\n+} // namespace\n+\n+std::vector<NodeEvictionCandidate> GetRandomNodeEvictionCandidates(const int n_candidates, FastRandomContext& random_context)\n+{\n+    std::vector<NodeEvictionCandidate> candidates;\n+    for (int id = 0; id < n_candidates; ++id) {\n+        candidates.push_back({\n+            /* id */ id,\n+            /* nTimeConnected */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* m_min_ping_time */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* nLastBlockTime */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* nLastTXTime */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* fRelevantServices */ random_context.randbool(),\n+            /* fRelayTxes */ random_context.randbool(),\n+            /* fBloomFilter */ random_context.randbool(),\n+            /* nKeyedNetGroup */ random_context.randrange(100),\n+            /* prefer_evict */ random_context.randbool(),\n+            /* m_is_local */ random_context.randbool(),\n+            /* m_is_onion */ random_context.randbool(),\n+        });\n+    }\n+    return candidates;\n+}\n+\n+// Create `num_peers` random nodes, apply setup function `candidate_setup_fn`,\n+// apply protection logic, and then return true if all of `protected_peer_ids`\n+// and none of `unprotected_peer_ids` are protected from eviction, i.e. removed\n+// from the eviction candidates.\n+bool IsProtected(int num_peers,\n+                 std::function<void(NodeEvictionCandidate&)> candidate_setup_fn,\n+                 const std::vector<NodeId>& protected_peer_ids,\n+                 const std::vector<NodeId>& unprotected_peer_ids,\n+                 FastRandomContext& random_context)\n+{\n+    std::vector<NodeEvictionCandidate> candidates{GetRandomNodeEvictionCandidates(num_peers, random_context)};\n+    for (NodeEvictionCandidate& candidate : candidates) {\n+        candidate_setup_fn(candidate);\n+    }\n+    Shuffle(candidates.begin(), candidates.end(), random_context);\n+\n+    const size_t expected{candidates.size() / 2}; // expect half the candidates will be protected\n+    ProtectEvictionCandidates(candidates);\n+    const size_t actual{candidates.size()};\n+    BOOST_CHECK(actual == expected || actual == expected + 1);\n+\n+    size_t unprotected_as_expected{0};\n+    for (const NodeEvictionCandidate& candidate : candidates) {\n+        if (std::find(protected_peer_ids.begin(), protected_peer_ids.end(), candidate.id) != protected_peer_ids.end()) {\n+            // this peer should have been removed from the eviction candidates\n+            BOOST_TEST_MESSAGE(strprintf(\"candidate id: %d\", candidate.id));\n+            return false;\n+        }\n+        if (std::find(unprotected_peer_ids.begin(), unprotected_peer_ids.end(), candidate.id) != unprotected_peer_ids.end()) {\n+            // this peer remains in the eviction candidates, as expected\n+            ++unprotected_as_expected;\n+        }\n+    }",
      "path": "src/test/net_peer_eviction_tests.cpp",
      "position": null,
      "original_position": 76,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "f1c02b3ef9fa4bbd82144eebbeaf8c9c9df238c5",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This loop is `O(num_peers * (num_protected + num_unprotected))`. It can easily be reduced to `O(num_peers)` by replacing the `std::vector` arguments with `std::unordered_set` (which can tell if an element is present in `O(1)` time). This will also simplify the lookups:\r\n\r\n```diff\r\n-if (std::find(protected_peer_ids.begin(), protected_peer_ids.end(), candidate.id) != protected_peer_ids.end()) {\r\n+if (protected_peer_ids.count(candidate.id) > 0) {\r\n```",
      "created_at": "2021-02-25T12:49:46Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r582806300",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/582806300"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": 66,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 77,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/582813828",
      "pull_request_review_id": 598527516,
      "id": 582813828,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjgxMzgyOA==",
      "diff_hunk": "@@ -0,0 +1,304 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <net.h>\n+#include <optional.h>\n+#include <test/util/setup_common.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <algorithm>\n+#include <functional>\n+#include <vector>\n+\n+BOOST_FIXTURE_TEST_SUITE(net_peer_eviction_tests, BasicTestingSetup)\n+\n+namespace {\n+constexpr int NODE_EVICTION_TEST_ROUNDS{10};\n+constexpr int NODE_EVICTION_TEST_UP_TO_N_NODES{200};\n+} // namespace\n+\n+std::vector<NodeEvictionCandidate> GetRandomNodeEvictionCandidates(const int n_candidates, FastRandomContext& random_context)\n+{\n+    std::vector<NodeEvictionCandidate> candidates;\n+    for (int id = 0; id < n_candidates; ++id) {\n+        candidates.push_back({\n+            /* id */ id,\n+            /* nTimeConnected */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* m_min_ping_time */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* nLastBlockTime */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* nLastTXTime */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* fRelevantServices */ random_context.randbool(),\n+            /* fRelayTxes */ random_context.randbool(),\n+            /* fBloomFilter */ random_context.randbool(),\n+            /* nKeyedNetGroup */ random_context.randrange(100),\n+            /* prefer_evict */ random_context.randbool(),\n+            /* m_is_local */ random_context.randbool(),\n+            /* m_is_onion */ random_context.randbool(),\n+        });\n+    }\n+    return candidates;\n+}\n+\n+// Create `num_peers` random nodes, apply setup function `candidate_setup_fn`,\n+// apply protection logic, and then return true if all of `protected_peer_ids`\n+// and none of `unprotected_peer_ids` are protected from eviction, i.e. removed\n+// from the eviction candidates.\n+bool IsProtected(int num_peers,\n+                 std::function<void(NodeEvictionCandidate&)> candidate_setup_fn,\n+                 const std::vector<NodeId>& protected_peer_ids,\n+                 const std::vector<NodeId>& unprotected_peer_ids,\n+                 FastRandomContext& random_context)\n+{\n+    std::vector<NodeEvictionCandidate> candidates{GetRandomNodeEvictionCandidates(num_peers, random_context)};\n+    for (NodeEvictionCandidate& candidate : candidates) {\n+        candidate_setup_fn(candidate);\n+    }\n+    Shuffle(candidates.begin(), candidates.end(), random_context);\n+\n+    const size_t expected{candidates.size() / 2}; // expect half the candidates will be protected\n+    ProtectEvictionCandidates(candidates);\n+    const size_t actual{candidates.size()};\n+    BOOST_CHECK(actual == expected || actual == expected + 1);\n+\n+    size_t unprotected_as_expected{0};\n+    for (const NodeEvictionCandidate& candidate : candidates) {\n+        if (std::find(protected_peer_ids.begin(), protected_peer_ids.end(), candidate.id) != protected_peer_ids.end()) {\n+            // this peer should have been removed from the eviction candidates\n+            BOOST_TEST_MESSAGE(strprintf(\"candidate id: %d\", candidate.id));\n+            return false;\n+        }\n+        if (std::find(unprotected_peer_ids.begin(), unprotected_peer_ids.end(), candidate.id) != unprotected_peer_ids.end()) {\n+            // this peer remains in the eviction candidates, as expected\n+            ++unprotected_as_expected;\n+        }\n+    }\n+    return unprotected_as_expected == unprotected_peer_ids.size();\n+}\n+\n+BOOST_AUTO_TEST_CASE(peer_protection_test)\n+{\n+    FastRandomContext random_context{true};\n+    int num_peers{12};\n+\n+    // Expect half of the peers with greatest uptime (the lowest nTimeConnected)\n+    // to be protected from eviction.\n+    BOOST_CHECK(IsProtected(\n+        num_peers, [](NodeEvictionCandidate& c) {\n+            c.nTimeConnected = c.id;\n+            c.m_is_onion = c.m_is_local = false;\n+        },\n+        /* protected_peer_ids */ {0, 1, 2, 3, 4, 5},\n+        /* unprotected_peer_ids */ {6, 7, 8, 9, 10, 11},\n+        random_context));\n+\n+    // Verify in the opposite direction.\n+    BOOST_CHECK(IsProtected(\n+        num_peers, [num_peers](NodeEvictionCandidate& c) {\n+            c.nTimeConnected = num_peers - c.id;\n+            c.m_is_onion = c.m_is_local = false;\n+        },\n+        /* protected_peer_ids */ {6, 7, 8, 9, 10, 11},\n+        /* unprotected_peer_ids */ {0, 1, 2, 3, 4, 5},\n+        random_context));\n+\n+    // Test protection of onion and localhost peers...\n+\n+    // Expect 1/4 onion peers to be protected from eviction,\n+    // independently of other characteristics.\n+    BOOST_CHECK(IsProtected(\n+        num_peers, [](NodeEvictionCandidate& c) {\n+            c.m_is_onion = (c.id == 3 || c.id == 8 || c.id == 9) ? true : false;",
      "path": "src/test/net_peer_eviction_tests.cpp",
      "position": null,
      "original_position": 112,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "f1c02b3ef9fa4bbd82144eebbeaf8c9c9df238c5",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: here and below, `expr ? true : false` is equivalent to `expr`\r\n\r\n```suggestion\r\n            c.m_is_onion = (c.id == 3 || c.id == 8 || c.id == 9);\r\n```",
      "created_at": "2021-02-25T13:01:55Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r582813828",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/582813828"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 112,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/582820494",
      "pull_request_review_id": 598527516,
      "id": 582820494,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjgyMDQ5NA==",
      "diff_hunk": "@@ -0,0 +1,304 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <net.h>\n+#include <optional.h>\n+#include <test/util/setup_common.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <algorithm>\n+#include <functional>\n+#include <vector>\n+\n+BOOST_FIXTURE_TEST_SUITE(net_peer_eviction_tests, BasicTestingSetup)\n+\n+namespace {\n+constexpr int NODE_EVICTION_TEST_ROUNDS{10};\n+constexpr int NODE_EVICTION_TEST_UP_TO_N_NODES{200};\n+} // namespace\n+\n+std::vector<NodeEvictionCandidate> GetRandomNodeEvictionCandidates(const int n_candidates, FastRandomContext& random_context)\n+{\n+    std::vector<NodeEvictionCandidate> candidates;\n+    for (int id = 0; id < n_candidates; ++id) {\n+        candidates.push_back({\n+            /* id */ id,\n+            /* nTimeConnected */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* m_min_ping_time */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* nLastBlockTime */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* nLastTXTime */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* fRelevantServices */ random_context.randbool(),\n+            /* fRelayTxes */ random_context.randbool(),\n+            /* fBloomFilter */ random_context.randbool(),\n+            /* nKeyedNetGroup */ random_context.randrange(100),\n+            /* prefer_evict */ random_context.randbool(),\n+            /* m_is_local */ random_context.randbool(),\n+            /* m_is_onion */ random_context.randbool(),\n+        });\n+    }\n+    return candidates;\n+}\n+\n+// Create `num_peers` random nodes, apply setup function `candidate_setup_fn`,\n+// apply protection logic, and then return true if all of `protected_peer_ids`\n+// and none of `unprotected_peer_ids` are protected from eviction, i.e. removed\n+// from the eviction candidates.\n+bool IsProtected(int num_peers,\n+                 std::function<void(NodeEvictionCandidate&)> candidate_setup_fn,\n+                 const std::vector<NodeId>& protected_peer_ids,\n+                 const std::vector<NodeId>& unprotected_peer_ids,\n+                 FastRandomContext& random_context)\n+{\n+    std::vector<NodeEvictionCandidate> candidates{GetRandomNodeEvictionCandidates(num_peers, random_context)};\n+    for (NodeEvictionCandidate& candidate : candidates) {\n+        candidate_setup_fn(candidate);\n+    }\n+    Shuffle(candidates.begin(), candidates.end(), random_context);\n+\n+    const size_t expected{candidates.size() / 2}; // expect half the candidates will be protected\n+    ProtectEvictionCandidates(candidates);\n+    const size_t actual{candidates.size()};\n+    BOOST_CHECK(actual == expected || actual == expected + 1);",
      "path": "src/test/net_peer_eviction_tests.cpp",
      "position": null,
      "original_position": 63,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "f1c02b3ef9fa4bbd82144eebbeaf8c9c9df238c5",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`ProtectEvictionCandidates()` will always remove `size() / 2` elements (no matter whether the size is odd or even), so the new size will always be `old_size - old_size / 2`.\r\n\r\n```suggestion\r\n    const size_t expected{candidates.size() - candidates.size() / 2}; // expect half the candidates will be protected\r\n    ProtectEvictionCandidates(candidates);\r\n    const size_t actual{candidates.size()};\r\n    BOOST_CHECK_EQUAL(actual, expected);\r\n```",
      "created_at": "2021-02-25T13:12:35Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r582820494",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/582820494"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": 60,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 63,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/582832154",
      "pull_request_review_id": 598527516,
      "id": 582832154,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjgzMjE1NA==",
      "diff_hunk": "@@ -889,39 +924,24 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n     // An attacker cannot manipulate this metric without performing useful work.\n     EraseLastKElements(vEvictionCandidates, CompareNodeTXTime, 4);\n     // Protect up to 8 non-tx-relay peers that have sent us novel blocks.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareNodeBlockRelayOnlyTime);\n-    size_t erase_size = std::min(size_t(8), vEvictionCandidates.size());\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return !n.fRelayTxes && n.fRelevantServices; }), vEvictionCandidates.end());\n+    const size_t erase_size = std::min(size_t(8), vEvictionCandidates.size());\n+    EraseLastKElements(vEvictionCandidates, CompareNodeBlockRelayOnlyTime, erase_size,\n+                       [](const NodeEvictionCandidate& n) { return !n.fRelayTxes && n.fRelevantServices; });\n \n     // Protect 4 nodes that most recently sent us novel blocks.\n     // An attacker cannot manipulate this metric without performing useful work.\n     EraseLastKElements(vEvictionCandidates, CompareNodeBlockTime, 4);\n \n-    // Protect the half of the remaining nodes which have been connected the longest.\n-    // This replicates the non-eviction implicit behavior, and precludes attacks that start later.\n-    // Reserve half of these protected spots for localhost peers, even if\n-    // they're not longest-uptime overall. This helps protect tor peers, which\n-    // tend to be otherwise disadvantaged under our eviction criteria.\n-    size_t initial_size = vEvictionCandidates.size();\n-    size_t total_protect_size = initial_size / 2;\n-\n-    // Pick out up to 1/4 peers that are localhost, sorted by longest uptime.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareLocalHostTimeConnected);\n-    size_t local_erase_size = total_protect_size / 2;\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_local; }), vEvictionCandidates.end());\n-    // Calculate how many we removed, and update our total number of peers that\n-    // we want to protect based on uptime accordingly.\n-    total_protect_size -= initial_size - vEvictionCandidates.size();\n-    EraseLastKElements(vEvictionCandidates, ReverseCompareNodeTimeConnected, total_protect_size);\n+    ProtectEvictionCandidates(vEvictionCandidates);\n \n     if (vEvictionCandidates.empty()) return nullopt;\n \n     // If any remaining peers are preferred for eviction consider only them.\n     // This happens after the other preferences since if a peer is really the best by other criteria (esp relaying blocks)\n     //  then we probably don't want to evict it no matter what.\n-    if (std::any_of(vEvictionCandidates.begin(),vEvictionCandidates.end(),[](NodeEvictionCandidate const &n){return n.prefer_evict;})) {\n-        vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.begin(),vEvictionCandidates.end(),\n-                                  [](NodeEvictionCandidate const &n){return !n.prefer_evict;}),vEvictionCandidates.end());\n+    if (std::any_of(vEvictionCandidates.begin(), vEvictionCandidates.end(), [](const NodeEvictionCandidate& n) { return n.prefer_evict; })) {\n+        EraseLastKElements(vEvictionCandidates, ReverseCompareNodeTimeConnected, vEvictionCandidates.size(),\n+                           [](const NodeEvictionCandidate& n) { return !n.prefer_evict; });",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 103,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "f1c02b3ef9fa4bbd82144eebbeaf8c9c9df238c5",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Note to other reviewers and maybe worth adding a comment: the sorting function is irrelevant here because we process the entire array (last `size()` elements).",
      "created_at": "2021-02-25T13:29:30Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r582832154",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/582832154"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": 943,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 944,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/584319129",
      "pull_request_review_id": 600274858,
      "id": 584319129,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NDMxOTEyOQ==",
      "diff_hunk": "@@ -0,0 +1,304 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <net.h>\n+#include <optional.h>\n+#include <test/util/setup_common.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <algorithm>\n+#include <functional>\n+#include <vector>\n+\n+BOOST_FIXTURE_TEST_SUITE(net_peer_eviction_tests, BasicTestingSetup)\n+\n+namespace {\n+constexpr int NODE_EVICTION_TEST_ROUNDS{10};\n+constexpr int NODE_EVICTION_TEST_UP_TO_N_NODES{200};\n+} // namespace\n+\n+std::vector<NodeEvictionCandidate> GetRandomNodeEvictionCandidates(const int n_candidates, FastRandomContext& random_context)\n+{\n+    std::vector<NodeEvictionCandidate> candidates;\n+    for (int id = 0; id < n_candidates; ++id) {\n+        candidates.push_back({\n+            /* id */ id,\n+            /* nTimeConnected */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* m_min_ping_time */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* nLastBlockTime */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* nLastTXTime */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* fRelevantServices */ random_context.randbool(),\n+            /* fRelayTxes */ random_context.randbool(),\n+            /* fBloomFilter */ random_context.randbool(),\n+            /* nKeyedNetGroup */ random_context.randrange(100),\n+            /* prefer_evict */ random_context.randbool(),\n+            /* m_is_local */ random_context.randbool(),\n+            /* m_is_onion */ random_context.randbool(),\n+        });\n+    }\n+    return candidates;\n+}\n+\n+// Create `num_peers` random nodes, apply setup function `candidate_setup_fn`,\n+// apply protection logic, and then return true if all of `protected_peer_ids`\n+// and none of `unprotected_peer_ids` are protected from eviction, i.e. removed\n+// from the eviction candidates.\n+bool IsProtected(int num_peers,\n+                 std::function<void(NodeEvictionCandidate&)> candidate_setup_fn,\n+                 const std::vector<NodeId>& protected_peer_ids,\n+                 const std::vector<NodeId>& unprotected_peer_ids,\n+                 FastRandomContext& random_context)\n+{\n+    std::vector<NodeEvictionCandidate> candidates{GetRandomNodeEvictionCandidates(num_peers, random_context)};\n+    for (NodeEvictionCandidate& candidate : candidates) {\n+        candidate_setup_fn(candidate);\n+    }\n+    Shuffle(candidates.begin(), candidates.end(), random_context);\n+\n+    const size_t expected{candidates.size() / 2}; // expect half the candidates will be protected\n+    ProtectEvictionCandidates(candidates);\n+    const size_t actual{candidates.size()};\n+    BOOST_CHECK(actual == expected || actual == expected + 1);",
      "path": "src/test/net_peer_eviction_tests.cpp",
      "position": null,
      "original_position": 63,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "f1c02b3ef9fa4bbd82144eebbeaf8c9c9df238c5",
      "in_reply_to_id": 582820494,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "That's better indeed. Done.",
      "created_at": "2021-02-28T16:06:22Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r584319129",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/584319129"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": 60,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 63,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/584319142",
      "pull_request_review_id": 600274869,
      "id": 584319142,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NDMxOTE0Mg==",
      "diff_hunk": "@@ -889,39 +924,24 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n     // An attacker cannot manipulate this metric without performing useful work.\n     EraseLastKElements(vEvictionCandidates, CompareNodeTXTime, 4);\n     // Protect up to 8 non-tx-relay peers that have sent us novel blocks.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareNodeBlockRelayOnlyTime);\n-    size_t erase_size = std::min(size_t(8), vEvictionCandidates.size());\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return !n.fRelayTxes && n.fRelevantServices; }), vEvictionCandidates.end());\n+    const size_t erase_size = std::min(size_t(8), vEvictionCandidates.size());\n+    EraseLastKElements(vEvictionCandidates, CompareNodeBlockRelayOnlyTime, erase_size,\n+                       [](const NodeEvictionCandidate& n) { return !n.fRelayTxes && n.fRelevantServices; });\n \n     // Protect 4 nodes that most recently sent us novel blocks.\n     // An attacker cannot manipulate this metric without performing useful work.\n     EraseLastKElements(vEvictionCandidates, CompareNodeBlockTime, 4);\n \n-    // Protect the half of the remaining nodes which have been connected the longest.\n-    // This replicates the non-eviction implicit behavior, and precludes attacks that start later.\n-    // Reserve half of these protected spots for localhost peers, even if\n-    // they're not longest-uptime overall. This helps protect tor peers, which\n-    // tend to be otherwise disadvantaged under our eviction criteria.\n-    size_t initial_size = vEvictionCandidates.size();\n-    size_t total_protect_size = initial_size / 2;\n-\n-    // Pick out up to 1/4 peers that are localhost, sorted by longest uptime.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareLocalHostTimeConnected);\n-    size_t local_erase_size = total_protect_size / 2;\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_local; }), vEvictionCandidates.end());\n-    // Calculate how many we removed, and update our total number of peers that\n-    // we want to protect based on uptime accordingly.\n-    total_protect_size -= initial_size - vEvictionCandidates.size();\n-    EraseLastKElements(vEvictionCandidates, ReverseCompareNodeTimeConnected, total_protect_size);\n+    ProtectEvictionCandidates(vEvictionCandidates);\n \n     if (vEvictionCandidates.empty()) return nullopt;\n \n     // If any remaining peers are preferred for eviction consider only them.\n     // This happens after the other preferences since if a peer is really the best by other criteria (esp relaying blocks)\n     //  then we probably don't want to evict it no matter what.\n-    if (std::any_of(vEvictionCandidates.begin(),vEvictionCandidates.end(),[](NodeEvictionCandidate const &n){return n.prefer_evict;})) {\n-        vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.begin(),vEvictionCandidates.end(),\n-                                  [](NodeEvictionCandidate const &n){return !n.prefer_evict;}),vEvictionCandidates.end());\n+    if (std::any_of(vEvictionCandidates.begin(), vEvictionCandidates.end(), [](const NodeEvictionCandidate& n) { return n.prefer_evict; })) {\n+        EraseLastKElements(vEvictionCandidates, ReverseCompareNodeTimeConnected, vEvictionCandidates.size(),\n+                           [](const NodeEvictionCandidate& n) { return !n.prefer_evict; });",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 103,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "f1c02b3ef9fa4bbd82144eebbeaf8c9c9df238c5",
      "in_reply_to_id": 582832154,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good idea. Decided for now to not touch this line instead. ",
      "created_at": "2021-02-28T16:06:29Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r584319142",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/584319142"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": 943,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 944,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/584319159",
      "pull_request_review_id": 600274890,
      "id": 584319159,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NDMxOTE1OQ==",
      "diff_hunk": "@@ -0,0 +1,304 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <net.h>\n+#include <optional.h>\n+#include <test/util/setup_common.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <algorithm>\n+#include <functional>\n+#include <vector>\n+\n+BOOST_FIXTURE_TEST_SUITE(net_peer_eviction_tests, BasicTestingSetup)\n+\n+namespace {\n+constexpr int NODE_EVICTION_TEST_ROUNDS{10};\n+constexpr int NODE_EVICTION_TEST_UP_TO_N_NODES{200};\n+} // namespace\n+\n+std::vector<NodeEvictionCandidate> GetRandomNodeEvictionCandidates(const int n_candidates, FastRandomContext& random_context)\n+{\n+    std::vector<NodeEvictionCandidate> candidates;\n+    for (int id = 0; id < n_candidates; ++id) {\n+        candidates.push_back({\n+            /* id */ id,\n+            /* nTimeConnected */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* m_min_ping_time */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* nLastBlockTime */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* nLastTXTime */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* fRelevantServices */ random_context.randbool(),\n+            /* fRelayTxes */ random_context.randbool(),\n+            /* fBloomFilter */ random_context.randbool(),\n+            /* nKeyedNetGroup */ random_context.randrange(100),\n+            /* prefer_evict */ random_context.randbool(),\n+            /* m_is_local */ random_context.randbool(),\n+            /* m_is_onion */ random_context.randbool(),\n+        });\n+    }\n+    return candidates;\n+}\n+\n+// Create `num_peers` random nodes, apply setup function `candidate_setup_fn`,\n+// apply protection logic, and then return true if all of `protected_peer_ids`\n+// and none of `unprotected_peer_ids` are protected from eviction, i.e. removed\n+// from the eviction candidates.\n+bool IsProtected(int num_peers,\n+                 std::function<void(NodeEvictionCandidate&)> candidate_setup_fn,\n+                 const std::vector<NodeId>& protected_peer_ids,\n+                 const std::vector<NodeId>& unprotected_peer_ids,\n+                 FastRandomContext& random_context)\n+{\n+    std::vector<NodeEvictionCandidate> candidates{GetRandomNodeEvictionCandidates(num_peers, random_context)};\n+    for (NodeEvictionCandidate& candidate : candidates) {\n+        candidate_setup_fn(candidate);\n+    }\n+    Shuffle(candidates.begin(), candidates.end(), random_context);\n+\n+    const size_t expected{candidates.size() / 2}; // expect half the candidates will be protected\n+    ProtectEvictionCandidates(candidates);\n+    const size_t actual{candidates.size()};\n+    BOOST_CHECK(actual == expected || actual == expected + 1);\n+\n+    size_t unprotected_as_expected{0};\n+    for (const NodeEvictionCandidate& candidate : candidates) {\n+        if (std::find(protected_peer_ids.begin(), protected_peer_ids.end(), candidate.id) != protected_peer_ids.end()) {\n+            // this peer should have been removed from the eviction candidates\n+            BOOST_TEST_MESSAGE(strprintf(\"candidate id: %d\", candidate.id));\n+            return false;\n+        }\n+        if (std::find(unprotected_peer_ids.begin(), unprotected_peer_ids.end(), candidate.id) != unprotected_peer_ids.end()) {\n+            // this peer remains in the eviction candidates, as expected\n+            ++unprotected_as_expected;\n+        }\n+    }\n+    return unprotected_as_expected == unprotected_peer_ids.size();\n+}\n+\n+BOOST_AUTO_TEST_CASE(peer_protection_test)\n+{\n+    FastRandomContext random_context{true};\n+    int num_peers{12};\n+\n+    // Expect half of the peers with greatest uptime (the lowest nTimeConnected)\n+    // to be protected from eviction.\n+    BOOST_CHECK(IsProtected(\n+        num_peers, [](NodeEvictionCandidate& c) {\n+            c.nTimeConnected = c.id;\n+            c.m_is_onion = c.m_is_local = false;\n+        },\n+        /* protected_peer_ids */ {0, 1, 2, 3, 4, 5},\n+        /* unprotected_peer_ids */ {6, 7, 8, 9, 10, 11},\n+        random_context));\n+\n+    // Verify in the opposite direction.\n+    BOOST_CHECK(IsProtected(\n+        num_peers, [num_peers](NodeEvictionCandidate& c) {\n+            c.nTimeConnected = num_peers - c.id;\n+            c.m_is_onion = c.m_is_local = false;\n+        },\n+        /* protected_peer_ids */ {6, 7, 8, 9, 10, 11},\n+        /* unprotected_peer_ids */ {0, 1, 2, 3, 4, 5},\n+        random_context));\n+\n+    // Test protection of onion and localhost peers...\n+\n+    // Expect 1/4 onion peers to be protected from eviction,\n+    // independently of other characteristics.\n+    BOOST_CHECK(IsProtected(\n+        num_peers, [](NodeEvictionCandidate& c) {\n+            c.m_is_onion = (c.id == 3 || c.id == 8 || c.id == 9) ? true : false;",
      "path": "src/test/net_peer_eviction_tests.cpp",
      "position": null,
      "original_position": 112,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "f1c02b3ef9fa4bbd82144eebbeaf8c9c9df238c5",
      "in_reply_to_id": 582813828,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done, thank you.",
      "created_at": "2021-02-28T16:06:40Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r584319159",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/584319159"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 112,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/584319181",
      "pull_request_review_id": 600274903,
      "id": 584319181,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NDMxOTE4MQ==",
      "diff_hunk": "@@ -0,0 +1,304 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <net.h>\n+#include <optional.h>\n+#include <test/util/setup_common.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+#include <algorithm>\n+#include <functional>\n+#include <vector>\n+\n+BOOST_FIXTURE_TEST_SUITE(net_peer_eviction_tests, BasicTestingSetup)\n+\n+namespace {\n+constexpr int NODE_EVICTION_TEST_ROUNDS{10};\n+constexpr int NODE_EVICTION_TEST_UP_TO_N_NODES{200};\n+} // namespace\n+\n+std::vector<NodeEvictionCandidate> GetRandomNodeEvictionCandidates(const int n_candidates, FastRandomContext& random_context)\n+{\n+    std::vector<NodeEvictionCandidate> candidates;\n+    for (int id = 0; id < n_candidates; ++id) {\n+        candidates.push_back({\n+            /* id */ id,\n+            /* nTimeConnected */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* m_min_ping_time */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* nLastBlockTime */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* nLastTXTime */ static_cast<int64_t>(random_context.randrange(100)),\n+            /* fRelevantServices */ random_context.randbool(),\n+            /* fRelayTxes */ random_context.randbool(),\n+            /* fBloomFilter */ random_context.randbool(),\n+            /* nKeyedNetGroup */ random_context.randrange(100),\n+            /* prefer_evict */ random_context.randbool(),\n+            /* m_is_local */ random_context.randbool(),\n+            /* m_is_onion */ random_context.randbool(),\n+        });\n+    }\n+    return candidates;\n+}\n+\n+// Create `num_peers` random nodes, apply setup function `candidate_setup_fn`,\n+// apply protection logic, and then return true if all of `protected_peer_ids`\n+// and none of `unprotected_peer_ids` are protected from eviction, i.e. removed\n+// from the eviction candidates.\n+bool IsProtected(int num_peers,\n+                 std::function<void(NodeEvictionCandidate&)> candidate_setup_fn,\n+                 const std::vector<NodeId>& protected_peer_ids,\n+                 const std::vector<NodeId>& unprotected_peer_ids,\n+                 FastRandomContext& random_context)\n+{\n+    std::vector<NodeEvictionCandidate> candidates{GetRandomNodeEvictionCandidates(num_peers, random_context)};\n+    for (NodeEvictionCandidate& candidate : candidates) {\n+        candidate_setup_fn(candidate);\n+    }\n+    Shuffle(candidates.begin(), candidates.end(), random_context);\n+\n+    const size_t expected{candidates.size() / 2}; // expect half the candidates will be protected\n+    ProtectEvictionCandidates(candidates);\n+    const size_t actual{candidates.size()};\n+    BOOST_CHECK(actual == expected || actual == expected + 1);\n+\n+    size_t unprotected_as_expected{0};\n+    for (const NodeEvictionCandidate& candidate : candidates) {\n+        if (std::find(protected_peer_ids.begin(), protected_peer_ids.end(), candidate.id) != protected_peer_ids.end()) {\n+            // this peer should have been removed from the eviction candidates\n+            BOOST_TEST_MESSAGE(strprintf(\"candidate id: %d\", candidate.id));\n+            return false;\n+        }\n+        if (std::find(unprotected_peer_ids.begin(), unprotected_peer_ids.end(), candidate.id) != unprotected_peer_ids.end()) {\n+            // this peer remains in the eviction candidates, as expected\n+            ++unprotected_as_expected;\n+        }\n+    }",
      "path": "src/test/net_peer_eviction_tests.cpp",
      "position": null,
      "original_position": 76,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "f1c02b3ef9fa4bbd82144eebbeaf8c9c9df238c5",
      "in_reply_to_id": 582806300,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nice, thank you! And no need for the `> 0`. Done for both `IsProtected` and `IsEvicted`.",
      "created_at": "2021-02-28T16:06:49Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r584319181",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/584319181"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": 66,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 77,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587607033",
      "pull_request_review_id": 604282355,
      "id": 587607033,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzYwNzAzMw==",
      "diff_hunk": "@@ -1287,8 +1288,11 @@ struct NodeEvictionCandidate\n     uint64_t nKeyedNetGroup;\n     bool prefer_evict;\n     bool m_is_local;\n+    bool m_is_onion;",
      "path": "src/net.h",
      "position": 12,
      "original_position": 12,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "ea9f19ee66ff66e1f5c384c19def994ec3037e13",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Maybe called it `m_is_onion_service` to dissociate from the manually configured hidden services you mentioned above?",
      "created_at": "2021-03-04T16:14:29Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r587607033",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/587607033"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1285,
      "original_line": 1285,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596070991",
      "pull_request_review_id": 614376281,
      "id": 596070991,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjA3MDk5MQ==",
      "diff_hunk": "@@ -1287,8 +1288,11 @@ struct NodeEvictionCandidate\n     uint64_t nKeyedNetGroup;\n     bool prefer_evict;\n     bool m_is_local;\n+    bool m_is_onion;",
      "path": "src/net.h",
      "position": 12,
      "original_position": 12,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "ea9f19ee66ff66e1f5c384c19def994ec3037e13",
      "in_reply_to_id": 587607033,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks @ariard. The latter ones would be `m_is_local`. I think I prefer to go with `m_is_onion` for `CNode::m_inbound_onion` and following the naming style of `m_is_local`.",
      "created_at": "2021-03-17T14:29:11Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r596070991",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596070991"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1285,
      "original_line": 1285,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597365954",
      "pull_request_review_id": 616015821,
      "id": 597365954,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzM2NTk1NA==",
      "diff_hunk": "@@ -879,6 +879,26 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n     elements.erase(elements.end() - eraseSize, elements.end());\n }\n \n+void ProtectEvictionCandidates(std::vector<NodeEvictionCandidate>& vEvictionCandidates)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "fd3cbfda2bd6d27d54aae18a657e3f15bd95748d",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"Extract ProtectEvictionCandidates() from SelectNodeToEvict()\"\r\n\r\nCan you add a comment explaining exactly which protection rules are implemented by this function, or give it a bit more specific name?\r\n\r\nIt seems it's just a subset of those currently in SelectNodeToEvict. If new eviction protections are added, how to decide if they should go into this function or into SelectNodeToEvict?",
      "created_at": "2021-03-19T02:29:15Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r597365954",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597365954"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 882,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597925590",
      "pull_request_review_id": 616729988,
      "id": 597925590,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzkyNTU5MA==",
      "diff_hunk": "@@ -879,6 +879,26 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n     elements.erase(elements.end() - eraseSize, elements.end());\n }\n \n+void ProtectEvictionCandidates(std::vector<NodeEvictionCandidate>& vEvictionCandidates)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "fd3cbfda2bd6d27d54aae18a657e3f15bd95748d",
      "in_reply_to_id": 597365954,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good idea. Done, renamed the function to `ProtectEvictionCandidatesByRatio()` (open to suggestions) and added Doxygen documentation.",
      "created_at": "2021-03-19T19:26:34Z",
      "updated_at": "2021-03-19T19:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r597925590",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597925590"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 882,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597929140",
      "pull_request_review_id": 616734349,
      "id": 597929140,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzkyOTE0MA==",
      "diff_hunk": "@@ -879,6 +879,26 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n     elements.erase(elements.end() - eraseSize, elements.end());\n }\n \n+void ProtectEvictionCandidates(std::vector<NodeEvictionCandidate>& vEvictionCandidates)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "fd3cbfda2bd6d27d54aae18a657e3f15bd95748d",
      "in_reply_to_id": 597365954,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Also updated the commit names/descriptions.",
      "created_at": "2021-03-19T19:33:13Z",
      "updated_at": "2021-03-19T19:33:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r597929140",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597929140"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 882,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604233445",
      "pull_request_review_id": 624445128,
      "id": 604233445,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDIzMzQ0NQ==",
      "diff_hunk": "@@ -893,30 +937,17 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n     // An attacker cannot manipulate this metric without performing useful work.\n     EraseLastKElements(vEvictionCandidates, CompareNodeTXTime, 4);\n     // Protect up to 8 non-tx-relay peers that have sent us novel blocks.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareNodeBlockRelayOnlyTime);\n-    size_t erase_size = std::min(size_t(8), vEvictionCandidates.size());\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return !n.fRelayTxes && n.fRelevantServices; }), vEvictionCandidates.end());\n+    const size_t erase_size = std::min(size_t(8), vEvictionCandidates.size());",
      "path": "src/net.cpp",
      "position": 76,
      "original_position": 76,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Since `EraseLastKElements` determines the minimum again, this line seems unnecessary (could just pass `size_t(8)`).",
      "created_at": "2021-03-30T16:03:53Z",
      "updated_at": "2021-03-30T16:10:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r604233445",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604233445"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 940,
      "original_line": 940,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604336054",
      "pull_request_review_id": 624578706,
      "id": 604336054,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwNDMzNjA1NA==",
      "diff_hunk": "@@ -893,30 +937,17 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n     // An attacker cannot manipulate this metric without performing useful work.\n     EraseLastKElements(vEvictionCandidates, CompareNodeTXTime, 4);\n     // Protect up to 8 non-tx-relay peers that have sent us novel blocks.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareNodeBlockRelayOnlyTime);\n-    size_t erase_size = std::min(size_t(8), vEvictionCandidates.size());\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return !n.fRelayTxes && n.fRelevantServices; }), vEvictionCandidates.end());\n+    const size_t erase_size = std::min(size_t(8), vEvictionCandidates.size());",
      "path": "src/net.cpp",
      "position": 76,
      "original_position": 76,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "in_reply_to_id": 604233445,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good eye! Will update in #21261.",
      "created_at": "2021-03-30T18:27:25Z",
      "updated_at": "2021-04-01T18:12:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r604336054",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/604336054"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 940,
      "original_line": 940,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616746732",
      "pull_request_review_id": 640036120,
      "id": 616746732,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjc0NjczMg==",
      "diff_hunk": "@@ -893,30 +937,17 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n     // An attacker cannot manipulate this metric without performing useful work.\n     EraseLastKElements(vEvictionCandidates, CompareNodeTXTime, 4);\n     // Protect up to 8 non-tx-relay peers that have sent us novel blocks.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareNodeBlockRelayOnlyTime);\n-    size_t erase_size = std::min(size_t(8), vEvictionCandidates.size());\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return !n.fRelayTxes && n.fRelevantServices; }), vEvictionCandidates.end());\n+    const size_t erase_size = std::min(size_t(8), vEvictionCandidates.size());",
      "path": "src/net.cpp",
      "position": 76,
      "original_position": 76,
      "commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "original_commit_id": "0cca08a8ee33b4e05ff586ae4fd914f5ea860cea",
      "in_reply_to_id": 604233445,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks again @mzumsande. Addressed in #21261.",
      "created_at": "2021-04-20T14:37:17Z",
      "updated_at": "2021-04-20T14:37:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r616746732",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616746732"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 940,
      "original_line": 940,
      "side": "RIGHT"
    }
  ]
}