{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307",
    "id": 1693829885,
    "node_id": "PR_kwDOABII585k9cr9",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/29307",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/29307.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/29307.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/9057ab8b80137a89df68a3ed4bc49f9926e0f634",
    "number": 29307,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "util: explicitly close all AutoFiles that have been written",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "`fclose(3)` may fail to flush the previously written data to disk, thus a failing `fclose(3)` is as serious as a failing `fwrite(3)`.\r\n\r\nPreviously the code ignored `fclose(3)` failures. This PR improves that by changing all users of `AutoFile` that use it to write data to explicitly close the file and handle a possible error.\r\n\r\n---\r\n\r\nOther alternatives are:\r\n\r\n1. `fflush(3)` after each write to the file (and throw if it fails from the `AutoFile::write()` method) and hope that `fclose(3)` will then always succeed. Assert that it succeeds from the destructor :roll_eyes:. Will hurt performance.\r\n2. Throw nevertheless from the destructor. Exception within the exception in C++ I think results in terminating the program without a useful message.\r\n3. (this is implemented in the latest incarnation of this PR) Redesign `AutoFile` so that its destructor cannot fail. Adjust _all_ its users :sob:. For example, if the file has been written to, then require the callers to explicitly call the `AutoFile::fclose()` method before the object goes out of scope. In the destructor, as a sanity check, assume/assert that this is indeed the case. Defeats the purpose of a RAII wrapper for `FILE*` which automatically closes the file when it goes out of scope and there are a lot of users of `AutoFile`.",
    "labels": [
      {
        "id": 241832923,
        "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
        "name": "Utils/log/libs",
        "description": "",
        "color": "5319e7",
        "default": false
      }
    ],
    "created_at": "2024-01-24T14:35:29Z",
    "updated_at": "2025-05-05T14:38:00Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "df3a096d3c373b57920890698c33712a9ac134b7",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "vasild:AutoFile_error_check",
      "ref": "AutoFile_error_check",
      "sha": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 120608826,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMjA2MDg4MjY=",
        "name": "bitcoin",
        "full_name": "vasild/bitcoin",
        "owner": {
          "login": "vasild",
          "id": 266751,
          "node_id": "MDQ6VXNlcjI2Njc1MQ==",
          "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/vasild",
          "html_url": "https://github.com/vasild",
          "followers_url": "https://api.github.com/users/vasild/followers",
          "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
          "organizations_url": "https://api.github.com/users/vasild/orgs",
          "repos_url": "https://api.github.com/users/vasild/repos",
          "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/vasild/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/vasild/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/vasild/bitcoin",
        "archive_url": "https://api.github.com/repos/vasild/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/vasild/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/vasild/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/vasild/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/vasild/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/vasild/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/vasild/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/vasild/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/vasild/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/vasild/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/vasild/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/vasild/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/vasild/bitcoin/events",
        "forks_url": "https://api.github.com/repos/vasild/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/vasild/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/vasild/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/vasild/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/vasild/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/vasild/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/vasild/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/vasild/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/vasild/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/vasild/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/vasild/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/vasild/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/vasild/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/vasild/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/vasild/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/vasild/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:vasild/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/vasild/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/vasild/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/vasild/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/vasild/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/vasild/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/vasild/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/vasild/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/vasild/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/vasild/bitcoin/hooks",
        "svn_url": "https://github.com/vasild/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 6,
        "watchers_count": 6,
        "size": 256251,
        "default_branch": "master",
        "open_issues_count": 2,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-05-05T14:36:52Z",
        "created_at": "2018-02-07T11:52:47Z",
        "updated_at": "2025-05-02T05:38:49Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "baa848b8d38187ce6b24a57cfadf1ea180209711",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 37175,
        "stargazers_count": 83382,
        "watchers_count": 83382,
        "size": 280748,
        "default_branch": "master",
        "open_issues_count": 722,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-05-05T14:19:39Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-05-05T14:47:41Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 151,
    "deletions": 41,
    "changed_files": 18,
    "commits": 2,
    "review_comments": 66,
    "comments": 43
  },
  "events": [
    {
      "event": "commented",
      "id": 1908256759,
      "node_id": "IC_kwDOABII585xva_3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1908256759",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-24T14:35:33Z",
      "updated_at": "2025-05-05T14:37:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/29307.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [ryanofsky](https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2243842400), [hodlinator](https://github.com/bitcoin/bitcoin/pull/29307#pullrequestreview-2288411339) |\n| Stale ACK | [maflcko](https://github.com/bitcoin/bitcoin/pull/29307#pullrequestreview-2130240983), [l0rinc](https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2851026294) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32043](https://github.com/bitcoin/bitcoin/pull/32043) ([IBD] Tracking PR for speeding up Initial Block Download by l0rinc)\n* [#31144](https://github.com/bitcoin/bitcoin/pull/31144) ([IBD] multi-byte block obfuscation by l0rinc)\n* [#29641](https://github.com/bitcoin/bitcoin/pull/29641) (scripted-diff: Use LogInfo over LogPrintf [WIP, NOMERGE, DRAFT] by maflcko)\n* [#28792](https://github.com/bitcoin/bitcoin/pull/28792) (Embed default ASMap as binary dump header file by fjahr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-1908256759",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "labeled",
      "id": 11585263523,
      "node_id": "LE_lADOABII5859EymxzwAAAAKyiRej",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11585263523",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-24T14:35:35Z",
      "label": {
        "name": "Utils/log/libs",
        "color": "5319e7"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11585573069,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAKyjdDN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11585573069",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "7c58f6ea4f603b570b7d8532aa9bb59df069d6cb",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/7c58f6ea4f603b570b7d8532aa9bb59df069d6cb",
      "created_at": "2024-01-24T14:58:17Z"
    },
    {
      "event": "labeled",
      "id": 11585575480,
      "node_id": "LE_lADOABII5859EymxzwAAAAKyjdo4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11585575480",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-24T14:58:27Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1908303442,
      "node_id": "IC_kwDOABII585xvmZS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1908303442",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-24T14:58:28Z",
      "updated_at": "2024-01-24T14:58:28Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\nðŸš§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/20819752683</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-1908303442",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "reviewed",
      "id": 1841755517,
      "node_id": "PRR_kwDOABII585txvV9",
      "url": null,
      "actor": null,
      "commit_id": "7c58f6ea4f603b570b7d8532aa9bb59df069d6cb",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#pullrequestreview-1841755517",
      "submitted_at": "2024-01-24T15:59:58Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
    },
    {
      "event": "reviewed",
      "id": 1841963492,
      "node_id": "PRR_kwDOABII585tyiHk",
      "url": null,
      "actor": null,
      "commit_id": "7c58f6ea4f603b570b7d8532aa9bb59df069d6cb",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#pullrequestreview-1841963492",
      "submitted_at": "2024-01-24T17:18:04Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11594047763,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAKzDyET",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11594047763",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "55439903212dcee6af09da7393a41e3754501b37",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/55439903212dcee6af09da7393a41e3754501b37",
      "created_at": "2024-01-25T08:30:12Z"
    },
    {
      "event": "unlabeled",
      "id": 11594660018,
      "node_id": "UNLE_lADOABII5859EymxzwAAAAKzGHiy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11594660018",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-25T09:25:08Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1914506129,
      "node_id": "IC_kwDOABII585yHQuR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1914506129",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-29T11:32:54Z",
      "updated_at": "2024-01-29T11:32:54Z",
      "author_association": "MEMBER",
      "body": "I don't think any care close-check needs to be done when reading from a file.\r\n\r\nSo what about removing the `write` method from `AutoFile`, and introduce a new derived class to add it back. This class could `Assume` that the file was flushed/closed before the destructor is called?",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-1914506129",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "commented",
      "id": 1925699470,
      "node_id": "IC_kwDOABII585yx9eO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1925699470",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-04T10:48:36Z",
      "updated_at": "2024-02-04T10:48:36Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I don't think any care close-check needs to be done when reading from a file.\r\n\r\nThat is my understanding too.\r\n \r\n> So what about removing the `write` method from `AutoFile`, and introduce a new derived class to add it back. This class could `Assume` that the file was flushed/closed before the destructor is called?\r\n\r\n`Assume` is more for code correctness, not for external errors (like IO error). If it does not fail during testing and on CI, that does not mean IO errors are absent and will not occur on the users' machines. Given that `Assume()` is removed from production builds, it still means that file corruption could remain unnoticed on live environments, like now on `master`.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-1925699470",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "commented",
      "id": 1926582804,
      "node_id": "IC_kwDOABII585y1VIU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1926582804",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-05T09:45:05Z",
      "updated_at": "2024-02-05T09:45:05Z",
      "author_association": "MEMBER",
      "body": "> > This class could `Assume` that the file was flushed/closed before the destructor is called?\r\n> \r\n> `Assume` is more for code correctness, not for external errors (like IO error).\r\n\r\nThe assumption would be that the close was called *before* the destructor is called. This is a code correctness question and seems like the perfect fit for Assume. That is, if the Assume fails, the code was missing a close, and the code must be changed to fix the internal bug. The Assume does not in any way check for IO errors.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-1926582804",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "commented",
      "id": 1927234971,
      "node_id": "IC_kwDOABII585y30Wb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1927234971",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-05T15:17:17Z",
      "updated_at": "2024-02-05T15:17:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "Then I misunderstood this:\r\n\r\n> This class could Assume that the file was flushed/closed before the destructor is called\r\n\r\nHow?\r\n\r\n",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-1927234971",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "commented",
      "id": 1927271889,
      "node_id": "IC_kwDOABII585y39XR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1927271889",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-05T15:34:33Z",
      "updated_at": "2024-02-05T15:34:33Z",
      "author_association": "MEMBER",
      "body": "AutoFile holds a file, which will be nullptr when it is closed. So if the file is nullptr, then it can be assumed to be flushed.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-1927271889",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "commented",
      "id": 1927420896,
      "node_id": "IC_kwDOABII585y4hvg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1927420896",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-05T16:40:43Z",
      "updated_at": "2024-02-05T16:40:43Z",
      "author_association": "CONTRIBUTOR",
      "body": "How/when would the file be closed?",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-1927420896",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "commented",
      "id": 1928966222,
      "node_id": "IC_kwDOABII585y-bBO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1928966222",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-06T08:00:33Z",
      "updated_at": "2024-02-06T08:00:33Z",
      "author_association": "MEMBER",
      "body": "> How/when would the file be closed?\r\n\r\nAn `AutoFile` can be closed by calling the `fclose()` method in the code.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-1928966222",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "commented",
      "id": 1929136430,
      "node_id": "IC_kwDOABII585y_Eku",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1929136430",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-06T09:45:13Z",
      "updated_at": "2024-02-06T09:45:13Z",
      "author_association": "CONTRIBUTOR",
      "body": "Ok, the users of the class then have to explicitly close. That is 1.4. from the OP, I elaborated it with more words.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-1929136430",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "commented",
      "id": 1991964579,
      "node_id": "IC_kwDOABII5852uvej",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1991964579",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-12T15:42:43Z",
      "updated_at": "2024-03-12T15:42:43Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\nðŸš§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/20850328376</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-1991964579",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "labeled",
      "id": 12091386992,
      "node_id": "LE_lADOABII5859EymxzwAAAALQs-xw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12091386992",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-12T15:42:43Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "referenced",
      "id": 12282222792,
      "node_id": "REFE_lADOABII5859EymxzwAAAALcE9jI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12282222792",
      "actor": {
        "login": "Retropex",
        "id": 74937347,
        "node_id": "MDQ6VXNlcjc0OTM3MzQ3",
        "avatar_url": "https://avatars.githubusercontent.com/u/74937347?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Retropex",
        "html_url": "https://github.com/Retropex",
        "followers_url": "https://api.github.com/users/Retropex/followers",
        "following_url": "https://api.github.com/users/Retropex/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Retropex/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Retropex/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Retropex/subscriptions",
        "organizations_url": "https://api.github.com/users/Retropex/orgs",
        "repos_url": "https://api.github.com/users/Retropex/repos",
        "events_url": "https://api.github.com/users/Retropex/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Retropex/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "f54c172ffe5432c1ff0a1e3becc65f5064eadc9b",
      "commit_url": "https://api.github.com/repos/Retropex/bitcoin/commits/f54c172ffe5432c1ff0a1e3becc65f5064eadc9b",
      "created_at": "2024-03-28T14:04:07Z"
    },
    {
      "event": "referenced",
      "id": 12282222812,
      "node_id": "REFE_lADOABII5859EymxzwAAAALcE9jc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12282222812",
      "actor": {
        "login": "Retropex",
        "id": 74937347,
        "node_id": "MDQ6VXNlcjc0OTM3MzQ3",
        "avatar_url": "https://avatars.githubusercontent.com/u/74937347?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Retropex",
        "html_url": "https://github.com/Retropex",
        "followers_url": "https://api.github.com/users/Retropex/followers",
        "following_url": "https://api.github.com/users/Retropex/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Retropex/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Retropex/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Retropex/subscriptions",
        "organizations_url": "https://api.github.com/users/Retropex/orgs",
        "repos_url": "https://api.github.com/users/Retropex/repos",
        "events_url": "https://api.github.com/users/Retropex/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Retropex/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "70403c5bb70df65f783eaf44792377887ee9e8d8",
      "commit_url": "https://api.github.com/repos/Retropex/bitcoin/commits/70403c5bb70df65f783eaf44792377887ee9e8d8",
      "created_at": "2024-03-28T14:04:07Z"
    },
    {
      "event": "commented",
      "id": 2045516340,
      "node_id": "IC_kwDOABII58557Bo0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2045516340",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-09T15:43:01Z",
      "updated_at": "2024-04-09T15:43:01Z",
      "author_association": "MEMBER",
      "body": "Seems like there is some discussion in the description that is a better fit for a brainstorming issue.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2045516340",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "convert_to_draft",
      "id": 12570200361,
      "node_id": "CTDE_lADOABII5859EymxzwAAAALtPgkp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12570200361",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-23T06:50:10Z"
    },
    {
      "event": "commented",
      "id": 2071544356,
      "node_id": "IC_kwDOABII5857eUIk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2071544356",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-23T06:50:32Z",
      "updated_at": "2024-04-23T06:50:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "Converted to draft due to failing CI and inactivity",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2071544356",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12768104467,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAL5CdAT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12768104467",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "1fa61d9edc45e80d202bbfb17b3b516a42ddd9c5",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/1fa61d9edc45e80d202bbfb17b3b516a42ddd9c5",
      "created_at": "2024-05-10T10:27:46Z"
    },
    {
      "event": "commented",
      "id": 2104363831,
      "node_id": "IC_kwDOABII5859bgs3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2104363831",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-10T10:28:50Z",
      "updated_at": "2024-05-10T10:36:00Z",
      "author_association": "CONTRIBUTOR",
      "body": "`5543990321...1fa61d9edc`: rebase and log a message from `~AutoFile()` if closing fails and terminate the program.\r\n\r\nReady for review. I think this would be a strict improvement over what we have now in `master` - a silent ignoring of a possible file corruption.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2104363831",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "ready_for_review",
      "id": 12768116462,
      "node_id": "RFRE_lADOABII5859EymxzwAAAAL5Cf7u",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12768116462",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-10T10:28:59Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12768383928,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAL5DhO4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12768383928",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "b44c33ac93b54b91b0acbe7034028433af36e43b",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/b44c33ac93b54b91b0acbe7034028433af36e43b",
      "created_at": "2024-05-10T10:58:05Z"
    },
    {
      "event": "commented",
      "id": 2104945955,
      "node_id": "IC_kwDOABII5859du0j",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2104945955",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-10T16:59:06Z",
      "updated_at": "2024-05-10T16:59:06Z",
      "author_association": "MEMBER",
      "body": "@vasild CI seems unhappy.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2104945955",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "mentioned",
      "id": 12772040055,
      "node_id": "MEE_lADOABII5859EymxzwAAAAL5Rd13",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12772040055",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-10T16:59:07Z"
    },
    {
      "event": "subscribed",
      "id": 12772040067,
      "node_id": "SE_lADOABII5859EymxzwAAAAL5Rd2D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12772040067",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-10T16:59:07Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12786496057,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAL6InI5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12786496057",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "13f540d60b5015b57a7edbea02473dab08e10f9f",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/13f540d60b5015b57a7edbea02473dab08e10f9f",
      "created_at": "2024-05-13T12:24:29Z"
    },
    {
      "event": "convert_to_draft",
      "id": 12786510251,
      "node_id": "CTDE_lADOABII5859EymxzwAAAAL6Iqmr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12786510251",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-13T12:25:32Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12790065338,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAL6WOi6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12790065338",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "661b7d84b542b3d76072fae4bd2782a104e4927b",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/661b7d84b542b3d76072fae4bd2782a104e4927b",
      "created_at": "2024-05-13T16:27:32Z"
    },
    {
      "event": "unlabeled",
      "id": 12793695665,
      "node_id": "UNLE_lADOABII5859EymxzwAAAAL6kE2x",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12793695665",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-13T22:42:51Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "ready_for_review",
      "id": 12799315193,
      "node_id": "RFRE_lADOABII5859EymxzwAAAAL65gz5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12799315193",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-14T09:50:59Z"
    },
    {
      "event": "commented",
      "id": 2109769504,
      "node_id": "IC_kwDOABII5859wIcg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2109769504",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-14T09:51:45Z",
      "updated_at": "2024-05-14T09:51:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "Fixed the CI!",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2109769504",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "reviewed",
      "id": 2055001995,
      "node_id": "PRR_kwDOABII5856fNeL",
      "url": null,
      "actor": null,
      "commit_id": "de23848eed5437f5e4dc6ccdc38b40cc58738ead",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#pullrequestreview-2055001995",
      "submitted_at": "2024-05-14T10:57:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12801416053,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAL7Bht1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12801416053",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "de23848eed5437f5e4dc6ccdc38b40cc58738ead",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/de23848eed5437f5e4dc6ccdc38b40cc58738ead",
      "created_at": "2024-05-14T12:32:30Z"
    },
    {
      "event": "reviewed",
      "id": 2057928541,
      "node_id": "PRR_kwDOABII5856qX9d",
      "url": null,
      "actor": null,
      "commit_id": "f9cf6b516b796461feb059729d2ab3737ad01ccc",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#pullrequestreview-2057928541",
      "submitted_at": "2024-05-15T12:54:07Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
    },
    {
      "event": "labeled",
      "id": 12912610837,
      "node_id": "LE_lADOABII5859EymxzwAAAAMBps4V",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12912610837",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-23T16:47:29Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2074608095,
      "node_id": "PRR_kwDOABII5857qAHf",
      "url": null,
      "actor": null,
      "commit_id": "de23848eed5437f5e4dc6ccdc38b40cc58738ead",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#pullrequestreview-2074608095",
      "submitted_at": "2024-05-23T17:22:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
    },
    {
      "event": "referenced",
      "id": 13150850293,
      "node_id": "REFE_lADOABII5859EymxzwAAAAMP2gz1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13150850293",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "ec8ef5e51c47b193997c07ea5ffba24aa95e16ae",
      "commit_url": "https://api.github.com/repos/bitcoinknots/bitcoin/commits/ec8ef5e51c47b193997c07ea5ffba24aa95e16ae",
      "created_at": "2024-06-13T17:53:00Z"
    },
    {
      "event": "referenced",
      "id": 13150850300,
      "node_id": "REFE_lADOABII5859EymxzwAAAAMP2gz8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13150850300",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "17f1f249931a00ad83c0c3766bd1f7de42db3f82",
      "commit_url": "https://api.github.com/repos/bitcoinknots/bitcoin/commits/17f1f249931a00ad83c0c3766bd1f7de42db3f82",
      "created_at": "2024-06-13T17:53:00Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13226641646,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAMUXoju",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13226641646",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "11be9f4103ea219f801a1f0fe1385f66ca70ad22",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/11be9f4103ea219f801a1f0fe1385f66ca70ad22",
      "created_at": "2024-06-20T09:59:40Z"
    },
    {
      "event": "renamed",
      "id": 13226823012,
      "node_id": "RTE_lADOABII5859EymxzwAAAAMUYU1k",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13226823012",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-20T10:14:12Z",
      "rename": {
        "from": "util: check for errors after close and read in AutoFile",
        "to": "util: explicitly close all AutoFiles that have been written"
      }
    },
    {
      "event": "unlabeled",
      "id": 13227945628,
      "node_id": "UNLE_lADOABII5859EymxzwAAAAMUcm6c",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13227945628",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-20T11:52:17Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2130240983,
      "node_id": "PRR_kwDOABII585--OXX",
      "url": null,
      "actor": null,
      "commit_id": "11be9f4103ea219f801a1f0fe1385f66ca70ad22",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "lgtm ACK 11be9f4103ea219f801a1f0fe1385f66ca70ad22\r\n\r\nWill do some testing later",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#pullrequestreview-2130240983",
      "submitted_at": "2024-06-20T12:04:46Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
    },
    {
      "event": "referenced",
      "id": 13248816784,
      "node_id": "REFE_lADOABII5859EymxzwAAAAMVsOaQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13248816784",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "d2ea6ab60b58f14aa4e988b22ff8dfbaac61bf08",
      "commit_url": "https://api.github.com/repos/bitcoinknots/bitcoin/commits/d2ea6ab60b58f14aa4e988b22ff8dfbaac61bf08",
      "created_at": "2024-06-22T03:42:40Z"
    },
    {
      "event": "labeled",
      "id": 13364334901,
      "node_id": "LE_lADOABII5859EymxzwAAAAMck5E1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13364334901",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-02T11:18:41Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13365439945,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAMcpG3J",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13365439945",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "ea89a6e368799fb268a9c7039baaa48c4cbb3f17",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/ea89a6e368799fb268a9c7039baaa48c4cbb3f17",
      "created_at": "2024-07-02T12:40:12Z"
    },
    {
      "event": "commented",
      "id": 2203060643,
      "node_id": "IC_kwDOABII586DUAmj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2203060643",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-02T12:41:00Z",
      "updated_at": "2024-07-02T12:41:00Z",
      "author_association": "CONTRIBUTOR",
      "body": "`11be9f4103...ea89a6e368`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2203060643",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "unlabeled",
      "id": 13366102110,
      "node_id": "UNLE_lADOABII5859EymxzwAAAAMcrohe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13366102110",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-02T13:22:55Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 13447364520,
      "node_id": "LE_lADOABII5859EymxzwAAAAMhhn-o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13447364520",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-09T22:22:24Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13599171810,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAMqkuTi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13599171810",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "4533445fd7ddc9cbdbd582f19088c940257dbe80",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/4533445fd7ddc9cbdbd582f19088c940257dbe80",
      "created_at": "2024-07-22T10:33:11Z"
    },
    {
      "event": "commented",
      "id": 2242633991,
      "node_id": "IC_kwDOABII586Fq-EH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2242633991",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-22T10:33:33Z",
      "updated_at": "2024-07-22T10:33:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "`ea89a6e368...4533445fd7`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2242633991",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "labeled",
      "id": 13600344593,
      "node_id": "LE_lADOABII5859EymxzwAAAAMqpMoR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13600344593",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-22T12:13:06Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2242808177,
      "node_id": "IC_kwDOABII586Frolx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2242808177",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-22T12:13:07Z",
      "updated_at": "2024-07-22T12:13:07Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/27742621741</sub>\n\n<details><summary>Hints</summary>\n\nMake sure to run all tests locally, according to the documentation.\n\nThe failure may happen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2242808177",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "unlabeled",
      "id": 13600760662,
      "node_id": "UNLE_lADOABII5859EymxzwAAAAMqqyNW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13600760662",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-22T12:45:35Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2242894082,
      "node_id": "IC_kwDOABII586Fr9kC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2242894082",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-22T12:56:30Z",
      "updated_at": "2024-07-22T12:56:30Z",
      "author_association": "CONTRIBUTOR",
      "body": "CI failure seems unrelated.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2242894082",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "unlabeled",
      "id": 13601957039,
      "node_id": "UNLE_lADOABII5859EymxzwAAAAMqvWSv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13601957039",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-22T14:07:41Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2243842400,
      "node_id": "IC_kwDOABII586FvlFg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2243842400",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-22T21:26:00Z",
      "updated_at": "2024-07-22T21:29:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK, approach ~0\r\n\r\nThe PR description is a bit vague about how it is changing the AutoFile API.\r\n\r\nPreviously, the autofile API *allowed* but did not *require* AutoFile callers to check for failing `fclose` calls after writing. Now it requires that callers call the `fclose` method manually and explicitly use or discard its return value.\r\n\r\nChecking for failing `fclose` calls is important because if a call fails, it probably indicates that there is a serious problem that should trigger a log message or an alert. Specifically if the file was used for writing it could mean that data could not successfully be saved to disk. So it would be bad for `fclose` errors to be discarded without being handled at all or reported somewhere.\r\n\r\nThe PR makes AutoFile require callers to handle failing fclose calls, and it enforces this in two ways:\r\n\r\n1. It adds `[[nodiscard]]` annotation to the `fclose` method so its return value cannot be ignored. The return value is 0 if successful or `EOF` (-1) if unsuccessful.\r\n2. It tries to enforce that callers actually invoke `fclose` by adding an `Assume` statement to the destructor that terminates the program with a fatal error if the file was written to and fclose was not called and the binary was built in a debug mode.\r\n\r\nIt seems like this approach works, but it is maybe a little fragile because it doesn't actually enforce that caller handles the fclose result in every code path. So for example if an early return statement is added after a caller opens an autofile object but before it calls the fclose method, and the early return code path is not normally executed, it can introduce a latent bug that occasionally will crash debug builds, while providing no indication that anything is wrong in release builds.\r\n\r\nI think if the goal is to require AutoFile callers to handle failing fclose calls, a more reliable way to do that would be to change the constructor signature to\r\n\r\n```c++\r\nexplicit AutoFile(std::FILE* file, std::function<void()> on_error);\r\n```\r\n\r\nAnd require the caller to provide an on_error callback that does error handing like\r\n\r\n```c++\r\n[&] {\r\n        remove(pathTmp);\r\n        LogError(\"%s: Failed to close file %s: %s\\n\", __func__, fs::PathToString(pathTmp), SysErrorString(errno));\r\n}\r\n```\r\n\r\nI think the current approach is ok too, but it seems more fragile because it doesn't detect all programming errors, and when it does it detects them with a runtime crash instead of a compile time error.\r\n\r\nI am coming to this late, so if you are really attached to the current approach I can just review and ack it, but I wanted to suggest an alternative.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2243842400",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "commented",
      "id": 2245216013,
      "node_id": "IC_kwDOABII586F00cN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2245216013",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-23T13:13:11Z",
      "updated_at": "2024-07-23T13:13:11Z",
      "author_association": "CONTRIBUTOR",
      "body": "@ryanofsky, I am not so attached to the current approach :) if it can be improved, then lets improve it.\r\n\r\nFor the `on_error` callback - that would be called on fclose() error from destructor only, right? Not on any error? E.g. the `write()` method throws an exception on error.\r\n\r\nNot all callers have the file name when creating `AutoFile` which means we would have to log some generic message without a file name. Or go an extra mile and make sure we have the file name, but some callers don't use _files_ at all, IIRC the fuzzer uses some cookie \"files\" that are not on the filesystem.\r\n\r\nThen the callback can be omitted and the message can be logged from the destructor:\r\n\r\n```diff\r\n     ~AutoFile()\r\n     {   \r\n         if (m_was_written) {\r\n             // Callers that wrote to the file must have closed it explicitly\r\n             // with the fclose() method and checked that the close succeeded.\r\n             // This is because here from the destructor we have no way to signal\r\n             // error due to close which, after write, could mean the file is\r\n             // corrupted and must be handled properly at the call site.\r\n             Assume(IsNull());\r\n         }\r\n                        \r\n-        (void)fclose();\r\n+        if (fclose() != 0) {\r\n+            LogError(\"Failed to close file: %s\\n\", SysErrorString(errno));\r\n+        }\r\n     }\r\n```",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2245216013",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "mentioned",
      "id": 13615684359,
      "node_id": "MEE_lADOABII5859EymxzwAAAAMrjtsH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13615684359",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-23T13:13:13Z"
    },
    {
      "event": "subscribed",
      "id": 13615684386,
      "node_id": "SE_lADOABII5859EymxzwAAAAMrjtsi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13615684386",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-23T13:13:13Z"
    },
    {
      "event": "labeled",
      "id": 13787636985,
      "node_id": "LE_lADOABII5859EymxzwAAAAM1zqT5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13787636985",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-07T06:57:24Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 13954095867,
      "node_id": "LE_lADOABII5859EymxzwAAAAM_upr7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13954095867",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-21T04:35:55Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13974128706,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAANA7EhC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13974128706",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "1dcd626fe133d8bdc682d5bd4fce6bfe5856dcf4",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/1dcd626fe133d8bdc682d5bd4fce6bfe5856dcf4",
      "created_at": "2024-08-22T09:27:45Z"
    },
    {
      "event": "commented",
      "id": 2304200104,
      "node_id": "IC_kwDOABII586JV02o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2304200104",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-22T09:27:57Z",
      "updated_at": "2024-08-22T09:27:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "`4533445fd7...1dcd626fe1`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2304200104",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "unlabeled",
      "id": 13974415840,
      "node_id": "UNLE_lADOABII5859EymxzwAAAANA8Kng",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13974415840",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-22T09:48:22Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13990621587,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAANB5_GT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13990621587",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "587d996f07ea02a6886a325d70094c427320070d",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/587d996f07ea02a6886a325d70094c427320070d",
      "created_at": "2024-08-23T09:24:01Z"
    },
    {
      "event": "commented",
      "id": 2306678413,
      "node_id": "IC_kwDOABII586JfR6N",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2306678413",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-23T09:25:18Z",
      "updated_at": "2024-08-23T09:25:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "`1dcd626fe1...587d996f07`: rebase, get the extra printout from https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2245216013 and resolve a silent merge conflict with https://github.com/bitcoin/bitcoin/pull/28052",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2306678413",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "unlabeled",
      "id": 13991511288,
      "node_id": "UNLE_lADOABII5859EymxzwAAAANB9YT4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13991511288",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-23T10:43:00Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14104776683,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAANItc_r",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14104776683",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "489c2477e7c0b2b433551362c61079cf6d3ef510",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/489c2477e7c0b2b433551362c61079cf6d3ef510",
      "created_at": "2024-09-02T14:53:55Z"
    },
    {
      "event": "commented",
      "id": 2324928668,
      "node_id": "IC_kwDOABII586Kk5ic",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2324928668",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-02T14:54:18Z",
      "updated_at": "2024-09-02T14:54:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "`587d996f07...489c2477e7`: rebase to pick CMake",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2324928668",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "labeled",
      "id": 14153394025,
      "node_id": "LE_lADOABII5859EymxzwAAAANLm6dp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14153394025",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-05T21:48:18Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 14263148553,
      "node_id": "UNLE_lADOABII5859EymxzwAAAANSJmAJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14263148553",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-15T13:26:03Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 14283615467,
      "node_id": "LE_lADOABII5859EymxzwAAAANTXqzr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14283615467",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-17T03:36:12Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14438853300,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAANcn2q0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14438853300",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "dba783538683cfc6af209c640c2d019648493f31",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/dba783538683cfc6af209c640c2d019648493f31",
      "created_at": "2024-09-28T05:20:06Z"
    },
    {
      "event": "commented",
      "id": 2380413586,
      "node_id": "IC_kwDOABII586N4jqS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2380413586",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-28T05:20:16Z",
      "updated_at": "2024-09-28T05:20:16Z",
      "author_association": "CONTRIBUTOR",
      "body": "`489c2477e7...dba7835386`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2380413586",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "unlabeled",
      "id": 14438994075,
      "node_id": "UNLE_lADOABII5859EymxzwAAAANcoZCb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14438994075",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-28T06:46:39Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2288411339,
      "node_id": "PRR_kwDOABII586IZmLL",
      "url": null,
      "actor": null,
      "commit_id": "dba783538683cfc6af209c640c2d019648493f31",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nAppreciate the intent of being rigorous in reporting issues with flushing file content to disk.\r\n\r\n#### Alternative implementation\r\n\r\nThe current PR which produces a *run-time failure* in the `AutoFile` destructor upon forgetting to explicitly call `fclose()`. I attempted an alternative implementation ([branch](https://github.com/bitcoin/bitcoin/compare/master...hodlinator:bitcoin:pr/29307_suggestions_prime)) [inspired by ryanofsky's comment](https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2243842400) that takes a lambda in the constructor which is called upon `fclose()`-failure in the destructor. This enforces the context-aware handling of the issue at *compile-time*. The change was somewhat invasive but I'm curious to hear what others make of it. (It also splits `AutoFile` into `FileReader` and `FileWriter` (naming inspired by other types in *streams.h*)).",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#pullrequestreview-2288411339",
      "submitted_at": "2025-01-22T10:56:38Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
    },
    {
      "event": "labeled",
      "id": 16033198894,
      "node_id": "LE_lADOABII5859EymxzwAAAAO7pzMu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16033198894",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-22T18:24:59Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "referenced",
      "id": 16482575822,
      "node_id": "REFE_lADOABII5859EymxzwAAAAPWcCXO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16482575822",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "06105d8da8efbbb7795c68c28bce70645e7eeb33",
      "commit_url": "https://api.github.com/repos/bitcoinknots/bitcoin/commits/06105d8da8efbbb7795c68c28bce70645e7eeb33",
      "created_at": "2025-02-26T15:56:04Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17247485347,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAQEB72j",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17247485347",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "9c16900b9b099840bfe9111bce22e36c21de00c5",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/9c16900b9b099840bfe9111bce22e36c21de00c5",
      "created_at": "2025-04-14T11:47:58Z"
    },
    {
      "event": "unlabeled",
      "id": 17248047606,
      "node_id": "UNLE_lADOABII5859EymxzwAAAAQEEFH2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17248047606",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-14T12:24:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2801543515,
      "node_id": "IC_kwDOABII586m_Clb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2801543515",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-14T12:25:19Z",
      "updated_at": "2025-04-14T12:25:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "`dba7835...9c16900`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2801543515",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17248059503,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAQEEIBv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17248059503",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "89399474499b816e166257a9d9ffc285cef287c2",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/89399474499b816e166257a9d9ffc285cef287c2",
      "created_at": "2025-04-14T12:25:33Z"
    },
    {
      "event": "commented",
      "id": 2801544989,
      "node_id": "IC_kwDOABII586m_C8d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2801544989",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-14T12:25:56Z",
      "updated_at": "2025-04-14T12:25:56Z",
      "author_association": "CONTRIBUTOR",
      "body": "`9c16900b9b...8939947449`: address suggestions",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2801544989",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "commented",
      "id": 2801567384,
      "node_id": "IC_kwDOABII586m_IaY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2801567384",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-14T12:34:27Z",
      "updated_at": "2025-04-14T12:34:27Z",
      "author_association": "CONTRIBUTOR",
      "body": "> lambda in the constructor which is called upon fclose()-failure in the destructor ... I'm curious to hear what others make of it. (It also splits AutoFile into FileReader and FileWriter (naming inspired by other types in streams.h)).\r\n\r\nConcept ACK, but I am worried that the lack of review interest here would mean that an even more invasive patch would never make it.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2801567384",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "commented",
      "id": 2801722119,
      "node_id": "IC_kwDOABII586m_uMH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2801722119",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-14T13:30:05Z",
      "updated_at": "2025-04-14T13:30:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2801722119",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "labeled",
      "id": 17297377036,
      "node_id": "LE_lADOABII5859EymxzwAAAAQHAQcM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17297377036",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-16T23:25:46Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17299786060,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAQHJclM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17299786060",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "aa88c6dfb60166a07014b6f1c7abc87ed0d30309",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/aa88c6dfb60166a07014b6f1c7abc87ed0d30309",
      "created_at": "2025-04-17T04:39:37Z"
    },
    {
      "event": "commented",
      "id": 2811720979,
      "node_id": "IC_kwDOABII586nl3UT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2811720979",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-17T04:40:13Z",
      "updated_at": "2025-04-17T04:40:13Z",
      "author_association": "CONTRIBUTOR",
      "body": "`8939947449...aa88c6dfb6`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2811720979",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "labeled",
      "id": 17300317219,
      "node_id": "LE_lADOABII5859EymxzwAAAAQHLeQj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17300317219",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-17T05:45:39Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2811819632,
      "node_id": "IC_kwDOABII586nmPZw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2811819632",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-17T05:45:40Z",
      "updated_at": "2025-04-17T05:45:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/40701339509</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2811819632",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "unlabeled",
      "id": 17300395061,
      "node_id": "UNLE_lADOABII5859EymxzwAAAAQHLxQ1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17300395061",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-17T05:53:03Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17301464577,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAQHP2YB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17301464577",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0e97a68e13ded93f3908f72c0b38083b6de991d3",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/0e97a68e13ded93f3908f72c0b38083b6de991d3",
      "created_at": "2025-04-17T07:31:46Z"
    },
    {
      "event": "commented",
      "id": 2812047725,
      "node_id": "IC_kwDOABII586nnHFt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2812047725",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-17T07:32:23Z",
      "updated_at": "2025-04-17T07:32:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "`aa88c6dfb6...0e97a68e13`: fix CI",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2812047725",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "reviewed",
      "id": 2774890658,
      "node_id": "PRR_kwDOABII586lZXii",
      "url": null,
      "actor": null,
      "commit_id": "0e97a68e13ded93f3908f72c0b38083b6de991d3",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#pullrequestreview-2774890658",
      "submitted_at": "2025-04-17T07:46:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17302057484,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAQHSHIM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17302057484",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "1f71111e2115ba3504b6585e16df54e5615dd3f9",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/1f71111e2115ba3504b6585e16df54e5615dd3f9",
      "created_at": "2025-04-17T08:17:16Z"
    },
    {
      "event": "commented",
      "id": 2812144686,
      "node_id": "IC_kwDOABII586nnewu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2812144686",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-17T08:17:30Z",
      "updated_at": "2025-04-17T08:17:30Z",
      "author_association": "CONTRIBUTOR",
      "body": "`0e97a68e13...1f71111e21`: fix AI and CI (even more)",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2812144686",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "reviewed",
      "id": 2774978391,
      "node_id": "PRR_kwDOABII586lZs9X",
      "url": null,
      "actor": null,
      "commit_id": "1f71111e2115ba3504b6585e16df54e5615dd3f9",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#pullrequestreview-2774978391",
      "submitted_at": "2025-04-17T08:22:14Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
    },
    {
      "event": "unlabeled",
      "id": 17303724929,
      "node_id": "UNLE_lADOABII5859EymxzwAAAAQHYeOB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17303724929",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-17T10:18:33Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17304666122,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAQHcEAK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17304666122",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "created_at": "2025-04-17T11:36:16Z"
    },
    {
      "event": "commented",
      "id": 2812596691,
      "node_id": "IC_kwDOABII586npNHT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2812596691",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-17T11:36:36Z",
      "updated_at": "2025-04-17T11:36:36Z",
      "author_association": "CONTRIBUTOR",
      "body": "`1f71111e21...c52b673bf8`: https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048480671",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2812596691",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "reviewed",
      "id": 2775379592,
      "node_id": "PRR_kwDOABII586lbO6I",
      "url": null,
      "actor": null,
      "commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK, we definitely want to know if this happens!\r\n\r\n* It seems we're using the return value as a boolean - can make make it return one?\r\n* The error messages seem all over the place, can we unify them to `LogError`?\r\n* Not sure if scope-ing the AutoFile + closing it explicitly is the best solution -  would probably prefer @ryanofsky's `std::function<void()> on_error` or @maflcko's recommendation to let `AutoFile` guarantee proper closing.\r\n* Sometimes we're explicitly showing a closing related failure, other times we're reusing previous error messages - it's not a very important or likely scenario, we could likely add it to other erroneous cases.\r\n* We have discernible changes here, all in a single commit - would prefer separating the concerns a bit more with better commit message explanations",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#pullrequestreview-2775379592",
      "submitted_at": "2025-04-17T12:14:51Z",
      "state": "CHANGES_REQUESTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17500810344,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAQTISxo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17500810344",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "c9cd7d3aa92653ba2df54188018f1e0baa336068",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/c9cd7d3aa92653ba2df54188018f1e0baa336068",
      "created_at": "2025-05-02T14:27:04Z"
    },
    {
      "event": "commented",
      "id": 2847346556,
      "node_id": "IC_kwDOABII586ptw98",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2847346556",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-02T14:27:19Z",
      "updated_at": "2025-05-02T14:27:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "`c52b673bf8...c9cd7d3aa9`: rebase and address suggestions",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2847346556",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17500901504,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAQTIpCA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17500901504",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "66087035cf01119e71dd57fd184fdb2428439206",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/66087035cf01119e71dd57fd184fdb2428439206",
      "created_at": "2025-05-02T14:33:40Z"
    },
    {
      "event": "commented",
      "id": 2847360895,
      "node_id": "IC_kwDOABII586pt0d_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2847360895",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-02T14:34:19Z",
      "updated_at": "2025-05-02T14:34:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "`c9cd7d3aa9...66087035cf`: remove outdated comment",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2847360895",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17501104720,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAQTJapQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17501104720",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "fe2d1955f6333c57f54aed2a2a8b3cdaa6bf9d71",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/fe2d1955f6333c57f54aed2a2a8b3cdaa6bf9d71",
      "created_at": "2025-05-02T14:48:20Z"
    },
    {
      "event": "commented",
      "id": 2847391766,
      "node_id": "IC_kwDOABII586pt8AW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2847391766",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-02T14:48:58Z",
      "updated_at": "2025-05-02T14:48:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "`66087035cf...fe2d1955f6`: add missing includes in the first commit",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2847391766",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "reviewed",
      "id": 2812640885,
      "node_id": "PRR_kwDOABII586npX51",
      "url": null,
      "actor": null,
      "commit_id": "fe2d1955f6333c57f54aed2a2a8b3cdaa6bf9d71",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review fe2d1955f6333c57f54aed2a2a8b3cdaa6bf9d71\r\n\r\n* blocker: the new `AutoFile::write_buffer` should also mark the file as dirty.\r\n* the current `fclose` returns a fake error code, but is actually a boolean - may make sense to rename it (e.g. `Close`, similarly to how we've wrapped `ftruncate` with `TruncateFile`) and migrate to returning a boolean to avoid the current confusion.\r\n\r\n<details>\r\n<summary>Diff since last review</summary>\r\n\r\n```patch\r\ndiff --git a/src/index/blockfilterindex.cpp b/src/index/blockfilterindex.cpp\r\nindex 9e6ea8d7d0..6b47a0fa0a 100644\r\n--- a/src/index/blockfilterindex.cpp\r\n+++ b/src/index/blockfilterindex.cpp\r\n@@ -13,6 +13,7 @@\r\n #include <node/blockstorage.h>\r\n #include <undo.h>\r\n #include <util/fs_helpers.h>\r\n+#include <util/syserror.h>\r\n #include <validation.h>\r\n \r\n /* The index database stores three items for each block: the disk location of the encoded filter,\r\n@@ -151,8 +152,13 @@ bool BlockFilterIndex::CustomCommit(CDBBatch& batch)\r\n         LogError(\"%s: Failed to open filter file %d\\n\", __func__, pos.nFile);\r\n         return false;\r\n     }\r\n-    if (!file.Commit() || file.fclose() != 0) {\r\n+    if (!file.Commit()) {\r\n         LogError(\"%s: Failed to commit filter file %d\\n\", __func__, pos.nFile);\r\n+        (void)file.fclose();\r\n+        return false;\r\n+    }\r\n+    if (file.fclose() != 0) {\r\n+        LogError(\"Failed to close filter file %d after commit: %s\", pos.nFile, SysErrorString(errno));\r\n         return false;\r\n     }\r\n \r\n@@ -205,8 +211,13 @@ size_t BlockFilterIndex::WriteFilterToDisk(FlatFilePos& pos, const BlockFilter&\r\n             LogPrintf(\"%s: Failed to truncate filter file %d\\n\", __func__, pos.nFile);\r\n             return 0;\r\n         }\r\n-        if (!last_file.Commit() || last_file.fclose() != 0) {\r\n+        if (!last_file.Commit()) {\r\n             LogPrintf(\"%s: Failed to commit filter file %d\\n\", __func__, pos.nFile);\r\n+            (void)last_file.fclose();\r\n+            return 0;\r\n+        }\r\n+        if (last_file.fclose() != 0) {\r\n+            LogError(\"Failed to close filter file %d after commit: %s\", pos.nFile, SysErrorString(errno));\r\n             return 0;\r\n         }\r\n \r\n@@ -231,7 +242,7 @@ size_t BlockFilterIndex::WriteFilterToDisk(FlatFilePos& pos, const BlockFilter&\r\n     fileout << filter.GetBlockHash() << filter.GetEncodedFilter();\r\n \r\n     if (fileout.fclose() != 0) {\r\n-        LogPrintf(\"Failed to close filter file %d: %s\", pos.nFile, SysErrorString(errno));\r\n+        LogError(\"Failed to close filter file %d: %s\", pos.nFile, SysErrorString(errno));\r\n         return 0;\r\n     }\r\n \r\ndiff --git a/src/node/blockstorage.cpp b/src/node/blockstorage.cpp\r\nindex 8b21356c42..e6a979b5f3 100644\r\n--- a/src/node/blockstorage.cpp\r\n+++ b/src/node/blockstorage.cpp\r\n@@ -33,6 +33,7 @@\r\n #include <util/fs.h>\r\n #include <util/signalinterrupt.h>\r\n #include <util/strencodings.h>\r\n+#include <util/syserror.h>\r\n #include <util/translation.h>\r\n #include <validation.h>\r\n \r\n@@ -940,37 +941,31 @@ bool BlockManager::WriteBlockUndo(const CBlockUndo& blockundo, BlockValidationSt\r\n             return false;\r\n         }\r\n \r\n+        // Open history file to append\r\n+        AutoFile file{OpenUndoFile(pos)};\r\n+        if (file.IsNull()) {\r\n+            LogError(\"OpenUndoFile failed for %s while writing block undo\", pos.ToString());\r\n+            return FatalError(m_opts.notifications, state, _(\"Failed to write undo data.\"));\r\n+        }\r\n         {\r\n-            // Open history file to append\r\n-            AutoFile file{OpenUndoFile(pos)};\r\n-            if (file.IsNull()) {\r\n-                LogError(\"OpenUndoFile failed for %s while writing block undo\", pos.ToString());\r\n-                return FatalError(m_opts.notifications, state, _(\"Failed to write undo data.\"));\r\n-            }\r\n+            BufferedWriter fileout{file};\r\n+\r\n+            // Write index header\r\n+            fileout << GetParams().MessageStart() << blockundo_size;\r\n+            pos.nPos += STORAGE_HEADER_BYTES;\r\n             {\r\n-                BufferedWriter fileout{file};\r\n-\r\n-                // Write index header\r\n-                fileout << GetParams().MessageStart() << blockundo_size;\r\n-                pos.nPos += STORAGE_HEADER_BYTES;\r\n-                {\r\n-                    // Calculate checksum\r\n-                    HashWriter hasher{};\r\n-                    hasher << block.pprev->GetBlockHash() << blockundo;\r\n-                    // Write undo data & checksum\r\n-                    fileout << blockundo << hasher.GetHash();\r\n-                }\r\n+                // Calculate checksum\r\n+                HashWriter hasher{};\r\n+                hasher << block.pprev->GetBlockHash() << blockundo;\r\n+                // Write undo data & checksum\r\n+                fileout << blockundo << hasher.GetHash();\r\n             }\r\n+        }\r\n \r\n-            if (file.fclose() != 0) {\r\n-                LogPrintLevel(BCLog::BLOCKSTORAGE,\r\n-                              BCLog::Level::Error,\r\n-                              \"Failed to close block undo file %s: %s\",\r\n-                              pos.ToString(),\r\n-                              SysErrorString(errno));\r\n-                return FatalError(m_opts.notifications, state, _(\"Failed to close block undo file.\"));\r\n-            }\r\n-            // Make sure that the file is closed before we call `FlushUndoFile`.\r\n+        // Make sure that the file is closed before we call `FlushUndoFile`.\r\n+        if (file.fclose() != 0) {\r\n+            LogError(\"Failed to close block undo file %s: %s\", pos.ToString(), SysErrorString(errno));\r\n+            return FatalError(m_opts.notifications, state, _(\"Failed to close block undo file.\"));\r\n         }\r\n \r\n         // rev files are written in block height order, whereas blk files are written as blocks come in (often out of order)\r\n@@ -1114,11 +1109,7 @@ FlatFilePos BlockManager::WriteBlock(const CBlock& block, int nHeight)\r\n     }\r\n \r\n     if (file.fclose() != 0) {\r\n-        LogPrintLevel(BCLog::BLOCKSTORAGE,\r\n-                      BCLog::Level::Error,\r\n-                      \"Failed to close block file %s: %s\",\r\n-                      pos.ToString(),\r\n-                      SysErrorString(errno));\r\n+        LogError(\"Failed to close block file %s: %s\", pos.ToString(), SysErrorString(errno));\r\n         m_opts.notifications.fatalError(_(\"Failed to close file when writing block.\"));\r\n         return FlatFilePos();\r\n     }\r\n@@ -1166,7 +1157,7 @@ static auto InitBlocksdirXorKey(const BlockManager::Options& opts)\r\n         )};\r\n         xor_key_file << xor_key;\r\n         if (xor_key_file.fclose() != 0) {\r\n-            throw std::runtime_error{strprintf(\"Error closing XOR key file %s: %s\\n\",\r\n+            throw std::runtime_error{strprintf(\"Error closing XOR key file %s: %s\",\r\n                                                fs::PathToString(xor_key_path),\r\n                                                SysErrorString(errno))};\r\n         }\r\ndiff --git a/src/policy/fees.cpp b/src/policy/fees.cpp\r\nindex ea763efc98..3a59930c4b 100644\r\n--- a/src/policy/fees.cpp\r\n+++ b/src/policy/fees.cpp\r\n@@ -19,6 +19,7 @@\r\n #include <uint256.h>\r\n #include <util/fs.h>\r\n #include <util/serfloat.h>\r\n+#include <util/syserror.h>\r\n #include <util/time.h>\r\n \r\n #include <algorithm>\r\n@@ -953,11 +954,16 @@ void CBlockPolicyEstimator::Flush() {\r\n void CBlockPolicyEstimator::FlushFeeEstimates()\r\n {\r\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"wb\")};\r\n-    if (est_file.IsNull() || !Write(est_file) || est_file.fclose() != 0) {\r\n-        LogWarning(\"Failed to write fee estimates to %s. Continuing anyway.\", fs::PathToString(m_estimation_filepath));\r\n-    } else {\r\n-        LogPrintf(\"Flushed fee estimates to %s.\\n\", fs::PathToString(m_estimation_filepath.filename()));\r\n+    if (est_file.IsNull() || !Write(est_file)) {\r\n+        LogPrintf(\"Failed to write fee estimates to %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));\r\n+        (void)est_file.fclose();\r\n+        return;\r\n+    }\r\n+    if (est_file.fclose() != 0) {\r\n+        LogError(\"Failed to close fee estimates file %s: %s. Continuing anyway.\", fs::PathToString(m_estimation_filepath), SysErrorString(errno));\r\n+        return;\r\n     }\r\n+    LogPrintf(\"Flushed fee estimates to %s.\\n\", fs::PathToString(m_estimation_filepath.filename()));\r\n }\r\n \r\n bool CBlockPolicyEstimator::Write(AutoFile& fileout) const\r\ndiff --git a/src/streams.h b/src/streams.h\r\nindex c13cebc5c6..09b2e20c08 100644\r\n--- a/src/streams.h\r\n+++ b/src/streams.h\r\n@@ -416,11 +416,13 @@ public:\r\n             // This is because here from the destructor we have no way to signal\r\n             // error due to close which, after write, could mean the file is\r\n             // corrupted and must be handled properly at the call site.\r\n+            // Destructors in C++ cannot signal an error to the callers because\r\n+            // they do not return a value and are not allowed to throw exceptions.\r\n             Assume(IsNull());\r\n         }\r\n \r\n         if (fclose() != 0) {\r\n-            LogPrintLevel(BCLog::ALL, BCLog::Level::Error, \"Failed to close file: %s\", SysErrorString(errno));\r\n+            LogError(\"Failed to close file: %s\", SysErrorString(errno));\r\n         }\r\n     }\r\n \r\ndiff --git a/src/test/fuzz/autofile.cpp b/src/test/fuzz/autofile.cpp\r\nindex cdbae9c3cc..8d17624da6 100644\r\n--- a/src/test/fuzz/autofile.cpp\r\n+++ b/src/test/fuzz/autofile.cpp\r\n@@ -63,9 +63,6 @@ FUZZ_TARGET(autofile)\r\n             fclose(f);\r\n         }\r\n     } else {\r\n-        // FuzzedFileProvider::close() is expected to fail sometimes. Don't let\r\n-        // the destructor of AutoFile be upset by a failing fclose(). Close it\r\n-        // explicitly (and ignore any errors) so that the destructor is a noop.\r\n         (void)auto_file.fclose();\r\n     }\r\n }\r\n```\r\n\r\n</details>",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#pullrequestreview-2812640885",
      "submitted_at": "2025-05-02T18:33:31Z",
      "state": "CHANGES_REQUESTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
    },
    {
      "event": "reviewed",
      "id": 2812670165,
      "node_id": "PRR_kwDOABII586npfDV",
      "url": null,
      "actor": null,
      "commit_id": "fe2d1955f6333c57f54aed2a2a8b3cdaa6bf9d71",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#pullrequestreview-2812670165",
      "submitted_at": "2025-05-02T18:36:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17518654621,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAQUMXSd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17518654621",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "2c1a8ff0c09c7ba489948e8d3090bb154c93d5bf",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/2c1a8ff0c09c7ba489948e8d3090bb154c93d5bf",
      "created_at": "2025-05-05T12:37:01Z"
    },
    {
      "event": "commented",
      "id": 2850863863,
      "node_id": "IC_kwDOABII586p7Lr3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2850863863",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-05T12:39:17Z",
      "updated_at": "2025-05-05T12:39:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "`fe2d1955f6...2c1a8ff0c0`: address suggestions\r\n\r\n> AutoFile::write_buffer should also mark the file as dirty\r\n\r\nDone.\r\n\r\n> the current fclose returns a fake error code...\r\n\r\nReplied to the discussion thread at https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048792563\r\n",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2850863863",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM1ODkxMjFiZjI0NTkwZmRkYWQ4ODJmYmRjMTg2MWQ4MWJhZDI1MzI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c589121bf24590fddad882fbdc1861d81bad2532",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c589121bf24590fddad882fbdc1861d81bad2532",
      "tree": {
        "sha": "d91fc6bcd234f30203ab7f769602f435df596fd3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d91fc6bcd234f30203ab7f769602f435df596fd3"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree d91fc6bcd234f30203ab7f769602f435df596fd3\nparent 5b8046a6e893b7fad5a93631e6d1e70db31878af\nauthor Vasil Dimov <vd@FreeBSD.org> 1706105035 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1746450197 +0200\n\nExplicitly close all AutoFiles that have been written\n\nThere is no way to report a close error from `AutoFile` destructor.\nSuch an error could be serious if the file has been written to because\nit may mean the file is now corrupted (same as if write fails).\n\nSo, change all users of `AutoFile` that use it to write data to\nexplicitly close the file and handle a possible error.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmgYtxYACgkQVN8G9ktV\ny79j2SAAg8mO3YaoIMjFx2KZ+14X4VVOJJfZWwMqzxjItJ5wByXsrWGw//vJY7L2\nXrjEROtvYlceeCZNjwuxFSkr6rsD6nZP1glj1FKfHPXAa5Zb5o6ewvlWm0d6pJz0\nEZTDXWDdHlBqXffeMnM/tUGI1We9AueZX8zBidqDmAacBYtAJbRj2oivQP/JcuRm\nOcY+ncbtst7kq59mYPXm2/87eWdt+X9eo99SHuPr+mMNK9NfVkmF36vAlFkQiJVN\nQ6rmxa+jDTCOjxRVjmhxQDtxXXa3Lgrj9cXp6fSqLLA8tGdPgui4EREBLQ+RVafW\nCHZiP0XhyswNMvy0y7ZCnsi3WfazPA8dM2RbOw5G/JDLwk9uVqFvAWnLMhOgJraY\n1MHkFHMW1a7UK4a08UX4m8h47v+PhUX1Jy96b+Uf1lbM8yXlAke4TI0JNxpT5vH4\nPuJNT1Yibbgfnku8a6AzXFUh7aHn5BL/1PFHpXmzvLZO/R25oSC4LURwV5f0z4Se\naQac4pu4MUcKrH9TOi01uspVQbIQMZqIB6mgTQJZCoZnCjXnuSjrwINKrt7RBFB8\nT4blow80AXpzk6EVXXgB9afN+JlrdG0dJlJB8NOCNqBWg3efFfxx73rYMp46Pf+E\nx9PdFwds7ZRvnFF/0C0dpgx+yjdeqhhHZO2JxUYOXpYrpSSlR4DMoLkqIqQqkFlD\nXXJDb1KgBI7cxfYa7BlUf9AQxW8FAfv4uXosMJFOXzmGFHNR3pkzuZ7dH/F72fQ4\ntOHdDVtJYTnZeeeNayFh/xEcTmajsbjrjILhYPQ4gkP0Vj2OfbP4F7NpVSFHDqck\ntJuZVMhc42yW+fHSez51b24dAGtcBesKQ7L9C5+nFi9Wn7k3aPRqYCZwptg9o+ak\nI1FhQgMO7vR1z8TQEQo5ElWadFbbJ/jDZ6+ZtpCnpkUiAlcN1eve9QP+IbMDS3Ys\ncdY9conASF436bEeA1ESqCi+TZRCu3Yj6aCumBtUE2x9XTIGCdOPa7q4aa5xQkW8\nsRyiJkCMeuWyPasSYiVpkFJrO7+zS2+ykjTUhZyG2W/Vpr42OIALUFfJQArj2cNI\nB9sKXqHR6niFhJMnUrTwrFRYTaNSyelr+ZvF0c9HurKWikygRCsMpdqGSxTyubbl\nCwzshuHa3SLAIZeTU037aOoDTyE0fw/3NSEvwzz0BBgk3503tpI/YhXt+FRANS/z\nmBrt4xd5PUSM0euK39kcueigzV4FcZxXGTg5wRXiYBXrj06+nwGdC6OYnMBZ5+4D\nbyRFUArxxr4wIQXkF1c68voLYBOGFLxjP6uM+pyKcB3BUDKsDBhEfVtHy+2hyS7W\noKCaCDl7JfSDmWjAn4A2hlxl/B8X0w==\n=Bo9D\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5b8046a6e893b7fad5a93631e6d1e70db31878af",
          "sha": "5b8046a6e893b7fad5a93631e6d1e70db31878af",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5b8046a6e893b7fad5a93631e6d1e70db31878af"
        }
      ],
      "message": "Explicitly close all AutoFiles that have been written\n\nThere is no way to report a close error from `AutoFile` destructor.\nSuch an error could be serious if the file has been written to because\nit may mean the file is now corrupted (same as if write fails).\n\nSo, change all users of `AutoFile` that use it to write data to\nexplicitly close the file and handle a possible error.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-05-05T13:03:17Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-01-24T14:03:55Z"
      },
      "sha": "c589121bf24590fddad882fbdc1861d81bad2532"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17519145472,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAQUOPIA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17519145472",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "61ba3fc494f2f5e60b668316c84cecbdc123e5fa",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/61ba3fc494f2f5e60b668316c84cecbdc123e5fa",
      "created_at": "2025-05-05T13:03:34Z"
    },
    {
      "event": "labeled",
      "id": 17519147370,
      "node_id": "LE_lADOABII5859EymxzwAAAAQUOPlq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17519147370",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-05T13:03:42Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2850943291,
      "node_id": "IC_kwDOABII586p7fE7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2850943291",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-05T13:03:43Z",
      "updated_at": "2025-05-05T13:03:43Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Task `MSan, depends`: https://github.com/bitcoin/bitcoin/runs/41649198396</sub>\n<sub>LLM reason (âœ¨ experimental): The CI failure was caused by an assertion failure in streams.h (AutoFile destructor) during the execution of streams_tests.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2850943291",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "commented",
      "id": 2850944121,
      "node_id": "IC_kwDOABII586p7fR5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2850944121",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-05T13:04:01Z",
      "updated_at": "2025-05-05T13:04:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "`2c1a8ff0c0...61ba3fc494`: fix CI",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2850944121",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "commented",
      "id": 2851026294,
      "node_id": "IC_kwDOABII586p7zV2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2851026294",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-05T13:31:59Z",
      "updated_at": "2025-05-05T13:31:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "`write_buffer` was also marked as dirty in latest push.\r\n\r\nuntested ACK 61ba3fc494f2f5e60b668316c84cecbdc123e5fa\r\n\r\nQ: shouldn't `Truncate` and `Commit` also set `m_was_written = true`?",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2851026294",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    },
    {
      "event": "review_requested",
      "id": 17519654605,
      "node_id": "RRE_lADOABII5859EymxzwAAAAQUQLbN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17519654605",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-05T13:32:05Z",
      "requested_reviewer": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 17519654884,
      "node_id": "RRE_lADOABII5859EymxzwAAAAQUQLfk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17519654884",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-05T13:32:06Z",
      "requested_reviewer": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 17519655154,
      "node_id": "RRE_lADOABII5859EymxzwAAAAQUQLjy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17519655154",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-05T13:32:07Z",
      "requested_reviewer": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDkwNTdhYjhiODAxMzdhODlkZjY4YTNlZDRiYzQ5Zjk5MjZlMGY2MzQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "tree": {
        "sha": "a391ff70033ca102a4542e6d4bab2d14f3c6d987",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a391ff70033ca102a4542e6d4bab2d14f3c6d987"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree a391ff70033ca102a4542e6d4bab2d14f3c6d987\nparent c589121bf24590fddad882fbdc1861d81bad2532\nauthor Vasil Dimov <vd@FreeBSD.org> 1746195761 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1746455566 +0200\n\nutil: check that a file has been closed before ~AutoFile() is called\n\nIf an `AutoFile` has been written to, then expect callers to have closed\nit explicitly via the `AutoFile::fclose()` method. This is because if\nthe destructor calls `std::fclose()` and encounters an error, then it\nis too late to indicate this to the caller in a meaningful way.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmgYzA8ACgkQVN8G9ktV\ny7+IgB//Z/8PHYiaAtQDaNDib6WrRZDujbXInOCYuXfcGtzB2/cUvwX7Mz/7f8Qf\nhEI7xwbecDbpa1toz8hhrZ3DYp1ajcAtRLlYgq/qWC7yDB+zh2m+4CKPVeOgV4v6\n21FDUDqmAmAp+hn0XGc1Id4rSMVCZIAX79Y5a4dCE/i5aecSd+ddbl5X5U6UqEE5\nrBDzsLKKbojhVVU7eLL7VWoqrnrtbdwP3AdzpiBJpVRkGBoZz/dZhAuc6fdB+X+M\nukaFTA7xctmMyDUEjb3fqJAH7xcoiejVCfbZMWppg7+6lnHdAtIiWxAhYuITCSH4\njocbqaJMvuIuqoXeOBAzWlLCF18lXcrD67W7ibN/3a66GphbBdSW+2OBLRR1MSWg\n2k8KDGxEWT5ArK4DsbIjMEi6VYAk6o5sfamkG2z4Kszj8J1Xk3wXkkTAB01WFNjP\nH/5X9xRslTmbW0gAkbueCeVbXzbuNLm3AI1UeI1WzwucmLSwrpXsHlsrvw133tC/\nFIyBpe1cSEsOrzb3FdRGrSbWQGONL94Yp0RWdm5USCbZRKpaqyBHVngS4QyK3tyJ\n4gaKAQolKEcWRX9+fSXcpnGMvc6NaQgJWgRAO0Ya3Sw0EN8N0w7VLnZBJMg8Gs6w\ns7LoIdiwFW4ca7Y5b/CFx4ecFZEyJCsMJumvWCbru6dWwkjIxTOdbPIw/YFEVnBp\nnlPc+kRGvW5XAi0MzDDW2Csu9/16fenrc9vz3Khl/j9neGPzlmemg1fE9GRqSs3t\nH8a00fk22vjOwJYOE3QwY/gjLa40CWJE4UTSBojyyDTPXLJ6HNInBDGZG9FiyBJu\nBZlkUF5zhfub8AKhssNh0UaadEGvDPrLuNtiwdqazEwIaGQ2/fAExXfjmTcVDsa0\nOHvRCSexiwBwo/5QBGR/l8MtlrLcckw0RfIf3pvIHNH9O+LWI3Tsf9LAIwAlpqLH\nrlKGUTgKi5thDpXLnp7LnkKWiAsHAeUIp5aB+Fjsa9HtAJWfe1TREHduTyVLidkh\nQuA+LI0we2qXw6YQhRpqhPaDklaM/xyfovMnsepATj5pR1/fvGg9XTO0t8Utr1H6\nJpSPnonkTtrgbqtJJH5BRjnL1bKWW8D+T/zN3zyPKZfFHW42YfGxpcgw+VaT62VG\nkGQMDnpY9jJGZYTA1RrspJPAUGSyOs8NVORblthL3m1CjvkYh0QofWN4gpxvo8aG\nDzXlz/KvwbBGfUAfs1PnXrCzLuRAhTEc2HlEGjBZYw67sbDwJe2q0+lKqW5Lh4aI\nYQVifEGLAJS//09m/7xYDFxzsH6ZIugv+KiTA86h94haLl+Kc3BRNDnx1eabPNKe\nwDvEJXH843s4SL7+JWYau3Ah3jR7+A==\n=qAHc\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c589121bf24590fddad882fbdc1861d81bad2532",
          "sha": "c589121bf24590fddad882fbdc1861d81bad2532",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c589121bf24590fddad882fbdc1861d81bad2532"
        }
      ],
      "message": "util: check that a file has been closed before ~AutoFile() is called\n\nIf an `AutoFile` has been written to, then expect callers to have closed\nit explicitly via the `AutoFile::fclose()` method. This is because if\nthe destructor calls `std::fclose()` and encounters an error, then it\nis too late to indicate this to the caller in a meaningful way.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-05-05T14:32:46Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-05-02T14:22:41Z"
      },
      "sha": "9057ab8b80137a89df68a3ed4bc49f9926e0f634"
    },
    {
      "event": "unlabeled",
      "id": 17520800590,
      "node_id": "UNLE_lADOABII5859EymxzwAAAAQUUjNO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17520800590",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-05T14:33:20Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17520864024,
      "node_id": "HRFPE_lADOABII5859EymxzwAAAAQUUysY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17520864024",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "created_at": "2025-05-05T14:36:54Z"
    },
    {
      "event": "commented",
      "id": 2851224058,
      "node_id": "IC_kwDOABII586p8jn6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2851224058",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-05T14:37:59Z",
      "updated_at": "2025-05-05T14:37:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "`61ba3fc494...9057ab8b80`:\r\n\r\n> shouldn't `Truncate` and `Commit` also set `m_was_written = true`?\r\n\r\nGood question! I think `Truncate()` - yes because it changes the contents of the file. Changed.\r\n\r\n`Commit()` does not, so I left it alone. In other words - if a file is opened, none of the `write()`, `write_buffer()` or `Truncate()` is called, `Commit()` is called, and the file object is destroyed, could that be a problem? I think no because the contents of the file was not changed.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#issuecomment-2851224058",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465152180",
      "pull_request_review_id": 1841755517,
      "id": 1465152180,
      "node_id": "PRRC_kwDOABII585XVHK0",
      "diff_hunk": "@@ -4,14 +4,20 @@\n \n #include <span.h>\n #include <streams.h>\n+#include <tinyformat.h>\n+#include <util/syserror.h>\n \n #include <array>\n \n std::size_t AutoFile::detail_fread(Span<std::byte> dst)\n {\n     if (!m_file) throw std::ios_base::failure(\"AutoFile::read: file handle is nullptr\");\n     if (m_xor.empty()) {\n-        return std::fread(dst.data(), 1, dst.size(), m_file);\n+        const auto n = std::fread(dst.data(), 1, dst.size(), m_file);\n+        if (ferror(m_file)) {\n+            throw std::ios_base::failure(strprintf(\"AutoFile::detail_fread: %s\", SysErrorString(errno)));",
      "path": "src/streams.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "7c58f6ea4f603b570b7d8532aa9bb59df069d6cb",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "not sure. `detail_fread` is an implementation detail and thin wrapper, with the goal to simply return the return value of `std::fread`. It should be left for the caller to decide about the error.\r\n\r\nIn any case, if you want to do this, you'd have to apply it to both branches of the `if`. The error message shouldn't differ just because a file is xor'd or not.\r\n\r\nFinally, it would be good to explain whether this is a bugfix or a refactor/belt-and-suspenders. I don't think an error/eof could have occurred if the full `dst.size()` was read. So I don't think this is needed, but I could be wrong. Ideally, there is a unit test showing why the change is needed.",
      "created_at": "2024-01-24T15:59:58Z",
      "updated_at": "2024-01-24T15:59:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1465152180",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465152180"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 18,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465295573",
      "pull_request_review_id": 1841963492,
      "id": 1465295573,
      "node_id": "PRRC_kwDOABII585XVqLV",
      "diff_hunk": "@@ -47,7 +47,7 @@ FUZZ_TARGET(autofile)\n                 }\n             },\n             [&] {\n-                auto_file.fclose();\n+                assert(auto_file.fclose() == 0);",
      "path": "src/test/fuzz/autofile.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "7c58f6ea4f603b570b7d8532aa9bb59df069d6cb",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This assert actually failed in CI (wow!):\r\n\r\nhttps://cirrus-ci.com/task/5586893237125120\r\n\r\n```\r\nRun autofile with args ['/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz', '-runs=1', PosixPath('/ci_container_base/ci/scratch/qa-assets/fuzz_seed_corpus/autofile')]INFO: Running with entropic power schedule (0xFF, 100).\r\nINFO: Seed: 3765617163\r\nINFO: Loaded 1 modules   (547059 inline 8-bit counters): 547059 [0x55cd54dd29b8, 0x55cd54e582ab), \r\nINFO: Loaded 1 PC tables (547059 PCs): 547059 [0x55cd54e582b0,0x55cd556b11e0), \r\nINFO:      535 files found in /ci_container_base/ci/scratch/qa-assets/fuzz_seed_corpus/autofile\r\nINFO: -max_len is not provided; libFuzzer will not generate inputs larger than 1041296 bytes\r\nINFO: seed corpus: files: 535 min: 1b max: 1041296b total: 17489928b rss: 106Mb\r\nfuzz: test/fuzz/autofile.cpp:50: auto autofile_fuzz_target(FuzzBufferType)::(anonymous class)::operator()() const: Assertion `auto_file.fclose() == 0' failed.\r\n==18378== ERROR: libFuzzer: deadly signal\r\n    #0 0x55cd5193ab55 in __sanitizer_print_stack_trace (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x1a5fb55) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #1 0x55cd518922fc in fuzzer::PrintStackTrace() (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x19b72fc) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #2 0x55cd51878367 in fuzzer::Fuzzer::CrashCallback() (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x199d367) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #3 0x7fb162f1d8ff  (/lib/x86_64-linux-gnu/libc.so.6+0x428ff) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #4 0x7fb162f7498a in pthread_kill (/lib/x86_64-linux-gnu/libc.so.6+0x9998a) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #5 0x7fb162f1d855 in gsignal (/lib/x86_64-linux-gnu/libc.so.6+0x42855) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #6 0x7fb162f018b6 in abort (/lib/x86_64-linux-gnu/libc.so.6+0x268b6) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #7 0x7fb162f017da  (/lib/x86_64-linux-gnu/libc.so.6+0x267da) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #8 0x7fb162f14185 in __assert_fail (/lib/x86_64-linux-gnu/libc.so.6+0x39185) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #9 0x55cd51accacc in autofile_fuzz_target(Span<unsigned char const>)::$_3::operator()() const src/test/fuzz/autofile.cpp:50:17\r\n    #10 0x55cd51accacc in unsigned long CallOneOf<autofile_fuzz_target(Span<unsigned char const>)::$_0, autofile_fuzz_target(Span<unsigned char const>)::$_1, autofile_fuzz_target(Span<unsigned char const>)::$_2, autofile_fuzz_target(Span<unsigned char const>)::$_3, autofile_fuzz_target(Span<unsigned char const>)::$_4, autofile_fuzz_target(Span<unsigned char const>)::$_5>(FuzzedDataProvider&, autofile_fuzz_target(Span<unsigned char const>)::$_0, autofile_fuzz_target(Span<unsigned char const>)::$_1, autofile_fuzz_target(Span<unsigned char const>)::$_2, autofile_fuzz_target(Span<unsigned char const>)::$_3, autofile_fuzz_target(Span<unsigned char const>)::$_4, autofile_fuzz_target(Span<unsigned char const>)::$_5) src/./test/fuzz/util.h:42:27\r\n    #11 0x55cd51accacc in autofile_fuzz_target(Span<unsigned char const>) src/test/fuzz/autofile.cpp:27:9\r\n    #12 0x55cd5204a52c in std::function<void (Span<unsigned char const>)>::operator()(Span<unsigned char const>) const /usr/bin/../lib/gcc/x86_64-linux-gnu/13/../../../../include/c++/13/bits/std_function.h:591:9\r\n    #13 0x55cd5204a52c in LLVMFuzzerTestOneInput src/test/fuzz/fuzz.cpp:178:5\r\n    #14 0x55cd51879814 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x199e814) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #15 0x55cd51878f09 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x199df09) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #16 0x55cd5187aaf6 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x199faf6) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #17 0x55cd5187b017 in fuzzer::Fuzzer::Loop(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x19a0017) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #18 0x55cd5186875b in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x198d75b) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #19 0x55cd51892ce6 in main (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x19b7ce6) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #20 0x7fb162f030cf  (/lib/x86_64-linux-gnu/libc.so.6+0x280cf) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #21 0x7fb162f03188 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x28188) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #22 0x55cd5185d624 in _start (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x1982624) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\nNOTE: libFuzzer has rudimentary signal handlers.\r\n      Combine libFuzzer with AddressSanitizer or similar for better crash reports.\r\nSUMMARY: libFuzzer: deadly signal\r\nMS: 0 ; base unit: 0000000000000000000000000000000000000000\r\nartifact_prefix='./'; Test unit written to ./crash-276f4f9d3e6ba98f897bd1082aec7214ca8e4f5d\r\nINFO: Running with entropic power schedule (0xFF, 100).\r\nINFO: Seed: 3765617163\r\nINFO: Loaded 1 modules   (547059 inline 8-bit counters): 547059 [0x55cd54dd29b8, 0x55cd54e582ab), \r\nINFO: Loaded 1 PC tables (547059 PCs): 547059 [0x55cd54e582b0,0x55cd556b11e0), \r\nINFO:      535 files found in /ci_container_base/ci/scratch/qa-assets/fuzz_seed_corpus/autofile\r\nINFO: -max_len is not provided; libFuzzer will not generate inputs larger than 1041296 bytes\r\nINFO: seed corpus: files: 535 min: 1b max: 1041296b total: 17489928b rss: 106Mb\r\nfuzz: test/fuzz/autofile.cpp:50: auto autofile_fuzz_target(FuzzBufferType)::(anonymous class)::operator()() const: Assertion `auto_file.fclose() == 0' failed.\r\n==18378== ERROR: libFuzzer: deadly signal\r\n    #0 0x55cd5193ab55 in __sanitizer_print_stack_trace (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x1a5fb55) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #1 0x55cd518922fc in fuzzer::PrintStackTrace() (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x19b72fc) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #2 0x55cd51878367 in fuzzer::Fuzzer::CrashCallback() (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x199d367) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #3 0x7fb162f1d8ff  (/lib/x86_64-linux-gnu/libc.so.6+0x428ff) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #4 0x7fb162f7498a in pthread_kill (/lib/x86_64-linux-gnu/libc.so.6+0x9998a) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #5 0x7fb162f1d855 in gsignal (/lib/x86_64-linux-gnu/libc.so.6+0x42855) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #6 0x7fb162f018b6 in abort (/lib/x86_64-linux-gnu/libc.so.6+0x268b6) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #7 0x7fb162f017da  (/lib/x86_64-linux-gnu/libc.so.6+0x267da) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #8 0x7fb162f14185 in __assert_fail (/lib/x86_64-linux-gnu/libc.so.6+0x39185) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #9 0x55cd51accacc in autofile_fuzz_target(Span<unsigned char const>)::$_3::operator()() const src/test/fuzz/autofile.cpp:50:17\r\n    #10 0x55cd51accacc in unsigned long CallOneOf<autofile_fuzz_target(Span<unsigned char const>)::$_0, autofile_fuzz_target(Span<unsigned char const>)::$_1, autofile_fuzz_target(Span<unsigned char const>)::$_2, autofile_fuzz_target(Span<unsigned char const>)::$_3, autofile_fuzz_target(Span<unsigned char const>)::$_4, autofile_fuzz_target(Span<unsigned char const>)::$_5>(FuzzedDataProvider&, autofile_fuzz_target(Span<unsigned char const>)::$_0, autofile_fuzz_target(Span<unsigned char const>)::$_1, autofile_fuzz_target(Span<unsigned char const>)::$_2, autofile_fuzz_target(Span<unsigned char const>)::$_3, autofile_fuzz_target(Span<unsigned char const>)::$_4, autofile_fuzz_target(Span<unsigned char const>)::$_5) src/./test/fuzz/util.h:42:27\r\n    #11 0x55cd51accacc in autofile_fuzz_target(Span<unsigned char const>) src/test/fuzz/autofile.cpp:27:9\r\n    #12 0x55cd5204a52c in std::function<void (Span<unsigned char const>)>::operator()(Span<unsigned char const>) const /usr/bin/../lib/gcc/x86_64-linux-gnu/13/../../../../include/c++/13/bits/std_function.h:591:9\r\n    #13 0x55cd5204a52c in LLVMFuzzerTestOneInput src/test/fuzz/fuzz.cpp:178:5\r\n    #14 0x55cd51879814 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x199e814) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #15 0x55cd51878f09 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x199df09) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #16 0x55cd5187aaf6 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x199faf6) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #17 0x55cd5187b017 in fuzzer::Fuzzer::Loop(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile>>&) (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x19a0017) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #18 0x55cd5186875b in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x198d75b) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #19 0x55cd51892ce6 in main (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x19b7ce6) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\n    #20 0x7fb162f030cf  (/lib/x86_64-linux-gnu/libc.so.6+0x280cf) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #21 0x7fb162f03188 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x28188) (BuildId: f0b834daa3d05a80967e9ec2f990a1ea71c958fa)\r\n    #22 0x55cd5185d624 in _start (/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz+0x1982624) (BuildId: 34c8e9fbac2706ae466ade7d359adebec5d82bcf)\r\nNOTE: libFuzzer has rudimentary signal handlers.\r\n      Combine libFuzzer with AddressSanitizer or similar for better crash reports.\r\nSUMMARY: libFuzzer: deadly signal\r\nMS: 0 ; base unit: 0000000000000000000000000000000000000000\r\nartifact_prefix='./'; Test unit written to ./crash-276f4f9d3e6ba98f897bd1082aec7214ca8e4f5d\r\nTarget ['/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/test/fuzz/fuzz', '-runs=1', PosixPath('/ci_container_base/ci/scratch/qa-assets/fuzz_seed_corpus/autofile')] failed with exit code 77\r\n```\r\n\r\nNo base64 of the unit in the output, I guess I cannot access `./crash-276f4f9d3e6ba98f897bd1082aec7214ca8e4f5d` and I cannot reproduce by running `FUZZ=autofile ./src/test/fuzz/fuzz -runs=1000000 .../qa-assets/fuzz_seed_corpus/autofile` locally. Maybe the CI machine ran out of disk space?",
      "created_at": "2024-01-24T17:18:04Z",
      "updated_at": "2024-01-24T17:18:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1465295573",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465295573"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 50,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465997866",
      "pull_request_review_id": 1843087352,
      "id": 1465997866,
      "node_id": "PRRC_kwDOABII585XYVoq",
      "diff_hunk": "@@ -47,7 +47,7 @@ FUZZ_TARGET(autofile)\n                 }\n             },\n             [&] {\n-                auto_file.fclose();\n+                assert(auto_file.fclose() == 0);",
      "path": "src/test/fuzz/autofile.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "7c58f6ea4f603b570b7d8532aa9bb59df069d6cb",
      "in_reply_to_id": 1465295573,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I realized that `auto_file` used in this fuzz test is not associated with a regular file on the filesystem, but with a \"cookie\" returned by `fuzzed_file_provider.open()` returned by `fopencookie(3)` which uses a custom close function `FuzzedFileProvider::close()` which can arbitrarily return `-1`:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/207220ce8b767d8efdb5abf042ecf23d846ded73/src/test/fuzz/util.cpp#L352\r\n\r\nchanged this to ignore the return value of `auto_file.fclose()`.",
      "created_at": "2024-01-25T08:22:13Z",
      "updated_at": "2024-01-25T08:22:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1465997866",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1465997866"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 50,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466018964",
      "pull_request_review_id": 1843121558,
      "id": 1466018964,
      "node_id": "PRRC_kwDOABII585XYayU",
      "diff_hunk": "@@ -4,14 +4,20 @@\n \n #include <span.h>\n #include <streams.h>\n+#include <tinyformat.h>\n+#include <util/syserror.h>\n \n #include <array>\n \n std::size_t AutoFile::detail_fread(Span<std::byte> dst)\n {\n     if (!m_file) throw std::ios_base::failure(\"AutoFile::read: file handle is nullptr\");\n     if (m_xor.empty()) {\n-        return std::fread(dst.data(), 1, dst.size(), m_file);\n+        const auto n = std::fread(dst.data(), 1, dst.size(), m_file);\n+        if (ferror(m_file)) {\n+            throw std::ios_base::failure(strprintf(\"AutoFile::detail_fread: %s\", SysErrorString(errno)));",
      "path": "src/streams.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "7c58f6ea4f603b570b7d8532aa9bb59df069d6cb",
      "in_reply_to_id": 1465152180,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Alright, moved to the caller.\r\n\r\nIMO this is a bugfix, but I am not 100% sure either. Might as well be viewed as \"belt-and-suspenders\". What is certain is that it can't hurt even if there is never an error on any platform if `detail_fread(dst) == dst.size()`. A unit test would require simulating an IO error under the `fread(3)` call and identically behaving `fread(3)` on all platforms.",
      "created_at": "2024-01-25T08:40:10Z",
      "updated_at": "2024-01-25T08:40:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1466018964",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1466018964"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 18,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1599815167",
      "pull_request_review_id": 2055001995,
      "id": 1599815167,
      "node_id": "PRRC_kwDOABII585fWz3_",
      "diff_hunk": "@@ -23,8 +25,9 @@ std::size_t AutoFile::detail_fread(Span<std::byte> dst)\n \n void AutoFile::read(Span<std::byte> dst)\n {\n-    if (detail_fread(dst) != dst.size()) {\n-        throw std::ios_base::failure(feof() ? \"AutoFile::read: end of file\" : \"AutoFile::read: fread failed\");\n+    if (detail_fread(dst) != dst.size() || ferror(m_file)) {",
      "path": "src/streams.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "de23848eed5437f5e4dc6ccdc38b40cc58738ead",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "de23848eed5437f5e4dc6ccdc38b40cc58738ead: I still don't understand this. Why would fread succeed to read the requested number of bytes, but then mark the stream with an error? If the goal is to somehow detect errors after the read succeeded, I am not sure this should be a goal. Otherwise, it would be good to explain what real user-facing bug this fixes or introduces.\r\n\r\nEither this is a refactor, in which case it seems pointless, or it is a behavior change, in which case it needs to explain why it beneficial and correct.",
      "created_at": "2024-05-14T10:57:05Z",
      "updated_at": "2024-05-14T10:57:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1599815167",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1599815167"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1599959087",
      "pull_request_review_id": 2055243360,
      "id": 1599959087,
      "node_id": "PRRC_kwDOABII585fXXAv",
      "diff_hunk": "@@ -23,8 +25,9 @@ std::size_t AutoFile::detail_fread(Span<std::byte> dst)\n \n void AutoFile::read(Span<std::byte> dst)\n {\n-    if (detail_fread(dst) != dst.size()) {\n-        throw std::ios_base::failure(feof() ? \"AutoFile::read: end of file\" : \"AutoFile::read: fread failed\");\n+    if (detail_fread(dst) != dst.size() || ferror(m_file)) {",
      "path": "src/streams.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "de23848eed5437f5e4dc6ccdc38b40cc58738ead",
      "in_reply_to_id": 1599815167,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This was somewhat answered in https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1465152180 above but let me elaborate - the thing that prompted me to do this change is this text from the `fread(3)` manual page:\r\n\r\n> The function fread() does not distinguish between end-of-file and error,\r\n> and callers must use feof(3) and ferror(3) to determine which occurred.\r\n\r\nI think checking for `ferror(3)` after `fread(3)` is a kind of harmless \"belt-and-suspenders\". If you are sure that if `detail_fread(dst) == dst.size()` then `ferror(m_file)` will always be `false` or feel strongly against this then I could drop the commit de23848eed `util: check for error after reading from a file`.",
      "created_at": "2024-05-14T12:39:28Z",
      "updated_at": "2024-05-14T12:39:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1599959087",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1599959087"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1601592294",
      "pull_request_review_id": 2057928541,
      "id": 1601592294,
      "node_id": "PRRC_kwDOABII585fdlvm",
      "diff_hunk": "@@ -213,6 +218,7 @@ bool DumpMempool(const CTxMemPool& pool, const fs::path& dump_path, FopenFn mock\n                   fs::file_size(dump_path));\n     } catch (const std::exception& e) {\n         LogInfo(\"Failed to dump mempool: %s. Continuing anyway.\\n\", e.what());\n+        (void)file.fclose();",
      "path": "src/kernel/mempool_persist.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "f9cf6b516b796461feb059729d2ab3737ad01ccc",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Not sure I understand this change either. This seems to be mixing the third alternative in the pull request description with the approach you wanted to take?\r\n\r\n> Defeats the purpose of a RAII wrapper for FILE* which automatically closes the file when it goes out of scope and there are a lot of users of AutoFile.",
      "created_at": "2024-05-15T12:54:07Z",
      "updated_at": "2024-05-15T12:54:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1601592294",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1601592294"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 221,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1611668338",
      "pull_request_review_id": 2073928975,
      "id": 1611668338,
      "node_id": "PRRC_kwDOABII585gEBty",
      "diff_hunk": "@@ -213,6 +218,7 @@ bool DumpMempool(const CTxMemPool& pool, const fs::path& dump_path, FopenFn mock\n                   fs::file_size(dump_path));\n     } catch (const std::exception& e) {\n         LogInfo(\"Failed to dump mempool: %s. Continuing anyway.\\n\", e.what());\n+        (void)file.fclose();",
      "path": "src/kernel/mempool_persist.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "f9cf6b516b796461feb059729d2ab3737ad01ccc",
      "in_reply_to_id": 1601592294,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "It is best if all users of `AutoFile` explicitly call the `fclose()` method and check that it succeeds (option 3. from PR description). This is not feasible because there are many users of `AutoFile`. However, some of those users already do call the `fclose()` method explicitly. For those users it is easy and I added checks whether `fclose()` succeeds. `DumpMempool()` is such a user and the change is:\r\n\r\n```diff\r\n             throw std::runtime_error(\"FileCommit failed\");\r\n-        file.fclose();           \r\n+        if (file.fclose() != 0) {    \r\n+            throw std::runtime_error(\r\n+                strprintf(\"Error closing %s: %s\", fs::PathToString(file_fspath), SysErrorString(errno)));\r\n+        }\r\n         if (!RenameOver(dump_path + \".new\", dump_path)) {\r\n```\r\n\r\nFor consistency in `DumpMempool()` I changed all code paths in that function to explicitly call `fclose()`. There are two codepaths and this added `(void)file.fclose();` is the other one. I ignore the return value because this is already failure handling and the function is going to return `false`. I didn't want to do something like \"while handling error1, error2 occurred\".",
      "created_at": "2024-05-23T13:11:26Z",
      "updated_at": "2024-05-23T13:11:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1611668338",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1611668338"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 221,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1612065514",
      "pull_request_review_id": 2074608095,
      "id": 1612065514,
      "node_id": "PRRC_kwDOABII585gFirq",
      "diff_hunk": "@@ -383,26 +385,42 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then avoid relying on the destructor\n+ * to close the file. It is better to instead explicitly close the file using\n+ * the `fclose()` method, check if it returns an error and treat such an error\n+ * as if the `write()` method has failed. The OS's `fclose(3)` may fail to flush\n+ * to disk data that has been previously written, rendering the file corrupt.\n+ * There is no way to signal a failure from the destructor to the caller, thus\n+ * this destructor will try to close the file and if an error occurs, it will\n+ * log a message and terminate the program.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n+    bool m_was_written{false};\n \n public:\n     explicit AutoFile(std::FILE* file, std::vector<std::byte> data_xor={}) : m_file{file}, m_xor{std::move(data_xor)} {}\n \n-    ~AutoFile() { fclose(); }\n+    ~AutoFile()\n+    {\n+        if (fclose() != 0 && m_was_written) {\n+            LogPrintLevel(BCLog::ALL, BCLog::Level::Error, \"Error closing file: %s\\n\", SysErrorString(errno));\n+            std::abort();",
      "path": "src/streams.h",
      "position": null,
      "original_position": 44,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "de23848eed5437f5e4dc6ccdc38b40cc58738ead",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "not sure about unconditionally crashing the node on any failure here. This may or may not be an issue, so the call site will have to decide about this.\r\n\r\nFor example, If an RPC user dumps the mempool to an external (corrupt) USB thumb drive, a failure shouldn't crash the node, but notify the user over the RPC.\r\n\r\nAlso, I am not sure about involving logging in this low-level code. Logging may not be set up, so this may never be printed before the crash.\r\n\r\nAlso, I am not sure about the log message. It just says that there was an error, but not whose fault it was or what should be done about it.\r\n\r\nA better solution overall may be to just call `if (m_was_written) Assume(IsNull());`. This should highlight all violating call sites during CI, because the test should be deterministic. (If there is a code path that is not deterministically tested, all hopes are lost anyway, and I don't think the solution should be to crash the users node completely and without considering the context?)",
      "created_at": "2024-05-23T17:22:44Z",
      "updated_at": "2024-05-23T17:22:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1612065514",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1612065514"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": 409,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1612068360",
      "pull_request_review_id": 2074612715,
      "id": 1612068360,
      "node_id": "PRRC_kwDOABII585gFjYI",
      "diff_hunk": "@@ -213,6 +218,7 @@ bool DumpMempool(const CTxMemPool& pool, const fs::path& dump_path, FopenFn mock\n                   fs::file_size(dump_path));\n     } catch (const std::exception& e) {\n         LogInfo(\"Failed to dump mempool: %s. Continuing anyway.\\n\", e.what());\n+        (void)file.fclose();",
      "path": "src/kernel/mempool_persist.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "f9cf6b516b796461feb059729d2ab3737ad01ccc",
      "in_reply_to_id": 1601592294,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Oh, now I see this is required, because otherwise the node would crash on this error instead of continuing with the current code, if this was missing?\r\n\r\nNot sure this is desirable, see also https://github.com/bitcoin/bitcoin/pull/29307/files#r1612065514",
      "created_at": "2024-05-23T17:25:26Z",
      "updated_at": "2024-05-23T17:25:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1612068360",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1612068360"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 221,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1612076482",
      "pull_request_review_id": 2074627478,
      "id": 1612076482,
      "node_id": "PRRC_kwDOABII585gFlXC",
      "diff_hunk": "@@ -23,8 +25,9 @@ std::size_t AutoFile::detail_fread(Span<std::byte> dst)\n \n void AutoFile::read(Span<std::byte> dst)\n {\n-    if (detail_fread(dst) != dst.size()) {\n-        throw std::ios_base::failure(feof() ? \"AutoFile::read: end of file\" : \"AutoFile::read: fread failed\");\n+    if (detail_fread(dst) != dst.size() || ferror(m_file)) {",
      "path": "src/streams.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "de23848eed5437f5e4dc6ccdc38b40cc58738ead",
      "in_reply_to_id": 1599815167,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> If you are sure that if detail_fread(dst) == dst.size() then ferror(m_file) will always be false or feel strongly against this then I could drop the commit https://github.com/bitcoin/bitcoin/commit/de23848eed5437f5e4dc6ccdc38b40cc58738ead util: check for error after reading from a file.\r\n\r\nI don't feel strongly in one way or another. I am just saying that with the currently available information, it is not possible to confidently review this and know it is a good change. At a minimum, it should be clear whether this is a refactor or a behavior change, and what user-facing bug this could possibly prevent or fix. (I can't think of one, but maybe I am missing something?)",
      "created_at": "2024-05-23T17:32:46Z",
      "updated_at": "2024-05-23T17:32:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1612076482",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1612076482"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1647059893",
      "pull_request_review_id": 2129580372,
      "id": 1647059893,
      "node_id": "PRRC_kwDOABII585iLCO1",
      "diff_hunk": "@@ -23,8 +25,9 @@ std::size_t AutoFile::detail_fread(Span<std::byte> dst)\n \n void AutoFile::read(Span<std::byte> dst)\n {\n-    if (detail_fread(dst) != dst.size()) {\n-        throw std::ios_base::failure(feof() ? \"AutoFile::read: end of file\" : \"AutoFile::read: fread failed\");\n+    if (detail_fread(dst) != dst.size() || ferror(m_file)) {",
      "path": "src/streams.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "de23848eed5437f5e4dc6ccdc38b40cc58738ead",
      "in_reply_to_id": 1599815167,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Well, it is pretty much obvious that checking for an error after read is either:\r\n\r\n* a noop, if the read could have never failed because it managed to read as many bytes as requested or\r\n* a bug fix where a read error was ignored before the fix\r\n\r\nso this is a safe change (it does not break anything), possibly fixing a bug. Given that you keep pushing against this I will drop this commit in the hopes to move this PR forward.",
      "created_at": "2024-06-20T07:00:29Z",
      "updated_at": "2024-06-20T07:00:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1647059893",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1647059893"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1647069077",
      "pull_request_review_id": 2129595246,
      "id": 1647069077,
      "node_id": "PRRC_kwDOABII585iLEeV",
      "diff_hunk": "@@ -23,8 +25,9 @@ std::size_t AutoFile::detail_fread(Span<std::byte> dst)\n \n void AutoFile::read(Span<std::byte> dst)\n {\n-    if (detail_fread(dst) != dst.size()) {\n-        throw std::ios_base::failure(feof() ? \"AutoFile::read: end of file\" : \"AutoFile::read: fread failed\");\n+    if (detail_fread(dst) != dst.size() || ferror(m_file)) {",
      "path": "src/streams.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "de23848eed5437f5e4dc6ccdc38b40cc58738ead",
      "in_reply_to_id": 1599815167,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "No, I don't understand why a \"read error was ignored before the fix\" and why \"this is a safe change (it does not break anything)\". For example, if this was hit on a filesystem that stored a block file, which was fully and successfully read, but then return an error (for an unknown reason), this would mean that for a user where the program previously worked fine without any issues, is now unusable (for an unknown reason).\r\n\r\n",
      "created_at": "2024-06-20T07:08:39Z",
      "updated_at": "2024-06-20T07:08:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1647069077",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1647069077"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1647164965",
      "pull_request_review_id": 2129750821,
      "id": 1647164965,
      "node_id": "PRRC_kwDOABII585iLb4l",
      "diff_hunk": "@@ -23,8 +25,9 @@ std::size_t AutoFile::detail_fread(Span<std::byte> dst)\n \n void AutoFile::read(Span<std::byte> dst)\n {\n-    if (detail_fread(dst) != dst.size()) {\n-        throw std::ios_base::failure(feof() ? \"AutoFile::read: end of file\" : \"AutoFile::read: fread failed\");\n+    if (detail_fread(dst) != dst.size() || ferror(m_file)) {",
      "path": "src/streams.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "de23848eed5437f5e4dc6ccdc38b40cc58738ead",
      "in_reply_to_id": 1599815167,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I just found a similar code to this proposed change:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/2d21060af831fa8f8f1791b4464961d5f28a88cb/src/node/utxo_snapshot.cpp#L74-L80\r\n\r\nAfter reading from a file and getting everything that is needed from it, the code checks if there is an extra data and if that read fails it reports an error.",
      "created_at": "2024-06-20T08:14:51Z",
      "updated_at": "2024-06-20T08:14:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1647164965",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1647164965"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1647191325",
      "pull_request_review_id": 2129792749,
      "id": 1647191325,
      "node_id": "PRRC_kwDOABII585iLiUd",
      "diff_hunk": "@@ -23,8 +25,9 @@ std::size_t AutoFile::detail_fread(Span<std::byte> dst)\n \n void AutoFile::read(Span<std::byte> dst)\n {\n-    if (detail_fread(dst) != dst.size()) {\n-        throw std::ios_base::failure(feof() ? \"AutoFile::read: end of file\" : \"AutoFile::read: fread failed\");\n+    if (detail_fread(dst) != dst.size() || ferror(m_file)) {",
      "path": "src/streams.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "de23848eed5437f5e4dc6ccdc38b40cc58738ead",
      "in_reply_to_id": 1599815167,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "The code you linked to is primarily checking for unexpected trailing data and only printing a warning. It is not making the program possibly unusable.",
      "created_at": "2024-06-20T08:30:38Z",
      "updated_at": "2024-06-20T08:30:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1647191325",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1647191325"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1647331068",
      "pull_request_review_id": 2130015446,
      "id": 1647331068,
      "node_id": "PRRC_kwDOABII585iMEb8",
      "diff_hunk": "@@ -23,8 +25,9 @@ std::size_t AutoFile::detail_fread(Span<std::byte> dst)\n \n void AutoFile::read(Span<std::byte> dst)\n {\n-    if (detail_fread(dst) != dst.size()) {\n-        throw std::ios_base::failure(feof() ? \"AutoFile::read: end of file\" : \"AutoFile::read: fread failed\");\n+    if (detail_fread(dst) != dst.size() || ferror(m_file)) {",
      "path": "src/streams.cpp",
      "position": null,
      "original_position": 15,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "de23848eed5437f5e4dc6ccdc38b40cc58738ead",
      "in_reply_to_id": 1599815167,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think I see your point, you prefer 1. over 2., assuming we got all the bytes we asked for from a read, then:\r\n\r\n1. Ignore possible IO error by not checking for it\r\n2. Check for an error and behave as if the read failed\r\n\r\nI dropped this change.",
      "created_at": "2024-06-20T10:05:51Z",
      "updated_at": "2024-06-20T10:05:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1647331068",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1647331068"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1647333555",
      "pull_request_review_id": 2130019353,
      "id": 1647333555,
      "node_id": "PRRC_kwDOABII585iMFCz",
      "diff_hunk": "@@ -383,26 +385,42 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then avoid relying on the destructor\n+ * to close the file. It is better to instead explicitly close the file using\n+ * the `fclose()` method, check if it returns an error and treat such an error\n+ * as if the `write()` method has failed. The OS's `fclose(3)` may fail to flush\n+ * to disk data that has been previously written, rendering the file corrupt.\n+ * There is no way to signal a failure from the destructor to the caller, thus\n+ * this destructor will try to close the file and if an error occurs, it will\n+ * log a message and terminate the program.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n+    bool m_was_written{false};\n \n public:\n     explicit AutoFile(std::FILE* file, std::vector<std::byte> data_xor={}) : m_file{file}, m_xor{std::move(data_xor)} {}\n \n-    ~AutoFile() { fclose(); }\n+    ~AutoFile()\n+    {\n+        if (fclose() != 0 && m_was_written) {\n+            LogPrintLevel(BCLog::ALL, BCLog::Level::Error, \"Error closing file: %s\\n\", SysErrorString(errno));\n+            std::abort();",
      "path": "src/streams.h",
      "position": null,
      "original_position": 44,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "de23848eed5437f5e4dc6ccdc38b40cc58738ead",
      "in_reply_to_id": 1612065514,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> if (m_was_written) Assume(IsNull());\r\n\r\nDone.",
      "created_at": "2024-06-20T10:07:47Z",
      "updated_at": "2024-06-20T10:07:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1647333555",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1647333555"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": 409,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1647335718",
      "pull_request_review_id": 2130023020,
      "id": 1647335718,
      "node_id": "PRRC_kwDOABII585iMFkm",
      "diff_hunk": "@@ -213,6 +218,7 @@ bool DumpMempool(const CTxMemPool& pool, const fs::path& dump_path, FopenFn mock\n                   fs::file_size(dump_path));\n     } catch (const std::exception& e) {\n         LogInfo(\"Failed to dump mempool: %s. Continuing anyway.\\n\", e.what());\n+        (void)file.fclose();",
      "path": "src/kernel/mempool_persist.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "f9cf6b516b796461feb059729d2ab3737ad01ccc",
      "in_reply_to_id": 1601592294,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Resolving this discussion. Changed the semantic of `AutoFile` to require all write users to call `fclose()`.",
      "created_at": "2024-06-20T10:09:35Z",
      "updated_at": "2024-06-20T10:09:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1647335718",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1647335718"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 221,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1748968105",
      "pull_request_review_id": 2288411339,
      "id": 1748968105,
      "node_id": "PRRC_kwDOABII585oPyKp",
      "diff_hunk": "@@ -61,25 +62,28 @@ bool SerializeFileDB(const std::string& prefix, const fs::path& path, const Data\n     FILE *file = fsbridge::fopen(pathTmp, \"wb\");\n     AutoFile fileout{file};\n     if (fileout.IsNull()) {\n-        fileout.fclose();\n         remove(pathTmp);\n         LogError(\"%s: Failed to open file %s\\n\", __func__, fs::PathToString(pathTmp));\n         return false;\n     }\n \n     // Serialize\n     if (!SerializeDB(fileout, data)) {\n-        fileout.fclose();\n+        (void)fileout.fclose();\n         remove(pathTmp);\n         return false;\n     }\n     if (!FileCommit(fileout.Get())) {\n-        fileout.fclose();\n+        (void)fileout.fclose();\n         remove(pathTmp);\n         LogError(\"%s: Failed to flush file %s\\n\", __func__, fs::PathToString(pathTmp));\n         return false;\n     }\n-    fileout.fclose();\n+    if (fileout.fclose() != 0) {\n+        remove(pathTmp);\n+        LogError(\"%s: Failed to close file %s: %s\\n\", __func__, fs::PathToString(pathTmp), SysErrorString(errno));",
      "path": "src/addrdb.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "489c2477e7c0b2b433551362c61079cf6d3ef510",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Less error-prone to use the error value returned from `fclose()` rather than relying on global `errno` which might have been mutated by `remove()` etc.\r\n```suggestion\r\n    if (int err{fileout.fclose()}; err != 0) {\r\n        remove(pathTmp);\r\n        LogError(\"Failed to close file %s: %s\", fs::PathToString(pathTmp), SysErrorString(err));\r\n```\r\n(Also dropped pre-`-logsourcelocations` `__func__` and removed superfluous newline).",
      "created_at": "2024-09-07T21:07:50Z",
      "updated_at": "2025-01-22T10:56:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1748968105",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1748968105"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": 82,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1748972711",
      "pull_request_review_id": 2288411339,
      "id": 1748972711,
      "node_id": "PRRC_kwDOABII585oPzSn",
      "diff_hunk": "@@ -229,6 +229,12 @@ size_t BlockFilterIndex::WriteFilterToDisk(FlatFilePos& pos, const BlockFilter&\n     }\n \n     fileout << filter.GetBlockHash() << filter.GetEncodedFilter();\n+\n+    if (fileout.fclose() != 0) {\n+        LogPrintf(\"%s: Failed to close filter file %d\\n\", __func__, pos.nFile);",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "489c2477e7c0b2b433551362c61079cf6d3ef510",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Could use `SystemErr(err)` here?\r\n```suggestion\r\n    if (int err{fileout.fclose()}; err != 0) {\r\n        LogPrintf(\"Failed to close filter file %d: %s\", pos.nFile, SysErrorString(err));\r\n```\r\nCould be done in other files too (*net.cpp*, *blockstorage.cpp*). (I can understand not wanting to do it further above in this specific file though).",
      "created_at": "2024-09-07T21:31:55Z",
      "updated_at": "2025-01-22T21:26:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1748972711",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1748972711"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": 233,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 234,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1748973642",
      "pull_request_review_id": 2288411339,
      "id": 1748973642,
      "node_id": "PRRC_kwDOABII585oPzhK",
      "diff_hunk": "@@ -28,7 +28,7 @@ static void FindByte(benchmark::Bench& bench)\n     });\n \n     // Cleanup\n-    file.fclose();\n+    (void)file.fclose();",
      "path": "src/bench/streams_findbyte.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "489c2477e7c0b2b433551362c61079cf6d3ef510",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Rather than silence errors, it might be good to at least assert against errors here and elsewhere in benchmarks/tests as we want to ensure we are benchmarking/testing properly? (Not for some fuzz-cases though [as you already found out](https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1465997866)).\r\n```suggestion\r\n    assert(file.fclose() != 0);\r\n```\r\nThat's already how you handled *src/wallet/test/fuzz/wallet_bdb_parser.cpp*.",
      "created_at": "2024-09-07T21:35:16Z",
      "updated_at": "2025-01-22T10:56:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1748973642",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1748973642"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 31,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1924262048",
      "pull_request_review_id": 2288411339,
      "id": 1924262048,
      "node_id": "PRRC_kwDOABII585yseig",
      "diff_hunk": "@@ -950,7 +950,7 @@ void CBlockPolicyEstimator::Flush() {\n void CBlockPolicyEstimator::FlushFeeEstimates()\n {\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"wb\")};\n-    if (est_file.IsNull() || !Write(est_file)) {\n+    if (est_file.IsNull() || !Write(est_file) || est_file.fclose() != 0) {\n         LogPrintf(\"Failed to write fee estimates to %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));",
      "path": "src/policy/fees.cpp",
      "position": 11,
      "original_position": 6,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "dba783538683cfc6af209c640c2d019648493f31",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: Might take the opportunity to improve grammar and modernize log:\r\n```suggestion\r\n        LogWarning(\"Failed to write fee estimates to %s. Continuing anyway.\", fs::PathToString(m_estimation_filepath));\r\n```",
      "created_at": "2025-01-21T19:28:54Z",
      "updated_at": "2025-01-22T10:56:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1924262048",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1924262048"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 958,
      "original_line": 958,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1924324131",
      "pull_request_review_id": 2288411339,
      "id": 1924324131,
      "node_id": "PRRC_kwDOABII585ystsj",
      "diff_hunk": "@@ -47,6 +47,7 @@\n #include <util/check.h>\n #include <util/fs.h>\n #include <util/strencodings.h>\n+#include <util/syserror.h>\n #include <util/translation.h>\n #include <validation.h>\n #include <validationinterface.h>",
      "path": "src/rpc/blockchain.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "dba783538683cfc6af209c640c2d019648493f31",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Should also explicitly `fclose()` `afile` from line 2790/2791.\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/dba783538683cfc6af209c640c2d019648493f31/src/rpc/blockchain.cpp#L2790-L2791",
      "created_at": "2025-01-21T20:27:16Z",
      "updated_at": "2025-01-22T10:56:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r1924324131",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1924324131"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 53,
      "original_line": 53,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042033291",
      "pull_request_review_id": 2764166358,
      "id": 2042033291,
      "node_id": "PRRC_kwDOABII5855tvSL",
      "diff_hunk": "@@ -47,6 +47,7 @@\n #include <util/check.h>\n #include <util/fs.h>\n #include <util/strencodings.h>\n+#include <util/syserror.h>\n #include <util/translation.h>\n #include <validation.h>\n #include <validationinterface.h>",
      "path": "src/rpc/blockchain.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "dba783538683cfc6af209c640c2d019648493f31",
      "in_reply_to_id": 1924324131,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "It is being closed inside `WriteUTXOSnapshot()`.",
      "created_at": "2025-04-14T12:24:33Z",
      "updated_at": "2025-04-14T12:24:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2042033291",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042033291"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 53,
      "original_line": 53,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042037331",
      "pull_request_review_id": 2764173227,
      "id": 2042037331,
      "node_id": "PRRC_kwDOABII5855twRT",
      "diff_hunk": "@@ -61,25 +62,28 @@ bool SerializeFileDB(const std::string& prefix, const fs::path& path, const Data\n     FILE *file = fsbridge::fopen(pathTmp, \"wb\");\n     AutoFile fileout{file};\n     if (fileout.IsNull()) {\n-        fileout.fclose();\n         remove(pathTmp);\n         LogError(\"%s: Failed to open file %s\\n\", __func__, fs::PathToString(pathTmp));\n         return false;\n     }\n \n     // Serialize\n     if (!SerializeDB(fileout, data)) {\n-        fileout.fclose();\n+        (void)fileout.fclose();\n         remove(pathTmp);\n         return false;\n     }\n     if (!FileCommit(fileout.Get())) {\n-        fileout.fclose();\n+        (void)fileout.fclose();\n         remove(pathTmp);\n         LogError(\"%s: Failed to flush file %s\\n\", __func__, fs::PathToString(pathTmp));\n         return false;\n     }\n-    fileout.fclose();\n+    if (fileout.fclose() != 0) {\n+        remove(pathTmp);\n+        LogError(\"%s: Failed to close file %s: %s\\n\", __func__, fs::PathToString(pathTmp), SysErrorString(errno));",
      "path": "src/addrdb.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "489c2477e7c0b2b433551362c61079cf6d3ef510",
      "in_reply_to_id": 1748968105,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done. Note however that `fclose()` returns either `0` or `EOF` (`-1`). It does not return the error code.",
      "created_at": "2025-04-14T12:27:15Z",
      "updated_at": "2025-04-14T12:27:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2042037331",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042037331"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": 82,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042038655",
      "pull_request_review_id": 2764175312,
      "id": 2042038655,
      "node_id": "PRRC_kwDOABII5855twl_",
      "diff_hunk": "@@ -229,6 +229,12 @@ size_t BlockFilterIndex::WriteFilterToDisk(FlatFilePos& pos, const BlockFilter&\n     }\n \n     fileout << filter.GetBlockHash() << filter.GetEncodedFilter();\n+\n+    if (fileout.fclose() != 0) {\n+        LogPrintf(\"%s: Failed to close filter file %d\\n\", __func__, pos.nFile);",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "489c2477e7c0b2b433551362c61079cf6d3ef510",
      "in_reply_to_id": 1748972711,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done, modulo `fclose()` does not return the error code which is to be found in `errno`.",
      "created_at": "2025-04-14T12:28:03Z",
      "updated_at": "2025-04-14T12:28:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2042038655",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042038655"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": 233,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 234,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042039473",
      "pull_request_review_id": 2764176584,
      "id": 2042039473,
      "node_id": "PRRC_kwDOABII5855twyx",
      "diff_hunk": "@@ -28,7 +28,7 @@ static void FindByte(benchmark::Bench& bench)\n     });\n \n     // Cleanup\n-    file.fclose();\n+    (void)file.fclose();",
      "path": "src/bench/streams_findbyte.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "489c2477e7c0b2b433551362c61079cf6d3ef510",
      "in_reply_to_id": 1748973642,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done, but it should be `==`, not `!=`.",
      "created_at": "2025-04-14T12:28:34Z",
      "updated_at": "2025-04-14T12:28:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2042039473",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042039473"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 31,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042039708",
      "pull_request_review_id": 2764177019,
      "id": 2042039708,
      "node_id": "PRRC_kwDOABII5855tw2c",
      "diff_hunk": "@@ -950,7 +950,7 @@ void CBlockPolicyEstimator::Flush() {\n void CBlockPolicyEstimator::FlushFeeEstimates()\n {\n     AutoFile est_file{fsbridge::fopen(m_estimation_filepath, \"wb\")};\n-    if (est_file.IsNull() || !Write(est_file)) {\n+    if (est_file.IsNull() || !Write(est_file) || est_file.fclose() != 0) {\n         LogPrintf(\"Failed to write fee estimates to %s. Continue anyway.\\n\", fs::PathToString(m_estimation_filepath));",
      "path": "src/policy/fees.cpp",
      "position": 11,
      "original_position": 6,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "dba783538683cfc6af209c640c2d019648493f31",
      "in_reply_to_id": 1924262048,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2025-04-14T12:28:45Z",
      "updated_at": "2025-04-14T12:28:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2042039708",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042039708"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 958,
      "original_line": 958,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048425590",
      "pull_request_review_id": 2774890658,
      "id": 2048425590,
      "node_id": "PRRC_kwDOABII5856GH52",
      "diff_hunk": "@@ -1093,13 +1103,26 @@ FlatFilePos BlockManager::WriteBlock(const CBlock& block, int nHeight)\n         m_opts.notifications.fatalError(_(\"Failed to write block.\"));\n         return FlatFilePos();\n     }\n-    BufferedWriter fileout{file};\n+    {\n+        BufferedWriter fileout{file};\n+\n+        // Write index header\n+        fileout << GetParams().MessageStart() << block_size;\n+        pos.nPos += STORAGE_HEADER_BYTES;\n+        // Write block\n+        fileout << TX_WITH_WITNESS(block);\n+    }\n+\n+    if (file.fclose() != 0) {\n+        LogPrintLevel(BCLog::BLOCKSTORAGE,\n+                      BCLog::Level::Error,\n+                      \"Failed to close block file %s: %s\",\n+                      pos.ToString(),\n+                      SysErrorString(errno));\n+        m_opts.notifications.fatalError(_(\"Failed close file when writing block.\"));",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 63,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "0e97a68e13ded93f3908f72c0b38083b6de991d3",
      "in_reply_to_id": null,
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "(âœ¨ LLM generated, experimental)\r\n\r\n    â€œFailed close file when writing block.â€ â†’ â€œFailed to close file when writing block.â€\r\n",
      "created_at": "2025-04-17T07:46:23Z",
      "updated_at": "2025-04-17T07:46:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048425590",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048425590"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1122,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048480671",
      "pull_request_review_id": 2774978391,
      "id": 2048480671,
      "node_id": "PRRC_kwDOABII5856GVWf",
      "diff_hunk": "@@ -4012,6 +4012,11 @@ static void CaptureMessageToFile(const CAddress& addr,\n     uint32_t size = data.size();\n     ser_writedata32(f, size);\n     f << data;\n+\n+    if (f.fclose() != 0) {\n+        throw std::ios_base::failure(\n+            strprintf(\"Error closing %s after write, file contents is likely incomplete\", fs::PathToString(path)));",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 7,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "1f71111e2115ba3504b6585e16df54e5615dd3f9",
      "in_reply_to_id": null,
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": " (âœ¨ LLM generated, experimental)\r\n\r\nfile contents is likely incomplete â‡’ file contents are likely incomplete",
      "created_at": "2025-04-17T08:22:13Z",
      "updated_at": "2025-04-17T08:22:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048480671",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048480671"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4018,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048729097",
      "pull_request_review_id": 2775379592,
      "id": 2048729097,
      "node_id": "PRRC_kwDOABII5856HSAJ",
      "diff_hunk": "@@ -151,7 +151,7 @@ bool BlockFilterIndex::CustomCommit(CDBBatch& batch)\n         LogError(\"%s: Failed to open filter file %d\\n\", __func__, pos.nFile);\n         return false;\n     }\n-    if (!file.Commit()) {\n+    if (!file.Commit() || file.fclose() != 0) {",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "1f71111e2115ba3504b6585e16df54e5615dd3f9",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "If we can't fully commit to disk, we won't call `fclose` directly - we'll rely on the destructor's close.\r\nWe'd get a commitment failure message (though that could have been successful) - and maybe another message from the destructor.\r\n\r\nCould we separate the two errors?\r\n```C++\r\nif (!file.Commit()) {\r\n    LogError(\"%s: Failed to commit filter file %d\", __func__, pos.nFile);\r\n    return false;\r\n}\r\nif (file.fclose()) {\r\n    LogError(\"%s: Failed to close filter file %d\", __func__, pos.nFile);\r\n    return false;\r\n}\r\n```\r\n\r\nor unify them to a single error like we're doing in https://github.com/bitcoin/bitcoin/pull/29307/files?w=1#diff-7194b705e3c48e34fbd6e648fbbee39c6e0b49ee9658658b930678a9a2d31dd6R957\r\n```C++\r\nif (file.IsNull() || !file.Commit() || file.fclose()) {\r\n    LogError(\"%s: Failed to flush filter file %d\", __func__, pos.nFile);\r\n    return false;\r\n}\r\n```",
      "created_at": "2025-04-17T11:09:38Z",
      "updated_at": "2025-04-17T12:14:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048729097",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048729097"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 154,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048747378",
      "pull_request_review_id": 2775379592,
      "id": 2048747378,
      "node_id": "PRRC_kwDOABII5856HWdy",
      "diff_hunk": "@@ -229,6 +229,12 @@ size_t BlockFilterIndex::WriteFilterToDisk(FlatFilePos& pos, const BlockFilter&\n     }\n \n     fileout << filter.GetBlockHash() << filter.GetEncodedFilter();\n+\n+    if (fileout.fclose() != 0) {\n+        LogPrintf(\"Failed to close filter file %d: %s\", pos.nFile, SysErrorString(errno));\n+        return 0;\n+    }",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 26,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "1f71111e2115ba3504b6585e16df54e5615dd3f9",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Why is this a `LogInfo`, shouldn't it be a `LogError`?\r\n```suggestion\r\n    if (fileout.fclose()) {\r\n        LogError(\"%s: Failed to close filter file %d: %s\", __func__, pos.nFile, SysErrorString(errno));\r\n        return 0;\r\n    }\r\n```",
      "created_at": "2025-04-17T11:23:11Z",
      "updated_at": "2025-04-17T12:14:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048747378",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048747378"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": 233,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 247,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048754656",
      "pull_request_review_id": 2775379592,
      "id": 2048754656,
      "node_id": "PRRC_kwDOABII5856HYPg",
      "diff_hunk": "@@ -947,20 +947,30 @@ bool BlockManager::WriteBlockUndo(const CBlockUndo& blockundo, BlockValidationSt\n                 LogError(\"OpenUndoFile failed for %s while writing block undo\", pos.ToString());\n                 return FatalError(m_opts.notifications, state, _(\"Failed to write undo data.\"));\n             }\n-            BufferedWriter fileout{file};\n-\n-            // Write index header\n-            fileout << GetParams().MessageStart() << blockundo_size;\n-            pos.nPos += STORAGE_HEADER_BYTES;\n             {\n-                // Calculate checksum\n-                HashWriter hasher{};\n-                hasher << block.pprev->GetBlockHash() << blockundo;\n-                // Write undo data & checksum\n-                fileout << blockundo << hasher.GetHash();\n+                BufferedWriter fileout{file};\n+\n+                // Write index header\n+                fileout << GetParams().MessageStart() << blockundo_size;\n+                pos.nPos += STORAGE_HEADER_BYTES;\n+                {\n+                    // Calculate checksum\n+                    HashWriter hasher{};\n+                    hasher << block.pprev->GetBlockHash() << blockundo;\n+                    // Write undo data & checksum\n+                    fileout << blockundo << hasher.GetHash();\n+                }\n             }\n \n-            fileout.flush(); // Make sure `AutoFile`/`BufferedWriter` go out of scope before we call `FlushUndoFile`\n+            if (file.fclose() != 0) {",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 30,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "1f71111e2115ba3504b6585e16df54e5615dd3f9",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: now that we're closing explicitly we probably don't need the scope, too (wouldn't we double-log in that case anyway?) Or if we keep it, could make sense to add the closing inside - unless it's deliberate, in which case we might want to explain it in the commit message",
      "created_at": "2025-04-17T11:28:42Z",
      "updated_at": "2025-04-17T12:14:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048754656",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048754656"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 965,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048754753",
      "pull_request_review_id": 2775379592,
      "id": 2048754753,
      "node_id": "PRRC_kwDOABII5856HYRB",
      "diff_hunk": "@@ -947,20 +947,30 @@ bool BlockManager::WriteBlockUndo(const CBlockUndo& blockundo, BlockValidationSt\n                 LogError(\"OpenUndoFile failed for %s while writing block undo\", pos.ToString());\n                 return FatalError(m_opts.notifications, state, _(\"Failed to write undo data.\"));\n             }\n-            BufferedWriter fileout{file};\n-\n-            // Write index header\n-            fileout << GetParams().MessageStart() << blockundo_size;\n-            pos.nPos += STORAGE_HEADER_BYTES;\n             {\n-                // Calculate checksum\n-                HashWriter hasher{};\n-                hasher << block.pprev->GetBlockHash() << blockundo;\n-                // Write undo data & checksum\n-                fileout << blockundo << hasher.GetHash();\n+                BufferedWriter fileout{file};\n+\n+                // Write index header\n+                fileout << GetParams().MessageStart() << blockundo_size;\n+                pos.nPos += STORAGE_HEADER_BYTES;\n+                {\n+                    // Calculate checksum\n+                    HashWriter hasher{};\n+                    hasher << block.pprev->GetBlockHash() << blockundo;\n+                    // Write undo data & checksum\n+                    fileout << blockundo << hasher.GetHash();\n+                }\n             }\n \n-            fileout.flush(); // Make sure `AutoFile`/`BufferedWriter` go out of scope before we call `FlushUndoFile`\n+            if (file.fclose() != 0) {\n+                LogPrintLevel(BCLog::BLOCKSTORAGE,\n+                              BCLog::Level::Error,\n+                              \"Failed to close block undo file %s: %s\",\n+                              pos.ToString(),\n+                              SysErrorString(errno));\n+                return FatalError(m_opts.notifications, state, _(\"Failed to close block undo file.\"));\n+            }\n+            // Make sure that the file is closed before we call `FlushUndoFile`.",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 38,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "1f71111e2115ba3504b6585e16df54e5615dd3f9",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I'd either delete this now or put it before the actual closing. And do we really need to make this unlikely scenario occupy so much space? And in the other case we simply used `LogError` instead:\r\n```C++\r\n// Make sure that the file is closed before we call `FlushUndoFile`.\r\nif (file.fclose()) {\r\n    LogError(\"Failed to close block undo file %s: %s\", pos.ToString(), SysErrorString(errno));\r\n    return FatalError(m_opts.notifications, state, _(\"Failed to close block undo file.\"));\r\n}\r\n```",
      "created_at": "2025-04-17T11:28:48Z",
      "updated_at": "2025-04-17T12:14:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048754753",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048754753"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 973,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048761555",
      "pull_request_review_id": 2775379592,
      "id": 2048761555,
      "node_id": "PRRC_kwDOABII5856HZ7T",
      "diff_hunk": "@@ -1142,6 +1165,11 @@ static auto InitBlocksdirXorKey(const BlockManager::Options& opts)\n #endif\n         )};\n         xor_key_file << xor_key;\n+        if (xor_key_file.fclose() != 0) {\n+            throw std::runtime_error{strprintf(\"Error closing XOR key file %s: %s\\n\",",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 80,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "1f71111e2115ba3504b6585e16df54e5615dd3f9",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit:\r\n```suggestion\r\n            throw std::runtime_error{strprintf(\"Error closing XOR key file %s: %s\",\r\n```",
      "created_at": "2025-04-17T11:34:18Z",
      "updated_at": "2025-04-17T12:14:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048761555",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048761555"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1169,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048769760",
      "pull_request_review_id": 2775379592,
      "id": 2048769760,
      "node_id": "PRRC_kwDOABII5856Hb7g",
      "diff_hunk": "@@ -62,5 +62,10 @@ FUZZ_TARGET(autofile)\n         if (f != nullptr) {\n             fclose(f);\n         }\n+    } else {\n+        // FuzzedFileProvider::close() is expected to fail sometimes. Don't let\n+        // the destructor of AutoFile be upset by a failing fclose(). Close it\n+        // explicitly (and ignore any errors) so that the destructor is a noop.",
      "path": "src/test/fuzz/autofile.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "why do we want the destructor to be a noop?",
      "created_at": "2025-04-17T11:40:11Z",
      "updated_at": "2025-04-17T12:14:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048769760",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048769760"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 68,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048772120",
      "pull_request_review_id": 2775379592,
      "id": 2048772120,
      "node_id": "PRRC_kwDOABII5856HcgY",
      "diff_hunk": "@@ -566,7 +568,9 @@ BOOST_AUTO_TEST_CASE(buffered_reader_matches_autofile_random_content)\n \n     // Write out the file with random content\n     {\n-        AutoFile{test_file.Open(pos, /*read_only=*/false), obfuscation}.write(m_rng.randbytes<std::byte>(file_size));\n+        AutoFile f{test_file.Open(pos, /*read_only=*/false), obfuscation};\n+        f.write(m_rng.randbytes<std::byte>(file_size));\n+        BOOST_REQUIRE_EQUAL(f.fclose(), 0);",
      "path": "src/test/streams_tests.cpp",
      "position": 43,
      "original_position": 43,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: this likely isn't strictly necessary, as long as it contains all the data (checked below), it should work correctly - but it's fine either way",
      "created_at": "2025-04-17T11:41:43Z",
      "updated_at": "2025-04-17T12:14:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048772120",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048772120"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 573,
      "original_line": 573,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048785183",
      "pull_request_review_id": 2775379592,
      "id": 2048785183,
      "node_id": "PRRC_kwDOABII5856Hfsf",
      "diff_hunk": "@@ -386,27 +389,48 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then the caller must close it\n+ * explicitly with the `fclose()` method, check if it returns an error and treat\n+ * such an error as if the `write()` method failed. The OS's `fclose(3)` may\n+ * fail to flush to disk data that has been previously written, rendering the\n+ * file corrupt.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n     std::optional<int64_t> m_position;\n+    bool m_was_written{false};",
      "path": "src/streams.h",
      "position": 33,
      "original_position": 33,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Can you separate the `AutoFile` changes to a new commit, explaining these changes separately from the changes that are calling close explicitly?",
      "created_at": "2025-04-17T11:51:03Z",
      "updated_at": "2025-04-17T12:14:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048785183",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048785183"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 406,
      "original_line": 406,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048791750",
      "pull_request_review_id": 2775379592,
      "id": 2048791750,
      "node_id": "PRRC_kwDOABII5856HhTG",
      "diff_hunk": "@@ -386,27 +389,48 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then the caller must close it\n+ * explicitly with the `fclose()` method, check if it returns an error and treat\n+ * such an error as if the `write()` method failed. The OS's `fclose(3)` may\n+ * fail to flush to disk data that has been previously written, rendering the\n+ * file corrupt.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n     std::optional<int64_t> m_position;\n+    bool m_was_written{false};\n \n public:\n     explicit AutoFile(std::FILE* file, std::vector<std::byte> data_xor={});\n \n-    ~AutoFile() { fclose(); }\n+    ~AutoFile()\n+    {\n+        if (m_was_written) {\n+            // Callers that wrote to the file must have closed it explicitly\n+            // with the fclose() method and checked that the close succeeded.\n+            // This is because here from the destructor we have no way to signal\n+            // error due to close which, after write, could mean the file is\n+            // corrupted and must be handled properly at the call site.\n+            Assume(IsNull());\n+        }\n+\n+        if (fclose() != 0) {\n+            LogPrintLevel(BCLog::ALL, BCLog::Level::Error, \"Failed to close file: %s\", SysErrorString(errno));",
      "path": "src/streams.h",
      "position": null,
      "original_position": 51,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "```suggestion\r\n            LogError(\"Failed to close file: %s\", SysErrorString(errno));\r\n```",
      "created_at": "2025-04-17T11:53:59Z",
      "updated_at": "2025-04-17T12:14:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048791750",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048791750"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 423,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048792563",
      "pull_request_review_id": 2775379592,
      "id": 2048792563,
      "node_id": "PRRC_kwDOABII5856Hhfz",
      "diff_hunk": "@@ -386,27 +389,48 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then the caller must close it\n+ * explicitly with the `fclose()` method, check if it returns an error and treat\n+ * such an error as if the `write()` method failed. The OS's `fclose(3)` may\n+ * fail to flush to disk data that has been previously written, rendering the\n+ * file corrupt.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n     std::optional<int64_t> m_position;\n+    bool m_was_written{false};\n \n public:\n     explicit AutoFile(std::FILE* file, std::vector<std::byte> data_xor={});\n \n-    ~AutoFile() { fclose(); }\n+    ~AutoFile()\n+    {\n+        if (m_was_written) {\n+            // Callers that wrote to the file must have closed it explicitly\n+            // with the fclose() method and checked that the close succeeded.\n+            // This is because here from the destructor we have no way to signal\n+            // error due to close which, after write, could mean the file is\n+            // corrupted and must be handled properly at the call site.\n+            Assume(IsNull());\n+        }\n+\n+        if (fclose() != 0) {\n+            LogPrintLevel(BCLog::ALL, BCLog::Level::Error, \"Failed to close file: %s\", SysErrorString(errno));\n+        }\n+    }\n \n     // Disallow copies\n     AutoFile(const AutoFile&) = delete;\n     AutoFile& operator=(const AutoFile&) = delete;\n \n     bool feof() const { return std::feof(m_file); }\n \n-    int fclose()\n+    [[nodiscard]] int fclose()",
      "path": "src/streams.h",
      "position": 64,
      "original_position": 62,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "ðŸ‘ for `[[nodiscard]]`, but this seems like the perfect opportunity to unify it with how e.g. `feof` works and change `fclose` to return a boolean instead - since we don't seem to check other values than 0.",
      "created_at": "2025-04-17T11:54:36Z",
      "updated_at": "2025-04-17T12:14:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048792563",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048792563"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 435,
      "original_line": 435,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048793171",
      "pull_request_review_id": 2775379592,
      "id": 2048793171,
      "node_id": "PRRC_kwDOABII5856HhpT",
      "diff_hunk": "@@ -386,27 +389,48 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then the caller must close it\n+ * explicitly with the `fclose()` method, check if it returns an error and treat\n+ * such an error as if the `write()` method failed. The OS's `fclose(3)` may\n+ * fail to flush to disk data that has been previously written, rendering the\n+ * file corrupt.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n     std::optional<int64_t> m_position;\n+    bool m_was_written{false};\n \n public:\n     explicit AutoFile(std::FILE* file, std::vector<std::byte> data_xor={});\n \n-    ~AutoFile() { fclose(); }\n+    ~AutoFile()\n+    {\n+        if (m_was_written) {\n+            // Callers that wrote to the file must have closed it explicitly\n+            // with the fclose() method and checked that the close succeeded.\n+            // This is because here from the destructor we have no way to signal\n+            // error due to close which, after write, could mean the file is",
      "path": "src/streams.h",
      "position": null,
      "original_position": 45,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "not sure what these lines mean",
      "created_at": "2025-04-17T11:55:01Z",
      "updated_at": "2025-04-17T12:14:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048793171",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048793171"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": 416,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 417,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048795915",
      "pull_request_review_id": 2775379592,
      "id": 2048795915,
      "node_id": "PRRC_kwDOABII5856HiUL",
      "diff_hunk": "@@ -79,13 +81,15 @@ BOOST_AUTO_TEST_CASE(flatfile_open)\n \n         file >> LIMITED_STRING(text, 256);\n         BOOST_CHECK_EQUAL(text, line2);\n+        BOOST_REQUIRE_EQUAL(file.fclose(), 0);",
      "path": "src/test/flatfile_tests.cpp",
      "position": 20,
      "original_position": 20,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "'require' seems a bit harsh, but shouldn't happen often",
      "created_at": "2025-04-17T11:56:55Z",
      "updated_at": "2025-04-17T12:14:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048795915",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048795915"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 84,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048798223",
      "pull_request_review_id": 2775379592,
      "id": 2048798223,
      "node_id": "PRRC_kwDOABII5856Hi4P",
      "diff_hunk": "@@ -95,6 +95,7 @@ void AutoFile::write(std::span<const std::byte> src)\n             src = src.subspan(buf_now.size());\n         }\n     }\n+    m_was_written = true;",
      "path": "src/streams.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "should this be added to `AutoFile::write_buffer` as well?",
      "created_at": "2025-04-17T11:58:37Z",
      "updated_at": "2025-04-17T12:14:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2048798223",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2048798223"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 98,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071700058",
      "pull_request_review_id": 2812161773,
      "id": 2071700058,
      "node_id": "PRRC_kwDOABII5857e6Ja",
      "diff_hunk": "@@ -151,7 +151,7 @@ bool BlockFilterIndex::CustomCommit(CDBBatch& batch)\n         LogError(\"%s: Failed to open filter file %d\\n\", __func__, pos.nFile);\n         return false;\n     }\n-    if (!file.Commit()) {\n+    if (!file.Commit() || file.fclose() != 0) {",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "1f71111e2115ba3504b6585e16df54e5615dd3f9",
      "in_reply_to_id": 2048729097,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "There is even a bigger problem with `if (!file.Commit() || file.fclose() != 0) {` -- if the commit fails when `fclose()` will not be called, it will return and the file destructor will be upset that the file has been written to and is not closed. Fixed.",
      "created_at": "2025-05-02T14:29:06Z",
      "updated_at": "2025-05-02T14:29:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071700058",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071700058"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 154,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071702348",
      "pull_request_review_id": 2812165499,
      "id": 2071702348,
      "node_id": "PRRC_kwDOABII5857e6tM",
      "diff_hunk": "@@ -229,6 +229,12 @@ size_t BlockFilterIndex::WriteFilterToDisk(FlatFilePos& pos, const BlockFilter&\n     }\n \n     fileout << filter.GetBlockHash() << filter.GetEncodedFilter();\n+\n+    if (fileout.fclose() != 0) {\n+        LogPrintf(\"Failed to close filter file %d: %s\", pos.nFile, SysErrorString(errno));\n+        return 0;\n+    }",
      "path": "src/index/blockfilterindex.cpp",
      "position": null,
      "original_position": 26,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "1f71111e2115ba3504b6585e16df54e5615dd3f9",
      "in_reply_to_id": 2048747378,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Changed to `LogError()`, but `__func__` is redundant with the config option `-logsourcelocations`, so I omitted it.",
      "created_at": "2025-05-02T14:30:46Z",
      "updated_at": "2025-05-02T14:30:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071702348",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071702348"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": 233,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 247,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071702885",
      "pull_request_review_id": 2812166302,
      "id": 2071702885,
      "node_id": "PRRC_kwDOABII5857e61l",
      "diff_hunk": "@@ -947,20 +947,30 @@ bool BlockManager::WriteBlockUndo(const CBlockUndo& blockundo, BlockValidationSt\n                 LogError(\"OpenUndoFile failed for %s while writing block undo\", pos.ToString());\n                 return FatalError(m_opts.notifications, state, _(\"Failed to write undo data.\"));\n             }\n-            BufferedWriter fileout{file};\n-\n-            // Write index header\n-            fileout << GetParams().MessageStart() << blockundo_size;\n-            pos.nPos += STORAGE_HEADER_BYTES;\n             {\n-                // Calculate checksum\n-                HashWriter hasher{};\n-                hasher << block.pprev->GetBlockHash() << blockundo;\n-                // Write undo data & checksum\n-                fileout << blockundo << hasher.GetHash();\n+                BufferedWriter fileout{file};\n+\n+                // Write index header\n+                fileout << GetParams().MessageStart() << blockundo_size;\n+                pos.nPos += STORAGE_HEADER_BYTES;\n+                {\n+                    // Calculate checksum\n+                    HashWriter hasher{};\n+                    hasher << block.pprev->GetBlockHash() << blockundo;\n+                    // Write undo data & checksum\n+                    fileout << blockundo << hasher.GetHash();\n+                }\n             }\n \n-            fileout.flush(); // Make sure `AutoFile`/`BufferedWriter` go out of scope before we call `FlushUndoFile`\n+            if (file.fclose() != 0) {",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 30,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "1f71111e2115ba3504b6585e16df54e5615dd3f9",
      "in_reply_to_id": 2048754656,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Right. Removed the scope.",
      "created_at": "2025-05-02T14:31:06Z",
      "updated_at": "2025-05-02T14:31:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071702885",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071702885"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 965,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071703580",
      "pull_request_review_id": 2812167581,
      "id": 2071703580,
      "node_id": "PRRC_kwDOABII5857e7Ac",
      "diff_hunk": "@@ -947,20 +947,30 @@ bool BlockManager::WriteBlockUndo(const CBlockUndo& blockundo, BlockValidationSt\n                 LogError(\"OpenUndoFile failed for %s while writing block undo\", pos.ToString());\n                 return FatalError(m_opts.notifications, state, _(\"Failed to write undo data.\"));\n             }\n-            BufferedWriter fileout{file};\n-\n-            // Write index header\n-            fileout << GetParams().MessageStart() << blockundo_size;\n-            pos.nPos += STORAGE_HEADER_BYTES;\n             {\n-                // Calculate checksum\n-                HashWriter hasher{};\n-                hasher << block.pprev->GetBlockHash() << blockundo;\n-                // Write undo data & checksum\n-                fileout << blockundo << hasher.GetHash();\n+                BufferedWriter fileout{file};\n+\n+                // Write index header\n+                fileout << GetParams().MessageStart() << blockundo_size;\n+                pos.nPos += STORAGE_HEADER_BYTES;\n+                {\n+                    // Calculate checksum\n+                    HashWriter hasher{};\n+                    hasher << block.pprev->GetBlockHash() << blockundo;\n+                    // Write undo data & checksum\n+                    fileout << blockundo << hasher.GetHash();\n+                }\n             }\n \n-            fileout.flush(); // Make sure `AutoFile`/`BufferedWriter` go out of scope before we call `FlushUndoFile`\n+            if (file.fclose() != 0) {\n+                LogPrintLevel(BCLog::BLOCKSTORAGE,\n+                              BCLog::Level::Error,\n+                              \"Failed to close block undo file %s: %s\",\n+                              pos.ToString(),\n+                              SysErrorString(errno));\n+                return FatalError(m_opts.notifications, state, _(\"Failed to close block undo file.\"));\n+            }\n+            // Make sure that the file is closed before we call `FlushUndoFile`.",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 38,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "1f71111e2115ba3504b6585e16df54e5615dd3f9",
      "in_reply_to_id": 2048754753,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Moved the comment before the actual closing. Reduced as well.",
      "created_at": "2025-05-02T14:31:39Z",
      "updated_at": "2025-05-02T14:31:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071703580",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071703580"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 973,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071703786",
      "pull_request_review_id": 2812167943,
      "id": 2071703786,
      "node_id": "PRRC_kwDOABII5857e7Dq",
      "diff_hunk": "@@ -1142,6 +1165,11 @@ static auto InitBlocksdirXorKey(const BlockManager::Options& opts)\n #endif\n         )};\n         xor_key_file << xor_key;\n+        if (xor_key_file.fclose() != 0) {\n+            throw std::runtime_error{strprintf(\"Error closing XOR key file %s: %s\\n\",",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 80,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "1f71111e2115ba3504b6585e16df54e5615dd3f9",
      "in_reply_to_id": 2048761555,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2025-05-02T14:31:50Z",
      "updated_at": "2025-05-02T14:31:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071703786",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071703786"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1169,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071706458",
      "pull_request_review_id": 2812172888,
      "id": 2071706458,
      "node_id": "PRRC_kwDOABII5857e7ta",
      "diff_hunk": "@@ -62,5 +62,10 @@ FUZZ_TARGET(autofile)\n         if (f != nullptr) {\n             fclose(f);\n         }\n+    } else {\n+        // FuzzedFileProvider::close() is expected to fail sometimes. Don't let\n+        // the destructor of AutoFile be upset by a failing fclose(). Close it\n+        // explicitly (and ignore any errors) so that the destructor is a noop.",
      "path": "src/test/fuzz/autofile.cpp",
      "position": null,
      "original_position": 16,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048769760,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Removed this outdated comment.",
      "created_at": "2025-05-02T14:33:53Z",
      "updated_at": "2025-05-02T14:33:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071706458",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071706458"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 68,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071707907",
      "pull_request_review_id": 2812175293,
      "id": 2071707907,
      "node_id": "PRRC_kwDOABII5857e8ED",
      "diff_hunk": "@@ -566,7 +568,9 @@ BOOST_AUTO_TEST_CASE(buffered_reader_matches_autofile_random_content)\n \n     // Write out the file with random content\n     {\n-        AutoFile{test_file.Open(pos, /*read_only=*/false), obfuscation}.write(m_rng.randbytes<std::byte>(file_size));\n+        AutoFile f{test_file.Open(pos, /*read_only=*/false), obfuscation};\n+        f.write(m_rng.randbytes<std::byte>(file_size));\n+        BOOST_REQUIRE_EQUAL(f.fclose(), 0);",
      "path": "src/test/streams_tests.cpp",
      "position": 43,
      "original_position": 43,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048772120,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think it is better to stop the test right away if the closing fails.",
      "created_at": "2025-05-02T14:34:56Z",
      "updated_at": "2025-05-02T14:34:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071707907",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071707907"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 573,
      "original_line": 573,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071708123",
      "pull_request_review_id": 2812175669,
      "id": 2071708123,
      "node_id": "PRRC_kwDOABII5857e8Hb",
      "diff_hunk": "@@ -386,27 +389,48 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then the caller must close it\n+ * explicitly with the `fclose()` method, check if it returns an error and treat\n+ * such an error as if the `write()` method failed. The OS's `fclose(3)` may\n+ * fail to flush to disk data that has been previously written, rendering the\n+ * file corrupt.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n     std::optional<int64_t> m_position;\n+    bool m_was_written{false};",
      "path": "src/streams.h",
      "position": 33,
      "original_position": 33,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048785183,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2025-05-02T14:35:06Z",
      "updated_at": "2025-05-02T14:35:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071708123",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071708123"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 406,
      "original_line": 406,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071708360",
      "pull_request_review_id": 2812176051,
      "id": 2071708360,
      "node_id": "PRRC_kwDOABII5857e8LI",
      "diff_hunk": "@@ -386,27 +389,48 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then the caller must close it\n+ * explicitly with the `fclose()` method, check if it returns an error and treat\n+ * such an error as if the `write()` method failed. The OS's `fclose(3)` may\n+ * fail to flush to disk data that has been previously written, rendering the\n+ * file corrupt.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n     std::optional<int64_t> m_position;\n+    bool m_was_written{false};\n \n public:\n     explicit AutoFile(std::FILE* file, std::vector<std::byte> data_xor={});\n \n-    ~AutoFile() { fclose(); }\n+    ~AutoFile()\n+    {\n+        if (m_was_written) {\n+            // Callers that wrote to the file must have closed it explicitly\n+            // with the fclose() method and checked that the close succeeded.\n+            // This is because here from the destructor we have no way to signal\n+            // error due to close which, after write, could mean the file is\n+            // corrupted and must be handled properly at the call site.\n+            Assume(IsNull());\n+        }\n+\n+        if (fclose() != 0) {\n+            LogPrintLevel(BCLog::ALL, BCLog::Level::Error, \"Failed to close file: %s\", SysErrorString(errno));",
      "path": "src/streams.h",
      "position": null,
      "original_position": 51,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048791750,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2025-05-02T14:35:16Z",
      "updated_at": "2025-05-02T14:35:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071708360",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071708360"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 423,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071715279",
      "pull_request_review_id": 2812190206,
      "id": 2071715279,
      "node_id": "PRRC_kwDOABII5857e93P",
      "diff_hunk": "@@ -386,27 +389,48 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then the caller must close it\n+ * explicitly with the `fclose()` method, check if it returns an error and treat\n+ * such an error as if the `write()` method failed. The OS's `fclose(3)` may\n+ * fail to flush to disk data that has been previously written, rendering the\n+ * file corrupt.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n     std::optional<int64_t> m_position;\n+    bool m_was_written{false};\n \n public:\n     explicit AutoFile(std::FILE* file, std::vector<std::byte> data_xor={});\n \n-    ~AutoFile() { fclose(); }\n+    ~AutoFile()\n+    {\n+        if (m_was_written) {\n+            // Callers that wrote to the file must have closed it explicitly\n+            // with the fclose() method and checked that the close succeeded.\n+            // This is because here from the destructor we have no way to signal\n+            // error due to close which, after write, could mean the file is\n+            // corrupted and must be handled properly at the call site.\n+            Assume(IsNull());\n+        }\n+\n+        if (fclose() != 0) {\n+            LogPrintLevel(BCLog::ALL, BCLog::Level::Error, \"Failed to close file: %s\", SysErrorString(errno));\n+        }\n+    }\n \n     // Disallow copies\n     AutoFile(const AutoFile&) = delete;\n     AutoFile& operator=(const AutoFile&) = delete;\n \n     bool feof() const { return std::feof(m_file); }\n \n-    int fclose()\n+    [[nodiscard]] int fclose()",
      "path": "src/streams.h",
      "position": 64,
      "original_position": 62,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048792563,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Hmm, the OS `feof()` returns nonzero if end-of-file. This makes it possible to use the natural:\r\n\r\n```cpp\r\nif (feof()) { // end-of-file has been reached\r\n```\r\n\r\nBut `fclose()` returns zero if the file has been closed. I do not want to invert the return value because that would be confusing for people that know the interface of the OS `fclose()`. Or even more confusing, if the return is not inverted and converted to `bool`:\r\n\r\n```\r\nbool fclose(...);\r\n\r\nif (fclose()) { // error!\r\n```",
      "created_at": "2025-05-02T14:40:14Z",
      "updated_at": "2025-05-02T14:40:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071715279",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071715279"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 435,
      "original_line": 435,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071716526",
      "pull_request_review_id": 2812192815,
      "id": 2071716526,
      "node_id": "PRRC_kwDOABII5857e-Ku",
      "diff_hunk": "@@ -386,27 +389,48 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then the caller must close it\n+ * explicitly with the `fclose()` method, check if it returns an error and treat\n+ * such an error as if the `write()` method failed. The OS's `fclose(3)` may\n+ * fail to flush to disk data that has been previously written, rendering the\n+ * file corrupt.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n     std::optional<int64_t> m_position;\n+    bool m_was_written{false};\n \n public:\n     explicit AutoFile(std::FILE* file, std::vector<std::byte> data_xor={});\n \n-    ~AutoFile() { fclose(); }\n+    ~AutoFile()\n+    {\n+        if (m_was_written) {\n+            // Callers that wrote to the file must have closed it explicitly\n+            // with the fclose() method and checked that the close succeeded.\n+            // This is because here from the destructor we have no way to signal\n+            // error due to close which, after write, could mean the file is",
      "path": "src/streams.h",
      "position": null,
      "original_position": 45,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048793171,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Elaborated a little bit:\r\n\r\n```cpp\r\n            // Callers that wrote to the file must have closed it explicitly\r\n            // with the fclose() method and checked that the close succeeded.\r\n            // This is because here from the destructor we have no way to signal\r\n            // error due to close which, after write, could mean the file is\r\n            // corrupted and must be handled properly at the call site.\r\n            // Destructors in C++ cannot signal an error to the callers because\r\n            // they do not return a value and are not allowed to throw exceptions.\r\n```",
      "created_at": "2025-05-02T14:41:05Z",
      "updated_at": "2025-05-02T14:41:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071716526",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071716526"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": 416,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 417,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071717206",
      "pull_request_review_id": 2812194099,
      "id": 2071717206,
      "node_id": "PRRC_kwDOABII5857e-VW",
      "diff_hunk": "@@ -79,13 +81,15 @@ BOOST_AUTO_TEST_CASE(flatfile_open)\n \n         file >> LIMITED_STRING(text, 256);\n         BOOST_CHECK_EQUAL(text, line2);\n+        BOOST_REQUIRE_EQUAL(file.fclose(), 0);",
      "path": "src/test/flatfile_tests.cpp",
      "position": 20,
      "original_position": 20,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048795915,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think it is better to stop the test immediately if closing a file gives an error.",
      "created_at": "2025-05-02T14:41:36Z",
      "updated_at": "2025-05-02T14:41:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071717206",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071717206"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 84,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071717840",
      "pull_request_review_id": 2812195093,
      "id": 2071717840,
      "node_id": "PRRC_kwDOABII5857e-fQ",
      "diff_hunk": "@@ -95,6 +95,7 @@ void AutoFile::write(std::span<const std::byte> src)\n             src = src.subspan(buf_now.size());\n         }\n     }\n+    m_was_written = true;",
      "path": "src/streams.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048798223,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "What to be added to `AutoFile::write_buffer`?",
      "created_at": "2025-05-02T14:42:04Z",
      "updated_at": "2025-05-02T14:42:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071717840",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071717840"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 98,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071924816",
      "pull_request_review_id": 2812536604,
      "id": 2071924816,
      "node_id": "PRRC_kwDOABII5857fxBQ",
      "diff_hunk": "@@ -95,6 +95,7 @@ void AutoFile::write(std::span<const std::byte> src)\n             src = src.subspan(buf_now.size());\n         }\n     }\n+    m_was_written = true;",
      "path": "src/streams.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048798223,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "`m_was_written = true`, since `AutoFile::write_buffer` also dirties (which is the term we use in other cases, if you think it describes the behavior better, consider renaming)",
      "created_at": "2025-05-02T17:22:29Z",
      "updated_at": "2025-05-02T17:22:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071924816",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071924816"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 98,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071926224",
      "pull_request_review_id": 2812538907,
      "id": 2071926224,
      "node_id": "PRRC_kwDOABII5857fxXQ",
      "diff_hunk": "@@ -386,27 +389,48 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then the caller must close it\n+ * explicitly with the `fclose()` method, check if it returns an error and treat\n+ * such an error as if the `write()` method failed. The OS's `fclose(3)` may\n+ * fail to flush to disk data that has been previously written, rendering the\n+ * file corrupt.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n     std::optional<int64_t> m_position;\n+    bool m_was_written{false};\n \n public:\n     explicit AutoFile(std::FILE* file, std::vector<std::byte> data_xor={});\n \n-    ~AutoFile() { fclose(); }\n+    ~AutoFile()\n+    {\n+        if (m_was_written) {\n+            // Callers that wrote to the file must have closed it explicitly\n+            // with the fclose() method and checked that the close succeeded.\n+            // This is because here from the destructor we have no way to signal\n+            // error due to close which, after write, could mean the file is\n+            // corrupted and must be handled properly at the call site.\n+            Assume(IsNull());\n+        }\n+\n+        if (fclose() != 0) {\n+            LogPrintLevel(BCLog::ALL, BCLog::Level::Error, \"Failed to close file: %s\", SysErrorString(errno));\n+        }\n+    }\n \n     // Disallow copies\n     AutoFile(const AutoFile&) = delete;\n     AutoFile& operator=(const AutoFile&) = delete;\n \n     bool feof() const { return std::feof(m_file); }\n \n-    int fclose()\n+    [[nodiscard]] int fclose()",
      "path": "src/streams.h",
      "position": 64,
      "original_position": 62,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048792563,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I find returning error codes for boolean values a lot more confusing.\r\nEdit: And we're already doing `if (!file.Commit()) {`, I find this a lot more intuitive than fake error codes.",
      "created_at": "2025-05-02T17:23:45Z",
      "updated_at": "2025-05-02T18:25:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071926224",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071926224"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 435,
      "original_line": 435,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071988064",
      "pull_request_review_id": 2812640885,
      "id": 2071988064,
      "node_id": "PRRC_kwDOABII5857gAdg",
      "diff_hunk": "@@ -386,27 +389,48 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then the caller must close it\n+ * explicitly with the `fclose()` method, check if it returns an error and treat\n+ * such an error as if the `write()` method failed. The OS's `fclose(3)` may\n+ * fail to flush to disk data that has been previously written, rendering the\n+ * file corrupt.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n     std::optional<int64_t> m_position;\n+    bool m_was_written{false};\n \n public:\n     explicit AutoFile(std::FILE* file, std::vector<std::byte> data_xor={});\n \n-    ~AutoFile() { fclose(); }\n+    ~AutoFile()\n+    {\n+        if (m_was_written) {\n+            // Callers that wrote to the file must have closed it explicitly\n+            // with the fclose() method and checked that the close succeeded.\n+            // This is because here from the destructor we have no way to signal\n+            // error due to close which, after write, could mean the file is",
      "path": "src/streams.h",
      "position": null,
      "original_position": 45,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048793171,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> because here from the destructor\r\n\r\nStill not sure what this means exactly, would this maybe work better?\r\n\r\n```suggestion\r\n            // This is because here in the destructor we have no way to signal\r\n            // errors from close(), which, after write, could mean the file is\r\n```",
      "created_at": "2025-05-02T18:20:13Z",
      "updated_at": "2025-05-02T18:33:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2071988064",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2071988064"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": 416,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 417,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2072005944",
      "pull_request_review_id": 2812670165,
      "id": 2072005944,
      "node_id": "PRRC_kwDOABII5857gE04",
      "diff_hunk": "@@ -959,8 +960,12 @@ bool BlockManager::WriteBlockUndo(const CBlockUndo& blockundo, BlockValidationSt\n                 // Write undo data & checksum\n                 fileout << blockundo << hasher.GetHash();\n             }\n+        }\n \n-            fileout.flush(); // Make sure `AutoFile`/`BufferedWriter` go out of scope before we call `FlushUndoFile`\n+        // Make sure that the file is closed before we call `FlushUndoFile`.\n+        if (file.fclose() != 0) {\n+            LogError(\"Failed to close block undo file %s: %s\", pos.ToString(), SysErrorString(errno));\n+            return FatalError(m_opts.notifications, state, _(\"Failed to close block undo file.\"));",
      "path": "src/node/blockstorage.cpp",
      "position": 38,
      "original_position": 38,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "fe2d1955f6333c57f54aed2a2a8b3cdaa6bf9d71",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "do we need both messages? How will this be displayed in the logs, isn't it redundant?",
      "created_at": "2025-05-02T18:36:48Z",
      "updated_at": "2025-05-02T18:36:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2072005944",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2072005944"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": 967,
      "original_start_line": 967,
      "start_side": "RIGHT",
      "line": 968,
      "original_line": 968,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2072389405",
      "pull_request_review_id": 2813227962,
      "id": 2072389405,
      "node_id": "PRRC_kwDOABII5857hicd",
      "diff_hunk": "@@ -386,27 +389,48 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then the caller must close it\n+ * explicitly with the `fclose()` method, check if it returns an error and treat\n+ * such an error as if the `write()` method failed. The OS's `fclose(3)` may\n+ * fail to flush to disk data that has been previously written, rendering the\n+ * file corrupt.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n     std::optional<int64_t> m_position;\n+    bool m_was_written{false};\n \n public:\n     explicit AutoFile(std::FILE* file, std::vector<std::byte> data_xor={});\n \n-    ~AutoFile() { fclose(); }\n+    ~AutoFile()\n+    {\n+        if (m_was_written) {\n+            // Callers that wrote to the file must have closed it explicitly\n+            // with the fclose() method and checked that the close succeeded.\n+            // This is because here from the destructor we have no way to signal\n+            // error due to close which, after write, could mean the file is\n+            // corrupted and must be handled properly at the call site.\n+            Assume(IsNull());\n+        }\n+\n+        if (fclose() != 0) {\n+            LogPrintLevel(BCLog::ALL, BCLog::Level::Error, \"Failed to close file: %s\", SysErrorString(errno));\n+        }\n+    }\n \n     // Disallow copies\n     AutoFile(const AutoFile&) = delete;\n     AutoFile& operator=(const AutoFile&) = delete;\n \n     bool feof() const { return std::feof(m_file); }\n \n-    int fclose()\n+    [[nodiscard]] int fclose()",
      "path": "src/streams.h",
      "position": 64,
      "original_position": 62,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048792563,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In that case it would be better to call it `bool AutoFile::Close()` rather than `bool AutoFile::fclose()`.",
      "created_at": "2025-05-03T12:51:32Z",
      "updated_at": "2025-05-03T20:48:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2072389405",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2072389405"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 435,
      "original_line": 435,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2072395486",
      "pull_request_review_id": 2813233807,
      "id": 2072395486,
      "node_id": "PRRC_kwDOABII5857hj7e",
      "diff_hunk": "@@ -386,27 +389,48 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then the caller must close it\n+ * explicitly with the `fclose()` method, check if it returns an error and treat\n+ * such an error as if the `write()` method failed. The OS's `fclose(3)` may\n+ * fail to flush to disk data that has been previously written, rendering the\n+ * file corrupt.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n     std::optional<int64_t> m_position;\n+    bool m_was_written{false};\n \n public:\n     explicit AutoFile(std::FILE* file, std::vector<std::byte> data_xor={});\n \n-    ~AutoFile() { fclose(); }\n+    ~AutoFile()\n+    {\n+        if (m_was_written) {\n+            // Callers that wrote to the file must have closed it explicitly\n+            // with the fclose() method and checked that the close succeeded.\n+            // This is because here from the destructor we have no way to signal\n+            // error due to close which, after write, could mean the file is\n+            // corrupted and must be handled properly at the call site.\n+            Assume(IsNull());\n+        }\n+\n+        if (fclose() != 0) {\n+            LogPrintLevel(BCLog::ALL, BCLog::Level::Error, \"Failed to close file: %s\", SysErrorString(errno));\n+        }\n+    }\n \n     // Disallow copies\n     AutoFile(const AutoFile&) = delete;\n     AutoFile& operator=(const AutoFile&) = delete;\n \n     bool feof() const { return std::feof(m_file); }\n \n-    int fclose()\n+    [[nodiscard]] int fclose()",
      "path": "src/streams.h",
      "position": 64,
      "original_position": 62,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048792563,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Agree, it's what I wrote in the review as well:\r\n>  the current `fclose` returns a fake error code, but is actually a boolean - may make sense to rename it (e.g. `Close`, similarly to how we've wrapped `ftruncate` with `TruncateFile`) and migrate to returning a boolean to avoid the current confusion.\r\n",
      "created_at": "2025-05-03T13:27:41Z",
      "updated_at": "2025-05-03T13:27:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2072395486",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2072395486"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 435,
      "original_line": 435,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2073354232",
      "pull_request_review_id": 2814650388,
      "id": 2073354232,
      "node_id": "PRRC_kwDOABII5857lN_4",
      "diff_hunk": "@@ -959,8 +960,12 @@ bool BlockManager::WriteBlockUndo(const CBlockUndo& blockundo, BlockValidationSt\n                 // Write undo data & checksum\n                 fileout << blockundo << hasher.GetHash();\n             }\n+        }\n \n-            fileout.flush(); // Make sure `AutoFile`/`BufferedWriter` go out of scope before we call `FlushUndoFile`\n+        // Make sure that the file is closed before we call `FlushUndoFile`.\n+        if (file.fclose() != 0) {\n+            LogError(\"Failed to close block undo file %s: %s\", pos.ToString(), SysErrorString(errno));\n+            return FatalError(m_opts.notifications, state, _(\"Failed to close block undo file.\"));",
      "path": "src/node/blockstorage.cpp",
      "position": 38,
      "original_position": 38,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "fe2d1955f6333c57f54aed2a2a8b3cdaa6bf9d71",
      "in_reply_to_id": 2072005944,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This just mimics the error handling when the file cannot be opened:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/53ccb75f0c47e1e48504cb392d7589548a8d25a2/src/node/blockstorage.cpp#L945-L949",
      "created_at": "2025-05-05T12:32:22Z",
      "updated_at": "2025-05-05T12:32:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2073354232",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2073354232"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": 967,
      "original_start_line": 967,
      "start_side": "RIGHT",
      "line": 968,
      "original_line": 968,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2073373828",
      "pull_request_review_id": 2814683581,
      "id": 2073373828,
      "node_id": "PRRC_kwDOABII5857lSyE",
      "diff_hunk": "@@ -386,27 +389,48 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then the caller must close it\n+ * explicitly with the `fclose()` method, check if it returns an error and treat\n+ * such an error as if the `write()` method failed. The OS's `fclose(3)` may\n+ * fail to flush to disk data that has been previously written, rendering the\n+ * file corrupt.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n     std::optional<int64_t> m_position;\n+    bool m_was_written{false};\n \n public:\n     explicit AutoFile(std::FILE* file, std::vector<std::byte> data_xor={});\n \n-    ~AutoFile() { fclose(); }\n+    ~AutoFile()\n+    {\n+        if (m_was_written) {\n+            // Callers that wrote to the file must have closed it explicitly\n+            // with the fclose() method and checked that the close succeeded.\n+            // This is because here from the destructor we have no way to signal\n+            // error due to close which, after write, could mean the file is\n+            // corrupted and must be handled properly at the call site.\n+            Assume(IsNull());\n+        }\n+\n+        if (fclose() != 0) {\n+            LogPrintLevel(BCLog::ALL, BCLog::Level::Error, \"Failed to close file: %s\", SysErrorString(errno));\n+        }\n+    }\n \n     // Disallow copies\n     AutoFile(const AutoFile&) = delete;\n     AutoFile& operator=(const AutoFile&) = delete;\n \n     bool feof() const { return std::feof(m_file); }\n \n-    int fclose()\n+    [[nodiscard]] int fclose()",
      "path": "src/streams.h",
      "position": 64,
      "original_position": 62,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048792563,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "The interface of `AutoFile::fclose()` is not changed by this PR and is not the purpose of this PR to change it. Thus I will leave it as it is.\r\n\r\nI think that the interface of the current `AutoFile::fclose()` is just fine. It mimics 1:1 the libc [fclose(3)](https://www.man7.org/linux/man-pages/man3/fclose.3.html) which is in line with the majority of the other system functions which:\r\n\r\n> return the valueÂ 0 if successful; otherwise the valueÂ -1 is returned and the global variable errno is set to indicate the error\r\n\r\nI don't think that is \"fake\" and I do not know why it would be confusing. It is well established. The benefit of mimicking 1:1 is that there is _zero learning curve_ for people that read the Bitcoin Core code and are familiar with the libc functions.",
      "created_at": "2025-05-05T12:46:23Z",
      "updated_at": "2025-05-05T12:46:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2073373828",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2073373828"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 435,
      "original_line": 435,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2073385113",
      "pull_request_review_id": 2814702428,
      "id": 2073385113,
      "node_id": "PRRC_kwDOABII5857lViZ",
      "diff_hunk": "@@ -386,27 +389,48 @@ class BitStreamWriter\n  *\n  * Will automatically close the file when it goes out of scope if not null.\n  * If you're returning the file pointer, return file.release().\n- * If you need to close the file early, use file.fclose() instead of fclose(file).\n+ * If you need to close the file early, use autofile.fclose() instead of fclose(underlying_FILE).\n+ *\n+ * @note If the file has been written to, then the caller must close it\n+ * explicitly with the `fclose()` method, check if it returns an error and treat\n+ * such an error as if the `write()` method failed. The OS's `fclose(3)` may\n+ * fail to flush to disk data that has been previously written, rendering the\n+ * file corrupt.\n  */\n class AutoFile\n {\n protected:\n     std::FILE* m_file;\n     std::vector<std::byte> m_xor;\n     std::optional<int64_t> m_position;\n+    bool m_was_written{false};\n \n public:\n     explicit AutoFile(std::FILE* file, std::vector<std::byte> data_xor={});\n \n-    ~AutoFile() { fclose(); }\n+    ~AutoFile()\n+    {\n+        if (m_was_written) {\n+            // Callers that wrote to the file must have closed it explicitly\n+            // with the fclose() method and checked that the close succeeded.\n+            // This is because here from the destructor we have no way to signal\n+            // error due to close which, after write, could mean the file is",
      "path": "src/streams.h",
      "position": null,
      "original_position": 45,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048793171,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-05-05T12:53:35Z",
      "updated_at": "2025-05-05T12:53:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2073385113",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2073385113"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": 416,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 417,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2073386754",
      "pull_request_review_id": 2814705127,
      "id": 2073386754,
      "node_id": "PRRC_kwDOABII5857lV8C",
      "diff_hunk": "@@ -95,6 +95,7 @@ void AutoFile::write(std::span<const std::byte> src)\n             src = src.subspan(buf_now.size());\n         }\n     }\n+    m_was_written = true;",
      "path": "src/streams.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "9057ab8b80137a89df68a3ed4bc49f9926e0f634",
      "original_commit_id": "c52b673bf854db4bf7e0a9de350ed9af1c99d575",
      "in_reply_to_id": 2048798223,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I see. Done. I also moved the `m_was_written = true` to be just after the `fwrite()` calls.",
      "created_at": "2025-05-05T12:54:40Z",
      "updated_at": "2025-05-05T12:54:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29307#discussion_r2073386754",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2073386754"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 98,
      "side": "RIGHT"
    }
  ]
}