{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415",
    "id": 1719386983,
    "node_id": "PR_kwDOABII585me8Nn",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/29415",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/29415.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/29415.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/3e6b5a9ec460e763b62624c5cea7178975e804eb",
    "number": 29415,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "Broadcast own transactions only via short-lived Tor or I2P connections",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "_Parts of this PR are isolated in independent smaller PRs to ease review:_\r\n\r\n* [x] _https://github.com/bitcoin/bitcoin/pull/33454_\r\n* [ ] _https://github.com/bitcoin/bitcoin/pull/33565_\r\n* [x] _https://github.com/bitcoin/bitcoin/pull/33567_\r\n* [ ] _https://github.com/bitcoin/bitcoin/pull/33792_\r\n* [x] _https://github.com/bitcoin/bitcoin/pull/33793_\r\n\r\n---\r\n\r\nTo improve privacy, broadcast locally submitted transactions (from the `sendrawtransaction` RPC) to the P2P network only via Tor or I2P short-lived connections, or to IPv4/IPv6 peers but through the Tor network.\r\n\r\n* Introduce a new connection type for private broadcast of transactions with the following properties:\r\n  * started whenever there are local transactions to be sent\r\n  * opened to Tor or I2P peers or IPv4/IPv6 via the Tor proxy\r\n  * opened regardless of max connections limits\r\n  * after handshake is completed one local transaction is pushed to the peer, `PING` is sent and after receiving `PONG` the connection is closed\r\n  * ignore all incoming messages after handshake is completed (except `PONG`)\r\n\r\n* Broadcast transactions submitted via `sendrawtransaction` using this new mechanism, to a few peers. Keep doing this until we receive back this transaction from one of our ordinary peers (this takes about 1 second on mainnet).\r\n\r\n* The transaction is stored in peerman and does not enter the mempool.\r\n\r\n* Once we get an `INV` from one of our ordinary peers, then the normal flow executes: we request the transaction with `GETDATA`, receive it with a `TX` message, put it in our mempool and broadcast it to all our existent connections (as if we see it for the first time).\r\n\r\n* After we receive the full transaction as a `TX` message, in reply to our `GETDATA` request, only then consider the transaction has propagated through the network and remove it from the storage in peerman, ending the private broadcast attempts.\r\n\r\nThe messages exchange should look like this:\r\n\r\n```\r\ntx-sender >--- connect -------> tx-recipient\r\ntx-sender >--- VERSION -------> tx-recipient (dummy VERSION with no revealing data)\r\ntx-sender <--- VERSION -------< tx-recipient\r\ntx-sender <--- WTXIDRELAY ----< tx-recipient (maybe)\r\ntx-sender <--- SENDADDRV2 ----< tx-recipient (maybe)\r\ntx-sender <--- SENDTXRCNCL ---< tx-recipient (maybe)\r\ntx-sender <--- VERACK --------< tx-recipient\r\ntx-sender >--- VERACK --------> tx-recipient\r\ntx-sender >--- INV/TX --------> tx-recipient\r\ntx-sender <--- GETDATA/TX ----< tx-recipient\r\ntx-sender >--- TX ------------> tx-recipient\r\ntx-sender >--- PING ----------> tx-recipient\r\ntx-sender <--- PONG ----------< tx-recipient\r\ntx-sender disconnects\r\n```\r\n\r\nWhenever a new transaction is received from `sendrawtransaction` RPC, the node will send it to a few (`NUM_PRIVATE_BROADCAST_PER_TX`) recipients right away. If after 10-15 mins we still have not heard anything about the transaction from the network, then it will be sent to 1 more peer (see `PeerManagerImpl::ReattemptPrivateBroadcast()`).\r\n\r\nA few considerations:\r\n* The short-lived private broadcast connections are very cheap and fast wrt network traffic. It is expected that some of those peers could blackhole the transaction. Just one honest/proper peer is enough for successful propagation.\r\n* The peers that receive the transaction could deduce that this is initial transaction broadcast from the transaction originator. This is ok, they can't identify the sender.\r\n\r\n---\r\n\r\n<details>\r\n<summary>How to test this?</summary>\r\n\r\nThank you, @stratospher and @andrewtoth!\r\n\r\nStart `bitcoind` with `-privatebroadcast=1 -debug=privatebroadcast`.\r\n\r\nCreate a wallet and get a new address, go to the Signet faucet and request some coins to that address:\r\n```bash\r\nbuild/bin/bitcoin-cli -chain=\"signet\" createwallet test\r\nbuild/bin/bitcoin-cli -chain=\"signet\" getnewaddress\r\n```\r\n\r\nGet a new address for the test transaction recipient:\r\n```bash\r\nbuild/bin/bitcoin-cli -chain=\"signet\" loadwallet test\r\nnew_address=$(build/bin/bitcoin-cli -chain=\"signet\" getnewaddress)\r\n```\r\n\r\nCreate the transaction:\r\n```bash\r\n# Option 1: `createrawtransaction` and `signrawtransactionwithwallet`:\r\n\r\ntxid=$(build/bin/bitcoin-cli -chain=\"signet\" listunspent | jq -r '.[0] | .txid')\r\nvout=$(build/bin/bitcoin-cli -chain=\"signet\" listunspent | jq -r '.[0] | .vout')\r\necho \"txid: $txid\"\r\necho \"vout: $vout\"\r\n\r\ntx=$(build/bin/bitcoin-cli -chain=\"signet\" createrawtransaction \"[{\\\"txid\\\": \\\"$txid\\\", \\\"vout\\\": $vout}]\" \"[{\\\"$new_address\\\": 0.00001000}]\" 0 false)\r\necho \"tx: $tx\"\r\n\r\nsigned_tx=$(build/bin/bitcoin-cli -chain=\"signet\" signrawtransactionwithwallet \"$tx\" | jq -r '.hex')\r\necho \"signed_tx: $signed_tx\"\r\n\r\n# OR Option 2: `walletcreatefundedpsbt` and `walletprocesspsbt`:\r\n# This makes it not have to worry about inputs and also automatically sends back change to the wallet.\r\n# Start `bitcoind` with `-fallbackfee=0.00003000` for instance for 3 sat/vbyte fee.\r\n\r\npsbt=$(build/bin/bitcoin-cli -chain=\"signet\" walletcreatefundedpsbt \"[]\" \"[{\\\"$new_address\\\": 0.00001000}]\" | jq -r '.psbt')\r\necho \"psbt: $psbt\"\r\n\r\nsigned_tx=$(build/bin/bitcoin-cli -chain=\"signet\" walletprocesspsbt \"$psbt\" | jq -r '.hex')\r\necho \"signed_tx: $signed_tx\"\r\n```\r\n\r\nFinally, send the transaction:\r\n```bash\r\nraw_tx=$(build/bin/bitcoin-cli -chain=\"signet\" sendrawtransaction \"$signed_tx\")\r\necho \"raw_tx: $raw_tx\"\r\n```\r\n\r\n</details>\r\n\r\n---\r\n\r\n<details>\r\n<summary>High-level explanation of the commits</summary>\r\n\r\n* New logging category and config option to enable private broadcast\r\n  * `log: introduce a new category for private broadcast`\r\n  * `init: introduce a new option to enable/disable private broadcast`\r\n\r\n* Implement the private broadcast connection handling on the `CConnman` side:\r\n  * `net: introduce a new connection type for private broadcast`\r\n  * `net: implement opening PRIVATE_BROADCAST connections`\r\n\r\n* Prepare `BroadcastTransaction()` for private broadcast requests:\r\n  * `net_processing: rename RelayTransaction to better describe what it does`\r\n  * `node: change a tx-relay on/off flag to a tri-state`\r\n  * `net_processing: store transactions for private broadcast in PeerManager`\r\n\r\n* Implement the private broadcast connection handling on the `PeerManager` side:\r\n  * `net_processing: reorder the code that handles the VERSION message`\r\n  * `net_processing: handle ConnectionType::PRIVATE_BROADCAST connections`\r\n  * `net_processing: stop private broadcast of a transaction after round-trip`\r\n  * `net_processing: retry private broadcast`\r\n\r\n* Engage the new functionality from `sendrawtransaction`:\r\n  * `rpc: use private broadcast from sendrawtransaction RPC if -privatebroadcast is ON`\r\n\r\n* Independent test framework improvement:\r\n  * `test: move create_malleated_version() to messages.py for reuse`\r\n\r\n* New functional test that exercies some of the new code:\r\n  * `test: add functional test for local tx relay`\r\n\r\n</details>\r\n\r\n---\r\n\r\n**This PR would close the following issues:**\r\nhttps://github.com/bitcoin/bitcoin/issues/3828 Clients leak IPs if they are recipients of a transaction\r\nhttps://github.com/bitcoin/bitcoin/issues/14692 Can't configure bitocoind to only send tx via Tor but receive clearnet transactions\r\nhttps://github.com/bitcoin/bitcoin/issues/19042 Tor-only transaction broadcast onlynet=onion alternative\r\nhttps://github.com/bitcoin/bitcoin/issues/24557 Option for receive events with all networks, but send transactions and/or blocks only with anonymous network[s]?\r\nhttps://github.com/bitcoin/bitcoin/issues/25450 Ability to broadcast wallet transactions only via dedicated oneshot Tor connections\r\nhttps://github.com/bitcoin/bitcoin/issues/32235 Tor: TX circuit isolation\r\n\r\n**Issues that are related, but (maybe?) not to be closed by this PR:**\r\nhttps://github.com/bitcoin/bitcoin/issues/21876 Broadcast a transaction to specific nodes\r\nhttps://github.com/bitcoin/bitcoin/issues/28636 new RPC: sendrawtransactiontopeer\r\n\r\n---\r\n\r\nFurther extensions:\r\n* Have the wallet do the private broadcast as well, https://github.com/bitcoin/bitcoin/issues/11887 would have to be resolved.\r\n* Have the `submitpackage` RPC do the private broadcast as well, [draft diff in the comment below](https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2972293733), thanks ismaelsadeeq!\r\n* Add some stats via RPC, so that the user can better monitor what is going on during and after the broadcast. Currently this can be done via the debug log, but that is not convenient.\r\n* Make the private broadcast storage, currently in peerman, persistent over node restarts.\r\n* Add (optional) random delay before starting to broadcast the transaction in order to avoid correlating unrelated transactions based on the time when they were broadcast. Suggested independently of this PR [here](https://github.com/bitcoin/bitcoin/issues/30471).\r\n* Consider periodically sending transactions that did not originate from the node as decoy, discussed [here](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035414972).\r\n* Consider waiting for peer's FEEFILTER message and if the transaction that was sent to the peer is below that threshold, then assume the peer is going to drop it. Then use this knowledge to retry more aggressively with another peer, instead of the current 10 min. See [comment below](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3258611648).\r\n* It may make sense to be able to override the default policy -- eg so submitrawtransaction can go straight to the mempool and relay, even if txs are normally privately relayed. See [comment below](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3427086681).\r\n\r\n---\r\n\r\n_A previous incarnation of this can be found at https://github.com/bitcoin/bitcoin/pull/27509. It puts the transaction in the mempool and (tries to) hide it from the outside observers. This turned out to be too error prone or maybe even impossible._\r\n",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "created_at": "2024-02-09T13:39:10Z",
    "updated_at": "2025-11-17T13:05:56Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "2334585777e1a16f2979f234e8e2c3e71046a6ff",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "nothingmuch",
        "id": 14242,
        "node_id": "MDQ6VXNlcjE0MjQy",
        "avatar_url": "https://avatars.githubusercontent.com/u/14242?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nothingmuch",
        "html_url": "https://github.com/nothingmuch",
        "followers_url": "https://api.github.com/users/nothingmuch/followers",
        "following_url": "https://api.github.com/users/nothingmuch/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nothingmuch/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nothingmuch/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nothingmuch/subscriptions",
        "organizations_url": "https://api.github.com/users/nothingmuch/orgs",
        "repos_url": "https://api.github.com/users/nothingmuch/repos",
        "events_url": "https://api.github.com/users/nothingmuch/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nothingmuch/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "vasild:private_broadcast",
      "ref": "private_broadcast",
      "sha": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 120608826,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMjA2MDg4MjY=",
        "name": "bitcoin",
        "full_name": "vasild/bitcoin",
        "owner": {
          "login": "vasild",
          "id": 266751,
          "node_id": "MDQ6VXNlcjI2Njc1MQ==",
          "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/vasild",
          "html_url": "https://github.com/vasild",
          "followers_url": "https://api.github.com/users/vasild/followers",
          "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
          "organizations_url": "https://api.github.com/users/vasild/orgs",
          "repos_url": "https://api.github.com/users/vasild/repos",
          "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/vasild/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/vasild/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/vasild/bitcoin",
        "archive_url": "https://api.github.com/repos/vasild/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/vasild/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/vasild/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/vasild/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/vasild/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/vasild/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/vasild/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/vasild/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/vasild/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/vasild/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/vasild/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/vasild/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/vasild/bitcoin/events",
        "forks_url": "https://api.github.com/repos/vasild/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/vasild/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/vasild/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/vasild/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/vasild/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/vasild/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/vasild/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/vasild/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/vasild/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/vasild/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/vasild/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/vasild/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/vasild/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/vasild/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/vasild/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/vasild/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:vasild/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/vasild/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/vasild/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/vasild/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/vasild/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/vasild/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/vasild/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/vasild/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/vasild/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/vasild/bitcoin/hooks",
        "svn_url": "https://github.com/vasild/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 6,
        "watchers_count": 6,
        "size": 269944,
        "default_branch": "master",
        "open_issues_count": 2,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-14T09:34:27Z",
        "created_at": "2018-02-07T11:52:47Z",
        "updated_at": "2025-11-13T10:44:35Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "dfde31f2ec1f90976f3ba6b06f2b38a1307c01ab",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38215,
        "stargazers_count": 86847,
        "watchers_count": 86847,
        "size": 296056,
        "default_branch": "master",
        "open_issues_count": 735,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-17T12:35:21Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-11-17T13:51:51Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 1439,
    "deletions": 86,
    "changed_files": 24,
    "commits": 13,
    "review_comments": 354,
    "comments": 152
  },
  "events": [
    {
      "event": "commented",
      "id": 1935952116,
      "node_id": "IC_kwDOABII585zZEj0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1935952116",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-09T13:39:13Z",
      "updated_at": "2025-11-17T13:05:56Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/29415.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [zzzi2p](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2025920443), [nothingmuch](https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1984991157), [jonatack](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2905206387), [kdmukai](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2956071169), [kevkevinpal](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2972766537), [RandyMcMillan](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3172916955), [naiyoma](https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-3335207073), [ajtowns](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3427086681) |\n| Stale ACK | [pinheadmz](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2203472829), [mzumsande](https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2932613802), [andrewtoth](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3315093703) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33792](https://github.com/bitcoin/bitcoin/pull/33792) (net_processing: reorder the code that handles the VERSION message by vasild)\n* [#33565](https://github.com/bitcoin/bitcoin/pull/33565) (net_processing: rename RelayTransaction to better describe what it does by vasild)\n* [#33300](https://github.com/bitcoin/bitcoin/pull/33300) (fuzz: compact block harness by Crypt-iQ)\n* [#32394](https://github.com/bitcoin/bitcoin/pull/32394) (net: make m_nodes_mutex non-recursive by vasild)\n* [#32015](https://github.com/bitcoin/bitcoin/pull/32015) (net: replace manual reference counting of CNode with shared_ptr by vasild)\n* [#30988](https://github.com/bitcoin/bitcoin/pull/30988) (Split CConnman by vasild)\n* [#30277](https://github.com/bitcoin/bitcoin/pull/30277) ([DO NOT MERGE] Erlay: bandwidth-efficient transaction relay protocol (Full implementation) by sr-gi)\n* [#30116](https://github.com/bitcoin/bitcoin/pull/30116) (p2p: Fill reconciliation sets (Erlay) attempt 2 by sr-gi)\n* [#29278](https://github.com/bitcoin/bitcoin/pull/29278) (Wallet:  Add `maxfeerate` wallet startup option by ismaelsadeeq)\n* [#28690](https://github.com/bitcoin/bitcoin/pull/28690) (build: Introduce internal kernel library by TheCharlatan)\n* [#28463](https://github.com/bitcoin/bitcoin/pull/28463) (p2p: Increase inbound capacity for block-relay only connections by mzumsande)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1935952116",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 1936003083,
      "node_id": "IC_kwDOABII585zZRAL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1936003083",
      "actor": {
        "login": "1440000bytes",
        "id": 147166694,
        "node_id": "U_kgDOCMWV5g",
        "avatar_url": "https://avatars.githubusercontent.com/u/147166694?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/1440000bytes",
        "html_url": "https://github.com/1440000bytes",
        "followers_url": "https://api.github.com/users/1440000bytes/followers",
        "following_url": "https://api.github.com/users/1440000bytes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/1440000bytes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/1440000bytes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/1440000bytes/subscriptions",
        "organizations_url": "https://api.github.com/users/1440000bytes/orgs",
        "repos_url": "https://api.github.com/users/1440000bytes/repos",
        "events_url": "https://api.github.com/users/1440000bytes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/1440000bytes/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-09T14:12:36Z",
      "updated_at": "2025-07-31T19:15:19Z",
      "author_association": "NONE",
      "body": "I am not sure about this approach to improve privacy. Is it necessary to open new short lived tor/i2p connections for broadcasting the transaction? What are the trade-offs in this implementation vs a simple implementation to relay tx to one or more peers that our node is already connected to?\r\n\r\nRelated issues:\r\n\r\nhttps://github.com/bitcoin/bitcoin/issues/21876\r\nhttps://github.com/bitcoin/bitcoin/issues/28636",
      "user": {
        "login": "1440000bytes",
        "id": 147166694,
        "node_id": "U_kgDOCMWV5g",
        "avatar_url": "https://avatars.githubusercontent.com/u/147166694?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/1440000bytes",
        "html_url": "https://github.com/1440000bytes",
        "followers_url": "https://api.github.com/users/1440000bytes/followers",
        "following_url": "https://api.github.com/users/1440000bytes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/1440000bytes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/1440000bytes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/1440000bytes/subscriptions",
        "organizations_url": "https://api.github.com/users/1440000bytes/orgs",
        "repos_url": "https://api.github.com/users/1440000bytes/repos",
        "events_url": "https://api.github.com/users/1440000bytes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/1440000bytes/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1936003083",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 11759489534,
      "node_id": "LE_lADOABII585-yiT2zwAAAAK865H-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11759489534",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-09T15:35:35Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11764679568,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAK9OsOQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11764679568",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "74ba7c7fb58e3a77eef7d69739145d22bb937f1c",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/74ba7c7fb58e3a77eef7d69739145d22bb937f1c",
      "created_at": "2024-02-10T11:50:15Z"
    },
    {
      "event": "commented",
      "id": 1936992757,
      "node_id": "IC_kwDOABII585zdCn1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1936992757",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-10T12:16:19Z",
      "updated_at": "2024-02-10T12:17:03Z",
      "author_association": "CONTRIBUTOR",
      "body": "@1440000bytes, thanks for asking! There is some discussion at https://github.com/bitcoin/bitcoin/pull/27509 (the previous attempt on this).\r\n\r\n> Is it necessary to open new short lived tor/i2p connections for broadcasting the transaction?\r\n\r\nYes, it is. See below.\r\n\r\n> What are the trade-offs in this implementation vs a simple implementation to relay tx to one or more peers that our node is already connected to?\r\n\r\nSending the transaction over clearnet reveals the IP address/geolocation of the sender. A spy with many connections to the network could try to guess who was the originator. So, why not send it to our Tor peers only? Because it is relatively easy for a spy to fingerprint and link clearnet and Tor connections to the same peer. That is, a long running connection over Tor could be linked to a long running clearnet connection. This is why the proposed changes open a short-lived connection that does not reveal any of the identity of the sender.\r\n\r\nWould this benefit nodes that don't have clearnet connections, e.g. Tor/I2P-only nodes? Yes! In the case where the sender sends two otherwise unrelated transactions over the same long-running Tor connection, the recipient will know that they have the same origin, even though they are not related on-chain. Using single shot connections fixes that too.\r\n\r\n> Related issues:\r\n\r\nLinked in the OP, thanks!",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1936992757",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 11764779098,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAK9PEha",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11764779098",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-10T12:48:54Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1874263137,
      "node_id": "PRR_kwDOABII585vtvxh",
      "url": null,
      "actor": null,
      "commit_id": "2b05af27608f9e4e9a1b5f5c83c7870a8e6c9425",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-02-10T21:48:08Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "davidgumberg",
        "id": 2257631,
        "node_id": "MDQ6VXNlcjIyNTc2MzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2257631?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/davidgumberg",
        "html_url": "https://github.com/davidgumberg",
        "followers_url": "https://api.github.com/users/davidgumberg/followers",
        "following_url": "https://api.github.com/users/davidgumberg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/davidgumberg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/davidgumberg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/davidgumberg/subscriptions",
        "organizations_url": "https://api.github.com/users/davidgumberg/orgs",
        "repos_url": "https://api.github.com/users/davidgumberg/repos",
        "events_url": "https://api.github.com/users/davidgumberg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/davidgumberg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1874263137",
      "submitted_at": "2024-02-10T21:48:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "commented",
      "id": 1937228496,
      "node_id": "IC_kwDOABII585zd8LQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1937228496",
      "actor": {
        "login": "epiccurious",
        "id": 109078515,
        "node_id": "U_kgDOBoBn8w",
        "avatar_url": "https://avatars.githubusercontent.com/u/109078515?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/epiccurious",
        "html_url": "https://github.com/epiccurious",
        "followers_url": "https://api.github.com/users/epiccurious/followers",
        "following_url": "https://api.github.com/users/epiccurious/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/epiccurious/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/epiccurious/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/epiccurious/subscriptions",
        "organizations_url": "https://api.github.com/users/epiccurious/orgs",
        "repos_url": "https://api.github.com/users/epiccurious/repos",
        "events_url": "https://api.github.com/users/epiccurious/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/epiccurious/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-10T21:56:09Z",
      "updated_at": "2024-02-10T21:56:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "v2 Transport will be enabled by default in the next release (https://github.com/bitcoin/bitcoin/pull/29347).\r\n\r\nIf there were eventually a change to _force_ clearnet transactions over v2 transport (so the details of the communications were encrypted), would that solve the same problem that this PR is aiming to solve?",
      "user": {
        "login": "epiccurious",
        "id": 109078515,
        "node_id": "U_kgDOBoBn8w",
        "avatar_url": "https://avatars.githubusercontent.com/u/109078515?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/epiccurious",
        "html_url": "https://github.com/epiccurious",
        "followers_url": "https://api.github.com/users/epiccurious/followers",
        "following_url": "https://api.github.com/users/epiccurious/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/epiccurious/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/epiccurious/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/epiccurious/subscriptions",
        "organizations_url": "https://api.github.com/users/epiccurious/orgs",
        "repos_url": "https://api.github.com/users/epiccurious/repos",
        "events_url": "https://api.github.com/users/epiccurious/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/epiccurious/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1937228496",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 1937766372,
      "node_id": "IC_kwDOABII585zf_fk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1937766372",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-11T14:13:16Z",
      "updated_at": "2024-02-11T14:13:16Z",
      "author_association": "CONTRIBUTOR",
      "body": "@epiccurious, p2p encryption \"solves\" the spying from intermediate routers on clearnet (aka man-in-the-middle). Tor, I2P and CJDNS solve that too. While this PR uses only Tor and I2P it would solve that problem. But there is more - it will as well solve issues with spying bitcoin nodes.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1937766372",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 11767128759,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAK9YCK3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11767128759",
      "actor": {
        "login": "epiccurious",
        "id": 109078515,
        "node_id": "U_kgDOBoBn8w",
        "avatar_url": "https://avatars.githubusercontent.com/u/109078515?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/epiccurious",
        "html_url": "https://github.com/epiccurious",
        "followers_url": "https://api.github.com/users/epiccurious/followers",
        "following_url": "https://api.github.com/users/epiccurious/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/epiccurious/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/epiccurious/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/epiccurious/subscriptions",
        "organizations_url": "https://api.github.com/users/epiccurious/orgs",
        "repos_url": "https://api.github.com/users/epiccurious/repos",
        "events_url": "https://api.github.com/users/epiccurious/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/epiccurious/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-11T14:13:18Z"
    },
    {
      "event": "subscribed",
      "id": 11767128766,
      "node_id": "SE_lADOABII585-yiT2zwAAAAK9YCK-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11767128766",
      "actor": {
        "login": "epiccurious",
        "id": 109078515,
        "node_id": "U_kgDOBoBn8w",
        "avatar_url": "https://avatars.githubusercontent.com/u/109078515?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/epiccurious",
        "html_url": "https://github.com/epiccurious",
        "followers_url": "https://api.github.com/users/epiccurious/followers",
        "following_url": "https://api.github.com/users/epiccurious/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/epiccurious/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/epiccurious/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/epiccurious/subscriptions",
        "organizations_url": "https://api.github.com/users/epiccurious/orgs",
        "repos_url": "https://api.github.com/users/epiccurious/repos",
        "events_url": "https://api.github.com/users/epiccurious/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/epiccurious/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-11T14:13:18Z"
    },
    {
      "event": "referenced",
      "id": 11767164746,
      "node_id": "REFE_lADOABII585-yiT2zwAAAAK9YK9K",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11767164746",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b0344c219a641b759fb0cc4f53afebe675b8ca27",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/b0344c219a641b759fb0cc4f53afebe675b8ca27",
      "created_at": "2024-02-11T14:26:23Z"
    },
    {
      "event": "labeled",
      "id": 11935116014,
      "node_id": "LE_lADOABII585-yiT2zwAAAALHY2ru",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11935116014",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-27T11:49:34Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11965894649,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALJOQ_5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11965894649",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "6fad02cf03d6b37d0a22443a411ec92649b1d39d",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/6fad02cf03d6b37d0a22443a411ec92649b1d39d",
      "created_at": "2024-02-29T13:18:05Z"
    },
    {
      "event": "commented",
      "id": 1971120973,
      "node_id": "IC_kwDOABII5851fOtN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1971120973",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-29T13:18:23Z",
      "updated_at": "2024-02-29T13:18:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "`74ba7c7fb5...6fad02cf03`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1971120973",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 11966519505,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAALJQpjR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11966519505",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-29T14:03:56Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1986011938,
      "node_id": "IC_kwDOABII5852YCMi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1986011938",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-08T16:32:33Z",
      "updated_at": "2024-03-08T16:32:33Z",
      "author_association": "MEMBER",
      "body": "concept ACK 6fad02cf03 \r\n\r\n(code review in progress)\r\n\r\nI am also testing this feature in Warnet, which deploys a regtest network and even has an internal Tor DA so I can simulate onion routing locally. Currently using a 20-node [graph](https://github.com/pinheadmz/warnet/blob/priv-broadcast/test/data/onion.graphml) and a [scenario](https://github.com/pinheadmz/warnet/blob/priv-broadcast/src/scenarios/onion_init.py) which connects the graph, adds onion addresses to the test node, and then sends a raw transaction from the node running this branch.\r\n\r\nThe private broadcast succeeds frequently but not always. In Warnet anyway I had better luck when the test node had `-listenonion=0`, I tried that after suspecting that inbound onion connections were removing potential peers from the private broadcast list, but I'm not sure.\r\n\r\nI think I noticed this in the original PR as well, if multiple transactions are sent, the count keeps going up without a limit: \r\n\r\n```\r\n [privatebroadcast] Requested to open 60 connection(s), trying to open one\r\n```\r\n\r\nScreenshot below, I managed to capture a private broadcast connection! I'll mention when i get to that commit in review as well, but the connection type `\"privbcast\"` is breaking the very nice `-netinfo` table :-)\r\n\r\n\r\nSo far I have a few questions about the strategy:\r\n\r\n1. How do we pick the onion peers to relay to? If we avoid reusing peers then (especially in my miniature network) we can run out quickly, and nothing ever gets broadcast.\r\n\r\n2. Are we using fresh Tor identities for these connections? I think [Wasabi does something like this:](https://docs.wasabiwallet.app/why-wasabi/NetworkLevelPrivacy.html)\r\n\r\n> Wasabi connects to each peer through a different Tor stream. \r\n\r\n3. Do you think we need any RPC to get the status of private tx sends or provide the option to abandon (or revert to clearnet?)\r\n\r\n4. I assume you are restricting the feature to sendraw so the wallet doesn't get involved and try something silly like rebroadcasting over clearnet or inserting in to our own mempool? Do you think future work will integrate the wallet?\r\n\r\n\r\n![privbroadcast](https://github.com/bitcoin/bitcoin/assets/2084648/ec172be1-e5d8-4c00-94fc-e219dccacdec)\r\n\r\n\r\n",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1986011938",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 1986188327,
      "node_id": "IC_kwDOABII5852YtQn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1986188327",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-08T18:21:15Z",
      "updated_at": "2024-03-11T09:35:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "@pinheadmz, excellent! Thank you for looking into this! Replies inline:\r\n\r\n> The private broadcast succeeds frequently but not always\r\n\r\nLets debug this in a sub-thread in order not to overwhelm the PR main thread: [here](https://github.com/bitcoin/bitcoin/pull/29415/files#r1519402830).\r\n\r\n> suspecting that inbound onion connections were removing potential peers from the private broadcast list\r\n\r\nNo, this cannot be the case. Inbound onion connections appear as IPv4 connections coming from the Tor daemon. They do not have any source address associated with them, other than the one of the Tor daemon itself (usually `127.0.0.1`).\r\n\r\n> I think I noticed this in the original PR as well, if multiple transactions are sent, the count keeps going up without a limit\r\n\r\nThat is now capped at `size_t MAX_PRIVATE_BROADCAST_CONNECTIONS{64}`.\r\n\r\n> the connection type `\"privbcast\"` is breaking the very nice `-netinfo` table\r\n\r\nThis better be addressed in the visualization engine, e.g. by using `%5.5s`\r\n\r\n> How do we pick the onion peers to relay to? If we avoid reusing peers then...\r\n\r\nWe pick a random Tor (or I2P) peer. In the same way we choose the address when we want to have an outbound connection to a peer from a particular network. No attempt to avoid reuse. But we don't connect to already connected peers. This is the logic as in `master`.\r\n\r\n> Are we using fresh Tor identities for these connections?\r\n\r\nYes, if `-proxyrandomize=1` (the default). This is the same in `master` - separate Tor circuit per connection. This PR does the same as Wasabi: https://docs.wasabiwallet.app/why-wasabi/NetworkLevelPrivacy.html#wasabi-wallet-light-node\r\n\r\n> Do you think we need any RPC to get the status of private tx sends or provide the option to abandon (or revert to clearnet?)\r\n\r\nYes, both would be useful, but as a followup PR. I am afraid putting those here would bloat this PR too much. I could however implement that and publish it under Draft PR that depends on this one, so people can use it during testing.\r\n\r\n> I assume you are restricting the feature to sendraw so the wallet doesn't get involved and try something silly like rebroadcasting over clearnet or inserting in to our own mempool?\r\n\r\nThe reason to omit the wallet is that it currently does not count non-mempool change. For example, if we have 1 BTC and send 0.6 to somebody and 0.4 as change, the wallet will show a balance of 0 (or 1, unchanged? somebody correct me if I am wrong) until the transaction enters the mempool (or gets mined in a block). This would be quite rough user experience. Note that this is already the case in `master` if `-walletbroadcast=0`.\r\n\r\n> Do you think future work will integrate the wallet?\r\n\r\nYes, but I left that for another PR. Omitting it here reduces the size of this PR and allows to deal with the wallet in isolation, after all the distracting infrastructure is in (e.g. log category, new type of connection, the \"net\" code, etc).\r\n",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1986188327",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 12059164170,
      "node_id": "MEE_lADOABII585-yiT2zwAAAALOyD4K",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12059164170",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-08T18:21:16Z"
    },
    {
      "event": "subscribed",
      "id": 12059164176,
      "node_id": "SE_lADOABII585-yiT2zwAAAALOyD4Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12059164176",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-08T18:21:16Z"
    },
    {
      "event": "reviewed",
      "id": 1925311361,
      "node_id": "PRR_kwDOABII585yweuB",
      "url": null,
      "actor": null,
      "commit_id": "6fad02cf03d6b37d0a22443a411ec92649b1d39d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-03-08T20:59:10Z",
      "author_association": "MEMBER",
      "body": "Reviewed code through first 11 commits (up to 07dee91112189be02c6694385de261570725b56b) some nits but mostly questions below. I will continue review next week.\r\n\r\nReally great clean up in first commit in logging.cpp, very satisfying!\r\n\r\nOne other out-of-line question, about commit eb9d7386ca82319ab682fc20ab35c13340d108a4, the commit message mentions \"poking CConnman to start broadcast\" but I don't think that is in the code in that commit.",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1925311361",
      "submitted_at": "2024-03-08T20:59:10Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "labeled",
      "id": 12062073882,
      "node_id": "LE_lADOABII585-yiT2zwAAAALO9KQa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12062073882",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-09T02:12:37Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1927346768,
      "node_id": "PRR_kwDOABII585y4PpQ",
      "url": null,
      "actor": null,
      "commit_id": "6fad02cf03d6b37d0a22443a411ec92649b1d39d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-03-11T09:35:15Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1927346768",
      "submitted_at": "2024-03-11T09:35:15Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 1928530676,
      "node_id": "PRR_kwDOABII585y8wr0",
      "url": null,
      "actor": null,
      "commit_id": "bc05ddc7b9369cf263bf88d0a773ca853d3c9af5",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-03-11T17:19:47Z",
      "author_association": "MEMBER",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1928530676",
      "submitted_at": "2024-03-11T17:19:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12077825561,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALP5P4Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12077825561",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "d10a0649b018638574fa7dc316b3e783bf6cee69",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/d10a0649b018638574fa7dc316b3e783bf6cee69",
      "created_at": "2024-03-11T17:56:06Z"
    },
    {
      "event": "commented",
      "id": 1989094391,
      "node_id": "IC_kwDOABII5852jyv3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1989094391",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-11T17:56:20Z",
      "updated_at": "2024-03-11T17:56:20Z",
      "author_association": "CONTRIBUTOR",
      "body": "`6fad02cf03...d10a0649b0`: rebase due to conflicts and address some suggestions",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1989094391",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 1928558982,
      "node_id": "PRR_kwDOABII585y83mG",
      "url": null,
      "actor": null,
      "commit_id": "d10a0649b018638574fa7dc316b3e783bf6cee69",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-03-11T18:41:59Z",
      "author_association": "MEMBER",
      "body": "code review ACK d10a0649b0\r\n\r\nAlthough I think you rebased while was in there, so a few of my commit hashes might be off.\r\n\r\nOne additional out of line comment, in commit message for 6b8c645ea623875de9e3e3d3f77054dd0a784c20 you are using C++ syntax to describe python :-)",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1928558982",
      "submitted_at": "2024-03-11T18:41:58Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "unlabeled",
      "id": 12078594150,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAALP8Lhm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12078594150",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-11T18:55:20Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12093175316,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALQzzYU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12093175316",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "5ca891f4e030b86eadeb9d01113de000f547d97c",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/5ca891f4e030b86eadeb9d01113de000f547d97c",
      "created_at": "2024-03-12T18:02:51Z"
    },
    {
      "event": "commented",
      "id": 1992254693,
      "node_id": "IC_kwDOABII5852v2Tl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1992254693",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-12T18:03:11Z",
      "updated_at": "2024-03-12T18:03:11Z",
      "author_association": "CONTRIBUTOR",
      "body": "`d10a0649b0...5ca891f4e0`: address some suggestions",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1992254693",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 12093193357,
      "node_id": "LE_lADOABII585-yiT2zwAAAALQz3yN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12093193357",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-12T18:04:33Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12093209903,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALQz70v",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12093209903",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b6dce67064de0f55ea108e6fdcf7eae2e3c2c462",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/b6dce67064de0f55ea108e6fdcf7eae2e3c2c462",
      "created_at": "2024-03-12T18:06:07Z"
    },
    {
      "event": "commented",
      "id": 1992260133,
      "node_id": "IC_kwDOABII5852v3ol",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1992260133",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-12T18:06:18Z",
      "updated_at": "2024-03-12T18:06:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "`5ca891f4e0...b6dce67064`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1992260133",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 12094588085,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAALQ5MS1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12094588085",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-12T20:25:30Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12102946189,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALRZE2N",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12102946189",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "cc867ebd6253deb0905be9547f915ab6d04aea8a",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/cc867ebd6253deb0905be9547f915ab6d04aea8a",
      "created_at": "2024-03-13T12:44:09Z"
    },
    {
      "event": "commented",
      "id": 1994313253,
      "node_id": "IC_kwDOABII58523s4l",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1994313253",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-13T12:44:21Z",
      "updated_at": "2024-03-13T12:44:21Z",
      "author_association": "CONTRIBUTOR",
      "body": "`b6dce67064...cc867ebd62`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1994313253",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2000166681,
      "node_id": "IC_kwDOABII5853OB8Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2000166681",
      "actor": {
        "login": "iotamega",
        "id": 101424448,
        "node_id": "U_kgDOBgudQA",
        "avatar_url": "https://avatars.githubusercontent.com/u/101424448?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/iotamega",
        "html_url": "https://github.com/iotamega",
        "followers_url": "https://api.github.com/users/iotamega/followers",
        "following_url": "https://api.github.com/users/iotamega/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/iotamega/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/iotamega/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/iotamega/subscriptions",
        "organizations_url": "https://api.github.com/users/iotamega/orgs",
        "repos_url": "https://api.github.com/users/iotamega/repos",
        "events_url": "https://api.github.com/users/iotamega/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/iotamega/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-15T17:56:31Z",
      "updated_at": "2024-03-15T17:56:31Z",
      "author_association": "NONE",
      "body": "Is this going to be on by default or just an option?\r\n\r\nHaven't had a chance to look at the code submissions yet but I do have concerns if this is on by default that many corporate networks will start blocking installation or that transactions will not be submitted as many corporate networks block Tor or I2P connections by default at the corporate firewall level.\r\n\r\nI assume it has failovers as well if it is by default?",
      "user": {
        "login": "iotamega",
        "id": 101424448,
        "node_id": "U_kgDOBgudQA",
        "avatar_url": "https://avatars.githubusercontent.com/u/101424448?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/iotamega",
        "html_url": "https://github.com/iotamega",
        "followers_url": "https://api.github.com/users/iotamega/followers",
        "following_url": "https://api.github.com/users/iotamega/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/iotamega/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/iotamega/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/iotamega/subscriptions",
        "organizations_url": "https://api.github.com/users/iotamega/orgs",
        "repos_url": "https://api.github.com/users/iotamega/repos",
        "events_url": "https://api.github.com/users/iotamega/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/iotamega/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2000166681",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2000288460,
      "node_id": "IC_kwDOABII5853OfrM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2000288460",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-15T19:09:03Z",
      "updated_at": "2024-03-15T19:09:03Z",
      "author_association": "MEMBER",
      "body": "> Is this going to be on by default or just an option?\r\n\r\nThis PR only affects transactions sent with RPC `sendrawtransaction` and only if `-privatebroadcast=1` is configured, which is not default",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2000288460",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12153291763,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALUZIPz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12153291763",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "4828d462094d527dc95b8666627db0e1411f02a5",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/4828d462094d527dc95b8666627db0e1411f02a5",
      "created_at": "2024-03-18T14:32:42Z"
    },
    {
      "event": "commented",
      "id": 2004081907,
      "node_id": "IC_kwDOABII5853c9zz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2004081907",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-18T14:33:03Z",
      "updated_at": "2024-03-18T14:33:03Z",
      "author_association": "CONTRIBUTOR",
      "body": "`cc867ebd62...4828d46209`: rebase and address suggestions",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2004081907",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2008043439,
      "node_id": "IC_kwDOABII5853sE-v",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2008043439",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-19T20:10:34Z",
      "updated_at": "2024-03-19T20:10:34Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nI made similar solutions for [EPS](https://github.com/chris-belcher/electrum-personal-server/pull/124) and [CoreLightning](https://github.com/andrewtoth/broadcast-over-tor), which I'm happy to see being obviated by adding this functionality to the source!\r\n\r\nCurious why this is just pushing an unsolicited `TX` message instead of using `INV`/`GETDATA`/`TX`? [This conversation](https://github.com/bitcoin/bitcoin/pull/27509#discussion_r1186579724) seems to convince me the latter is better?\r\nAlso, if the submitted tx is spending unconfirmed outputs, should we support sending the parents to the peer if requested?\r\n",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2008043439",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2013120102,
      "node_id": "IC_kwDOABII5853_cZm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2013120102",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-21T17:23:34Z",
      "updated_at": "2024-03-21T17:23:34Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Curious why this is just pushing an unsolicited TX message instead of using INV/GETDATA/TX? https://github.com/bitcoin/bitcoin/pull/27509#discussion_r1186579724 seems to convince me the latter is better?\r\n\r\nI followed up in that conversion. For now I am keeping it as it is, but if you are happy with all the rest and would otherwise ACK, then say so! ;-)\r\n\r\n> Also, if the submitted tx is spending unconfirmed outputs, should we support sending the parents to the peer if requested?\r\n\r\nRight now in `master` `sendrawtransaction` RPC operates on a single transaction. Its parents must already be in the mempool. This PR keeps it that way. Parent+child is more for the `submitpackage` RPC. That + the wallet I will deal with in a followup PRs.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2013120102",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2015255608,
      "node_id": "IC_kwDOABII5854Hlw4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2015255608",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-22T14:43:07Z",
      "updated_at": "2024-03-22T14:52:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > Curious why this is just pushing an unsolicited TX message instead of using INV/GETDATA/TX? [#27509 (comment)](https://github.com/bitcoin/bitcoin/pull/27509#discussion_r1186579724) seems to convince me the latter is better?\r\n> \r\n> I followed up in that conversion. For now I am keeping it as it is, but if you are happy with all the rest and would otherwise ACK, then say so! ;-)\r\n\r\nThanks. I read through the proposal to not accept unsolicited `TX` messages, and the reasoning to reject it makes sense to me. I suppose if you know you're the originator of a tx, the only reason *not* to push the tx unsolicited to all your peers is for privacy reasons. However, in this case the privacy reasons are moot because of the ephemeral private connections.\r\n\r\n> \r\n> > Also, if the submitted tx is spending unconfirmed outputs, should we support sending the parents to the peer if requested?\r\n> \r\n> Right now in `master` `sendrawtransaction` RPC operates on a single transaction. Its parents must already be in the mempool. This PR keeps it that way. Parent+child is more for the `submitpackage` RPC. That + the wallet I will deal with in a followup PRs.\r\n\r\nI mean the case where we have a parent unconfirmed tx in our mempool, and the peer we connected to does not. If we push a tx spending that unconfirmed parent, the peer will respond with a `GETDATA` for the parent tx. So we can either:\r\n1. Ignore the `GETDATA` . This will result in our tx not relaying through this connection if the peer doesn't have all unconfirmed parents.\r\n2. Wait for the `GETDATA` and respond with a `TX` message. We won't know if the peer will eventually ask for the parent, so this will be tricky and we will have to wait for some time. However, in this time if we receive an `INV` for it from another peer we can close because we know we were successful.\r\n3. Push all unconfirmed parents along with the tx we are sending. This will result in potentially wasted bandwidth.\r\n",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2015255608",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 1961307297,
      "node_id": "PRR_kwDOABII58505yyh",
      "url": null,
      "actor": null,
      "commit_id": "4828d462094d527dc95b8666627db0e1411f02a5",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-03-26T21:47:27Z",
      "author_association": "CONTRIBUTOR",
      "body": "Haven't finished my review yet, but submitting a few comments.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1961307297",
      "submitted_at": "2024-03-26T21:47:27Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "commented",
      "id": 2023117355,
      "node_id": "IC_kwDOABII5854llIr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2023117355",
      "actor": {
        "login": "jb55",
        "id": 45598,
        "node_id": "MDQ6VXNlcjQ1NTk4",
        "avatar_url": "https://avatars.githubusercontent.com/u/45598?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jb55",
        "html_url": "https://github.com/jb55",
        "followers_url": "https://api.github.com/users/jb55/followers",
        "following_url": "https://api.github.com/users/jb55/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jb55/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jb55/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jb55/subscriptions",
        "organizations_url": "https://api.github.com/users/jb55/orgs",
        "repos_url": "https://api.github.com/users/jb55/repos",
        "events_url": "https://api.github.com/users/jb55/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jb55/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-27T15:51:53Z",
      "updated_at": "2024-03-27T15:51:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "Oh wow just saw this! Thank you. Will review.",
      "user": {
        "login": "jb55",
        "id": 45598,
        "node_id": "MDQ6VXNlcjQ1NTk4",
        "avatar_url": "https://avatars.githubusercontent.com/u/45598?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jb55",
        "html_url": "https://github.com/jb55",
        "followers_url": "https://api.github.com/users/jb55/followers",
        "following_url": "https://api.github.com/users/jb55/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jb55/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jb55/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jb55/subscriptions",
        "organizations_url": "https://api.github.com/users/jb55/orgs",
        "repos_url": "https://api.github.com/users/jb55/repos",
        "events_url": "https://api.github.com/users/jb55/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jb55/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2023117355",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2025920443,
      "node_id": "IC_kwDOABII5854wRe7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2025920443",
      "actor": {
        "login": "zzzi2p",
        "id": 62618568,
        "node_id": "MDQ6VXNlcjYyNjE4NTY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/62618568?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/zzzi2p",
        "html_url": "https://github.com/zzzi2p",
        "followers_url": "https://api.github.com/users/zzzi2p/followers",
        "following_url": "https://api.github.com/users/zzzi2p/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/zzzi2p/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/zzzi2p/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/zzzi2p/subscriptions",
        "organizations_url": "https://api.github.com/users/zzzi2p/orgs",
        "repos_url": "https://api.github.com/users/zzzi2p/repos",
        "events_url": "https://api.github.com/users/zzzi2p/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/zzzi2p/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-28T19:08:15Z",
      "updated_at": "2024-03-28T19:08:15Z",
      "author_association": "NONE",
      "body": "Concept ACK\r\n\r\nThis is consistent with i2p guidelines on resource usage.\r\nGood work!",
      "user": {
        "login": "zzzi2p",
        "id": 62618568,
        "node_id": "MDQ6VXNlcjYyNjE4NTY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/62618568?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/zzzi2p",
        "html_url": "https://github.com/zzzi2p",
        "followers_url": "https://api.github.com/users/zzzi2p/followers",
        "following_url": "https://api.github.com/users/zzzi2p/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/zzzi2p/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/zzzi2p/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/zzzi2p/subscriptions",
        "organizations_url": "https://api.github.com/users/zzzi2p/orgs",
        "repos_url": "https://api.github.com/users/zzzi2p/repos",
        "events_url": "https://api.github.com/users/zzzi2p/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/zzzi2p/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2025920443",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12293835861,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALcxQxV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12293835861",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "09ad469cc10081594ac1e312043a0e47901ba547",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/09ad469cc10081594ac1e312043a0e47901ba547",
      "created_at": "2024-03-29T10:47:40Z"
    },
    {
      "event": "commented",
      "id": 2027063667,
      "node_id": "IC_kwDOABII58540olz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2027063667",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-29T10:48:02Z",
      "updated_at": "2024-03-29T10:48:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "`4828d46209...09ad469cc1`: rebase and address suggestions",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2027063667",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2027080005,
      "node_id": "IC_kwDOABII58540slF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2027080005",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-29T11:02:31Z",
      "updated_at": "2024-03-29T11:02:31Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I mean the case where we have a parent unconfirmed tx in our mempool, and the peer we connected to does not. If we push a tx spending that unconfirmed parent, the peer will respond with a `GETDATA` for the parent tx...\r\n\r\nI will keep it simple stupid for now, meaning that in this case that particular peer will not relay the transaction further. Others should succeed. If \"nobody\" has the parent in their mempool, then somehow we are trying to broadcast an orphaned transaction with parent(s) not seen by the network. Can say that this is not supported at this point and will best be supported by a future `submitpackage` which does private broadcast.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2027080005",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12294241122,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALcyzti",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12294241122",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "c7e4d5cb2bf01d9719702e71c8d6264ee670e988",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/c7e4d5cb2bf01d9719702e71c8d6264ee670e988",
      "created_at": "2024-03-29T11:41:10Z"
    },
    {
      "event": "commented",
      "id": 2027122878,
      "node_id": "IC_kwDOABII585403C-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2027122878",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-29T11:41:15Z",
      "updated_at": "2024-03-29T11:41:15Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\nðŸš§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/23235305634</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2027122878",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 12294241457,
      "node_id": "LE_lADOABII585-yiT2zwAAAALcyzyx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12294241457",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-29T11:41:15Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1969324333,
      "node_id": "PRR_kwDOABII5851YYEt",
      "url": null,
      "actor": null,
      "commit_id": "c7e4d5cb2bf01d9719702e71c8d6264ee670e988",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-03-29T18:35:13Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1969324333",
      "submitted_at": "2024-03-29T18:35:13Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 1969597243,
      "node_id": "PRR_kwDOABII5851Zas7",
      "url": null,
      "actor": null,
      "commit_id": "cf76f4f0fe1a3ef0730f70a035c10e01712b6d6b",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-03-29T20:55:52Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1969597243",
      "submitted_at": "2024-03-29T20:55:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 1969951271,
      "node_id": "PRR_kwDOABII5851axIn",
      "url": null,
      "actor": null,
      "commit_id": "c7e4d5cb2bf01d9719702e71c8d6264ee670e988",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-03-30T14:20:06Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1969951271",
      "submitted_at": "2024-03-30T14:20:06Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 1970997616,
      "node_id": "PRR_kwDOABII5851ewlw",
      "url": null,
      "actor": null,
      "commit_id": "b1f65ba837a805dc8f855c02337c1593c77add6d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-04-01T09:47:19Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1970997616",
      "submitted_at": "2024-04-01T09:47:19Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 1971157352,
      "node_id": "PRR_kwDOABII5851fXlo",
      "url": null,
      "actor": null,
      "commit_id": "b1f65ba837a805dc8f855c02337c1593c77add6d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-04-01T12:12:12Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1971157352",
      "submitted_at": "2024-04-01T12:12:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12312725519,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALd5UgP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12312725519",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "413574e81ef4d608b9b0a2079f81a4e90ee2a341",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/413574e81ef4d608b9b0a2079f81a4e90ee2a341",
      "created_at": "2024-04-01T16:20:57Z"
    },
    {
      "event": "commented",
      "id": 2030100651,
      "node_id": "IC_kwDOABII5855AOCr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2030100651",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-01T16:25:57Z",
      "updated_at": "2024-04-01T16:25:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "`c7e4d5cb2b...413574e81e`: rebase and address suggestions",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2030100651",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 1971975903,
      "node_id": "PRR_kwDOABII5851ifbf",
      "url": null,
      "actor": null,
      "commit_id": "413574e81ef4d608b9b0a2079f81a4e90ee2a341",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-04-01T19:29:12Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1971975903",
      "submitted_at": "2024-04-01T19:29:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "referenced",
      "id": 12327287070,
      "node_id": "REFE_lADOABII585-yiT2zwAAAALew3ke",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12327287070",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "3b987d03a49964995dced76889634561fd363d28",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3b987d03a49964995dced76889634561fd363d28",
      "created_at": "2024-04-02T14:47:12Z"
    },
    {
      "event": "labeled",
      "id": 12327500578,
      "node_id": "LE_lADOABII585-yiT2zwAAAALexrsi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12327500578",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-02T14:58:51Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12329000950,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALe3Z_2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12329000950",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "390e628a07ce62d32deae4bcfa1bdb31f5a0e125",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/390e628a07ce62d32deae4bcfa1bdb31f5a0e125",
      "created_at": "2024-04-02T16:39:40Z"
    },
    {
      "event": "commented",
      "id": 2032545515,
      "node_id": "IC_kwDOABII5855Ji7r",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2032545515",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-02T16:40:02Z",
      "updated_at": "2024-04-02T16:40:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "`413574e81e...390e628a07`: rebase due to conflicts and address suggestion",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2032545515",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 12329529594,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAALe5bD6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12329529594",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-02T17:22:10Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1974917244,
      "node_id": "PRR_kwDOABII5851tth8",
      "url": null,
      "actor": null,
      "commit_id": "390e628a07ce62d32deae4bcfa1bdb31f5a0e125",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-04-02T21:56:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "Do we need test coverage for retrying stale txs and having multiple concurrent txs queued for private broadcast?",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1974917244",
      "submitted_at": "2024-04-02T21:56:50Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12357568855,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALgkYlX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12357568855",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "9297437af2c2f45a7b9a12be78fa0e597c54ac79",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/9297437af2c2f45a7b9a12be78fa0e597c54ac79",
      "created_at": "2024-04-04T12:37:52Z"
    },
    {
      "event": "commented",
      "id": 2037088808,
      "node_id": "IC_kwDOABII5855a4Io",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2037088808",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-04T12:39:01Z",
      "updated_at": "2024-04-04T12:39:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "`390e628a07...9297437af2`: rebase and address suggestions\r\n\r\n> Do we need test coverage for retrying stale txs and having multiple concurrent txs queued for private broadcast?\r\n\r\nYes.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2037088808",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 12362421618,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAALg25Vy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12362421618",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-04T17:46:39Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1985948537,
      "node_id": "PRR_kwDOABII5852Xyt5",
      "url": null,
      "actor": null,
      "commit_id": "9297437af2c2f45a7b9a12be78fa0e597c54ac79",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-04-08T09:48:36Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1985948537",
      "submitted_at": "2024-04-08T09:48:36Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 1984991157,
      "node_id": "PRR_kwDOABII5852UI-1",
      "url": null,
      "actor": null,
      "commit_id": "9297437af2c2f45a7b9a12be78fa0e597c54ac79",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-04-08T10:07:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "cACK, with a suggestion and some observations on the design space WRT reliability/success.\r\n\r\n> Yes, if `-proxyrandomize=1` (the default). This is the same in `master` - separate Tor circuit per connection.\r\n\r\nIf this is not the case and a peer to which a long lived connection already exists is selected again, then tor will multiplex both connections on the same established circuit, which means that the two connections are unambiguously correlated.\r\n\r\nAvoiding already connected peers would work around this, but perhaps it's sufficient just to warn on startup if `privatebroadcast=1` and `proxyrandomize=0`, since that is unlikely to be configured (requires opt out & opt in), and unlikely to be an issue even if it is configured since a malicious peer would need to be selected twice.\r\n\r\nThis would be less of a concern if clearnet hosts are also allowed, since the likelyhood of selecting the same peer diminishes quadratically in the size of the set of potential peers.\r\n\r\n> > I assume you are restricting the feature to sendraw so the wallet doesn't get involved and try something silly like rebroadcasting over clearnet or inserting in to our own mempool?\r\n> \r\n> The reason to omit the wallet is that it currently does not count non-mempool change.\r\n\r\nIf I understand correctly, the concern with rebroadcasting still applies, but in the case that private broadcast was successful?",
      "user": {
        "login": "nothingmuch",
        "id": 14242,
        "node_id": "MDQ6VXNlcjE0MjQy",
        "avatar_url": "https://avatars.githubusercontent.com/u/14242?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nothingmuch",
        "html_url": "https://github.com/nothingmuch",
        "followers_url": "https://api.github.com/users/nothingmuch/followers",
        "following_url": "https://api.github.com/users/nothingmuch/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nothingmuch/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nothingmuch/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nothingmuch/subscriptions",
        "organizations_url": "https://api.github.com/users/nothingmuch/orgs",
        "repos_url": "https://api.github.com/users/nothingmuch/repos",
        "events_url": "https://api.github.com/users/nothingmuch/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nothingmuch/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1984991157",
      "submitted_at": "2024-04-08T10:07:31Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "subscribed",
      "id": 12510434826,
      "node_id": "SE_lADOABII585-yiT2zwAAAALprhYK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12510434826",
      "actor": {
        "login": "sethforprivacy",
        "id": 40500387,
        "node_id": "MDQ6VXNlcjQwNTAwMzg3",
        "avatar_url": "https://avatars.githubusercontent.com/u/40500387?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sethforprivacy",
        "html_url": "https://github.com/sethforprivacy",
        "followers_url": "https://api.github.com/users/sethforprivacy/followers",
        "following_url": "https://api.github.com/users/sethforprivacy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sethforprivacy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sethforprivacy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sethforprivacy/subscriptions",
        "organizations_url": "https://api.github.com/users/sethforprivacy/orgs",
        "repos_url": "https://api.github.com/users/sethforprivacy/repos",
        "events_url": "https://api.github.com/users/sethforprivacy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sethforprivacy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-17T15:43:46Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12579051072,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALtxRZA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12579051072",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "cc760207b80e5dc62ab9c88fea08623dba2881fa",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/cc760207b80e5dc62ab9c88fea08623dba2881fa",
      "created_at": "2024-04-23T17:19:27Z"
    },
    {
      "event": "commented",
      "id": 2072977453,
      "node_id": "IC_kwDOABII5857jyAt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2072977453",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-23T17:21:28Z",
      "updated_at": "2024-04-23T17:21:28Z",
      "author_association": "CONTRIBUTOR",
      "body": "`9297437af2...cc760207b8`: rebase and address suggestions:\r\n\r\n* Give a startup warning if `-privatebroadcast=1`, `-proxyrandomize=0` and the Tor network is reachable (i.e. we will use Tor for private broadcast).\r\n* Enforce `-walletbroadcast=0` if `-privatebroadcast=1` because it would be confusing to have the wallet do the traditional broadcast while the `sendrawtransaction` RPC does a private broadcast. Furthermore if a wallet transaction is sent via `sendrawtransaction` and ends up in the mempool from outside and is not mined for some time, then the wallet will try to broadcast it using the traditional mechanism.\r\n* Private broadcast also to IPv4 and IPv6 peers (!) through the Tor proxy.\r\n* Remove conflicting Tor address from the functional test and don't log every address added to addrman.\r\n",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2072977453",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2072989163,
      "node_id": "IC_kwDOABII5857j03r",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2072989163",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-23T17:27:56Z",
      "updated_at": "2024-04-23T17:28:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Avoiding already connected peers would work around this, but perhaps it's sufficient just to warn on startup if privatebroadcast=1 and proxyrandomize=0\r\n\r\nIn `master` we already avoid connecting to an already connected address, regardless of the connection type:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/256e1703197fdddd78bc6d659431cd0fc3b63cde/src/net.cpp#L2862\r\n\r\nI added a startup warning anyway.\r\n\r\n\r\n\r\n> > > I assume you are restricting the feature to sendraw so the wallet doesn't get involved and try something silly like rebroadcasting over clearnet or inserting in to our own mempool?\r\n\r\n> > The reason to omit the wallet is that it currently does not count non-mempool change.\r\n\r\n> If I understand correctly, the concern with rebroadcasting still applies, but in the case that private broadcast was successful?\r\n\r\nYes, I enforced `walletbroadcast=0` to avoid the wallet rebroadcasting.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2072989163",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 12581093248,
      "node_id": "LE_lADOABII585-yiT2zwAAAALt5D-A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12581093248",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-23T20:07:43Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12587089329,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALuP72x",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12587089329",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "ea1ca3715ed8ad42632537850a571031d4f54d47",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/ea1ca3715ed8ad42632537850a571031d4f54d47",
      "created_at": "2024-04-24T07:28:55Z"
    },
    {
      "event": "commented",
      "id": 2074267427,
      "node_id": "IC_kwDOABII5857os8j",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2074267427",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-24T07:30:38Z",
      "updated_at": "2024-04-24T07:30:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "`cc760207b8...ea1ca3715e`: adjust `feature_config_args.py` after forbidding `-walletbroadcast` when `-privatebroadcast` is enabled.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2074267427",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12592119310,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALujH4O",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12592119310",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "fd603b8f5c23c171e1cff70a73f5d64d6d74c4f7",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/fd603b8f5c23c171e1cff70a73f5d64d6d74c4f7",
      "created_at": "2024-04-24T13:35:59Z"
    },
    {
      "event": "unlabeled",
      "id": 12596290018,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAALuzCHi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12596290018",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-24T18:16:15Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 12615610375,
      "node_id": "LE_lADOABII585-yiT2zwAAAALv8vAH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12615610375",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-25T21:14:04Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2020968807,
      "node_id": "PRR_kwDOABII5854dYln",
      "url": null,
      "actor": null,
      "commit_id": "fd603b8f5c23c171e1cff70a73f5d64d6d74c4f7",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-04-25T22:34:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "Did another round of review.\r\n\r\nnit: `local tx relay` -> `private broadcast` in last commit message",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2020968807",
      "submitted_at": "2024-04-25T22:34:46Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 2031166535,
      "node_id": "PRR_kwDOABII5855ESRH",
      "url": null,
      "actor": null,
      "commit_id": "6b4693ee859d6bddf559a0b32749b1dafe015ef4",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-04-30T12:22:03Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2031166535",
      "submitted_at": "2024-04-30T12:22:03Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12670568263,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALzOYdH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12670568263",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "42cb08060053a41de4c5c0ed681d939c3708c2e5",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/42cb08060053a41de4c5c0ed681d939c3708c2e5",
      "created_at": "2024-05-01T13:40:14Z"
    },
    {
      "event": "commented",
      "id": 2088480026,
      "node_id": "IC_kwDOABII5858e60a",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2088480026",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-01T13:40:26Z",
      "updated_at": "2024-05-01T13:40:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "`fd603b8f5c...42cb080600`: rebase and address suggestions",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2088480026",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12670660262,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALzOu6m",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12670660262",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "7a0debb8fbd1a6f2b49ff4f33defe103e73dcb8a",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/7a0debb8fbd1a6f2b49ff4f33defe103e73dcb8a",
      "created_at": "2024-05-01T13:47:09Z"
    },
    {
      "event": "unlabeled",
      "id": 12671755684,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAALzS6Wk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12671755684",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-01T15:28:31Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12672028991,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAALzT9E_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12672028991",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "65ba8d02034d8fd0eb4c680614197cab6f1892fc",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/65ba8d02034d8fd0eb4c680614197cab6f1892fc",
      "created_at": "2024-05-01T15:54:04Z"
    },
    {
      "event": "labeled",
      "id": 12672030472,
      "node_id": "LE_lADOABII585-yiT2zwAAAALzT9cI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12672030472",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-01T15:54:10Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 12674460856,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAALzdOy4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12674460856",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-01T20:16:28Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2041604763,
      "node_id": "PRR_kwDOABII5855sGqb",
      "url": null,
      "actor": null,
      "commit_id": "65ba8d02034d8fd0eb4c680614197cab6f1892fc",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-05-13T14:57:31Z",
      "author_association": "MEMBER",
      "body": "Code review up to 28adad8eefd18a62232b5c77cbc9ca739a53308d (no tests so far).\r\n\r\nThe main thing I'm wondering currently is why are we tacking `m_private_broadcast_connections_to_open` loosely? It feels harder to reason about, but I don't see what the benefit of it is.",
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2041604763",
      "submitted_at": "2024-05-13T14:57:31Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 2052999547,
      "node_id": "PRR_kwDOABII5856Xkl7",
      "url": null,
      "actor": null,
      "commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-05-13T15:12:31Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2052999547",
      "submitted_at": "2024-05-13T15:12:31Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12880140919,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAL_t1p3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12880140919",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "e85cc59badd357219213a6bda985a9fd93910a5c",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/e85cc59badd357219213a6bda985a9fd93910a5c",
      "created_at": "2024-05-21T13:17:50Z"
    },
    {
      "event": "commented",
      "id": 2122621311,
      "node_id": "IC_kwDOABII585-hKF_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2122621311",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-21T13:18:59Z",
      "updated_at": "2024-05-21T13:24:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "`65ba8d0203...e85cc59bad`: rebase, address suggestions and remove the argument of `ProxyForClearnetPrivateBroadcast()` because it is always IPv4 or IPv6 and we treat both in the same way.\r\n\r\n> The main thing I'm wondering currently is why are we tacking m_private_broadcast_connections_to_open loosely? It feels harder to reason about, but I don't see what the benefit of it is.\r\n\r\nContinued at https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608327017 to avoid overwhelming the main discussion thread of the PR and to make replies close to each other (rather than scattered in the main thread).",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2122621311",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 2068635557,
      "node_id": "PRR_kwDOABII5857TN-l",
      "url": null,
      "actor": null,
      "commit_id": "e85cc59badd357219213a6bda985a9fd93910a5c",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-05-21T13:21:58Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2068635557",
      "submitted_at": "2024-05-21T13:21:58Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12897197774,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAMAu57O",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12897197774",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "057c79365c35ad802584379ebedb8b6542216214",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/057c79365c35ad802584379ebedb8b6542216214",
      "created_at": "2024-05-22T16:15:53Z"
    },
    {
      "event": "commented",
      "id": 2125213533,
      "node_id": "IC_kwDOABII585-rC9d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2125213533",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-22T16:22:20Z",
      "updated_at": "2024-05-22T16:22:20Z",
      "author_association": "CONTRIBUTOR",
      "body": "`e85cc59bad...057c79365c`: in order to decide whether to private broadcast to IPv4/IPv6 peers, instead of (before this force push) requiring that `-onion=` is explicitly set, do this (after this force push): keep track if we ever managed to connect to an `.onion` address via the `NET_ONION` proxy, if yes assume that this proxy is a Tor proxy and connecting to IPv4/IPv6 addresses through it will be done via the Tor network and via a Tor exit node.\r\n\r\nThis is better because it is stronger guarantee (before the user could still misconfigure an orginary non-Tor proxy as `-onion=`) and works automatically, without requiring config options to be set.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2125213533",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "referenced",
      "id": 12905379001,
      "node_id": "REFE_lADOABII585-yiT2zwAAAAMBOHS5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12905379001",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "a63c7c7ea2dff07e76dd2cf2398cb150667ac86c",
      "commit_url": "https://api.github.com/repos/vasild/pushtx/commits/a63c7c7ea2dff07e76dd2cf2398cb150667ac86c",
      "created_at": "2024-05-23T08:14:53Z"
    },
    {
      "event": "referenced",
      "id": 12906443115,
      "node_id": "REFE_lADOABII585-yiT2zwAAAAMBSLFr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12906443115",
      "actor": {
        "login": "alfred-hodler",
        "id": 100861939,
        "node_id": "U_kgDOBgMH8w",
        "avatar_url": "https://avatars.githubusercontent.com/u/100861939?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alfred-hodler",
        "html_url": "https://github.com/alfred-hodler",
        "followers_url": "https://api.github.com/users/alfred-hodler/followers",
        "following_url": "https://api.github.com/users/alfred-hodler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/alfred-hodler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/alfred-hodler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/alfred-hodler/subscriptions",
        "organizations_url": "https://api.github.com/users/alfred-hodler/orgs",
        "repos_url": "https://api.github.com/users/alfred-hodler/repos",
        "events_url": "https://api.github.com/users/alfred-hodler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/alfred-hodler/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "cb75581df22098dcd90dc2989cfc63bbe2262ff7",
      "commit_url": "https://api.github.com/repos/alfred-hodler/pushtx/commits/cb75581df22098dcd90dc2989cfc63bbe2262ff7",
      "created_at": "2024-05-23T09:29:52Z"
    },
    {
      "event": "labeled",
      "id": 13138066829,
      "node_id": "LE_lADOABII585-yiT2zwAAAAMPFv2N",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13138066829",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-12T22:34:44Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13229513265,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAMUilox",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13229513265",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "7a7e7d189dfe5efa6ab3c644f55f410412163503",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/7a7e7d189dfe5efa6ab3c644f55f410412163503",
      "created_at": "2024-06-20T13:44:34Z"
    },
    {
      "event": "commented",
      "id": 2180745584,
      "node_id": "IC_kwDOABII586B-4lw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2180745584",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-20T13:44:46Z",
      "updated_at": "2024-06-20T13:44:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "`057c79365c...7a7e7d189d`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2180745584",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 13229692616,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAMUjRbI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13229692616",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-20T13:56:17Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2142672720,
      "node_id": "PRR_kwDOABII585_tpdQ",
      "url": null,
      "actor": null,
      "commit_id": "7a7e7d189dfe5efa6ab3c644f55f410412163503",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-06-26T19:49:39Z",
      "author_association": "MEMBER",
      "body": "Re-reviewed first half of commits, will continue tomorrow. A few comments and questions below.",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2142672720",
      "submitted_at": "2024-06-26T19:49:39Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 2146390857,
      "node_id": "PRR_kwDOABII585_71NJ",
      "url": null,
      "actor": null,
      "commit_id": "7a7e7d189dfe5efa6ab3c644f55f410412163503",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-06-27T20:20:05Z",
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2146390857",
      "submitted_at": "2024-06-27T20:20:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 2148337702,
      "node_id": "PRR_kwDOABII586ADQgm",
      "url": null,
      "actor": null,
      "commit_id": "7a7e7d189dfe5efa6ab3c644f55f410412163503",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-06-28T17:51:53Z",
      "author_association": "MEMBER",
      "body": "code review ACK 7a7e7d189dfe5efa6ab3c644f55f410412163503\r\n\r\nsome questions and comments above and below (sorry spread out review over a few days)\r\n\r\nI want to run this in warnet again with a lot more TXs and see how we do as well",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2148337702",
      "submitted_at": "2024-06-28T17:51:53Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "review_requested",
      "id": 13334706810,
      "node_id": "RRE_lADOABII585-yiT2zwAAAAMaz3p6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13334706810",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-28T17:51:59Z",
      "requested_reviewer": {
        "login": "nothingmuch",
        "id": 14242,
        "node_id": "MDQ6VXNlcjE0MjQy",
        "avatar_url": "https://avatars.githubusercontent.com/u/14242?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nothingmuch",
        "html_url": "https://github.com/nothingmuch",
        "followers_url": "https://api.github.com/users/nothingmuch/followers",
        "following_url": "https://api.github.com/users/nothingmuch/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nothingmuch/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nothingmuch/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nothingmuch/subscriptions",
        "organizations_url": "https://api.github.com/users/nothingmuch/orgs",
        "repos_url": "https://api.github.com/users/nothingmuch/repos",
        "events_url": "https://api.github.com/users/nothingmuch/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nothingmuch/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 13334706899,
      "node_id": "RRE_lADOABII585-yiT2zwAAAAMaz3rT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13334706899",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-28T17:52:00Z",
      "requested_reviewer": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13363901881,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAMcjPW5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13363901881",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "3bd618a91fe3935399d380d254996e4263586c80",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/3bd618a91fe3935399d380d254996e4263586c80",
      "created_at": "2024-07-02T10:42:45Z"
    },
    {
      "event": "commented",
      "id": 2202707437,
      "node_id": "IC_kwDOABII586DSqXt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2202707437",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-02T10:43:00Z",
      "updated_at": "2024-07-02T10:43:00Z",
      "author_association": "CONTRIBUTOR",
      "body": "`7a7e7d189d...3bd618a91f`: rebase and address suggestions",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2202707437",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2203472829,
      "node_id": "IC_kwDOABII586DVlO9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2203472829",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-02T15:04:55Z",
      "updated_at": "2024-07-02T15:04:55Z",
      "author_association": "MEMBER",
      "body": "utACK 3bd618a91f\r\n\r\nCode changes since last review look good.",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2203472829",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 2154365549,
      "node_id": "PRR_kwDOABII586AaQJt",
      "url": null,
      "actor": null,
      "commit_id": "3bd618a91fe3935399d380d254996e4263586c80",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-07-02T19:18:51Z",
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2154365549",
      "submitted_at": "2024-07-02T19:18:51Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "labeled",
      "id": 13393484026,
      "node_id": "LE_lADOABII585-yiT2zwAAAAMeUFj6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13393484026",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-04T11:22:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13710036067,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAMxLoxj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13710036067",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "8baf19fb2af5f8c0742ba5ef5007f3e4a632be08",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/8baf19fb2af5f8c0742ba5ef5007f3e4a632be08",
      "created_at": "2024-07-31T13:25:25Z"
    },
    {
      "event": "commented",
      "id": 2260523021,
      "node_id": "IC_kwDOABII586GvNgN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2260523021",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-31T13:25:48Z",
      "updated_at": "2024-07-31T13:25:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "`3bd618a91f...8baf19fb2a`:\r\n\r\n* Rebase due to conflicts.\r\n\r\n* Tune the logic of the decision to open a private broadcast connection - we yield to other connection types every other attempt, but it might happen that when we yield the loop blocks on the `semOutbound` grant. This means that we are not ready to open other connection types. In this case and if private broadcast is needed, proceed with private broadcast even if the previous connection was private broadcast as well. This simplifies `ShouldOpen()` as the logic \"previous was private broadcast\" is moved to the caller.\r\n\r\n* Rename `tor_proxy` to `proxy_for_ipv4or6` and actually set it, it's used only for logging.\r\n\r\n* Run transactions to be broadcast through mempool acceptance test, they were not before.\r\n\r\n* If the same transaction is repeatedly given to `sendrawtransaction` RPC, then don't open 5 new private broadcast connections every time. Change subsequent requests to do nothing but log a message that it was not necessary to `sendrawtransaction` the transaction again.\r\n\r\n* Change the extension of the SOCKS5 proxy - instead of being given a set of predefined destinations to redirect the connections to, it is now given a callback function which returns the destination where to redirect, or it can decide to return `None` asking the SOCKS5 proxy to close the connection (default behavior). This is more flexible.\r\n\r\n* Move `create_malleated_version()` from `p2p_orphan_handling.py` to `test_framework/messages.py` where it can be reused.\r\n\r\n* Extend the functional tests as per https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1663040526, thanks @instagibbs for the suggestions!\r\n",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2260523021",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 13710042030,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAMxLqOu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13710042030",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-31T13:25:49Z"
    },
    {
      "event": "subscribed",
      "id": 13710042052,
      "node_id": "SE_lADOABII585-yiT2zwAAAAMxLqPE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13710042052",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-31T13:25:49Z"
    },
    {
      "event": "unlabeled",
      "id": 13711443663,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAMxRAbP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13711443663",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-31T14:57:27Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2260951219,
      "node_id": "IC_kwDOABII586Gw2Cz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2260951219",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-31T16:50:35Z",
      "updated_at": "2024-07-31T16:50:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/28160559851</sub>\n\n<details><summary>Hints</summary>\n\nMake sure to run all tests locally, according to the documentation.\n\nThe failure may happen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2260951219",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 13712888228,
      "node_id": "LE_lADOABII585-yiT2zwAAAAMxWhGk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13712888228",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-31T16:50:35Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13721718821,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAMx4NAl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13721718821",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "97ae670dc4713c38b23e44e955f66c1ae11e344f",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/97ae670dc4713c38b23e44e955f66c1ae11e344f",
      "created_at": "2024-08-01T08:18:01Z"
    },
    {
      "event": "commented",
      "id": 2262339302,
      "node_id": "IC_kwDOABII586G2I7m",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2262339302",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-01T08:20:26Z",
      "updated_at": "2024-08-01T08:20:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "`8baf19fb2a...97ae670dc4`: fix the scope of two local variables in `socks5.py`",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2262339302",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13723054292,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAMx9TDU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13723054292",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "created_at": "2024-08-01T09:35:42Z"
    },
    {
      "event": "commented",
      "id": 2262596528,
      "node_id": "IC_kwDOABII586G3Huw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2262596528",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-01T09:36:05Z",
      "updated_at": "2024-08-01T09:36:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "`97ae670dc4...30ec819596`: pet the python linter",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2262596528",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 13724103910,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAMyBTTm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13724103910",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-01T10:52:16Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2212563874,
      "node_id": "PRR_kwDOABII586D4Qui",
      "url": null,
      "actor": null,
      "commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-08-01T13:52:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "30ec819596f4000b46c9b7bf8d3ee1518af5d533 tested several things/scenarios and succesfully privately broadcasted several transactionsâœ…",
      "user": {
        "login": "MarnixCroes",
        "id": 93143998,
        "node_id": "U_kgDOBY1Dvg",
        "avatar_url": "https://avatars.githubusercontent.com/u/93143998?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarnixCroes",
        "html_url": "https://github.com/MarnixCroes",
        "followers_url": "https://api.github.com/users/MarnixCroes/followers",
        "following_url": "https://api.github.com/users/MarnixCroes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarnixCroes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarnixCroes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarnixCroes/subscriptions",
        "organizations_url": "https://api.github.com/users/MarnixCroes/orgs",
        "repos_url": "https://api.github.com/users/MarnixCroes/repos",
        "events_url": "https://api.github.com/users/MarnixCroes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarnixCroes/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2212563874",
      "submitted_at": "2024-08-01T13:52:41Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13738927098,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAMy52P6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13738927098",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "2b478bf332eeeec8ee7fba1439660b4e591409bc",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/2b478bf332eeeec8ee7fba1439660b4e591409bc",
      "created_at": "2024-08-02T09:13:26Z"
    },
    {
      "event": "commented",
      "id": 2264935052,
      "node_id": "IC_kwDOABII586HACqM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2264935052",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-02T09:14:04Z",
      "updated_at": "2024-08-02T09:14:04Z",
      "author_association": "CONTRIBUTOR",
      "body": "`30ec819596...2b478bf332`: update description of `-privatebroadcast` as per https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1700042799",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2264935052",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2267359160,
      "node_id": "IC_kwDOABII586HJSe4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2267359160",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-04T06:08:43Z",
      "updated_at": "2024-08-04T06:11:30Z",
      "author_association": "CONTRIBUTOR",
      "body": "This shouldn't send transactions without sending an INV.  Instead, it should INV and wait for the GETDATA. (thanks to mzumsande for making a note of the behavior).",
      "user": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2267359160",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 13756819425,
      "node_id": "LE_lADOABII585-yiT2zwAAAAMz-Gfh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13756819425",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-05T01:40:44Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2271875972,
      "node_id": "IC_kwDOABII586HahOE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2271875972",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-06T18:17:09Z",
      "updated_at": "2024-08-06T18:17:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "> This shouldn't send transactions without sending an INV. Instead, it should INV and wait for the GETDATA. (thanks to mzumsande for making a note of the behavior).\r\n\r\nFor context, an old discussion on this: https://github.com/bitcoin/bitcoin/pull/27509#discussion_r1186579724  (I want to think a bit more on the potential benefits of #30572 before voicing an opinion).",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2271875972",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2273546756,
      "node_id": "IC_kwDOABII586Hg5IE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2273546756",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-07T13:58:53Z",
      "updated_at": "2024-08-07T13:59:47Z",
      "author_association": "MEMBER",
      "body": "> (I want to think a bit more on the potential benefits of https://github.com/bitcoin/bitcoin/pull/30572 before voicing an opinion).\r\n\r\nThe cost here is that if this PR stays as-is, we can't change our minds later abour 30572, fwiw. It's something I've noted a few times elsewhere.",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2273546756",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13860348322,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAM6JCGi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13860348322",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "11364e2e58807cce2ab936cc5098a28e76063b48",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/11364e2e58807cce2ab936cc5098a28e76063b48",
      "created_at": "2024-08-13T09:17:12Z"
    },
    {
      "event": "commented",
      "id": 2285769580,
      "node_id": "IC_kwDOABII586IPhNs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2285769580",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-13T09:17:44Z",
      "updated_at": "2024-08-13T09:17:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "`2b478bf332...11364e2e58`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2285769580",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 13860740588,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAM6Kh3s",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13860740588",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-13T09:45:10Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2286098751,
      "node_id": "IC_kwDOABII586IQxk_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2286098751",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-13T12:11:35Z",
      "updated_at": "2024-08-13T12:11:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "`11364e2e58..2db437fbd1`: do the transaction send with `INV+GETDATA+TX` instead of just `TX`, so that this PR is now not related or tied to #30572.\r\n\r\nI think this complicates the code without providing a benefit, thus my preference is to avoid it, so I kept the change in separate commits (the two on the top of the branch). It can be reviewed separately and squashed accordingly if people like it, or easily dropped.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2286098751",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 13863450129,
      "node_id": "LE_lADOABII585-yiT2zwAAAAM6U3YR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13863450129",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-13T13:18:34Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2286235225,
      "node_id": "IC_kwDOABII586IRS5Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2286235225",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-13T13:18:35Z",
      "updated_at": "2024-08-13T13:18:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/28704849578</sub>\n\n<details><summary>Hints</summary>\n\nMake sure to run all tests locally, according to the documentation.\n\nThe failure may happen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2286235225",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13864137238,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAM6XfIW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13864137238",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "df3a22f87af02bbe9659f0abad2141e0333a0e4a",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/df3a22f87af02bbe9659f0abad2141e0333a0e4a",
      "created_at": "2024-08-13T14:04:31Z"
    },
    {
      "event": "commented",
      "id": 2286346598,
      "node_id": "IC_kwDOABII586IRuFm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2286346598",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-13T14:06:09Z",
      "updated_at": "2024-08-13T14:06:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "`2db437fbd1...df3a22f87a`: pet clang-tidy and combine the last two commits (that implement the `INV+GETDATA`) because otherwise the test-each-commit CI task fails.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2286346598",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 2236191698,
      "node_id": "PRR_kwDOABII586FSZPS",
      "url": null,
      "actor": null,
      "commit_id": "4a955955ec587120fb121e5068e3bc1f80406ac5",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-08-13T17:42:31Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2236191698",
      "submitted_at": "2024-08-13T17:42:31Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13879401612,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAM7RtyM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13879401612",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "31d841ddb8f0dd4d893611415f382b58f1da38a4",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/31d841ddb8f0dd4d893611415f382b58f1da38a4",
      "created_at": "2024-08-14T12:29:00Z"
    },
    {
      "event": "unlabeled",
      "id": 13880560963,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAM7WI1D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13880560963",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-14T13:44:59Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 13909017350,
      "node_id": "LE_lADOABII585-yiT2zwAAAAM9CsMG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13909017350",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-16T10:13:11Z",
      "label": {
        "name": "Needs CMake port",
        "color": "0e8a16"
      }
    },
    {
      "event": "commented",
      "id": 2295439986,
      "node_id": "IC_kwDOABII586I0aJy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2295439986",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-18T23:51:38Z",
      "updated_at": "2024-08-18T23:51:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "Private broadcast can also reduce privacy.  I think the weakness is a tossup vs the obvious alternative (run ordinary connections exclusively over Tor) so it's not a reason to not implement the feature, but it's worth discussing in order to understand the limits and see if mitigations are possible.\r\n\r\nThe issue on my mind is that Tor has little to no resistance to traffic analysis. The small amount of resistance it has is by quantizing messages into fixed size cells.   Otherwise, it essentially doesn't have much resistance because analysis resistance is incompatible with achieving low latency.  Too bad for us because for txn broadcast latency is fairly irrelevant.\r\n\r\nWe assume the attacker is able to passively monitor the internet connection of our victim.  Lets also assume their non-blocksonly Bitcoin P2P connection is encrypted as is increasingly so (and it's a ~6 line change to add an option to make peer v2-only, which I assume someone will propose once they feel v2 listeners are widespread enough).\r\n\r\nThe attacker is attempting to confirm that the monitored peer is the originator of specific transactions on the network, or alternatively is looking at all the transactions and try to determine which are likely authored by the monitored peer.\r\n\r\nAgainst *this* threat model, I think this PR creates a substantial weakness compared to not having it:  any time the user transacts they will create a predictable amount of traffic to tor which is a somewhat a function of the size of the transaction.  There may be enough noise that a single transaction isn't enough alone, but someone who transacted a couple times a day would likely be identifiable.\r\n\r\nOf course, this isn't the threat model this PR really hopes to address. This PR is strong against a threat model where the attacker cannot traffic analyze anyone but instead runs many bitcoin \"nodes\"  and then is able to correlate incoming (decrypted) traffic to originating IP address.  Of the two threat models I think this latter one is a greater concern.\r\n\r\nBut, perhaps if there were padding traffic and a tiny amount of broadcast of third-party txn as if they were private broadcast then the weakness under the traffic analysis case would be improved to be no worse than you'd have from just running ordinary P2P across tor?\r\n",
      "user": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2295439986",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2296543993,
      "node_id": "IC_kwDOABII586I4nr5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2296543993",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-19T13:10:26Z",
      "updated_at": "2024-08-19T13:10:26Z",
      "author_association": "MEMBER",
      "body": "@gmaxwell \r\n>But, perhaps if there were padding traffic and a tiny amount of broadcast of third-party txn as if they were private broadcast then the weakness under the traffic analysis case would be improved to be no worse than you'd have from just running ordinary P2P across tor?\r\n\r\nAssuming a switch to INV-based private relay, you might need to take some care to make sure the decoy tx gets requested at high rates, since the real private relay will tend to result in the getadata for the tx?",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2296543993",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 13930251269,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAM-TsQF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13930251269",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-19T13:10:27Z"
    },
    {
      "event": "subscribed",
      "id": 13930251286,
      "node_id": "SE_lADOABII585-yiT2zwAAAAM-TsQW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13930251286",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-19T13:10:27Z"
    },
    {
      "event": "commented",
      "id": 2303324108,
      "node_id": "IC_kwDOABII586JSe_M",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2303324108",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-22T00:07:12Z",
      "updated_at": "2024-08-22T00:07:12Z",
      "author_association": "CONTRIBUTOR",
      "body": "It might be possible to conceal from a traffic analysis perspective what if anything was requested using padding.",
      "user": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2303324108",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 14093547102,
      "node_id": "LE_lADOABII585-yiT2zwAAAANICnZe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14093547102",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-01T06:08:00Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2323184629,
      "node_id": "IC_kwDOABII586KePv1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2323184629",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-01T06:08:01Z",
      "updated_at": "2024-09-01T06:08:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/28761292823</sub>\n\n<details><summary>Hints</summary>\n\nMake sure to run all tests locally, according to the documentation.\n\nThe failure may happen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2323184629",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 14098076828,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAANIT5Sc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14098076828",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-02T06:19:13Z",
      "label": {
        "name": "Needs CMake port",
        "color": "0e8a16"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14105780677,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAANIxSHF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14105780677",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "08c9a8254ad5e5476454d154aeae439df6b9eafc",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/08c9a8254ad5e5476454d154aeae439df6b9eafc",
      "created_at": "2024-09-02T16:40:58Z"
    },
    {
      "event": "commented",
      "id": 2325087575,
      "node_id": "IC_kwDOABII586KlgVX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2325087575",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-02T16:41:18Z",
      "updated_at": "2024-09-02T16:41:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "`31d841ddb8...08c9a8254a`: rebase to pick CMake",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2325087575",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 14107142447,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAANI2ekv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14107142447",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-02T20:52:25Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 14121648743,
      "node_id": "LE_lADOABII585-yiT2zwAAAANJt0Jn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14121648743",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-03T21:56:36Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14125988228,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAANJ-XmE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14125988228",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "ed7040a9da420b7166b99ffcc0a5aa029116509e",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/ed7040a9da420b7166b99ffcc0a5aa029116509e",
      "created_at": "2024-09-04T08:00:06Z"
    },
    {
      "event": "commented",
      "id": 2328178587,
      "node_id": "IC_kwDOABII586KxS-b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2328178587",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-04T08:00:19Z",
      "updated_at": "2024-09-04T08:00:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "`08c9a8254a...ed7040a9da`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2328178587",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 14126315683,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAANJ_nij",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14126315683",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-04T08:23:51Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 14127885146,
      "node_id": "LE_lADOABII585-yiT2zwAAAANKFmta",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14127885146",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-04T10:13:05Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 14129674414,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAANKMbiu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14129674414",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-04T12:08:29Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 14136162358,
      "node_id": "LE_lADOABII585-yiT2zwAAAANKlLg2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14136162358",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-04T19:27:37Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14216629581,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAANPYI1N",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14216629581",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "abec00bb80aab764677cb5dfb9f77cd7e9d7d85b",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/abec00bb80aab764677cb5dfb9f77cd7e9d7d85b",
      "created_at": "2024-09-11T13:47:21Z"
    },
    {
      "event": "commented",
      "id": 2343727228,
      "node_id": "IC_kwDOABII586LsnB8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2343727228",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-11T13:47:40Z",
      "updated_at": "2024-09-11T13:47:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "`ed7040a9da...abec00bb80`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2343727228",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 14218098126,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAANPdvXO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14218098126",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-11T15:11:06Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 14221161971,
      "node_id": "LE_lADOABII585-yiT2zwAAAANPpbXz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14221161971",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-11T18:44:22Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 14239528182,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAANQvfT2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14239528182",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-12T22:09:24Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 14323208737,
      "node_id": "LE_lADOABII585-yiT2zwAAAANVutIh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14323208737",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-19T12:19:54Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2360838083,
      "node_id": "IC_kwDOABII586Mt4fD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2360838083",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-19T12:19:55Z",
      "updated_at": "2024-09-19T12:19:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/29995994415</sub>\n\n<details><summary>Hints</summary>\n\nMake sure to run all tests locally, according to the documentation.\n\nThe failure may happen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2360838083",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14453865730,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAANdhH0C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14453865730",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "4101c7ac8d94261515d87a0501f5489151634210",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/4101c7ac8d94261515d87a0501f5489151634210",
      "created_at": "2024-09-30T10:51:37Z"
    },
    {
      "event": "commented",
      "id": 2382848929,
      "node_id": "IC_kwDOABII586OB2Oh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2382848929",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-30T10:52:07Z",
      "updated_at": "2024-09-30T10:52:07Z",
      "author_association": "CONTRIBUTOR",
      "body": "`abec00bb80...4101c7ac8d`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2382848929",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14455129608,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAANdl8YI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14455129608",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b98320ceff4c8bc5de4031ca4e9d9c8f317cd5a7",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/b98320ceff4c8bc5de4031ca4e9d9c8f317cd5a7",
      "created_at": "2024-09-30T12:21:17Z"
    },
    {
      "event": "reviewed",
      "id": 2337970767,
      "node_id": "PRR_kwDOABII586LWppP",
      "url": null,
      "actor": null,
      "commit_id": "b98320ceff4c8bc5de4031ca4e9d9c8f317cd5a7",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-09-30T23:09:59Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2337970767",
      "submitted_at": "2024-09-30T23:09:59Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14501118063,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAANgVYBv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14501118063",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "54f4f3b05e26351e67251815ff9d98fdd26bdcda",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/54f4f3b05e26351e67251815ff9d98fdd26bdcda",
      "created_at": "2024-10-03T09:03:44Z"
    },
    {
      "event": "commented",
      "id": 2391079413,
      "node_id": "IC_kwDOABII586OhPn1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2391079413",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-03T10:36:57Z",
      "updated_at": "2024-10-03T10:36:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "`b98320ceff...54f4f3b05e`: address suggestions and blindly try to fix a bogus warning about uninitialized optional (didn't work)",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2391079413",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 14528347562,
      "node_id": "LE_lADOABII585-yiT2zwAAAANh9P2q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14528347562",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-05T16:17:01Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14540942466,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAANitSyC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14540942466",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "f9b2eaf96cf32dae53a0c00a30fe32f38dc9def6",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/f9b2eaf96cf32dae53a0c00a30fe32f38dc9def6",
      "created_at": "2024-10-07T13:42:02Z"
    },
    {
      "event": "commented",
      "id": 2396973132,
      "node_id": "IC_kwDOABII586O3uhM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2396973132",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-07T13:42:11Z",
      "updated_at": "2024-10-07T13:42:11Z",
      "author_association": "CONTRIBUTOR",
      "body": "`54f4f3b05e...f9b2eaf96c`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2396973132",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 14541582549,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAANivvDV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14541582549",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-07T14:18:59Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2352597568,
      "node_id": "PRR_kwDOABII586MOcpA",
      "url": null,
      "actor": null,
      "commit_id": "f9b2eaf96cf32dae53a0c00a30fe32f38dc9def6",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2024-10-07T18:36:34Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2352597568",
      "submitted_at": "2024-10-07T18:36:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14554984504,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAANji3A4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14554984504",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "a51c2cdda52b28d875247e4e47ac613f38a03417",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/a51c2cdda52b28d875247e4e47ac613f38a03417",
      "created_at": "2024-10-08T11:18:20Z"
    },
    {
      "event": "commented",
      "id": 2399582453,
      "node_id": "IC_kwDOABII586PBrj1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2399582453",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-08T11:26:32Z",
      "updated_at": "2024-10-08T11:26:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "`f9b2eaf96c...a51c2cdda5`: address suggestions and further try to silence the bogus std::optional warning.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2399582453",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 14564856800,
      "node_id": "LE_lADOABII585-yiT2zwAAAANkIhPg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14564856800",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-09T02:19:32Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14569494921,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAANkaNmJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14569494921",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "09a7394759173043ccc1eadbed0160b845f538fd",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/09a7394759173043ccc1eadbed0160b845f538fd",
      "created_at": "2024-10-09T09:32:14Z"
    },
    {
      "event": "commented",
      "id": 2401821128,
      "node_id": "IC_kwDOABII586PKOHI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2401821128",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-09T09:33:01Z",
      "updated_at": "2024-10-09T09:33:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "`a51c2cdda5...09a7394759`: silence the bogus GCC warning about uninitialized `std::optional`",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2401821128",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14569560772,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAANkadrE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14569560772",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "6b10008441e47cc59113195fde76b0b55ffc2236",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/6b10008441e47cc59113195fde76b0b55ffc2236",
      "created_at": "2024-10-09T09:36:20Z"
    },
    {
      "event": "commented",
      "id": 2401828752,
      "node_id": "IC_kwDOABII586PKP-Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2401828752",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-09T09:36:35Z",
      "updated_at": "2024-10-09T09:36:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "`09a7394759...6b10008441`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2401828752",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 14570475841,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAANkd9FB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14570475841",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-09T10:35:24Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 14570684499,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAANkewBT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14570684499",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-09T10:50:07Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unsubscribed",
      "id": 14582004157,
      "node_id": "UE_lADOABII585-yiT2zwAAAANlJ7m9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14582004157",
      "actor": {
        "login": "csjones",
        "id": 637026,
        "node_id": "MDQ6VXNlcjYzNzAyNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/637026?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/csjones",
        "html_url": "https://github.com/csjones",
        "followers_url": "https://api.github.com/users/csjones/followers",
        "following_url": "https://api.github.com/users/csjones/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/csjones/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/csjones/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/csjones/subscriptions",
        "organizations_url": "https://api.github.com/users/csjones/orgs",
        "repos_url": "https://api.github.com/users/csjones/repos",
        "events_url": "https://api.github.com/users/csjones/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/csjones/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-10T02:28:59Z"
    },
    {
      "event": "subscribed",
      "id": 14582004326,
      "node_id": "SE_lADOABII585-yiT2zwAAAANlJ7pm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14582004326",
      "actor": {
        "login": "csjones",
        "id": 637026,
        "node_id": "MDQ6VXNlcjYzNzAyNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/637026?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/csjones",
        "html_url": "https://github.com/csjones",
        "followers_url": "https://api.github.com/users/csjones/followers",
        "following_url": "https://api.github.com/users/csjones/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/csjones/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/csjones/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/csjones/subscriptions",
        "organizations_url": "https://api.github.com/users/csjones/orgs",
        "repos_url": "https://api.github.com/users/csjones/repos",
        "events_url": "https://api.github.com/users/csjones/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/csjones/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-10T02:29:01Z"
    },
    {
      "event": "subscribed",
      "id": 14728529424,
      "node_id": "SE_lADOABII585-yiT2zwAAAANt44YQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14728529424",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-19T00:27:52Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14783070140,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAANxI7-8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14783070140",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "ec7693a9aac7a78e30cd134537218eefba6cbdaf",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/ec7693a9aac7a78e30cd134537218eefba6cbdaf",
      "created_at": "2024-10-22T11:15:44Z"
    },
    {
      "event": "commented",
      "id": 2429007032,
      "node_id": "IC_kwDOABII586Qx7S4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2429007032",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-22T11:18:54Z",
      "updated_at": "2024-10-22T11:18:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "`6b10008441...ec7693a9aa`: take suggestions from https://github.com/bitcoin/bitcoin/pull/29420 - in the SOCKS5 proxy, put the sockets forwarding snippet from `socks5.py` to its own function and retry `send()`s.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2429007032",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "referenced",
      "id": 14990316775,
      "node_id": "REFE_lADOABII585-yiT2zwAAAAN9fhTn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14990316775",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "97b790e844abd2f92c928239a7dc786d37fad18b",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/97b790e844abd2f92c928239a7dc786d37fad18b",
      "created_at": "2024-10-29T19:32:25Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15207963709,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAOKdxw9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15207963709",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "f5fc9451aab0d9fb987e6f091d1febcf40c337a4",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/f5fc9451aab0d9fb987e6f091d1febcf40c337a4",
      "created_at": "2024-11-08T09:21:04Z"
    },
    {
      "event": "commented",
      "id": 2464213134,
      "node_id": "IC_kwDOABII586S4OiO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2464213134",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-08T09:22:05Z",
      "updated_at": "2024-11-08T09:22:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "`ec7693a9aa...f5fc9451aa`: rebase and drop the commits that were already merged via https://github.com/bitcoin/bitcoin/pull/29420",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2464213134",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2466865095,
      "node_id": "IC_kwDOABII586TCV_H",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2466865095",
      "actor": {
        "login": "1440000bytes",
        "id": 147166694,
        "node_id": "U_kgDOCMWV5g",
        "avatar_url": "https://avatars.githubusercontent.com/u/147166694?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/1440000bytes",
        "html_url": "https://github.com/1440000bytes",
        "followers_url": "https://api.github.com/users/1440000bytes/followers",
        "following_url": "https://api.github.com/users/1440000bytes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/1440000bytes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/1440000bytes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/1440000bytes/subscriptions",
        "organizations_url": "https://api.github.com/users/1440000bytes/orgs",
        "repos_url": "https://api.github.com/users/1440000bytes/repos",
        "events_url": "https://api.github.com/users/1440000bytes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/1440000bytes/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-10T19:37:45Z",
      "updated_at": "2025-07-31T19:15:27Z",
      "author_association": "NONE",
      "body": "> @1440000bytes, thanks for asking! There is some discussion at #27509 (the previous attempt on this).\r\n> \r\n> > Is it necessary to open new short lived tor/i2p connections for broadcasting the transaction?\r\n> \r\n> Yes, it is. See below.\r\n> \r\n> > What are the trade-offs in this implementation vs a simple implementation to relay tx to one or more peers that our node is already connected to?\r\n> \r\n> Sending the transaction over clearnet reveals the IP address/geolocation of the sender. A spy with many connections to the network could try to guess who was the originator. So, why not send it to our Tor peers only? Because it is relatively easy for a spy to fingerprint and link clearnet and Tor connections to the same peer. That is, a long running connection over Tor could be linked to a long running clearnet connection. This is why the proposed changes open a short-lived connection that does not reveal any of the identity of the sender.\r\n> \r\n> Would this benefit nodes that don't have clearnet connections, e.g. Tor/I2P-only nodes? Yes! In the case where the sender sends two otherwise unrelated transactions over the same long-running Tor connection, the recipient will know that they have the same origin, even though they are not related on-chain. Using single shot connections fixes that too.\r\n> \r\n> > Related issues:\r\n> \r\n> Linked in the OP, thanks!\r\n\r\nI am still not satisfied with this answer as a general approach could have allowed dandelion++ without changing bitcoin core. However, it improves privacy compared to status quo so I wont be a roadblock.\r\n\r\n ",
      "user": {
        "login": "1440000bytes",
        "id": 147166694,
        "node_id": "U_kgDOCMWV5g",
        "avatar_url": "https://avatars.githubusercontent.com/u/147166694?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/1440000bytes",
        "html_url": "https://github.com/1440000bytes",
        "followers_url": "https://api.github.com/users/1440000bytes/followers",
        "following_url": "https://api.github.com/users/1440000bytes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/1440000bytes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/1440000bytes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/1440000bytes/subscriptions",
        "organizations_url": "https://api.github.com/users/1440000bytes/orgs",
        "repos_url": "https://api.github.com/users/1440000bytes/repos",
        "events_url": "https://api.github.com/users/1440000bytes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/1440000bytes/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2466865095",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 15691319526,
      "node_id": "LE_lADOABII585-yiT2zwAAAAOnRojm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15691319526",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-17T18:54:58Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15733235576,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAOpxh94",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15733235576",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "3522e897f28d56efec63984550f233d04d18e9a7",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/3522e897f28d56efec63984550f233d04d18e9a7",
      "created_at": "2024-12-20T14:20:26Z"
    },
    {
      "event": "commented",
      "id": 2557107378,
      "node_id": "IC_kwDOABII586Yalyy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2557107378",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-20T14:20:42Z",
      "updated_at": "2024-12-20T14:20:42Z",
      "author_association": "CONTRIBUTOR",
      "body": "`f5fc9451aa...3522e897f2`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2557107378",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 15733403204,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAOpyK5E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15733403204",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-20T14:36:36Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 15734366708,
      "node_id": "LE_lADOABII585-yiT2zwAAAAOp12H0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15734366708",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-20T16:10:49Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2557292039,
      "node_id": "IC_kwDOABII586YbS4H",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2557292039",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-20T16:10:50Z",
      "updated_at": "2024-12-20T16:10:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/34713712952</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2557292039",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15734391184,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAOp18GQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15734391184",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "964b7b0ad6eea4731c2e8059bbeaf990028834e2",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/964b7b0ad6eea4731c2e8059bbeaf990028834e2",
      "created_at": "2024-12-20T16:13:03Z"
    },
    {
      "event": "commented",
      "id": 2557298504,
      "node_id": "IC_kwDOABII586YbUdI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2557298504",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-20T16:13:34Z",
      "updated_at": "2024-12-20T16:13:34Z",
      "author_association": "CONTRIBUTOR",
      "body": "`3522e897f2...964b7b0ad6`: pet clang-tidy",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2557298504",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unsubscribed",
      "id": 15734497013,
      "node_id": "UE_lADOABII585-yiT2zwAAAAOp2V71",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15734497013",
      "actor": {
        "login": "csjones",
        "id": 637026,
        "node_id": "MDQ6VXNlcjYzNzAyNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/637026?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/csjones",
        "html_url": "https://github.com/csjones",
        "followers_url": "https://api.github.com/users/csjones/followers",
        "following_url": "https://api.github.com/users/csjones/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/csjones/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/csjones/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/csjones/subscriptions",
        "organizations_url": "https://api.github.com/users/csjones/orgs",
        "repos_url": "https://api.github.com/users/csjones/repos",
        "events_url": "https://api.github.com/users/csjones/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/csjones/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-20T16:23:32Z"
    },
    {
      "event": "subscribed",
      "id": 15734497242,
      "node_id": "SE_lADOABII585-yiT2zwAAAAOp2V_a",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15734497242",
      "actor": {
        "login": "csjones",
        "id": 637026,
        "node_id": "MDQ6VXNlcjYzNzAyNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/637026?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/csjones",
        "html_url": "https://github.com/csjones",
        "followers_url": "https://api.github.com/users/csjones/followers",
        "following_url": "https://api.github.com/users/csjones/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/csjones/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/csjones/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/csjones/subscriptions",
        "organizations_url": "https://api.github.com/users/csjones/orgs",
        "repos_url": "https://api.github.com/users/csjones/repos",
        "events_url": "https://api.github.com/users/csjones/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/csjones/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-20T16:23:33Z"
    },
    {
      "event": "unlabeled",
      "id": 15735464228,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAOp6CEk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15735464228",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-20T18:01:51Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 15773453677,
      "node_id": "LE_lADOABII585-yiT2zwAAAAOsK81t",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15773453677",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-27T15:13:21Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 16293252497,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAPLJ02R",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16293252497",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "ebc7ba02168867f88d431c2d7095b7040c9a1eeb",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/ebc7ba02168867f88d431c2d7095b7040c9a1eeb",
      "created_at": "2025-02-13T09:19:11Z"
    },
    {
      "event": "commented",
      "id": 2655986646,
      "node_id": "IC_kwDOABII586eTyPW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2655986646",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-02-13T09:19:22Z",
      "updated_at": "2025-02-13T09:19:22Z",
      "author_association": "CONTRIBUTOR",
      "body": "`964b7b0ad6...ebc7ba0216`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2655986646",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 16294342363,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAPLN-7b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16294342363",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-02-13T10:35:41Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2707596335,
      "node_id": "IC_kwDOABII586hYqQv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2707596335",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-07T22:15:33Z",
      "updated_at": "2025-03-07T22:15:33Z",
      "author_association": "MEMBER",
      "body": "Plan to review soon.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2707596335",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 16720909082,
      "node_id": "LE_lADOABII585-yiT2zwAAAAPkpNMa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16720909082",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-12T20:43:20Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 16809561584,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAPp7Y3w",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16809561584",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "e150e3064b4c8165a0429a536d5235e8475e0045",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/e150e3064b4c8165a0429a536d5235e8475e0045",
      "created_at": "2025-03-17T16:03:02Z"
    },
    {
      "event": "commented",
      "id": 2730066751,
      "node_id": "IC_kwDOABII586iuYM_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2730066751",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-17T16:03:33Z",
      "updated_at": "2025-03-17T16:03:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "`ebc7ba0216...e150e3064b`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2730066751",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 16809868321,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAPp8jwh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16809868321",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-17T16:19:25Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 17080665275,
      "node_id": "LE_lADOABII585-yiT2zwAAAAP6FkS7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17080665275",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-01T18:33:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17089994323,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAP6pJ5T",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17089994323",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "created_at": "2025-04-02T09:08:51Z"
    },
    {
      "event": "commented",
      "id": 2771929840,
      "node_id": "IC_kwDOABII586lOErw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2771929840",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-02T09:11:11Z",
      "updated_at": "2025-04-02T13:40:21Z",
      "author_association": "CONTRIBUTOR",
      "body": "`e150e3064b...cae4c1134d`:\r\n\r\n* Instead of opening new private broadcast connections from `ThreadOpenConnections()`, together with all others, do that in a separate thread. This greatly simplifies the code because normal outbound connections and private broadcast ones are subject to too different opening conditions and logic and forcing all of the code in `ThreadOpenConnections()` made that function quite complex. Now the code is neatly separated in `ThreadPrivateBroadcast()` and easy to follow, just 59 lines of new code and `ThreadOpenConnections()` is not modified.\r\n\r\n* In practice a transaction usually gets received back before the last of the 5 connections has completed. Thus reduce the number of peers to send the transaction from 5 to 3 (there is a retry-later mechanism as well).\r\n\r\n* Change `LogPrintLevel(BCLog::PRIVATE_BROADCAST, BCLog::Level::Debug, ` to `LogDebug(BCLog::PRIVATE_BROADCAST, ` to reduce verbosity, even though this is inconsistent with higher level logs which use `LogPrintLevel()`: `LogPrintLevel(BCLog::PRIVATE_BROADCAST, BCLog::Level::Warning, `.\r\n\r\n* Remove trailing newlines from log messages since a recent change in `master` made them unnecessary.\r\n\r\n* Avoid repeating `fLogIPs ? strprintf(\", peeraddr=%s\", pnode->addr.ToStringAddrPort()) : \"\"` all over the place and use the recently added `LogIP()`, thanks @Sjors!\r\n",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2771929840",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 17090048915,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAP6pXOT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17090048915",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-02T09:11:13Z"
    },
    {
      "event": "subscribed",
      "id": 17090048945,
      "node_id": "SE_lADOABII585-yiT2zwAAAAP6pXOx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17090048945",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-02T09:11:13Z"
    },
    {
      "event": "unlabeled",
      "id": 17090910184,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAP6spfo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17090910184",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-02T10:02:13Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2776015945,
      "node_id": "IC_kwDOABII586ldqRJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2776015945",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T14:39:05Z",
      "updated_at": "2025-04-03T14:39:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "Could we have a small guide how to test this (starting with a signet wallet with a few sats e.g. from a faucet)? I've done it once (successfully) a few months ago, but I don't work with the wallet very often and always have to lookup the rpc commands again.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2776015945",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2776090861,
      "node_id": "IC_kwDOABII586ld8jt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2776090861",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T15:02:29Z",
      "updated_at": "2025-04-03T15:02:29Z",
      "author_association": "CONTRIBUTOR",
      "body": "+1! I saved this in a script to avoid repeating the procedure every time.\r\n\r\n1. Create a wallet and get a new address:\r\n```\r\nbuild/bin/bitcoin-cli -chain=\"signet\" createwallet test\r\nbuild/bin/bitcoin-cli -chain=\"signet\" getnewaddress\r\n```\r\n2. Go to the Signet faucet and request some coins.\r\n3. Run the script\r\n```\r\n#!/bin/bash\r\ncd bitcoin\r\nbuild/bin/bitcoin-cli -chain=\"signet\" loadwallet test\r\ntxid=$(build/bin/bitcoin-cli -chain=\"signet\" listunspent | jq -r '.[0] | .txid')\r\nvout=$(build/bin/bitcoin-cli -chain=\"signet\" listunspent | jq -r '.[0] | .vout')\r\necho \"txid: $txid\"\r\necho \"vout: $vout\"\r\n\r\nnew_address=$(build/bin/bitcoin-cli -chain=\"signet\" getnewaddress)\r\ntx=$(build/bin/bitcoin-cli -chain=\"signet\" createrawtransaction \"[{\\\"txid\\\": \\\"$txid\\\", \\\"vout\\\": $vout}]\" \"[{\\\"$new_address\\\": 0.00001}]\" 0 false)\r\necho \"tx: $tx\"\r\n\r\nsigned_tx=$(build/bin/bitcoin-cli -chain=\"signet\" signrawtransactionwithwallet $tx | jq -r '.hex')\r\necho \"signed_tx: $signed_tx\"\r\n\r\nraw_tx=$(build/bin/bitcoin-cli -chain=\"signet\" sendrawtransaction $signed_tx)\r\necho \"raw_tx: $raw_tx\"\r\n```",
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2776090861",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2776603494,
      "node_id": "IC_kwDOABII586lf5tm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2776603494",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T18:26:24Z",
      "updated_at": "2025-04-03T18:26:24Z",
      "author_association": "CONTRIBUTOR",
      "body": "@stratospher that's a great script, thanks! I've modified it slightly to use the more modern psbt wallet commands. This makes it not have to worry about inputs and also automatically sends back change to the wallet.\r\n\r\nThis does mean you will have to start bitcoind with `-fallbackfee=0.00003` for instance for 3 sat/vbyte fee.\r\nAlso start bitcoind with `-privatebroadcast=1 -debug=privatebroadcast`.\r\n\r\n```\r\n#!/bin/bash\r\ncd bitcoin\r\nbuild/bin/bitcoin-cli -chain=\"signet\" loadwallet test\r\n\r\nnew_address=$(build/bin/bitcoin-cli -chain=\"signet\" getnewaddress)\r\npsbt=$(build/bin/bitcoin-cli -chain=\"signet\" walletcreatefundedpsbt \"[]\" \"[{\\\"$new_address\\\": 0.00001}]\" | jq -r '.psbt')\r\necho \"psbt: $psbt\"\r\n\r\nsigned_tx=$(build/bin/bitcoin-cli -chain=\"signet\" walletprocesspsbt $psbt | jq -r '.hex')\r\necho \"signed_tx: $signed_tx\"\r\n\r\nraw_tx=$(build/bin/bitcoin-cli -chain=\"signet\" sendrawtransaction $signed_tx)\r\necho \"raw_tx: $raw_tx\"\r\n```",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2776603494",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 17118661107,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAP8Wgnz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17118661107",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T18:26:25Z"
    },
    {
      "event": "subscribed",
      "id": 17118661133,
      "node_id": "SE_lADOABII585-yiT2zwAAAAP8WgoN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17118661133",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T18:26:26Z"
    },
    {
      "event": "reviewed",
      "id": 2745195105,
      "node_id": "PRR_kwDOABII586joFph",
      "url": null,
      "actor": null,
      "commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-06T19:04:04Z",
      "author_association": "CONTRIBUTOR",
      "body": "Very nice, I've been testing on 398d9440db79d8b5f46094f831e79e3f2a835874 without the `inv` sending.\r\n\r\nOne thing is that sending multiple txs quickly using `walletcreatefundedpsbt` will select the same utxos since we didn't get the previous tx yet. The double spent tx will still get pushed to peers, but there's no indication that it failed from RPC or log perspective until next retry. This is a consequence of not submitting to our mempool, which I think is ok. But, maybe we could have a shorter duration stale tx check to have faster feedback than 10 minutes for these cases.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2745195105",
      "submitted_at": "2025-04-06T19:04:04Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 2747338325,
      "node_id": "PRR_kwDOABII586jwQ5V",
      "url": null,
      "actor": null,
      "commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-07T15:53:26Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2747338325",
      "submitted_at": "2025-04-07T15:53:26Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "commented",
      "id": 2785035360,
      "node_id": "IC_kwDOABII586mAERg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2785035360",
      "actor": {
        "login": "learnwayback",
        "id": 185106791,
        "node_id": "U_kgDOCwiBZw",
        "avatar_url": "https://avatars.githubusercontent.com/u/185106791?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/learnwayback",
        "html_url": "https://github.com/learnwayback",
        "followers_url": "https://api.github.com/users/learnwayback/followers",
        "following_url": "https://api.github.com/users/learnwayback/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/learnwayback/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/learnwayback/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/learnwayback/subscriptions",
        "organizations_url": "https://api.github.com/users/learnwayback/orgs",
        "repos_url": "https://api.github.com/users/learnwayback/repos",
        "events_url": "https://api.github.com/users/learnwayback/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/learnwayback/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T01:59:57Z",
      "updated_at": "2025-04-08T02:02:38Z",
      "author_association": "NONE",
      "body": "Isn't this a bit much? \r\n\r\n-proxyrandomize ensures that each connection is its own tor circuit\r\nso all you need to do is close the connection that was used to send a locally originating TX.\r\nminimal modification.",
      "user": {
        "login": "learnwayback",
        "id": 185106791,
        "node_id": "U_kgDOCwiBZw",
        "avatar_url": "https://avatars.githubusercontent.com/u/185106791?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/learnwayback",
        "html_url": "https://github.com/learnwayback",
        "followers_url": "https://api.github.com/users/learnwayback/followers",
        "following_url": "https://api.github.com/users/learnwayback/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/learnwayback/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/learnwayback/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/learnwayback/subscriptions",
        "organizations_url": "https://api.github.com/users/learnwayback/orgs",
        "repos_url": "https://api.github.com/users/learnwayback/repos",
        "events_url": "https://api.github.com/users/learnwayback/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/learnwayback/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2785035360",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 17165375321,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAP_ItdZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17165375321",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T07:17:11Z"
    },
    {
      "event": "subscribed",
      "id": 17165375352,
      "node_id": "SE_lADOABII585-yiT2zwAAAAP_Itd4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17165375352",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T07:17:11Z"
    },
    {
      "event": "mentioned",
      "id": 17165375380,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAP_IteU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17165375380",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T07:17:11Z"
    },
    {
      "event": "subscribed",
      "id": 17165375400,
      "node_id": "SE_lADOABII585-yiT2zwAAAAP_Iteo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17165375400",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T07:17:11Z"
    },
    {
      "event": "commented",
      "id": 2785476282,
      "node_id": "IC_kwDOABII586mBv66",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2785476282",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T07:18:47Z",
      "updated_at": "2025-04-08T07:18:47Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Could we have a small guide how to test this ... always have to lookup the rpc commands again.\r\n\r\nMe too. Added \"How to test this?\" to the PR description, based on @stratospher and @andrewtoth's commands, thank you!",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2785476282",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 17165400716,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAP_IzqM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17165400716",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T07:18:49Z"
    },
    {
      "event": "subscribed",
      "id": 17165400735,
      "node_id": "SE_lADOABII585-yiT2zwAAAAP_Izqf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17165400735",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T07:18:49Z"
    },
    {
      "event": "mentioned",
      "id": 17165400756,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAP_Izq0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17165400756",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T07:18:49Z"
    },
    {
      "event": "subscribed",
      "id": 17165400773,
      "node_id": "SE_lADOABII585-yiT2zwAAAAP_IzrF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17165400773",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T07:18:49Z"
    },
    {
      "event": "reviewed",
      "id": 2749487666,
      "node_id": "PRR_kwDOABII586j4doy",
      "url": null,
      "actor": null,
      "commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-08T10:30:52Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2749487666",
      "submitted_at": "2025-04-08T10:30:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "commented",
      "id": 2786081893,
      "node_id": "IC_kwDOABII586mEDxl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2786081893",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T11:11:45Z",
      "updated_at": "2025-04-08T11:11:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "PR description is stale:\n> the node will send it to 5 (NUM_PRIVATE_BROADCAST_PER_TX)\n\nShould be 3.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2786081893",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17171153122,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAP_ewDi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17171153122",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "14ebee8ea29e555caaeaa4e0a935f0897390bdfb",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/14ebee8ea29e555caaeaa4e0a935f0897390bdfb",
      "created_at": "2025-04-08T13:28:48Z"
    },
    {
      "event": "commented",
      "id": 2786464771,
      "node_id": "IC_kwDOABII586mFhQD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2786464771",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T13:35:23Z",
      "updated_at": "2025-04-08T13:35:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "`cae4c1134d...14ebee8ea2`: rebase and address suggestions\r\n\r\n> Should be 3.\r\n\r\nUpdated the OP.\r\n\r\n> Isn't this a bit much?\r\n-proxyrandomize ensures that each connection is its own tor circuit\r\nso all you need to do is close the connection that was used to send a locally originating TX.\r\nminimal modification.\r\n\r\nAnd also make sure that before sending the transaction we do not leak any node-identity-revealing information to the peer. And not put the transaction in the mempool. https://github.com/bitcoin/bitcoin/pull/27509 tried to put the tx in the mempool but that turned out to be not feasible. See also https://github.com/bitcoin/bitcoin/issues/32235#issuecomment-2785659926\r\n",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2786464771",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 2750468030,
      "node_id": "PRR_kwDOABII586j8M--",
      "url": null,
      "actor": null,
      "commit_id": "14ebee8ea29e555caaeaa4e0a935f0897390bdfb",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-08T15:38:10Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2750468030",
      "submitted_at": "2025-04-08T15:38:10Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 2751328427,
      "node_id": "PRR_kwDOABII586j_fCr",
      "url": null,
      "actor": null,
      "commit_id": "14ebee8ea29e555caaeaa4e0a935f0897390bdfb",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-08T22:07:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "I like moving the connection-making logic into its own thread, `ThreadOpenConnections()` is already ~confusing~ complicated enough as is.\r\n\r\nI tested this multiple time with the added guide (thanks!) on signet and it worked really well, got the tx back almost immediately. Might also test it on mainnet soon (fees are low...), I'd be interested to know if the time to receive a tx originating from Tor changes a lot between on i2p, clearnet, or tor peers.\r\n\r\nFWIW I'm in favor of including the last commit, sending invs - even if this means more connections will timeout after 180s because there is a race between the second peer requesting the tx from you, or getting from someone else before.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2751328427",
      "submitted_at": "2025-04-08T22:07:37Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "commented",
      "id": 2788608403,
      "node_id": "IC_kwDOABII586mNsmT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2788608403",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-09T07:24:22Z",
      "updated_at": "2025-04-09T07:24:22Z",
      "author_association": "CONTRIBUTOR",
      "body": "Would also broadcasting some random transactions through this same mechanism (also randomly) address the concern mentioned by @gmaxwell in https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2295439986 ?",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2788608403",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 17183467996,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAQANunc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17183467996",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-09T07:24:23Z"
    },
    {
      "event": "subscribed",
      "id": 17183468029,
      "node_id": "SE_lADOABII585-yiT2zwAAAAQANun9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17183468029",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-09T07:24:23Z"
    },
    {
      "event": "reviewed",
      "id": 2752901260,
      "node_id": "PRR_kwDOABII586kFfCM",
      "url": null,
      "actor": null,
      "commit_id": "14ebee8ea29e555caaeaa4e0a935f0897390bdfb",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-09T10:00:15Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2752901260",
      "submitted_at": "2025-04-09T10:00:15Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17189492514,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAQAktci",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17189492514",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "ddce2a585b8bb179cf2be8027ab6daf29cac7e21",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/ddce2a585b8bb179cf2be8027ab6daf29cac7e21",
      "created_at": "2025-04-09T13:17:28Z"
    },
    {
      "event": "commented",
      "id": 2789675040,
      "node_id": "IC_kwDOABII586mRxAg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2789675040",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-09T13:17:58Z",
      "updated_at": "2025-04-09T13:17:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "`14ebee8ea2...ddce2a585b`: address suggestions",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2789675040",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 2753934046,
      "node_id": "PRR_kwDOABII586kJbLe",
      "url": null,
      "actor": null,
      "commit_id": "33f2770bc80316e65eb838bb63d3f38ab53dd27c",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-09T15:38:30Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2753934046",
      "submitted_at": "2025-04-09T15:38:30Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17217329454,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAQCO5ku",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17217329454",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "17342ec4b5443430b3e112608ec91e2373bf5cc3",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/17342ec4b5443430b3e112608ec91e2373bf5cc3",
      "created_at": "2025-04-11T04:44:47Z"
    },
    {
      "event": "commented",
      "id": 2795829514,
      "node_id": "IC_kwDOABII586mpPkK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2795829514",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-11T04:51:43Z",
      "updated_at": "2025-04-11T04:51:43Z",
      "author_association": "CONTRIBUTOR",
      "body": "`ddce2a585b...17342ec4b5`: squash the extra `INV` step into commit 33f2770bc8 `net_processing: handle ConnectionType::PRIVATE_BROADCAST connections` (which is now 7b1527a95a). Verdict: https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2037888422\r\n\r\nJust for the records, if we ever want to send `TX` directly, omit the `INV`/`GETDATA` step, this is the patch to reverse apply:\r\n\r\n<details>\r\n<summary>[patch] add INV/GETDATA (could be reverse applied)</summary>\r\n\r\n```diff\r\ncommit ddce2a585b8bb179cf2be8027ab6daf29cac7e21\r\nParent: 8db1ee3587794646a339dc003628964f3376718d\r\nAuthor:     Vasil Dimov <vd@FreeBSD.org>\r\nAuthorDate: Tue Aug 13 11:44:32 2024 +0200\r\nCommit:     Vasil Dimov <vd@FreeBSD.org>\r\nCommitDate: Wed Apr 9 15:11:49 2025 +0200\r\ngpg: Signature made Wed Apr  9 15:11:51 2025 CEST\r\ngpg:                using RSA key E64D8D45614DB07545D9CCC154DF06F64B55CBBF\r\ngpg: Good signature from \"Vasil Dimov <vd@myforest.net>\" [ultimate]\r\ngpg:                 aka \"Vasil Dimov <vd@FreeBSD.org>\" [ultimate]\r\ngpg:                 aka \"Vasil Dimov <vasild@gmail.com>\" [ultimate]\r\n\r\n\r\n    fixup! net_processing: handle ConnectionType::PRIVATE_BROADCAST connections\r\n    \r\n    This change adds INV+GETDATA to the transaction sending sequence.\r\n\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex 66e463e8c7..d7378ae095 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -4065,12 +4065,13 @@ void CConnman::PushMessage(CNode* pnode, CSerializedNetMsg&& msg)\r\n {\r\n     AssertLockNotHeld(m_total_bytes_sent_mutex);\r\n \r\n     if (pnode->IsPrivateBroadcastConn() &&\r\n         msg.m_type != NetMsgType::VERSION &&\r\n         msg.m_type != NetMsgType::VERACK &&\r\n+        msg.m_type != NetMsgType::INV &&\r\n         msg.m_type != NetMsgType::TX &&\r\n         msg.m_type != NetMsgType::PING) {\r\n         // Ensure private broadcast connections only send the above message types.\r\n         // Others are not needed and may degrade privacy.\r\n         LogDebug(BCLog::PRIVATE_BROADCAST,\r\n                  \"Omitting send of message '%s', peer=%d%s\",\r\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\r\nindex c06cce1df7..776a9d6cdd 100644\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -938,13 +938,13 @@ private:\r\n \r\n     /** Process compact block txns  */\r\n     void ProcessCompactBlockTxns(CNode& pfrom, Peer& peer, const BlockTransactions& block_transactions)\r\n         EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex, !m_most_recent_block_mutex);\r\n \r\n     /**\r\n-     * Schedule a transaction be sent to the given peer (via `PushMessage()`), unsolicited.\r\n+     * Schedule an INV for a transaction be sent to the given peer (via `PushMessage()`).\r\n      * The transaction is picked from the list of transactions for private broadcast.\r\n      * It is assumed that the connection to the peer is `ConnectionType::PRIVATE_BROADCAST`.\r\n      * Calling this for other peers will degrade privacy. Don't do that.\r\n      */\r\n     void PushPrivateBroadcastTx(CNode& node) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex, !m_most_recent_block_mutex);\r\n \r\n@@ -3525,19 +3525,20 @@ void PeerManagerImpl::PushPrivateBroadcastTx(CNode& node)\r\n         return;\r\n     }\r\n     const CTransactionRef& tx{*opt_tx};\r\n \r\n     LogPrintLevel(BCLog::PRIVATE_BROADCAST,\r\n                   BCLog::Level::Info,\r\n-                  \"P2P handshake completed, sending txid=%s%s, peer=%d%s\",\r\n+                  \"P2P handshake completed, sending INV for txid=%s%s, peer=%d%s\",\r\n                   tx->GetHash().ToString(),\r\n                   tx->HasWitness() ? strprintf(\", wtxid=%s\", tx->GetWitnessHash().ToString()) : \"\",\r\n                   node.GetId(),\r\n                   node.LogIP(fLogIPs));\r\n \r\n-    MakeAndPushMessage(node, NetMsgType::TX, TX_WITH_WITNESS(*tx));\r\n+    MakeAndPushMessage(node, NetMsgType::INV, std::vector<CInv>{{CInv{MSG_TX, tx->GetHash().ToUint256()}}});\r\n+\r\n     m_tx_for_private_broadcast.PushedToNode(node.GetId(), tx->GetHash());\r\n }\r\n \r\n void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type, DataStream& vRecv,\r\n                                      const std::chrono::microseconds time_received,\r\n                                      const std::atomic<bool>& interruptMsgProc)\r\n@@ -3859,15 +3860,12 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\r\n             // The peer may intend to later send us NetMsgType::FEEFILTER limiting\r\n             // cheap transactions, but we don't wait for that and thus we may send\r\n             // them a transaction below their threshold. This is ok because this\r\n             // relay logic is designed to work even in cases when the peer drops\r\n             // the transaction (due to it being too cheap, or for other reasons).\r\n             PushPrivateBroadcastTx(pfrom);\r\n-\r\n-            peer->m_ping_queued = true; // Ensure a ping will be sent: mimick a request via RPC.\r\n-            MaybeSendPing(pfrom, *peer, GetTime<std::chrono::microseconds>());\r\n         }\r\n \r\n         return;\r\n     }\r\n \r\n     if (msg_type == NetMsgType::SENDHEADERS) {\r\n@@ -3987,13 +3985,13 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\r\n     if (!pfrom.fSuccessfullyConnected) {\r\n         LogDebug(BCLog::NET, \"Unsupported message \\\"%s\\\" prior to verack from peer=%d\\n\", SanitizeString(msg_type), pfrom.GetId());\r\n         return;\r\n     }\r\n \r\n     if (pfrom.IsPrivateBroadcastConn()) {\r\n-        if (msg_type != NetMsgType::PONG) {\r\n+        if (msg_type != NetMsgType::PONG && msg_type != NetMsgType::GETDATA) {\r\n             LogDebug(BCLog::PRIVATE_BROADCAST,\r\n                      \"Ignoring incoming message '%s', peer=%d%s\",\r\n                      msg_type,\r\n                      pfrom.GetId(),\r\n                      pfrom.LogIP(fLogIPs));\r\n             return;\r\n@@ -4200,12 +4198,47 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\r\n         LogDebug(BCLog::NET, \"received getdata (%u invsz) peer=%d\\n\", vInv.size(), pfrom.GetId());\r\n \r\n         if (vInv.size() > 0) {\r\n             LogDebug(BCLog::NET, \"received getdata for: %s peer=%d\\n\", vInv[0].ToString(), pfrom.GetId());\r\n         }\r\n \r\n+        if (pfrom.IsPrivateBroadcastConn()) {\r\n+            const auto pushed_tx_opt = m_tx_for_private_broadcast.GetTxPushedToNode(pfrom.GetId());\r\n+            if (!pushed_tx_opt) {\r\n+                LogPrintLevel(BCLog::PRIVATE_BROADCAST,\r\n+                              BCLog::Level::Info,\r\n+                              \"Disconnecting: got GETDATA without sending an INV, peer=%d%s\\n\",\r\n+                              pfrom.GetId(),\r\n+                              fLogIPs ? strprintf(\", peeraddr=%s\", pfrom.addr.ToStringAddrPort()) : \"\");\r\n+                pfrom.fDisconnect = true;\r\n+                m_connman.m_private_broadcast.NumToOpenAdd(1);\r\n+                return;\r\n+            }\r\n+\r\n+            const CTransactionRef& pushed_tx{*pushed_tx_opt};\r\n+\r\n+            // The GETDATA request must contain exactly one inv and it must be for the transaction\r\n+            // that we INVed to the peer earlier.\r\n+            if (vInv.size() == 1 && vInv[0].IsMsgTx() && vInv[0].hash == pushed_tx->GetHash()) {\r\n+\r\n+                MakeAndPushMessage(pfrom, NetMsgType::TX, TX_WITH_WITNESS(*pushed_tx));\r\n+\r\n+                peer->m_ping_queued = true; // Ensure a ping will be sent: mimick a request via RPC.\r\n+                MaybeSendPing(pfrom, *peer, GetTime<std::chrono::microseconds>());\r\n+            } else {\r\n+                LogPrintLevel(BCLog::PRIVATE_BROADCAST,\r\n+                              BCLog::Level::Info,\r\n+                              \"Disconnecting: got an unexpected GETDATA message, peer=%d%s\\n\",\r\n+                              pfrom.GetId(),\r\n+                              fLogIPs ? strprintf(\", peeraddr=%s\", pfrom.addr.ToStringAddrPort()) : \"\");\r\n+                pfrom.fDisconnect = true;\r\n+                m_connman.m_private_broadcast.NumToOpenAdd(1);\r\n+            }\r\n+            return;\r\n+        }\r\n+\r\n         {\r\n             LOCK(peer->m_getdata_requests_mutex);\r\n             peer->m_getdata_requests.insert(peer->m_getdata_requests.end(), vInv.begin(), vInv.end());\r\n             ProcessGetData(pfrom, *peer, interruptMsgProc);\r\n         }\r\n \r\ndiff --git a/src/private_broadcast.cpp b/src/private_broadcast.cpp\r\nindex a96dbe0856..8483c61829 100644\r\n--- a/src/private_broadcast.cpp\r\n+++ b/src/private_broadcast.cpp\r\n@@ -51,12 +51,30 @@ std::optional<CTransactionRef> PrivateBroadcast::GetTxForBroadcast() EXCLUSIVE_L\r\n void PrivateBroadcast::PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n {\r\n     LOCK(m_mutex);\r\n     m_by_nodeid.emplace(nodeid, txid);\r\n }\r\n \r\n+std::optional<CTransactionRef> PrivateBroadcast::GetTxPushedToNode(const NodeId& nodeid)\r\n+    EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n+{\r\n+    LOCK(m_mutex);\r\n+\r\n+    auto it_by_node = m_by_nodeid.find(nodeid);\r\n+    if (it_by_node == m_by_nodeid.end()) {\r\n+        return std::nullopt;\r\n+    }\r\n+    const Txid txid{it_by_node->second};\r\n+\r\n+    auto it_by_txid = m_by_txid.find(txid);\r\n+    if (it_by_txid == m_by_txid.end()) {\r\n+        return std::nullopt;\r\n+    }\r\n+    return it_by_txid->second.tx;\r\n+}\r\n+\r\n void PrivateBroadcast::FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n {\r\n     LOCK(m_mutex);\r\n     auto it = m_by_nodeid.find(nodeid);\r\n     if (it == m_by_nodeid.end()) {\r\n         return;\r\ndiff --git a/src/private_broadcast.h b/src/private_broadcast.h\r\nindex bc8735cdfc..72183be7b2 100644\r\n--- a/src/private_broadcast.h\r\n+++ b/src/private_broadcast.h\r\n@@ -53,12 +53,17 @@ public:\r\n      * we get a PONG from the node which would confirm that the transaction has been received.\r\n      * At the time we get the PONG we need to know which transaction we sent to that node,\r\n      * so that we can account how many times we broadcast each transaction.\r\n      */\r\n     void PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\r\n \r\n+    /**\r\n+     * Get the transaction that was pushed to a given node by PushedToNode().\r\n+     */\r\n+    std::optional<CTransactionRef> GetTxPushedToNode(const NodeId& nodeid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\r\n+\r\n     /**\r\n      * Mark the end of a broadcast of a transaction. Either successful by receiving a PONG,\r\n      * or unsuccessful by closing the connection to the node without getting PONG.\r\n      */\r\n     void FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\r\n \r\ndiff --git a/test/functional/p2p_private_broadcast.py b/test/functional/p2p_private_broadcast.py\r\nindex 4bdd7e2e87..25d297ff7b 100755\r\n--- a/test/functional/p2p_private_broadcast.py\r\n+++ b/test/functional/p2p_private_broadcast.py\r\n@@ -252,12 +252,13 @@ class P2PPrivateBroadcast(BitcoinTestFramework):\r\n             self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} must be a private broadcast, checking it\")\r\n             peer.wait_for_disconnect()\r\n             # Now it is (C).\r\n             assert_equal(peer.message_count, {\r\n                 \"version\": 1,\r\n                 \"verack\": 1,\r\n+                \"inv\": 1,\r\n                 \"tx\": 1,\r\n                 \"ping\": 1\r\n             })\r\n             dummy_address = CAddress()\r\n             dummy_address.nServices = 0\r\n             assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\r\n```\r\n</details>",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2795829514",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17237317481,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAQDbJdp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17237317481",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b8c8ff8968bf902abbc183c249ba8e7df8273a4a",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/b8c8ff8968bf902abbc183c249ba8e7df8273a4a",
      "created_at": "2025-04-13T05:08:16Z"
    },
    {
      "event": "commented",
      "id": 2799656389,
      "node_id": "IC_kwDOABII586m313F",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2799656389",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-13T05:08:53Z",
      "updated_at": "2025-04-13T05:08:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "`17342ec4b5...b8c8ff8968`: address https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2040875380",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2799656389",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 2762792984,
      "node_id": "PRR_kwDOABII586krOAY",
      "url": null,
      "actor": null,
      "commit_id": "b8c8ff8968bf902abbc183c249ba8e7df8273a4a",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-13T16:29:49Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2762792984",
      "submitted_at": "2025-04-13T16:29:49Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "labeled",
      "id": 17257224611,
      "node_id": "LE_lADOABII585-yiT2zwAAAAQEnFmj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17257224611",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-14T22:58:26Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17261453448,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAQE3OCI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17261453448",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "400e9b17649497e298f76bc420d1a4933d5a4568",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/400e9b17649497e298f76bc420d1a4933d5a4568",
      "created_at": "2025-04-15T05:09:23Z"
    },
    {
      "event": "commented",
      "id": 2803821570,
      "node_id": "IC_kwDOABII586nHuwC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2803821570",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-15T05:10:04Z",
      "updated_at": "2025-04-15T05:10:04Z",
      "author_association": "CONTRIBUTOR",
      "body": "`b8c8ff8968...400e9b1764`: rebase due to conflicts and https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2042370434",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2803821570",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 17261536806,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAQE3iYm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17261536806",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-15T05:14:53Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2769080193,
      "node_id": "PRR_kwDOABII586lDM-B",
      "url": null,
      "actor": null,
      "commit_id": "400e9b17649497e298f76bc420d1a4933d5a4568",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-15T16:30:40Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2769080193",
      "submitted_at": "2025-04-15T16:30:40Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17288218960,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAQGdUlQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17288218960",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "2b34857ad54aebbf0a9271e742c2caee85577bc8",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/2b34857ad54aebbf0a9271e742c2caee85577bc8",
      "created_at": "2025-04-16T12:26:19Z"
    },
    {
      "event": "commented",
      "id": 2809425085,
      "node_id": "IC_kwDOABII586ndGy9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2809425085",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-16T12:26:49Z",
      "updated_at": "2025-04-16T12:26:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "`400e9b1764...2b34857ad5`: address https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2045034011",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2809425085",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 2776054347,
      "node_id": "PRR_kwDOABII586ldzpL",
      "url": null,
      "actor": null,
      "commit_id": "2b34857ad54aebbf0a9271e742c2caee85577bc8",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-17T14:51:45Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2776054347",
      "submitted_at": "2025-04-17T14:51:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 2780003837,
      "node_id": "PRR_kwDOABII586ls339",
      "url": null,
      "actor": null,
      "commit_id": "2b34857ad54aebbf0a9271e742c2caee85577bc8",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-19T15:25:09Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2780003837",
      "submitted_at": "2025-04-19T15:25:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "commented",
      "id": 2816767319,
      "node_id": "IC_kwDOABII586n5HVX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2816767319",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-19T16:10:37Z",
      "updated_at": "2025-04-19T16:10:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK 2b34857ad54aebbf0a9271e742c2caee85577bc8 - modulo the functional test malleated valid witness comment\r\n\r\nMade many successful private broadcast connections with all 4 network types.\r\nSuccessfully had connections timeout after sending the INV.\r\nTested resending the same raw tx multiple times.\r\nTested sending many double spends of the same tx at the same time.\r\nSuccessfully had stale txs reattempted.\r\nTested with both `-maxconnections=0` and many inbound and outbound connections.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2816767319",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "review_requested",
      "id": 17329047795,
      "node_id": "RRE_lADOABII585-yiT2zwAAAAQI5Ejz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17329047795",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-19T16:10:46Z",
      "requested_reviewer": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 2780027129,
      "node_id": "PRR_kwDOABII586ls9j5",
      "url": null,
      "actor": null,
      "commit_id": "2b34857ad54aebbf0a9271e742c2caee85577bc8",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-19T16:32:29Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2780027129",
      "submitted_at": "2025-04-19T16:32:29Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 2781261301,
      "node_id": "PRR_kwDOABII586lxq31",
      "url": null,
      "actor": null,
      "commit_id": "2b34857ad54aebbf0a9271e742c2caee85577bc8",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-21T13:39:29Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2781261301",
      "submitted_at": "2025-04-21T13:39:29Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "commented",
      "id": 2822874857,
      "node_id": "IC_kwDOABII586oQabp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2822874857",
      "actor": {
        "login": "Asad1445",
        "id": 49920200,
        "node_id": "MDQ6VXNlcjQ5OTIwMjAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/49920200?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Asad1445",
        "html_url": "https://github.com/Asad1445",
        "followers_url": "https://api.github.com/users/Asad1445/followers",
        "following_url": "https://api.github.com/users/Asad1445/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Asad1445/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Asad1445/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Asad1445/subscriptions",
        "organizations_url": "https://api.github.com/users/Asad1445/orgs",
        "repos_url": "https://api.github.com/users/Asad1445/repos",
        "events_url": "https://api.github.com/users/Asad1445/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Asad1445/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-23T02:02:47Z",
      "updated_at": "2025-04-23T02:17:01Z",
      "author_association": "NONE",
      "body": "1FiHzRUVuA9rx3QJiCbnmoqtu7KouUoMPq",
      "user": {
        "login": "Asad1445",
        "id": 49920200,
        "node_id": "MDQ6VXNlcjQ5OTIwMjAw",
        "avatar_url": "https://avatars.githubusercontent.com/u/49920200?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Asad1445",
        "html_url": "https://github.com/Asad1445",
        "followers_url": "https://api.github.com/users/Asad1445/followers",
        "following_url": "https://api.github.com/users/Asad1445/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Asad1445/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Asad1445/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Asad1445/subscriptions",
        "organizations_url": "https://api.github.com/users/Asad1445/orgs",
        "repos_url": "https://api.github.com/users/Asad1445/repos",
        "events_url": "https://api.github.com/users/Asad1445/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Asad1445/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2822874857",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 2763515026,
      "node_id": "PRR_kwDOABII586kt-SS",
      "url": null,
      "actor": null,
      "commit_id": "2b34857ad54aebbf0a9271e742c2caee85577bc8",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-23T08:31:52Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2763515026",
      "submitted_at": "2025-04-23T08:31:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17370550607,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAQLXZFP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17370550607",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "1c16944a4aff71e6560703916b11b2a544ea71ca",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/1c16944a4aff71e6560703916b11b2a544ea71ca",
      "created_at": "2025-04-23T12:52:49Z"
    },
    {
      "event": "commented",
      "id": 2824202867,
      "node_id": "IC_kwDOABII586oVepz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2824202867",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-23T12:53:04Z",
      "updated_at": "2025-04-23T12:53:04Z",
      "author_association": "CONTRIBUTOR",
      "body": "`2b34857ad5...1c16944a4a`: address suggestions",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2824202867",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2824999837,
      "node_id": "IC_kwDOABII586oYhOd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2824999837",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-23T17:17:48Z",
      "updated_at": "2025-04-23T17:17:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 1c16944a4aff71e6560703916b11b2a544ea71ca\r\n\r\nDiff from 2b34857ad54aebbf0a9271e742c2caee85577bc8 is trivial.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2824999837",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 17463838275,
      "node_id": "LE_lADOABII585-yiT2zwAAAAQQ7QZD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17463838275",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-29T23:11:05Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17573906301,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAQXfId9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17573906301",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "32488cfd6cfe219c930498ffffc469e7d05cfe44",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/32488cfd6cfe219c930498ffffc469e7d05cfe44",
      "created_at": "2025-05-08T13:17:41Z"
    },
    {
      "event": "commented",
      "id": 2863039003,
      "node_id": "IC_kwDOABII586qpoIb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2863039003",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-08T13:17:50Z",
      "updated_at": "2025-05-08T13:17:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "`1c16944a4a...32488cfd6c`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2863039003",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 17575123531,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAQXjxpL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17575123531",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-08T14:29:15Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 17698467708,
      "node_id": "LE_lADOABII585-yiT2zwAAAAQe6S98",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17698467708",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-17T09:47:09Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17731073497,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAQg2rXZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17731073497",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "fb12a062b82520e4d498ee22b7c6f5ce0d4d74b4",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/fb12a062b82520e4d498ee22b7c6f5ce0d4d74b4",
      "created_at": "2025-05-20T10:05:07Z"
    },
    {
      "event": "commented",
      "id": 2893760250,
      "node_id": "IC_kwDOABII586se0b6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2893760250",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-20T10:05:26Z",
      "updated_at": "2025-05-20T10:05:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "`32488cfd6c...fb12a062b8`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2893760250",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 17733089504,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAQg-Xjg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17733089504",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-20T12:11:03Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 17741717919,
      "node_id": "LE_lADOABII585-yiT2zwAAAAQhfSGf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17741717919",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-20T21:00:10Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17753233606,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAQiLNjG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17753233606",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "cedbc2cd99754c099e92f074e1d5566da265bf26",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/cedbc2cd99754c099e92f074e1d5566da265bf26",
      "created_at": "2025-05-21T12:48:41Z"
    },
    {
      "event": "commented",
      "id": 2897850022,
      "node_id": "IC_kwDOABII586sua6m",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2897850022",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T12:48:55Z",
      "updated_at": "2025-05-21T12:48:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "`fb12a062b8...cedbc2cd99`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2897850022",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 17754986779,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAQiR5kb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17754986779",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T14:23:43Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 17757092241,
      "node_id": "LE_lADOABII585-yiT2zwAAAAQiZ7mR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17757092241",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T16:16:10Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 17764641334,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAQi2uo2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17764641334",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-22T04:34:44Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2905206387,
      "node_id": "IC_kwDOABII586tKe5z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2905206387",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-23T17:22:40Z",
      "updated_at": "2025-05-23T17:22:40Z",
      "author_association": "MEMBER",
      "body": "Concept ACK, need to review this",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2905206387",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2907963606,
      "node_id": "IC_kwDOABII586tVADW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2907963606",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-25T17:35:03Z",
      "updated_at": "2025-05-25T17:35:03Z",
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK cedbc2cd99754c099e92f074e1d5566da265bf26\r\n\r\nChanges from previously ACK'd 1c16944a4aff71e6560703916b11b2a544ea71ca - `git range-diff 99a4ddf5ab...1c16944a4a 7763e86afa...cedbc2cd99`\r\n\r\n- CSempahoreGrant -> CountingSemaphoreGrant in c3ff0b2e46be289f7c8e4aa2ea72b18f853dc100\r\n- CSemaphoreGrant::post -> CountingSempahoreGrant::release in c3ff0b2e46be289f7c8e4aa2ea72b18f853dc100\r\n- CSempahore -> std::counting_sempahore in c3ff0b2e46be289f7c8e4aa2ea72b18f853dc100\r\n- Removed some changes to `CWallet::ResubmitWalletTransactions` callsites used for legacy wallet in 0c1b3988a3af703302d01d586ca9aaf75f0144b0.\r\n- Removed a leading `\\n` character in aeddefa4b6144b3ddc401a2f03052a83d3361a60.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2907963606",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "review_requested",
      "id": 17805025336,
      "node_id": "RRE_lADOABII585-yiT2zwAAAAQlQyA4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17805025336",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-25T17:35:13Z",
      "requested_reviewer": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "commented",
      "id": 2920377815,
      "node_id": "IC_kwDOABII586uEW3X",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2920377815",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-29T19:30:29Z",
      "updated_at": "2025-05-29T19:30:29Z",
      "author_association": "MEMBER",
      "body": "Tested this again with Warnet branch https://github.com/bitcoin-dev-project/warnet/pull/720, a feature that actually deploys a \"local\" Tor with its own directory authority into the cluster -- so I can deploy 20 regtest with onion addresses and monitor them all. Was able to catch to the private broadcast connections in the `netinfo` dashboard:\r\n\r\n```\r\n<->   type   net   serv  v  mping   ping send recv  txn  blk  hb addrp addrl  age id address\r\nout   priv onion   nwl2  2                  0    0                   .          0 54 ljockabue5siujir4sqsgc23ks4jgfdlyxd2eedqk4ywe3iwajigplad.onion:18444\r\nout   priv onion   nwl2  2                  1    1                   .          0 53 6vzl73cby36qkbsaiinplnsz5mufxtzjr3xubgdliucpjx53lgfw2nad.onion:18444\r\n```\r\n\r\nI can also grep all the nodes' logs for the txid and observe the relay pattern across the network:\r\n\r\nHere, tank-0000 sends a tx to tank-0001\r\n\r\n```\r\ntank-0000 default [privatebroadcast] Requesting 3 new connections due to txid=bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2, wtxid=bf7d6a592f8a04ea4799e4748d2e7a9a57ec669b68b747f0c74035c2f22bb733\r\ntank-0000 default [privatebroadcast:info] P2P handshake completed, sending INV for txid=bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2, wtxid=bf7d6a592f8a04ea4799e4748d2e7a9a57ec669b68b747f0c74035c2f22bb733, peer=206 peeraddr=10.109.0.153:18444\r\ntank-0016 default [net] got inv: tx bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2  new peer=103\r\ntank-0000 default [privatebroadcast:info] P2P handshake completed, sending INV for txid=bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2, wtxid=bf7d6a592f8a04ea4799e4748d2e7a9a57ec669b68b747f0c74035c2f22bb733, peer=207 peeraddr=ah3rqn6qilhnqscv76gk5xzdxvoh7y7d2psoujtrjggmsiwqif53f4yd.onion:18444\r\ntank-0014 default [net] got inv: tx bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2  new peer=122\r\ntank-0000 default [net] received getdata for: tx bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2 peer=206\r\ntank-0016 default [net] Requesting tx bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2 peer=103\r\ntank-0000 default [privatebroadcast:info] Received our privately broadcast transaction (txid=bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2) from the network from peer=28 peeraddr=10.108.51.222:18444; stopping private broadcast attempts\r\ntank-0000 default [miner] AddToWallet bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2  new InMempool\r\ntank-0001 default [miner] AddToWallet bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2  new InMempool\r\n\r\n```\r\n\r\nOne thing I noticed is that if I (perhaps accidentally) `sendrawtransaction` the same tx a second time, we open private connections, send our `INV` -- but those nodes already have the tx. So the connection remains open until we get disconnected by (I think) the remote peer when we (I think) ignore their `PING`. The cycle then continues, even though the re-submitted tx is in our own mempool already! \r\n\r\n```\r\ntank-0000 default [privatebroadcast] Requesting 3 new connections due to txid=bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2, wtxid=bf7d6a592f8a04ea4799e4748d2e7a9a57ec669b68b747f0c74035c2f22bb733\r\ntank-0000 default [privatebroadcast:info] P2P handshake completed, sending INV for txid=bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2, wtxid=bf7d6a592f8a04ea4799e4748d2e7a9a57ec669b68b747f0c74035c2f22bb733, peer=211 peeraddr=2iz75k2b3w5krzrf4si3axpgc3hbpvwoiq3ry7kppnohh4icmu4l4myd.onion:18444\r\ntank-0011 default [net] got inv: tx bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2  have peer=108\r\ntank-0000 default [privatebroadcast:info] P2P handshake completed, sending INV for txid=bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2, wtxid=bf7d6a592f8a04ea4799e4748d2e7a9a57ec669b68b747f0c74035c2f22bb733, peer=212 peeraddr=ctxl43uomyccbdknlpr2bp57va64eprkcch66nwwhnjbnwqeslfy3yid.onion:18444\r\ntank-0009 default [net] got inv: tx bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2  have peer=111\r\ntank-0000 default [privatebroadcast:info] P2P handshake completed, sending INV for txid=bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2, wtxid=bf7d6a592f8a04ea4799e4748d2e7a9a57ec669b68b747f0c74035c2f22bb733, peer=213 peeraddr=kcbwa3x2cdes6yyshibbydq5ataeorsvntraanmvbmucfvk5uvu2jaad.onion:18444\r\ntank-0017 default [net] got inv: tx bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2  have peer=111\r\n```\r\n\r\nThis appears to continue even after the tx is confirmed, until \r\n```\r\nGiving up broadcast attempts for txid=bd7e40aa9d6346ac3513b0daac10cc8329a41ef2f180473cccfd7446489e0ba2 wtxid=bf7d6a592f8a04ea4799e4748d2e7a9a57ec669b68b747f0c74035c2f22bb733: txn-already-known\r\n```",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2920377815",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2930801207,
      "node_id": "IC_kwDOABII586usHo3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2930801207",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-02T13:42:19Z",
      "updated_at": "2025-06-02T13:42:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "> if I (perhaps accidentally) `sendrawtransaction` the same tx a second time, we open private connections, send our INV -- but those nodes already have the tx.\r\n\r\nThis PR will not queue new private broadcast connections if the same tx is submitted again. However, it does keep trying to broadcast with the 3 connections queued from the first time the tx is submitted. If those peers already have the tx, then the connection will wait for 3 minutes until disconnecting. See discussion [here](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2042370434) for why I think we should treat a 3 minute wait as a successful private broadcast connection and decrement the queued connection count.\r\n\r\n> The cycle then continues, even though the re-submitted tx is in our own mempool already!\r\n\r\nThis should not happen with this PR. The tx is removed from the private broadcast queue when we receive it in our mempool. Were you testing on the latest version of this PR?\r\n",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2930801207",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2931233423,
      "node_id": "IC_kwDOABII586utxKP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2931233423",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-02T15:20:16Z",
      "updated_at": "2025-06-02T15:20:16Z",
      "author_association": "MEMBER",
      "body": "> This PR will not queue new private broadcast connections if the same tx is submitted again.\r\n\r\nWhere is this implemented in the PR?",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2931233423",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2931272929,
      "node_id": "IC_kwDOABII586ut6zh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2931272929",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-02T15:31:38Z",
      "updated_at": "2025-06-02T15:33:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "@pinheadmz in [ScheduleTxForPrivateBroadcast](https://github.com/bitcoin/bitcoin/pull/29415/files#diff-6875de769e90cec84d2e8a9c1b962cdbcda44d870d42e4215827e599e11e90e3R2295-R2313) we check if the tx was inserted into the private broadcast queue, and only then do we queue more private broadcast connections to open. The tx is removed from the private broadcast queue when we receive the tx in our mempool [here](https://github.com/bitcoin/bitcoin/pull/29415/files#diff-6875de769e90cec84d2e8a9c1b962cdbcda44d870d42e4215827e599e11e90e3R4536).\r\n\r\nEdit: ugh it's hard to link to the lines, because they are not expanded by default in `net_processing.cpp`. They are lines 2295-2313 in `net_processing.cpp`.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2931272929",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 17937126700,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAQtItUs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17937126700",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-02T15:31:39Z"
    },
    {
      "event": "subscribed",
      "id": 17937126716,
      "node_id": "SE_lADOABII585-yiT2zwAAAAQtItU8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17937126716",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-02T15:31:39Z"
    },
    {
      "event": "commented",
      "id": 2931283927,
      "node_id": "IC_kwDOABII586ut9fX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2931283927",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-02T15:34:37Z",
      "updated_at": "2025-06-02T15:34:37Z",
      "author_association": "MEMBER",
      "body": "Ok and then after the tx is received in mempool and removed from queue, I send it again. I think it's probably harmless but we will continue to re-send the tx until it finally gets confirmed and then `ReattemptPrivateBroadcast()` will catch it as txn-already-known",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2931283927",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2931287755,
      "node_id": "IC_kwDOABII586ut-bL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2931287755",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-02T15:35:37Z",
      "updated_at": "2025-06-02T15:35:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Ok and then after the tx is received in mempool and removed from queue, I send it again.\r\n\r\nBut `sendrawtransaction` will fail if the tx is already in our mempool, no? How will this succeed?",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2931287755",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2931306622,
      "node_id": "IC_kwDOABII586uuDB-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2931306622",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-02T15:40:53Z",
      "updated_at": "2025-06-02T15:40:53Z",
      "author_association": "MEMBER",
      "body": "> But `sendrawtransaction` will fail if the tx is already in our mempool, no? How will this succeed?\r\n\r\nAre you sure about this?\r\n\r\n```\r\n\r\n            // There's already a transaction in the mempool with this txid. Don't\r\n            // try to submit this transaction to the mempool (since it'll be\r\n            // rejected as a TX_CONFLICT), but do attempt to reannounce the mempool\r\n            // transaction if broadcast_method is not ADD_TO_MEMPOOL_NO_BROADCAST.\r\n            //\r\n            // The mempool transaction may have the same or different witness (and\r\n            // wtxid) as this transaction. Use the mempool's wtxid for reannouncement.\r\n```",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2931306622",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2931340529,
      "node_id": "IC_kwDOABII586uuLTx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2931340529",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-02T15:48:40Z",
      "updated_at": "2025-06-02T18:48:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Are you sure about this?\r\n\r\nI was not sure, thanks for the correction :). I see we only check for acceptance if the tx is not already in our mempool. If it is, then we skip checking acceptance and try and broadcast again. That behavior makes sense to me, and I think this is another reason why we should treat 3 minute timeouts waiting for `GETDATA` as a successful private broadcast connection.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2931340529",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2956055221,
      "node_id": "IC_kwDOABII586wMdK1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2956055221",
      "actor": {
        "login": "kdmukai",
        "id": 934746,
        "node_id": "MDQ6VXNlcjkzNDc0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/934746?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kdmukai",
        "html_url": "https://github.com/kdmukai",
        "followers_url": "https://api.github.com/users/kdmukai/followers",
        "following_url": "https://api.github.com/users/kdmukai/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kdmukai/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kdmukai/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kdmukai/subscriptions",
        "organizations_url": "https://api.github.com/users/kdmukai/orgs",
        "repos_url": "https://api.github.com/users/kdmukai/repos",
        "events_url": "https://api.github.com/users/kdmukai/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kdmukai/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-09T14:59:17Z",
      "updated_at": "2025-06-09T14:59:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "## Summary\r\nSince this PR now has 444 comments, this is an attempt to help people get up to speed on the discussion thus far and identify any remaining concerns or TODO items.\r\n\r\nNote vasild's \"Further extensions\" section in the PR description. Throughout this discussion he has emphasized keeping this PR as simple as possible, deferring further work to subsequent PRs.\r\n\r\n\r\n## Q&A highlights\r\n* vasild to 1440000bytes: [Why not relay to an existing Tor peer?](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1936992757)\r\n  * [1440000bytes' follow-up](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2466865095)\r\n  * [related response to learnwayback](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2786464771)\r\n* vasild to epiccurious: [This PR's privacy wins vs encrypting all relay traffic?](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1937766372)\r\n* vasild to andrewtoth: [What if the recipient needs the parent tx also?](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2013120102)\r\n  * [vasild follow up](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2027080005)\r\n* pinheadmz, others (from prior related PR): [Why hard-code a user agent for these broadcasts?](https://github.com/bitcoin/bitcoin/pull/27509#discussion_r1214671917)\r\n  * [continues here](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1518263617)\r\n* vasild to sr-gi: [Why `MAX_PRIVATE_BROADCAST_CONNECTIONS=64`?](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1607031740)\r\n* vasild: [Why `NUM_PRIVATE_BROADCAST_PER_TX=3`?](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2771929840)\r\n* mzumsande, others: [Where to define `TxBroadcastMethod` -> `node/types.h`](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1540013020)\r\n* vasild to mzumsande: [step through theoretical attack + mitigation](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1540139554)\r\n* vasild to sr-gi: [Prioritization of private broadcast vs other connections](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1595819770)\r\n  * [related discussion w/mzumsande](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1781677003)\r\n\r\n\r\n## Useful comments\r\n* iotamega: [note that corporate firewalls block Tor/I2P](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2000166681)\r\n* nothingmuch: [warn if `privatebroadcast=1` and `proxyrandomize=0`](https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1984991157)\r\n  * vasild: [warning added](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2072977453)\r\n  * related [`walletbroadcast=0` restriction removed](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1660978352)\r\n* gmaxwell: [PR is strong against attacker running many nodes, weak against direct Tor traffic analysis](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2295439986) (but deems this a lesser risk)\r\n  * vasild: [response to gmaxwell, also to w0xlt on decoy txs](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035018416)\r\n* andrewtoth: [sending multiple txs quickly using `walletcreatefundedpsbt` can create double spend attempts](https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2745195105)\r\n* pinheadmz: [Successful testing in a 20 node Tor cluster](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2920377815)\r\n* nothingmuch: [Can add clearnet connections when using Tor](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1554905733)\r\n* MarnixCroes, others: [can't run with `-connect`; solution = `-maxconnections=0 -addnode=<localnode>`](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1700086637)\r\n* mzumsande: [avoid `Good()` and `Connected()` to prevent inadvertent Tor connection reuse](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1781795191)\r\n* mzumsande: [checking txid vs wtxid to decide private broadcast was successful](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1781868981)\r\n\r\n## Unresolved questions / remaining TODO\r\n\r\n### Send INV message?\r\nDiscussion of the exact broadcast approach to take seemed to coalesce in favor of sending INV and then waiting for the GETDATA request. But there are subtleties to consider around what it means if the connection times out at various stages of the communication cycle, when to consider the private broadcast a success, etc.\r\n\r\nSee the last two bullet points in particular for the most recent ongoing discussions. This goes beyond my depth so unfortunately I can't say how much remains to be resolved here.\r\n\r\n* andrewtoth: [Beginning of discussion on TX vs INV / GETDATA / TX](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2008043439)\r\n* gmaxwell: [should send INV and wait](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2267359160)\r\n* vasild: [implemented INV / GETDATA / TX but with misgivings](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2286098751)\r\n* mzumsande: [Send INV](https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2751328427)\r\n* mzumsande: [More detailed discussion of de-anon analysis / timing considerations](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035643498)\r\n* andrewtoth: [Further timeout considerations](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2041159799)\r\n\r\n### Misc\r\nThe only other open TODO items or unresolved concerns I could identify:\r\n- [ ] andrewtoth: [missing test coverage](https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-1974917244) (now resolved?)\r\n- [ ] sr-gi: Are you satisfied with [vasild's answer re: `m_private_broadcast_connections_to_open`](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608327017)?",
      "user": {
        "login": "kdmukai",
        "id": 934746,
        "node_id": "MDQ6VXNlcjkzNDc0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/934746?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kdmukai",
        "html_url": "https://github.com/kdmukai",
        "followers_url": "https://api.github.com/users/kdmukai/followers",
        "following_url": "https://api.github.com/users/kdmukai/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kdmukai/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kdmukai/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kdmukai/subscriptions",
        "organizations_url": "https://api.github.com/users/kdmukai/orgs",
        "repos_url": "https://api.github.com/users/kdmukai/repos",
        "events_url": "https://api.github.com/users/kdmukai/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kdmukai/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2956055221",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2956071169,
      "node_id": "IC_kwDOABII586wMhEB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2956071169",
      "actor": {
        "login": "kdmukai",
        "id": 934746,
        "node_id": "MDQ6VXNlcjkzNDc0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/934746?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kdmukai",
        "html_url": "https://github.com/kdmukai",
        "followers_url": "https://api.github.com/users/kdmukai/followers",
        "following_url": "https://api.github.com/users/kdmukai/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kdmukai/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kdmukai/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kdmukai/subscriptions",
        "organizations_url": "https://api.github.com/users/kdmukai/orgs",
        "repos_url": "https://api.github.com/users/kdmukai/repos",
        "events_url": "https://api.github.com/users/kdmukai/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kdmukai/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-09T15:04:41Z",
      "updated_at": "2025-06-09T15:04:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK.\r\n\r\nThis seems like a significant chain analysis heuristic breaker. While only newly updated nodes would have this private broadcast option, my understanding is that any Tor- or I2P-enabled node will be able to receive these txs and then broadcast them out to all their peers.\r\n\r\nSo now the broadcaster-is-the-sender heuristic is permanently called into question _even when it's an older node_ that's being spied on. That's pretty neat.",
      "user": {
        "login": "kdmukai",
        "id": 934746,
        "node_id": "MDQ6VXNlcjkzNDc0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/934746?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kdmukai",
        "html_url": "https://github.com/kdmukai",
        "followers_url": "https://api.github.com/users/kdmukai/followers",
        "following_url": "https://api.github.com/users/kdmukai/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kdmukai/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kdmukai/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kdmukai/subscriptions",
        "organizations_url": "https://api.github.com/users/kdmukai/orgs",
        "repos_url": "https://api.github.com/users/kdmukai/repos",
        "events_url": "https://api.github.com/users/kdmukai/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kdmukai/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2956071169",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 2956083575,
      "node_id": "IC_kwDOABII586wMkF3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2956083575",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-09T15:09:05Z",
      "updated_at": "2025-06-09T15:09:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "> my understanding is that any Tor- or I2P-enabled node will be able to receive these txs and then broadcast them out to all their peers.\r\n\r\n@kdmukai it's even better than that, any node listening on clearnet can also receive these txs through Tor exit nodes and appear to be the broadcast origin.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2956083575",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 18057380501,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAQ0TcKV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18057380501",
      "actor": {
        "login": "kdmukai",
        "id": 934746,
        "node_id": "MDQ6VXNlcjkzNDc0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/934746?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kdmukai",
        "html_url": "https://github.com/kdmukai",
        "followers_url": "https://api.github.com/users/kdmukai/followers",
        "following_url": "https://api.github.com/users/kdmukai/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kdmukai/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kdmukai/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kdmukai/subscriptions",
        "organizations_url": "https://api.github.com/users/kdmukai/orgs",
        "repos_url": "https://api.github.com/users/kdmukai/repos",
        "events_url": "https://api.github.com/users/kdmukai/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kdmukai/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-09T15:09:06Z"
    },
    {
      "event": "subscribed",
      "id": 18057380529,
      "node_id": "SE_lADOABII585-yiT2zwAAAAQ0TcKx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18057380529",
      "actor": {
        "login": "kdmukai",
        "id": 934746,
        "node_id": "MDQ6VXNlcjkzNDc0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/934746?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kdmukai",
        "html_url": "https://github.com/kdmukai",
        "followers_url": "https://api.github.com/users/kdmukai/followers",
        "following_url": "https://api.github.com/users/kdmukai/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kdmukai/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kdmukai/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kdmukai/subscriptions",
        "organizations_url": "https://api.github.com/users/kdmukai/orgs",
        "repos_url": "https://api.github.com/users/kdmukai/repos",
        "events_url": "https://api.github.com/users/kdmukai/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kdmukai/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-09T15:09:06Z"
    },
    {
      "event": "labeled",
      "id": 18102788514,
      "node_id": "LE_lADOABII585-yiT2zwAAAAQ3AqGi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18102788514",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-11T22:32:34Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2972766537,
      "node_id": "IC_kwDOABII586xMNFJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2972766537",
      "actor": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-14T13:32:55Z",
      "updated_at": "2025-06-14T13:32:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK, still need to review fully\r\n\r\nI wrote a fuzz test for `private_broadcast.cpp` https://github.com/kevkevinpal/bitcoin/commit/fcee39cdefcf5ccb55ae9a019d534e09f230e50c\r\nFeel free to pick the commit\r\n\r\nAdded coverage\r\n![Screenshot 2025-06-14 at 8 30 16â€¯AM](https://github.com/user-attachments/assets/ac342d33-0499-458e-bdf0-684f1f6e721c)\r\n",
      "user": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2972766537",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 2932613802,
      "node_id": "PRR_kwDOABII586uzCKq",
      "url": null,
      "actor": null,
      "commit_id": "cedbc2cd99754c099e92f074e1d5566da265bf26",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-06-16T15:37:42Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK cedbc2cd99754c099e92f074e1d5566da265bf26 (I know it needs rebase)\r\n\r\nI reviewed the code again and tested this on signet over the last couple of days - it works well.\r\nWhile it increases complexity of `net_processing` and `net`, I think the privacy gains are worth it.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2932613802",
      "submitted_at": "2025-06-16T15:37:42Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18207569079,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAQ9QXS3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18207569079",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "281f6f3b4d215630f8e4193454c0b5fa75385ec5",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/281f6f3b4d215630f8e4193454c0b5fa75385ec5",
      "created_at": "2025-06-18T10:24:02Z"
    },
    {
      "event": "commented",
      "id": 2983626651,
      "node_id": "IC_kwDOABII586x1oeb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2983626651",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-18T10:24:16Z",
      "updated_at": "2025-06-18T10:26:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "`cedbc2cd99...281f6f3b4d`: rebase due to conflicts and address a suggestion\r\n\r\nEdit:\r\n> I wrote a fuzz test for private_broadcast.cpp https://github.com/kevkevinpal/bitcoin/commit/fcee39cdefcf5ccb55ae9a019d534e09f230e50c\r\n\r\n@kevkevinpal, that looks nice! I am doing some mods to it and will come back with it soon...",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2983626651",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 18207616230,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAQ9Qizm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18207616230",
      "actor": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-18T10:27:04Z"
    },
    {
      "event": "subscribed",
      "id": 18207616256,
      "node_id": "SE_lADOABII585-yiT2zwAAAAQ9Qi0A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18207616256",
      "actor": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-18T10:27:04Z"
    },
    {
      "event": "labeled",
      "id": 18208640182,
      "node_id": "LE_lADOABII585-yiT2zwAAAAQ9Ucy2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18208640182",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-18T11:33:16Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 18208800130,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAQ9VD2C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18208800130",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-18T11:43:22Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 18220233818,
      "node_id": "LE_lADOABII585-yiT2zwAAAAQ-ArRa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18220233818",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-19T00:31:58Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18226666048,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAQ-ZNpA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18226666048",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "4a873c2a67fd33111da97ce675aee7994b99546c",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/4a873c2a67fd33111da97ce675aee7994b99546c",
      "created_at": "2025-06-19T09:31:59Z"
    },
    {
      "event": "commented",
      "id": 2987446188,
      "node_id": "IC_kwDOABII586yEM-s",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2987446188",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-19T09:43:38Z",
      "updated_at": "2025-06-19T09:43:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "`281f6f3b4d...4a873c2a67`: rebase due to conflicts and break an `if` into two equivalent `if`s to make it more readable, fix a silent conflict in the functional test - use `.txid_hex` instead of `.rehash()`.\r\n\r\nA modified version of the fuzz test from https://github.com/kevkevinpal/bitcoin/commit/fcee39cdefcf5ccb55ae9a019d534e09f230e50c is in https://github.com/vasild/bitcoin/commit/1c406354fc7254dc9266d1c69f4a4e7dcb478856. Thanks @kevkevinpal! Since the fuzz test is an extra load on reviewers and is not a blocker for this PR I did not include it (yet) here. If reviewers like it and are willing to ACK it as well, then I will add that commit on top of this PR, otherwise it will be in a followup.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2987446188",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 18226867027,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAQ-Z-tT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18226867027",
      "actor": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-19T09:43:39Z"
    },
    {
      "event": "subscribed",
      "id": 18226867071,
      "node_id": "SE_lADOABII585-yiT2zwAAAAQ-Z-t_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18226867071",
      "actor": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-19T09:43:39Z"
    },
    {
      "event": "unlabeled",
      "id": 18228312091,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAQ-ffgb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18228312091",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-19T11:17:54Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 18228924064,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAQ-h06g",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18228924064",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-19T11:52:42Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2987928588,
      "node_id": "IC_kwDOABII586yGCwM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2987928588",
      "actor": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-19T12:29:28Z",
      "updated_at": "2025-06-19T12:29:28Z",
      "author_association": "CONTRIBUTOR",
      "body": "> A modified version of the fuzz test from https://github.com/kevkevinpal/bitcoin/commit/fcee39cdefcf5ccb55ae9a019d534e09f230e50c is in https://github.com/vasild/bitcoin/commit/1c406354fc7254dc9266d1c69f4a4e7dcb478856. Thanks @kevkevinpal! Since the fuzz test is an extra load on reviewers and is not a blocker for this PR I did not include it (yet) here. If reviewers like it and are willing to ACK it as well, then I will add that commit on top of this PR, otherwise it will be in a followup.\n\nYup no problem! Adding as a follow-up sounds good to me",
      "user": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2987928588",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 18229622474,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAQ-kfbK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18229622474",
      "actor": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-19T12:29:29Z"
    },
    {
      "event": "subscribed",
      "id": 18229622500,
      "node_id": "SE_lADOABII585-yiT2zwAAAAQ-kfbk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18229622500",
      "actor": {
        "login": "kevkevinpal",
        "id": 15950706,
        "node_id": "MDQ6VXNlcjE1OTUwNzA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15950706?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kevkevinpal",
        "html_url": "https://github.com/kevkevinpal",
        "followers_url": "https://api.github.com/users/kevkevinpal/followers",
        "following_url": "https://api.github.com/users/kevkevinpal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kevkevinpal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kevkevinpal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kevkevinpal/subscriptions",
        "organizations_url": "https://api.github.com/users/kevkevinpal/orgs",
        "repos_url": "https://api.github.com/users/kevkevinpal/repos",
        "events_url": "https://api.github.com/users/kevkevinpal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kevkevinpal/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-19T12:29:29Z"
    },
    {
      "event": "reviewed",
      "id": 2948341713,
      "node_id": "PRR_kwDOABII586vvB_R",
      "url": null,
      "actor": null,
      "commit_id": "4a873c2a67fd33111da97ce675aee7994b99546c",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-06-22T21:15:48Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2948341713",
      "submitted_at": "2025-06-22T21:15:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "reviewed",
      "id": 2972293733,
      "node_id": "PRR_kwDOABII586xKZpl",
      "url": null,
      "actor": null,
      "commit_id": "4a873c2a67fd33111da97ce675aee7994b99546c",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-07-01T13:27:05Z",
      "author_association": "MEMBER",
      "body": "I was experimenting with privacy on Bitcoin core and see this work.\r\nKudos ðŸŽ‰  and thanks for your work to improve privacy\r\n\r\nGreat summary by @kdmukai \r\n\r\nDid some manual tests on signet using the script provided; it was smooth on the happy path\r\n<details> \r\n<summary>See logs</summary>\r\n\r\n```terminal\r\n2025-06-30T17:06:38Z [privatebroadcast:info] P2P handshake completed, sending INV for txid=fdb1884dd42d940c3edd786487e45311a2d5f2328cf7349fa4ad5f29f5449c96, wtxid=862c319f69d047db646a375b2287a511614c246e4956ead1d715d6d492ea1c80, peer=12\r\n2025-06-30T17:06:40Z Saw new header hash=0000000b9db2e9016363a6869d25691acef5ccdb94216c1683dee955dcc8ff4f height=258554 peer=4\r\n2025-06-30T17:06:42Z UpdateTip: new best=0000000b9db2e9016363a6869d25691acef5ccdb94216c1683dee955dcc8ff4f height=258554 version=0x20000000 log2_work=42.262158 tx=21879263 date='2025-06-30T17:06:01Z' progress=1.000000 cache=5.1MiB(25884txo)\r\n2025-06-30T17:06:43Z New private-broadcast v1 peer connected: version: 70016, blocks=258554, peer=14\r\n2025-06-30T17:06:43Z [privatebroadcast:info] P2P handshake completed, sending INV for txid=fdb1884dd42d940c3edd786487e45311a2d5f2328cf7349fa4ad5f29f5449c96, wtxid=862c319f69d047db646a375b2287a511614c246e4956ead1d715d6d492ea1c80, peer=14\r\n2025-06-30T17:06:43Z New private-broadcast v2 peer connected: version: 70016, blocks=258554, peer=13\r\n2025-06-30T17:06:43Z [privatebroadcast:info] P2P handshake completed, sending INV for txid=fdb1884dd42d940c3edd786487e45311a2d5f2328cf7349fa4ad5f29f5449c96, wtxid=862c319f69d047db646a375b2287a511614c246e4956ead1d715d6d492ea1c80, peer=13\r\n2025-06-30T17:06:43Z [privatebroadcast:info] Got a PONG (the transaction will probably reach the network), marking for disconnect, peer=12\r\n2025-06-30T17:06:48Z [privatebroadcast:info] Got a PONG (the transaction will probably reach the network), marking for disconnect, peer=13\r\n2025-06-30T17:06:48Z [privatebroadcast:info] Got a PONG (the transaction will probably reach the network), marking for disconnect, peer=14\r\n2025-06-30T17:06:49Z [privatebroadcast:info] Received our privately broadcast transaction (txid=fdb1884dd42d940c3edd786487e45311a2d5f2328cf7349fa4ad5f29f5449c96) from the network from peer=7; stopping private broadcast attempt\r\n```\r\n</details>\r\n\r\n\r\nI've noticed an issue and have two questions on approach.\r\n\r\n**_Issue_**: I think there is a bug in `BroadcastTransaction` whereby if you pass 0 as the value of `maxfeerate` the transaction won't be broadcasted because  you combine maxfee check and test accept check when we want want private broadcast. \r\n\r\n<details> \r\n<summary>Should fail with this modified bash script</summary>\r\n\r\n```terminal\r\n#!/bin/bash\r\nbuild/bin/bitcoin-cli -chain=\"signet\" loadwallet test\r\n\r\nnew_address=$(build/bin/bitcoin-cli -chain=\"signet\" getnewaddress)\r\npsbt=$(build/bin/bitcoin-cli -chain=\"signet\" walletcreatefundedpsbt \"[]\" \"[{\\\"$new_address\\\": 0.00001}]\" | jq -r '.psbt')\r\necho \"psbt: $psbt\"\r\n\r\n\r\nsigned_tx=$(build/bin/bitcoin-cli -chain=\"signet\" walletprocesspsbt $psbt | jq -r '.hex')\r\necho \"signed_tx: $signed_tx\"\r\n\r\nraw_tx=$(build/bin/bitcoin-cli -chain=\"signet\" sendrawtransaction $signed_tx 0)\r\necho \"raw_tx: $raw_tx\"\r\n```\r\n</details>\r\n\r\n```\r\nerror code: -25\r\nerror message:\r\nmax fee exceeded\r\n```\r\nThe fix is simple i.e is to just separate them or something like that.\r\n\r\n\r\n<details> \r\n<summary>see diff</summary>\r\n\r\n```diff\r\ndiff --git a/src/node/transaction.cpp b/src/node/transaction.cpp\r\nindex 0c4f37e4714..9cd9fde1000 100644\r\n--- a/src/node/transaction.cpp\r\n+++ b/src/node/transaction.cpp\r\n@@ -74,13 +74,27 @@ TransactionError BroadcastTransaction(NodeContext& node,\r\n             wtxid = mempool_tx->GetWitnessHash();\r\n         } else {\r\n             // Transaction is not already in the mempool.\r\n-            if (max_tx_fee > 0 || broadcast_method == NO_MEMPOOL_PRIVATE_BROADCAST) {\r\n+            std::optional<CAmount> base_fee;\r\n+            if (broadcast_method == NO_MEMPOOL_PRIVATE_BROADCAST) {\r\n                 // First, call ATMP with test_accept and check the fee. If ATMP\r\n                 // fails here, return error immediately.\r\n-                const MempoolAcceptResult result = node.chainman->ProcessTransaction(tx, /*test_accept=*/ true);\r\n+                const auto result = node.chainman->ProcessTransaction(tx, /*test_accept=*/ true);\r\n                 if (result.m_result_type != MempoolAcceptResult::ResultType::VALID) {\r\n                     return HandleATMPError(result.m_state, err_string);\r\n-                } else if (result.m_base_fees.value() > max_tx_fee) {\r\n+                }\r\n+                base_fee = result.m_base_fees.value();\r\n+            }\r\n+\r\n+            if (max_tx_fee > 0) {\r\n+                // Only call ProcessTransaction if we did not call it before\r\n+                if (!base_fee) {\r\n+                    const auto result = node.chainman->ProcessTransaction(tx, /*test_accept=*/ true);\r\n+                    if (result.m_result_type != MempoolAcceptResult::ResultType::VALID) {\r\n+                        return HandleATMPError(result.m_state, err_string);\r\n+                    }\r\n+                    base_fee = result.m_base_fees.value();\r\n+                }\r\n+                if (base_fee > max_tx_fee) {\r\n                     return TransactionError::MAX_FEE_EXCEEDED;\r\n                 }\r\n             }\r\n```\r\n</details>\r\n\r\n**_Questions_**\r\n\r\n1. Why is this only on `sendrawtransaction`, could also be implemented on the experimental `submitpackage`  RPC to ensure no contradiction in approach and also 1p1c package relay is a thing now.\r\n(edit: if you have 1p1c that you will want to relay, parent is below the minrelayfee; the mechanism right now is to submit the package txs via `submitpackage`; it will be accepted to the mempool both, and be broadcasted to peers, peers will reject the parent because it is below minrelayfee and accept child in it's orphanage, then request the parent from the peer and this is how the 1p1c will relay (opportunistically))\r\n Correct me if I am wrong they currently contradict base on the decision not to add the txs to the mempool, and in `submitpackage` adding to the mempool before broadcasting is a requirement that must be satisfied although I think you can bye-pass that limitiation easily by passing `test-accept` as  `false` the `ProcessNewPackage` call and then remove the check  that tx must exist in mempool before broadcasting to peers (edit: in case of 1p1c package relay only the child will be accept to peer orphanage but then their is no way for the peer to get the parent from the original sender because it does not save the parent in it's mempool) .\r\n\r\nI've try implementing it and it works\r\n<details> \r\n<summary>see diff</summary>\r\n\r\n```diff\r\ndiff --git a/src/node/transaction.cpp b/src/node/transaction.cpp\r\nindex 0c4f37e4714..9cd9fde1000 100644\r\n--- a/src/node/transaction.cpp\r\n+++ b/src/node/transaction.cpp\r\n@@ -74,13 +74,27 @@ TransactionError BroadcastTransaction(NodeContext& node,\r\n             wtxid = mempool_tx->GetWitnessHash();\r\n         } else {\r\n             // Transaction is not already in the mempool.\r\n-            if (max_tx_fee > 0 || broadcast_method == NO_MEMPOOL_PRIVATE_BROADCAST) {\r\n+            std::optional<CAmount> base_fee;\r\n+            if (broadcast_method == NO_MEMPOOL_PRIVATE_BROADCAST) {\r\n                 // First, call ATMP with test_accept and check the fee. If ATMP\r\n                 // fails here, return error immediately.\r\n-                const MempoolAcceptResult result = node.chainman->ProcessTransaction(tx, /*test_accept=*/ true);\r\n+                const auto result = node.chainman->ProcessTransaction(tx, /*test_accept=*/ true);\r\n                 if (result.m_result_type != MempoolAcceptResult::ResultType::VALID) {\r\n                     return HandleATMPError(result.m_state, err_string);\r\n-                } else if (result.m_base_fees.value() > max_tx_fee) {\r\n+                }\r\n+                base_fee = result.m_base_fees.value();\r\n+            }\r\n+\r\n+            if (max_tx_fee > 0) {\r\n+                // Only call ProcessTransaction if we did not call it before\r\n+                if (!base_fee) {\r\n+                    const auto result = node.chainman->ProcessTransaction(tx, /*test_accept=*/ true);\r\n+                    if (result.m_result_type != MempoolAcceptResult::ResultType::VALID) {\r\n+                        return HandleATMPError(result.m_state, err_string);\r\n+                    }\r\n+                    base_fee = result.m_base_fees.value();\r\n+                }\r\n+                if (base_fee > max_tx_fee) {\r\n                     return TransactionError::MAX_FEE_EXCEEDED;\r\n                 }\r\n             }\r\ndiff --git a/src/rpc/mempool.cpp b/src/rpc/mempool.cpp\r\nindex 4fd78d732f1..f9c1b130665 100644\r\n--- a/src/rpc/mempool.cpp\r\n+++ b/src/rpc/mempool.cpp\r\n@@ -1053,10 +1053,23 @@ static RPCHelpMan submitpackage()\r\n                 throw JSONRPCTransactionError(TransactionError::INVALID_PACKAGE, \"package topology disallowed. not child-with-parents or parents depend on each other.\");\r\n             }\r\n \r\n+            const bool private_broadcast_enabled{gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)};\r\n+            if (private_broadcast_enabled &&\r\n+                !g_reachable_nets.Contains(NET_ONION) &&\r\n+                !g_reachable_nets.Contains(NET_I2P)) {\r\n+                throw JSONRPCError(RPC_MISC_ERROR,\r\n+                                   \"-privatebroadcast is enabled, but none of the Tor or I2P networks is \"\r\n+                                   \"reachable. Maybe the location of the Tor proxy couldn't be retrieved \"\r\n+                                   \"from the Tor daemon at startup. Check whether the Tor daemon is running \"\r\n+                                   \"and that -torcontrol, -torpassword and -i2psam are configured properly.\");\r\n+            }\r\n+            const auto method = private_broadcast_enabled ? node::NO_MEMPOOL_PRIVATE_BROADCAST\r\n+                                                          : node::ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL;\r\n+\r\n             NodeContext& node = EnsureAnyNodeContext(request.context);\r\n             CTxMemPool& mempool = EnsureMemPool(node);\r\n             Chainstate& chainstate = EnsureChainman(node).ActiveChainstate();\r\n-            const auto package_result = WITH_LOCK(::cs_main, return ProcessNewPackage(chainstate, mempool, txns, /*test_accept=*/ false, client_maxfeerate));\r\n+            const auto package_result = WITH_LOCK(::cs_main, return ProcessNewPackage(chainstate, mempool, txns, /*test_accept=*/ private_broadcast_enabled, client_maxfeerate));\r\n \r\n             std::string package_msg = \"success\";\r\n \r\n@@ -1066,9 +1079,9 @@ static RPCHelpMan submitpackage()\r\n                 {\r\n                     // Belt-and-suspenders check; everything should be successful here\r\n                     CHECK_NONFATAL(package_result.m_tx_results.size() == txns.size());\r\n-                    for (const auto& tx : txns) {\r\n-                        CHECK_NONFATAL(mempool.exists(GenTxid::Txid(tx->GetHash())));\r\n-                    }\r\n+                    // for (const auto& tx : txns) {\r\n+                    //     CHECK_NONFATAL(mempool.exists(GenTxid::Txid(tx->GetHash())));\r\n+                    // }\r\n                     break;\r\n                 }\r\n                 case PackageValidationResult::PCKG_MEMPOOL_ERROR:\r\n@@ -1091,17 +1104,15 @@ static RPCHelpMan submitpackage()\r\n             size_t num_broadcast{0};\r\n             for (const auto& tx : txns) {\r\n                 // We don't want to re-submit the txn for validation in BroadcastTransaction\r\n-                if (!mempool.exists(GenTxid::Txid(tx->GetHash()))) {\r\n+                if (!private_broadcast_enabled && !mempool.exists(GenTxid::Txid(tx->GetHash()))) {\r\n                     continue;\r\n                 }\r\n-\r\n-                // We do not expect an error here; we are only broadcasting things already/still in mempool\r\n                 std::string err_string;\r\n                 const auto err = BroadcastTransaction(node,\r\n                                                       tx,\r\n                                                       err_string,\r\n                                                       /*max_tx_fee=*/0,\r\n-                                                      node::ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL,\r\n+                                                      method,\r\n                                                       /*wait_callback=*/true);\r\n                 if (err != TransactionError::OK) {\r\n                     throw JSONRPCTransactionError(err,\r\n```\r\n\r\n</details>\r\n\r\n However I am still not confident on this diff that is the consistency with when `test accept` is  either `false` or `true` since test accept has some limitations see #32160 \r\n\r\n\r\n2. How does this approach compare to running a node with `-onlynet=tor` and `onlynet=i2p` and not having inbound? Because I thought that  I can achieve the privacy that this PR provided by doing that?\r\n(edit: we can then improve this by having a more strict `onlynet` where even inbounds are the network specified ) \r\nOr if conservative you can have two nodes one via with peers only on tor/i2p only and another via clearnet peers and only using my tor node for personal transactions submissions to the network.\r\n\r\nSide question: I see this is opt-in, do we plan to enable this by default; if yes did we have intuition theoretically on the impact on the whole network in terms of tx propagation speed?",
      "user": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2972293733",
      "submitted_at": "2025-06-30T19:07:25Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18500693017,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAROuiwZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18500693017",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "6d697bba168fbe257d23dbdb703c7d2e47be37ed",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/6d697bba168fbe257d23dbdb703c7d2e47be37ed",
      "created_at": "2025-07-07T09:18:47Z"
    },
    {
      "event": "mentioned",
      "id": 18500869838,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAROvN7O",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18500869838",
      "actor": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-07T09:28:29Z"
    },
    {
      "event": "subscribed",
      "id": 18500869888,
      "node_id": "SE_lADOABII585-yiT2zwAAAAROvN8A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18500869888",
      "actor": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-07T09:28:29Z"
    },
    {
      "event": "commented",
      "id": 3044285606,
      "node_id": "IC_kwDOABII5861dBym",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3044285606",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-07T10:04:25Z",
      "updated_at": "2025-07-07T10:04:25Z",
      "author_association": "CONTRIBUTOR",
      "body": "`4a873c2a67...6d697bba16`: rebase and address [the above suggestion about `BroadcastTransaction()`](https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2972293733).\r\n\r\n> I think there is a bug in `BroadcastTransaction()` ...\r\n\r\nRight, good catch! I fixed it like this:\r\n\r\n```diff\r\n             // Transaction is not already in the mempool.\r\n-            if (max_tx_fee > 0 || broadcast_method == NO_MEMPOOL_PRIVATE_BROADCAST) {\r\n+            const bool check_max_fee{max_tx_fee > 0};\r\n+            if (check_max_fee || broadcast_method == NO_MEMPOOL_PRIVATE_BROADCAST) {\r\n                 // First, call ATMP with test_accept and check the fee. If ATMP\r\n                 // fails here, return error immediately.\r\n                 const MempoolAcceptResult result = node.chainman->ProcessTransaction(tx, /*test_accept=*/ true);\r\n                 if (result.m_result_type != MempoolAcceptResult::ResultType::VALID) {\r\n                     return HandleATMPError(result.m_state, err_string);\r\n-                } else if (result.m_base_fees.value() > max_tx_fee) {\r\n+                } else if (check_max_fee && result.m_base_fees.value() > max_tx_fee) {\r\n                     return TransactionError::MAX_FEE_EXCEEDED;\r\n                 }\r\n             }\r\n             \r\n             switch (broadcast_method) {\r\n```\r\nand also tweaked the functional test to cover that `maxtxfee=0` case. The modified test would fail without the above change to `BroadcastTransaction()`. Cool, thanks!\r\n\r\n> Why is this only on `sendrawtransaction`, could also be implemented on the experimental `submitpackage` ...\r\n\r\nYes, this should be also for `submitpackage`. The reason I did not implement it is because I want to cut this PR slim to get the private broadcast mechanism in, reduce review load, because it is already big as it is. There is a \"Future extenstions\" section the PR description, added `submitpackage` there and linked to your comment with the diff.\r\n\r\n> How does this approach compare to running a node with -onlynet=tor and onlynet=i2p and not having inbound? Because I thought that I can achieve the privacy that this PR provided by doing that? ...\r\n\r\nHiding the IP address (geolocation) - yes, but:\r\n1. Sending own transactions over long lived connections is problematic because then two different transactions that are otherwise unrelated, looking at the coins (ie on-chain analysis) could be linked together to the same originator. See the comment above [Would this benefit nodes that don't have clearnet connections, e.g. Tor/I2P-only nodes?](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1936992757). In general, long lived connections exchange a ton of information that can be used to fingerprint a node. The most blatant of those is a customized user-agent string, e.g. `-uacomment=vasilsnode`.\r\n2. onlynet tor+i2p node is more likely to be [Sybiled](https://en.bitcoin.it/wiki/Weaknesses#Sybil_attack).\r\n\r\n> Side question: I see this is opt-in, do we plan to enable this by default\r\n\r\nI do not know about \"we\". I guess making private broadcast default has not been widely discussed and either accepted or rejected. My personal plan is this - once this is released and we see that it works (!) and also the wallet and `submitpackage` RPC do it and that works as well, then yes, I will propose to change the default of `-privatebroadcast` from `0` to `1`. I guess then the question of \"should enable this by default?\" will get widely discussed.\r\n\r\n> if yes did we have intuition theoretically on the impact on the whole network in terms of tx propagation speed?\r\n\r\nGood question. With `-privatebroadcast=0` the transaction originator broadcasts it to everybody and then everybody broadcasts it to everybody, and so on, the transaction floods the network. With `-privatebroadcast=1` the originator will give the transaction to somebody and they will send it to everybody, starting the same flooding process. So, the only difference wrt timing is the initial send via the short lived connection. For the originator this adds a delay of a few seconds. For the network I think it does not matter.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3044285606",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 3046135912,
      "node_id": "IC_kwDOABII5861kFho",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3046135912",
      "actor": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-07T18:21:06Z",
      "updated_at": "2025-07-07T18:21:06Z",
      "author_association": "MEMBER",
      "body": "> Yes, this should be also for submitpackage. The reason I did not implement it is because I want to cut this PR slim to get the private broadcast mechanism in, reduce review load, because it is already big as it is. There is a \"Future extenstions\" section the PR description, added submitpackage there and linked to your comment with the diff.\r\n\r\n1. In that case, this probably shouldnâ€™t be a startup option but rather a runtime option for `sendrawtransaction`, I think.\r\nwhen we have privatebroadcast on all broadcast RPC then it should be implemented as a startup option where the runtime option overrides the startup value.\r\n\r\n2. FWIW, the diff would only allow reliably broadcasting a single tx package privately, but 1p1c package broadcast is problematic due to the current limitation of not adding transactions to the mempool.\r\n\r\n> Sending own transactions over long lived connections is problematic because then two different transactions that are otherwise unrelated, looking at the coins (ie on-chain analysis) could be linked together to the same originator.\r\n\r\nIs it not possible to perform this type of on-chain analysis even with `privatebroadcast`? For example, someone could observe the blockchain and fingerprint transactions as likely coming from a particular node and label it as \"vasilsnode\"? \r\n\r\nHiding the IP address (geolocation) is the most important gain from this imo, what will a tor/i2p peer be able to do after fingerprinting that bunch of transactions are from it's peer?\r\n\r\n> onlynet tor+i2p node is more likely to be [Sybiled](https://en.bitcoin.it/wiki/Weaknesses#Sybil_attack).\r\nlow-latency encryption/anonymization of Bitcoin's transmissions (with Tor, JAP, etc.) can be defeated relatively easily with a timing attack if you're connected to several of the attacker's nodes and the attacker is watching your transmissions at your ISP\r\n\r\nThanks, I wasnâ€™t aware of this before  Iâ€™ll need to ponder more about it.\r\n\r\n> I do not know about \"we\". \r\n\r\nYeah, I meant your plan. Thanks for explaining :)\r\n\r\n> once this is released and we see that it works (!) and also the wallet and submitpackage RPC do it and that works as well, then yes, I will propose to change the default of -privatebroadcast from 0 to 1. I guess then the question of \"should enable this by default?\" will get widely discussed.\r\n\r\nNice plan. Iâ€™ve seen that review burden can be significantly eased when thereâ€™s a major PR that outlines the overall architecture and plan and provide the holistic view of the project, along with smaller sub-PRs that tackle each component individually. Maybe that structure could help in this case (and have all what you mentioned above implemented so that e2e test will be easy)?\r\n\r\n\r\n> For the originator this adds a delay of a few seconds. For the network I think it does not matter.\r\n\r\nGreat, thanks for explaining.\r\n",
      "user": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3046135912",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 3046202153,
      "node_id": "IC_kwDOABII5861kVsp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3046202153",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-07T18:48:43Z",
      "updated_at": "2025-07-07T18:48:43Z",
      "author_association": "CONTRIBUTOR",
      "body": ">>Sending own transactions over long lived connections is problematic because then two different transactions that are otherwise unrelated, looking at the coins (ie on-chain analysis) could be linked together to the same originator.\r\n\r\n>Is it not possible to perform this type of on-chain analysis even with privatebroadcast? For example, someone could observe the blockchain and fingerprint transactions as likely coming from a particular node and label it as \"vasilsnode\"?\r\n\r\nConsider a wallet with 2 unrelated utxos. Spending both individually in separate txs will not link the two txs when observing the blockchain. If the same node was observed to initially broadcast both txs, then they will be linked to the same originator. This is not solved by an onlynet tor or i2p node, but is solved by privatebroadcast.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3046202153",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "referenced",
      "id": 18512453746,
      "node_id": "REFE_lADOABII585-yiT2zwAAAARPbaBy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18512453746",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "fc543f94a9c39723ad4c3f8c295dd370833acff0",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fc543f94a9c39723ad4c3f8c295dd370833acff0",
      "created_at": "2025-07-07T20:37:17Z"
    },
    {
      "event": "commented",
      "id": 3046513244,
      "node_id": "IC_kwDOABII5861lhpc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3046513244",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-07T21:02:32Z",
      "updated_at": "2025-07-07T21:02:32Z",
      "author_association": "MEMBER",
      "body": "@ismaelsadeeq I don't think 1p1c is compatible with this approach at all, unless the connection is intentionally held open long enough for the parent to be fetched from the sending node? Obviously the connection could be held open with additional logic but just pointing this out. A sender-initiated package relay system might be easier to extend (but way out of scope of this PR).",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3046513244",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 18512776047,
      "node_id": "MEE_lADOABII585-yiT2zwAAAARPcotv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18512776047",
      "actor": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-07T21:02:33Z"
    },
    {
      "event": "subscribed",
      "id": 18512776068,
      "node_id": "SE_lADOABII585-yiT2zwAAAARPcouE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18512776068",
      "actor": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-07T21:02:34Z"
    },
    {
      "event": "labeled",
      "id": 18592820536,
      "node_id": "LE_lADOABII585-yiT2zwAAAARUN-04",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18592820536",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-11T19:24:31Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3067277642,
      "node_id": "IC_kwDOABII58620vFK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3067277642",
      "actor": {
        "login": "User087",
        "id": 79201998,
        "node_id": "MDQ6VXNlcjc5MjAxOTk4",
        "avatar_url": "https://avatars.githubusercontent.com/u/79201998?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/User087",
        "html_url": "https://github.com/User087",
        "followers_url": "https://api.github.com/users/User087/followers",
        "following_url": "https://api.github.com/users/User087/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/User087/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/User087/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/User087/subscriptions",
        "organizations_url": "https://api.github.com/users/User087/orgs",
        "repos_url": "https://api.github.com/users/User087/repos",
        "events_url": "https://api.github.com/users/User087/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/User087/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-13T20:12:52Z",
      "updated_at": "2025-07-13T20:12:52Z",
      "author_association": "NONE",
      "body": "To be clear, in what ways does the proposed feature resemble/differ from the [`--tx-proxy` option in monero](https://docs.getmonero.org/interacting/monerod-reference/#tori2p-and-proxies):\r\n\r\n> Send out your local transactions through SOCKS5 proxy (Tor or I2P).\r\n> ...\r\n> This was introduced to make publishing transactions over Tor easier (no need for torsocks) while allowing clearnet for blocks at the same time (while torsocks affected everything).\r\n> ...\r\n> Note that forwarded transactions (those not originating from the connected wallet(s)) will still be relayed over clearnet.\r\n\r\nand [from the guide](https://github.com/monero-project/monero/blob/c540d400712e4eedda2a8e1f0f7d93f3ee213789/docs/ANONYMITY_NETWORKS.md#behavior):\r\n> If _any_ anonymity network is enabled, transactions being broadcast that lack a valid \"context\" (i.e. the transaction did not come from a P2P connection), will only be sent to peers on anonymity networks. If an anonymity network is enabled but no peers over an anonymity network are available, an error is logged and the transaction is kept for future broadcasting over an anonymity network. The transaction will not be broadcast unless an anonymity connection is made or until `monerod` is shutdown and restarted with only public connections enabled.\r\n\r\nWould monero's implementation be useful at all?",
      "user": {
        "login": "User087",
        "id": 79201998,
        "node_id": "MDQ6VXNlcjc5MjAxOTk4",
        "avatar_url": "https://avatars.githubusercontent.com/u/79201998?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/User087",
        "html_url": "https://github.com/User087",
        "followers_url": "https://api.github.com/users/User087/followers",
        "following_url": "https://api.github.com/users/User087/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/User087/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/User087/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/User087/subscriptions",
        "organizations_url": "https://api.github.com/users/User087/orgs",
        "repos_url": "https://api.github.com/users/User087/repos",
        "events_url": "https://api.github.com/users/User087/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/User087/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3067277642",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 3069532178,
      "node_id": "IC_kwDOABII58629VgS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3069532178",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-14T13:00:05Z",
      "updated_at": "2025-07-14T13:00:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "@User087 There are a few differences from the feature you linked. From the same guide, [the very last section](https://github.com/monero-project/monero/blob/master/docs/ANONYMITY_NETWORKS.md#i2ptor-stream-used-twice):\r\n> I2P/Tor Stream Used Twice\r\n`monerod` currently selects two outgoing connections every 5 minutes for transmitting transactions over I2P/Tor.\r\n\r\nThe proposed feature here does not use any existing connections for transmitting transactions. It creates a new connection to a random peer for every transaction that is submitted.\r\n\r\nFrom my understanding, the `--tx-proxy` option also will not relay to clearnet nodes via Tor exit nodes. The proposed feature here will also connect to IPv4 and IPv6 nodes by tunneling through a Tor exit node.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3069532178",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 18617720981,
      "node_id": "MEE_lADOABII585-yiT2zwAAAARVs-CV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18617720981",
      "actor": {
        "login": "User087",
        "id": 79201998,
        "node_id": "MDQ6VXNlcjc5MjAxOTk4",
        "avatar_url": "https://avatars.githubusercontent.com/u/79201998?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/User087",
        "html_url": "https://github.com/User087",
        "followers_url": "https://api.github.com/users/User087/followers",
        "following_url": "https://api.github.com/users/User087/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/User087/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/User087/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/User087/subscriptions",
        "organizations_url": "https://api.github.com/users/User087/orgs",
        "repos_url": "https://api.github.com/users/User087/repos",
        "events_url": "https://api.github.com/users/User087/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/User087/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-14T13:00:07Z"
    },
    {
      "event": "subscribed",
      "id": 18617721006,
      "node_id": "SE_lADOABII585-yiT2zwAAAARVs-Cu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18617721006",
      "actor": {
        "login": "User087",
        "id": 79201998,
        "node_id": "MDQ6VXNlcjc5MjAxOTk4",
        "avatar_url": "https://avatars.githubusercontent.com/u/79201998?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/User087",
        "html_url": "https://github.com/User087",
        "followers_url": "https://api.github.com/users/User087/followers",
        "following_url": "https://api.github.com/users/User087/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/User087/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/User087/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/User087/subscriptions",
        "organizations_url": "https://api.github.com/users/User087/orgs",
        "repos_url": "https://api.github.com/users/User087/repos",
        "events_url": "https://api.github.com/users/User087/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/User087/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-14T13:00:07Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18637369762,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAARW37Gi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18637369762",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "dbd76e68c3fd86814e96be85a2d23eb542df6e55",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/dbd76e68c3fd86814e96be85a2d23eb542df6e55",
      "created_at": "2025-07-15T12:28:36Z"
    },
    {
      "event": "commented",
      "id": 3073424315,
      "node_id": "IC_kwDOABII5863MLu7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3073424315",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-15T12:32:59Z",
      "updated_at": "2025-07-15T12:32:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "`6d697bba16...dbd76e68c3`: rebase due to conflicts\r\n\r\n> runtime option for `sendrawtransaction`\r\n\r\n@ismaelsadeeq, I thought about this, but decided to have a single global option to control the behavior given that the plan is to do private broadcast from other places as well. Otherwise it would be a messy situation where \"my wallet is doing private broadcast but my RPC is not\" or similar.\r\n\r\n> what will a tor/i2p peer be able to do after fingerprinting that bunch of transactions are from it's peer?\r\n\r\nLink them together to the same originator, even if the UTXOs are unrelated.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3073424315",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 18637444610,
      "node_id": "MEE_lADOABII585-yiT2zwAAAARW4NYC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18637444610",
      "actor": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-15T12:33:00Z"
    },
    {
      "event": "subscribed",
      "id": 18637444622,
      "node_id": "SE_lADOABII585-yiT2zwAAAARW4NYO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18637444622",
      "actor": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-15T12:33:00Z"
    },
    {
      "event": "unlabeled",
      "id": 18640222583,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAARXCzl3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18640222583",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-15T14:44:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3086471740,
      "node_id": "IC_kwDOABII586399I8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3086471740",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-18T02:38:44Z",
      "updated_at": "2025-07-18T14:01:06Z",
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK dbd76e68c3fd86814e96be85a2d23eb542df6e55\r\n\r\nChanges from my last ACK cedbc2cd99754c099e92f074e1d5566da265bf26 (`git range-diff 7763e86afa...cedbc2cd99 5d17e64a02...dbd76e68c3`)\r\n\r\n4480ca4a2f - Added a comment\r\nead32f37c8 - `const uint256&` in some places were changed to `const Txid/Wtxid&` and this caused a conflict\r\n7255b28cbb - fixed issue with passing 0 as second parameter to sendrawtransaction\r\n9ec10ceb59 - split up combined `if` statement into two separate statements. Expanded on a comment.\r\nb817c3e45b - updated methods to field access in test due to conflict\r\n\r\nI tested `sendrawtransaction` with `0` as second parameter as well for good measure. It worked correctly.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3086471740",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "review_requested",
      "id": 18691873246,
      "node_id": "RRE_lADOABII585-yiT2zwAAAARaH1ne",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18691873246",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-18T02:38:54Z",
      "requested_reviewer": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "labeled",
      "id": 18707856148,
      "node_id": "LE_lADOABII585-yiT2zwAAAARbEzsU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18707856148",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-18T22:00:13Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "referenced",
      "id": 18915025432,
      "node_id": "REFE_lADOABII585-yiT2zwAAAARnbGIY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18915025432",
      "actor": {
        "login": "DashCoreAutoGuix",
        "id": 156604295,
        "node_id": "U_kgDOCVWXhw",
        "avatar_url": "https://avatars.githubusercontent.com/u/156604295?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DashCoreAutoGuix",
        "html_url": "https://github.com/DashCoreAutoGuix",
        "followers_url": "https://api.github.com/users/DashCoreAutoGuix/followers",
        "following_url": "https://api.github.com/users/DashCoreAutoGuix/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DashCoreAutoGuix/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DashCoreAutoGuix/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DashCoreAutoGuix/subscriptions",
        "organizations_url": "https://api.github.com/users/DashCoreAutoGuix/orgs",
        "repos_url": "https://api.github.com/users/DashCoreAutoGuix/repos",
        "events_url": "https://api.github.com/users/DashCoreAutoGuix/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DashCoreAutoGuix/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "6b53b0b9b3226009f1032aaeaea24a45accee39b",
      "commit_url": "https://api.github.com/repos/DashCoreAutoGuix/dash/commits/6b53b0b9b3226009f1032aaeaea24a45accee39b",
      "created_at": "2025-07-31T09:07:12Z"
    },
    {
      "event": "commented",
      "id": 3164047001,
      "node_id": "IC_kwDOABII5868l4aZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3164047001",
      "actor": {
        "login": "kdmukai",
        "id": 934746,
        "node_id": "MDQ6VXNlcjkzNDc0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/934746?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kdmukai",
        "html_url": "https://github.com/kdmukai",
        "followers_url": "https://api.github.com/users/kdmukai/followers",
        "following_url": "https://api.github.com/users/kdmukai/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kdmukai/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kdmukai/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kdmukai/subscriptions",
        "organizations_url": "https://api.github.com/users/kdmukai/orgs",
        "repos_url": "https://api.github.com/users/kdmukai/repos",
        "events_url": "https://api.github.com/users/kdmukai/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kdmukai/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-07T12:49:09Z",
      "updated_at": "2025-08-07T12:49:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "I successfully completed an end-to-end test:\r\n\r\nI configured the Bitcoin Keeper android wallet (v2.5.1) to connect to my electrs instance (v0.10.10) which in turn connected to bitcoind at dbd76e6 on testnet4.\r\n\r\nA basic transaction created in Keeper was sent through electrs and out to the network via private broadcast without any complaints. No modifications needed in Keeper or electrs.\r\n\r\nAs far as electrs was concerned, nothing was out of the ordinary:\r\n```\r\n[2025-08-07T11:56:21.829Z DEBUG electrs::server] 1: recv {\"jsonrpc\":\"2.0\",\"method\":\"blockchain.transaction.broadcast\",\"params\":[\"0200000000010180e479f995f35081b96d754640b3614795c7e7a2b3487e1364857ee60fe7d1940100000000feffffff0213b50000000000001600148d38a74a217d0b676481bf5201aa6be9f0f0cf3aac0d0000000000001600141faf25fdc3344325ff5433efdc193db70dc199a402483045022100abbdd964305f6aa5e1d460b30ccadf5084d0708d76da4cd508c95ab4a1cb641b0220400b6123c34fbe035b7dd9be44781b484ae7cc635e0e1dab5e2a402fb57ca91d012102c3239d07a327bfd938dceb288d371f70f508a8243fc0861affb2d4c83065b56d8f750100\"],\"id\":44}\r\n[2025-08-07T11:56:21.829Z DEBUG bitcoincore_rpc] JSON-RPC request: sendrawtransaction [\"0200000000010180e479f995f35081b96d754640b3614795c7e7a2b3487e1364857ee60fe7d1940100000000feffffff0213b50000000000001600148d38a74a217d0b676481bf5201aa6be9f0f0cf3aac0d0000000000001600141faf25fdc3344325ff5433efdc193db70dc199a402483045022100abbdd964305f6aa5e1d460b30ccadf5084d0708d76da4cd508c95ab4a1cb641b0220400b6123c34fbe035b7dd9be44781b484ae7cc635e0e1dab5e2a402fb57ca91d012102c3239d07a327bfd938dceb288d371f70f508a8243fc0861affb2d4c83065b56d8f750100\"]\r\n[2025-08-07T11:56:21.831Z DEBUG electrs::server] 1: send {\"id\":44,\"jsonrpc\":\"2.0\",\"result\":\"af2c09c62e9a7e81c0974b8be393b9b3cd606c5246860fecbc10916bff10fbe5\"}\r\n```\r\n\r\nbitcoind logs:\r\n```\r\n2025-08-07T11:56:21Z [privatebroadcast] Requesting 3 new connections due to txid=af2c09c62e9a7e81c0974b8be393b9b3cd606c5246860fecbc10916bff10fbe5, wtxid=fe1fc666af1425bf61ee3155ded9aa301490229f302db232eb99ba9e15c55a85\r\n2025-08-07T11:56:24Z [privatebroadcast] Socket connected to 85.203.53.149:18333 through the proxy at 127.0.0.1:9050; remaining connections to open: 2\r\n2025-08-07T11:56:24Z [privatebroadcast] Failed to connect to [2607:5300:205:200::115b]:48333 through the proxy at 127.0.0.1:9050, will retry to a different address; remaining connections to open: 2\r\n2025-08-07T11:56:24Z [privatebroadcast] Reattempting broadcast of stale txid=af2c09c62e9a7e81c0974b8be393b9b3cd606c5246860fecbc10916bff10fbe5 wtxid=fe1fc666af1425bf61ee3155ded9aa301490229f302db232eb99ba9e15c55a85\r\n2025-08-07T11:56:24Z New private-broadcast v2 peer connected: version: 70016, blocks=95632, peer=14\r\n2025-08-07T11:56:24Z [privatebroadcast:info] P2P handshake completed, sending INV for txid=af2c09c62e9a7e81c0974b8be393b9b3cd606c5246860fecbc10916bff10fbe5, wtxid=fe1fc666af1425bf61ee3155ded9aa301490229f302db232eb99ba9e15c55a85, peer=14\r\n2025-08-07T11:56:24Z [privatebroadcast] Ignoring incoming message 'ping', peer=14\r\n2025-08-07T11:56:24Z [privatebroadcast] Ignoring incoming message 'feefilter', peer=14\r\n2025-08-07T11:56:29Z [privatebroadcast:info] Got a PONG (the transaction will probably reach the network), marking for disconnect, peer=14\r\n2025-08-07T11:56:32Z [privatebroadcast:info] Received our privately broadcast transaction (txid=af2c09c62e9a7e81c0974b8be393b9b3cd606c5246860fecbc10916bff10fbe5) from the network from peer=8; stopping private broadcast attempts\r\n```",
      "user": {
        "login": "kdmukai",
        "id": 934746,
        "node_id": "MDQ6VXNlcjkzNDc0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/934746?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kdmukai",
        "html_url": "https://github.com/kdmukai",
        "followers_url": "https://api.github.com/users/kdmukai/followers",
        "following_url": "https://api.github.com/users/kdmukai/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kdmukai/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kdmukai/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kdmukai/subscriptions",
        "organizations_url": "https://api.github.com/users/kdmukai/orgs",
        "repos_url": "https://api.github.com/users/kdmukai/repos",
        "events_url": "https://api.github.com/users/kdmukai/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kdmukai/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3164047001",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 3172916955,
      "node_id": "IC_kwDOABII5869Ht7b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3172916955",
      "actor": {
        "login": "RandyMcMillan",
        "id": 152159,
        "node_id": "MDQ6VXNlcjE1MjE1OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/152159?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RandyMcMillan",
        "html_url": "https://github.com/RandyMcMillan",
        "followers_url": "https://api.github.com/users/RandyMcMillan/followers",
        "following_url": "https://api.github.com/users/RandyMcMillan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RandyMcMillan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RandyMcMillan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RandyMcMillan/subscriptions",
        "organizations_url": "https://api.github.com/users/RandyMcMillan/orgs",
        "repos_url": "https://api.github.com/users/RandyMcMillan/repos",
        "events_url": "https://api.github.com/users/RandyMcMillan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RandyMcMillan/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-10T21:52:40Z",
      "updated_at": "2025-08-10T21:52:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "RandyMcMillan",
        "id": 152159,
        "node_id": "MDQ6VXNlcjE1MjE1OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/152159?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RandyMcMillan",
        "html_url": "https://github.com/RandyMcMillan",
        "followers_url": "https://api.github.com/users/RandyMcMillan/followers",
        "following_url": "https://api.github.com/users/RandyMcMillan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RandyMcMillan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RandyMcMillan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RandyMcMillan/subscriptions",
        "organizations_url": "https://api.github.com/users/RandyMcMillan/orgs",
        "repos_url": "https://api.github.com/users/RandyMcMillan/repos",
        "events_url": "https://api.github.com/users/RandyMcMillan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RandyMcMillan/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3172916955",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 3184854933,
      "node_id": "IC_kwDOABII58691QeV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3184854933",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-13T17:38:53Z",
      "updated_at": "2025-08-13T17:38:53Z",
      "author_association": "MEMBER",
      "body": "Needs trivial rebase in commit `\"test: move create_malleated_version() to messages.py for reuse\"`\r\n\r\n```diff\r\ndiff --cc test/functional/p2p_orphan_handling.py\r\nindex f2eed48603c,94b911f4b5a..00000000000\r\n--- a/test/functional/p2p_orphan_handling.py\r\n+++ b/test/functional/p2p_orphan_handling.py\r\n  \r\n  from test_framework.messages import (\r\n      CInv,\r\n++<<<<<<< HEAD\r\n +    CTxInWitness,\r\n +    DEFAULT_ANCESTOR_LIMIT,\r\n++=======\r\n++>>>>>>> b817c3e45bd (test: move create_malleated_version() to messages.py for reuse)\r\n      MSG_TX,\r\n      MSG_WITNESS_TX,\r\n```\r\n\r\n(Not a blocker for reviewing further.)",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3184854933",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 3117833369,
      "node_id": "PRR_kwDOABII58651lyZ",
      "url": null,
      "actor": null,
      "commit_id": "dbd76e68c3fd86814e96be85a2d23eb542df6e55",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-08-13T22:08:18Z",
      "author_association": "MEMBER",
      "body": "Reviewed up to and including b9cf8a1ea533291bb6395b0efd104c39, looks good so far.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-3117833369",
      "submitted_at": "2025-08-13T22:07:20Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "review_requested",
      "id": 19146546721,
      "node_id": "RRE_lADOABII585-yiT2zwAAAAR1OR4h",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19146546721",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-13T22:07:34Z",
      "requested_reviewer": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 19438435562,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAASGnvzq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19438435562",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "2bd4714fa9529dd691a6c0a6acbd2fbce7e0d1cf",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/2bd4714fa9529dd691a6c0a6acbd2fbce7e0d1cf",
      "created_at": "2025-09-01T09:40:12Z"
    },
    {
      "event": "commented",
      "id": 3241642016,
      "node_id": "IC_kwDOABII587BN4gg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3241642016",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-01T09:41:07Z",
      "updated_at": "2025-09-01T09:41:07Z",
      "author_association": "CONTRIBUTOR",
      "body": "`dbd76e68c3...2bd4714fa9`: rebase due to conflicts and address https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2274730057\r\n\r\nI am back from some afk time.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3241642016",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 19440535760,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAASGvwjQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19440535760",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-01T11:43:43Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 19477706322,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAASI9jZS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19477706322",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "8fbff5233fe7586ce316fc435dea6d0732462e1c",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/8fbff5233fe7586ce316fc435dea6d0732462e1c",
      "created_at": "2025-09-03T09:12:10Z"
    },
    {
      "event": "commented",
      "id": 3248422237,
      "node_id": "IC_kwDOABII587Bnv1d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3248422237",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-03T09:20:40Z",
      "updated_at": "2025-09-03T09:20:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "`2bd4714fa9...8fbff5233f`: extend the functional test to send two transactions that have the same txid but different wtxid, made possible by https://github.com/bitcoin/bitcoin/pull/32385. Thank you, @stratospher!\r\n\r\nThe functional test has grown quite extensive. It is a further load on reviewers. That is in the last two commits. If you don't feel like reviewing it, you can omit those last two commits and review up to bb814cde2a `rpc: use private broadcast from sendrawtransaction RPC if -privatebroadcast is ON`. In that case I am going to remove the last two commits from here and put them into a separate PR.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3248422237",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 19477862061,
      "node_id": "MEE_lADOABII585-yiT2zwAAAASI-Jat",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19477862061",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-03T09:20:41Z"
    },
    {
      "event": "subscribed",
      "id": 19477862131,
      "node_id": "SE_lADOABII585-yiT2zwAAAASI-Jbz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19477862131",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-03T09:20:42Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 19478045087,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAASI-2Gf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19478045087",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "4327327dd07457621fe1a9c88dfbf6fccb0e8854",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/4327327dd07457621fe1a9c88dfbf6fccb0e8854",
      "created_at": "2025-09-03T09:30:22Z"
    },
    {
      "event": "labeled",
      "id": 19478050301,
      "node_id": "LE_lADOABII585-yiT2zwAAAASI-3X9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19478050301",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-03T09:30:39Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3248461985,
      "node_id": "IC_kwDOABII587Bn5ih",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3248461985",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-03T09:31:23Z",
      "updated_at": "2025-09-03T09:31:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "`8fbff5233f...4327327dd0`: fix python linter `f-string without any placeholders`",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3248461985",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 3248463106,
      "node_id": "IC_kwDOABII587Bn50C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3248463106",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-03T09:31:42Z",
      "updated_at": "2025-09-03T09:31:42Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/runs/49482001469</sub>\n<sub>LLM reason (âœ¨ experimental): (empty)</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3248463106",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 19479774179,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAASJFcPj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19479774179",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-03T11:04:32Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3258611648,
      "node_id": "IC_kwDOABII587COnfA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3258611648",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-05T14:44:49Z",
      "updated_at": "2025-09-05T22:38:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "I tried sending a tx with fee rate 0.1 sat/vbyte using 4327327dd07457621fe1a9c88dfbf6fccb0e8854.\r\n\r\nI connected to 3 nodes and disconnected after receiving the PONG, and then attempted one more connection every 10 minutes.\r\nI finally received the tx back from another peer after 13 hours and 90 connection attempts.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3258611648",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 3194671681,
      "node_id": "PRR_kwDOABII586-atJB",
      "url": null,
      "actor": null,
      "commit_id": "4327327dd07457621fe1a9c88dfbf6fccb0e8854",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-09-08T00:27:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 4327327dd07457621fe1a9c88dfbf6fccb0e8854\r\n\r\nChanges from my last ACK dbd76e68c3fd86814e96be85a2d23eb542df6e55 (`git range-diff 5d17e64a02...dbd76e68c3 7cc9a08706...4327327dd0`):\r\n\r\n- ee75225369: grammar\r\n- ead32f37c8: remove txid conversions to resolve conflict\r\n- 9ec10ceb59: convert `Txid` to `uint256`, update import from `util/transaction_identifier.h` to `primitives/transaction_identifier.h` to resolve conflict\r\n- dbd76e68c3: add functional test for rejecting scheduling private broadcast for a tx which shares a txid with a different already scheduled tx\r\n\r\nAlso ran functional tests locally.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-3194671681",
      "submitted_at": "2025-09-08T00:27:38Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "commented",
      "id": 3265576319,
      "node_id": "IC_kwDOABII587CpL1_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3265576319",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-08T10:10:19Z",
      "updated_at": "2025-09-08T10:13:14Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I tried sending a tx with fee rate 0.1 sat/vbyte\r\n\r\nAdded a note to \"Further extensions\" in PR description (see at the bottom) to consider checking the FEEFILTER message and retrying sooner than 10 minutes if the transaction is below their threshold.\r\n\r\n> I finally received the tx back from another peer after 13 hours and 90 connection attempts.\r\n\r\nI wonder how this compares to the current send-to-all-connected-peers approach. If it took 90 peers to find one to accept the transaction, and if we are connected to less peers, then even sending to all of them could turn out to be futile (edit: note that we will honor FEEFILTER for connected peers). Then we don't actively cycle our connected peers or deliberately try to find a peer that will accept our low fee transaction. So it could be that it takes even more time with the current send-to-all-connected-peers approach?",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3265576319",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 19601053332,
      "node_id": "LE_lADOABII585-yiT2zwAAAASQUFaU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19601053332",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-09T23:59:20Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 19634450997,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAASSTfI1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19634450997",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "created_at": "2025-09-11T11:20:02Z"
    },
    {
      "event": "commented",
      "id": 3280041954,
      "node_id": "IC_kwDOABII587DgXfi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3280041954",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-11T11:20:33Z",
      "updated_at": "2025-09-11T11:20:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "`4327327dd0...3f6a61e3c5`: rebase due to conflicts and take https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2328909174",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3280041954",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 19635785738,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAASSYlAK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19635785738",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-11T12:18:10Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 19747502817,
      "node_id": "LE_lADOABII585-yiT2zwAAAASZCvrh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19747502817",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-17T10:53:29Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 19797430789,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAAScBNIF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19797430789",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "3aa74b517621950b7c987d9c6db1856b4bd70ed1",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/3aa74b517621950b7c987d9c6db1856b4bd70ed1",
      "created_at": "2025-09-19T11:23:40Z"
    },
    {
      "event": "commented",
      "id": 3311820597,
      "node_id": "IC_kwDOABII587FZl81",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3311820597",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-19T11:23:41Z",
      "updated_at": "2025-09-19T11:23:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "`3f6a61e3c5...3aa74b5176`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3311820597",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 19799022574,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAAScHRvu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19799022574",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-19T12:56:20Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3312099790,
      "node_id": "IC_kwDOABII587FaqHO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3312099790",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-19T12:57:09Z",
      "updated_at": "2025-09-19T12:57:09Z",
      "author_association": "MEMBER",
      "body": "> if we take the last commit: fixup\r\n\r\nI feel like this is going to be taken, no? Especially as we think ahead with relay (say, 1p1pc packages), seems necessary to do the INV/getdata cycle.",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3312099790",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 3312186763,
      "node_id": "IC_kwDOABII587Fa_WL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3312186763",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-19T13:22:29Z",
      "updated_at": "2025-09-19T13:22:29Z",
      "author_association": "CONTRIBUTOR",
      "body": "@instagibbs, yes, this was already taken some time ago and squashed into the relevant commit: https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2795829514",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3312186763",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 19799530039,
      "node_id": "MEE_lADOABII585-yiT2zwAAAAScJNo3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19799530039",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-19T13:22:31Z"
    },
    {
      "event": "subscribed",
      "id": 19799530076,
      "node_id": "SE_lADOABII585-yiT2zwAAAAScJNpc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19799530076",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-19T13:22:31Z"
    },
    {
      "event": "commented",
      "id": 3315093703,
      "node_id": "IC_kwDOABII587FmFDH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3315093703",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-20T16:37:42Z",
      "updated_at": "2025-09-20T16:37:42Z",
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 3aa74b517621950b7c987d9c6db1856b4bd70ed1\r\n\r\nTrivial changes since my last ACK (`git range-diff 7cc9a08706...4327327dd0 edb871cba2...3aa74b5176`).",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3315093703",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 3319219472,
      "node_id": "IC_kwDOABII587F10UQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3319219472",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-22T14:00:04Z",
      "updated_at": "2025-09-22T14:00:04Z",
      "author_association": "CONTRIBUTOR",
      "body": "I extracted one commit from here into https://github.com/bitcoin/bitcoin/pull/33454 with the aim to reduce the size of this PR once #33454 is merged.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3319219472",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 20021636941,
      "node_id": "LE_lADOABII585-yiT2zwAAAASpYe9N",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20021636941",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-30T23:53:44Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20035903838,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAASqO6Fe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20035903838",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "22fadecc140bd009a42c69a128d0484c0d734dcd",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/22fadecc140bd009a42c69a128d0484c0d734dcd",
      "created_at": "2025-10-01T14:24:53Z"
    },
    {
      "event": "commented",
      "id": 3356612313,
      "node_id": "IC_kwDOABII587IEdbZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3356612313",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-01T14:25:43Z",
      "updated_at": "2025-10-01T14:25:43Z",
      "author_association": "CONTRIBUTOR",
      "body": "`3aa74b5176...22fadecc14`: rebase due to conflicts and pick changes from https://github.com/bitcoin/bitcoin/pull/33454",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3356612313",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 20037072287,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAASqTXWf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20037072287",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-01T15:06:16Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20038251180,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAASqX3Ks",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20038251180",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b01d6df464e495ff323adaf9178ad55facce3478",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/b01d6df464e495ff323adaf9178ad55facce3478",
      "created_at": "2025-10-01T15:57:02Z"
    },
    {
      "event": "commented",
      "id": 3357077663,
      "node_id": "IC_kwDOABII587IGPCf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3357077663",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-01T15:57:22Z",
      "updated_at": "2025-10-01T15:57:22Z",
      "author_association": "CONTRIBUTOR",
      "body": "`22fadecc14...b01d6df464`: resolve silent merge conflict / fix CI",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3357077663",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 20044754078,
      "node_id": "LE_lADOABII585-yiT2zwAAAASqwqye",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20044754078",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-01T21:47:12Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20055822422,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAASra5BW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20055822422",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "21efe8fa8207b72c8953572b5b009394bbe580a6",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/21efe8fa8207b72c8953572b5b009394bbe580a6",
      "created_at": "2025-10-02T10:05:34Z"
    },
    {
      "event": "commented",
      "id": 3360280902,
      "node_id": "IC_kwDOABII587ISdFG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3360280902",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-02T10:05:51Z",
      "updated_at": "2025-10-02T10:05:51Z",
      "author_association": "CONTRIBUTOR",
      "body": "`b01d6df464...21efe8fa82`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3360280902",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 20056332291,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAASrc1gD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20056332291",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-02T10:31:22Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "referenced",
      "id": 20120794186,
      "node_id": "REFE_lADOABII585-yiT2zwAAAASvSvRK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20120794186",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "452ea59281121faeca33aa208b01f7bbd8323e7c",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/452ea59281121faeca33aa208b01f7bbd8323e7c",
      "created_at": "2025-10-06T16:43:44Z"
    },
    {
      "event": "labeled",
      "id": 20122538237,
      "node_id": "LE_lADOABII585-yiT2zwAAAASvZZD9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20122538237",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-06T18:03:23Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20135616450,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAASwLR_C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20135616450",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "7d837fef28bd12680c65a153884e910fa3f420c6",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/7d837fef28bd12680c65a153884e910fa3f420c6",
      "created_at": "2025-10-07T08:52:25Z"
    },
    {
      "event": "commented",
      "id": 3375858344,
      "node_id": "IC_kwDOABII587JN4Ko",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3375858344",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-07T08:53:50Z",
      "updated_at": "2025-10-07T08:53:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "`21efe8fa82...7d837fef28`: rebase due to conflicts; remove changes that were already merged via https://github.com/bitcoin/bitcoin/pull/33454",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3375858344",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 20138143971,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAASwU7Dj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20138143971",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-07T10:58:44Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20143515826,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAASwpaiy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20143515826",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "a9d697c0e19cdd1d6e6da145d7d19ef593ebe989",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/a9d697c0e19cdd1d6e6da145d7d19ef593ebe989",
      "created_at": "2025-10-07T15:15:06Z"
    },
    {
      "event": "commented",
      "id": 3377395591,
      "node_id": "IC_kwDOABII587JTveH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3377395591",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-07T15:16:27Z",
      "updated_at": "2025-10-07T15:16:27Z",
      "author_association": "CONTRIBUTOR",
      "body": "`7d837fef28...a9d697c0e1`: minor changes to facilitate chopping off two pieces of this into smaller independent PRs:\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/33565\r\nhttps://github.com/bitcoin/bitcoin/pull/33567",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3377395591",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 3335207073,
      "node_id": "PRR_kwDOABII587Gyzih",
      "url": null,
      "actor": null,
      "commit_id": "a9d697c0e19cdd1d6e6da145d7d19ef593ebe989",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-10-14T11:55:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nTested consecutively for 5 days on Signet,\r\n<details>\r\n<summary> my data from those 5 days</summary>\r\n\r\n- Day 1\r\n  Time to hear back: 11 seconds\r\n  Connections: 3 attempted, 3 successful\r\n\r\n- Day 2\r\n  Time to hear back: 72 seconds (1 min 12 sec)\r\n  Connections: 3 attempted, 1 successful\r\n\r\n- Day 3\r\n  Time to hear back: 14 seconds\r\n  Connections: 3 attempted, 3 successful\r\n\r\n- Day 4\r\n  Time to hear back: 15 seconds\r\n  Connections: 3 attempted, 1 successful \r\n\r\n- Day 5\r\n  Time to hear back: 15 seconds\r\n  Connections: 3 attempted, 3 successful\r\n\r\n</details>\r\n\r\n\r\nI got an intermittent SOCKS5 error while running tests\r\n```\r\n2025-10-08T11:54:47.008390Z TestFramework (INFO):   - siblings' parent added to the mempool\r\n2025-10-08T11:54:47.011980Z TestFramework (INFO):   - sent sibling1: ok\r\n2025-10-08T11:54:47.019053Z TestFramework (INFO):   - sibling2 rejected because it has the same txid: ok\r\n2025-10-08T11:54:47.019536Z TestFramework (INFO): Trying to send a transaction when none of Tor or I2P is reachable\r\n2025-10-08T11:54:47.023692Z TestFramework.socks5 (ERROR): socks5 request handling failed.\r\nTraceback (most recent call last):\r\n File \"/home/ubuntu/Projects/bitcoin/test/functional/test_framework/socks5.py\", line 139, in handle\r\n   ver = recvall(self.conn, 1)[0]\r\n         ^^^^^^^^^^^^^^^^^^^^^\r\n File \"/home/ubuntu/Projects/bitcoin/test/functional/test_framework/socks5.py\", line 33, in recvall\r\n   d = s.recv(n)\r\n       ^^^^^^^^^\r\nConnectionResetError: [Errno 104] Connection reset by peer\r\n2025-10-08T11:54:47.489806Z TestFramework (INFO): Stopping nodes\r\n2025-10-08T11:54:47.597776Z TestFramework (INFO): Cleaning up /tmp/bitcoin_func_test_6jjqtl1l on exit\r\n2025-10-08T11:54:47.598040Z TestFramework (INFO): Tests successful\r\n```",
      "user": {
        "login": "naiyoma",
        "id": 40592031,
        "node_id": "MDQ6VXNlcjQwNTkyMDMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/40592031?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naiyoma",
        "html_url": "https://github.com/naiyoma",
        "followers_url": "https://api.github.com/users/naiyoma/followers",
        "following_url": "https://api.github.com/users/naiyoma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naiyoma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naiyoma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naiyoma/subscriptions",
        "organizations_url": "https://api.github.com/users/naiyoma/orgs",
        "repos_url": "https://api.github.com/users/naiyoma/repos",
        "events_url": "https://api.github.com/users/naiyoma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naiyoma/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-3335207073",
      "submitted_at": "2025-10-14T11:55:44Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "commented",
      "id": 3427086681,
      "node_id": "IC_kwDOABII587MRTFZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3427086681",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-21T14:48:12Z",
      "updated_at": "2025-10-23T14:41:21Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK as per https://github.com/bitcoin/bitcoin/pull/27509#issuecomment-1523087063\r\n\r\nNot sure the internal implementation around `BroadcastTransaction()` fully makes sense -- I could see `BroadcastTransaction()` having the knowledge of how transactions should be broadcast being better than having every caller of it specify it. If that means we need to prioritise fixing #11887 so that we can do this for wallet transactions straight away, that doesn't seem like a bad thing (EDIT: see #33671 as a first pass). Not doing this for wallet txs seems like a big miss anyway?\r\n\r\nIt may make sense to be able to override the default policy -- eg so submitrawtransaction can go straight to the mempool and relay, even if txs are normally privately relayed; but I think the default logic and parameter lookups should be centralised.\r\n\r\nAs far as the protocol goes, it may make sense to wait a little longer to allow for `GETDATA <parent txid>` 1p1c relay, including in the case where you're not sending a package, but cpfp'ing something that was already in the mempool.\r\n\r\n> Consider periodically sending transactions that did not originate from the node as decoy, discussed https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035414972.\r\n\r\nIt might be good to align the behaviour of feeler connections made over private networks with the private relay logic. ie, rather than introducing a new connection type, overload feeler connections as follows:\r\n\r\n * if the feeler connection is over a public network, no change\r\n * otherwise:\r\n   * continue to do normal feeler logic\r\n   * if there are private txs due to be broadcast, pick a private tx. otherwise, pick a recent tx.\r\n   * send an INV, wait for a GETDATA, send a PING, wait for a PONG. if there were parent txs in the mempool or parent txs in the private pool. once it's been 30s since the last message, disconnect.\r\n * make private network feeler connections more frequently when there are private txs queued to send\r\n * restrict feeler connection messages in a similar way to how this PR restricts private broadcast connections\r\n\r\nMoving private_broadcast storage into the mempool rather than in peermanager would probably make sense in that case.",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3427086681",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 20639504263,
      "node_id": "LE_lADOABII585-yiT2zwAAAATONdeH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20639504263",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-31T17:20:22Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "referenced",
      "id": 20641352201,
      "node_id": "REFE_lADOABII585-yiT2zwAAAATOUgoJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20641352201",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "25c45bb0d0bd6618ec9296a1a43605657124e5de",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/25c45bb0d0bd6618ec9296a1a43605657124e5de",
      "created_at": "2025-10-31T19:00:29Z"
    },
    {
      "event": "labeled",
      "id": 20641655995,
      "node_id": "LE_lADOABII585-yiT2zwAAAATOVqy7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20641655995",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-31T19:17:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20682653685,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAATQyD_1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20682653685",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "c6f46943d1346271d5959be8356d638e5e4423dc",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/c6f46943d1346271d5959be8356d638e5e4423dc",
      "created_at": "2025-11-03T19:00:01Z"
    },
    {
      "event": "commented",
      "id": 3482056374,
      "node_id": "IC_kwDOABII587Pi_a2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3482056374",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-03T19:02:02Z",
      "updated_at": "2025-11-03T19:02:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "`a9d697c0e1...c6f46943d1`: rebase due to conflicts, https://github.com/bitcoin/bitcoin/pull/33567 was merged so removed that change from here. Thanks!",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3482056374",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 20683190517,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAATQ0HD1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20683190517",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-03T19:27:04Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3482304222,
      "node_id": "IC_kwDOABII587Pj77e",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3482304222",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-03T19:58:34Z",
      "updated_at": "2025-11-03T20:02:22Z",
      "author_association": "CONTRIBUTOR",
      "body": "> It might be good to align the behaviour of feeler connections made over private networks with the private relay logic. ie, rather than introducing a new connection type, overload feeler connections as follows:\r\n\r\nThere are downsides to this:\r\n- feeler connections are made to random entries from the new table of addrman (which could be flooded with fake spam addrs, making most of the connection attempts fail). Private broadcast txns are chosen like normal connections, with 50% new/tried chance. I think we really want this 50% tried chance to improve chances of finding a peer that is online - even in the event of addr spam.\r\n- Combining private broadcast with anything else that changes internal state makes it less private. Successful feeler connections will move an address from new to tried in addrman. If we would leak that information somehow (which we probably don't at the moment, but might in future through unrelated changes to addr relay), we could also leak information about the origin of the private transaction.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3482304222",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 3486069744,
      "node_id": "IC_kwDOABII587PyTPw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3486069744",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-04T13:42:31Z",
      "updated_at": "2025-11-04T13:42:31Z",
      "author_association": "CONTRIBUTOR",
      "body": "@ajtowns, thanks for looking into this. Some replies inline:\r\n\r\n> Not sure the internal implementation around `BroadcastTransaction()` fully makes sense -- I could see `BroadcastTransaction()` having the knowledge of how transactions should be broadcast being better than having every caller of it specify it.\r\n\r\nIn `master` it is the latter - callers of `BroadcastTransaction()` tell it whether to broadcast and/or put in the mempool. I guess this can be changed, at least for the private broadcast vs broadcast to all case. Then `BroadcastTransaction()` would have to query the value of the `-privatebroadcast=` config parameter and take action accordingly. However this would be inflexible. For example if we want to temporarily override the global config, maybe by introducing an extra parameter to `sendrawtransaction` RPC, then `BroadcastTransaction()` would have no way to know the value of that parameter. It seems better to me to have the callers tell the function how to broadcast, like in `master` and in this PR. So I will leave it as it is.\r\n\r\n> If that means we need to prioritise fixing https://github.com/bitcoin/bitcoin/issues/11887 so that we can do this for wallet transactions straight away, that doesn't seem like a bad thing (EDIT: see https://github.com/bitcoin/bitcoin/pull/33671 as a first pass).\r\n\r\nI would like to not tie this PR with changes to the wallet.\r\n\r\n> Not doing this for wallet txs seems like a big miss anyway?\r\n\r\nIMO having the wallet to account for non-mempool transactions would be nice to have and to have it soon would be even better. But even if that is available today I would implement private broadcast from the wallet in a subsequent PR instead of in this one. This one is already big enough and review is scarce. Seems like a good approach, as a first step (this PR) to introduce a mechanism to do the private broadcast and one user of it (RPC). Then add other users of it (wallet) in a different PR.\r\n\r\n> It may make sense to be able to override the default policy -- eg so submitrawtransaction can go straight to the mempool and relay, even if txs are normally privately relayed\r\n\r\nRight. Added to the \"Further extensions\" section in the PR description.\r\n\r\n> it may make sense to wait a little longer to allow for `GETDATA <parent txid>` 1p1c relay, including in the case where you're not sending a package, but cpfp'ing something that was already in the mempool\r\n\r\nHmm, right now it will wait 3 minutes (`PRIVATE_BROADCAST_MAX_CONNECTION_LIFETIME`). That is the entire connection lifetime, but the initial messages exchange takes seconds if not less. So, in practice we will wait for `GETDATA` a few seconds less than 3 minutes. Seems enough, no?\r\n\r\n> It might be good to align the behaviour of feeler connections made over private networks with the private relay logic. ie, rather than introducing a new connection type, overload feeler connections as follows:\r\n\r\nIt is better to keep private broadcast connections completely separate than the other connections and not use one such connection for anything else than sending one transaction. Otherwise it is too easy to unintentionally make some privacy leaks, like @mzumsande pointed above.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3486069744",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "mentioned",
      "id": 20703241065,
      "node_id": "MEE_lADOABII585-yiT2zwAAAATSAmNp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20703241065",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-04T13:42:33Z"
    },
    {
      "event": "subscribed",
      "id": 20703241130,
      "node_id": "SE_lADOABII585-yiT2zwAAAATSAmOq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20703241130",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-04T13:42:33Z"
    },
    {
      "event": "mentioned",
      "id": 20703241166,
      "node_id": "MEE_lADOABII585-yiT2zwAAAATSAmPO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20703241166",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-04T13:42:33Z"
    },
    {
      "event": "subscribed",
      "id": 20703241197,
      "node_id": "SE_lADOABII585-yiT2zwAAAATSAmPt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20703241197",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-04T13:42:33Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20708592365,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAATSVArt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20708592365",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "ada059e714d66fede8b1323aec890f7da8589e7e",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/ada059e714d66fede8b1323aec890f7da8589e7e",
      "created_at": "2025-11-04T17:06:39Z"
    },
    {
      "event": "commented",
      "id": 3487100711,
      "node_id": "IC_kwDOABII587P2O8n",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3487100711",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-04T17:06:58Z",
      "updated_at": "2025-11-04T17:06:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "`c6f46943d1...ada059e714`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3487100711",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 3420985495,
      "node_id": "PRR_kwDOABII587L6BiX",
      "url": null,
      "actor": null,
      "commit_id": "ada059e714d66fede8b1323aec890f7da8589e7e",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-05T10:01:07Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-3420985495",
      "submitted_at": "2025-11-05T10:01:07Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "commented",
      "id": 3491839226,
      "node_id": "IC_kwDOABII587QITz6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3491839226",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-05T15:18:53Z",
      "updated_at": "2025-11-05T15:18:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "Extracted two more commits into separate smaller PRs for easier review:\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/33792\r\nhttps://github.com/bitcoin/bitcoin/pull/33793",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3491839226",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "reviewed",
      "id": 3431175370,
      "node_id": "PRR_kwDOABII587Mg5TK",
      "url": null,
      "actor": null,
      "commit_id": "ada059e714d66fede8b1323aec890f7da8589e7e",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-07T01:15:46Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-3431175370",
      "submitted_at": "2025-11-07T01:15:46Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20784476263,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAATW2fBn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20784476263",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "e5e16de7b5d7970e8313a8e3a8c031cb9cd17b59",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/e5e16de7b5d7970e8313a8e3a8c031cb9cd17b59",
      "created_at": "2025-11-07T11:05:22Z"
    },
    {
      "event": "commented",
      "id": 3501908260,
      "node_id": "IC_kwDOABII587QuuEk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3501908260",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-07T11:05:55Z",
      "updated_at": "2025-11-07T11:05:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "`ada059e714...e5e16de7b5`: do https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2501363004 and https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2493783865",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3501908260",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "referenced",
      "id": 20784745178,
      "node_id": "REFE_lADOABII585-yiT2zwAAAATW3gra",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20784745178",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "4b12beedaef5740cf0553e6fed88d70ffb1b9a4c",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4b12beedaef5740cf0553e6fed88d70ffb1b9a4c",
      "created_at": "2025-11-07T11:17:41Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBjZjcxZDE2ZjY0NDk5ZDNkYzM1M2I4Y2I0NzAzODA3ODA4ZDk2MDc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0cf71d16f64499d3dc353b8cb4703807808d9607",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0cf71d16f64499d3dc353b8cb4703807808d9607",
      "tree": {
        "sha": "e96fd8a53eb2ef252dfa585ec5abf956acd67019",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e96fd8a53eb2ef252dfa585ec5abf956acd67019"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree e96fd8a53eb2ef252dfa585ec5abf956acd67019\nparent 4b12beedaef5740cf0553e6fed88d70ffb1b9a4c\nauthor Vasil Dimov <vd@FreeBSD.org> 1702556461 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1762515514 +0100\n\nlog: introduce a new category for private broadcast\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmkN2jsACgkQVN8G9ktV\ny79tpB//YK0Zwqu3ijYFKOle9AwdY6f6O5oKWEiDqK8ndBbwhpsRPp+ZNoLnM94R\nIxxgt2P6GGpIjURA09plreA7EHh9QMv/Hfx0a1rRwFkm5uARl8OOx5yO+28t1vFA\nsGrBzZgoHAlYfkU5CG8/7qqOlaLcReTVt6bxkbxdhyVqWySVJLSp3e2d2aglwbJ+\nFoCG62PA+aZ9ZQdry/qmgEVaj1GzqWJkEQg+2uwe+RdmfuqA7JdXbkyT8UyTkxud\nd0hvIQEfWh4LRgeoLSObxr7+UqW63/x4UDvyhZ68sJdrZ5haO5UUxuQiZ+RlLztb\n0/7/zFD1rAehiDJvQOAwGSLy0/5mljS7MPMVmaz3CXMfUIjOaKG6tnh8StirMeLp\nk1P8knq049YzEQ1DKfNkBQiq+oVnrD8cZkhbP/HLzm9n1AGAk7h4C7/G5ovpzM6i\nPlGC4kLOuB54gVItNv1SD1hzi4dCDJY/jwHx871BZnJTrI1/4Ax3Tbu21G9z1LjE\n70MUJY2ovDkaRboHja3xi33JHqUZve8ty2DBAx7trjiGO5ZG6/ssXgO4HwAUq6TN\n02IbHFoMdWxs9BN6MYW18UYdiY761WrnRCidE/M+2DBjHihQi+0CjZ2KMajR0DHS\nGPHGRZWs9bxXHnA+h5tgxP9c34CcAOMWSnCbazhM3lCw6Np8EvuTKfHUHxgrMOF8\nrPSBsc4DvGi4A9gPibdw0fVHA6aeUZ+QWq0KMbLjfFbbwHX6dIX0BllzS/0YeRhM\nFDHnVII5tEqyr/TMy50eQvT93oPnhjhX8mS6gZWYEpSvPVto4TZsJjRPkJ2yZ5yR\nrYXgx3P74EW5v+03JzTuh3MdzeuvdL/8/mOgWmo7SGkF0nrIOv77TH/uxCisR7OB\n4KWamAoqbhmn5+aCrP2LtZWy0juYiIz7fLZqknkIvqzMhNuEqMEClZVKc7lR6W2z\nBYF1SkTOa9tdNKD6HH09r30OfcH7JfBH1wE99FhTZR1RCp5Q0YQJf+ndK3bI6Q7Q\nwZ+JC6Xl1HNE+rJX8HZeaFPf5QjCUskh01Mg/65PvvVdk32hhhOmhmpW/BRbHYER\n1Dzh44anBLWXMExjTdS0VIdGMG2fmpPktNnHYC5Rzu9xRHhXsmLQNBW/Ibx37Rj+\nW2bQMgRdLP4Zbv3VgA8y4Ctt0VyecKHjyFc50JBmoLRb81JiCUxDWFSlZAI3gGNW\nwPhb7VXRrEXjUBQXw7ea9s2mCHA1yT2gTRzX+U3CIQe3tqWaa4dU6/xRcNQMz+qx\nbATZNR6SrpLBGN2JrFMFWGegW3kTW6ep2hN5rOEGyl4di973mGSLpJubuMz27+Zy\nFFEFfzTzOeiLN6P+ewCdiEH5Dx0sxw==\n=10hv\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4b12beedaef5740cf0553e6fed88d70ffb1b9a4c",
          "sha": "4b12beedaef5740cf0553e6fed88d70ffb1b9a4c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4b12beedaef5740cf0553e6fed88d70ffb1b9a4c"
        }
      ],
      "message": "log: introduce a new category for private broadcast",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-11-07T11:38:34Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-12-14T12:21:01Z"
      },
      "sha": "0cf71d16f64499d3dc353b8cb4703807808d9607"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGMwYTVhOTU0N2M0NTA5ZDAwZGE5ZGQ4ZWIyMTY2MTYxZmJhYzJmMjI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c0a5a9547c4509d00da9dd8eb2166161fbac2f22",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c0a5a9547c4509d00da9dd8eb2166161fbac2f22",
      "tree": {
        "sha": "fda6741f9f203a4cc138712c93ea694ac5547827",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fda6741f9f203a4cc138712c93ea694ac5547827"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree fda6741f9f203a4cc138712c93ea694ac5547827\nparent 0cf71d16f64499d3dc353b8cb4703807808d9607\nauthor Vasil Dimov <vd@FreeBSD.org> 1702559465 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1762515515 +0100\n\ninit: introduce a new option to enable/disable private broadcast\n\nCo-authored-by: brunoerg <brunoely.gc@gmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmkN2jwACgkQVN8G9ktV\ny7+RaCAAqXV73j5NUPngZxWE1goObDgd8XMuJxa2K/mwBoNzTRohbMM5lqQ67Soa\nPMZ400V5uL34GNQXJ3Sw7jeDDyXT+x8cOwJxVEZ9BxqPR89IH95XkPReiOERXxQH\nf5I3BwdrAKJ45O35/hvIZCu9N3aTJBXngtRMvyJ51qzF7AjDlEsYfMqUgRium06B\nvwrxtHSt/S/coDNDsFm0JnVaa/5CAnVLPlvzGTm8QLCVFCXg3mLCM8Oh5T68Aubr\n2WKJsb310gmuVQ3W+McjWdYbJJPkSs8VCsP0n6GRtpIxHSZTW5dcKNYN27omb7gb\nwZP4fTlGG+i1nJB7vbQ3vik8JrLS0vtRfAmE8BCZub/2sNc7V1uYfdCveFQlx1Tn\nAQigiWzyPvfNqHPeYaaAs/z8tRRYfG9ONAlcSjwHwO2gyA6gkSVKbMJw688ZsSNB\nrlnMeMTb2oj1zqKaqXRg3RCFIGnET2o0h3i5YA3vT3QdHW//o8BSxGHZ4u2z0Lax\nNuOcyJz3L7uqU0I4opoEf8w7gPbFdZaMES0GUmGt5XtoLWWSuNcsJ4rvoeyaulbL\nkiFHwIXmEdcNN7Ka8f4hnO284v/UWxuQmxyvPD7pQZZdiKJ6ZmsiAFkFcYNAcd5R\nsP33cpwjEantnmMlEMYTF38TDDluhgI7v0Ujb6mDmvYQ8qo4indcuIhU9UGle9xT\nEURqEFdeLAnEBK247RH4FdPCFZ/s5S2Cz+2vKg8Gt5FstWq/HTZ/ZSRLu4D5Dbrm\nsoqyMpXgurwQaHtGh/C641gsvFeZwNiOQHwX6lJkaHfY9QG/0t3yDXOSJ226fG9W\nOCO4rxsSYg/fvKyjHPhcJQRBxYNNKULn3jzHtC0vLnnVkAtsyKtgcWYO3LnPTAkm\njCYzKofo87S2akHZkRZL+fXJQAyTwykfvnOk8y5ZG3x+GnS/YR8328cIr2Mx2szY\nKnIkg2WpfI3kLmZ/mKlLVeLf5peEFpXjY6XmPFkajVVsCOEednLp/z0b8Ol/S0+x\ngErLH401mxm/9Uy3BQVn7GbZFoR0JQAEhofsZg9fp7z9rg/C9QFLUlepyn9o0VVQ\nWn68T4xgixa8Tn1LaZ97Br/ZXrNULAGuWH5GsHSzINIWn6dHANfFBvjGdrUZ33JD\nSpMLMgZfSHwHi9BJMxAFVKrSQOUmHyjuLEZJqUDUoOweJ3O34uV/KL7otTJJAVJj\nlV2f9olPpKeddrEU/NyOidTGOJbO/b5fMRUUGL9A9jrIQI7ix5sU57y/TFvnr0Ng\nu9zLjuqz/4Scy8OvriN/B7722RaeXQrz3vbGvyCNaCQF4MuOKPE+WzDs+hfomBwh\nKPxrMaLeVT0r2fZu540f2tVt4TJWsg==\n=NPxH\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0cf71d16f64499d3dc353b8cb4703807808d9607",
          "sha": "0cf71d16f64499d3dc353b8cb4703807808d9607",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0cf71d16f64499d3dc353b8cb4703807808d9607"
        }
      ],
      "message": "init: introduce a new option to enable/disable private broadcast\n\nCo-authored-by: brunoerg <brunoely.gc@gmail.com>",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-11-07T11:38:35Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-12-14T13:11:05Z"
      },
      "sha": "c0a5a9547c4509d00da9dd8eb2166161fbac2f22"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDA3ZGUzNzhlZDJhZTVkMmM1YWIxNThlZDBjODc2ODgyY2I3NjBjZGY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/07de378ed2ae5d2c5ab158ed0c876882cb760cdf",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/07de378ed2ae5d2c5ab158ed0c876882cb760cdf",
      "tree": {
        "sha": "87ee3d22529ee7b3e6868e4ff6904349b9db641d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/87ee3d22529ee7b3e6868e4ff6904349b9db641d"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 87ee3d22529ee7b3e6868e4ff6904349b9db641d\nparent c0a5a9547c4509d00da9dd8eb2166161fbac2f22\nauthor Vasil Dimov <vd@FreeBSD.org> 1702560848 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1762515516 +0100\n\nnet: introduce a new connection type for private broadcast\n\nWe will open a short-lived connection to a random Tor or I2P peer,\nsend our transaction to that peer and close the connection.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmkN2j0ACgkQVN8G9ktV\ny7+zoh/7BKYhmrGned9C3onkBhXIA05qfw5sovTbZ+anufnD+L8b6Ij7nBqElOyg\nquPyIrj/IazDQxWZJ+YapLvr5l/2PcjAGkheD0O2OT1fgS195kU+2iVH4cVYqetB\nwFb43hOBuMZvi3M6dKEpvsg5uzOazi5aYIBwudOiL8uUELsSQ0PCJKzEtJS4gxI1\nxpVyPZpwSpvTBGjAQWotosMShnm/TzY41x58H3WBsgnXw2MuCRlbE1BRMx30PBdj\nYavJ/qGuk/jt89pawL9XZ6rmS9OhVZb+8H6uVAHgA5oOZ5ikZQZ+l4HvEsDtUzJ/\nd+L53U582UXdJE0fDM904uP2RkVwBwyejf5fpxXjvSJyct4sJ7c5koRsE9akTJcq\n0et8Ep6mcDrYcW2KzxnVAUeAkS3I9kHqyNeFAE6B2bf7W1jAnXcX+WqCZVVQ2xWm\nUoAkJaPD4kWvg9ykVEZgyxNft3sJHu90cjP0T6Fq/26dRAP7OHVIpDHvePJ5OMKc\nyMGTpO75kNpVRhfqYhSBPDB0ORhYXG1Po0eV5t5LctAgLXjy+tXabOgJZYpwSGjD\nSj4mQBbu5u3OM0ViFDu4brMngIQGLm0G7yMDyZmnFHOSUtia51gTH6ftfOkJWZjO\nTEtiy7b470GM8Y06PVv3qZWHLll4bXW3tlsCGoaQ+DNvlbl9R+mLE4GeIKaRcbQC\nnbpDRlO2i9R+lYy7yDEj/hicozKXNOOE9giaONbfGRLJu5aqHn67bNG/YY2GD359\nfusA+FlKBGUqx1gtaJE/SrOR74YzebWTlYIGrVFuSzLZ0iFuYaJ+PayLW9Ocn1z5\nrxRFqZtG3Li+AR6JnJX0ovaM2aNMe38Trv8Ui+o4aXXBH56NvM/zsg9NHTZAm874\nMcc6E8ns1AdGNDvqDVUq+mNSvvOvCoLm9yywOFPbD6a9SmeOo2mzlIB3jYva/yXU\nIbvRC7gUXGXRUtvjI7myiBGVvLTxuhbVbzwXtbmLPzaJxi224lbTeECYmUu2gMRa\nOfqpM8Q+AGW2KoCfcc6c18ah8+SNKuc3Kijr179/IHRGdxPwk+eP3fOJOumnzkj1\n3D8BNqn/uSGH6LdsJE6FHsNPzqeEpVfvmM6t+NdKY3zStZ+o1Pq+iXNeIG59/dqr\npM5lHdipRUywsUuADdJ57qbkxRM0HAPoiuLtV02XUoPdRf2/e/XPCzB3KLNPFPaT\n7lZY926bjE8r/ul33L2kS4FFaUQAk2MgFGgzabFZ3UuIZI/xBJe4pnv2ZWR5IuQo\n+5mdtMgmdFXvjFHNP1JItP62eibvluPKYOMNeFATj4koaua3v7+PKPZtCM8mGx+P\nrOGKr1mJ3dqtHjbqQ17XvFSmcRJGBg==\n=Mt5d\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c0a5a9547c4509d00da9dd8eb2166161fbac2f22",
          "sha": "c0a5a9547c4509d00da9dd8eb2166161fbac2f22",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c0a5a9547c4509d00da9dd8eb2166161fbac2f22"
        }
      ],
      "message": "net: introduce a new connection type for private broadcast\n\nWe will open a short-lived connection to a random Tor or I2P peer,\nsend our transaction to that peer and close the connection.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-11-07T11:38:36Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-12-14T13:34:08Z"
      },
      "sha": "07de378ed2ae5d2c5ab158ed0c876882cb760cdf"
    },
    {
      "event": "labeled",
      "id": 20786295937,
      "node_id": "LE_lADOABII585-yiT2zwAAAATW9bSB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20786295937",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-07T12:25:04Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20786375356,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAATW9uq8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20786375356",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "29ef3c62de1084b76050414f1f0549c05f9d9ef9",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/29ef3c62de1084b76050414f1f0549c05f9d9ef9",
      "created_at": "2025-11-07T12:28:53Z"
    },
    {
      "event": "commented",
      "id": 3502289963,
      "node_id": "IC_kwDOABII587QwLQr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3502289963",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-07T12:30:08Z",
      "updated_at": "2025-11-07T12:30:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "`e5e16de7b5...29ef3c62de`: rebase due to conflicts, drop the changes that were merged via https://github.com/bitcoin/bitcoin/pull/33793, thank you!",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3502289963",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 20789758154,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAATXKojK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20789758154",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-07T14:51:10Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20839657897,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAATaI_Gp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20839657897",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "d419fbc42bed874ad5377dfa72c6b4813fe24454",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/d419fbc42bed874ad5377dfa72c6b4813fe24454",
      "created_at": "2025-11-10T15:16:13Z"
    },
    {
      "event": "commented",
      "id": 3512327977,
      "node_id": "IC_kwDOABII587RWd8p",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3512327977",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-10T15:19:22Z",
      "updated_at": "2025-11-10T15:19:22Z",
      "author_association": "CONTRIBUTOR",
      "body": "`29ef3c62de...d419fbc42b`: drop the last commit which contained the functional tests. That functional test + a fuzz test now live in a separate PR: https://github.com/bitcoin/bitcoin/pull/33843. This reduces the main PR from\r\n`1451 insertions(+), 91 deletions(-)` to\r\n`1036 insertions(+), 91 deletions(-)`.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3512327977",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 3512531635,
      "node_id": "IC_kwDOABII587RXPqz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3512531635",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-10T15:50:52Z",
      "updated_at": "2025-11-10T15:50:52Z",
      "author_association": "CONTRIBUTOR",
      "body": "`d419fbc42b..29ef3c62de`: restore back the test here and close https://github.com/bitcoin/bitcoin/pull/33843 after discussion at https://www.erisian.com.au/bitcoin-core-dev/log-2025-11-10.html#l-236\r\n\r\nIf people review up to but not including the test, they can ACK the last but one commit.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3512531635",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 3512913726,
      "node_id": "IC_kwDOABII587RYs8-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3512913726",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-10T17:07:11Z",
      "updated_at": "2025-11-10T17:07:11Z",
      "author_association": "MEMBER",
      "body": "Forgot to re-add the fuzz test from #33843 (https://github.com/bitcoin/bitcoin/pull/33843/commits/8e4084f7b6d51b3fd1e5f299c5e7531f5885b2cd) back here?",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3512913726",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "commented",
      "id": 3515590666,
      "node_id": "IC_kwDOABII587Ri6gK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3515590666",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T08:42:29Z",
      "updated_at": "2025-11-11T08:42:29Z",
      "author_association": "CONTRIBUTOR",
      "body": "I restored to the previous commit id `29ef3c62de`:\r\n`29ef3c62de...d419fbc42b`: remove the functional test\r\n`d419fbc42b..29ef3c62de`: restore the functional test\r\nthe fuzz test wasn't there in the first place.\r\n\r\nI think it needs some more polishing and is not ready for a non-draft PR.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3515590666",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20860899951,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAATbaBJv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20860899951",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "875795ef0ffa1be6ad07d6bf43e306dd531c6e65",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/875795ef0ffa1be6ad07d6bf43e306dd531c6e65",
      "created_at": "2025-11-11T11:52:46Z"
    },
    {
      "event": "commented",
      "id": 3516542540,
      "node_id": "IC_kwDOABII587Rmi5M",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3516542540",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-11T11:59:55Z",
      "updated_at": "2025-11-11T11:59:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "`29ef3c62de...875795ef0f`: bugfix: transactions to be broadcast are sorted by priority (number of times broadcast, last broadcast timestamp). The timestamp should only be compared for transactions that have been broadcast the same number of times. The previous code would compare `(3, 100) < (5, 90)` and `(5, 90) < (3, 100)` which was nonsensical :face_with_head_bandage: ",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3516542540",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20912594131,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAATefNzT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20912594131",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "7547f915bc6cb0425b46234df486e0de34cad3b3",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/7547f915bc6cb0425b46234df486e0de34cad3b3",
      "created_at": "2025-11-13T09:50:04Z"
    },
    {
      "event": "commented",
      "id": 3526942592,
      "node_id": "IC_kwDOABII587SON-A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3526942592",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-13T10:07:40Z",
      "updated_at": "2025-11-13T10:07:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "`875795ef0f...7547f915bc`: take suggestions from https://github.com/bitcoin/bitcoin/pull/33565",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3526942592",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20923511556,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAATfI3ME",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20923511556",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "36ae854b1ddf98edce7adfe6448e3a57f36267e8",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/36ae854b1ddf98edce7adfe6448e3a57f36267e8",
      "created_at": "2025-11-13T17:50:04Z"
    },
    {
      "event": "commented",
      "id": 3529005336,
      "node_id": "IC_kwDOABII587SWFkY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3529005336",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-13T17:51:13Z",
      "updated_at": "2025-11-13T17:51:13Z",
      "author_association": "CONTRIBUTOR",
      "body": "`7547f915bc...36ae854b1d`: take changes from https://github.com/bitcoin/bitcoin/pull/33792, apply similar simplification in the handling of `VERACK` message and some nit changes around logging.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3529005336",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "labeled",
      "id": 20924599123,
      "node_id": "LE_lADOABII585-yiT2zwAAAATfNAtT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20924599123",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-13T18:45:42Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3462686432,
      "node_id": "PRR_kwDOABII587OZGbg",
      "url": null,
      "actor": null,
      "commit_id": "11a339437b88ef739bc309f3f9ba90cf35d0a76f",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-14T04:09:45Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-3462686432",
      "submitted_at": "2025-11-14T04:09:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc4ZTk4ODM1ZjU3YzlmNzQ2YTYxNGNhYzA0YWY2NDVlM2ZjZTY5ZWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/78e98835f57c9f746a614cac04af645e3fce69ed",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/78e98835f57c9f746a614cac04af645e3fce69ed",
      "tree": {
        "sha": "7782ce2674e2aa32a2356c1cf175a63a3120162f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7782ce2674e2aa32a2356c1cf175a63a3120162f"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 7782ce2674e2aa32a2356c1cf175a63a3120162f\nparent 07de378ed2ae5d2c5ab158ed0c876882cb760cdf\nauthor Vasil Dimov <vd@FreeBSD.org> 1743566861 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1763112625 +0100\n\nnet: implement opening PRIVATE_BROADCAST connections\n\nImplement opening `ConnectionType::PRIVATE_BROADCAST` connections with\nthe following properties:\n* Only to Tor or I2P (or IPv4/IPv6 through the Tor proxy, if provided)\n* Open such connections only when requested and don't maintain N opened\n  connections of this type.\n* Since this is substantially different than what\n  `OpenNetworkConnection()` does, open the private broadcast connections\n  from a different thread instead of modifying `OpenNetworkConnection()`\n  to also open those types of connections.\n\nCo-authored-by: Andrew Toth <andrewstoth@gmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmkW9u0ACgkQVN8G9ktV\ny7+n+x//R2OlLjuGa9agC35EmS4D/ppBzQjGcauoLzqCFB7liT/MGKCpxgPJ6tJD\nVObF2T5+FAJqQZtfsrT1WouzUtm56jOE7ajsSixjwfVs+NsfUXpyhh5ERc3KPl6F\nyBkJJeotmFv2rclw7Vo4ydRecHGwLKlfzWnrqNoRP5lM0T+qFFTVisrAKZPMPeZ2\nearWCp5gAjAvjKpXhjlLAOCY53orjiHG5AoBQycaCIvHMEHl3rivOUGWpzrkkvzM\nKsn9Rjaa+f4PDV68iAniFZvQ9RXaZaYzTZ1b88TWb596XJq0u4VFiQ3qrS6oLHgZ\nM7ON55I0e1xhkE/GQ1bCUea69AE0k5oYtDDoTaUGvtUn+dOF9GZdYGNvf1mCs0Kh\nOsbncIPj8OziD/Kbrxhnbdsff0I1d84QAxBJsZqzpzxAGjxZ4tA/dSnPeO0lyGdT\nRUFAO8G3W6hu5oTXdD5AiIj2VVWbU8y6VyqB1+elwHsnsFrfO0s63BBD6AmyO/cK\nBCNWSJLS2tDGiGuf8RthEp0yarzUgMNh9xmKCU+5nBXbbKSpyn8KXYb+5O14s2hU\nJjczxIlNGq5nTuxwL4ScdpeYn9t7jD/7nqZyLwI3FBU7TkJ3MqGyDc8YctU9pKa4\nBjlPTWtkrPNfIULfOHkHxmkWTKef3jF/B0+djiVxJQzOwdTuz2KtmVMxIGCLGOCY\n5nZuqZMzCUthMI3GW9a4z8a6+E4Unt9jMccJ5gD7hWDVTRWuEFHiEVZVntZrwxh1\nVr1PaAJSxzvLSwHe/tnSFQzBp5mF/W2WG4RqQKCy1CyrBe/VMLrepfr7RNmadxlD\nAEzBHYu+h4eK5T4UdzYDf/MUhJHY+HUPCT/Guyr2R3p9xxJPM5AqAcOHQp2XY4QU\najpGL506LK7/dyu5SB/PTvFojDsctuIyAR2N7ASABl3ekBbn/u/2IE7dMOvJ7m2Z\n97Sk5t/CoAJp8TwmcIMTxKnDDVZy7hZaFgz5Z0eGLTwTYw1Ku4dVjQVeWAEIt0L2\n3sIp67+aCX8mf5hzEGeChhby/b8V9dBuAJ9CEfoZzPLsFNQVnelKFRcwbqroBord\npwCfE+LinSa3RMYcbu6HdN0yyFzPq3XRoCeq+XvkF7hFCE1KwG6OYEkFfpBuDmXv\nEgqjZxAN16hkz8EVhysoxL5LX1sfYvKCR2W7HQqiE7vh2PqlnDypqfSgFJvz8/97\nmRhcuB3yebuM+NyyokJORn65kS1unWuRK6a1rnAC4lq5SSsoo1zZBtBvpq6LA+MP\nVdZbmGdzeLAuXp3KOxYHFU2FQYfBtF2vfu6xy64fa5biRJwwI0kNvNo6hYIiYJCi\nMKYLR2Ny8NXNiFzhVVDQIG+NkM46JA==\n=wP3G\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/07de378ed2ae5d2c5ab158ed0c876882cb760cdf",
          "sha": "07de378ed2ae5d2c5ab158ed0c876882cb760cdf",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/07de378ed2ae5d2c5ab158ed0c876882cb760cdf"
        }
      ],
      "message": "net: implement opening PRIVATE_BROADCAST connections\n\nImplement opening `ConnectionType::PRIVATE_BROADCAST` connections with\nthe following properties:\n* Only to Tor or I2P (or IPv4/IPv6 through the Tor proxy, if provided)\n* Open such connections only when requested and don't maintain N opened\n  connections of this type.\n* Since this is substantially different than what\n  `OpenNetworkConnection()` does, open the private broadcast connections\n  from a different thread instead of modifying `OpenNetworkConnection()`\n  to also open those types of connections.\n\nCo-authored-by: Andrew Toth <andrewstoth@gmail.com>",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-11-14T09:30:25Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-04-02T04:07:41Z"
      },
      "sha": "78e98835f57c9f746a614cac04af645e3fce69ed"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDJjNzVhOTE1Mjg0YTJmMDExZmY4ODYwMzI1YWM0ZGNlN2MxYWQyOGM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2c75a915284a2f011ff8860325ac4dce7c1ad28c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/2c75a915284a2f011ff8860325ac4dce7c1ad28c",
      "tree": {
        "sha": "4e8b3729d4b70a207941f07b3d657a7622b625a4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4e8b3729d4b70a207941f07b3d657a7622b625a4"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 4e8b3729d4b70a207941f07b3d657a7622b625a4\nparent 78e98835f57c9f746a614cac04af645e3fce69ed\nauthor Vasil Dimov <vd@FreeBSD.org> 1703082737 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1763112685 +0100\n\nnet_processing: rename RelayTransaction() to better describe what it does\n\nRename `PeerManager::RelayTransaction()` to\n`PeerManager::InitiateTxBroadcastToAll()`. The transaction is not\nrelayed when the method returns. It is only enqueued for a possible\nbroadcasting at a later time. Also, there will be another method which\nonly does so to Tor or I2P peers.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmkW9u4ACgkQVN8G9ktV\ny7+hWB//dtI5tjAnlp9Jb5DWJKsnPGMhwCqdGxMnvXxHXu/Snor08svLlLplbXcD\nRApenoHiWtWUtDycAHL7ISVK/hjlGTvg6KKoawpvPiuBgdUaRkZ48T+cH8YuAjcZ\nAoUHkLzAFnUwoxfy/6kA7Hf+N0eIVdKv+isQ8Yf11+V4oR39POWiSbvYwipQ7bpY\nzgzLqdK41QZk7OMRfAcFIRnsHbMw3aTJs9u4J0dKZRMdE7OB/H+AjAZIPP0o5RdW\nt4HCC7T5WKq+ws1/RaBvU/uRMMGOocbTU2pDGTVFkSg5Vh+7Q9P8Ek4jgWICUd34\nclOVOHp2HpWakUIkNnQ5LINWkGvHx5NHYH5RT00vT5oSyjl35beKIgOe4noEsulw\n4ZPc3bx6dNMRGDZhYMLT9izog+TPPyixhd5zM8ZwW6o4vm2FsfEmQ5i7lBxxdqt1\nbHQ/nzGkhNvVn5Jw6JN+lbsb0TPo+1irN0qV5h0An9j/JBCNfsdBC2CnFUpJR+/h\nwGK+FgeIfoL73bzHKKYVyQHXzFYF74cfQncJv8WLJb5luUoSPEJ7yErI7F/sVX5l\nONMqGznS3E6iSkkNuvxqwSFF4SuOQQWdJj5UtvsDnVuAm6J4UY1UUXKbzz1B3lU5\nTxExitwPRqKJsrPfLXfoPyvNVuZWWihlO/+InYWdOpDHUbAOMO9kItb7XexhawZn\nIK8mj1F31VkeGQHSZQFVfNFySxuTXKQzBb+mGt7ERkunbLsii2pGAGta7gUWt0Sv\ndidywFPXQI1Bs2eTnR3PM2kLZHgnuqUK4Ba9SAzomzh4jJAlUfleuQrAOb27wM4o\n7BRHyQPAHTRo6E57ab1TRya6kNGa3EPQsHXPVA3EnlsLOnoHanEntO9y/1OERlo9\nLoHuXkPPY/ig+iRYu/wwdNyaZZlzc46O/7aQn5pBPveah9oCCJIueBAS2Zc5LbUR\n97wsJ7/3OkP/F2/fiClI1FHM3DYI+h8ucqIAZtFH5kgY0QwXsBck6HNDlYkDSE+p\nMPUMHoR3WpM5/6Qo5h5otZ2MFBYL5iVwv69mclneQl8Ft+spJoAYQD1/GuF4p1bn\njYYWfa2CBcc8bMZjT9xDlUF+AcKBFu+AtdirU9fDWJbc9AdD7ZNtjbu9lKcUBOVz\nYbJ05hRZkQGShqjEMh8Rpyj+RKw3VPgPjn+mW0qi40EOo4tklJa9D9IYd6yRMsCC\nR23kCpvaAA9kvpyuPi88S7M3JxUHzc0/eofMkAiM9eF/F2xSMM7QxleOyQ8Rgw8e\nCKwaS4ywiQaafnEavLYOlP/DTJwsnRhxTVZsEKxffuz+Q1A+vtBbsp86uE/d4p/A\ncShuTnMjNnt0cHulXyvKrJkvd+rjew==\n=Ftr5\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/78e98835f57c9f746a614cac04af645e3fce69ed",
          "sha": "78e98835f57c9f746a614cac04af645e3fce69ed",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/78e98835f57c9f746a614cac04af645e3fce69ed"
        }
      ],
      "message": "net_processing: rename RelayTransaction() to better describe what it does\n\nRename `PeerManager::RelayTransaction()` to\n`PeerManager::InitiateTxBroadcastToAll()`. The transaction is not\nrelayed when the method returns. It is only enqueued for a possible\nbroadcasting at a later time. Also, there will be another method which\nonly does so to Tor or I2P peers.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-11-14T09:31:25Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-12-20T14:32:17Z"
      },
      "sha": "2c75a915284a2f011ff8860325ac4dce7c1ad28c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGJkYzhhZWE3ZTc4YmE4MmFlN2E5MGZkMzI0YTdiZWE3YThjZGI1MWM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bdc8aea7e78ba82ae7a90fd324a7bea7a8cdb51c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/bdc8aea7e78ba82ae7a90fd324a7bea7a8cdb51c",
      "tree": {
        "sha": "f98fd3d20bf8374d8cac47f1766a062016069dc7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f98fd3d20bf8374d8cac47f1766a062016069dc7"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree f98fd3d20bf8374d8cac47f1766a062016069dc7\nparent 2c75a915284a2f011ff8860325ac4dce7c1ad28c\nauthor Vasil Dimov <vd@FreeBSD.org> 1759849035 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1763112686 +0100\n\nnode: extend node::TxBroadcast with a 3rd option\n\nExtend `node::TxBroadcast` with a 3rd option to not add the\ntransaction to the mempool and broadcast privately.\n\nThis is a non-functional change - `BroadcastTransaction()` will not\ndo anything if the 3rd options is passed and is not used by any of\nits callers.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmkW9u4ACgkQVN8G9ktV\ny7/ISx/+MGhb0VW1l2+nZt7fni5+XU4fgHJZ2NhiAHjT7JOZ9WefJ2qFYIMz6Kx3\n+U0YIcFhxhlNR8qV/E+/qNEV9NyQUCgnDUvCvNzytKLy/UG6/TnnGw7nVJXOeUtF\nfvlmAoDC+8NUAretHXrz39IEDzv6ldnJ3oe1evT+91txNDeOVu78mIkeueiFrJJH\nWoe6fOW7w7XkStNruaYoPpJK6MfTO2/Q5VFeAMcOTba+YQNx7eSKfb5FEZ44shuA\nW+acf+RlbvOhjbot1h+gLO3DAEe40B1Rh7puAYal9G2MOXrBja2t1lXLQOJjVe2X\nOZViyVddoj6XOUsN9ziB7guVfBfB97CPaAViIuuydPE4zQfMXvsuaRLZJ/LK14pn\nqsoCnpccpTxLoO+jgzinlNxoVIgVgFH2hvd7PuHhRg+a3U1Zw1ZIBKHBrkyE4QVJ\n6vlLCZWJpCQnJZHbAfhw5jFJILQMFDwtxq2NDks8QcDlt2Q/ugGNLcP2fLaAr7Hz\nhA8K8KnJ2zQ7JC7cgWSFqPQ0Q8e9rwVQxfWbeweg5q/m4bCZSYKOcPu/8AkKjtkB\nRKxQ7PCcHIVGoYB5WPXYpX3qoXohFJORVOdEfGXptXNyn0U2P0z3G3SaIN0INeNr\n1m0A3ZX0JMALKf9CPT1d+kMuRq14B99JYHOfkx3Enhx613iuEMvs5PYm6fWWg6Pk\nHR7bIco11BMqJV3WX8rPZQHXTyl2OXyMH0ACRCLZ88rI8eeJp+ITCgDS3A6A28Gi\nj9VTT+EeuIj5da4h1X9R/LobcrUWKcOLTPMNTJF/imrrxbQX/yBZVBzwcsIRV+L3\nYU82b8ptNgNLD4YBvTulUXfcoP72B1tjMteNvzptimmXISoOxdgZWnxJUMjzuOO2\nd8eDPv/uVj2pWUUCU9V0HNATjDLKrXQOX8RH9fbFS11RVwqymjA1yBaiI21wNmaP\nQYHyV0O41HNg6uADZjcfK7p0D/Xjnl803+cUzi2ya8owHgAZycd19VBsK62nQpRH\ng5WG4iTFKsId/HF7+FQ/5DllPqu3JJNK0SP0qOl1a2J9ghRAOr8FdjXjRmhHHMSe\nEIuAHaf5xNHU7AsKEgrnc+y1EKEbrFXoljhfgzqsf3gNClcZ/VyFsGcu2VlUMevn\nBRkPE+BerVyTDtWeI3YlSVyoY3p+JWW0mUFQQnuW40g6GUahVjyxVopaSk6i46kG\nIuWo0Rfcjmk/RFMyfc4+EO+VZ3OBk652TI+0OiHeT9FeV1LDzjJ3TtDqDfy/wOym\nUuh6NelntaKfbeQk/97gSIMI4C6XHr9hAd763QsvZbV8L2mBNINGwIQgnfwjyANn\n51fEwZpXZOePJvI1jQ9/ZLJA+jBsLQ==\n=oyBw\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2c75a915284a2f011ff8860325ac4dce7c1ad28c",
          "sha": "2c75a915284a2f011ff8860325ac4dce7c1ad28c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2c75a915284a2f011ff8860325ac4dce7c1ad28c"
        }
      ],
      "message": "node: extend node::TxBroadcast with a 3rd option\n\nExtend `node::TxBroadcast` with a 3rd option to not add the\ntransaction to the mempool and broadcast privately.\n\nThis is a non-functional change - `BroadcastTransaction()` will not\ndo anything if the 3rd options is passed and is not used by any of\nits callers.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-11-14T09:31:26Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-10-07T14:57:15Z"
      },
      "sha": "bdc8aea7e78ba82ae7a90fd324a7bea7a8cdb51c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDA4NTcwY2RhYTE0MGFkOTIxNGU3NGFiNzRmNDg2NmNiNGZhMDAxNDI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/08570cdaa140ad9214e74ab74f4866cb4fa00142",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/08570cdaa140ad9214e74ab74f4866cb4fa00142",
      "tree": {
        "sha": "546b0b0996a918563abfecb049579fa2077e4f7b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/546b0b0996a918563abfecb049579fa2077e4f7b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 546b0b0996a918563abfecb049579fa2077e4f7b\nparent bdc8aea7e78ba82ae7a90fd324a7bea7a8cdb51c\nauthor Vasil Dimov <vd@FreeBSD.org> 1706605284 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1763112687 +0100\n\nnet_processing: store transactions for private broadcast in PeerManager\n\nExtend `PeerManager` with a transaction storage and a new method\n`ScheduleTxForPrivateBroadcast()` which:\n* adds a transaction to that storage and\n* calls `CConnman::PrivateBroadcastAdd()` to open dedicated privacy\n  connections that will pick an entry from the transaction storage and\n  broadcast it.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmkW9u8ACgkQVN8G9ktV\ny799dB/+KaFRqVRNjsFYBXcKduXr4+yqZYJrZZRh6lhnwf5p3XKyPz/yTZ1drsyF\nT12kE6qu1J147GfRyupDrqzK4rHmUK7Vi8agW3+Qf4RvBP1RQO+mdgKrpuQr1/cc\nUuM6leY6wXj4mdW093qeQy+MPLvKZ1/VwyNNnZzGLzX6PWH8BJzl8SH2XBY2ASXE\nKWr0/ALCEgS33aDEPz4ATivNDHFV1J77OwsKRkasRD+fp1sJ+ofdHIwhpIbY1xJ0\njqEeci7DjTyvvkf+7BWYM+4xoFzzExJk1UbZqT6hC8+z4ggYr71o6hhmO9bAEpZU\n0v5+apxTdYxZz6xPD1yi7V3pZeDJO1dYVs7mOLHuKNpxoMSuHoJ8N7gJYdZkcrux\nJ8ZlPTBoZnYe6oEeCaFG25lmPxS1WPX3bMFhUg7E0LYzy39gX5MTHrAu2ihiJVSk\nG90L6hGp19ccN/utmmPUhmeHo89uxIiWdbqPaFcWROa9rQ3DFle12d6q6f4hHTGl\n3CVOAI5zWlRXN9lELO7vORxlEzxCCBIomKbGzgmyJ3wD7t62t3SG6qf1bIP5ZhB5\neEZjrwoXLus/WSyfqg0T3FeegONyJeRbS3hIjuaDpF0Gin3+RXjKoZDlsDo3FDLo\neDKne26pQTwYH3s82FkYgdr4dq1XXtgltfh/z4VEC0QpD6XBLx/9qCVtwMyT2Q6Y\nuOt2fh6ZnmXnbfL/QzoR3Ts2lwqpm3TdcxrN8pzpehdlXzvsH5q4TXA7m8o0+pjX\n4E11SZJKBY71L+TdUTkfXHvmTzRIPJbZxO0xZa+2Vy1cYBKbT3wXR7c8CpscdCMi\n2BofjhN2b89zg2rLn5oed9TgNPtgJQMMOQL1N2Re6BOekSJrUR89TJrQP1knZ81V\nogIr6TJ+3CIltC15RFBHNgZCsWFJYkyNYftGO2pmw2VLbPIv2kyTrL2ljgUKu3zn\n5IRoiW0L9x98wzdV17mbM/QbluDPtE6cPQoJFFzOsopBVhwh7efNysHqlLLXFeop\nkq2Z1tfiXhd5VBvJss5iJn8OVl2HWGiZMMhPX5AJEY2SPsaWl0jF7+mUmRquR7JO\nONEFfFvgH3EtlvAdXlD5aOC/FAe5xTOdDnVxgK+tokWW9N0vCqR54lksR4AR3g/D\nEJi2H97IGVwqFbztaMjhrYWi42oBNwiyRczgXhwmFoMJvQJBM/La424XyH0k5VLs\nRBvret9msK52RODD7HWhsSCU58R9FFJxRznj7HalRbzCqs2tmMpjBu0xCB4o4KKc\nlUJkvM5Alm5Yl0C4fYeRNSy990xALOIaoHBUjdakQTs+2kyb4SCr2LEzpJeMwr39\n0Hay1CScpZBGMaeCmdBilvfMz8xIlQ==\n=AC/k\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bdc8aea7e78ba82ae7a90fd324a7bea7a8cdb51c",
          "sha": "bdc8aea7e78ba82ae7a90fd324a7bea7a8cdb51c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/bdc8aea7e78ba82ae7a90fd324a7bea7a8cdb51c"
        }
      ],
      "message": "net_processing: store transactions for private broadcast in PeerManager\n\nExtend `PeerManager` with a transaction storage and a new method\n`ScheduleTxForPrivateBroadcast()` which:\n* adds a transaction to that storage and\n* calls `CConnman::PrivateBroadcastAdd()` to open dedicated privacy\n  connections that will pick an entry from the transaction storage and\n  broadcast it.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-11-14T09:31:27Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-01-30T09:01:24Z"
      },
      "sha": "08570cdaa140ad9214e74ab74f4866cb4fa00142"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGE0ODVhNTEzMGVkMDk0ODYyMWI1YWE1MmFjMjE3M2NhODZlOGExNTQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a485a5130ed0948621b5aa52ac2173ca86e8a154",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a485a5130ed0948621b5aa52ac2173ca86e8a154",
      "tree": {
        "sha": "81cf40d9cffd8f38c627cd17f44fae5e90ff6ef8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/81cf40d9cffd8f38c627cd17f44fae5e90ff6ef8"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 81cf40d9cffd8f38c627cd17f44fae5e90ff6ef8\nparent 08570cdaa140ad9214e74ab74f4866cb4fa00142\nauthor Vasil Dimov <vd@FreeBSD.org> 1703161470 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1763112687 +0100\n\nnet_processing: reorder the code that handles the VERSION message\n\nChange the order in which code snippets are executed as a result of\nreceiving the `VERSION` message. Move the snippets that do\n`MakeAndPushMessage()` near the end. This makes it easier to interrupt\nthe execution when no messages should be sent as a response to the\n`VERSION` messages, in private broadcast connections.\n\nThis is a non-functional change.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmkW9vAACgkQVN8G9ktV\ny799miAAgEyk2azq6T6axTlVWMvovgeL01I16warLWyLqqWkcL/ODUV/Pf/y/nLG\nQnoJeNWu1gUK7ojH+aiVuLsWLFLzk9S6Vm0oIPE3+Qk00P2oaDCEO0PbFNC7/LXH\n7SHCKdCRD4q7M+lJQX/jXYeVQ2E80gVR2xgV1fvXfuQ8SdchiYOPHENbDad9wnoi\nT+WIM8GeVQugM76EErQLM9esT9FJq0zoP02KJ4qPGG4hRaDzbuM+pKbmgtKXgpUI\nllVWOwPcWU43k9eXDaoqMt7zELu/ohMwWdfmTXQbtXqX8Ep6E3UmXTbXotTechx/\ngqP/3ViFmmaYH2/kAisd29CLyuaII9jV07HcCK5a3hZKtKs/eTmrTm4w7n0KNgtz\nqodVGLvemZq8Jl6dykr2et2B4Tqa6QjdIYZNxLoa6ldxHz+CW24VEfL6o9oxEKp3\ny4w7dBm4xIaBiaO2vS2hgiEV7U8/i+XzJgETAe02H0mYut33LAPsZQNe7a28IIK/\nmN0oGXi6FOhLGKia8BhkJ5/+LP5z0KSWlBuLiayfgopHWR5F5P4fDTbvKkzP5+mD\nX0xxKM9KF1mWpLsp0LUjcqBIDeE28Z6kRE/d0jYC9zlf93JrqJlpItjEsToCVGHI\nGJTsN0fYxFZTnM5hID5TpOYjuNzuxaSl0PAEOeUavQZw4MgFb8P3NxaubqiC6f9D\nd1hEyPQhjrlqhpCwn1iPv1oy/fRbLYLEO6XDL+FrLH/lMISB/CWjLU0OY2cfp67D\nEKIbSA+0/WSYBcR23vdJ/WXlnxsVVYGjmXHzi4egW1Nd5ANnhv/cZeCNMIMbHOky\nHvVK/qOKgM1gP40/vjew8i+0UiIwkdD1nc9X/RDS0hGIsANZFcxf6QIZvwNu0zYx\nfK8ipg38QCyvNFiN/lhFAasbmkwaKRx6I0YqKooDimRXdXr70KWy3lTramZLY7oR\nF4SwQvOshYQALMjy5LEyefZXFPMU7hxYGI9V3BFvjzsdRJ73kOlsoND/nnRBolBw\nOzExrkVFyV2rmMDtqn0ZhqASHuDFEQezPBACkFPS4PLf7aREzVk9/yTj0QoJn2Ab\n6nSMGHz27knxu+6nX+ZcCrSIfGJScipV4uwPNTK7m4is7ENetD11ENryreq8BezT\nBH/E62UtMK/U/74xYyIq2WT3Ws4fP/MaT2721IaXjezK/T7/TDPfS26ap0FJTcTV\nJol8dzrzghjouE3tUFA48X+Qf0VeYcBBiaOO/9vL0Ds+EpM4NTITS6cvvj5cZZZb\n+pGL2/sd2VOnCgA5aBthQQmvn42nVXU6lkDnpgnh5ph6cWXLfu1OAPdr8IIsuUFT\nwxt0KuSyqAYtEOziIrATjAamqkU0fQ==\n=Fufa\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/08570cdaa140ad9214e74ab74f4866cb4fa00142",
          "sha": "08570cdaa140ad9214e74ab74f4866cb4fa00142",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/08570cdaa140ad9214e74ab74f4866cb4fa00142"
        }
      ],
      "message": "net_processing: reorder the code that handles the VERSION message\n\nChange the order in which code snippets are executed as a result of\nreceiving the `VERSION` message. Move the snippets that do\n`MakeAndPushMessage()` near the end. This makes it easier to interrupt\nthe execution when no messages should be sent as a response to the\n`VERSION` messages, in private broadcast connections.\n\nThis is a non-functional change.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-11-14T09:31:27Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-12-21T12:24:30Z"
      },
      "sha": "a485a5130ed0948621b5aa52ac2173ca86e8a154"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDI1ZTE1NTQ4YTM4NWJjMmMzZDRhODliZGZiMmU2YTE0MWEzYTg3ZmM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/25e15548a385bc2c3d4a89bdfb2e6a141a3a87fc",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/25e15548a385bc2c3d4a89bdfb2e6a141a3a87fc",
      "tree": {
        "sha": "e9cc4a15124f117cb2d2cbf271c897697ef2495f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e9cc4a15124f117cb2d2cbf271c897697ef2495f"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree e9cc4a15124f117cb2d2cbf271c897697ef2495f\nparent a485a5130ed0948621b5aa52ac2173ca86e8a154\nauthor Vasil Dimov <vd@FreeBSD.org> 1681911630 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1763112688 +0100\n\nnet_processing: handle ConnectionType::PRIVATE_BROADCAST connections\n\nFor connections of type `ConnectionType::PRIVATE_BROADCAST`:\n* After receiving VERACK, relay a transaction from the list of\n  transactions for private broadcast and disconnect\n* Don't process any messages after VERACK\n* Don't send any messages other than the minimum required for the\n  transaction relay\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmkW9vAACgkQVN8G9ktV\ny79OHh/9EJxCHa8VhDQ1jOxkpdxSkNNFPxFXwV3Oq7PxRmGRpe+k+LZad8CEipLZ\nPbIj4/DMBF9afRTTb9CsFkM4+a09z/nwP6CcobZDOANAz+occ/HSDMMMFtrOKD28\n8N9qNTCTjsNUOefjwTXok6SNYpLSo4OK90knTJGIsj6hqU1i9jP1VSPtWk8WOMNe\noFTAo3jyutfw+qz/MOGlU0OU4/zsWMH09PCI8sv4C3ucgONv/gU0T1nkj2L+ZF1n\nkgdEQ8ktcahn7ywIbsUSWsQU+jzkllWweUGs73reyHRx0lE/K8aigcWPnVD/8YLw\n+AiYlY+8aP+b3uATzNiUcCKQoDsmWcJhiHGuNKxV6o2g7I+jW00gl7x2h/DNsZmt\n+5aJ51BPipZrKm9GYB6171Xly4kS3FlB8r2EAkcyEfdIaDcHqjZyhA0ZEQ/dYFza\n/Xl/qz6r0uxqw9xNrkiZaSrZrcUDYvJhED6wdTnGA+ZBK37Qvbdb349/KnDIshbl\nUTML5u/osbpbV/f6nxXZaZzREW+V3tO3SM7pYdb+AUWMcJikPNzUTfZtGZ6bqu2x\nkVlsinwvyxPQLVWJ5fngdxBXmQxXcy8ZdTUE8kAQAPasKZLCD37PbZbDGLO1Hoh9\n6dDouMENWdywgfU+m1aNvxQqRO3tDsAoj+sgzemepBsqYuQ51vqMrAeYf205zaZs\nMvGJr/bCZxCRJIZTLvb7d5Vx+neu4bccf9N7pAjnUvw8qxqXo5mA0sc9Kvo1Fmaw\nEAVEOQtTHiUtW4K9WyIOhamDG9nA4nUSpLAXhhnIig/xWccwVgMrvG/IpSUgVjgA\nXK1a8NbvRKgSAk+/cVIHPfgBny8iNdShd2kaz7qAXByJvkAxLKrA1q/24WXdzJNG\nrxEQT/9VVsozBq2S3wmMvoOJ+zbee30OCyPccOpR1zGgylrzep2yohwZs5QwYhYt\neUulQs945znO/1W9bsubhM/ZVePxkgXrupt/Q1rN9Hb/WPo6RmCjqale7g+sn57K\nILuyaPlUivtRlOIZkCH0lBPjPvb2hlBJw+Z6zn1TETaWMtJbQxVNlkwpEVPl7vLk\nBBlxiBXftLJFfRztg6v8OLaxriQ7w+CPqae8S9XWDfmX82RFOtdIah8CgdJ3X9Jm\n+DLwXsrmrd3rsYry0raa+cPHz9jl576q7QAtp/4iK14H/mjMamk3lsQumjBYOOo1\nJnodFhsALZkCI6tjU9JbP4MwjQt+l6GwkuDsjHT/n9V/2U8iWkPvEgVBtUumqg5c\ni+2mH1rCT6ZKt8U8MQQJkEVgDTkGB2Y24tLLm9drDkx6M/JXWe7ERoqp0gk9ySdz\nzSPChXUZPC2b7aGvIfsutBdhNI+Y6A==\n=HlGV\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a485a5130ed0948621b5aa52ac2173ca86e8a154",
          "sha": "a485a5130ed0948621b5aa52ac2173ca86e8a154",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a485a5130ed0948621b5aa52ac2173ca86e8a154"
        }
      ],
      "message": "net_processing: handle ConnectionType::PRIVATE_BROADCAST connections\n\nFor connections of type `ConnectionType::PRIVATE_BROADCAST`:\n* After receiving VERACK, relay a transaction from the list of\n  transactions for private broadcast and disconnect\n* Don't process any messages after VERACK\n* Don't send any messages other than the minimum required for the\n  transaction relay",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-11-14T09:31:28Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-04-19T13:40:30Z"
      },
      "sha": "25e15548a385bc2c3d4a89bdfb2e6a141a3a87fc"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDZlMThiMTA2MTEzMzgyM2YxZThlMjA0NDgxOGJlZDExMTAxOGNhZWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6e18b1061133823f1e8e2044818bed111018caea",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6e18b1061133823f1e8e2044818bed111018caea",
      "tree": {
        "sha": "fa8afa11db5a0e57775af2b794dcacd2dc2c463b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fa8afa11db5a0e57775af2b794dcacd2dc2c463b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree fa8afa11db5a0e57775af2b794dcacd2dc2c463b\nparent 25e15548a385bc2c3d4a89bdfb2e6a141a3a87fc\nauthor Vasil Dimov <vd@FreeBSD.org> 1706637083 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1763112688 +0100\n\nnet_processing: stop private broadcast of a transaction after round-trip\n\nRemove the transaction from the list of transactions to broadcast after\nwe receive it from the network.\n\nOnly remove the transaction if it is the same as the one we sent: both\ntxid and wtxid match. Don't remove transactions that have the same txid\nand different wxtid. Such transactions show that some of the private\nbroadcast recipients malleated the witness and the transaction made it\nback to us. The witness could be either:\n* invalid, in which case the transaction will not be accepted in\n  anybody's pool; or\n* valid, in which case either the original or the malleated transaction\n  will make it to nodes' mempools and eventually be mined. Our response\n  is to keep broadcasting the original. If the malleated transaction\n  wins then we will eventually stop broadcasting the original when it\n  gets stale and gets removed from the \"to broadcast\" storage cause it\n  is not acceptable in our mempool.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmkW9vEACgkQVN8G9ktV\ny78BLSAAigjPtnMbo/naKHVz/taD7tsZ9tdp6OwkwiTSJAx9ueovQJCjPBvynmmP\n2HemZI6Nr7o1qhi9eorKClZ2Q3drVvkdzKnNwgwOKXYalSixp/7L55wQGnRynvrO\nZzKvfoOuuGobWg0ASlz6Qs/zV5jK5amuNHQhS8sTjoS9CSOSClswLA5ol/vEzRid\n6EmP84jipLCJz+2bFNGeD49GvENT8WBH0gVKQLAJJb/dqQbpBzc63HXYrymDfDLl\nZ+Be4+Gp3nYQsg5lK8d+H8yyB6bqsQQtmUNOwqoEwDAP7+TKzRSFWlzv3DPNExfQ\nxmjElhH8uUtq81hI9T1y2/0CBiycipzLuShR9iKykjN94hT9wHbO3qQ9xAiBaFjk\nsqkK6UWwv+1FsT6/J3GjP2pBKS9E2XiVSh6LVHYNGBNTv1ib/VpLFgaDrlzfQYLK\nBaUmgRpXuCe7Ur/eRWYlDg2K6+mnqP+AbiDHgMo2TuPgm+kmAbfLHO3O4WeCZ6Tr\njEmxXfOiZxyml6Gd2sz9CBStcQjgBir3Kwaqzjj4vJ3WCbxQNwqMPEdjTJkblNf1\nn/reW54R1GVBlZOa2j0VyoFqVrUdoKflhhWQd/Kged5p/g38LpGeE/z7U1jqq4hp\nqdsxgXpsmMVSaAWtjcUFR5iKuD7gWRTAEq1Bxci7VFWPC6GggoI2lNM24Ghfg2y1\nOJX9AZZyBtwZjeuyN00sFoRPtPE90MfvXyPaIrelKMwwzn9Hec/Js1BsCf09R3AI\ndgA99LhzQw2J2mrZAM2F67ZNANa4dpJOoTQn5W758uqEtKF3tsc7K7NAvuVZI51t\n5Rt2PLEzno69RFKUDbKmELfHJ1NudHbzS+WewEzY2sXDfFTfoxW/RyPzNrbPdIqj\nA9v7prTO+rcGyNJ9n8WYE+WeCA5NLE4JGAyquo7vzD6cdHsqCaOsrKTbVT0E5AzE\nSR2DJBWZMHLhFoHOF1zBgW5wO9G+3fu6/QVOownE0xUTHtrxAKY6VIpx2hgi5p8G\nA127KxH+BV7WQW+kgwc7low5/jOWbQ3o2TLFUuExwp385D/uViX2E4KZDm6XZz0R\novInzl1Dllqckgf9akNi/bKta6QBIhWsmY8LvItxIWJg5PsUZST+pji1tlOv5y8B\nnMnSN6wFGyefc6zbzTK25JNhDjsqzFP07iyPqM2UdhyEunEOY+FR5AbxoaNwBMvD\nOuN17NiYj5GhcSHKn+lGjlv/X9Iu5FAIcxs5jGPbELsZsuT4O8b1v9Wk5KMTkcg3\nhz7Y2PqaRNrKc0MIvVZNvg/95qLjKv6hvTzHCBad10y1uCgpxmhI53CtJJyWW4jl\nxmim2n8e5Ei2WhDJCVVketO9BDnvag==\n=W2sq\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/25e15548a385bc2c3d4a89bdfb2e6a141a3a87fc",
          "sha": "25e15548a385bc2c3d4a89bdfb2e6a141a3a87fc",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/25e15548a385bc2c3d4a89bdfb2e6a141a3a87fc"
        }
      ],
      "message": "net_processing: stop private broadcast of a transaction after round-trip\n\nRemove the transaction from the list of transactions to broadcast after\nwe receive it from the network.\n\nOnly remove the transaction if it is the same as the one we sent: both\ntxid and wtxid match. Don't remove transactions that have the same txid\nand different wxtid. Such transactions show that some of the private\nbroadcast recipients malleated the witness and the transaction made it\nback to us. The witness could be either:\n* invalid, in which case the transaction will not be accepted in\n  anybody's pool; or\n* valid, in which case either the original or the malleated transaction\n  will make it to nodes' mempools and eventually be mined. Our response\n  is to keep broadcasting the original. If the malleated transaction\n  wins then we will eventually stop broadcasting the original when it\n  gets stale and gets removed from the \"to broadcast\" storage cause it\n  is not acceptable in our mempool.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-11-14T09:31:28Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-01-30T17:51:23Z"
      },
      "sha": "6e18b1061133823f1e8e2044818bed111018caea"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGYwYTBhMGEwYTc5ZjAyODliMmFmZjM4MzBhOTVmYjlmZjBmZTEzNDc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f0a0a0a0a79f0289b2aff3830a95fb9ff0fe1347",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f0a0a0a0a79f0289b2aff3830a95fb9ff0fe1347",
      "tree": {
        "sha": "4ef408b49fb4f6400c1b97a46aabb8837cb5c428",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4ef408b49fb4f6400c1b97a46aabb8837cb5c428"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 4ef408b49fb4f6400c1b97a46aabb8837cb5c428\nparent 6e18b1061133823f1e8e2044818bed111018caea\nauthor Vasil Dimov <vd@FreeBSD.org> 1706635523 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1763112689 +0100\n\nnet_processing: retry private broadcast\n\nPeriodically check for stale transactions in peerman and if found,\nreschedule new connections to be opened by connman for broadcasting\nthem.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmkW9vEACgkQVN8G9ktV\ny7+mLR//dQnJ4brOQJjdaqQu4sA4zEA4+BBB7n8ip6g0swqK0VpEz68JtmxpxXsm\neh2FE1Kn1sbX9LgGVbjxXNbnpM9VegDjKnItnnDfnyTFzOBNzgGAIisPVdAV0WA/\n68PKXMDgKBFQZGZKLw64p/taFDdmrB7rdzGSlagNFOU0wRp6qteby0upZ+Qa7soq\nNr5w8dctLPa6ktuYYJiP26PB0S16yShdPNiRis50wn3O8uVDYcgEW6jki05ziWmM\nUzpX7MupChMjL2LrQkZHLivGUVlzKvUC5GoHwnq6J2iAC4d4sKeHR7I0Wi8lAfYJ\nRH8KUyPt/9hv7Bs1M3hslxkvJ8q6MKPD6m7tjeSQCRXUu4ooY96asxuycs467gSo\nZEj2gNHlwmZQoVnGMhcuJy2Rz7tYZfOs28vKlZeY9A4aNBDXDZ87hGSwNELJErlk\nts5CwFB+zKHNgcgotk/ibOU7y7KBF9Yq4fkMx5s3belP8ltRQxTYoIqm/fh3uC9M\nuYTenwG7k12Mzi40sZtULeaWvnPZ05WWAvX5xfNEjpb9LV5NGxqKWUDR4ZLvZ3XP\ns2O1P5TmZJxCZctrug8pCqUrAFo1A9ZlVdLlXLmSTFFZP9YsbY4waun6URrbfmsS\nZERVWhkMGms4JY7p5mzpjH8Z0KE7de2keRypvv+z36bb6IM1c7y1qUpLUszicuUQ\nRlqmzHKVqeQJAPuyY0TvoRUBGBckDbjuOhnBEIPqDoNGa4etYTLbtWlmPBkWmjl+\nSAd51YFlI6KsOwDGPOiIQmjzr/tNlEMq0R8+CQHozFYYpQp9S0wTH3Ue5tlZ8sm+\n6ERDT5OkaMgumvlp97DRUYwy0FW5eh0kF7JBx+hAbYs+AnZlq0VMflqWUjrahaMI\nhZf0eGjZZYjuL8zqOnvs6LWssIa27sIvULud8/F7eJ0/HHQNB45/5Agmzkyt0auE\nx85aAimXN62F1KCPexGx7DheTdNKyV0tO8MqPmkHO8w0nCRbRDljfas15Vyaj7JE\neZncg+D6HqIxWY9ycUS+o/aMnWHXfT3eQRaSsQMBwfDIAnsWkq1jpxdzB7cDl1mV\njuVkGck3Y0HU4KMA4jYgmzNGGD9ZHmVb3jyH0pPxEcyEphsiY/ScCB0WDKMYbFmT\nLpxzBvtd5sBGcoWOUnf2ag6DKSTBTgBXSWhWKVlx2kFqzNjpJ/djAAronRNPmBIn\nWcZuX84SOJhz2gFV3bow6NxEQrWruzXREdq5VSNIX/lxRKyLtowxHv6zH2lXxWQY\n0Rtnbm7QlbnFDCmhrRzDLaHrFUiW11WJ+lR4RT/deSXcb0tUlUsEIH7JDm0olaDN\nzkcy5X0LAnihgSZXiFuD+jgoBLp4Xw==\n=pffu\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6e18b1061133823f1e8e2044818bed111018caea",
          "sha": "6e18b1061133823f1e8e2044818bed111018caea",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6e18b1061133823f1e8e2044818bed111018caea"
        }
      ],
      "message": "net_processing: retry private broadcast\n\nPeriodically check for stale transactions in peerman and if found,\nreschedule new connections to be opened by connman for broadcasting\nthem.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-11-14T09:31:29Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-01-30T17:25:23Z"
      },
      "sha": "f0a0a0a0a79f0289b2aff3830a95fb9ff0fe1347"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQ4NmUxOTg2ZjY3MDM2ZTI5ZDg3NDc4ZDZiZTQyMzU4NmQ5MzVhNDM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/486e1986f67036e29d87478d6be423586d935a43",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/486e1986f67036e29d87478d6be423586d935a43",
      "tree": {
        "sha": "fe4c52b8ac47ebb9cf20c92b764311e8514bc17b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fe4c52b8ac47ebb9cf20c92b764311e8514bc17b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree fe4c52b8ac47ebb9cf20c92b764311e8514bc17b\nparent f0a0a0a0a79f0289b2aff3830a95fb9ff0fe1347\nauthor Vasil Dimov <vd@FreeBSD.org> 1706800264 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1763112690 +0100\n\nrpc: use private broadcast from sendrawtransaction RPC if -privatebroadcast is ON\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmkW9vIACgkQVN8G9ktV\ny784qx/+LuzZzl23hey3O/LA8KzZ/+HE+N3svDFN0Srctyx6SyAE0wbtxkKyVHiX\nqlCp4q2VvQF1PRVZ66evOCNMwrh4Jg+z11Lp5GZJnjJicmymbo6gp7XKD4iWEVnH\n2LdzkoajHLJyZDkZPkdPsX0kMMFvuIVaRY1SxIkYzDrUhY1bVYwth1545L2eRqtr\nOrzldHOE29RgfrSeVPKU+5E94pAHQlfdMFWfWaeeWB/B0MMim4WIwHb1/YbOH/CA\n42jEX4DrWI6CjnaQlWj3QatSKGhCDwbzcTPFWDEWE9C8TXH6MMX+8k6ce2NSO2Sl\nC2xdgmv0Rp7e6mQpRfya27nlcW2Tj7jLisqpbd01PZUUFhkXM1pcOTBrERbBKuud\n9Ry4Vk0CoTmQvPgf1P4LnvChAhW+Qd8yPJc4MTDDCTuaWnpuj488wT+FIRLv2DEh\nfvz9yQBUgYYtenMDN7B4J0wWVeRuKp8ghHnZYGkUNVF+mzY2EgqaZ1RVsm58jW85\n3QeZizFkBKwUUKTB5REzTyHvoTz1tshHnqXaoxi3ohhDxV0e3fXtGPtuaf0h0hKL\nclI2WhB6BAMqbMBeqxQHyn00a/3N9jqXVqTKW8JRN1BANW3MZB5rZ/BOupetlaw/\neLdgacZkLTp/uLduYuF43j+3gKLdn/vM9H59yV3foqp2Ad8KaaVYtYYhsLuTRwHk\nr7Bb7ShoKa2jqb57EtNyn2hzs3wG/07xZ4MY0AWOxZtA7PZ9e4xc85TdPp8VC21o\nNq8OhsneT/jv/PcP/mfYe6NLD+zWPqeEYKn275WMYsGDulVonOE9AiNRjXrCdeJ4\naiA5J3XtKjno7z2SCyI/bEdcb6Ex8RnAhWuvOtfkpTfYJKAWnjPqJHzLlid1lQmO\nRU2GFJrapFQSPcII9jmtxgb0qGo7SuePluVAEFQtNzCNcp7JQjmtXZqtxv6VaqdD\nolT0AKLJULKXOE3trqK/bFe8T0b52+TiW6p5pjHamS2WqMYpA1CrNOfcdcYAuC40\nwtma7wAFed9i8qZWnc9W5E88uetOsxlZtEYIqtfm1+tOlhH1Vo0ClBcudE6wF0Vk\nIROitTlv6FpO7oVOroXnjKCsMl8AecmUJB0GZXVHNgQ3rNla8bX1pjCyC/rCH5RF\niD2M3e9bReTB23NMSBOeLRRgLCI8WgESrNPs0rBo+brYKS7jHNh+lpNvUH2Szcxm\ng4//rSeVBizmLDi4u3V+vstBWon4+CESLeRBUuPEUeaLmZYU6XE56Q6lcc9FcCNQ\nS7dgSm7VILRNNxWEFKM3ILRot922avsVhKUJes/1pR4d54PFlRidAulMqiHiz4nb\nlIC3v9r/zcdyxL8GSh5hCVsj041tLA==\n=7Ltd\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f0a0a0a0a79f0289b2aff3830a95fb9ff0fe1347",
          "sha": "f0a0a0a0a79f0289b2aff3830a95fb9ff0fe1347",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f0a0a0a0a79f0289b2aff3830a95fb9ff0fe1347"
        }
      ],
      "message": "rpc: use private broadcast from sendrawtransaction RPC if -privatebroadcast is ON",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-11-14T09:31:30Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-02-01T15:11:04Z"
      },
      "sha": "486e1986f67036e29d87478d6be423586d935a43"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDNlNmI1YTllYzQ2MGU3NjNiNjI2MjRjNWNlYTcxNzg5NzVlODA0ZWI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "tree": {
        "sha": "133af4fb39ea2006ba537e2c0489285586bfe7f3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/133af4fb39ea2006ba537e2c0489285586bfe7f3"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 133af4fb39ea2006ba537e2c0489285586bfe7f3\nparent 486e1986f67036e29d87478d6be423586d935a43\nauthor Vasil Dimov <vd@FreeBSD.org> 1684336789 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1763112690 +0100\n\ntest: add functional test for private broadcast\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmkW9vMACgkQVN8G9ktV\ny79+pB/+LYAwE+muMUr8bCf2r2glcdKhBJbnw3zH8/Un1IxER1QrESwywfJCGkBg\nmvgJV3ICkTzgLdcq1NblNAr5u0mqj6qG0c+5RYHZGUvWTqO5eD5gjQIXWvpgs8tT\nyp+Hl3aJovlnvPPcql3pvVWZeKfuV9jr7Gn/7KlIB8QF+BAzXsDCkuCKo4upEa7i\nXUTO3tPuOp2dQaz407TxUnfzkTJeszVpO2U3epKvK4FSMHoZtS63+2SW3qHel3fP\nnrW3tFK8vhl+VPDGYUftOfkynqEgvw+qBEdpiaOgXPDhV+SDcuQcx10FJfLztY09\nuRazVgBwpAIWaob6KsbmE2/RiYv6Ahx+mcsDdVf1GNMvKy8p7ZdLysmEyZKR/xTQ\nxIj9gpCCK8pwJ2HqtD68IA/QXkqpqPiWHDFK+CqM2JLmS+MyzuFNPQ1vd5pG+mbZ\n9sFUEiDtWJ871zil8+ZYJ2/Pjm/nuepQJ4Byo9sUF7FxJ5IQa5MA1Y+XGLxWOnKq\nBoiHymp2AGWPKv0FuMctKNL3qHYapwprZ5q0j9sahh/ORKcmtAgpq2pbP/HEgPgM\nO7/mMKcGcQCYCgFfADnxMFe6EmyEu2tKLkyikMQdvZB1LdwAboCouH46G3rfcPnp\nkvR0xIYxeLQmkhLCdkaigoLWTugVaNaIkPBFAaK3nWx7uPHBCg6fivJWrnqayB7n\n7Y4LS69jVUSaxxfOCzaNJeKtTfLVFQOHZJLQpUlOEhWIG8c4gMpq8ShNveX5oUe3\nu8qkkawxZYQ4KuN8JkYrPdfINpu+Au3ebChpFbz9DD+jmaAVjvpQeRPdH0rDae9y\n+cskRBiYXbb8VkDZH5o7Djig6FO9RD4LFYTvrEIHIx58pydlmeQ4+pWjSHowsKTZ\njZdJArzbP1anpAaRYUMq8PSKUqMqUMGEoA+BVVaxtbcUv3pyAUd7hE7AgT+ypGU3\nWvg5tSU6WqLPgVhIFqcnUCrgSmCbaFV8GF027bGu8DHczvBFzJPEleUG3dlF0dqW\nUBOf+3iEN/3cce68iWvfZASQBnibvGvNVoyJ5/97jJFdltpgWKlpNPhD00TBGek2\n80ayuEp4mjRf5akqY1f7P7qtY7OgT4WIQnQf6BcT9cKl8Wrp3SNfXeP+fh4B5+G4\n9rRUfDHMg4ZGR2vM7ftktTM3ohgYOlLVxwBt18M+oAgrBdEbnc7LOrsY8I4kqLiy\n4BHK7KH7ktkl/cuyxnqU0UKCBan846DXda52k+2KfA+oeRRYB5KEifZlS5PqibTw\np1JuGPOxQg4nz9ri8aji8obi6z6Q1e358epaGmYaFoNOaPiohwpIL++ZPW5bapHF\nEulwHu+Q4hUTOagxBIQfd98b+SbTdA==\n=kl1g\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/486e1986f67036e29d87478d6be423586d935a43",
          "sha": "486e1986f67036e29d87478d6be423586d935a43",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/486e1986f67036e29d87478d6be423586d935a43"
        }
      ],
      "message": "test: add functional test for private broadcast",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-11-14T09:31:30Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-05-17T15:19:49Z"
      },
      "sha": "3e6b5a9ec460e763b62624c5cea7178975e804eb"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20938484719,
      "node_id": "HRFPE_lADOABII585-yiT2zwAAAATgB-vv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20938484719",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "created_at": "2025-11-14T09:34:30Z"
    },
    {
      "event": "commented",
      "id": 3531815161,
      "node_id": "IC_kwDOABII587Sgzj5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3531815161",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-14T09:34:54Z",
      "updated_at": "2025-11-14T09:34:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "`36ae854b1d...3e6b5a9ec4`: take https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2525677364",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-3531815161",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415"
    },
    {
      "event": "unlabeled",
      "id": 20940196131,
      "node_id": "UNLE_lADOABII585-yiT2zwAAAATgIgkj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20940196131",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-14T10:41:58Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1485310634",
      "pull_request_review_id": 1874263137,
      "id": 1485310634,
      "node_id": "PRRC_kwDOABII585YiAqq",
      "diff_hunk": "@@ -142,49 +141,58 @@ bool BCLog::Logger::DefaultShrinkDebugFile() const\n     return m_categories == BCLog::NONE;\n }\n \n-struct CLogCategoryDesc {\n-    BCLog::LogFlags flag;\n-    std::string category;\n-};\n-\n-const CLogCategoryDesc LogCategories[] =\n-{\n-    {BCLog::NONE, \"0\"},\n-    {BCLog::NONE, \"\"},\n-    {BCLog::NET, \"net\"},\n-    {BCLog::TOR, \"tor\"},\n-    {BCLog::MEMPOOL, \"mempool\"},\n-    {BCLog::HTTP, \"http\"},\n-    {BCLog::BENCH, \"bench\"},\n-    {BCLog::ZMQ, \"zmq\"},\n-    {BCLog::WALLETDB, \"walletdb\"},\n-    {BCLog::RPC, \"rpc\"},\n-    {BCLog::ESTIMATEFEE, \"estimatefee\"},\n-    {BCLog::ADDRMAN, \"addrman\"},\n-    {BCLog::SELECTCOINS, \"selectcoins\"},\n-    {BCLog::REINDEX, \"reindex\"},\n-    {BCLog::CMPCTBLOCK, \"cmpctblock\"},\n-    {BCLog::RAND, \"rand\"},\n-    {BCLog::PRUNE, \"prune\"},\n-    {BCLog::PROXY, \"proxy\"},\n-    {BCLog::MEMPOOLREJ, \"mempoolrej\"},\n-    {BCLog::LIBEVENT, \"libevent\"},\n-    {BCLog::COINDB, \"coindb\"},\n-    {BCLog::QT, \"qt\"},\n-    {BCLog::LEVELDB, \"leveldb\"},\n-    {BCLog::VALIDATION, \"validation\"},\n-    {BCLog::I2P, \"i2p\"},\n-    {BCLog::IPC, \"ipc\"},\n+static const std::map<std::string, BCLog::LogFlags> LOG_CATEGORIES_BY_STR{\n+    {\"0\", BCLog::NONE},\n+    {\"\", BCLog::NONE},\n+    {\"net\", BCLog::NET},\n+    {\"tor\", BCLog::TOR},\n+    {\"mempool\", BCLog::MEMPOOL},\n+    {\"http\", BCLog::HTTP},\n+    {\"bench\", BCLog::BENCH},\n+    {\"zmq\", BCLog::ZMQ},\n+    {\"walletdb\", BCLog::WALLETDB},\n+    {\"rpc\", BCLog::RPC},\n+    {\"estimatefee\", BCLog::ESTIMATEFEE},\n+    {\"addrman\", BCLog::ADDRMAN},\n+    {\"selectcoins\", BCLog::SELECTCOINS},\n+    {\"reindex\", BCLog::REINDEX},\n+    {\"cmpctblock\", BCLog::CMPCTBLOCK},\n+    {\"rand\", BCLog::RAND},\n+    {\"prune\", BCLog::PRUNE},\n+    {\"proxy\", BCLog::PROXY},\n+    {\"mempoolrej\", BCLog::MEMPOOLREJ},\n+    {\"libevent\", BCLog::LIBEVENT},\n+    {\"coindb\", BCLog::COINDB},\n+    {\"qt\", BCLog::QT},\n+    {\"leveldb\", BCLog::LEVELDB},\n+    {\"validation\", BCLog::VALIDATION},\n+    {\"i2p\", BCLog::I2P},\n+    {\"ipc\", BCLog::IPC},\n #ifdef DEBUG_LOCKCONTENTION\n-    {BCLog::LOCK, \"lock\"},\n+    {\"lock\", BCLog::LOCK},\n #endif\n-    {BCLog::UTIL, \"util\"},\n-    {BCLog::BLOCKSTORAGE, \"blockstorage\"},\n-    {BCLog::TXRECONCILIATION, \"txreconciliation\"},\n-    {BCLog::SCAN, \"scan\"},\n-    {BCLog::TXPACKAGES, \"txpackages\"},\n-    {BCLog::ALL, \"1\"},\n-    {BCLog::ALL, \"all\"},\n+    {\"util\", BCLog::UTIL},",
      "path": "src/logging.cpp",
      "position": 1,
      "original_position": 86,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "2b05af27608f9e4e9a1b5f5c83c7870a8e6c9425",
      "in_reply_to_id": null,
      "user": {
        "login": "davidgumberg",
        "id": 2257631,
        "node_id": "MDQ6VXNlcjIyNTc2MzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2257631?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/davidgumberg",
        "html_url": "https://github.com/davidgumberg",
        "followers_url": "https://api.github.com/users/davidgumberg/followers",
        "following_url": "https://api.github.com/users/davidgumberg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/davidgumberg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/davidgumberg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/davidgumberg/subscriptions",
        "organizations_url": "https://api.github.com/users/davidgumberg/orgs",
        "repos_url": "https://api.github.com/users/davidgumberg/repos",
        "events_url": "https://api.github.com/users/davidgumberg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/davidgumberg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "While touching this, maybe `BCLog::UTIL` which is not used since https://github.com/bitcoin/bitcoin/pull/27896 should be dropped?",
      "created_at": "2024-02-10T21:48:08Z",
      "updated_at": "2024-02-10T21:50:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1485310634",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1485310634"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 174,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1485605463",
      "pull_request_review_id": 1874379420,
      "id": 1485605463,
      "node_id": "PRRC_kwDOABII585YjIpX",
      "diff_hunk": "@@ -142,49 +141,58 @@ bool BCLog::Logger::DefaultShrinkDebugFile() const\n     return m_categories == BCLog::NONE;\n }\n \n-struct CLogCategoryDesc {\n-    BCLog::LogFlags flag;\n-    std::string category;\n-};\n-\n-const CLogCategoryDesc LogCategories[] =\n-{\n-    {BCLog::NONE, \"0\"},\n-    {BCLog::NONE, \"\"},\n-    {BCLog::NET, \"net\"},\n-    {BCLog::TOR, \"tor\"},\n-    {BCLog::MEMPOOL, \"mempool\"},\n-    {BCLog::HTTP, \"http\"},\n-    {BCLog::BENCH, \"bench\"},\n-    {BCLog::ZMQ, \"zmq\"},\n-    {BCLog::WALLETDB, \"walletdb\"},\n-    {BCLog::RPC, \"rpc\"},\n-    {BCLog::ESTIMATEFEE, \"estimatefee\"},\n-    {BCLog::ADDRMAN, \"addrman\"},\n-    {BCLog::SELECTCOINS, \"selectcoins\"},\n-    {BCLog::REINDEX, \"reindex\"},\n-    {BCLog::CMPCTBLOCK, \"cmpctblock\"},\n-    {BCLog::RAND, \"rand\"},\n-    {BCLog::PRUNE, \"prune\"},\n-    {BCLog::PROXY, \"proxy\"},\n-    {BCLog::MEMPOOLREJ, \"mempoolrej\"},\n-    {BCLog::LIBEVENT, \"libevent\"},\n-    {BCLog::COINDB, \"coindb\"},\n-    {BCLog::QT, \"qt\"},\n-    {BCLog::LEVELDB, \"leveldb\"},\n-    {BCLog::VALIDATION, \"validation\"},\n-    {BCLog::I2P, \"i2p\"},\n-    {BCLog::IPC, \"ipc\"},\n+static const std::map<std::string, BCLog::LogFlags> LOG_CATEGORIES_BY_STR{\n+    {\"0\", BCLog::NONE},\n+    {\"\", BCLog::NONE},\n+    {\"net\", BCLog::NET},\n+    {\"tor\", BCLog::TOR},\n+    {\"mempool\", BCLog::MEMPOOL},\n+    {\"http\", BCLog::HTTP},\n+    {\"bench\", BCLog::BENCH},\n+    {\"zmq\", BCLog::ZMQ},\n+    {\"walletdb\", BCLog::WALLETDB},\n+    {\"rpc\", BCLog::RPC},\n+    {\"estimatefee\", BCLog::ESTIMATEFEE},\n+    {\"addrman\", BCLog::ADDRMAN},\n+    {\"selectcoins\", BCLog::SELECTCOINS},\n+    {\"reindex\", BCLog::REINDEX},\n+    {\"cmpctblock\", BCLog::CMPCTBLOCK},\n+    {\"rand\", BCLog::RAND},\n+    {\"prune\", BCLog::PRUNE},\n+    {\"proxy\", BCLog::PROXY},\n+    {\"mempoolrej\", BCLog::MEMPOOLREJ},\n+    {\"libevent\", BCLog::LIBEVENT},\n+    {\"coindb\", BCLog::COINDB},\n+    {\"qt\", BCLog::QT},\n+    {\"leveldb\", BCLog::LEVELDB},\n+    {\"validation\", BCLog::VALIDATION},\n+    {\"i2p\", BCLog::I2P},\n+    {\"ipc\", BCLog::IPC},\n #ifdef DEBUG_LOCKCONTENTION\n-    {BCLog::LOCK, \"lock\"},\n+    {\"lock\", BCLog::LOCK},\n #endif\n-    {BCLog::UTIL, \"util\"},\n-    {BCLog::BLOCKSTORAGE, \"blockstorage\"},\n-    {BCLog::TXRECONCILIATION, \"txreconciliation\"},\n-    {BCLog::SCAN, \"scan\"},\n-    {BCLog::TXPACKAGES, \"txpackages\"},\n-    {BCLog::ALL, \"1\"},\n-    {BCLog::ALL, \"all\"},\n+    {\"util\", BCLog::UTIL},",
      "path": "src/logging.cpp",
      "position": 1,
      "original_position": 86,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "2b05af27608f9e4e9a1b5f5c83c7870a8e6c9425",
      "in_reply_to_id": 1485310634,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done in https://github.com/bitcoin/bitcoin/pull/29419, thanks for the suggestion!",
      "created_at": "2024-02-11T14:28:49Z",
      "updated_at": "2024-02-11T14:28:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1485605463",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1485605463"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 174,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517972760",
      "pull_request_review_id": 1925311361,
      "id": 1517972760,
      "node_id": "PRRC_kwDOABII585aem0Y",
      "diff_hunk": "@@ -70,6 +70,7 @@ namespace BCLog {\n         TXRECONCILIATION = (1 << 27),\n         SCAN        = (1 << 28),\n         TXPACKAGES  = (1 << 29),\n+        PRIVATE_BROADCAST = (1 << 30),",
      "path": "src/logging.h",
      "position": 1,
      "original_position": 4,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e672e55ddb49378bd5c8e4f03fadae5774310c70",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "e672e55ddb49378bd5c8e4f03fadae5774310c70 does this mean there is only one bit left in `LogFlags : uint32_t` ?!",
      "created_at": "2024-03-08T16:42:11Z",
      "updated_at": "2024-03-08T20:59:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1517972760",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517972760"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 73,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517981961",
      "pull_request_review_id": 1925311361,
      "id": 1517981961,
      "node_id": "PRRC_kwDOABII585aepEJ",
      "diff_hunk": "@@ -1900,6 +1911,23 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        if (!g_reachable_nets.Contains(NET_I2P) && !g_reachable_nets.Contains(NET_ONION) &&\n+            (!listenonion || args.IsArgSet(\"-onlynet\"))) {",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 52,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "72f0dbc99e6eed26bef21965dabc5f0bebf01b33",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "72f0dbc99e6eed26bef21965dabc5f0bebf01b33 if user sets `-onlynet=onion` do we require (by the time we get to this line) that NET_ONION is reachable? Or couldn't it come up later, similar to the `-listenonion` configuration?",
      "created_at": "2024-03-08T16:50:30Z",
      "updated_at": "2024-03-08T20:59:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1517981961",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1517981961"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1961,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518063388",
      "pull_request_review_id": 1925311361,
      "id": 1518063388,
      "node_id": "PRRC_kwDOABII585ae88c",
      "diff_hunk": "@@ -452,6 +452,7 @@ class NetinfoRequestHandler : public BaseRequestHandler\n         if (conn_type == \"block-relay-only\") return \"block\";\n         if (conn_type == \"manual\" || conn_type == \"feeler\") return conn_type;\n         if (conn_type == \"addr-fetch\") return \"addr\";\n+        if (conn_type == \"private-broadcast\") return \"privbcast\";",
      "path": "src/bitcoin-cli.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "7a0f492104c1621b7089a64fa330c72b06d30574",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "7a0f492104c1621b7089a64fa330c72b06d30574 `\"privbcast\"` needs to be <= 6 characters to fit nicely in the table layout, or you could extend the column width:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/1cd2e29870e4ad3b7c57b1d567df0e6df56572b0/src/bitcoin-cli.cpp#L549-L552",
      "created_at": "2024-03-08T17:51:51Z",
      "updated_at": "2024-03-08T20:59:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1518063388",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518063388"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 455,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518080397",
      "pull_request_review_id": 1925311361,
      "id": 1518080397,
      "node_id": "PRRC_kwDOABII585afBGN",
      "diff_hunk": "@@ -75,6 +75,13 @@ enum class ConnectionType {\n      * AddrMan is empty.\n      */\n     ADDR_FETCH,\n+\n+    /**\n+     * Private broadcast connections are short-lived and only opened to\n+     * privacy networks (Tor, I2P) for relaying privacy-sensitive data (like\n+     * our own transactions) and closed afterwards.\n+     */\n+    PRIVATE_BROADCAST,",
      "path": "src/node/connection_types.h",
      "position": 10,
      "original_position": 10,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "7a0f492104c1621b7089a64fa330c72b06d30574",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "7a0f492104c1621b7089a64fa330c72b06d30574 I noticed this wasn't added to the fuzzer, dunno if it needs to be:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/1cd2e29870e4ad3b7c57b1d567df0e6df56572b0/src/test/util/net.h#L112-L119",
      "created_at": "2024-03-08T18:06:46Z",
      "updated_at": "2024-03-08T20:59:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1518080397",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518080397"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 84,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518132032",
      "pull_request_review_id": 1925311361,
      "id": 1518132032,
      "node_id": "PRRC_kwDOABII585afNtA",
      "diff_hunk": "@@ -456,7 +456,7 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         if (addrConnect.IsI2P() && use_proxy) {\n             i2p::Connection conn;\n \n-            if (m_i2p_sam_session) {\n+            if (m_i2p_sam_session && conn_type != ConnectionType::PRIVATE_BROADCAST) {",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 5,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4e19f9cc9834c0b76a2d03fea0921879de46fea9",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "4e19f9cc9834c0b76a2d03fea0921879de46fea9 Just to clarify: if a i2p sam session already exists, normally we would re-use it. But in the case of private broadcast we force a new transient session? Comment might be nice here.",
      "created_at": "2024-03-08T18:38:29Z",
      "updated_at": "2024-03-08T20:59:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1518132032",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518132032"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 494,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518175963",
      "pull_request_review_id": 1925311361,
      "id": 1518175963,
      "node_id": "PRRC_kwDOABII585afYbb",
      "diff_hunk": "@@ -2413,6 +2413,63 @@ bool CConnman::MaybePickPreferredNetwork(std::optional<Network>& network)\n     return false;\n }\n \n+/**\n+ * Decide whether to open a private broadcast connection and if yes, to which network.\n+ * @param[in,out] net If the previous attempt to open a connection was an attempt to\n+ * open a private broadcast connection (successful or not), then this should have a\n+ * value. When the function ends if this has value then it will contain the network\n+ * to which to open the connection.\n+ * @param[in] num_needed Number of private broadcast connections that need to be opened.\n+ * @param[in] num_opened Number of private broadcast connections that are currently opened.\n+ */\n+static void MaybePickPrivateBroadcastNetwork(std::optional<Network>& net, size_t num_needed, size_t num_opened)\n+{\n+    if (net.has_value()) {\n+        // Yield to other connection types.\n+        net = std::nullopt;\n+        return;\n+    }\n+\n+    if (num_needed == 0) {\n+        net = std::nullopt;\n+        return;\n+    }\n+\n+    if (num_opened >= MAX_PRIVATE_BROADCAST_CONNECTIONS) {\n+        LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                      BCLog::Level::Debug,\n+                      \"Requested to open %d connection(s), but there are already %d \"\n+                      \"connections opened. Will wait for some of them to be closed \"\n+                      \"before opening a new one\\n\",\n+                      num_needed,\n+                      num_opened);\n+        net = std::nullopt;\n+        return;\n+    }\n+\n+    const bool tor_reachable{g_reachable_nets.Contains(NET_ONION)};\n+    const bool i2p_reachable{g_reachable_nets.Contains(NET_I2P)};\n+    if (tor_reachable && i2p_reachable) {\n+        net = FastRandomContext{}.randbool() ? NET_ONION : NET_I2P;\n+    } else if (tor_reachable) {\n+        net = NET_ONION;\n+    } else if (i2p_reachable) {\n+        net = NET_I2P;\n+    } else {\n+        LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                      BCLog::Level::Warning,\n+                      \"Requested to open %d connection(s) but none of the Tor or I2P networks is reachable.\\n\",\n+                      num_needed);\n+        net = std::nullopt;\n+        return;\n+    }\n+\n+    LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                  BCLog::Level::Debug,\n+                  \"Requested to open %d connection(s), trying to open one\\n\",\n+                  num_needed);",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 67,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4e19f9cc9834c0b76a2d03fea0921879de46fea9",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "4e19f9cc9834c0b76a2d03fea0921879de46fea9 Feels like this log message is not in the right place since this function does not try to open a connection.",
      "created_at": "2024-03-08T19:01:46Z",
      "updated_at": "2024-03-08T20:59:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1518175963",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518175963"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 2467,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2465,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518178949",
      "pull_request_review_id": 1925311361,
      "id": 1518178949,
      "node_id": "PRRC_kwDOABII585afZKF",
      "diff_hunk": "@@ -2886,6 +2964,16 @@ void CConnman::OpenNetworkConnection(const CAddress& addrConnect, bool fCountFai\n         return;\n     pnode->grantOutbound = std::move(grant_outbound);\n \n+    if (conn_type == ConnectionType::PRIVATE_BROADCAST) {\n+        const size_t before_sub{m_private_broadcast_connections_to_open.fetch_sub(1)};",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 170,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4e19f9cc9834c0b76a2d03fea0921879de46fea9",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "4e19f9cc9834c0b76a2d03fea0921879de46fea9 does this need underflow protection? Just like an `Assume()` even?",
      "created_at": "2024-03-08T19:04:52Z",
      "updated_at": "2024-03-08T20:59:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1518178949",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518178949"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3054,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518194970",
      "pull_request_review_id": 1925311361,
      "id": 1518194970,
      "node_id": "PRRC_kwDOABII585afdEa",
      "diff_hunk": "@@ -2051,7 +2065,7 @@ NodeClock::time_point CWallet::GetDefaultNextResend() { return FastRandomContext\n // that depends on the `relay` option. Periodic rebroadcast uses the pattern\n // relay=true force=false, while loading into the mempool\n // (on start, or after import) uses relay=false force=true.\n-void CWallet::ResubmitWalletTransactions(bool relay, bool force)\n+void CWallet::ResubmitWalletTransactions(TxBroadcastMethod broadcast_method, bool force)",
      "path": "src/wallet/wallet.cpp",
      "position": 1,
      "original_position": 46,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "532e63279a3c04fef8da2c1bb95e5280c94abc4e",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "532e63279a3c04fef8da2c1bb95e5280c94abc4e consider rephrasing the comment on the previous line since `relay=true` isn't a thing any more?",
      "created_at": "2024-03-08T19:22:32Z",
      "updated_at": "2024-03-08T20:59:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1518194970",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518194970"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2069,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518225842",
      "pull_request_review_id": 1925311361,
      "id": 1518225842,
      "node_id": "PRRC_kwDOABII585afkmy",
      "diff_hunk": "@@ -1083,6 +1087,62 @@ class PeerManagerImpl final : public PeerManager\n \n     void AddAddressKnown(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n     void PushAddress(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n+\n+    /**\n+     * Store a list of transactions to be broadcast privately. Supports the following operations:\n+     * - Add a new transaction\n+     * - Remove a transaction, after it has been seen by the network\n+     * - Mark a broadcast of a transaction (remember when and how many times)\n+     * - Get a transaction for broadcast, the one that has been broadcast less times and least recently\n+     */\n+    class PrivateBroadcast\n+    {\n+    public:\n+        void Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+        {\n+            const Txid& txid = tx->GetHash();\n+            LOCK(m_mutex);\n+            auto [pos, inserted] = m_by_txid.emplace(txid, TxWithPriority{.tx = tx, .priority = Priority{}});\n+            if (inserted) {\n+                m_by_priority.emplace(Priority{}, txid);\n+            }\n+        }\n+\n+    private:\n+        struct Priority {\n+            size_t num_broadcasted{0};\n+            std::chrono::microseconds last_broadcasted{0};\n+\n+            bool operator<(const Priority& other) const\n+            {\n+                if (num_broadcasted < other.num_broadcasted) {\n+                    return true;\n+                }\n+                return last_broadcasted < other.last_broadcasted;\n+            }\n+        };\n+\n+        struct TxWithPriority {\n+            CTransactionRef tx;\n+            Priority priority;\n+        };\n+\n+        struct TxidHasher {\n+            size_t operator()(const Txid& txid) const { return SipHashUint256(0, 0, txid.ToUint256()); }",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 63,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "eb9d7386ca82319ab682fc20ab35c13340d108a4",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "eb9d7386ca82319ab682fc20ab35c13340d108a4 Hashing a hash? Does this just make the `std::unordered_map` lookups faster because the keys are smaller (looks like 64 bits?)",
      "created_at": "2024-03-08T19:47:41Z",
      "updated_at": "2024-03-08T20:59:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1518225842",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518225842"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1236,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518256562",
      "pull_request_review_id": 1925311361,
      "id": 1518256562,
      "node_id": "PRRC_kwDOABII585afsGy",
      "diff_hunk": "@@ -1108,6 +1116,71 @@ class PeerManagerImpl final : public PeerManager\n             }\n         }\n \n+        /**\n+         * Get the transaction that has been broadcast less times and least recently.\n+         */\n+        std::optional<CTransactionRef> GetTxForBroadcast() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+        {\n+            LOCK(m_mutex);\n+            if (m_by_priority.empty()) {\n+                return std::nullopt;\n+            }\n+            const Txid& txid = m_by_priority.begin()->second;\n+            auto it = m_by_txid.find(txid);\n+            if (it == m_by_txid.end()) {\n+                return std::nullopt;",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 42,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "07dee91112189be02c6694385de261570725b56b",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "07dee91112189be02c6694385de261570725b56b this would be unexpected if we had the txid in the priority list but not in the actual txid list, right? Maybe we should at least remove the txid from the priority list if this ever happens, or log something, or like, call the police or something?",
      "created_at": "2024-03-08T20:23:23Z",
      "updated_at": "2024-03-08T20:59:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1518256562",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518256562"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1150,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518263617",
      "pull_request_review_id": 1925311361,
      "id": 1518263617,
      "node_id": "PRRC_kwDOABII585aft1B",
      "diff_hunk": "@@ -1566,26 +1665,53 @@ void PeerManagerImpl::FindNextBlocks(std::vector<const CBlockIndex*>& vBlocks, c\n \n void PeerManagerImpl::PushNodeVersion(CNode& pnode, const Peer& peer)\n {\n-    uint64_t my_services{peer.m_our_services};\n-    const int64_t nTime{count_seconds(GetTime<std::chrono::seconds>())};\n-    uint64_t nonce = pnode.GetLocalNonce();\n-    const int nNodeStartingHeight{m_best_height};\n-    NodeId nodeid = pnode.GetId();\n-    CAddress addr = pnode.addr;\n-\n-    CService addr_you = addr.IsRoutable() && !IsProxy(addr) && addr.IsAddrV1Compatible() ? addr : CService();\n-    uint64_t your_services{addr.nServices};\n-\n-    const bool tx_relay{!RejectIncomingTxs(pnode)};\n-    MakeAndPushMessage(pnode, NetMsgType::VERSION, PROTOCOL_VERSION, my_services, nTime,\n-            your_services, CNetAddr::V1(addr_you), // Together the pre-version-31402 serialization of CAddress \"addrYou\" (without nTime)\n-            my_services, CNetAddr::V1(CService{}), // Together the pre-version-31402 serialization of CAddress \"addrMe\" (without nTime)\n-            nonce, strSubVersion, nNodeStartingHeight, tx_relay);\n-\n+    uint64_t my_services;\n+    int64_t my_time;\n+    uint64_t your_services;\n+    CService your_addr;\n+    std::string my_user_agent;\n+    int my_height;\n+    bool my_tx_relay;\n+    if (pnode.IsPrivateBroadcastConn()) {\n+        my_services = NODE_NONE;\n+        my_time = 0;\n+        your_services = NODE_NONE;\n+        your_addr = CService{};\n+        my_user_agent = \"/pynode:0.0.1/\";",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 172,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "07dee91112189be02c6694385de261570725b56b",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "07dee91112189be02c6694385de261570725b56b could this just be blank?",
      "created_at": "2024-03-08T20:32:24Z",
      "updated_at": "2024-03-08T20:59:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1518263617",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518263617"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1528,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518279844",
      "pull_request_review_id": 1925311361,
      "id": 1518279844,
      "node_id": "PRRC_kwDOABII585afxyk",
      "diff_hunk": "@@ -3706,7 +3885,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                       (mapped_as ? strprintf(\", mapped_as=%d\", mapped_as) : \"\"));\n         }\n \n-        if (pfrom.GetCommonVersion() >= SHORT_IDS_BLOCKS_VERSION) {\n+        if (pfrom.GetCommonVersion() >= SHORT_IDS_BLOCKS_VERSION && !pfrom.IsPrivateBroadcastConn()) {",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 291,
      "commit_id": "7547f915bc6cb0425b46234df486e0de34cad3b3",
      "original_commit_id": "07dee91112189be02c6694385de261570725b56b",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "07dee91112189be02c6694385de261570725b56b do you need this here? I thought you had filtered out all the unnecessary messages already in `CConnman::PushMessage()`",
      "created_at": "2024-03-08T20:52:20Z",
      "updated_at": "2024-03-08T20:59:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1518279844",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518279844"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3859,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518282738",
      "pull_request_review_id": 1925311361,
      "id": 1518282738,
      "node_id": "PRRC_kwDOABII585afyfy",
      "diff_hunk": "@@ -4929,6 +5133,16 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                     if (ping_time.count() >= 0) {\n                         // Let connman know about this successful ping-pong\n                         pfrom.PongReceived(ping_time);\n+                        if (pfrom.IsPrivateBroadcastConn()) {\n+                            m_tx_for_private_broadcast.BroadcastEnd(pfrom.GetId(), /*confirmed_by_node=*/true);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 339,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "07dee91112189be02c6694385de261570725b56b",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "07dee91112189be02c6694385de261570725b56b `BroadcastEnd()` returns a `bool`, seems like you could include that in the log message where you have the word \"probably\"",
      "created_at": "2024-03-08T20:55:54Z",
      "updated_at": "2024-03-08T20:59:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1518282738",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1518282738"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 5357,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519402830",
      "pull_request_review_id": 1927346768,
      "id": 1519402830,
      "node_id": "PRRC_kwDOABII585akD9O",
      "diff_hunk": "@@ -452,6 +452,7 @@ class NetinfoRequestHandler : public BaseRequestHandler\n         if (conn_type == \"block-relay-only\") return \"block\";",
      "path": "src/bitcoin-cli.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "6fad02cf03d6b37d0a22443a411ec92649b1d39d",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "From the PR main thread https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-1986011938:\r\n\r\n> The private broadcast succeeds frequently but not always\r\n\r\nIn the originator's log you can check to whom is the transaction being sent. Then in the recipient's logs you can check if it was accepted and further broadcast to everybody. Enable `-debug=net -debug=privatebroadcast`.",
      "created_at": "2024-03-11T09:35:14Z",
      "updated_at": "2024-03-11T09:35:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1519402830",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519402830"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 452,
      "original_line": 452,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519831611",
      "pull_request_review_id": 1928014516,
      "id": 1519831611,
      "node_id": "PRRC_kwDOABII585also7",
      "diff_hunk": "@@ -70,6 +70,7 @@ namespace BCLog {\n         TXRECONCILIATION = (1 << 27),\n         SCAN        = (1 << 28),\n         TXPACKAGES  = (1 << 29),\n+        PRIVATE_BROADCAST = (1 << 30),",
      "path": "src/logging.h",
      "position": 1,
      "original_position": 4,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e672e55ddb49378bd5c8e4f03fadae5774310c70",
      "in_reply_to_id": 1517972760,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes. `LogFlags` is not stored on disk (I hope!) or participate in some permanent on-disk format. It is memory only and can be flipped to `uint64_t` when needed.",
      "created_at": "2024-03-11T14:37:03Z",
      "updated_at": "2024-03-11T14:37:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1519831611",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1519831611"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 73,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520116658",
      "pull_request_review_id": 1928519119,
      "id": 1520116658,
      "node_id": "PRRC_kwDOABII585amyOy",
      "diff_hunk": "@@ -1900,6 +1911,23 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        if (!g_reachable_nets.Contains(NET_I2P) && !g_reachable_nets.Contains(NET_ONION) &&\n+            (!listenonion || args.IsArgSet(\"-onlynet\"))) {",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 52,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "72f0dbc99e6eed26bef21965dabc5f0bebf01b33",
      "in_reply_to_id": 1517981961,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> if user sets `-onlynet=onion` do we require (by the time we get to this line) that NET_ONION is reachable?\r\n\r\nNo. `-listen=1 -listenonion=1 -torcontrol=... -torpassword=... -onlynet=onion` would get us here with `NET_ONION` being unreachable.\r\n\r\n> Or couldn't it come up later, similar to the `-listenonion` configuration?\r\n\r\nYes, if `-listenonion=1 -torcontrol=... -torpassword=...` is given then we will later, after startup, connect to the Tor daemon and possibly make `NET_ONION` reachable.",
      "created_at": "2024-03-11T17:15:17Z",
      "updated_at": "2024-03-11T17:15:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1520116658",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520116658"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1961,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520122930",
      "pull_request_review_id": 1928530676,
      "id": 1520122930,
      "node_id": "PRRC_kwDOABII585amzwy",
      "diff_hunk": "@@ -4499,6 +4515,16 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         const uint256& hash = peer->m_wtxid_relay ? wtxid : txid;\n         AddKnownTx(*peer, hash);\n \n+        if (m_tx_for_private_broadcast.Remove(ptx)) {",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "bc05ddc7b9369cf263bf88d0a773ca853d3c9af5",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "bc05ddc7b9369cf263bf88d0a773ca853d3c9af5 maybe I'm missing something, but should we not also adjust `m_private_broadcast_connections_to_open` when we get our privately broadcast tx back over regular relay? In my first local test, all 5 onion connections were completed before I got the tx back. But if the very first private connection relays the tx around and we get it back, do we still need to bother with the next 4?",
      "created_at": "2024-03-11T17:19:46Z",
      "updated_at": "2024-03-11T17:19:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1520122930",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520122930"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4663,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520128211",
      "pull_request_review_id": 1928539673,
      "id": 1520128211,
      "node_id": "PRRC_kwDOABII585am1DT",
      "diff_hunk": "@@ -1900,6 +1911,23 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        if (!g_reachable_nets.Contains(NET_I2P) && !g_reachable_nets.Contains(NET_ONION) &&\n+            (!listenonion || args.IsArgSet(\"-onlynet\"))) {",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 52,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "72f0dbc99e6eed26bef21965dabc5f0bebf01b33",
      "in_reply_to_id": 1517981961,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "ok so then isn't it possible for a user to start with `-privatebroadcast` but i2p and onion aren't reachable *yet*? They would get an init error but the Tor daemon could become reachable later, by the time we need it.",
      "created_at": "2024-03-11T17:23:32Z",
      "updated_at": "2024-03-11T17:23:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1520128211",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520128211"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1961,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520139562",
      "pull_request_review_id": 1928558982,
      "id": 1520139562,
      "node_id": "PRRC_kwDOABII585am30q",
      "diff_hunk": "@@ -2657,7 +2733,9 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n             CAddress addr;\n             NodeSeconds addr_last_try{0s};\n \n-            if (fFeeler) {\n+            if (open_private_broadcast_to.has_value()) {\n+                std::tie(addr, addr_last_try) = addrman.Select(/*new_only=*/false, open_private_broadcast_to.value());",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 160,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4e19f9cc9834c0b76a2d03fea0921879de46fea9",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "4e19f9cc9834c0b76a2d03fea0921879de46fea9 what if `MaybePickPrivateBroadcastNetwork()` chooses i2p but we don't have any addrs for that network? I think the `while` loop below may try forever until addrman finally has something for i2p? But we *could* call `MaybePickPrivateBroadcastNetwork()` again or just switch to Tor if we know we have addrs there.",
      "created_at": "2024-03-11T17:31:42Z",
      "updated_at": "2024-03-11T18:41:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1520139562",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520139562"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2761,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520152548",
      "pull_request_review_id": 1928558982,
      "id": 1520152548,
      "node_id": "PRRC_kwDOABII585am6_k",
      "diff_hunk": "@@ -1797,10 +1820,56 @@ void PeerManagerImpl::ReattemptInitialBroadcast(CScheduler& scheduler)\n         }\n     }\n \n-    // Schedule next run for 10-15 minutes in the future.\n-    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n-    const std::chrono::milliseconds delta = 10min + GetRandMillis(5min);\n-    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, delta);\n+    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, NextTxBroadcast());\n+}\n+\n+void PeerManagerImpl::ReattemptPrivateBroadcast(CScheduler& scheduler)\n+{\n+    // The following heuristic is subject to races, but that is ok: if it overshoots,\n+    // we will open some private connections in vain, if it undershoots, the stale\n+    // transactions will be picked on the next run.\n+\n+    size_t num_active{0};\n+    m_connman.ForEachNode([&num_active](const CNode* node) {\n+        if (node->IsPrivateBroadcastConn()) {\n+            ++num_active;\n+        }\n+    });\n+\n+    const size_t num_to_open{m_connman.NumPrivateBroadcastToOpen()};\n+\n+    // Remove stale transactions that are no longer relevant (e.g. already in\n+    // the mempool or mined) and count the remaining ones.\n+    size_t num_stale{0};\n+    const auto stale_txs = m_tx_for_private_broadcast.GetStale();\n+    {\n+        LOCK(cs_main);\n+        for (const auto& stale_tx : stale_txs) {\n+            auto mempool_acceptable = m_chainman.ProcessTransaction(stale_tx, /*test_accept=*/true);\n+            if (mempool_acceptable.m_result_type == MempoolAcceptResult::ResultType::VALID) {\n+                LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                              BCLog::Level::Debug,\n+                              \"Reattempting broadcast of stale txid=%s wtxid=%s\\n\",\n+                              stale_tx->GetHash().ToString(),\n+                              stale_tx->GetWitnessHash().ToString());\n+                ++num_stale;\n+            } else {\n+                LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                              BCLog::Level::Info,\n+                              \"Giving up broadcast attempts for txid=%s wtxid=%s: %s\\n\",\n+                              stale_tx->GetHash().ToString(),\n+                              stale_tx->GetWitnessHash().ToString(),\n+                              mempool_acceptable.m_state.ToString());\n+                m_tx_for_private_broadcast.Remove(stale_tx);\n+            }\n+        }\n+    }\n+\n+    if (num_stale > num_active + num_to_open) {",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 97,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "c09d6409c957af7c449a60778689d6715d9a6628",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "c09d6409c957af7c449a60778689d6715d9a6628 `num_stale` is a count of transactions but the other two numbers here count p2p connections, are we still going to use `NUM_PRIVATE_BROADCAST_PER_TX` here?",
      "created_at": "2024-03-11T17:40:18Z",
      "updated_at": "2024-03-11T18:41:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1520152548",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520152548"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1901,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520180548",
      "pull_request_review_id": 1928640468,
      "id": 1520180548,
      "node_id": "PRRC_kwDOABII585anB1E",
      "diff_hunk": "@@ -452,6 +452,7 @@ class NetinfoRequestHandler : public BaseRequestHandler\n         if (conn_type == \"block-relay-only\") return \"block\";\n         if (conn_type == \"manual\" || conn_type == \"feeler\") return conn_type;\n         if (conn_type == \"addr-fetch\") return \"addr\";\n+        if (conn_type == \"private-broadcast\") return \"privbcast\";",
      "path": "src/bitcoin-cli.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "7a0f492104c1621b7089a64fa330c72b06d30574",
      "in_reply_to_id": 1518063388,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Changed to `privat`. Feel free to suggest another name.",
      "created_at": "2024-03-11T17:54:41Z",
      "updated_at": "2024-03-11T17:54:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1520180548",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520180548"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 455,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520182217",
      "pull_request_review_id": 1928643867,
      "id": 1520182217,
      "node_id": "PRRC_kwDOABII585anCPJ",
      "diff_hunk": "@@ -75,6 +75,13 @@ enum class ConnectionType {\n      * AddrMan is empty.\n      */\n     ADDR_FETCH,\n+\n+    /**\n+     * Private broadcast connections are short-lived and only opened to\n+     * privacy networks (Tor, I2P) for relaying privacy-sensitive data (like\n+     * our own transactions) and closed afterwards.\n+     */\n+    PRIVATE_BROADCAST,",
      "path": "src/node/connection_types.h",
      "position": 10,
      "original_position": 10,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "7a0f492104c1621b7089a64fa330c72b06d30574",
      "in_reply_to_id": 1518080397,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Good catch, added!",
      "created_at": "2024-03-11T17:55:04Z",
      "updated_at": "2024-03-11T17:55:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1520182217",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520182217"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 84,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520183380",
      "pull_request_review_id": 1928646551,
      "id": 1520183380,
      "node_id": "PRRC_kwDOABII585anChU",
      "diff_hunk": "@@ -456,7 +456,7 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         if (addrConnect.IsI2P() && use_proxy) {\n             i2p::Connection conn;\n \n-            if (m_i2p_sam_session) {\n+            if (m_i2p_sam_session && conn_type != ConnectionType::PRIVATE_BROADCAST) {",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 5,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4e19f9cc9834c0b76a2d03fea0921879de46fea9",
      "in_reply_to_id": 1518132032,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes. Added a comment.",
      "created_at": "2024-03-11T17:55:22Z",
      "updated_at": "2024-03-11T17:55:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1520183380",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520183380"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 494,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520191910",
      "pull_request_review_id": 1928558982,
      "id": 1520191910,
      "node_id": "PRRC_kwDOABII585anEmm",
      "diff_hunk": "@@ -89,11 +91,14 @@ static RPCHelpMan sendrawtransaction()\n             std::string err_string;\n             AssertLockNotHeld(cs_main);\n             NodeContext& node = EnsureAnyNodeContext(request.context);\n+            const auto method = gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST) ?\n+                                    NO_MEMPOOL_PRIVATE_BROADCAST :",
      "path": "src/rpc/mempool.cpp",
      "position": 1,
      "original_position": 16,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e36a1b4848f8f762b550a9469993211d41bd6cb9",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "e36a1b4848f8f762b550a9469993211d41bd6cb9 heh, makes the placement of this function in `mempool.cpp` a bit arbitrary now!",
      "created_at": "2024-03-11T17:59:08Z",
      "updated_at": "2024-03-11T18:42:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1520191910",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520191910"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 95,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520210992",
      "pull_request_review_id": 1928558982,
      "id": 1520210992,
      "node_id": "PRRC_kwDOABII585anJQw",
      "diff_hunk": "@@ -117,6 +128,33 @@ def handle(self):\n             cmdin = Socks5Command(cmd, atyp, addr, port, username, password)\n             self.serv.queue.put(cmdin)\n             logger.debug('Proxy: %s', cmdin)\n+",
      "path": "test/functional/test_framework/socks5.py",
      "position": 1,
      "original_position": 29,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "2b2e747455699236200fa3cddddfff7005f6a44a",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "2b2e747455699236200fa3cddddfff7005f6a44a Could be overkill, but you could actually adjust the \"dummy response\" a few lines up to actually respond accurately, in particular the `REPLY` field could be used to report a connection failure back to bitcoind.\r\n\r\nFrom https://www.rfc-editor.org/rfc/rfc1928\r\n\r\n```diff\r\ndiff --git a/test/functional/test_framework/socks5.py b/test/functional/test_framework/socks5.py\r\nindex 48ad8bbeea..568e9fa64c 100644\r\n--- a/test/functional/test_framework/socks5.py\r\n+++ b/test/functional/test_framework/socks5.py\r\n@@ -123,7 +123,14 @@ class Socks5Connection():\r\n             port = (port_hi << 8) | port_lo\r\n \r\n             # Send dummy response\r\n-            self.conn.sendall(bytearray([0x05, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]))\r\n+            self.conn.sendall(bytearray([\r\n+                0x05, # Protocol version\r\n+                0x00, # Reply (0x00 = success)\r\n+                0x00, # Reserved (must be 0x00)\r\n+                0x01, # Server bound address type (0x01 = ipv4)\r\n+                0x00, 0x00, 0x00, 0x00, # Server bound ipv4 address\r\n+                0x00, 0x00 # Server bound port\r\n+            ]))\r\n \r\n             cmdin = Socks5Command(cmd, atyp, addr, port, username, password)\r\n             self.serv.queue.put(cmdin)\r\n\r\n```",
      "created_at": "2024-03-11T18:13:52Z",
      "updated_at": "2024-03-11T18:41:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1520210992",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520210992"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 174,
      "original_line": 174,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520232425",
      "pull_request_review_id": 1928558982,
      "id": 1520232425,
      "node_id": "PRRC_kwDOABII585anOfp",
      "diff_hunk": "@@ -0,0 +1,311 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 66,
      "commit_id": "29ef3c62de1084b76050414f1f0549c05f9d9ef9",
      "original_commit_id": "d10a0649b018638574fa7dc316b3e783bf6cee69",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "d10a0649b018638574fa7dc316b3e783bf6cee69 just a guess, would this work?\r\n1. start the node with `-addnode=<ipv4>` x10\r\n2. wait for 10 outbounds to connect\r\n3. `addpeeraddress` with all the onion and i2p addrs\r\n4. send raw, etc...",
      "created_at": "2024-03-11T18:21:54Z",
      "updated_at": "2024-03-11T18:41:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1520232425",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520232425"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 56,
      "original_line": 56,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520245249",
      "pull_request_review_id": 1928558982,
      "id": 1520245249,
      "node_id": "PRRC_kwDOABII585anRoB",
      "diff_hunk": "@@ -0,0 +1,311 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtctu7uctl7hly2juu3thbgeivfnvw3ckj3phy6nyvpnx66yeyd.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"listen_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"listen_port\": p2p_port(1), # nodes[1] listen port",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 182,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "d10a0649b018638574fa7dc316b3e783bf6cee69",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "d10a0649b018638574fa7dc316b3e783bf6cee69 nit: slightly confusing to prefix these with `listen_` I would expect, like:\r\n`to_addr` `to_port` `requested_to_addr`",
      "created_at": "2024-03-11T18:26:52Z",
      "updated_at": "2024-03-11T18:41:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1520245249",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520245249"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 181,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 182,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520261754",
      "pull_request_review_id": 1928558982,
      "id": 1520261754,
      "node_id": "PRRC_kwDOABII585anVp6",
      "diff_hunk": "@@ -0,0 +1,311 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtctu7uctl7hly2juu3thbgeivfnvw3ckj3phy6nyvpnx66yeyd.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"listen_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"listen_port\": p2p_port(1), # nodes[1] listen port\n+                    \"node\": None,\n+                    \"requested_to_addr\": None,\n+                })\n+            else:\n+                # Create a Python P2P listening node and add it to self.socks5_server.conf.destinations[]\n+                listener = P2PInterface()\n+                listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                listener.peer_connect_send_version(services=P2P_SERVICES)\n+                self.network_thread.listen(\n+                    p2p=listener,\n+                    # Instruct the SOCKS5 server to redirect a connection to this Python P2P listener.\n+                    callback=lambda addr, port: self.socks5_server.conf.destinations.append({\n+                        \"listen_addr\": addr,\n+                        \"listen_port\": port,\n+                        \"node\": None,\n+                        \"requested_to_addr\": None,\n+                    }),\n+                    addr=\"127.0.0.1\",\n+                    port=ports_base + i)\n+                # Wait until the callback has been called and it has done append().\n+                self.wait_until(lambda: len(self.socks5_server.conf.destinations) == i + 1)\n+\n+                self.socks5_server.conf.destinations[i][\"node\"] = listener\n+\n+        self.extra_args = [\n+            [\n+                \"-peerbloomfilters\", # needed to test replies to MEMPOOL\n+                \"-cjdnsreachable\", # needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{p2p_port(1)}=onion\", # consider all incoming as coming from Tor\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+\n+        observer_inbound = tx_originator.add_p2p_connection(P2PDataStore())\n+\n+        # Fill tx_originator's addrman.\n+        for addr in addresses:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if res[\"success\"]:\n+                self.log.debug(f\"Added {addr} to tx_originator's addrman\")\n+            else:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: self.socks5_server.conf.destinations_used == NUM_INITIAL_CONNECTIONS)\n+\n+        node1 = self.nodes[1]\n+        far_observer = node1.add_p2p_connection(P2PInterface())\n+\n+        # The next opened connections should be \"private broadcast\" for sending the transaction.\n+\n+        miniwallet = MiniWallet(tx_originator)\n+        tx = miniwallet.send_self_transfer(from_node=tx_originator)\n+        self.log.info(f\"Created transaction txid={tx['txid']}\")\n+\n+        self.log.debug(f\"Inspecting outbound connection i={NUM_INITIAL_CONNECTIONS}, must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(node1.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(tx[\"txid\"])\n+        self.log.debug(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: the private broadcast target received and further relayed the transaction\")\n+\n+        num_private_broadcast_opened = 1 # already 1 connection to node1, confirmed by far_observer getting the tx\n+        for i in range(NUM_INITIAL_CONNECTIONS + 1, len(self.socks5_server.conf.destinations)):\n+            self.log.debug(f\"Inspecting outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            peer = self.socks5_server.conf.destinations[i][\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            requested_to_addr = self.socks5_server.conf.destinations[i][\"requested_to_addr\"]\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"Outbound connection i={i} to {requested_to_addr} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"Outbound connection i={i} to {requested_to_addr} must be a private broadcast, checking it\")\n+            assert requested_to_addr.endswith(\".onion\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.rehash(), tx[\"txid\"])\n+            self.log.debug(f\"Outbound connection i={i} is proper private broadcast, test ok\")\n+            num_private_broadcast_opened += 1\n+            if num_private_broadcast_opened == NUM_PRIVATE_BROADCAST_PER_TX:\n+                break\n+        assert_equal(num_private_broadcast_opened, NUM_PRIVATE_BROADCAST_PER_TX)\n+\n+        wtxid_int = int(tx[\"wtxid\"], 16)\n+        inv = CInv(MSG_WTX, wtxid_int)\n+\n+        self.log.info(\"Checking that the transaction is not in the originator node's mempool\")\n+        assert len(tx_originator.getrawmempool()) == 0",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 296,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "d10a0649b018638574fa7dc316b3e783bf6cee69",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "d10a0649b018638574fa7dc316b3e783bf6cee69 sanity check: you can assert this because none of the private-broadcast peers are connected back to the `tx_originator`?",
      "created_at": "2024-03-11T18:40:21Z",
      "updated_at": "2024-03-11T18:41:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1520261754",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1520261754"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 295,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 296,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521442428",
      "pull_request_review_id": 1931025116,
      "id": 1521442428,
      "node_id": "PRRC_kwDOABII585ar158",
      "diff_hunk": "@@ -1900,6 +1911,23 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        if (!g_reachable_nets.Contains(NET_I2P) && !g_reachable_nets.Contains(NET_ONION) &&\n+            (!listenonion || args.IsArgSet(\"-onlynet\"))) {",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 52,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "72f0dbc99e6eed26bef21965dabc5f0bebf01b33",
      "in_reply_to_id": 1517981961,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "It would be possible.\r\n`-privatebroadcast=1 -listenonion=1 -torcontrol=... -torpassword=...` would do exactly that and allow the startup to proceed. However, `args.IsArgSet(\"-onlynet\")` was misplaced. It was intended to give error on things like\r\n`-privatebroadcast=1 -listenonion=1 -torcontrol=... -torpassword=... -onlynet=ipv4` but it was too strong and would mistakenly forbid\r\n`-privatebroadcast=1 -listenonion=1 -torcontrol=... -torpassword=... -onlynet=onion` as well.\r\n\r\nChanged.",
      "created_at": "2024-03-12T13:12:59Z",
      "updated_at": "2024-03-12T13:12:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1521442428",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521442428"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1961,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521449066",
      "pull_request_review_id": 1931037458,
      "id": 1521449066,
      "node_id": "PRRC_kwDOABII585ar3hq",
      "diff_hunk": "@@ -2413,6 +2413,63 @@ bool CConnman::MaybePickPreferredNetwork(std::optional<Network>& network)\n     return false;\n }\n \n+/**\n+ * Decide whether to open a private broadcast connection and if yes, to which network.\n+ * @param[in,out] net If the previous attempt to open a connection was an attempt to\n+ * open a private broadcast connection (successful or not), then this should have a\n+ * value. When the function ends if this has value then it will contain the network\n+ * to which to open the connection.\n+ * @param[in] num_needed Number of private broadcast connections that need to be opened.\n+ * @param[in] num_opened Number of private broadcast connections that are currently opened.\n+ */\n+static void MaybePickPrivateBroadcastNetwork(std::optional<Network>& net, size_t num_needed, size_t num_opened)\n+{\n+    if (net.has_value()) {\n+        // Yield to other connection types.\n+        net = std::nullopt;\n+        return;\n+    }\n+\n+    if (num_needed == 0) {\n+        net = std::nullopt;\n+        return;\n+    }\n+\n+    if (num_opened >= MAX_PRIVATE_BROADCAST_CONNECTIONS) {\n+        LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                      BCLog::Level::Debug,\n+                      \"Requested to open %d connection(s), but there are already %d \"\n+                      \"connections opened. Will wait for some of them to be closed \"\n+                      \"before opening a new one\\n\",\n+                      num_needed,\n+                      num_opened);\n+        net = std::nullopt;\n+        return;\n+    }\n+\n+    const bool tor_reachable{g_reachable_nets.Contains(NET_ONION)};\n+    const bool i2p_reachable{g_reachable_nets.Contains(NET_I2P)};\n+    if (tor_reachable && i2p_reachable) {\n+        net = FastRandomContext{}.randbool() ? NET_ONION : NET_I2P;\n+    } else if (tor_reachable) {\n+        net = NET_ONION;\n+    } else if (i2p_reachable) {\n+        net = NET_I2P;\n+    } else {\n+        LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                      BCLog::Level::Warning,\n+                      \"Requested to open %d connection(s) but none of the Tor or I2P networks is reachable.\\n\",\n+                      num_needed);\n+        net = std::nullopt;\n+        return;\n+    }\n+\n+    LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                  BCLog::Level::Debug,\n+                  \"Requested to open %d connection(s), trying to open one\\n\",\n+                  num_needed);",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 67,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4e19f9cc9834c0b76a2d03fea0921879de46fea9",
      "in_reply_to_id": 1518175963,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think it is ok. This function is a helper of the caller which opens the connection. The doc of the function reads: `Decide whether to open a private broadcast connection and if yes, to which network.`",
      "created_at": "2024-03-12T13:16:53Z",
      "updated_at": "2024-03-12T13:16:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1521449066",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521449066"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 2467,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2465,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521573338",
      "pull_request_review_id": 1931240276,
      "id": 1521573338,
      "node_id": "PRRC_kwDOABII585asV3a",
      "diff_hunk": "@@ -2886,6 +2964,16 @@ void CConnman::OpenNetworkConnection(const CAddress& addrConnect, bool fCountFai\n         return;\n     pnode->grantOutbound = std::move(grant_outbound);\n \n+    if (conn_type == ConnectionType::PRIVATE_BROADCAST) {\n+        const size_t before_sub{m_private_broadcast_connections_to_open.fetch_sub(1)};",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 170,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4e19f9cc9834c0b76a2d03fea0921879de46fea9",
      "in_reply_to_id": 1518178949,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Added `Assume()`",
      "created_at": "2024-03-12T14:29:17Z",
      "updated_at": "2024-03-12T14:29:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1521573338",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521573338"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3054,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521584926",
      "pull_request_review_id": 1931259359,
      "id": 1521584926,
      "node_id": "PRRC_kwDOABII585asYse",
      "diff_hunk": "@@ -2051,7 +2065,7 @@ NodeClock::time_point CWallet::GetDefaultNextResend() { return FastRandomContext\n // that depends on the `relay` option. Periodic rebroadcast uses the pattern\n // relay=true force=false, while loading into the mempool\n // (on start, or after import) uses relay=false force=true.\n-void CWallet::ResubmitWalletTransactions(bool relay, bool force)\n+void CWallet::ResubmitWalletTransactions(TxBroadcastMethod broadcast_method, bool force)",
      "path": "src/wallet/wallet.cpp",
      "position": 1,
      "original_position": 46,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "532e63279a3c04fef8da2c1bb95e5280c94abc4e",
      "in_reply_to_id": 1518194970,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Right, changed.",
      "created_at": "2024-03-12T14:36:08Z",
      "updated_at": "2024-03-12T14:36:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1521584926",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521584926"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2069,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521812693",
      "pull_request_review_id": 1931643945,
      "id": 1521812693,
      "node_id": "PRRC_kwDOABII585atQTV",
      "diff_hunk": "@@ -1083,6 +1087,62 @@ class PeerManagerImpl final : public PeerManager\n \n     void AddAddressKnown(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n     void PushAddress(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n+\n+    /**\n+     * Store a list of transactions to be broadcast privately. Supports the following operations:\n+     * - Add a new transaction\n+     * - Remove a transaction, after it has been seen by the network\n+     * - Mark a broadcast of a transaction (remember when and how many times)\n+     * - Get a transaction for broadcast, the one that has been broadcast less times and least recently\n+     */\n+    class PrivateBroadcast\n+    {\n+    public:\n+        void Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+        {\n+            const Txid& txid = tx->GetHash();\n+            LOCK(m_mutex);\n+            auto [pos, inserted] = m_by_txid.emplace(txid, TxWithPriority{.tx = tx, .priority = Priority{}});\n+            if (inserted) {\n+                m_by_priority.emplace(Priority{}, txid);\n+            }\n+        }\n+\n+    private:\n+        struct Priority {\n+            size_t num_broadcasted{0};\n+            std::chrono::microseconds last_broadcasted{0};\n+\n+            bool operator<(const Priority& other) const\n+            {\n+                if (num_broadcasted < other.num_broadcasted) {\n+                    return true;\n+                }\n+                return last_broadcasted < other.last_broadcasted;\n+            }\n+        };\n+\n+        struct TxWithPriority {\n+            CTransactionRef tx;\n+            Priority priority;\n+        };\n+\n+        struct TxidHasher {\n+            size_t operator()(const Txid& txid) const { return SipHashUint256(0, 0, txid.ToUint256()); }",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 63,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "eb9d7386ca82319ab682fc20ab35c13340d108a4",
      "in_reply_to_id": 1518225842,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "https://www.erisian.com.au/bitcoin-core-dev/log-2024-03-12.html#l-136 switched to `SaltedTxidHasher`.",
      "created_at": "2024-03-12T16:49:32Z",
      "updated_at": "2024-03-12T16:49:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1521812693",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521812693"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1236,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521854424",
      "pull_request_review_id": 1931752158,
      "id": 1521854424,
      "node_id": "PRRC_kwDOABII585atafY",
      "diff_hunk": "@@ -1108,6 +1116,71 @@ class PeerManagerImpl final : public PeerManager\n             }\n         }\n \n+        /**\n+         * Get the transaction that has been broadcast less times and least recently.\n+         */\n+        std::optional<CTransactionRef> GetTxForBroadcast() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+        {\n+            LOCK(m_mutex);\n+            if (m_by_priority.empty()) {\n+                return std::nullopt;\n+            }\n+            const Txid& txid = m_by_priority.begin()->second;\n+            auto it = m_by_txid.find(txid);\n+            if (it == m_by_txid.end()) {\n+                return std::nullopt;",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 42,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "07dee91112189be02c6694385de261570725b56b",
      "in_reply_to_id": 1518256562,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Added `Assume()` that the entry is found.",
      "created_at": "2024-03-12T17:20:01Z",
      "updated_at": "2024-03-12T17:20:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1521854424",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521854424"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1150,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521863661",
      "pull_request_review_id": 1931777320,
      "id": 1521863661,
      "node_id": "PRRC_kwDOABII585atcvt",
      "diff_hunk": "@@ -1566,26 +1665,53 @@ void PeerManagerImpl::FindNextBlocks(std::vector<const CBlockIndex*>& vBlocks, c\n \n void PeerManagerImpl::PushNodeVersion(CNode& pnode, const Peer& peer)\n {\n-    uint64_t my_services{peer.m_our_services};\n-    const int64_t nTime{count_seconds(GetTime<std::chrono::seconds>())};\n-    uint64_t nonce = pnode.GetLocalNonce();\n-    const int nNodeStartingHeight{m_best_height};\n-    NodeId nodeid = pnode.GetId();\n-    CAddress addr = pnode.addr;\n-\n-    CService addr_you = addr.IsRoutable() && !IsProxy(addr) && addr.IsAddrV1Compatible() ? addr : CService();\n-    uint64_t your_services{addr.nServices};\n-\n-    const bool tx_relay{!RejectIncomingTxs(pnode)};\n-    MakeAndPushMessage(pnode, NetMsgType::VERSION, PROTOCOL_VERSION, my_services, nTime,\n-            your_services, CNetAddr::V1(addr_you), // Together the pre-version-31402 serialization of CAddress \"addrYou\" (without nTime)\n-            my_services, CNetAddr::V1(CService{}), // Together the pre-version-31402 serialization of CAddress \"addrMe\" (without nTime)\n-            nonce, strSubVersion, nNodeStartingHeight, tx_relay);\n-\n+    uint64_t my_services;\n+    int64_t my_time;\n+    uint64_t your_services;\n+    CService your_addr;\n+    std::string my_user_agent;\n+    int my_height;\n+    bool my_tx_relay;\n+    if (pnode.IsPrivateBroadcastConn()) {\n+        my_services = NODE_NONE;\n+        my_time = 0;\n+        your_services = NODE_NONE;\n+        your_addr = CService{};\n+        my_user_agent = \"/pynode:0.0.1/\";",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 172,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "07dee91112189be02c6694385de261570725b56b",
      "in_reply_to_id": 1518263617,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "See this: https://github.com/bitcoin/bitcoin/pull/27509#discussion_r1214671917",
      "created_at": "2024-03-12T17:27:09Z",
      "updated_at": "2024-03-12T17:27:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1521863661",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521863661"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1528,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521865397",
      "pull_request_review_id": 1931781298,
      "id": 1521865397,
      "node_id": "PRRC_kwDOABII585atdK1",
      "diff_hunk": "@@ -3706,7 +3885,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                       (mapped_as ? strprintf(\", mapped_as=%d\", mapped_as) : \"\"));\n         }\n \n-        if (pfrom.GetCommonVersion() >= SHORT_IDS_BLOCKS_VERSION) {\n+        if (pfrom.GetCommonVersion() >= SHORT_IDS_BLOCKS_VERSION && !pfrom.IsPrivateBroadcastConn()) {",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 291,
      "commit_id": "7547f915bc6cb0425b46234df486e0de34cad3b3",
      "original_commit_id": "07dee91112189be02c6694385de261570725b56b",
      "in_reply_to_id": 1518279844,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Somehow I find this more clear. Some redundancy doesn't hurt.",
      "created_at": "2024-03-12T17:28:08Z",
      "updated_at": "2024-03-12T17:28:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1521865397",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521865397"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3859,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521879812",
      "pull_request_review_id": 1931815592,
      "id": 1521879812,
      "node_id": "PRRC_kwDOABII585atgsE",
      "diff_hunk": "@@ -4929,6 +5133,16 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                     if (ping_time.count() >= 0) {\n                         // Let connman know about this successful ping-pong\n                         pfrom.PongReceived(ping_time);\n+                        if (pfrom.IsPrivateBroadcastConn()) {\n+                            m_tx_for_private_broadcast.BroadcastEnd(pfrom.GetId(), /*confirmed_by_node=*/true);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 339,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "07dee91112189be02c6694385de261570725b56b",
      "in_reply_to_id": 1518282738,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "By \"probably successful private broadcast\" I meant that probably the transaction will successfully reach the network, not that we successfully gave it to one peer. Reworded.\r\n\r\n~Also the return value of `BroadcastEnd()` was not used by the callers. Changed it to `void`.~ ignore this nonsense",
      "created_at": "2024-03-12T17:37:14Z",
      "updated_at": "2024-03-12T18:01:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1521879812",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521879812"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 5357,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521896483",
      "pull_request_review_id": 1931861170,
      "id": 1521896483,
      "node_id": "PRRC_kwDOABII585atkwj",
      "diff_hunk": "@@ -2657,7 +2733,9 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n             CAddress addr;\n             NodeSeconds addr_last_try{0s};\n \n-            if (fFeeler) {\n+            if (open_private_broadcast_to.has_value()) {\n+                std::tie(addr, addr_last_try) = addrman.Select(/*new_only=*/false, open_private_broadcast_to.value());",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 160,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4e19f9cc9834c0b76a2d03fea0921879de46fea9",
      "in_reply_to_id": 1520139562,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "No, in that case `Select()` will return an invalid address and we will `break;` from the inside loop. Then the outside loop will call `MaybePickPrivateBroadcastNetwork()` again.",
      "created_at": "2024-03-12T17:50:14Z",
      "updated_at": "2024-03-12T17:50:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1521896483",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521896483"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2761,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521900121",
      "pull_request_review_id": 1931871701,
      "id": 1521900121,
      "node_id": "PRRC_kwDOABII585atlpZ",
      "diff_hunk": "@@ -1797,10 +1820,56 @@ void PeerManagerImpl::ReattemptInitialBroadcast(CScheduler& scheduler)\n         }\n     }\n \n-    // Schedule next run for 10-15 minutes in the future.\n-    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n-    const std::chrono::milliseconds delta = 10min + GetRandMillis(5min);\n-    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, delta);\n+    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, NextTxBroadcast());\n+}\n+\n+void PeerManagerImpl::ReattemptPrivateBroadcast(CScheduler& scheduler)\n+{\n+    // The following heuristic is subject to races, but that is ok: if it overshoots,\n+    // we will open some private connections in vain, if it undershoots, the stale\n+    // transactions will be picked on the next run.\n+\n+    size_t num_active{0};\n+    m_connman.ForEachNode([&num_active](const CNode* node) {\n+        if (node->IsPrivateBroadcastConn()) {\n+            ++num_active;\n+        }\n+    });\n+\n+    const size_t num_to_open{m_connman.NumPrivateBroadcastToOpen()};\n+\n+    // Remove stale transactions that are no longer relevant (e.g. already in\n+    // the mempool or mined) and count the remaining ones.\n+    size_t num_stale{0};\n+    const auto stale_txs = m_tx_for_private_broadcast.GetStale();\n+    {\n+        LOCK(cs_main);\n+        for (const auto& stale_tx : stale_txs) {\n+            auto mempool_acceptable = m_chainman.ProcessTransaction(stale_tx, /*test_accept=*/true);\n+            if (mempool_acceptable.m_result_type == MempoolAcceptResult::ResultType::VALID) {\n+                LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                              BCLog::Level::Debug,\n+                              \"Reattempting broadcast of stale txid=%s wtxid=%s\\n\",\n+                              stale_tx->GetHash().ToString(),\n+                              stale_tx->GetWitnessHash().ToString());\n+                ++num_stale;\n+            } else {\n+                LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                              BCLog::Level::Info,\n+                              \"Giving up broadcast attempts for txid=%s wtxid=%s: %s\\n\",\n+                              stale_tx->GetHash().ToString(),\n+                              stale_tx->GetWitnessHash().ToString(),\n+                              mempool_acceptable.m_state.ToString());\n+                m_tx_for_private_broadcast.Remove(stale_tx);\n+            }\n+        }\n+    }\n+\n+    if (num_stale > num_active + num_to_open) {",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 97,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "c09d6409c957af7c449a60778689d6715d9a6628",
      "in_reply_to_id": 1520152548,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`NUM_PRIVATE_BROADCAST_PER_TX` is just for the initial broadcast. Then if a transaction gets stale, we retry one shot at a time. There is no special reason for this. Could be either way.",
      "created_at": "2024-03-12T17:53:17Z",
      "updated_at": "2024-03-12T17:53:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1521900121",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1521900121"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1901,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523138657",
      "pull_request_review_id": 1933992798,
      "id": 1523138657,
      "node_id": "PRRC_kwDOABII585ayUBh",
      "diff_hunk": "@@ -89,11 +91,14 @@ static RPCHelpMan sendrawtransaction()\n             std::string err_string;\n             AssertLockNotHeld(cs_main);\n             NodeContext& node = EnsureAnyNodeContext(request.context);\n+            const auto method = gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST) ?\n+                                    NO_MEMPOOL_PRIVATE_BROADCAST :",
      "path": "src/rpc/mempool.cpp",
      "position": 1,
      "original_position": 16,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e36a1b4848f8f762b550a9469993211d41bd6cb9",
      "in_reply_to_id": 1520191910,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yeah, it was before as well. Somehow the code and the comments around this say that \"the transaction is sent to the mempool for broadcast\" which is not quite accurate (in `master`). I don't think that the mempool is broadcasting the transaction. Will leave it as it is for now.",
      "created_at": "2024-03-13T12:27:09Z",
      "updated_at": "2024-03-13T12:27:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1523138657",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523138657"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 95,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523162366",
      "pull_request_review_id": 1934036115,
      "id": 1523162366,
      "node_id": "PRRC_kwDOABII585ayZz-",
      "diff_hunk": "@@ -0,0 +1,311 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtctu7uctl7hly2juu3thbgeivfnvw3ckj3phy6nyvpnx66yeyd.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"listen_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"listen_port\": p2p_port(1), # nodes[1] listen port\n+                    \"node\": None,\n+                    \"requested_to_addr\": None,\n+                })\n+            else:\n+                # Create a Python P2P listening node and add it to self.socks5_server.conf.destinations[]\n+                listener = P2PInterface()\n+                listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                listener.peer_connect_send_version(services=P2P_SERVICES)\n+                self.network_thread.listen(\n+                    p2p=listener,\n+                    # Instruct the SOCKS5 server to redirect a connection to this Python P2P listener.\n+                    callback=lambda addr, port: self.socks5_server.conf.destinations.append({\n+                        \"listen_addr\": addr,\n+                        \"listen_port\": port,\n+                        \"node\": None,\n+                        \"requested_to_addr\": None,\n+                    }),\n+                    addr=\"127.0.0.1\",\n+                    port=ports_base + i)\n+                # Wait until the callback has been called and it has done append().\n+                self.wait_until(lambda: len(self.socks5_server.conf.destinations) == i + 1)\n+\n+                self.socks5_server.conf.destinations[i][\"node\"] = listener\n+\n+        self.extra_args = [\n+            [\n+                \"-peerbloomfilters\", # needed to test replies to MEMPOOL\n+                \"-cjdnsreachable\", # needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{p2p_port(1)}=onion\", # consider all incoming as coming from Tor\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+\n+        observer_inbound = tx_originator.add_p2p_connection(P2PDataStore())\n+\n+        # Fill tx_originator's addrman.\n+        for addr in addresses:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if res[\"success\"]:\n+                self.log.debug(f\"Added {addr} to tx_originator's addrman\")\n+            else:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: self.socks5_server.conf.destinations_used == NUM_INITIAL_CONNECTIONS)\n+\n+        node1 = self.nodes[1]\n+        far_observer = node1.add_p2p_connection(P2PInterface())\n+\n+        # The next opened connections should be \"private broadcast\" for sending the transaction.\n+\n+        miniwallet = MiniWallet(tx_originator)\n+        tx = miniwallet.send_self_transfer(from_node=tx_originator)\n+        self.log.info(f\"Created transaction txid={tx['txid']}\")\n+\n+        self.log.debug(f\"Inspecting outbound connection i={NUM_INITIAL_CONNECTIONS}, must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(node1.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(tx[\"txid\"])\n+        self.log.debug(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: the private broadcast target received and further relayed the transaction\")\n+\n+        num_private_broadcast_opened = 1 # already 1 connection to node1, confirmed by far_observer getting the tx\n+        for i in range(NUM_INITIAL_CONNECTIONS + 1, len(self.socks5_server.conf.destinations)):\n+            self.log.debug(f\"Inspecting outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            peer = self.socks5_server.conf.destinations[i][\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            requested_to_addr = self.socks5_server.conf.destinations[i][\"requested_to_addr\"]\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"Outbound connection i={i} to {requested_to_addr} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"Outbound connection i={i} to {requested_to_addr} must be a private broadcast, checking it\")\n+            assert requested_to_addr.endswith(\".onion\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.rehash(), tx[\"txid\"])\n+            self.log.debug(f\"Outbound connection i={i} is proper private broadcast, test ok\")\n+            num_private_broadcast_opened += 1\n+            if num_private_broadcast_opened == NUM_PRIVATE_BROADCAST_PER_TX:\n+                break\n+        assert_equal(num_private_broadcast_opened, NUM_PRIVATE_BROADCAST_PER_TX)\n+\n+        wtxid_int = int(tx[\"wtxid\"], 16)\n+        inv = CInv(MSG_WTX, wtxid_int)\n+\n+        self.log.info(\"Checking that the transaction is not in the originator node's mempool\")\n+        assert len(tx_originator.getrawmempool()) == 0",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 296,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "d10a0649b018638574fa7dc316b3e783bf6cee69",
      "in_reply_to_id": 1520261754,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, exactly.",
      "created_at": "2024-03-13T12:40:40Z",
      "updated_at": "2024-03-13T12:40:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1523162366",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523162366"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 295,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 296,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1528651929",
      "pull_request_review_id": 1943216946,
      "id": 1528651929,
      "node_id": "PRRC_kwDOABII585bHWCZ",
      "diff_hunk": "@@ -117,6 +128,33 @@ def handle(self):\n             cmdin = Socks5Command(cmd, atyp, addr, port, username, password)\n             self.serv.queue.put(cmdin)\n             logger.debug('Proxy: %s', cmdin)\n+",
      "path": "test/functional/test_framework/socks5.py",
      "position": 1,
      "original_position": 29,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "2b2e747455699236200fa3cddddfff7005f6a44a",
      "in_reply_to_id": 1520210992,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I will leave it as it is, looks too complicated after looking at doing this for some time.",
      "created_at": "2024-03-18T14:16:14Z",
      "updated_at": "2024-03-18T14:16:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1528651929",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1528651929"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 174,
      "original_line": 174,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1528654321",
      "pull_request_review_id": 1943220975,
      "id": 1528654321,
      "node_id": "PRRC_kwDOABII585bHWnx",
      "diff_hunk": "@@ -0,0 +1,311 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 66,
      "commit_id": "29ef3c62de1084b76050414f1f0549c05f9d9ef9",
      "original_commit_id": "d10a0649b018638574fa7dc316b3e783bf6cee69",
      "in_reply_to_id": 1520232425,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "No, because `-addnode` is counted separately from the `10` automatic outbound connections.",
      "created_at": "2024-03-18T14:17:49Z",
      "updated_at": "2024-03-18T14:17:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1528654321",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1528654321"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 56,
      "original_line": 56,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1528677093",
      "pull_request_review_id": 1943255900,
      "id": 1528677093,
      "node_id": "PRRC_kwDOABII585bHcLl",
      "diff_hunk": "@@ -0,0 +1,311 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtctu7uctl7hly2juu3thbgeivfnvw3ckj3phy6nyvpnx66yeyd.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"listen_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"listen_port\": p2p_port(1), # nodes[1] listen port",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 182,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "d10a0649b018638574fa7dc316b3e783bf6cee69",
      "in_reply_to_id": 1520245249,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Renamed.",
      "created_at": "2024-03-18T14:29:42Z",
      "updated_at": "2024-03-18T14:29:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1528677093",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1528677093"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 181,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 182,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1528683066",
      "pull_request_review_id": 1943267875,
      "id": 1528683066,
      "node_id": "PRRC_kwDOABII585bHdo6",
      "diff_hunk": "@@ -4499,6 +4515,16 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         const uint256& hash = peer->m_wtxid_relay ? wtxid : txid;\n         AddKnownTx(*peer, hash);\n \n+        if (m_tx_for_private_broadcast.Remove(ptx)) {",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 27,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "bc05ddc7b9369cf263bf88d0a773ca853d3c9af5",
      "in_reply_to_id": 1520122930,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, good idea. Implemented.",
      "created_at": "2024-03-18T14:33:28Z",
      "updated_at": "2024-03-18T14:33:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1528683066",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1528683066"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4663,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1528684259",
      "pull_request_review_id": 1943270053,
      "id": 1528684259,
      "node_id": "PRRC_kwDOABII585bHd7j",
      "diff_hunk": "@@ -1797,10 +1820,56 @@ void PeerManagerImpl::ReattemptInitialBroadcast(CScheduler& scheduler)\n         }\n     }\n \n-    // Schedule next run for 10-15 minutes in the future.\n-    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n-    const std::chrono::milliseconds delta = 10min + GetRandMillis(5min);\n-    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, delta);\n+    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, NextTxBroadcast());\n+}\n+\n+void PeerManagerImpl::ReattemptPrivateBroadcast(CScheduler& scheduler)\n+{\n+    // The following heuristic is subject to races, but that is ok: if it overshoots,\n+    // we will open some private connections in vain, if it undershoots, the stale\n+    // transactions will be picked on the next run.\n+\n+    size_t num_active{0};\n+    m_connman.ForEachNode([&num_active](const CNode* node) {\n+        if (node->IsPrivateBroadcastConn()) {\n+            ++num_active;\n+        }\n+    });\n+\n+    const size_t num_to_open{m_connman.NumPrivateBroadcastToOpen()};\n+\n+    // Remove stale transactions that are no longer relevant (e.g. already in\n+    // the mempool or mined) and count the remaining ones.\n+    size_t num_stale{0};\n+    const auto stale_txs = m_tx_for_private_broadcast.GetStale();\n+    {\n+        LOCK(cs_main);\n+        for (const auto& stale_tx : stale_txs) {\n+            auto mempool_acceptable = m_chainman.ProcessTransaction(stale_tx, /*test_accept=*/true);\n+            if (mempool_acceptable.m_result_type == MempoolAcceptResult::ResultType::VALID) {\n+                LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                              BCLog::Level::Debug,\n+                              \"Reattempting broadcast of stale txid=%s wtxid=%s\\n\",\n+                              stale_tx->GetHash().ToString(),\n+                              stale_tx->GetWitnessHash().ToString());\n+                ++num_stale;\n+            } else {\n+                LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                              BCLog::Level::Info,\n+                              \"Giving up broadcast attempts for txid=%s wtxid=%s: %s\\n\",\n+                              stale_tx->GetHash().ToString(),\n+                              stale_tx->GetWitnessHash().ToString(),\n+                              mempool_acceptable.m_state.ToString());\n+                m_tx_for_private_broadcast.Remove(stale_tx);\n+            }\n+        }\n+    }\n+\n+    if (num_stale > num_active + num_to_open) {",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 97,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "c09d6409c957af7c449a60778689d6715d9a6628",
      "in_reply_to_id": 1520152548,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I also renamed the variables to make it clear that we are comparing number of transactions with number of connections.",
      "created_at": "2024-03-18T14:34:17Z",
      "updated_at": "2024-03-18T14:34:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1528684259",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1528684259"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1901,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1539838051",
      "pull_request_review_id": 1961307297,
      "id": 1539838051,
      "node_id": "PRRC_kwDOABII585byBBj",
      "diff_hunk": "@@ -514,7 +514,10 @@ RPCConsole::RPCConsole(interfaces::Node& node, const PlatformStyle *_platformSty\n         tr(\"Outbound Feeler: short-lived, for testing addresses\"),\n         /*: Explanatory text for a short-lived outbound peer connection that is used\n             to request addresses from a peer. */\n-        tr(\"Outbound Address Fetch: short-lived, for soliciting addresses\")};\n+        tr(\"Outbound Address Fetch: short-lived, for soliciting addresses\"),\n+        /*: Explanatory text for a short-lived outbound peer connection that is used\n+            to broadcast privacy-sensitve data (like our transactions). */",
      "path": "src/qt/rpcconsole.cpp",
      "position": 1,
      "original_position": 7,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "9eee0e9d71b4d80dd1fe7439882d07adbd23ee42",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "typo: sensitive (this and next line)",
      "created_at": "2024-03-26T17:58:08Z",
      "updated_at": "2024-03-26T21:47:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1539838051",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1539838051"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 519,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1539858047",
      "pull_request_review_id": 1961307297,
      "id": 1539858047,
      "node_id": "PRRC_kwDOABII585byF5_",
      "diff_hunk": "@@ -1007,10 +1012,22 @@ bool AppInitParameterInteraction(const ArgsManager& args)\n #endif\n     // Trim requested connection counts, to fit into system limitations\n     // <int> in std::min<int>(...) to work around FreeBSD compilation issue described in #2695\n-    nMaxConnections = std::max(std::min<int>(nMaxConnections, fd_max - nBind - MIN_CORE_FILEDESCRIPTORS - MAX_ADDNODE_CONNECTIONS - NUM_FDS_MESSAGE_CAPTURE), 0);\n+    nMaxConnections = std::max(std::min<int>(nMaxConnections,",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 28,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "64742d7881d7646a382d97a934c05347c8bdd04d",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "It seems excessive that `MAX_PRIVATE_BROADCAST_CONNECTIONS=64` has the power to reduce `nMaxConnections` to a lower value even in the case where private broadcast isn't enabled.\r\nMight be better to make that conditional on `privatebroadcast`, similar to how it's done with `nBind`.",
      "created_at": "2024-03-26T18:13:16Z",
      "updated_at": "2024-03-26T21:47:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1539858047",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1539858047"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1024,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540013020",
      "pull_request_review_id": 1961307297,
      "id": 1540013020,
      "node_id": "PRRC_kwDOABII585byrvc",
      "diff_hunk": "@@ -439,4 +439,18 @@ class GenTxid\n     friend bool operator<(const GenTxid& a, const GenTxid& b) { return std::tie(a.m_is_wtxid, a.m_hash) < std::tie(b.m_is_wtxid, b.m_hash); }\n };\n \n+/**\n+ * Methods to broadcast a local transaction.\n+ * Used to influence BroadcastTransaction() and its callers.\n+ */\n+enum TxBroadcastMethod : uint8_t {",
      "path": "src/primitives/transaction.h",
      "position": 1,
      "original_position": 8,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "52e6a40d2aab620e71eed23da26b43e3e3457503",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Wouldn't this fit better into `node/transaction.h` , together with `BroadcastTransaction` ?",
      "created_at": "2024-03-26T19:53:53Z",
      "updated_at": "2024-03-26T21:47:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1540013020",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540013020"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 446,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540139554",
      "pull_request_review_id": 1961307297,
      "id": 1540139554,
      "node_id": "PRRC_kwDOABII585bzKoi",
      "diff_hunk": "@@ -366,7 +366,16 @@ bool CConnman::CheckIncomingNonce(uint64_t nonce)\n {\n     LOCK(m_nodes_mutex);\n     for (const CNode* pnode : m_nodes) {\n-        if (!pnode->fSuccessfullyConnected && !pnode->IsInboundConn() && pnode->GetLocalNonce() == nonce)\n+        // Omit private broadcast connections from this check to prevent this privacy attack:",
      "path": "src/net.cpp",
      "position": 5,
      "original_position": 5,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "5ce95d9960a3935e633fba08ddd9efe3f5b20b0d",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> The peer starts connecting to (clearnet) nodes and sends them a VERSION message which contains our nonce. If the peer manages to connect to us we would disconnect.\r\n\r\nI'm confused by this attack. First, if the peer connects to us over clearnet it would be an inbound connection for us - we don't disconnect inbounds, see `!pnode->IsInboundConn()` a few lines below. Second, even if we did disconnect, I still don't see the how the attack could work - it would be a new connection with a new ID and a new nonce (the nonce is created using the peer id [here](https://github.com/bitcoin/bitcoin/blob/d04324a7056a735c1127ba8ccdc720a16e7281a3/src/net.cpp#L509), so it should be different for each peer).",
      "created_at": "2024-03-26T21:35:28Z",
      "updated_at": "2024-03-26T21:47:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1540139554",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1540139554"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 357,
      "original_line": 357,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1542970441",
      "pull_request_review_id": 1966214627,
      "id": 1542970441,
      "node_id": "PRRC_kwDOABII585b99xJ",
      "diff_hunk": "@@ -439,4 +439,18 @@ class GenTxid\n     friend bool operator<(const GenTxid& a, const GenTxid& b) { return std::tie(a.m_is_wtxid, a.m_hash) < std::tie(b.m_is_wtxid, b.m_hash); }\n };\n \n+/**\n+ * Methods to broadcast a local transaction.\n+ * Used to influence BroadcastTransaction() and its callers.\n+ */\n+enum TxBroadcastMethod : uint8_t {",
      "path": "src/primitives/transaction.h",
      "position": 1,
      "original_position": 8,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "52e6a40d2aab620e71eed23da26b43e3e3457503",
      "in_reply_to_id": 1540013020,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think so, but this drags some further changes, are you ok with those:\r\n\r\n<details>\r\n<summary>[patch] move TxBroadcastMethod from primitives/transaction.h to node/transaction.h</summary>\r\n\r\n```diff\r\ndiff --git i/src/interfaces/chain.h w/src/interfaces/chain.h\r\nindex 315211ae49..eeb5fef42b 100644\r\n--- i/src/interfaces/chain.h\r\n+++ w/src/interfaces/chain.h\r\n@@ -4,12 +4,13 @@\r\n \r\n #ifndef BITCOIN_INTERFACES_CHAIN_H\r\n #define BITCOIN_INTERFACES_CHAIN_H\r\n \r\n #include <blockfilter.h>\r\n #include <common/settings.h>\r\n+#include <node/transaction.h>\r\n #include <primitives/transaction.h> // For CTransactionRef\r\n #include <util/result.h>\r\n \r\n #include <functional>\r\n #include <memory>\r\n #include <optional>\r\n@@ -215,13 +216,13 @@ public:\r\n     //! @param[in] broadcast_method Whether to add the transaction to the\r\n     //! mempool and how/whether to broadcast it.\r\n     //! @param[out] err_string Set if an error occurs.\r\n     //! @return False if the transaction could not be added due to the fee or for another reason.\r\n     virtual bool broadcastTransaction(const CTransactionRef& tx,\r\n                                       const CAmount& max_tx_fee,\r\n-                                      TxBroadcastMethod broadcast_method,\r\n+                                      node::TxBroadcastMethod broadcast_method,\r\n                                       std::string& err_string) = 0;\r\n \r\n     //! Calculate mempool ancestor and descendant counts for the given transaction.\r\n     virtual void getTransactionAncestry(const uint256& txid, size_t& ancestors, size_t& descendants, size_t* ancestorsize = nullptr, CAmount* ancestorfees = nullptr) = 0;\r\n \r\n     //! For each outpoint, calculate the fee-bumping cost to spend this outpoint at the specified\r\ndiff --git i/src/node/transaction.h w/src/node/transaction.h\r\nindex 75c50bab28..01cdfaf1ff 100644\r\n--- i/src/node/transaction.h\r\n+++ w/src/node/transaction.h\r\n@@ -29,12 +29,26 @@ static const CFeeRate DEFAULT_MAX_RAW_TX_FEE_RATE{COIN / 10};\r\n /** Maximum burn value for sendrawtransaction, submitpackage, and testmempoolaccept RPC calls.\r\n  * By default, a transaction with a burn value higher than this will be rejected\r\n  * by these RPCs and the GUI. This can be overridden with the maxburnamount argument.\r\n  */\r\n static const CAmount DEFAULT_MAX_BURN_AMOUNT{0};\r\n \r\n+/**\r\n+ * Methods to broadcast a local transaction.\r\n+ * Used to influence BroadcastTransaction() and its callers.\r\n+ */\r\n+enum TxBroadcastMethod : uint8_t {\r\n+    /// Add the transaction to the mempool and broadcast to all currently connected peers.\r\n+    ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL,\r\n+    /// Add the transaction to the mempool, but don't broadcast to anybody.\r\n+    ADD_TO_MEMPOOL_NO_BROADCAST,\r\n+    /// Omit the mempool and directly send the transaction via a few dedicated connections to\r\n+    /// peers on privacy networks.\r\n+    NO_MEMPOOL_PRIVATE_BROADCAST,\r\n+};\r\n+\r\n /**\r\n  * Submit a transaction to the mempool and (optionally) relay it to all P2P peers.\r\n  *\r\n  * Mempool submission can be synchronous (will await mempool entry notification\r\n  * over the CValidationInterface) or asynchronous (will submit and not wait for\r\n  * notification), depending on the value of wait_callback. wait_callback MUST\r\ndiff --git i/src/primitives/transaction.h w/src/primitives/transaction.h\r\nindex 2051ebae5a..ccbeb3ec49 100644\r\n--- i/src/primitives/transaction.h\r\n+++ w/src/primitives/transaction.h\r\n@@ -436,21 +436,7 @@ public:\r\n     bool IsWtxid() const { return m_is_wtxid; }\r\n     const uint256& GetHash() const LIFETIMEBOUND { return m_hash; }\r\n     friend bool operator==(const GenTxid& a, const GenTxid& b) { return a.m_is_wtxid == b.m_is_wtxid && a.m_hash == b.m_hash; }\r\n     friend bool operator<(const GenTxid& a, const GenTxid& b) { return std::tie(a.m_is_wtxid, a.m_hash) < std::tie(b.m_is_wtxid, b.m_hash); }\r\n };\r\n \r\n-/**\r\n- * Methods to broadcast a local transaction.\r\n- * Used to influence BroadcastTransaction() and its callers.\r\n- */\r\n-enum TxBroadcastMethod : uint8_t {\r\n-    /// Add the transaction to the mempool and broadcast to all currently connected peers.\r\n-    ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL,\r\n-    /// Add the transaction to the mempool, but don't broadcast to anybody.\r\n-    ADD_TO_MEMPOOL_NO_BROADCAST,\r\n-    /// Omit the mempool and directly send the transaction via a few dedicated connections to\r\n-    /// peers on privacy networks.\r\n-    NO_MEMPOOL_PRIVATE_BROADCAST,\r\n-};\r\n-\r\n #endif // BITCOIN_PRIMITIVES_TRANSACTION_H\r\ndiff --git i/src/rpc/mempool.cpp w/src/rpc/mempool.cpp\r\nindex 14d303a0b1..ba69446f36 100644\r\n--- i/src/rpc/mempool.cpp\r\n+++ w/src/rpc/mempool.cpp\r\n@@ -8,12 +8,13 @@\r\n #include <kernel/mempool_persist.h>\r\n \r\n #include <chainparams.h>\r\n #include <core_io.h>\r\n #include <kernel/mempool_entry.h>\r\n #include <node/mempool_persist_args.h>\r\n+#include <node/transaction.h>\r\n #include <policy/rbf.h>\r\n #include <policy/settings.h>\r\n #include <primitives/transaction.h>\r\n #include <rpc/server.h>\r\n #include <rpc/server_util.h>\r\n #include <rpc/util.h>\r\n@@ -91,13 +92,13 @@ static RPCHelpMan sendrawtransaction()\r\n             AssertLockNotHeld(cs_main);\r\n             NodeContext& node = EnsureAnyNodeContext(request.context);\r\n             const TransactionError err = BroadcastTransaction(node,\r\n                                                               tx,\r\n                                                               err_string,\r\n                                                               max_raw_tx_fee,\r\n-                                                              ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL,\r\n+                                                              node::ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL,\r\n                                                               /*wait_callback=*/true);\r\n             if (TransactionError::OK != err) {\r\n                 throw JSONRPCTransactionError(err, err_string);\r\n             }\r\n \r\n             return tx->GetHash().GetHex();\r\n@@ -953,13 +954,13 @@ static RPCHelpMan submitpackage()\r\n                 // We do not expect an error here; we are only broadcasting things already/still in mempool\r\n                 std::string err_string;\r\n                 const auto err = BroadcastTransaction(node,\r\n                                                       tx,\r\n                                                       err_string,\r\n                                                       /*max_tx_fee=*/0,\r\n-                                                      ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL,\r\n+                                                      node::ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL,\r\n                                                       /*wait_callback=*/true);\r\n                 if (err != TransactionError::OK) {\r\n                     throw JSONRPCTransactionError(err,\r\n                         strprintf(\"transaction broadcast failed: %s (%d transactions were broadcast successfully)\",\r\n                             err_string, num_broadcast));\r\n                 }\r\ndiff --git i/src/wallet/rpc/backup.cpp w/src/wallet/rpc/backup.cpp\r\nindex fdbd44ffe5..2e61a0e945 100644\r\n--- i/src/wallet/rpc/backup.cpp\r\n+++ w/src/wallet/rpc/backup.cpp\r\n@@ -10,12 +10,13 @@\r\n #include <clientversion.h>\r\n #include <core_io.h>\r\n #include <hash.h>\r\n #include <interfaces/chain.h>\r\n #include <key_io.h>\r\n #include <merkleblock.h>\r\n+#include <node/transaction.h>\r\n #include <rpc/util.h>\r\n #include <script/descriptor.h>\r\n #include <script/script.h>\r\n #include <script/solver.h>\r\n #include <sync.h>\r\n #include <uint256.h>\r\n@@ -308,13 +309,13 @@ RPCHelpMan importaddress()\r\n             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid Bitcoin address or script\");\r\n         }\r\n     }\r\n     if (fRescan)\r\n     {\r\n         RescanWallet(*pwallet, reserver);\r\n-        pwallet->ResubmitWalletTransactions(ADD_TO_MEMPOOL_NO_BROADCAST, /*force=*/true);\r\n+        pwallet->ResubmitWalletTransactions(node::ADD_TO_MEMPOOL_NO_BROADCAST, /*force=*/true);\r\n     }\r\n \r\n     return UniValue::VNULL;\r\n },\r\n     };\r\n }\r\n@@ -479,13 +480,13 @@ RPCHelpMan importpubkey()\r\n \r\n         pwallet->ImportPubKeys({pubKey.GetID()}, {{pubKey.GetID(), pubKey}} , /*key_origins=*/{}, /*add_keypool=*/false, /*internal=*/false, /*timestamp=*/1);\r\n     }\r\n     if (fRescan)\r\n     {\r\n         RescanWallet(*pwallet, reserver);\r\n-        pwallet->ResubmitWalletTransactions(ADD_TO_MEMPOOL_NO_BROADCAST, /*force=*/true);\r\n+        pwallet->ResubmitWalletTransactions(node::ADD_TO_MEMPOOL_NO_BROADCAST, /*force=*/true);\r\n     }\r\n \r\n     return UniValue::VNULL;\r\n },\r\n     };\r\n }\r\n@@ -1400,13 +1401,13 @@ RPCHelpMan importmulti()\r\n                 nLowestTimestamp = timestamp;\r\n             }\r\n         }\r\n     }\r\n     if (fRescan && fRunScan && requests.size()) {\r\n         int64_t scannedTime = pwallet->RescanFromTime(nLowestTimestamp, reserver, /*update=*/true);\r\n-        pwallet->ResubmitWalletTransactions(ADD_TO_MEMPOOL_NO_BROADCAST, /*force=*/true);\r\n+        pwallet->ResubmitWalletTransactions(node::ADD_TO_MEMPOOL_NO_BROADCAST, /*force=*/true);\r\n \r\n         if (pwallet->IsAbortingRescan()) {\r\n             throw JSONRPCError(RPC_MISC_ERROR, \"Rescan aborted by user.\");\r\n         }\r\n         if (scannedTime > nLowestTimestamp) {\r\n             std::vector<UniValue> results = response.getValues();\r\n@@ -1694,13 +1695,13 @@ RPCHelpMan importdescriptors()\r\n         pwallet->ConnectScriptPubKeyManNotifiers();\r\n     }\r\n \r\n     // Rescan the blockchain using the lowest timestamp\r\n     if (rescan) {\r\n         int64_t scanned_time = pwallet->RescanFromTime(lowest_timestamp, reserver, /*update=*/true);\r\n-        pwallet->ResubmitWalletTransactions(ADD_TO_MEMPOOL_NO_BROADCAST, /*force=*/true);\r\n+        pwallet->ResubmitWalletTransactions(node::ADD_TO_MEMPOOL_NO_BROADCAST, /*force=*/true);\r\n \r\n         if (pwallet->IsAbortingRescan()) {\r\n             throw JSONRPCError(RPC_MISC_ERROR, \"Rescan aborted by user.\");\r\n         }\r\n \r\n         if (scanned_time > lowest_timestamp) {\r\ndiff --git i/src/wallet/test/wallet_tests.cpp w/src/wallet/test/wallet_tests.cpp\r\nindex 003d1aab29..2377c71e21 100644\r\n--- i/src/wallet/test/wallet_tests.cpp\r\n+++ w/src/wallet/test/wallet_tests.cpp\r\n@@ -10,12 +10,13 @@\r\n #include <vector>\r\n \r\n #include <addresstype.h>\r\n #include <interfaces/chain.h>\r\n #include <key_io.h>\r\n #include <node/blockstorage.h>\r\n+#include <node/transaction.h>\r\n #include <policy/policy.h>\r\n #include <rpc/server.h>\r\n #include <script/solver.h>\r\n #include <test/util/logging.h>\r\n #include <test/util/random.h>\r\n #include <test/util/setup_common.h>\r\n@@ -819,13 +820,13 @@ BOOST_FIXTURE_TEST_CASE(CreateWallet, TestChain100Setup)\r\n     });\r\n     std::string error;\r\n     m_coinbase_txns.push_back(CreateAndProcessBlock({}, GetScriptForRawPubKey(coinbaseKey.GetPubKey())).vtx[0]);\r\n     auto block_tx = TestSimpleSpend(*m_coinbase_txns[0], 0, coinbaseKey, GetScriptForRawPubKey(key.GetPubKey()));\r\n     m_coinbase_txns.push_back(CreateAndProcessBlock({block_tx}, GetScriptForRawPubKey(coinbaseKey.GetPubKey())).vtx[0]);\r\n     auto mempool_tx = TestSimpleSpend(*m_coinbase_txns[1], 0, coinbaseKey, GetScriptForRawPubKey(key.GetPubKey()));\r\n-    BOOST_CHECK(m_node.chain->broadcastTransaction(MakeTransactionRef(mempool_tx), DEFAULT_TRANSACTION_MAXFEE, ADD_TO_MEMPOOL_NO_BROADCAST, error));\r\n+    BOOST_CHECK(m_node.chain->broadcastTransaction(MakeTransactionRef(mempool_tx), DEFAULT_TRANSACTION_MAXFEE, node::ADD_TO_MEMPOOL_NO_BROADCAST, error));\r\n \r\n \r\n     // Reload wallet and make sure new transactions are detected despite events\r\n     // being blocked\r\n     // Loading will also ask for current mempool transactions\r\n     wallet = TestLoadWallet(context);\r\n@@ -861,13 +862,13 @@ BOOST_FIXTURE_TEST_CASE(CreateWallet, TestChain100Setup)\r\n     auto handler = HandleLoadWallet(context, [&](std::unique_ptr<interfaces::Wallet> wallet) {\r\n             BOOST_CHECK(rescan_completed);\r\n             m_coinbase_txns.push_back(CreateAndProcessBlock({}, GetScriptForRawPubKey(coinbaseKey.GetPubKey())).vtx[0]);\r\n             block_tx = TestSimpleSpend(*m_coinbase_txns[2], 0, coinbaseKey, GetScriptForRawPubKey(key.GetPubKey()));\r\n             m_coinbase_txns.push_back(CreateAndProcessBlock({block_tx}, GetScriptForRawPubKey(coinbaseKey.GetPubKey())).vtx[0]);\r\n             mempool_tx = TestSimpleSpend(*m_coinbase_txns[3], 0, coinbaseKey, GetScriptForRawPubKey(key.GetPubKey()));\r\n-            BOOST_CHECK(m_node.chain->broadcastTransaction(MakeTransactionRef(mempool_tx), DEFAULT_TRANSACTION_MAXFEE, ADD_TO_MEMPOOL_NO_BROADCAST, error));\r\n+            BOOST_CHECK(m_node.chain->broadcastTransaction(MakeTransactionRef(mempool_tx), DEFAULT_TRANSACTION_MAXFEE, node::ADD_TO_MEMPOOL_NO_BROADCAST, error));\r\n             m_node.validation_signals->SyncWithValidationInterfaceQueue();\r\n         });\r\n     wallet = TestLoadWallet(context);\r\n     // Since mempool transactions are requested at the end of loading, there will\r\n     // be 2 additional AddToWallet calls, one from the previous test, and a duplicate for mempool_tx\r\n     BOOST_CHECK_EQUAL(addtx_count, 2 + 2);\r\ndiff --git i/src/wallet/wallet.cpp w/src/wallet/wallet.cpp\r\nindex 0904399926..2566b2d543 100644\r\n--- i/src/wallet/wallet.cpp\r\n+++ w/src/wallet/wallet.cpp\r\n@@ -24,12 +24,13 @@\r\n #include <interfaces/wallet.h>\r\n #include <kernel/chain.h>\r\n #include <kernel/mempool_removal_reason.h>\r\n #include <key.h>\r\n #include <key_io.h>\r\n #include <logging.h>\r\n+#include <node/transaction.h>\r\n #include <outputtype.h>\r\n #include <policy/feerate.h>\r\n #include <primitives/block.h>\r\n #include <primitives/transaction.h>\r\n #include <psbt.h>\r\n #include <pubkey.h>\r\n@@ -1999,13 +2000,13 @@ CWallet::ScanResult CWallet::ScanForWalletTransactions(const uint256& start_bloc\r\n     }\r\n     return result;\r\n }\r\n \r\n bool CWallet::SubmitTxMemoryPoolAndRelay(CWalletTx& wtx,\r\n                                          std::string& err_string,\r\n-                                         TxBroadcastMethod broadcast_method) const\r\n+                                         node::TxBroadcastMethod broadcast_method) const\r\n {\r\n     AssertLockHeld(cs_wallet);\r\n \r\n     // Can't relay if wallet is not broadcasting\r\n     if (!GetBroadcastTransactions()) return false;\r\n     // Don't relay abandoned transactions\r\n@@ -2016,19 +2017,19 @@ bool CWallet::SubmitTxMemoryPoolAndRelay(CWalletTx& wtx,\r\n     // Don't try to submit conflicted or confirmed transactions.\r\n     if (GetTxDepthInMainChain(wtx) != 0) return false;\r\n \r\n     // Submit transaction to mempool for relay\r\n     const char* what{\"\"};\r\n     switch (broadcast_method) {\r\n-    case ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL:\r\n+    case node::ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL:\r\n         what = \"to mempool and for broadcast to all peers\";\r\n         break;\r\n-    case ADD_TO_MEMPOOL_NO_BROADCAST:\r\n+    case node::ADD_TO_MEMPOOL_NO_BROADCAST:\r\n         what = \"to mempool without broadcast\";\r\n         break;\r\n-    case NO_MEMPOOL_PRIVATE_BROADCAST:\r\n+    case node::NO_MEMPOOL_PRIVATE_BROADCAST:\r\n         what = \"for private broadcast without adding to the mempool\";\r\n         break;\r\n     }\r\n     WalletLogPrintf(\"Submitting wtx %s %s\\n\", wtx.GetHash().ToString(), what);\r\n     // We must set TxStateInMempool here. Even though it will also be set later by the\r\n     // entered-mempool callback, if we did not there would be a race where a\r\n@@ -2095,13 +2096,13 @@ NodeClock::time_point CWallet::GetDefaultNextResend() { return FastRandomContext\r\n // The `force` option results in all unconfirmed transactions being submitted to\r\n // the mempool. This does not necessarily result in those transactions being relayed,\r\n // that depends on the `broadcast_method` option. Periodic rebroadcast uses the pattern\r\n // broadcast_method=ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL force=false, while loading into\r\n // the mempool (on start, or after import) uses\r\n // broadcast_method=ADD_TO_MEMPOOL_NO_BROADCAST force=true.\r\n-void CWallet::ResubmitWalletTransactions(TxBroadcastMethod broadcast_method, bool force)\r\n+void CWallet::ResubmitWalletTransactions(node::TxBroadcastMethod broadcast_method, bool force)\r\n {\r\n     // Don't attempt to resubmit if the wallet is configured to not broadcast,\r\n     // even if forcing.\r\n     if (!fBroadcastTransactions) return;\r\n \r\n     int submitted_tx_count = 0;\r\n@@ -2136,13 +2137,13 @@ void CWallet::ResubmitWalletTransactions(TxBroadcastMethod broadcast_method, boo\r\n /** @} */ // end of mapWallet\r\n \r\n void MaybeResendWalletTxs(WalletContext& context)\r\n {\r\n     for (const std::shared_ptr<CWallet>& pwallet : GetWallets(context)) {\r\n         if (!pwallet->ShouldResend()) continue;\r\n-        pwallet->ResubmitWalletTransactions(ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL, /*force=*/false);\r\n+        pwallet->ResubmitWalletTransactions(node::ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL, /*force=*/false);\r\n         pwallet->SetNextResend();\r\n     }\r\n }\r\n \r\n \r\n /** @defgroup Actions\r\n@@ -2344,13 +2345,13 @@ void CWallet::CommitTransaction(CTransactionRef tx, mapValue_t mapValue, std::ve\r\n     if (!fBroadcastTransactions) {\r\n         // Don't submit tx to the mempool\r\n         return;\r\n     }\r\n \r\n     std::string err_string;\r\n-    if (!SubmitTxMemoryPoolAndRelay(*wtx, err_string, ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL)) {\r\n+    if (!SubmitTxMemoryPoolAndRelay(*wtx, err_string, node::ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL)) {\r\n         WalletLogPrintf(\"CommitTransaction(): Transaction cannot be broadcast immediately, %s\\n\", err_string);\r\n         // TODO: if we expect the failure to be long term or permanent, instead delete wtx from the wallet and return failure.\r\n     }\r\n }\r\n \r\n DBErrors CWallet::LoadWallet()\r\n@@ -3389,13 +3390,13 @@ bool CWallet::UpgradeWallet(int version, bilingual_str& error)\r\n }\r\n \r\n void CWallet::postInitProcess()\r\n {\r\n     // Add wallet transactions that aren't already in a block to mempool\r\n     // Do this here as mempool requires genesis block to be loaded\r\n-    ResubmitWalletTransactions(ADD_TO_MEMPOOL_NO_BROADCAST, /*force=*/true);\r\n+    ResubmitWalletTransactions(node::ADD_TO_MEMPOOL_NO_BROADCAST, /*force=*/true);\r\n \r\n     // Update wallet transactions with current mempool transactions.\r\n     WITH_LOCK(cs_wallet, chain().requestMempoolTransactions(*this));\r\n }\r\n \r\n bool CWallet::BackupWallet(const std::string& strDest) const\r\ndiff --git i/src/wallet/wallet.h w/src/wallet/wallet.h\r\nindex 8f9881c304..ceadabf165 100644\r\n--- i/src/wallet/wallet.h\r\n+++ w/src/wallet/wallet.h\r\n@@ -9,12 +9,13 @@\r\n #include <addresstype.h>\r\n #include <consensus/amount.h>\r\n #include <interfaces/chain.h>\r\n #include <interfaces/handler.h>\r\n #include <kernel/cs_main.h>\r\n #include <logging.h>\r\n+#include <node/transaction.h>\r\n #include <outputtype.h>\r\n #include <policy/feerate.h>\r\n #include <primitives/transaction.h>\r\n #include <script/interpreter.h>\r\n #include <script/script.h>\r\n #include <support/allocators/secure.h>\r\n@@ -631,13 +632,13 @@ public:\r\n     ScanResult ScanForWalletTransactions(const uint256& start_block, int start_height, std::optional<int> max_height, const WalletRescanReserver& reserver, bool fUpdate, const bool save_progress);\r\n     void transactionRemovedFromMempool(const CTransactionRef& tx, MemPoolRemovalReason reason) override;\r\n     /** Set the next time this wallet should resend transactions to 12-36 hours from now, ~1 day on average. */\r\n     void SetNextResend() { m_next_resend = GetDefaultNextResend(); }\r\n     /** Return true if all conditions for periodically resending transactions are met. */\r\n     bool ShouldResend() const;\r\n-    void ResubmitWalletTransactions(TxBroadcastMethod broadcast_method, bool force);\r\n+    void ResubmitWalletTransactions(node::TxBroadcastMethod broadcast_method, bool force);\r\n \r\n     OutputType TransactionChangeType(const std::optional<OutputType>& change_type, const std::vector<CRecipient>& vecSend) const;\r\n \r\n     /** Fetch the inputs and sign with SIGHASH_ALL. */\r\n     bool SignTransaction(CMutableTransaction& tx) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\r\n     /** Sign the tx given the input coins and sighash. */\r\n@@ -676,13 +677,13 @@ public:\r\n      * @param[in] mapValue key-values to be set on the transaction.\r\n      * @param[in] orderForm BIP 70 / BIP 21 order form details to be set on the transaction.\r\n      */\r\n     void CommitTransaction(CTransactionRef tx, mapValue_t mapValue, std::vector<std::pair<std::string, std::string>> orderForm);\r\n \r\n     /** Pass this transaction to node for optional mempool insertion and relay to peers. */\r\n-    bool SubmitTxMemoryPoolAndRelay(CWalletTx& wtx, std::string& err_string, TxBroadcastMethod broadcast_method) const\r\n+    bool SubmitTxMemoryPoolAndRelay(CWalletTx& wtx, std::string& err_string, node::TxBroadcastMethod broadcast_method) const\r\n         EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\r\n \r\n     bool ImportScripts(const std::set<CScript> scripts, int64_t timestamp) EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\r\n     bool ImportPrivKeys(const std::map<CKeyID, CKey>& privkey_map, const int64_t timestamp) EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\r\n     bool ImportPubKeys(const std::vector<CKeyID>& ordered_pubkeys, const std::map<CKeyID, CPubKey>& pubkey_map, const std::map<CKeyID, std::pair<CPubKey, KeyOriginInfo>>& key_origins, const bool add_keypool, const bool internal, const int64_t timestamp) EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\r\n     bool ImportScriptPubKeys(const std::string& label, const std::set<CScript>& script_pub_keys, const bool have_solving_data, const bool apply_label, const int64_t timestamp) EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\r\n```\r\n\r\n</details>",
      "created_at": "2024-03-28T13:22:43Z",
      "updated_at": "2024-03-28T13:22:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1542970441",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1542970441"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 446,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543036439",
      "pull_request_review_id": 1966317652,
      "id": 1543036439,
      "node_id": "PRRC_kwDOABII585b-N4X",
      "diff_hunk": "@@ -366,7 +366,16 @@ bool CConnman::CheckIncomingNonce(uint64_t nonce)\n {\n     LOCK(m_nodes_mutex);\n     for (const CNode* pnode : m_nodes) {\n-        if (!pnode->fSuccessfullyConnected && !pnode->IsInboundConn() && pnode->GetLocalNonce() == nonce)\n+        // Omit private broadcast connections from this check to prevent this privacy attack:",
      "path": "src/net.cpp",
      "position": 5,
      "original_position": 5,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "5ce95d9960a3935e633fba08ddd9efe3f5b20b0d",
      "in_reply_to_id": 1540139554,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I reread your statement and the code a few times and I think that the code is legit (or the attack the code is guarding against could happen). Let me elaborate:\r\n\r\n1. We connect for a private broadcast to `boopeer.onion` and send them `nonce=1234` in our `VERSION` message. For this an entry is added to `CConnman::m_nodes` that has `IsInboundConn() == false`.\r\n2. The `boo` guy delays their `VERACK` on the private connection and connects to random nodes on clearnet. Assuming we also listen on clearnet address, they are lucky enough and manage to connect to us. They send us `VERSION` with `nonce=1234`. For this connection `IsInboundConn() == true` on our side and this code is executed:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/c8e3978114716bb8fb10695b9d187652f3ab4926/src/net_processing.cpp#L3532-L3537\r\n\r\npassing `nonce=1234` to `CheckIncomingNonce()` which finds the entry in `m_nodes` from 1. and returns `false`. Then the clearnet connection from 2. is closed by us.\r\n\r\nMakes sense?",
      "created_at": "2024-03-28T14:01:39Z",
      "updated_at": "2024-03-28T14:01:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1543036439",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543036439"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 357,
      "original_line": 357,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543171484",
      "pull_request_review_id": 1966540871,
      "id": 1543171484,
      "node_id": "PRRC_kwDOABII585b-u2c",
      "diff_hunk": "@@ -439,4 +439,18 @@ class GenTxid\n     friend bool operator<(const GenTxid& a, const GenTxid& b) { return std::tie(a.m_is_wtxid, a.m_hash) < std::tie(b.m_is_wtxid, b.m_hash); }\n };\n \n+/**\n+ * Methods to broadcast a local transaction.\n+ * Used to influence BroadcastTransaction() and its callers.\n+ */\n+enum TxBroadcastMethod : uint8_t {",
      "path": "src/primitives/transaction.h",
      "position": 1,
      "original_position": 8,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "52e6a40d2aab620e71eed23da26b43e3e3457503",
      "in_reply_to_id": 1540013020,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Hmm, after looking at that diff I'm not so sure . It's probably a layer violation include `node/` files from the wallet.\r\nOn the other hand, having this enum in `primitive/transaction.h` still doesn't feel right, given that this isn't really a primitive property of a transaction like `COutPoint`. Maybe put it into another (new) file in `kernel/`, and handle it similar to `enum class ChainstateRole` and `enum class MemPoolRemovalReason` could be the best way?",
      "created_at": "2024-03-28T15:27:04Z",
      "updated_at": "2024-03-28T15:27:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1543171484",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543171484"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 446,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543176910",
      "pull_request_review_id": 1966549210,
      "id": 1543176910,
      "node_id": "PRRC_kwDOABII585b-wLO",
      "diff_hunk": "@@ -366,7 +366,16 @@ bool CConnman::CheckIncomingNonce(uint64_t nonce)\n {\n     LOCK(m_nodes_mutex);\n     for (const CNode* pnode : m_nodes) {\n-        if (!pnode->fSuccessfullyConnected && !pnode->IsInboundConn() && pnode->GetLocalNonce() == nonce)\n+        // Omit private broadcast connections from this check to prevent this privacy attack:",
      "path": "src/net.cpp",
      "position": 5,
      "original_position": 5,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "5ce95d9960a3935e633fba08ddd9efe3f5b20b0d",
      "in_reply_to_id": 1540139554,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, now it makes sense, thanks! I'm not sure where I got confused, I probably misread the existing code.",
      "created_at": "2024-03-28T15:30:30Z",
      "updated_at": "2024-03-28T15:30:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1543176910",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543176910"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 357,
      "original_line": 357,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543237929",
      "pull_request_review_id": 1966647339,
      "id": 1543237929,
      "node_id": "PRRC_kwDOABII585b-_Ep",
      "diff_hunk": "@@ -514,7 +514,10 @@ RPCConsole::RPCConsole(interfaces::Node& node, const PlatformStyle *_platformSty\n         tr(\"Outbound Feeler: short-lived, for testing addresses\"),\n         /*: Explanatory text for a short-lived outbound peer connection that is used\n             to request addresses from a peer. */\n-        tr(\"Outbound Address Fetch: short-lived, for soliciting addresses\")};\n+        tr(\"Outbound Address Fetch: short-lived, for soliciting addresses\"),\n+        /*: Explanatory text for a short-lived outbound peer connection that is used\n+            to broadcast privacy-sensitve data (like our transactions). */",
      "path": "src/qt/rpcconsole.cpp",
      "position": 1,
      "original_position": 7,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "9eee0e9d71b4d80dd1fe7439882d07adbd23ee42",
      "in_reply_to_id": 1539838051,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Fixed, will be in next push.",
      "created_at": "2024-03-28T16:08:37Z",
      "updated_at": "2024-03-28T16:08:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1543237929",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543237929"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 519,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543240449",
      "pull_request_review_id": 1966651380,
      "id": 1543240449,
      "node_id": "PRRC_kwDOABII585b-_sB",
      "diff_hunk": "@@ -1007,10 +1012,22 @@ bool AppInitParameterInteraction(const ArgsManager& args)\n #endif\n     // Trim requested connection counts, to fit into system limitations\n     // <int> in std::min<int>(...) to work around FreeBSD compilation issue described in #2695\n-    nMaxConnections = std::max(std::min<int>(nMaxConnections, fd_max - nBind - MIN_CORE_FILEDESCRIPTORS - MAX_ADDNODE_CONNECTIONS - NUM_FDS_MESSAGE_CAPTURE), 0);\n+    nMaxConnections = std::max(std::min<int>(nMaxConnections,",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 28,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "64742d7881d7646a382d97a934c05347c8bdd04d",
      "in_reply_to_id": 1539858047,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done, will be in next push. Good observation!\r\n\r\nThis raised the unrelated-to-this-PR question https://www.erisian.com.au/bitcoin-core-dev/log-2024-03-28.html#l-59",
      "created_at": "2024-03-28T16:10:34Z",
      "updated_at": "2024-03-28T16:10:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1543240449",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543240449"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1024,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543265026",
      "pull_request_review_id": 1966686141,
      "id": 1543265026,
      "node_id": "PRRC_kwDOABII585b_FsC",
      "diff_hunk": "@@ -439,4 +439,18 @@ class GenTxid\n     friend bool operator<(const GenTxid& a, const GenTxid& b) { return std::tie(a.m_is_wtxid, a.m_hash) < std::tie(b.m_is_wtxid, b.m_hash); }\n };\n \n+/**\n+ * Methods to broadcast a local transaction.\n+ * Used to influence BroadcastTransaction() and its callers.\n+ */\n+enum TxBroadcastMethod : uint8_t {",
      "path": "src/primitives/transaction.h",
      "position": 1,
      "original_position": 8,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "52e6a40d2aab620e71eed23da26b43e3e3457503",
      "in_reply_to_id": 1540013020,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Maybe it is ok to include `node/` from the wallet:\r\n\r\n```\r\n$ git grep node/ origin/master -- \"*wallet*\"\r\norigin/master:src/bench/wallet_balance.cpp:7:#include <node/chainstate.h>\r\norigin/master:src/bench/wallet_balance.cpp:8:#include <node/context.h>\r\norigin/master:src/bench/wallet_create.cpp:10:#include <node/context.h>\r\norigin/master:src/bench/wallet_create_tx.cpp:10:#include <node/context.h>\r\norigin/master:src/bench/wallet_ismine.cpp:12:#include <node/context.h>\r\norigin/master:src/bench/wallet_loading.cpp:11:#include <node/context.h>\r\norigin/master:src/qt/walletframe.cpp:7:#include <node/interface_ui.h>\r\norigin/master:src/qt/walletmodel.cpp:21:#include <node/interface_ui.h>\r\norigin/master:src/qt/walletview.cpp:22:#include <node/interface_ui.h>\r\norigin/master:src/wallet/init.cpp:16:#include <node/context.h>\r\norigin/master:src/wallet/init.cpp:17:#include <node/interface_ui.h>\r\norigin/master:src/wallet/test/coinselector_tests.cpp:6:#include <node/context.h>\r\norigin/master:src/wallet/test/init_test_fixture.h:10:#include <node/context.h>\r\norigin/master:src/wallet/test/ismine_tests.cpp:7:#include <node/context.h>\r\norigin/master:src/wallet/test/wallet_test_fixture.h:12:#include <node/context.h>\r\norigin/master:src/wallet/test/wallet_tests.cpp:15:#include <node/blockstorage.h>\r\norigin/master:test/functional/test_framework/wallet.py:141:            # Sort tx by ancestor count. See BlockAssembler::SortForBlock in src/node/miner.cpp\r\n```",
      "created_at": "2024-03-28T16:24:37Z",
      "updated_at": "2024-03-28T16:24:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1543265026",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543265026"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 446,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543307618",
      "pull_request_review_id": 1966753698,
      "id": 1543307618,
      "node_id": "PRRC_kwDOABII585b_QFi",
      "diff_hunk": "@@ -439,4 +439,18 @@ class GenTxid\n     friend bool operator<(const GenTxid& a, const GenTxid& b) { return std::tie(a.m_is_wtxid, a.m_hash) < std::tie(b.m_is_wtxid, b.m_hash); }\n };\n \n+/**\n+ * Methods to broadcast a local transaction.\n+ * Used to influence BroadcastTransaction() and its callers.\n+ */\n+enum TxBroadcastMethod : uint8_t {",
      "path": "src/primitives/transaction.h",
      "position": 1,
      "original_position": 8,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "52e6a40d2aab620e71eed23da26b43e3e3457503",
      "in_reply_to_id": 1540013020,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "@TheCharlatan you probably dealt a lot with these kind of questions for kernel, do you have an opinion where this enum should be?",
      "created_at": "2024-03-28T16:53:30Z",
      "updated_at": "2024-03-28T16:53:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1543307618",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543307618"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 446,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543379055",
      "pull_request_review_id": 1966863599,
      "id": 1543379055,
      "node_id": "PRRC_kwDOABII585b_hhv",
      "diff_hunk": "@@ -439,4 +439,18 @@ class GenTxid\n     friend bool operator<(const GenTxid& a, const GenTxid& b) { return std::tie(a.m_is_wtxid, a.m_hash) < std::tie(b.m_is_wtxid, b.m_hash); }\n };\n \n+/**\n+ * Methods to broadcast a local transaction.\n+ * Used to influence BroadcastTransaction() and its callers.\n+ */\n+enum TxBroadcastMethod : uint8_t {",
      "path": "src/primitives/transaction.h",
      "position": 1,
      "original_position": 8,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "52e6a40d2aab620e71eed23da26b43e3e3457503",
      "in_reply_to_id": 1540013020,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1543307618\r\n\r\nI'd suggest moving `TxBroadcastMethod` enum to [`node/types.h`](https://github.com/ryanofsky/bitcoin/blob/pr/rmutil/src/node/types.h), which doesn't exist yet but is introduced in #29015, and could be added here as well.\r\n\r\n> It's probably a layer violation include node/ files from the wallet.\r\n\r\nWe don't want wallet code to call node functions or use internal node types, but node and wallet code do define a handful of \"public\" types (CNodeStats, CNodeStateStats, and SynchronizationState, AddressPurpose, isminetype, CRecipient, and CCoinControl) I mentioned recently in https://github.com/bitcoin/bitcoin/pull/29015#discussion_r1425731507 that are useful even without depending on node or wallet libraries, and I think it makes sense to put the lightweight types in [`node/types.h`](https://github.com/ryanofsky/bitcoin/blob/pr/rmutil/src/node/types.h), [`wallet/types.h`](https://github.com/ryanofsky/bitcoin/blob/pr/rmutil/src/wallet/types.h), [`common/types.h`](https://github.com/ryanofsky/bitcoin/blob/pr/rmutil/src/common/types.h) files so they can be explained and used without dragging in other things. Other options I mentioned in that comment:\r\n\r\n> We do have a choice where about where to put public types which are not really part of any library. We can put them in the interfaces directory, or in common, or in the node and wallet directories. Personally, I think it makes sense to put them in the wallet directory when they are related to wallet functionality and used by wallet code, put them in the node directory when they are related to node functionality and used by node code, put them in the common directory when they are related to common functionality (like PSBT) and used by common code. The comments at the top of {node,wallet,common}/types.h files are meant to explain the idea that these are public types.",
      "created_at": "2024-03-28T17:39:28Z",
      "updated_at": "2024-03-28T17:39:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1543379055",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1543379055"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 446,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1544337066",
      "pull_request_review_id": 1968266790,
      "id": 1544337066,
      "node_id": "PRRC_kwDOABII585cDLaq",
      "diff_hunk": "@@ -439,4 +439,18 @@ class GenTxid\n     friend bool operator<(const GenTxid& a, const GenTxid& b) { return std::tie(a.m_is_wtxid, a.m_hash) < std::tie(b.m_is_wtxid, b.m_hash); }\n };\n \n+/**\n+ * Methods to broadcast a local transaction.\n+ * Used to influence BroadcastTransaction() and its callers.\n+ */\n+enum TxBroadcastMethod : uint8_t {",
      "path": "src/primitives/transaction.h",
      "position": 1,
      "original_position": 8,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "52e6a40d2aab620e71eed23da26b43e3e3457503",
      "in_reply_to_id": 1540013020,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Moved to `node/types.h` (new file). Could put it elsewhere if there are better suggestions. Thanks for the suggestion!\r\n\r\nEdit: btw, the doxygen comment should have `\\file` on its own line. See https://www.doxygen.nl/manual/commands.html#cmdfile and run `doxygen doc/Doxyfile` and then inspect `doc/doxygen/html/node_2types_8h.html`.",
      "created_at": "2024-03-29T10:27:49Z",
      "updated_at": "2024-03-29T10:30:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1544337066",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1544337066"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 446,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1544759045",
      "pull_request_review_id": 1969324333,
      "id": 1544759045,
      "node_id": "PRRC_kwDOABII585cEycF",
      "diff_hunk": "@@ -0,0 +1,311 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtctu7uctl7hly2juu3thbgeivfnvw3ckj3phy6nyvpnx66yeyd.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"to_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"to_port\": p2p_port(1), # nodes[1] listen port\n+                    \"node\": None,\n+                    \"requested_to_addr\": None,\n+                })\n+            else:\n+                # Create a Python P2P listening node and add it to self.socks5_server.conf.destinations[]\n+                listener = P2PInterface()\n+                listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                listener.peer_connect_send_version(services=P2P_SERVICES)\n+                self.network_thread.listen(\n+                    p2p=listener,\n+                    # Instruct the SOCKS5 server to redirect a connection to this Python P2P listener.\n+                    callback=lambda addr, port: self.socks5_server.conf.destinations.append({\n+                        \"to_addr\": addr,\n+                        \"to_port\": port,\n+                        \"node\": None,\n+                        \"requested_to_addr\": None,\n+                    }),\n+                    addr=\"127.0.0.1\",\n+                    port=ports_base + i)\n+                # Wait until the callback has been called and it has done append().\n+                self.wait_until(lambda: len(self.socks5_server.conf.destinations) == i + 1)\n+\n+                self.socks5_server.conf.destinations[i][\"node\"] = listener\n+\n+        self.extra_args = [\n+            [\n+                \"-peerbloomfilters\", # needed to test replies to MEMPOOL\n+                \"-cjdnsreachable\", # needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{p2p_port(1)}=onion\", # consider all incoming as coming from Tor\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+\n+        observer_inbound = tx_originator.add_p2p_connection(P2PDataStore())\n+\n+        # Fill tx_originator's addrman.\n+        for addr in addresses:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if res[\"success\"]:\n+                self.log.debug(f\"Added {addr} to tx_originator's addrman\")\n+            else:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: self.socks5_server.conf.destinations_used == NUM_INITIAL_CONNECTIONS)\n+\n+        node1 = self.nodes[1]\n+        far_observer = node1.add_p2p_connection(P2PInterface())\n+\n+        # The next opened connections should be \"private broadcast\" for sending the transaction.\n+\n+        miniwallet = MiniWallet(tx_originator)\n+        tx = miniwallet.send_self_transfer(from_node=tx_originator)\n+        self.log.info(f\"Created transaction txid={tx['txid']}\")\n+\n+        self.log.debug(f\"Inspecting outbound connection i={NUM_INITIAL_CONNECTIONS}, must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(node1.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(tx[\"txid\"])\n+        self.log.debug(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: the private broadcast target received and further relayed the transaction\")\n+\n+        num_private_broadcast_opened = 1 # already 1 connection to node1, confirmed by far_observer getting the tx\n+        for i in range(NUM_INITIAL_CONNECTIONS + 1, len(self.socks5_server.conf.destinations)):\n+            self.log.debug(f\"Inspecting outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            peer = self.socks5_server.conf.destinations[i][\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            requested_to_addr = self.socks5_server.conf.destinations[i][\"requested_to_addr\"]\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"Outbound connection i={i} to {requested_to_addr} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"Outbound connection i={i} to {requested_to_addr} must be a private broadcast, checking it\")\n+            assert requested_to_addr.endswith(\".onion\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.rehash(), tx[\"txid\"])\n+            self.log.debug(f\"Outbound connection i={i} is proper private broadcast, test ok\")\n+            num_private_broadcast_opened += 1\n+            if num_private_broadcast_opened == NUM_PRIVATE_BROADCAST_PER_TX:\n+                break\n+        assert_equal(num_private_broadcast_opened, NUM_PRIVATE_BROADCAST_PER_TX)\n+\n+        wtxid_int = int(tx[\"wtxid\"], 16)\n+        inv = CInv(MSG_WTX, wtxid_int)\n+\n+        self.log.info(\"Checking that the transaction is not in the originator node's mempool\")\n+        assert len(tx_originator.getrawmempool()) == 0",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 296,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "c7e4d5cb2bf01d9719702e71c8d6264ee670e988",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit:\r\n```suggestion\r\n        assert_equal(len(tx_originator.getrawmempool()), 0)\r\n```",
      "created_at": "2024-03-29T18:35:12Z",
      "updated_at": "2024-03-29T18:35:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1544759045",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1544759045"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 296,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1544863598",
      "pull_request_review_id": 1969597243,
      "id": 1544863598,
      "node_id": "PRRC_kwDOABII585cFL9u",
      "diff_hunk": "@@ -91,11 +93,14 @@ static RPCHelpMan sendrawtransaction()\n             std::string err_string;\n             AssertLockNotHeld(cs_main);\n             NodeContext& node = EnsureAnyNodeContext(request.context);\n+            const auto method = gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)",
      "path": "src/rpc/mempool.cpp",
      "position": 1,
      "original_position": 15,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "cf76f4f0fe1a3ef0730f70a035c10e01712b6d6b",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In cf76f4f0fe1a3ef0730f70a035c10e01712b6d6b: Shouldn't we check here whether any private network is reachable? Because we can start a node with `-privatebroadcast` with `NET_ONION` becoming reachable later, no?",
      "created_at": "2024-03-29T20:55:52Z",
      "updated_at": "2024-03-29T20:55:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1544863598",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1544863598"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 96,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545397035",
      "pull_request_review_id": 1969951271,
      "id": 1545397035,
      "node_id": "PRRC_kwDOABII585cHOMr",
      "diff_hunk": "@@ -655,11 +656,12 @@ class NetinfoRequestHandler : public BaseRequestHandler\n         \"           \\\"in\\\"  - inbound connections are those initiated by the peer\\n\"\n         \"           \\\"out\\\" - outbound connections are those initiated by us\\n\"\n         \"  type     Type of peer connection\\n\"\n-        \"           \\\"full\\\"   - full relay, the default\\n\"\n-        \"           \\\"block\\\"  - block relay; like full relay but does not relay transactions or addresses\\n\"\n-        \"           \\\"manual\\\" - peer we manually added using RPC addnode or the -addnode/-connect config options\\n\"\n-        \"           \\\"feeler\\\" - short-lived connection for testing addresses\\n\"\n-        \"           \\\"addr\\\"   - address fetch; short-lived connection for requesting addresses\\n\"\n+        \"           \\\"full\\\"      - full relay, the default\\n\"\n+        \"           \\\"block\\\"     - block relay; like full relay but does not relay transactions or addresses\\n\"\n+        \"           \\\"manual\\\"    - peer we manually added using RPC addnode or the -addnode/-connect config options\\n\"\n+        \"           \\\"feeler\\\"    - short-lived connection for testing addresses\\n\"\n+        \"           \\\"addr\\\"      - address fetch; short-lived connection for requesting addresses\\n\"\n+        \"           \\\"privat\\\"    - private broadcast; short-lived connection for broadcasting our transactions\\n\"",
      "path": "src/bitcoin-cli.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "c7e4d5cb2bf01d9719702e71c8d6264ee670e988",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "```suggestion\r\n        \"           \\\"private\\\"    - private broadcast; short-lived connection for broadcasting our transactions\\n\"\r\n```",
      "created_at": "2024-03-30T14:20:06Z",
      "updated_at": "2024-03-30T14:20:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1545397035",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545397035"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 691,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546167724",
      "pull_request_review_id": 1970997616,
      "id": 1546167724,
      "node_id": "PRRC_kwDOABII585cKKWs",
      "diff_hunk": "@@ -2493,7 +2561,17 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n             }\n         }\n \n-        CSemaphoreGrant grant(*semOutbound);\n+        MaybePickPrivateBroadcastNetwork(open_private_broadcast_to,\n+                                         m_private_broadcast_connections_to_open.load(),\n+                                         num_private_broadcast_opened);\n+\n+        // Don't wait for outbound connection slot to be available if we are going",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 115,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b1f65ba837a805dc8f855c02337c1593c77add6d",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Private connections are opened regardless of max connections limits, I think we could cover it in the functional test.",
      "created_at": "2024-04-01T09:47:18Z",
      "updated_at": "2024-04-01T09:47:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1546167724",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546167724"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2580,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546262607",
      "pull_request_review_id": 1971157352,
      "id": 1546262607,
      "node_id": "PRRC_kwDOABII585cKhhP",
      "diff_hunk": "@@ -2396,6 +2399,63 @@ bool CConnman::MaybePickPreferredNetwork(std::optional<Network>& network)\n     return false;\n }\n \n+/**\n+ * Decide whether to open a private broadcast connection and if yes, to which network.\n+ * @param[in,out] net If the previous attempt to open a connection was an attempt to\n+ * open a private broadcast connection (successful or not), then this should have a\n+ * value. When the function ends if this has value then it will contain the network\n+ * to which to open the connection.\n+ * @param[in] num_needed Number of private broadcast connections that need to be opened.\n+ * @param[in] num_opened Number of private broadcast connections that are currently opened.\n+ */\n+static void MaybePickPrivateBroadcastNetwork(std::optional<Network>& net, size_t num_needed, size_t num_opened)",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 25,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b1f65ba837a805dc8f855c02337c1593c77add6d",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In b1f65ba837a805dc8f855c02337c1593c77add6d: non-blocker: I think it would be more elegant if `MaybePickPrivateBroadcastNetwork` returns `std::optional<Network> net`. ",
      "created_at": "2024-04-01T12:12:12Z",
      "updated_at": "2024-04-01T12:12:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1546262607",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546262607"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2411,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546535762",
      "pull_request_review_id": 1971635317,
      "id": 1546535762,
      "node_id": "PRRC_kwDOABII585cLkNS",
      "diff_hunk": "@@ -0,0 +1,311 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtctu7uctl7hly2juu3thbgeivfnvw3ckj3phy6nyvpnx66yeyd.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"to_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"to_port\": p2p_port(1), # nodes[1] listen port\n+                    \"node\": None,\n+                    \"requested_to_addr\": None,\n+                })\n+            else:\n+                # Create a Python P2P listening node and add it to self.socks5_server.conf.destinations[]\n+                listener = P2PInterface()\n+                listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                listener.peer_connect_send_version(services=P2P_SERVICES)\n+                self.network_thread.listen(\n+                    p2p=listener,\n+                    # Instruct the SOCKS5 server to redirect a connection to this Python P2P listener.\n+                    callback=lambda addr, port: self.socks5_server.conf.destinations.append({\n+                        \"to_addr\": addr,\n+                        \"to_port\": port,\n+                        \"node\": None,\n+                        \"requested_to_addr\": None,\n+                    }),\n+                    addr=\"127.0.0.1\",\n+                    port=ports_base + i)\n+                # Wait until the callback has been called and it has done append().\n+                self.wait_until(lambda: len(self.socks5_server.conf.destinations) == i + 1)\n+\n+                self.socks5_server.conf.destinations[i][\"node\"] = listener\n+\n+        self.extra_args = [\n+            [\n+                \"-peerbloomfilters\", # needed to test replies to MEMPOOL\n+                \"-cjdnsreachable\", # needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{p2p_port(1)}=onion\", # consider all incoming as coming from Tor\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+\n+        observer_inbound = tx_originator.add_p2p_connection(P2PDataStore())\n+\n+        # Fill tx_originator's addrman.\n+        for addr in addresses:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if res[\"success\"]:\n+                self.log.debug(f\"Added {addr} to tx_originator's addrman\")\n+            else:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: self.socks5_server.conf.destinations_used == NUM_INITIAL_CONNECTIONS)\n+\n+        node1 = self.nodes[1]\n+        far_observer = node1.add_p2p_connection(P2PInterface())\n+\n+        # The next opened connections should be \"private broadcast\" for sending the transaction.\n+\n+        miniwallet = MiniWallet(tx_originator)\n+        tx = miniwallet.send_self_transfer(from_node=tx_originator)\n+        self.log.info(f\"Created transaction txid={tx['txid']}\")\n+\n+        self.log.debug(f\"Inspecting outbound connection i={NUM_INITIAL_CONNECTIONS}, must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(node1.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(tx[\"txid\"])\n+        self.log.debug(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: the private broadcast target received and further relayed the transaction\")\n+\n+        num_private_broadcast_opened = 1 # already 1 connection to node1, confirmed by far_observer getting the tx\n+        for i in range(NUM_INITIAL_CONNECTIONS + 1, len(self.socks5_server.conf.destinations)):\n+            self.log.debug(f\"Inspecting outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            peer = self.socks5_server.conf.destinations[i][\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            requested_to_addr = self.socks5_server.conf.destinations[i][\"requested_to_addr\"]\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"Outbound connection i={i} to {requested_to_addr} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"Outbound connection i={i} to {requested_to_addr} must be a private broadcast, checking it\")\n+            assert requested_to_addr.endswith(\".onion\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.rehash(), tx[\"txid\"])\n+            self.log.debug(f\"Outbound connection i={i} is proper private broadcast, test ok\")\n+            num_private_broadcast_opened += 1\n+            if num_private_broadcast_opened == NUM_PRIVATE_BROADCAST_PER_TX:\n+                break\n+        assert_equal(num_private_broadcast_opened, NUM_PRIVATE_BROADCAST_PER_TX)\n+\n+        wtxid_int = int(tx[\"wtxid\"], 16)\n+        inv = CInv(MSG_WTX, wtxid_int)\n+\n+        self.log.info(\"Checking that the transaction is not in the originator node's mempool\")\n+        assert len(tx_originator.getrawmempool()) == 0",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 296,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "c7e4d5cb2bf01d9719702e71c8d6264ee670e988",
      "in_reply_to_id": 1544759045,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2024-04-01T16:21:13Z",
      "updated_at": "2024-04-01T16:21:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1546535762",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546535762"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 296,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546542191",
      "pull_request_review_id": 1971641791,
      "id": 1546542191,
      "node_id": "PRRC_kwDOABII585cLlxv",
      "diff_hunk": "@@ -91,11 +93,14 @@ static RPCHelpMan sendrawtransaction()\n             std::string err_string;\n             AssertLockNotHeld(cs_main);\n             NodeContext& node = EnsureAnyNodeContext(request.context);\n+            const auto method = gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)",
      "path": "src/rpc/mempool.cpp",
      "position": 1,
      "original_position": 15,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "cf76f4f0fe1a3ef0730f70a035c10e01712b6d6b",
      "in_reply_to_id": 1544863598,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2024-04-01T16:23:44Z",
      "updated_at": "2024-04-01T16:23:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1546542191",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546542191"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 96,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546548842",
      "pull_request_review_id": 1971648140,
      "id": 1546548842,
      "node_id": "PRRC_kwDOABII585cLnZq",
      "diff_hunk": "@@ -2493,7 +2561,17 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n             }\n         }\n \n-        CSemaphoreGrant grant(*semOutbound);\n+        MaybePickPrivateBroadcastNetwork(open_private_broadcast_to,\n+                                         m_private_broadcast_connections_to_open.load(),\n+                                         num_private_broadcast_opened);\n+\n+        // Don't wait for outbound connection slot to be available if we are going",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 115,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b1f65ba837a805dc8f855c02337c1593c77add6d",
      "in_reply_to_id": 1546167724,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The current functional test already opens the usual 10 connections and then fires a private broadcast one. Is this what you mean?",
      "created_at": "2024-04-01T16:25:11Z",
      "updated_at": "2024-04-01T16:25:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1546548842",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546548842"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2580,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546549521",
      "pull_request_review_id": 1971648844,
      "id": 1546549521,
      "node_id": "PRRC_kwDOABII585cLnkR",
      "diff_hunk": "@@ -2396,6 +2399,63 @@ bool CConnman::MaybePickPreferredNetwork(std::optional<Network>& network)\n     return false;\n }\n \n+/**\n+ * Decide whether to open a private broadcast connection and if yes, to which network.\n+ * @param[in,out] net If the previous attempt to open a connection was an attempt to\n+ * open a private broadcast connection (successful or not), then this should have a\n+ * value. When the function ends if this has value then it will contain the network\n+ * to which to open the connection.\n+ * @param[in] num_needed Number of private broadcast connections that need to be opened.\n+ * @param[in] num_opened Number of private broadcast connections that are currently opened.\n+ */\n+static void MaybePickPrivateBroadcastNetwork(std::optional<Network>& net, size_t num_needed, size_t num_opened)",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 25,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b1f65ba837a805dc8f855c02337c1593c77add6d",
      "in_reply_to_id": 1546262607,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2024-04-01T16:25:20Z",
      "updated_at": "2024-04-01T16:25:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1546549521",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546549521"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2411,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546557097",
      "pull_request_review_id": 1971658452,
      "id": 1546557097,
      "node_id": "PRRC_kwDOABII585cLpap",
      "diff_hunk": "@@ -2493,7 +2561,17 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n             }\n         }\n \n-        CSemaphoreGrant grant(*semOutbound);\n+        MaybePickPrivateBroadcastNetwork(open_private_broadcast_to,\n+                                         m_private_broadcast_connections_to_open.load(),\n+                                         num_private_broadcast_opened);\n+\n+        // Don't wait for outbound connection slot to be available if we are going",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 115,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b1f65ba837a805dc8f855c02337c1593c77add6d",
      "in_reply_to_id": 1546167724,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, I missed that. Nevermind.",
      "created_at": "2024-04-01T16:27:36Z",
      "updated_at": "2024-04-01T16:27:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1546557097",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546557097"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2580,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546558523",
      "pull_request_review_id": 1971659859,
      "id": 1546558523,
      "node_id": "PRRC_kwDOABII585cLpw7",
      "diff_hunk": "@@ -655,11 +656,12 @@ class NetinfoRequestHandler : public BaseRequestHandler\n         \"           \\\"in\\\"  - inbound connections are those initiated by the peer\\n\"\n         \"           \\\"out\\\" - outbound connections are those initiated by us\\n\"\n         \"  type     Type of peer connection\\n\"\n-        \"           \\\"full\\\"   - full relay, the default\\n\"\n-        \"           \\\"block\\\"  - block relay; like full relay but does not relay transactions or addresses\\n\"\n-        \"           \\\"manual\\\" - peer we manually added using RPC addnode or the -addnode/-connect config options\\n\"\n-        \"           \\\"feeler\\\" - short-lived connection for testing addresses\\n\"\n-        \"           \\\"addr\\\"   - address fetch; short-lived connection for requesting addresses\\n\"\n+        \"           \\\"full\\\"      - full relay, the default\\n\"\n+        \"           \\\"block\\\"     - block relay; like full relay but does not relay transactions or addresses\\n\"\n+        \"           \\\"manual\\\"    - peer we manually added using RPC addnode or the -addnode/-connect config options\\n\"\n+        \"           \\\"feeler\\\"    - short-lived connection for testing addresses\\n\"\n+        \"           \\\"addr\\\"      - address fetch; short-lived connection for requesting addresses\\n\"\n+        \"           \\\"privat\\\"    - private broadcast; short-lived connection for broadcasting our transactions\\n\"",
      "path": "src/bitcoin-cli.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "c7e4d5cb2bf01d9719702e71c8d6264ee670e988",
      "in_reply_to_id": 1545397035,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "It was suggested that this be 6 chars or less: https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1518063388. Feel free to suggest another name.",
      "created_at": "2024-04-01T16:28:36Z",
      "updated_at": "2024-04-01T16:28:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1546558523",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546558523"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 691,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546756330",
      "pull_request_review_id": 1971975903,
      "id": 1546756330,
      "node_id": "PRRC_kwDOABII585cMaDq",
      "diff_hunk": "@@ -0,0 +1,311 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtctu7uctl7hly2juu3thbgeivfnvw3ckj3phy6nyvpnx66yeyd.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"to_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"to_port\": p2p_port(1), # nodes[1] listen port\n+                    \"node\": None,\n+                    \"requested_to_addr\": None,\n+                })\n+            else:\n+                # Create a Python P2P listening node and add it to self.socks5_server.conf.destinations[]\n+                listener = P2PInterface()\n+                listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                listener.peer_connect_send_version(services=P2P_SERVICES)\n+                self.network_thread.listen(\n+                    p2p=listener,\n+                    # Instruct the SOCKS5 server to redirect a connection to this Python P2P listener.\n+                    callback=lambda addr, port: self.socks5_server.conf.destinations.append({\n+                        \"to_addr\": addr,\n+                        \"to_port\": port,\n+                        \"node\": None,\n+                        \"requested_to_addr\": None,\n+                    }),\n+                    addr=\"127.0.0.1\",\n+                    port=ports_base + i)\n+                # Wait until the callback has been called and it has done append().\n+                self.wait_until(lambda: len(self.socks5_server.conf.destinations) == i + 1)\n+\n+                self.socks5_server.conf.destinations[i][\"node\"] = listener\n+\n+        self.extra_args = [\n+            [\n+                \"-peerbloomfilters\", # needed to test replies to MEMPOOL\n+                \"-cjdnsreachable\", # needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{p2p_port(1)}=onion\", # consider all incoming as coming from Tor\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+\n+        observer_inbound = tx_originator.add_p2p_connection(P2PDataStore())\n+\n+        # Fill tx_originator's addrman.\n+        for addr in addresses:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if res[\"success\"]:\n+                self.log.debug(f\"Added {addr} to tx_originator's addrman\")\n+            else:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 235,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "413574e81ef4d608b9b0a2079f81a4e90ee2a341",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 413574e81ef4d608b9b0a2079f81a4e90ee2a341: You can use `-test=addrman` to make addrman deterministic.  Running the test several times I realized that sometimes a collision happens, sometimes not.",
      "created_at": "2024-04-01T19:29:12Z",
      "updated_at": "2024-04-01T19:29:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1546756330",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546756330"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 232,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548220655",
      "pull_request_review_id": 1974375838,
      "id": 1548220655,
      "node_id": "PRRC_kwDOABII585cR_jv",
      "diff_hunk": "@@ -0,0 +1,311 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtctu7uctl7hly2juu3thbgeivfnvw3ckj3phy6nyvpnx66yeyd.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"to_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"to_port\": p2p_port(1), # nodes[1] listen port\n+                    \"node\": None,\n+                    \"requested_to_addr\": None,\n+                })\n+            else:\n+                # Create a Python P2P listening node and add it to self.socks5_server.conf.destinations[]\n+                listener = P2PInterface()\n+                listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                listener.peer_connect_send_version(services=P2P_SERVICES)\n+                self.network_thread.listen(\n+                    p2p=listener,\n+                    # Instruct the SOCKS5 server to redirect a connection to this Python P2P listener.\n+                    callback=lambda addr, port: self.socks5_server.conf.destinations.append({\n+                        \"to_addr\": addr,\n+                        \"to_port\": port,\n+                        \"node\": None,\n+                        \"requested_to_addr\": None,\n+                    }),\n+                    addr=\"127.0.0.1\",\n+                    port=ports_base + i)\n+                # Wait until the callback has been called and it has done append().\n+                self.wait_until(lambda: len(self.socks5_server.conf.destinations) == i + 1)\n+\n+                self.socks5_server.conf.destinations[i][\"node\"] = listener\n+\n+        self.extra_args = [\n+            [\n+                \"-peerbloomfilters\", # needed to test replies to MEMPOOL\n+                \"-cjdnsreachable\", # needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{p2p_port(1)}=onion\", # consider all incoming as coming from Tor\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+\n+        observer_inbound = tx_originator.add_p2p_connection(P2PDataStore())\n+\n+        # Fill tx_originator's addrman.\n+        for addr in addresses:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if res[\"success\"]:\n+                self.log.debug(f\"Added {addr} to tx_originator's addrman\")\n+            else:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 235,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "413574e81ef4d608b9b0a2079f81a4e90ee2a341",
      "in_reply_to_id": 1546756330,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2024-04-02T16:39:46Z",
      "updated_at": "2024-04-02T16:39:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1548220655",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548220655"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 232,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548540109",
      "pull_request_review_id": 1974917244,
      "id": 1548540109,
      "node_id": "PRRC_kwDOABII585cTNjN",
      "diff_hunk": "@@ -1097,6 +1101,58 @@ class PeerManagerImpl final : public PeerManager\n \n     void AddAddressKnown(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n     void PushAddress(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n+\n+    /**\n+     * Store a list of transactions to be broadcast privately. Supports the following operations:\n+     * - Add a new transaction\n+     * - Remove a transaction, after it has been seen by the network\n+     * - Mark a broadcast of a transaction (remember when and how many times)\n+     * - Get a transaction for broadcast, the one that has been broadcast less times and least recently",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 28,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "08c017b640a8d928f2b0ac32f1040e4b8372ae5f",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "```suggestion\r\n     * - Get a transaction for broadcast, the one that has been broadcast fewer times and least recently\r\n```",
      "created_at": "2024-04-02T19:59:59Z",
      "updated_at": "2024-04-02T21:56:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1548540109",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548540109"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548572949",
      "pull_request_review_id": 1974917244,
      "id": 1548572949,
      "node_id": "PRRC_kwDOABII585cTVkV",
      "diff_hunk": "@@ -1122,6 +1130,72 @@ class PeerManagerImpl final : public PeerManager\n             }\n         }\n \n+        /**\n+         * Get the transaction that has been broadcast less times and least recently.",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 31,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e03f1b1eb04df0c3deead36d70c014f758e3647f",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "```suggestion\r\n         * Get the transaction that has been broadcast fewest times and least recently.\r\n```",
      "created_at": "2024-04-02T20:34:47Z",
      "updated_at": "2024-04-02T21:56:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1548572949",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548572949"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1134,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548580964",
      "pull_request_review_id": 1974917244,
      "id": 1548580964,
      "node_id": "PRRC_kwDOABII585cTXhk",
      "diff_hunk": "@@ -1143,15 +1217,41 @@ class PeerManagerImpl final : public PeerManager\n \n         using ByTxid = std::unordered_map<Txid, TxWithPriority, SaltedTxidHasher>;\n         using ByPriority = std::multimap<Priority, Txid>;\n+        using ByNodeId = std::unordered_map<NodeId, Txid>;\n \n         struct Iterators {\n             ByTxid::iterator by_txid;\n             ByPriority::iterator by_priority;\n         };\n \n+        /**\n+         * Get iterators in `m_by_txid` and `m_by_priority` for a given transaction.\n+         */\n+        std::optional<Iterators> Find(const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(m_mutex)",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 113,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e03f1b1eb04df0c3deead36d70c014f758e3647f",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: This could be `const` method?",
      "created_at": "2024-04-02T20:43:01Z",
      "updated_at": "2024-04-02T21:56:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1548580964",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548580964"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1264,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548596412",
      "pull_request_review_id": 1974917244,
      "id": 1548596412,
      "node_id": "PRRC_kwDOABII585cTbS8",
      "diff_hunk": "@@ -1593,26 +1693,53 @@ void PeerManagerImpl::FindNextBlocks(std::vector<const CBlockIndex*>& vBlocks, c\n \n void PeerManagerImpl::PushNodeVersion(CNode& pnode, const Peer& peer)\n {\n-    uint64_t my_services{peer.m_our_services};\n-    const int64_t nTime{count_seconds(GetTime<std::chrono::seconds>())};\n-    uint64_t nonce = pnode.GetLocalNonce();\n-    const int nNodeStartingHeight{m_best_height};\n-    NodeId nodeid = pnode.GetId();\n-    CAddress addr = pnode.addr;\n-\n-    CService addr_you = addr.IsRoutable() && !IsProxy(addr) && addr.IsAddrV1Compatible() ? addr : CService();\n-    uint64_t your_services{addr.nServices};\n-\n-    const bool tx_relay{!RejectIncomingTxs(pnode)};\n-    MakeAndPushMessage(pnode, NetMsgType::VERSION, PROTOCOL_VERSION, my_services, nTime,\n-            your_services, CNetAddr::V1(addr_you), // Together the pre-version-31402 serialization of CAddress \"addrYou\" (without nTime)\n-            my_services, CNetAddr::V1(CService{}), // Together the pre-version-31402 serialization of CAddress \"addrMe\" (without nTime)\n-            nonce, strSubVersion, nNodeStartingHeight, tx_relay);\n-\n+    uint64_t my_services;\n+    int64_t my_time;\n+    uint64_t your_services;\n+    CService your_addr;\n+    std::string my_user_agent;\n+    int my_height;\n+    bool my_tx_relay;\n+    if (pnode.IsPrivateBroadcastConn()) {\n+        my_services = NODE_NONE;\n+        my_time = 0;\n+        your_services = NODE_NONE;\n+        your_addr = CService{};\n+        my_user_agent = \"/pynode:0.0.1/\";\n+        my_height = 0;\n+        my_tx_relay = false;\n+    } else {\n+        CAddress addr{pnode.addr};\n+\n+        my_services = peer.m_our_services;\n+        my_time = count_seconds(GetTime<std::chrono::seconds>());\n+        your_services = addr.nServices;\n+        your_addr = addr.IsRoutable() && !IsProxy(addr) && addr.IsAddrV1Compatible() ? addr : CService{};\n+        my_user_agent = strSubVersion;\n+        my_height = m_best_height;\n+        my_tx_relay = !RejectIncomingTxs(pnode);\n+    }\n+\n+    MakeAndPushMessage(\n+        pnode,\n+        NetMsgType::VERSION,\n+        PROTOCOL_VERSION,\n+        my_services,\n+        my_time,\n+        // your_services + CNetAddr::V1(your_addr) is the pre-version-31402 serialization of your_addr (without nTime)\n+        your_services, CNetAddr::V1(your_addr),\n+        // same, for a dummy address\n+        my_services, CNetAddr::V1(CService{}),\n+        pnode.GetLocalNonce(),\n+        my_user_agent,\n+        my_height,\n+        my_tx_relay);\n+\n+    const NodeId nodeid{pnode.GetId()};\n     if (fLogIPs) {\n-        LogPrint(BCLog::NET, \"send version message: version %d, blocks=%d, them=%s, txrelay=%d, peer=%d\\n\", PROTOCOL_VERSION, nNodeStartingHeight, addr_you.ToStringAddrPort(), tx_relay, nodeid);\n+        LogPrint(BCLog::NET, \"send version message: version %d, blocks=%d, them=%s, txrelay=%d, peer=%d\\n\", PROTOCOL_VERSION, my_height, your_addr.ToStringAddrPort(), my_tx_relay, nodeid);\n     } else {\n-        LogPrint(BCLog::NET, \"send version message: version %d, blocks=%d, txrelay=%d, peer=%d\\n\", PROTOCOL_VERSION, nNodeStartingHeight, tx_relay, nodeid);\n+        LogPrint(BCLog::NET, \"send version message: version %d, blocks=%d, txrelay=%d, peer=%d\\n\", PROTOCOL_VERSION, my_height, my_tx_relay, nodeid);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 209,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e03f1b1eb04df0c3deead36d70c014f758e3647f",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Since we're touching these lines, maybe update to `LogPrintLevel`?",
      "created_at": "2024-04-02T20:55:59Z",
      "updated_at": "2024-04-02T21:56:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1548596412",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548596412"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1742,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1551588051",
      "pull_request_review_id": 1979741566,
      "id": 1551588051,
      "node_id": "PRRC_kwDOABII585ce1rT",
      "diff_hunk": "@@ -1143,15 +1217,41 @@ class PeerManagerImpl final : public PeerManager\n \n         using ByTxid = std::unordered_map<Txid, TxWithPriority, SaltedTxidHasher>;\n         using ByPriority = std::multimap<Priority, Txid>;\n+        using ByNodeId = std::unordered_map<NodeId, Txid>;\n \n         struct Iterators {\n             ByTxid::iterator by_txid;\n             ByPriority::iterator by_priority;\n         };\n \n+        /**\n+         * Get iterators in `m_by_txid` and `m_by_priority` for a given transaction.\n+         */\n+        std::optional<Iterators> Find(const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(m_mutex)",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 113,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e03f1b1eb04df0c3deead36d70c014f758e3647f",
      "in_reply_to_id": 1548580964,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Indeed the `Find()` method does not modify any of the members. I tried to make it `const`, but it has to return non-const iterators to the members... :(",
      "created_at": "2024-04-04T12:30:10Z",
      "updated_at": "2024-04-04T12:30:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1551588051",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1551588051"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1264,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1551600727",
      "pull_request_review_id": 1979762724,
      "id": 1551600727,
      "node_id": "PRRC_kwDOABII585ce4xX",
      "diff_hunk": "@@ -1097,6 +1101,58 @@ class PeerManagerImpl final : public PeerManager\n \n     void AddAddressKnown(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n     void PushAddress(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n+\n+    /**\n+     * Store a list of transactions to be broadcast privately. Supports the following operations:\n+     * - Add a new transaction\n+     * - Remove a transaction, after it has been seen by the network\n+     * - Mark a broadcast of a transaction (remember when and how many times)\n+     * - Get a transaction for broadcast, the one that has been broadcast less times and least recently",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 28,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "08c017b640a8d928f2b0ac32f1040e4b8372ae5f",
      "in_reply_to_id": 1548540109,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2024-04-04T12:38:01Z",
      "updated_at": "2024-04-04T12:38:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1551600727",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1551600727"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1551600883",
      "pull_request_review_id": 1979763009,
      "id": 1551600883,
      "node_id": "PRRC_kwDOABII585ce4zz",
      "diff_hunk": "@@ -1122,6 +1130,72 @@ class PeerManagerImpl final : public PeerManager\n             }\n         }\n \n+        /**\n+         * Get the transaction that has been broadcast less times and least recently.",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 31,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e03f1b1eb04df0c3deead36d70c014f758e3647f",
      "in_reply_to_id": 1548572949,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2024-04-04T12:38:08Z",
      "updated_at": "2024-04-04T12:38:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1551600883",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1551600883"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1134,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1551601200",
      "pull_request_review_id": 1979763592,
      "id": 1551601200,
      "node_id": "PRRC_kwDOABII585ce44w",
      "diff_hunk": "@@ -1593,26 +1693,53 @@ void PeerManagerImpl::FindNextBlocks(std::vector<const CBlockIndex*>& vBlocks, c\n \n void PeerManagerImpl::PushNodeVersion(CNode& pnode, const Peer& peer)\n {\n-    uint64_t my_services{peer.m_our_services};\n-    const int64_t nTime{count_seconds(GetTime<std::chrono::seconds>())};\n-    uint64_t nonce = pnode.GetLocalNonce();\n-    const int nNodeStartingHeight{m_best_height};\n-    NodeId nodeid = pnode.GetId();\n-    CAddress addr = pnode.addr;\n-\n-    CService addr_you = addr.IsRoutable() && !IsProxy(addr) && addr.IsAddrV1Compatible() ? addr : CService();\n-    uint64_t your_services{addr.nServices};\n-\n-    const bool tx_relay{!RejectIncomingTxs(pnode)};\n-    MakeAndPushMessage(pnode, NetMsgType::VERSION, PROTOCOL_VERSION, my_services, nTime,\n-            your_services, CNetAddr::V1(addr_you), // Together the pre-version-31402 serialization of CAddress \"addrYou\" (without nTime)\n-            my_services, CNetAddr::V1(CService{}), // Together the pre-version-31402 serialization of CAddress \"addrMe\" (without nTime)\n-            nonce, strSubVersion, nNodeStartingHeight, tx_relay);\n-\n+    uint64_t my_services;\n+    int64_t my_time;\n+    uint64_t your_services;\n+    CService your_addr;\n+    std::string my_user_agent;\n+    int my_height;\n+    bool my_tx_relay;\n+    if (pnode.IsPrivateBroadcastConn()) {\n+        my_services = NODE_NONE;\n+        my_time = 0;\n+        your_services = NODE_NONE;\n+        your_addr = CService{};\n+        my_user_agent = \"/pynode:0.0.1/\";\n+        my_height = 0;\n+        my_tx_relay = false;\n+    } else {\n+        CAddress addr{pnode.addr};\n+\n+        my_services = peer.m_our_services;\n+        my_time = count_seconds(GetTime<std::chrono::seconds>());\n+        your_services = addr.nServices;\n+        your_addr = addr.IsRoutable() && !IsProxy(addr) && addr.IsAddrV1Compatible() ? addr : CService{};\n+        my_user_agent = strSubVersion;\n+        my_height = m_best_height;\n+        my_tx_relay = !RejectIncomingTxs(pnode);\n+    }\n+\n+    MakeAndPushMessage(\n+        pnode,\n+        NetMsgType::VERSION,\n+        PROTOCOL_VERSION,\n+        my_services,\n+        my_time,\n+        // your_services + CNetAddr::V1(your_addr) is the pre-version-31402 serialization of your_addr (without nTime)\n+        your_services, CNetAddr::V1(your_addr),\n+        // same, for a dummy address\n+        my_services, CNetAddr::V1(CService{}),\n+        pnode.GetLocalNonce(),\n+        my_user_agent,\n+        my_height,\n+        my_tx_relay);\n+\n+    const NodeId nodeid{pnode.GetId()};\n     if (fLogIPs) {\n-        LogPrint(BCLog::NET, \"send version message: version %d, blocks=%d, them=%s, txrelay=%d, peer=%d\\n\", PROTOCOL_VERSION, nNodeStartingHeight, addr_you.ToStringAddrPort(), tx_relay, nodeid);\n+        LogPrint(BCLog::NET, \"send version message: version %d, blocks=%d, them=%s, txrelay=%d, peer=%d\\n\", PROTOCOL_VERSION, my_height, your_addr.ToStringAddrPort(), my_tx_relay, nodeid);\n     } else {\n-        LogPrint(BCLog::NET, \"send version message: version %d, blocks=%d, txrelay=%d, peer=%d\\n\", PROTOCOL_VERSION, nNodeStartingHeight, tx_relay, nodeid);\n+        LogPrint(BCLog::NET, \"send version message: version %d, blocks=%d, txrelay=%d, peer=%d\\n\", PROTOCOL_VERSION, my_height, my_tx_relay, nodeid);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 209,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e03f1b1eb04df0c3deead36d70c014f758e3647f",
      "in_reply_to_id": 1548596412,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2024-04-04T12:38:20Z",
      "updated_at": "2024-04-04T12:38:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1551601200",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1551601200"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1742,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1554905733",
      "pull_request_review_id": 1984991157,
      "id": 1554905733,
      "node_id": "PRRC_kwDOABII585crfqF",
      "diff_hunk": "@@ -2440,6 +2500,11 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         LogPrintf(\"Fixed seeds are disabled\\n\");\n     }\n \n+    // Private broadcast connections are opened with priority over others, but only half\n+    // of the time to avoid depriving other connection types if private broadcast is\n+    // needed but opening such connections is unsuccessful for some reason.",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 82,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "fe57027b3ef3164ce3eaeac877edce613782f3ed",
      "in_reply_to_id": null,
      "user": {
        "login": "nothingmuch",
        "id": 14242,
        "node_id": "MDQ6VXNlcjE0MjQy",
        "avatar_url": "https://avatars.githubusercontent.com/u/14242?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nothingmuch",
        "html_url": "https://github.com/nothingmuch",
        "followers_url": "https://api.github.com/users/nothingmuch/followers",
        "following_url": "https://api.github.com/users/nothingmuch/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nothingmuch/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nothingmuch/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nothingmuch/subscriptions",
        "organizations_url": "https://api.github.com/users/nothingmuch/orgs",
        "repos_url": "https://api.github.com/users/nothingmuch/repos",
        "events_url": "https://api.github.com/users/nothingmuch/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nothingmuch/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "With regards to this comment and:\r\n\r\n> We pick a random Tor (or I2P) peer.\r\n\r\nTo increase success rate and reduce latency, clearnet peers could be also be selected when using Tor, without harming privacy of broadcast...\r\n\r\nClearnet connections only need one Tor circuit, whereas hidden service connections which require two circuits for the connecting peer and one from the accepting peer.\r\n\r\nFurthermore, if SOCKS proxy credentials are reused for the broadcast of a single transaction (but not all transactions in the private broadcast queue), multiple connections could share the same circuit/exit node. This specific optimization does introduce a censorship risk (even if BIP 324 is used [edit: *due*] to the MITM consideration) and there precedent for such malicious exit nodes.\r\n\r\nFrom a privacy standpoint both optimizations would be more or less equivalent to broadcasting through isolated connections to peers with hidden service addresses, since the origin is still protected and being able to link these connections does not aid in deanonymization since these connections all pertain to the same data.\r\n\r\nThe main rationale for these optimizations is that Tor daemon builds circuits sequentially, and does not keep many built circuits in reserve (IIRC 2 unless their construction is explicitly requested through the control socket), so when SOCKS connections are opened with distinct credentials the connection establishment and time to first byte will typically scale linearly in the order that the SOCKS connections are accepted by tor daemon itself, and since building a new circuit can take on the order of seconds.",
      "created_at": "2024-04-07T10:34:05Z",
      "updated_at": "2024-04-08T16:36:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1554905733",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1554905733"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 2503,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2585,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1555541188",
      "pull_request_review_id": 1985948537,
      "id": 1555541188,
      "node_id": "PRRC_kwDOABII585ct6zE",
      "diff_hunk": "@@ -0,0 +1,312 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 68,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "9297437af2c2f45a7b9a12be78fa0e597c54ac79",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 9297437af2c2f45a7b9a12be78fa0e597c54ac79: Since the addrman is deterministic now, you can remove addresses that are conflicting.\r\n\r\n```diff\r\n--- a/test/functional/p2p_private_broadcast.py\r\n+++ b/test/functional/p2p_private_broadcast.py\r\n@@ -118,7 +118,6 @@ addresses = [\r\n     \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\r\n     \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\r\n     \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\r\n-    \"devinbtctu7uctl7hly2juu3thbgeivfnvw3ckj3phy6nyvpnx66yeyd.onion\",\r\n     \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\r\n     \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\r\n     \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\r\n```",
      "created_at": "2024-04-08T09:48:36Z",
      "updated_at": "2024-04-08T12:27:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1555541188",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1555541188"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 68,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1555757479",
      "pull_request_review_id": 1986301219,
      "id": 1555757479,
      "node_id": "PRRC_kwDOABII585cuvmn",
      "diff_hunk": "@@ -0,0 +1,312 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 68,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "9297437af2c2f45a7b9a12be78fa0e597c54ac79",
      "in_reply_to_id": 1555541188,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Also, maybe we do not need this verification anymore?\r\n```py\r\nif res[\"success\"]:\r\n    self.log.info(f\"Added {addr} to tx_originator's addrman\")\r\nelse:\r\n    self.log.info(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\r\n```",
      "created_at": "2024-04-08T12:37:21Z",
      "updated_at": "2024-04-08T12:37:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1555757479",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1555757479"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 68,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576618058",
      "pull_request_review_id": 2017849197,
      "id": 1576618058,
      "node_id": "PRRC_kwDOABII585d-UhK",
      "diff_hunk": "@@ -0,0 +1,312 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 68,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "9297437af2c2f45a7b9a12be78fa0e597c54ac79",
      "in_reply_to_id": 1555541188,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Right, removed the conflicting address and reduced the logging to log only if adding to the addrman fails.",
      "created_at": "2024-04-23T17:22:15Z",
      "updated_at": "2024-04-23T17:22:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1576618058",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576618058"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 68,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576619537",
      "pull_request_review_id": 2017851486,
      "id": 1576619537,
      "node_id": "PRRC_kwDOABII585d-U4R",
      "diff_hunk": "@@ -2440,6 +2500,11 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         LogPrintf(\"Fixed seeds are disabled\\n\");\n     }\n \n+    // Private broadcast connections are opened with priority over others, but only half\n+    // of the time to avoid depriving other connection types if private broadcast is\n+    // needed but opening such connections is unsuccessful for some reason.",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 82,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "fe57027b3ef3164ce3eaeac877edce613782f3ed",
      "in_reply_to_id": 1554905733,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I added broadcast to IPv4 and IPv6 peers through the Tor proxy. Thanks!",
      "created_at": "2024-04-23T17:23:17Z",
      "updated_at": "2024-04-23T17:23:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1576619537",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1576619537"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 2503,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2585,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578537557",
      "pull_request_review_id": 2020968807,
      "id": 1578537557,
      "node_id": "PRRC_kwDOABII585eFpJV",
      "diff_hunk": "@@ -120,6 +120,12 @@ bool WalletInit::ParameterInteraction() const\n         LogPrintf(\"%s: parameter interaction: -blocksonly=1 -> setting -walletbroadcast=0\\n\", __func__);\n     }\n \n+    if (gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST) &&",
      "path": "src/wallet/init.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "1407b3fa264b096813281a767da3cd3ca80ed096",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "have you considered using `SoftSetBoolArg` to set `-walletbroadcast` to 0 if `-privatebroadcast` was chosen?\r\nIt's not the most user-friendly thing to introduce a new command arg that would only work if another arg was also changed from its default.",
      "created_at": "2024-04-24T21:25:09Z",
      "updated_at": "2024-04-25T22:34:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1578537557",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1578537557"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 122,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1579852847",
      "pull_request_review_id": 2020968807,
      "id": 1579852847,
      "node_id": "PRRC_kwDOABII585eKqQv",
      "diff_hunk": "@@ -386,6 +386,27 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+/**\n+ * Check if private broadcast can be done to clearnet peers and if yes via which proxy.\n+ * If private broadcast connections should not be opened to `net`, then this will return an empty optional.\n+ */\n+static std::optional<Proxy> ProxyForClearnetPrivateBroadcast(Network clearnet)\n+{\n+    if (clearnet != NET_IPV4 && clearnet != NET_IPV6) {\n+        return std::nullopt;\n+    }\n+    Proxy tor_proxy;\n+    const std::string onion_arg{gArgs.GetArg(\"-onion\", \"\")};\n+    if (onion_arg != \"\" && onion_arg == \"0\" && GetProxy(NET_ONION, tor_proxy)) {\n+        // Use the Tor proxy (if provided) for private broadcast connections to clearnet peers.\n+        // Note: we check whether -onion is explicitly used because GetProxy(NET_ONION) may",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 17,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "6b4693ee859d6bddf559a0b32749b1dafe015ef4",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think this requires an update to `tor.md`, which currently says:\r\n`-onion=ip:port  Set the proxy server to use for Tor onion services. You do not need to set this if it's the same as -proxy.`\r\nAfter this PR, specifiying it explicitly is necessary if you want to do private broadcast to clearnet peers.",
      "created_at": "2024-04-25T17:12:46Z",
      "updated_at": "2024-04-25T22:34:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1579852847",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1579852847"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 406,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1579854025",
      "pull_request_review_id": 2020968807,
      "id": 1579854025,
      "node_id": "PRRC_kwDOABII585eKqjJ",
      "diff_hunk": "@@ -386,6 +386,27 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+/**\n+ * Check if private broadcast can be done to clearnet peers and if yes via which proxy.\n+ * If private broadcast connections should not be opened to `net`, then this will return an empty optional.\n+ */\n+static std::optional<Proxy> ProxyForClearnetPrivateBroadcast(Network clearnet)\n+{\n+    if (clearnet != NET_IPV4 && clearnet != NET_IPV6) {\n+        return std::nullopt;\n+    }\n+    Proxy tor_proxy;\n+    const std::string onion_arg{gArgs.GetArg(\"-onion\", \"\")};\n+    if (onion_arg != \"\" && onion_arg == \"0\" && GetProxy(NET_ONION, tor_proxy)) {",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 15,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "6b4693ee859d6bddf559a0b32749b1dafe015ef4",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "You probably meant `onion_arg != \"0\"`",
      "created_at": "2024-04-25T17:13:04Z",
      "updated_at": "2024-04-25T22:34:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1579854025",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1579854025"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 400,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1580115581",
      "pull_request_review_id": 2020968807,
      "id": 1580115581,
      "node_id": "PRRC_kwDOABII585eLqZ9",
      "diff_hunk": "@@ -3898,6 +3907,23 @@ bool CConnman::NodeFullyConnected(const CNode* pnode)\n void CConnman::PushMessage(CNode* pnode, CSerializedNetMsg&& msg)\n {\n     AssertLockNotHeld(m_total_bytes_sent_mutex);\n+\n+    if (pnode->IsPrivateBroadcastConn() &&\n+        msg.m_type != NetMsgType::VERSION &&\n+        msg.m_type != NetMsgType::VERACK &&\n+        msg.m_type != NetMsgType::TX &&\n+        msg.m_type != NetMsgType::PING) {\n+        // Ensure private broadcast connections only send the above message types.\n+        // Others are not needed and may degrade privacy.\n+        LogPrintLevel(BCLog::PRIVATE_BROADCAST,",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 30,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "ae6651d267895342c2794b62bf1f2e6d15867778",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "It looks like we make sure in `net_processing` to not send any of theses messages, and here we check again. I haven't thought about this long, but can this log be triggered, or could this be an `Assume(false)` instead?",
      "created_at": "2024-04-25T20:55:11Z",
      "updated_at": "2024-04-25T22:34:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1580115581",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1580115581"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4050,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1580149990",
      "pull_request_review_id": 2020968807,
      "id": 1580149990,
      "node_id": "PRRC_kwDOABII585eLyzm",
      "diff_hunk": "@@ -1097,6 +1101,58 @@ class PeerManagerImpl final : public PeerManager\n \n     void AddAddressKnown(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n     void PushAddress(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n+\n+    /**\n+     * Store a list of transactions to be broadcast privately. Supports the following operations:\n+     * - Add a new transaction\n+     * - Remove a transaction, after it has been seen by the network\n+     * - Mark a broadcast of a transaction (remember when and how many times)\n+     * - Get a transaction for broadcast, the one that has been broadcast fewer times and least recently\n+     */\n+    class PrivateBroadcast\n+    {\n+    public:\n+        void Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+        {\n+            const Txid& txid = tx->GetHash();\n+            LOCK(m_mutex);\n+            auto [pos, inserted] = m_by_txid.emplace(txid, TxWithPriority{.tx = tx, .priority = Priority{}});\n+            if (inserted) {\n+                m_by_priority.emplace(Priority{}, txid);\n+            }\n+        }\n+\n+    private:\n+        struct Priority {\n+            size_t num_broadcasted{0};\n+            std::chrono::microseconds last_broadcasted{0};\n+\n+            bool operator<(const Priority& other) const\n+            {\n+                if (num_broadcasted < other.num_broadcasted) {\n+                    return true;\n+                }\n+                return last_broadcasted < other.last_broadcasted;\n+            }\n+        };\n+\n+        struct TxWithPriority {\n+            CTransactionRef tx;\n+            Priority priority;\n+        };\n+\n+        using ByTxid = std::unordered_map<Txid, TxWithPriority, SaltedTxidHasher>;\n+        using ByPriority = std::multimap<Priority, Txid>;\n+\n+        struct Iterators {\n+            ByTxid::iterator by_txid;\n+            ByPriority::iterator by_priority;\n+        };\n+\n+        mutable Mutex m_mutex;\n+        ByTxid m_by_txid GUARDED_BY(m_mutex);\n+        ByPriority m_by_priority GUARDED_BY(m_mutex);\n+    } m_tx_for_private_broadcast;",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 73,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4a5433c3c8681198cfa342f8112e70828fa0ac04",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This class is getting pretty large in the end, maybe put it into its own module (similar to `TxReconciliationTracker` or `TxRequestTracker`)",
      "created_at": "2024-04-25T21:20:19Z",
      "updated_at": "2024-04-25T22:34:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1580149990",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1580149990"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1580200865",
      "pull_request_review_id": 2020968807,
      "id": 1580200865,
      "node_id": "PRRC_kwDOABII585eL_Oh",
      "diff_hunk": "@@ -0,0 +1,309 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"to_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"to_port\": p2p_port(1), # nodes[1] listen port\n+                    \"node\": None,\n+                    \"requested_to_addr\": None,\n+                })\n+            else:\n+                # Create a Python P2P listening node and add it to self.socks5_server.conf.destinations[]\n+                listener = P2PInterface()\n+                listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                listener.peer_connect_send_version(services=P2P_SERVICES)\n+                self.network_thread.listen(\n+                    p2p=listener,\n+                    # Instruct the SOCKS5 server to redirect a connection to this Python P2P listener.\n+                    callback=lambda addr, port: self.socks5_server.conf.destinations.append({\n+                        \"to_addr\": addr,\n+                        \"to_port\": port,\n+                        \"node\": None,\n+                        \"requested_to_addr\": None,\n+                    }),\n+                    addr=\"127.0.0.1\",\n+                    port=ports_base + i)\n+                # Wait until the callback has been called and it has done append().\n+                self.wait_until(lambda: len(self.socks5_server.conf.destinations) == i + 1)\n+\n+                self.socks5_server.conf.destinations[i][\"node\"] = listener\n+\n+        self.extra_args = [\n+            [\n+                \"-peerbloomfilters\", # needed to test replies to MEMPOOL",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 208,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "fd603b8f5c23c171e1cff70a73f5d64d6d74c4f7",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I don't think is needed, `MEMPOOL` is never tested.",
      "created_at": "2024-04-25T22:23:19Z",
      "updated_at": "2024-04-25T22:34:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1580200865",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1580200865"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 208,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1580205599",
      "pull_request_review_id": 2020968807,
      "id": 1580205599,
      "node_id": "PRRC_kwDOABII585eMAYf",
      "diff_hunk": "@@ -91,11 +94,23 @@ static RPCHelpMan sendrawtransaction()\n             std::string err_string;\n             AssertLockNotHeld(cs_main);\n             NodeContext& node = EnsureAnyNodeContext(request.context);\n+            const bool private_broadcast_enabled{gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)};\n+            if (private_broadcast_enabled &&\n+                !g_reachable_nets.Contains(NET_ONION) &&\n+                !g_reachable_nets.Contains(NET_I2P)) {\n+                throw JSONRPCError(RPC_MISC_ERROR,\n+                                   \"-privatebroadcast is enabled, but none of the Tor or I2P networks is \"",
      "path": "src/rpc/mempool.cpp",
      "position": 48,
      "original_position": 21,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "180e51a723520f530bb675e937eeaabebcc0b0b5",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "sendrawtransaction doc should be updated (it already mentions privacy issues).",
      "created_at": "2024-04-25T22:30:44Z",
      "updated_at": "2024-04-25T22:34:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1580205599",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1580205599"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 118,
      "original_line": 118,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1584709863",
      "pull_request_review_id": 2031166535,
      "id": 1584709863,
      "node_id": "PRRC_kwDOABII585edMDn",
      "diff_hunk": "@@ -2883,6 +3013,34 @@ void CConnman::OpenNetworkConnection(const CAddress& addrConnect, bool fCountFai\n     }\n }\n \n+void CConnman::PrivateBroadcastAdd(size_t n)\n+{\n+    const size_t before{m_private_broadcast_connections_to_open.fetch_add(n)};\n+\n+    LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                  BCLog::Level::Debug,\n+                  \"Request to increment the needed new connections by %d, changed from %d to %d\\n\",\n+                  n,\n+                  before,\n+                  before + n);\n+}\n+\n+void CConnman::PrivateBroadcastSub(size_t n)\n+{\n+    size_t before{m_private_broadcast_connections_to_open.load()};\n+    size_t desired;\n+    do {\n+        desired = before > n ? before - n : 0;\n+    } while (!m_private_broadcast_connections_to_open.compare_exchange_weak(before, desired));",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 261,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "6b4693ee859d6bddf559a0b32749b1dafe015ef4",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 6b4693ee859d6bddf559a0b32749b1dafe015ef4 \"net: implement opening PRIVATE_BROADCAST connections\": Just a question: why using `compare_exchange_weak` instead of `fetch_sub`? ",
      "created_at": "2024-04-30T12:22:03Z",
      "updated_at": "2024-04-30T12:22:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1584709863",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1584709863"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3102,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586316212",
      "pull_request_review_id": 2033662158,
      "id": 1586316212,
      "node_id": "PRRC_kwDOABII585ejUO0",
      "diff_hunk": "@@ -120,6 +120,12 @@ bool WalletInit::ParameterInteraction() const\n         LogPrintf(\"%s: parameter interaction: -blocksonly=1 -> setting -walletbroadcast=0\\n\", __func__);\n     }\n \n+    if (gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST) &&",
      "path": "src/wallet/init.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "1407b3fa264b096813281a767da3cd3ca80ed096",
      "in_reply_to_id": 1578537557,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, but I did not like the behavior of the wallet \"unexpectedly\" stopping to broadcast its own transactions because `-privatebroadcast` is enabled.\r\n\r\n> It's not the most user-friendly thing to introduce a new command arg that would only work if another arg was also changed from its default.\r\n\r\nYes, I agree. I do not like that either but somewhat prefer it over automatically switching off wallet broadcast. I can imagine GUI users who enable `-privatebroadcast` and still try to send transactions from their wallets and have no clue why they are not being mined.\r\n\r\nLeaving this open to discussion and proposals.",
      "created_at": "2024-05-01T13:46:03Z",
      "updated_at": "2024-05-01T13:46:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1586316212",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586316212"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 122,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586317728",
      "pull_request_review_id": 2033664674,
      "id": 1586317728,
      "node_id": "PRRC_kwDOABII585ejUmg",
      "diff_hunk": "@@ -386,6 +386,27 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+/**\n+ * Check if private broadcast can be done to clearnet peers and if yes via which proxy.\n+ * If private broadcast connections should not be opened to `net`, then this will return an empty optional.\n+ */\n+static std::optional<Proxy> ProxyForClearnetPrivateBroadcast(Network clearnet)\n+{\n+    if (clearnet != NET_IPV4 && clearnet != NET_IPV6) {\n+        return std::nullopt;\n+    }\n+    Proxy tor_proxy;\n+    const std::string onion_arg{gArgs.GetArg(\"-onion\", \"\")};\n+    if (onion_arg != \"\" && onion_arg == \"0\" && GetProxy(NET_ONION, tor_proxy)) {\n+        // Use the Tor proxy (if provided) for private broadcast connections to clearnet peers.\n+        // Note: we check whether -onion is explicitly used because GetProxy(NET_ONION) may",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 17,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "6b4693ee859d6bddf559a0b32749b1dafe015ef4",
      "in_reply_to_id": 1579852847,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Updated.",
      "created_at": "2024-05-01T13:47:33Z",
      "updated_at": "2024-05-01T13:47:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1586317728",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586317728"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 406,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586317921",
      "pull_request_review_id": 2033664971,
      "id": 1586317921,
      "node_id": "PRRC_kwDOABII585ejUph",
      "diff_hunk": "@@ -386,6 +386,27 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+/**\n+ * Check if private broadcast can be done to clearnet peers and if yes via which proxy.\n+ * If private broadcast connections should not be opened to `net`, then this will return an empty optional.\n+ */\n+static std::optional<Proxy> ProxyForClearnetPrivateBroadcast(Network clearnet)\n+{\n+    if (clearnet != NET_IPV4 && clearnet != NET_IPV6) {\n+        return std::nullopt;\n+    }\n+    Proxy tor_proxy;\n+    const std::string onion_arg{gArgs.GetArg(\"-onion\", \"\")};\n+    if (onion_arg != \"\" && onion_arg == \"0\" && GetProxy(NET_ONION, tor_proxy)) {",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 15,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "6b4693ee859d6bddf559a0b32749b1dafe015ef4",
      "in_reply_to_id": 1579854025,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, fixed!",
      "created_at": "2024-05-01T13:47:45Z",
      "updated_at": "2024-05-01T13:47:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1586317921",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586317921"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 400,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586318759",
      "pull_request_review_id": 2033666558,
      "id": 1586318759,
      "node_id": "PRRC_kwDOABII585ejU2n",
      "diff_hunk": "@@ -3898,6 +3907,23 @@ bool CConnman::NodeFullyConnected(const CNode* pnode)\n void CConnman::PushMessage(CNode* pnode, CSerializedNetMsg&& msg)\n {\n     AssertLockNotHeld(m_total_bytes_sent_mutex);\n+\n+    if (pnode->IsPrivateBroadcastConn() &&\n+        msg.m_type != NetMsgType::VERSION &&\n+        msg.m_type != NetMsgType::VERACK &&\n+        msg.m_type != NetMsgType::TX &&\n+        msg.m_type != NetMsgType::PING) {\n+        // Ensure private broadcast connections only send the above message types.\n+        // Others are not needed and may degrade privacy.\n+        LogPrintLevel(BCLog::PRIVATE_BROADCAST,",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 30,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "ae6651d267895342c2794b62bf1f2e6d15867778",
      "in_reply_to_id": 1580115581,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Added `Assume(false)` and a comment.",
      "created_at": "2024-05-01T13:48:14Z",
      "updated_at": "2024-05-01T13:48:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1586318759",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586318759"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4050,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586319178",
      "pull_request_review_id": 2033667197,
      "id": 1586319178,
      "node_id": "PRRC_kwDOABII585ejU9K",
      "diff_hunk": "@@ -1097,6 +1101,58 @@ class PeerManagerImpl final : public PeerManager\n \n     void AddAddressKnown(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n     void PushAddress(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n+\n+    /**\n+     * Store a list of transactions to be broadcast privately. Supports the following operations:\n+     * - Add a new transaction\n+     * - Remove a transaction, after it has been seen by the network\n+     * - Mark a broadcast of a transaction (remember when and how many times)\n+     * - Get a transaction for broadcast, the one that has been broadcast fewer times and least recently\n+     */\n+    class PrivateBroadcast\n+    {\n+    public:\n+        void Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+        {\n+            const Txid& txid = tx->GetHash();\n+            LOCK(m_mutex);\n+            auto [pos, inserted] = m_by_txid.emplace(txid, TxWithPriority{.tx = tx, .priority = Priority{}});\n+            if (inserted) {\n+                m_by_priority.emplace(Priority{}, txid);\n+            }\n+        }\n+\n+    private:\n+        struct Priority {\n+            size_t num_broadcasted{0};\n+            std::chrono::microseconds last_broadcasted{0};\n+\n+            bool operator<(const Priority& other) const\n+            {\n+                if (num_broadcasted < other.num_broadcasted) {\n+                    return true;\n+                }\n+                return last_broadcasted < other.last_broadcasted;\n+            }\n+        };\n+\n+        struct TxWithPriority {\n+            CTransactionRef tx;\n+            Priority priority;\n+        };\n+\n+        using ByTxid = std::unordered_map<Txid, TxWithPriority, SaltedTxidHasher>;\n+        using ByPriority = std::multimap<Priority, Txid>;\n+\n+        struct Iterators {\n+            ByTxid::iterator by_txid;\n+            ByPriority::iterator by_priority;\n+        };\n+\n+        mutable Mutex m_mutex;\n+        ByTxid m_by_txid GUARDED_BY(m_mutex);\n+        ByPriority m_by_priority GUARDED_BY(m_mutex);\n+    } m_tx_for_private_broadcast;",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 73,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4a5433c3c8681198cfa342f8112e70828fa0ac04",
      "in_reply_to_id": 1580149990,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, I was thinking the same. Moved away.",
      "created_at": "2024-05-01T13:48:37Z",
      "updated_at": "2024-05-01T13:48:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1586319178",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586319178"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1155,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586319383",
      "pull_request_review_id": 2033667535,
      "id": 1586319383,
      "node_id": "PRRC_kwDOABII585ejVAX",
      "diff_hunk": "@@ -0,0 +1,309 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"to_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"to_port\": p2p_port(1), # nodes[1] listen port\n+                    \"node\": None,\n+                    \"requested_to_addr\": None,\n+                })\n+            else:\n+                # Create a Python P2P listening node and add it to self.socks5_server.conf.destinations[]\n+                listener = P2PInterface()\n+                listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                listener.peer_connect_send_version(services=P2P_SERVICES)\n+                self.network_thread.listen(\n+                    p2p=listener,\n+                    # Instruct the SOCKS5 server to redirect a connection to this Python P2P listener.\n+                    callback=lambda addr, port: self.socks5_server.conf.destinations.append({\n+                        \"to_addr\": addr,\n+                        \"to_port\": port,\n+                        \"node\": None,\n+                        \"requested_to_addr\": None,\n+                    }),\n+                    addr=\"127.0.0.1\",\n+                    port=ports_base + i)\n+                # Wait until the callback has been called and it has done append().\n+                self.wait_until(lambda: len(self.socks5_server.conf.destinations) == i + 1)\n+\n+                self.socks5_server.conf.destinations[i][\"node\"] = listener\n+\n+        self.extra_args = [\n+            [\n+                \"-peerbloomfilters\", # needed to test replies to MEMPOOL",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 208,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "fd603b8f5c23c171e1cff70a73f5d64d6d74c4f7",
      "in_reply_to_id": 1580200865,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Removed.",
      "created_at": "2024-05-01T13:48:50Z",
      "updated_at": "2024-05-01T13:48:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1586319383",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586319383"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 208,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586319507",
      "pull_request_review_id": 2033667725,
      "id": 1586319507,
      "node_id": "PRRC_kwDOABII585ejVCT",
      "diff_hunk": "@@ -91,11 +94,23 @@ static RPCHelpMan sendrawtransaction()\n             std::string err_string;\n             AssertLockNotHeld(cs_main);\n             NodeContext& node = EnsureAnyNodeContext(request.context);\n+            const bool private_broadcast_enabled{gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)};\n+            if (private_broadcast_enabled &&\n+                !g_reachable_nets.Contains(NET_ONION) &&\n+                !g_reachable_nets.Contains(NET_I2P)) {\n+                throw JSONRPCError(RPC_MISC_ERROR,\n+                                   \"-privatebroadcast is enabled, but none of the Tor or I2P networks is \"",
      "path": "src/rpc/mempool.cpp",
      "position": 48,
      "original_position": 21,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "180e51a723520f530bb675e937eeaabebcc0b0b5",
      "in_reply_to_id": 1580205599,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Updated.",
      "created_at": "2024-05-01T13:48:58Z",
      "updated_at": "2024-05-01T13:48:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1586319507",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586319507"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 118,
      "original_line": 118,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586320176",
      "pull_request_review_id": 2033668893,
      "id": 1586320176,
      "node_id": "PRRC_kwDOABII585ejVMw",
      "diff_hunk": "@@ -2883,6 +3013,34 @@ void CConnman::OpenNetworkConnection(const CAddress& addrConnect, bool fCountFai\n     }\n }\n \n+void CConnman::PrivateBroadcastAdd(size_t n)\n+{\n+    const size_t before{m_private_broadcast_connections_to_open.fetch_add(n)};\n+\n+    LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                  BCLog::Level::Debug,\n+                  \"Request to increment the needed new connections by %d, changed from %d to %d\\n\",\n+                  n,\n+                  before,\n+                  before + n);\n+}\n+\n+void CConnman::PrivateBroadcastSub(size_t n)\n+{\n+    size_t before{m_private_broadcast_connections_to_open.load()};\n+    size_t desired;\n+    do {\n+        desired = before > n ? before - n : 0;\n+    } while (!m_private_broadcast_connections_to_open.compare_exchange_weak(before, desired));",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 261,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "6b4693ee859d6bddf559a0b32749b1dafe015ef4",
      "in_reply_to_id": 1584709863,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "To avoid negative values. I added a comment in the source code to explain.",
      "created_at": "2024-05-01T13:49:51Z",
      "updated_at": "2024-05-01T13:49:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1586320176",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586320176"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3102,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586454646",
      "pull_request_review_id": 2033880606,
      "id": 1586454646,
      "node_id": "PRRC_kwDOABII585ej2B2",
      "diff_hunk": "@@ -3898,6 +3907,23 @@ bool CConnman::NodeFullyConnected(const CNode* pnode)\n void CConnman::PushMessage(CNode* pnode, CSerializedNetMsg&& msg)\n {\n     AssertLockNotHeld(m_total_bytes_sent_mutex);\n+\n+    if (pnode->IsPrivateBroadcastConn() &&\n+        msg.m_type != NetMsgType::VERSION &&\n+        msg.m_type != NetMsgType::VERACK &&\n+        msg.m_type != NetMsgType::TX &&\n+        msg.m_type != NetMsgType::PING) {\n+        // Ensure private broadcast connections only send the above message types.\n+        // Others are not needed and may degrade privacy.\n+        LogPrintLevel(BCLog::PRIVATE_BROADCAST,",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 30,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "ae6651d267895342c2794b62bf1f2e6d15867778",
      "in_reply_to_id": 1580115581,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This was triggered in the fuzz tests. I could complicate the fuzz tests to avoid sending unwanted messages if the random node happens to be a private broadcast, but `CConnman::PushMessage()` is called from a lot of places including from the RPC and that may change in the future as well. It is somewhat hard to judge that nobody will call `PushMessage()` with an unwanted message. Thus I think it is better to assume that this is the real check here in `CConnman::PushMessage()` and that the one in `PeerManagerImpl::SendMessages()` is an optimization. Removed the `Assume(false)`.",
      "created_at": "2024-05-01T15:59:47Z",
      "updated_at": "2024-05-01T15:59:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1586454646",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1586454646"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4050,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1591511159",
      "pull_request_review_id": 2041604763,
      "id": 1591511159,
      "node_id": "PRRC_kwDOABII585e3Ih3",
      "diff_hunk": "@@ -120,6 +120,12 @@ bool WalletInit::ParameterInteraction() const\n         LogPrintf(\"%s: parameter interaction: -blocksonly=1 -> setting -walletbroadcast=0\\n\", __func__);\n     }\n \n+    if (gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST) &&",
      "path": "src/wallet/init.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "1407b3fa264b096813281a767da3cd3ca80ed096",
      "in_reply_to_id": 1578537557,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I was pretty confused about this, maybe because I misunderstood the proposal. By just reading what the help for `-privatebroadcast` I wouldn't assume that transactions made using the wallet won't be broadcast. My understanding was that anything done via the wallet would work as usual, but that transactions sent via `sendrawtransaction` would use the private broadcast mechanism if set.\r\n\r\nI think this should be mentioned in the help of `-privatebroadcast`.",
      "created_at": "2024-05-06T20:18:49Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1591511159",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1591511159"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 122,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1591513311",
      "pull_request_review_id": 2041604763,
      "id": 1591513311,
      "node_id": "PRRC_kwDOABII585e3JDf",
      "diff_hunk": "@@ -655,11 +656,12 @@ class NetinfoRequestHandler : public BaseRequestHandler\n         \"           \\\"in\\\"  - inbound connections are those initiated by the peer\\n\"\n         \"           \\\"out\\\" - outbound connections are those initiated by us\\n\"\n         \"  type     Type of peer connection\\n\"\n-        \"           \\\"full\\\"   - full relay, the default\\n\"\n-        \"           \\\"block\\\"  - block relay; like full relay but does not relay transactions or addresses\\n\"\n-        \"           \\\"manual\\\" - peer we manually added using RPC addnode or the -addnode/-connect config options\\n\"\n-        \"           \\\"feeler\\\" - short-lived connection for testing addresses\\n\"\n-        \"           \\\"addr\\\"   - address fetch; short-lived connection for requesting addresses\\n\"\n+        \"           \\\"full\\\"      - full relay, the default\\n\"\n+        \"           \\\"block\\\"     - block relay; like full relay but does not relay transactions or addresses\\n\"\n+        \"           \\\"manual\\\"    - peer we manually added using RPC addnode or the -addnode/-connect config options\\n\"\n+        \"           \\\"feeler\\\"    - short-lived connection for testing addresses\\n\"\n+        \"           \\\"addr\\\"      - address fetch; short-lived connection for requesting addresses\\n\"\n+        \"           \\\"privat\\\"    - private broadcast; short-lived connection for broadcasting our transactions\\n\"",
      "path": "src/bitcoin-cli.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "c7e4d5cb2bf01d9719702e71c8d6264ee670e988",
      "in_reply_to_id": 1545397035,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'd go with priv, but just my opinion",
      "created_at": "2024-05-06T20:21:06Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1591513311",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1591513311"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 691,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595556422",
      "pull_request_review_id": 2041604763,
      "id": 1595556422,
      "node_id": "PRRC_kwDOABII585fGkJG",
      "diff_hunk": "@@ -71,6 +71,8 @@ static const int MAX_ADDNODE_CONNECTIONS = 8;\n static const int MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2;\n /** Maximum number of feeler connections */\n static const int MAX_FEELER_CONNECTIONS = 1;\n+/** Maximum number of private broadcast connections */\n+static constexpr size_t MAX_PRIVATE_BROADCAST_CONNECTIONS{64};",
      "path": "src/net.h",
      "position": 5,
      "original_position": 5,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd\r\n\r\nWhat is the rationale for 64? That seems like a lot of connections.",
      "created_at": "2024-05-09T14:48:50Z",
      "updated_at": "2024-05-13T14:57:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1595556422",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595556422"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 77,
      "original_line": 77,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595743723",
      "pull_request_review_id": 2041604763,
      "id": 1595743723,
      "node_id": "PRRC_kwDOABII585fHR3r",
      "diff_hunk": "@@ -386,6 +386,27 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+/**\n+ * Check if private broadcast can be done to clearnet peers and if yes via which proxy.\n+ * If private broadcast connections should not be opened to `net`, then this will return an empty optional.\n+ */\n+static std::optional<Proxy> ProxyForClearnetPrivateBroadcast(Network clearnet)\n+{\n+    if (clearnet != NET_IPV4 && clearnet != NET_IPV6) {\n+        return std::nullopt;\n+    }\n+    Proxy tor_proxy;\n+    const std::string onion_arg{gArgs.GetArg(\"-onion\", \"\")};\n+    if (onion_arg != \"\" && onion_arg == \"0\" && GetProxy(NET_ONION, tor_proxy)) {\n+        // Use the Tor proxy (if provided) for private broadcast connections to clearnet peers.\n+        // Note: we check whether -onion is explicitly used because GetProxy(NET_ONION) may",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 17,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "6b4693ee859d6bddf559a0b32749b1dafe015ef4",
      "in_reply_to_id": 1579852847,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Is there no better way of checking whether `-proxy` is an actual Tor proxy or just a regular SOCKS5 proxy? It feels like the amount of custom settings that this will require to run will make it hard to use",
      "created_at": "2024-05-09T17:15:24Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1595743723",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595743723"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 406,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595748248",
      "pull_request_review_id": 2041604763,
      "id": 1595748248,
      "node_id": "PRRC_kwDOABII585fHS-Y",
      "diff_hunk": "@@ -386,6 +386,27 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+/**\n+ * Check if private broadcast can be done to clearnet peers and if yes via which proxy.",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 5,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd:\r\n\r\nnit: if yes -> if so",
      "created_at": "2024-05-09T17:17:54Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1595748248",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595748248"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 390,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595750204",
      "pull_request_review_id": 2041604763,
      "id": 1595750204,
      "node_id": "PRRC_kwDOABII585fHTc8",
      "diff_hunk": "@@ -386,6 +386,27 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+/**\n+ * Check if private broadcast can be done to clearnet peers and if yes via which proxy.\n+ * If private broadcast connections should not be opened to `net`, then this will return an empty optional.\n+ */\n+static std::optional<Proxy> ProxyForClearnetPrivateBroadcast(Network clearnet)",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 8,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd:\r\n\r\nnit: sorry for bikeshedding `clearnet` doesn't seem the best name for this. Maybe `net` or `network`?\r\n\r\n",
      "created_at": "2024-05-09T17:19:45Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1595750204",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595750204"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 393,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595750802",
      "pull_request_review_id": 2041604763,
      "id": 1595750802,
      "node_id": "PRRC_kwDOABII585fHTmS",
      "diff_hunk": "@@ -386,6 +386,27 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+/**\n+ * Check if private broadcast can be done to clearnet peers and if yes via which proxy.\n+ * If private broadcast connections should not be opened to `net`, then this will return an empty optional.\n+ */\n+static std::optional<Proxy> ProxyForClearnetPrivateBroadcast(Network clearnet)",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 8,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": 1595750204,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Also, this is already referenced as `net` in the docs",
      "created_at": "2024-05-09T17:20:08Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1595750802",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595750802"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 393,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595772136",
      "pull_request_review_id": 2041604763,
      "id": 1595772136,
      "node_id": "PRRC_kwDOABII585fHYzo",
      "diff_hunk": "@@ -456,14 +477,24 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n \n     for (auto& target_addr: connect_to) {\n         if (target_addr.IsValid()) {\n-            const bool use_proxy{GetProxy(target_addr.GetNetwork(), proxy)};\n+            bool use_proxy{GetProxy(addrConnect.GetNetwork(), proxy)};\n+            if (conn_type == ConnectionType::PRIVATE_BROADCAST) {\n+                const auto proxy_opt{ProxyForClearnetPrivateBroadcast(addrConnect.GetNetwork())};\n+                if (proxy_opt.has_value()) {\n+                    use_proxy = true;\n+                    proxy = proxy_opt.value();\n+                }\n+            }",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 40,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd\r\n\r\nThe way you are defining `use_proxy` could lead to `proxy_opt` having no value, yet `use_proxy` being `true`\r\n\r\n```suggestion\r\n            bool use_proxy;\r\n            if (conn_type == ConnectionType::PRIVATE_BROADCAST) {\r\n                const auto proxy_opt{ProxyForClearnetPrivateBroadcast(addrConnect.GetNetwork())};\r\n                if (proxy_opt.has_value()) {\r\n                    use_proxy = true;\r\n                    proxy = proxy_opt.value();\r\n                }\r\n            } else {\r\n                use_proxy = GetProxy(addrConnect.GetNetwork(), proxy);\r\n            }\r\n```",
      "created_at": "2024-05-09T17:37:54Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1595772136",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595772136"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 480,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 486,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595773620",
      "pull_request_review_id": 2041604763,
      "id": 1595773620,
      "node_id": "PRRC_kwDOABII585fHZK0",
      "diff_hunk": "@@ -456,14 +477,24 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n \n     for (auto& target_addr: connect_to) {\n         if (target_addr.IsValid()) {\n-            const bool use_proxy{GetProxy(target_addr.GetNetwork(), proxy)};\n+            bool use_proxy{GetProxy(addrConnect.GetNetwork(), proxy)};\n+            if (conn_type == ConnectionType::PRIVATE_BROADCAST) {\n+                const auto proxy_opt{ProxyForClearnetPrivateBroadcast(addrConnect.GetNetwork())};\n+                if (proxy_opt.has_value()) {\n+                    use_proxy = true;\n+                    proxy = proxy_opt.value();\n+                }\n+            }",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 40,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": 1595772136,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`use_proxy` can even be defined right after `proxy` (a few lined above) for simplicity ",
      "created_at": "2024-05-09T17:39:28Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1595773620",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595773620"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 480,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 486,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595793107",
      "pull_request_review_id": 2041604763,
      "id": 1595793107,
      "node_id": "PRRC_kwDOABII585fHd7T",
      "diff_hunk": "@@ -456,14 +477,24 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n \n     for (auto& target_addr: connect_to) {\n         if (target_addr.IsValid()) {\n-            const bool use_proxy{GetProxy(target_addr.GetNetwork(), proxy)};\n+            bool use_proxy{GetProxy(addrConnect.GetNetwork(), proxy)};\n+            if (conn_type == ConnectionType::PRIVATE_BROADCAST) {\n+                const auto proxy_opt{ProxyForClearnetPrivateBroadcast(addrConnect.GetNetwork())};\n+                if (proxy_opt.has_value()) {\n+                    use_proxy = true;\n+                    proxy = proxy_opt.value();\n+                }\n+            }\n             bool proxyConnectionFailed = false;\n \n             if (target_addr.IsI2P() && use_proxy) {\n                 i2p::Connection conn;\n                 bool connected{false};\n \n-                if (m_i2p_sam_session) {\n+                // If an I2P SAM session already exists, normally we would re-use it. But in the case of\n+                // private broadcast we force a new transient session. A Connect() using m_i2p_sam_session\n+                // would use our permanent I2P address as a source address.\n+                if (m_i2p_sam_session && conn_type != ConnectionType::PRIVATE_BROADCAST) {",
      "path": "src/net.cpp",
      "position": 26,
      "original_position": 51,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd\r\n\r\nI'm confused here. We choose not to use our permanent `m_i2p_sam_session` to avoid linking this to our permanent I2P ID, however, we use a pool of transient I2P sessions (`m_unused_i2p_sessions`) instead. I understand these transient sessions can be reused (or at least that's what I get from the docs of `m_unused_i2p_sessions`). So if the same `(peer, session_id)` pair is picked, the node will know that we created both transactions, wouldn't it?",
      "created_at": "2024-05-09T17:57:15Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1595793107",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595793107"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 473,
      "original_line": 473,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595819770",
      "pull_request_review_id": 2041604763,
      "id": 1595819770,
      "node_id": "PRRC_kwDOABII585fHkb6",
      "diff_hunk": "@@ -2605,18 +2721,19 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         bool fFeeler = false;\n         std::optional<Network> preferred_net;\n \n-        // Determine what type of connection to open. Opening\n-        // BLOCK_RELAY connections to addresses from anchors.dat gets the highest\n-        // priority. Then we open OUTBOUND_FULL_RELAY priority until we\n-        // meet our full-relay capacity. Then we open BLOCK_RELAY connection\n-        // until we hit our block-relay-only peer limit.\n-        // GetTryNewOutboundPeer() gets set when a stale tip is detected, so we\n-        // try opening an additional OUTBOUND_FULL_RELAY connection. If none of\n-        // these conditions are met, check to see if it's time to try an extra\n-        // block-relay-only peer (to confirm our tip is current, see below) or the next_feeler\n-        // timer to decide if we should open a FEELER.\n-\n-        if (!m_anchors.empty() && (nOutboundBlockRelay < m_max_outbound_block_relay)) {\n+        // Determine what type of connection to open, in order of priority:\n+        // * PRIVATE_BROADCAST if needed\n+        // * BLOCK_RELAY connections to addresses from anchors.dat until we reach m_max_outbound_block_relay\n+        // * OUTBOUND_FULL_RELAY until we reach m_max_outbound_full_relay\n+        // * BLOCK_RELAY until we reach m_max_outbound_block_relay\n+        // * OUTBOUND_FULL_RELAY if GetTryNewOutboundPeer() is true (a stale tip is detected)\n+        // * BLOCK_RELAY if it's time to try an extra block-relay-only peer (to confirm our tip is current)\n+        // * FEELER if it's time to try a feeler\n+        // * else retry the loop (sleep a bit and start from the top of this list)\n+\n+        if (open_private_broadcast_to.has_value()) {\n+            conn_type = ConnectionType::PRIVATE_BROADCAST;",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 205,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd\r\n\r\nI don't think we should be giving `PRIVATE_BROADCAST` priority over every other type of connection. At the very least, they should go after `BLOCK_RELAY`.\r\n\r\nHaving connections that keep us up to date should be more important than sending out our own stuff",
      "created_at": "2024-05-09T18:21:16Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1595819770",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595819770"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 2734,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2744,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595875212",
      "pull_request_review_id": 2041604763,
      "id": 1595875212,
      "node_id": "PRRC_kwDOABII585fHx-M",
      "diff_hunk": "@@ -2452,6 +2483,72 @@ bool CConnman::MaybePickPreferredNetwork(std::optional<Network>& network)\n     return false;\n }\n \n+/**\n+ * Decide whether to open a private broadcast connection and if yes, to which network.\n+ * @param[in] prev_was_private_broadcast Whether the previous attempt to open a connection\n+ * was an attempt to open a private broadcast connection (successful or not).\n+ * @param[in] num_needed Number of private broadcast connections that need to be opened.",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 63,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd\r\n\r\nThis took me a while to grasp. `num_needed` is set to `m_private_broadcast_connections_to_open.load()`, which is only set to anything above 0 **if there are transactions pending to be broadcast**.\r\n\r\nI think it'd be good to clarify this here, to make it clear that we won't try to open a connection of this type if we have no transactions pending ",
      "created_at": "2024-05-09T19:20:07Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1595875212",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1595875212"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2497,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596830944",
      "pull_request_review_id": 2041604763,
      "id": 1596830944,
      "node_id": "PRRC_kwDOABII585fLbTg",
      "diff_hunk": "@@ -179,6 +180,9 @@ static constexpr size_t MAX_ADDR_PROCESSING_TOKEN_BUCKET{MAX_ADDR_TO_SEND};\n /** The compactblocks version we support. See BIP 152. */\n static constexpr uint64_t CMPCTBLOCKS_VERSION{2};\n ",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 11,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "434a20371e441660147da6d0c6c1832cb0d0073b",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 434a20371e441660147da6d0c6c1832cb0d0073b\r\n\r\nnit: remove line break",
      "created_at": "2024-05-10T14:27:46Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1596830944",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596830944"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 182,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596831509",
      "pull_request_review_id": 2041604763,
      "id": 1596831509,
      "node_id": "PRRC_kwDOABII585fLbcV",
      "diff_hunk": "@@ -179,6 +180,9 @@ static constexpr size_t MAX_ADDR_PROCESSING_TOKEN_BUCKET{MAX_ADDR_TO_SEND};\n /** The compactblocks version we support. See BIP 152. */\n static constexpr uint64_t CMPCTBLOCKS_VERSION{2};\n \n+/** For private broadcast, send a transaction to this many peers per one broadcast attempt. */",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 12,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "434a20371e441660147da6d0c6c1832cb0d0073b",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 434a20371e441660147da6d0c6c1832cb0d0073b\r\n\r\nnit: per one -> for each",
      "created_at": "2024-05-10T14:28:15Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1596831509",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596831509"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 183,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596833034",
      "pull_request_review_id": 2041604763,
      "id": 1596833034,
      "node_id": "PRRC_kwDOABII585fLb0K",
      "diff_hunk": "@@ -1175,6 +1180,8 @@ class PeerManagerImpl final : public PeerManager\n \n     void AddAddressKnown(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n     void PushAddress(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n+",
      "path": "src/net_processing.cpp",
      "position": 67,
      "original_position": 30,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "434a20371e441660147da6d0c6c1832cb0d0073b",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 434a20371e441660147da6d0c6c1832cb0d0073b\r\n\r\nThis is missing docs",
      "created_at": "2024-05-10T14:29:29Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1596833034",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596833034"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1087,
      "original_line": 1087,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596835091",
      "pull_request_review_id": 2041604763,
      "id": 1596835091,
      "node_id": "PRRC_kwDOABII585fLcUT",
      "diff_hunk": "@@ -2341,6 +2348,19 @@ void PeerManagerImpl::ScheduleTxForBroadcastToAll(const uint256& txid, const uin\n     };\n }\n \n+void PeerManagerImpl::ScheduleTxForPrivateBroadcast(const CTransactionRef& tx)\n+{\n+    m_tx_for_private_broadcast.Add(tx);\n+\n+    LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                  BCLog::Level::Debug,\n+                  \"Requesting %d new connections due to txid=%s, wtxid=%s\\n\",",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 45,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "434a20371e441660147da6d0c6c1832cb0d0073b",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 434a20371e441660147da6d0c6c1832cb0d0073b\r\n\r\nI don't follow this log. What is the \"due to ...\" trying to convey here?",
      "created_at": "2024-05-10T14:31:13Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1596835091",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596835091"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2459,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596842874",
      "pull_request_review_id": 2041604763,
      "id": 1596842874,
      "node_id": "PRRC_kwDOABII585fLeN6",
      "diff_hunk": "@@ -0,0 +1,55 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_PRIVATE_BROADCAST_H\n+#define BITCOIN_PRIVATE_BROADCAST_H\n+\n+#include <primitives/transaction.h>\n+#include <sync.h>\n+#include <threadsafety.h>\n+#include <util/hasher.h>\n+\n+#include <chrono>\n+#include <map>\n+#include <unordered_map>\n+\n+/**\n+ * Store a list of transactions to be broadcast privately. Supports the following operations:\n+ * - Add a new transaction\n+ * - Remove a transaction, after it has been seen by the network\n+ * - Mark a broadcast of a transaction (remember when and how many times)\n+ * - Get a transaction for broadcast, the one that has been broadcast fewer times and least recently",
      "path": "src/private_broadcast.h",
      "position": 26,
      "original_position": 22,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "434a20371e441660147da6d0c6c1832cb0d0073b",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 434a20371e441660147da6d0c6c1832cb0d0073b\r\n\r\nnit: I don't think these belong to this commit yet",
      "created_at": "2024-05-10T14:37:44Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1596842874",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596842874"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 24,
      "original_start_line": 20,
      "start_side": "RIGHT",
      "line": 26,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596847026",
      "pull_request_review_id": 2041604763,
      "id": 1596847026,
      "node_id": "PRRC_kwDOABII585fLfOy",
      "diff_hunk": "@@ -0,0 +1,23 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers",
      "path": "src/private_broadcast.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "434a20371e441660147da6d0c6c1832cb0d0073b",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 434a20371e441660147da6d0c6c1832cb0d0073b\r\n\r\nnit: 2024",
      "created_at": "2024-05-10T14:41:18Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1596847026",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596847026"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596847172",
      "pull_request_review_id": 2041604763,
      "id": 1596847172,
      "node_id": "PRRC_kwDOABII585fLfRE",
      "diff_hunk": "@@ -0,0 +1,55 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers",
      "path": "src/private_broadcast.h",
      "position": 1,
      "original_position": 1,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "434a20371e441660147da6d0c6c1832cb0d0073b",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 434a20371e441660147da6d0c6c1832cb0d0073b\r\n\r\nnit: 2024",
      "created_at": "2024-05-10T14:41:25Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1596847172",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596847172"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596937357",
      "pull_request_review_id": 2041604763,
      "id": 1596937357,
      "node_id": "PRRC_kwDOABII585fL1SN",
      "diff_hunk": "@@ -1566,26 +1665,53 @@ void PeerManagerImpl::FindNextBlocks(std::vector<const CBlockIndex*>& vBlocks, c\n \n void PeerManagerImpl::PushNodeVersion(CNode& pnode, const Peer& peer)\n {\n-    uint64_t my_services{peer.m_our_services};\n-    const int64_t nTime{count_seconds(GetTime<std::chrono::seconds>())};\n-    uint64_t nonce = pnode.GetLocalNonce();\n-    const int nNodeStartingHeight{m_best_height};\n-    NodeId nodeid = pnode.GetId();\n-    CAddress addr = pnode.addr;\n-\n-    CService addr_you = addr.IsRoutable() && !IsProxy(addr) && addr.IsAddrV1Compatible() ? addr : CService();\n-    uint64_t your_services{addr.nServices};\n-\n-    const bool tx_relay{!RejectIncomingTxs(pnode)};\n-    MakeAndPushMessage(pnode, NetMsgType::VERSION, PROTOCOL_VERSION, my_services, nTime,\n-            your_services, CNetAddr::V1(addr_you), // Together the pre-version-31402 serialization of CAddress \"addrYou\" (without nTime)\n-            my_services, CNetAddr::V1(CService{}), // Together the pre-version-31402 serialization of CAddress \"addrMe\" (without nTime)\n-            nonce, strSubVersion, nNodeStartingHeight, tx_relay);\n-\n+    uint64_t my_services;\n+    int64_t my_time;\n+    uint64_t your_services;\n+    CService your_addr;\n+    std::string my_user_agent;\n+    int my_height;\n+    bool my_tx_relay;\n+    if (pnode.IsPrivateBroadcastConn()) {\n+        my_services = NODE_NONE;\n+        my_time = 0;\n+        your_services = NODE_NONE;\n+        your_addr = CService{};\n+        my_user_agent = \"/pynode:0.0.1/\";",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 172,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "07dee91112189be02c6694385de261570725b56b",
      "in_reply_to_id": 1518263617,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think `/pynode:0.0.1/` is as good as any other of the options commented on the linked thread, but having a comment there specifying why this was picked is worth. Any future traveller will be so confuse to see that user agent without context ",
      "created_at": "2024-05-10T16:03:32Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1596937357",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596937357"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1528,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596947249",
      "pull_request_review_id": 2041604763,
      "id": 1596947249,
      "node_id": "PRRC_kwDOABII585fL3sx",
      "diff_hunk": "@@ -1622,26 +1630,66 @@ void PeerManagerImpl::FindNextBlocks(std::vector<const CBlockIndex*>& vBlocks, c\n \n void PeerManagerImpl::PushNodeVersion(CNode& pnode, const Peer& peer)\n {\n-    uint64_t my_services{peer.m_our_services};\n-    const int64_t nTime{count_seconds(GetTime<std::chrono::seconds>())};\n-    uint64_t nonce = pnode.GetLocalNonce();\n-    const int nNodeStartingHeight{m_best_height};\n-    NodeId nodeid = pnode.GetId();\n-    CAddress addr = pnode.addr;\n-\n-    CService addr_you = addr.IsRoutable() && !IsProxy(addr) && addr.IsAddrV1Compatible() ? addr : CService();\n-    uint64_t your_services{addr.nServices};\n-\n-    const bool tx_relay{!RejectIncomingTxs(pnode)};\n-    MakeAndPushMessage(pnode, NetMsgType::VERSION, PROTOCOL_VERSION, my_services, nTime,\n-            your_services, CNetAddr::V1(addr_you), // Together the pre-version-31402 serialization of CAddress \"addrYou\" (without nTime)\n-            my_services, CNetAddr::V1(CService{}), // Together the pre-version-31402 serialization of CAddress \"addrMe\" (without nTime)\n-            nonce, strSubVersion, nNodeStartingHeight, tx_relay);\n-\n+    uint64_t my_services;\n+    int64_t my_time;\n+    uint64_t your_services;\n+    CService your_addr;\n+    std::string my_user_agent;\n+    int my_height;\n+    bool my_tx_relay;",
      "path": "src/net_processing.cpp",
      "position": 127,
      "original_position": 52,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "fecab592de8d0994e6d61e454e118d652ffd7b93",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In fecab592de8d0994e6d61e454e118d652ffd7b93\r\n\r\nmicro-nit: There is no `your_` counterparty for this, so there's no need to call them `my_`. This is kind of assumed ",
      "created_at": "2024-05-10T16:12:54Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1596947249",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596947249"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1548,
      "original_start_line": 1637,
      "start_side": "RIGHT",
      "line": 1550,
      "original_line": 1550,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596957262",
      "pull_request_review_id": 2041604763,
      "id": 1596957262,
      "node_id": "PRRC_kwDOABII585fL6JO",
      "diff_hunk": "@@ -5155,6 +5282,17 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                     if (ping_time.count() >= 0) {\n                         // Let connman know about this successful ping-pong\n                         pfrom.PongReceived(ping_time);\n+                        if (pfrom.IsPrivateBroadcastConn()) {\n+                            m_tx_for_private_broadcast.BroadcastEnd(pfrom.GetId(), /*confirmed_by_node=*/true);\n+                            LogPrintLevel(\n+                                BCLog::PRIVATE_BROADCAST,\n+                                BCLog::Level::Info,\n+                                \"Got a PONG (probably the transaction will reach the network), \"",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 243,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "fecab592de8d0994e6d61e454e118d652ffd7b93",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In fecab592de8d0994e6d61e454e118d652ffd7b93\r\n\r\nnit:\r\n\r\n```suggestion\r\n                                \"Got a PONG (the transaction will probably reach the network), \"\r\n```",
      "created_at": "2024-05-10T16:22:25Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1596957262",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596957262"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 5290,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596958082",
      "pull_request_review_id": 2041604763,
      "id": 1596958082,
      "node_id": "PRRC_kwDOABII585fL6WC",
      "diff_hunk": "@@ -1790,6 +1838,17 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n         LOCK(m_headers_presync_mutex);\n         m_headers_presync_stats.erase(nodeid);\n     }\n+    // This is done when we get a PONG from the peer. Repeat here too in case we never receive a PONG.\n+    if (node.IsPrivateBroadcastConn() &&\n+        m_tx_for_private_broadcast.BroadcastEnd(nodeid, /*confirmed_by_node=*/false)) {\n+\n+        LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                      BCLog::Level::Info,\n+                      \"Never got a PONG (probably the transaction will not \"",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 121,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "fecab592de8d0994e6d61e454e118d652ffd7b93",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In fecab592de8d0994e6d61e454e118d652ffd7b93\r\n\r\n```suggestion\r\n                      \"Never got a PONG (the transaction will probably not \"\r\n```",
      "created_at": "2024-05-10T16:23:12Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1596958082",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596958082"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1847,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596988561",
      "pull_request_review_id": 2041604763,
      "id": 1596988561,
      "node_id": "PRRC_kwDOABII585fMByR",
      "diff_hunk": "@@ -26,6 +29,26 @@ class PrivateBroadcast\n public:\n     void Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n \n+    /**\n+     * Get the transaction that has been broadcast fewest times and least recently.\n+     */\n+    std::optional<CTransactionRef> GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+    /**\n+     * Mark a transaction as pushed to a given node. This is an intermediate state before\n+     * we get a PONG from the node which would confirm that the transaction has been received.\n+     * At the time we get the PONG we need to know which transaction we sent to that node,\n+     * so that we can account how many times we broadcast each transaction.\n+     */\n+    void PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+    /**\n+     * Mark the end of a broadcast of a transaction. Either successful by receiving a PONG,\n+     * or unsuccessful by closing the connection to the node without getting PONG.\n+     * @return true if the reference by the given node id was removed\n+     */\n+    bool BroadcastEnd(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);",
      "path": "src/private_broadcast.h",
      "position": 1,
      "original_position": 39,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "fecab592de8d0994e6d61e454e118d652ffd7b93",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In fecab592de8d0994e6d61e454e118d652ffd7b93\r\n\r\n`FinishBroadcast` may sound better",
      "created_at": "2024-05-10T16:49:58Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1596988561",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1596988561"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 50,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1597007136",
      "pull_request_review_id": 2041604763,
      "id": 1597007136,
      "node_id": "PRRC_kwDOABII585fMGUg",
      "diff_hunk": "@@ -14,10 +15,78 @@ void PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!\n     }\n }\n \n+std::optional<CTransactionRef> PrivateBroadcast::GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    if (m_by_priority.empty()) {\n+        return std::nullopt;\n+    }\n+    const Txid& txid = m_by_priority.begin()->second;\n+    auto it = m_by_txid.find(txid);\n+    if (Assume(it != m_by_txid.end())) {\n+        return it->second.tx;\n+    }\n+    m_by_priority.erase(m_by_priority.begin());\n+    return std::nullopt;\n+}\n+\n+void PrivateBroadcast::PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    m_by_nodeid.emplace(nodeid, txid);\n+}\n+\n+bool PrivateBroadcast::BroadcastEnd(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    auto it = m_by_nodeid.find(nodeid);\n+    if (it == m_by_nodeid.end()) {\n+        return false;\n+    }\n+    const Txid txid{it->second};\n+    m_by_nodeid.erase(it);\n+\n+    if (!confirmed_by_node) {\n+        return true;\n+    }\n+\n+    // Update broadcast stats.\n+\n+    auto iters = Find(txid);\n+    if (!iters) {\n+        return true;\n+    }\n+    Priority& priority = iters->by_txid->second.priority;\n+\n+    ++priority.num_broadcasted;\n+    priority.last_broadcasted = GetTime<std::chrono::microseconds>();\n+\n+    m_by_priority.erase(iters->by_priority);\n+    m_by_priority.emplace(priority, iters->by_txid->first);",
      "path": "src/private_broadcast.cpp",
      "position": 1,
      "original_position": 59,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "fecab592de8d0994e6d61e454e118d652ffd7b93",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In fecab592de8d0994e6d61e454e118d652ffd7b93\r\n\r\nIsn't `iters->by_txid->first` the same as `txid`? It would read way simpler by using the latter",
      "created_at": "2024-05-10T17:08:47Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1597007136",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1597007136"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 65,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1597010441",
      "pull_request_review_id": 2041604763,
      "id": 1597010441,
      "node_id": "PRRC_kwDOABII585fMHIJ",
      "diff_hunk": "@@ -14,10 +15,78 @@ void PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!\n     }\n }\n \n+std::optional<CTransactionRef> PrivateBroadcast::GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    if (m_by_priority.empty()) {\n+        return std::nullopt;\n+    }\n+    const Txid& txid = m_by_priority.begin()->second;\n+    auto it = m_by_txid.find(txid);\n+    if (Assume(it != m_by_txid.end())) {\n+        return it->second.tx;\n+    }\n+    m_by_priority.erase(m_by_priority.begin());\n+    return std::nullopt;\n+}\n+\n+void PrivateBroadcast::PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    m_by_nodeid.emplace(nodeid, txid);\n+}\n+\n+bool PrivateBroadcast::BroadcastEnd(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    auto it = m_by_nodeid.find(nodeid);\n+    if (it == m_by_nodeid.end()) {\n+        return false;\n+    }\n+    const Txid txid{it->second};\n+    m_by_nodeid.erase(it);\n+\n+    if (!confirmed_by_node) {\n+        return true;\n+    }\n+\n+    // Update broadcast stats.\n+\n+    auto iters = Find(txid);\n+    if (!iters) {\n+        return true;\n+    }\n+    Priority& priority = iters->by_txid->second.priority;\n+\n+    ++priority.num_broadcasted;\n+    priority.last_broadcasted = GetTime<std::chrono::microseconds>();\n+\n+    m_by_priority.erase(iters->by_priority);\n+    m_by_priority.emplace(priority, iters->by_txid->first);",
      "path": "src/private_broadcast.cpp",
      "position": 1,
      "original_position": 59,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "fecab592de8d0994e6d61e454e118d652ffd7b93",
      "in_reply_to_id": 1597007136,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Also, excuse my lack of cpp proficiency but, is it necessary to delete and re-add the item? Why is not updating `priority` enough (as done in the above two lines)?",
      "created_at": "2024-05-10T17:11:28Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1597010441",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1597010441"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 65,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1597146275",
      "pull_request_review_id": 2041604763,
      "id": 1597146275,
      "node_id": "PRRC_kwDOABII585fMoSj",
      "diff_hunk": "@@ -4658,6 +4658,21 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         const uint256& hash = peer->m_wtxid_relay ? wtxid : txid;\n         AddKnownTx(*peer, hash);\n \n+        if (auto num_broadcasted = m_tx_for_private_broadcast.Remove(ptx)) {\n+            LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                          BCLog::Level::Info,\n+                          \"Received our privately broadcast transaction (txid=%s) from the \"\n+                          \"network from peer=%d%s; stopping private broadcast attempts\\n\",\n+                          txid.ToString(),\n+                          pfrom.GetId(),\n+                          fLogIPs ? strprintf(\", peeraddr=%s\", pfrom.addr.ToStringAddrPort()) : \"\");\n+            if (NUM_PRIVATE_BROADCAST_PER_TX > num_broadcasted.value()) {\n+                // Not all of the initial NUM_PRIVATE_BROADCAST_PER_TX connections were needed.\n+                // Tell CConnman it does not need to start the remaining ones.\n+                m_connman.PrivateBroadcastSub(NUM_PRIVATE_BROADCAST_PER_TX - num_broadcasted.value());",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 15,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "bb697ba5f51f5e31ec472f32682fbb6eb692fa37",
      "in_reply_to_id": null,
      "user": {
        "login": "sr-gi",
        "id": 6665628,
        "node_id": "MDQ6VXNlcjY2NjU2Mjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6665628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sr-gi",
        "html_url": "https://github.com/sr-gi",
        "followers_url": "https://api.github.com/users/sr-gi/followers",
        "following_url": "https://api.github.com/users/sr-gi/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sr-gi/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sr-gi/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sr-gi/subscriptions",
        "organizations_url": "https://api.github.com/users/sr-gi/orgs",
        "repos_url": "https://api.github.com/users/sr-gi/repos",
        "events_url": "https://api.github.com/users/sr-gi/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sr-gi/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In bb697ba5f51f5e31ec472f32682fbb6eb692fa37\r\n\r\nAFAICT this is the only use of `CConnman::PrivateBroadcastSub`, meaning we should be able to simplify the method by unconditionally setting `m_private_broadcast_connections_to_open` to 0",
      "created_at": "2024-05-10T19:28:42Z",
      "updated_at": "2024-05-13T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1597146275",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1597146275"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4768,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598646404",
      "pull_request_review_id": 2052999547,
      "id": 1598646404,
      "node_id": "PRRC_kwDOABII585fSWiE",
      "diff_hunk": "@@ -1498,6 +1514,7 @@ class CConnman\n     int m_max_outbound_block_relay;\n \n     int m_max_addnode{MAX_ADDNODE_CONNECTIONS};\n+    int m_max_private_broadcast{MAX_PRIVATE_BROADCAST_CONNECTIONS};",
      "path": "src/net.h",
      "position": 1,
      "original_position": 34,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd \"net: implement opening PRIVATE_BROADCAST connections\": `m_max_private_broadcast` is not used. ",
      "created_at": "2024-05-13T15:12:30Z",
      "updated_at": "2024-05-13T15:12:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1598646404",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1598646404"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1517,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1607031740",
      "pull_request_review_id": 2066636300,
      "id": 1607031740,
      "node_id": "PRRC_kwDOABII585fyVu8",
      "diff_hunk": "@@ -71,6 +71,8 @@ static const int MAX_ADDNODE_CONNECTIONS = 8;\n static const int MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2;\n /** Maximum number of feeler connections */\n static const int MAX_FEELER_CONNECTIONS = 1;\n+/** Maximum number of private broadcast connections */\n+static constexpr size_t MAX_PRIVATE_BROADCAST_CONNECTIONS{64};",
      "path": "src/net.h",
      "position": 5,
      "original_position": 5,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": 1595556422,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "It could be lower. I picked 64 because I imagine somebody submitting 100s or even 1000s of transactions at the same time. Processing those serially would take a lot of time. Would you suggest another number?",
      "created_at": "2024-05-20T17:06:15Z",
      "updated_at": "2024-05-20T17:06:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1607031740",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1607031740"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 77,
      "original_line": 77,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1607790271",
      "pull_request_review_id": 2067774857,
      "id": 1607790271,
      "node_id": "PRRC_kwDOABII585f1O6_",
      "diff_hunk": "@@ -386,6 +386,27 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+/**\n+ * Check if private broadcast can be done to clearnet peers and if yes via which proxy.\n+ * If private broadcast connections should not be opened to `net`, then this will return an empty optional.\n+ */\n+static std::optional<Proxy> ProxyForClearnetPrivateBroadcast(Network clearnet)\n+{\n+    if (clearnet != NET_IPV4 && clearnet != NET_IPV6) {\n+        return std::nullopt;\n+    }\n+    Proxy tor_proxy;\n+    const std::string onion_arg{gArgs.GetArg(\"-onion\", \"\")};\n+    if (onion_arg != \"\" && onion_arg == \"0\" && GetProxy(NET_ONION, tor_proxy)) {\n+        // Use the Tor proxy (if provided) for private broadcast connections to clearnet peers.\n+        // Note: we check whether -onion is explicitly used because GetProxy(NET_ONION) may",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 17,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "6b4693ee859d6bddf559a0b32749b1dafe015ef4",
      "in_reply_to_id": 1579852847,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Hmm, maybe we can keep track of whether we have successfully managed to connect to at least one `.onion` address via the `-proxy`, then we can assume that is a Tor proxy? How does that sound?",
      "created_at": "2024-05-21T07:35:05Z",
      "updated_at": "2024-05-22T16:26:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1607790271",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1607790271"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 406,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608069282",
      "pull_request_review_id": 2068227727,
      "id": 1608069282,
      "node_id": "PRRC_kwDOABII585f2TCi",
      "diff_hunk": "@@ -456,14 +477,24 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n \n     for (auto& target_addr: connect_to) {\n         if (target_addr.IsValid()) {\n-            const bool use_proxy{GetProxy(target_addr.GetNetwork(), proxy)};\n+            bool use_proxy{GetProxy(addrConnect.GetNetwork(), proxy)};\n+            if (conn_type == ConnectionType::PRIVATE_BROADCAST) {\n+                const auto proxy_opt{ProxyForClearnetPrivateBroadcast(addrConnect.GetNetwork())};\n+                if (proxy_opt.has_value()) {\n+                    use_proxy = true;\n+                    proxy = proxy_opt.value();\n+                }\n+            }",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 40,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": 1595772136,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`proxy_opt` exists only inside the `if`. What matters after this `if` are the values of `use_proxy` and `proxy`. I think your suggestion is equivalent to the current code. I.e.\r\n\r\n```\r\nset use_proxy and proxy (normal)\r\nif (special case)\r\n    replace use_proxy and proxy with special values\r\n```\r\nvs\r\n```\r\nif (special case)\r\n    set use_proxy and proxy to special values\r\nelse\r\n    set use_proxy and proxy (normal)\r\n```\r\n\r\nRight?",
      "created_at": "2024-05-21T10:36:27Z",
      "updated_at": "2024-05-21T10:36:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608069282",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608069282"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 480,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 486,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608108288",
      "pull_request_review_id": 2068279627,
      "id": 1608108288,
      "node_id": "PRRC_kwDOABII585f2ckA",
      "diff_hunk": "@@ -456,14 +477,24 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n \n     for (auto& target_addr: connect_to) {\n         if (target_addr.IsValid()) {\n-            const bool use_proxy{GetProxy(target_addr.GetNetwork(), proxy)};\n+            bool use_proxy{GetProxy(addrConnect.GetNetwork(), proxy)};\n+            if (conn_type == ConnectionType::PRIVATE_BROADCAST) {\n+                const auto proxy_opt{ProxyForClearnetPrivateBroadcast(addrConnect.GetNetwork())};\n+                if (proxy_opt.has_value()) {\n+                    use_proxy = true;\n+                    proxy = proxy_opt.value();\n+                }\n+            }\n             bool proxyConnectionFailed = false;\n \n             if (target_addr.IsI2P() && use_proxy) {\n                 i2p::Connection conn;\n                 bool connected{false};\n \n-                if (m_i2p_sam_session) {\n+                // If an I2P SAM session already exists, normally we would re-use it. But in the case of\n+                // private broadcast we force a new transient session. A Connect() using m_i2p_sam_session\n+                // would use our permanent I2P address as a source address.\n+                if (m_i2p_sam_session && conn_type != ConnectionType::PRIVATE_BROADCAST) {",
      "path": "src/net.cpp",
      "position": 26,
      "original_position": 51,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": 1595793107,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The transient sessions are not reused. `m_unused_i2p_sessions` description reads:\r\n\r\n> If connecting to a host fails, then the created session is put to this pool for reuse.\r\n\r\nThe code is this:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/a786fd2041913d82ca90b561de309421bd24e41b/src/net.cpp#L472-L480\r\n\r\nI.e. pop/extract a session from `m_unused_i2p_sessions` and if we cannot connect, then we did not use the session and thus put it back to `m_unused_i2p_sessions`.\r\n\r\nDo you think that the description of `m_unused_i2p_sessions` can be improved? Would you suggest an exact wording?",
      "created_at": "2024-05-21T10:47:32Z",
      "updated_at": "2024-05-21T10:47:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608108288",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608108288"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 473,
      "original_line": 473,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608129277",
      "pull_request_review_id": 2068314643,
      "id": 1608129277,
      "node_id": "PRRC_kwDOABII585f2hr9",
      "diff_hunk": "@@ -2605,18 +2721,19 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         bool fFeeler = false;\n         std::optional<Network> preferred_net;\n \n-        // Determine what type of connection to open. Opening\n-        // BLOCK_RELAY connections to addresses from anchors.dat gets the highest\n-        // priority. Then we open OUTBOUND_FULL_RELAY priority until we\n-        // meet our full-relay capacity. Then we open BLOCK_RELAY connection\n-        // until we hit our block-relay-only peer limit.\n-        // GetTryNewOutboundPeer() gets set when a stale tip is detected, so we\n-        // try opening an additional OUTBOUND_FULL_RELAY connection. If none of\n-        // these conditions are met, check to see if it's time to try an extra\n-        // block-relay-only peer (to confirm our tip is current, see below) or the next_feeler\n-        // timer to decide if we should open a FEELER.\n-\n-        if (!m_anchors.empty() && (nOutboundBlockRelay < m_max_outbound_block_relay)) {\n+        // Determine what type of connection to open, in order of priority:\n+        // * PRIVATE_BROADCAST if needed\n+        // * BLOCK_RELAY connections to addresses from anchors.dat until we reach m_max_outbound_block_relay\n+        // * OUTBOUND_FULL_RELAY until we reach m_max_outbound_full_relay\n+        // * BLOCK_RELAY until we reach m_max_outbound_block_relay\n+        // * OUTBOUND_FULL_RELAY if GetTryNewOutboundPeer() is true (a stale tip is detected)\n+        // * BLOCK_RELAY if it's time to try an extra block-relay-only peer (to confirm our tip is current)\n+        // * FEELER if it's time to try a feeler\n+        // * else retry the loop (sleep a bit and start from the top of this list)\n+\n+        if (open_private_broadcast_to.has_value()) {\n+            conn_type = ConnectionType::PRIVATE_BROADCAST;",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 205,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": 1595819770,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "A few considerations:\r\n\r\n* Private broadcast connections are not blocked on the `semOutbound` grant. They come to this code right away.\r\n\r\n* Even if there is a high demand for private broadcast connections, we would try to open such ones only half of the time in `CConnman::ThreadOpenConnections()` to avoid such starvation of only opening private broadcast and not others for a long time (see how `MaybePickPrivateBroadcastNetwork()` yields to other connection types if we previously opened a private broadcast one).\r\n\r\n* Non-`BLOCK_RELAY` connections keep us up to date as well (with new blocks). I.e blocks could come via inbound, full-outbound, etc.\r\n\r\nGiven the above, I think the current code does not need to be changed.",
      "created_at": "2024-05-21T11:02:10Z",
      "updated_at": "2024-05-21T11:02:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608129277",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608129277"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 2734,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2744,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608172001",
      "pull_request_review_id": 2068383787,
      "id": 1608172001,
      "node_id": "PRRC_kwDOABII585f2sHh",
      "diff_hunk": "@@ -2452,6 +2483,72 @@ bool CConnman::MaybePickPreferredNetwork(std::optional<Network>& network)\n     return false;\n }\n \n+/**\n+ * Decide whether to open a private broadcast connection and if yes, to which network.\n+ * @param[in] prev_was_private_broadcast Whether the previous attempt to open a connection\n+ * was an attempt to open a private broadcast connection (successful or not).\n+ * @param[in] num_needed Number of private broadcast connections that need to be opened.",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 63,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": 1595875212,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Added this sentence: \"We try to open a connection of this type only if there are transactions pending, but up to a limit.\"",
      "created_at": "2024-05-21T11:38:42Z",
      "updated_at": "2024-05-21T11:38:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608172001",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608172001"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2497,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608174270",
      "pull_request_review_id": 2068387303,
      "id": 1608174270,
      "node_id": "PRRC_kwDOABII585f2sq-",
      "diff_hunk": "@@ -179,6 +180,9 @@ static constexpr size_t MAX_ADDR_PROCESSING_TOKEN_BUCKET{MAX_ADDR_TO_SEND};\n /** The compactblocks version we support. See BIP 152. */\n static constexpr uint64_t CMPCTBLOCKS_VERSION{2};\n ",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 11,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "434a20371e441660147da6d0c6c1832cb0d0073b",
      "in_reply_to_id": 1596830944,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Removed.",
      "created_at": "2024-05-21T11:40:32Z",
      "updated_at": "2024-05-21T11:40:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608174270",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608174270"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 182,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608176500",
      "pull_request_review_id": 2068391038,
      "id": 1608176500,
      "node_id": "PRRC_kwDOABII585f2tN0",
      "diff_hunk": "@@ -179,6 +180,9 @@ static constexpr size_t MAX_ADDR_PROCESSING_TOKEN_BUCKET{MAX_ADDR_TO_SEND};\n /** The compactblocks version we support. See BIP 152. */\n static constexpr uint64_t CMPCTBLOCKS_VERSION{2};\n \n+/** For private broadcast, send a transaction to this many peers per one broadcast attempt. */",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 12,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "434a20371e441660147da6d0c6c1832cb0d0073b",
      "in_reply_to_id": 1596831509,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2024-05-21T11:42:27Z",
      "updated_at": "2024-05-21T11:42:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608176500",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608176500"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 183,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608179155",
      "pull_request_review_id": 2068395273,
      "id": 1608179155,
      "node_id": "PRRC_kwDOABII585f2t3T",
      "diff_hunk": "@@ -1175,6 +1180,8 @@ class PeerManagerImpl final : public PeerManager\n \n     void AddAddressKnown(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n     void PushAddress(Peer& peer, const CAddress& addr) EXCLUSIVE_LOCKS_REQUIRED(g_msgproc_mutex);\n+",
      "path": "src/net_processing.cpp",
      "position": 67,
      "original_position": 30,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "434a20371e441660147da6d0c6c1832cb0d0073b",
      "in_reply_to_id": 1596833034,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Added \"A list of transactions to be broadcast privately.\"",
      "created_at": "2024-05-21T11:44:38Z",
      "updated_at": "2024-05-21T11:44:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608179155",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608179155"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1087,
      "original_line": 1087,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608182222",
      "pull_request_review_id": 2068400075,
      "id": 1608182222,
      "node_id": "PRRC_kwDOABII585f2unO",
      "diff_hunk": "@@ -2341,6 +2348,19 @@ void PeerManagerImpl::ScheduleTxForBroadcastToAll(const uint256& txid, const uin\n     };\n }\n \n+void PeerManagerImpl::ScheduleTxForPrivateBroadcast(const CTransactionRef& tx)\n+{\n+    m_tx_for_private_broadcast.Add(tx);\n+\n+    LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                  BCLog::Level::Debug,\n+                  \"Requesting %d new connections due to txid=%s, wtxid=%s\\n\",",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 45,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "434a20371e441660147da6d0c6c1832cb0d0073b",
      "in_reply_to_id": 1596835091,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "\"due to\" = \"because of\" = \"because there is a new transaction for broadcast - txid=...\". I am open to suggestions for better wording.",
      "created_at": "2024-05-21T11:47:09Z",
      "updated_at": "2024-05-21T11:47:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608182222",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608182222"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2459,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608191485",
      "pull_request_review_id": 2068414399,
      "id": 1608191485,
      "node_id": "PRRC_kwDOABII585f2w39",
      "diff_hunk": "@@ -0,0 +1,55 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_PRIVATE_BROADCAST_H\n+#define BITCOIN_PRIVATE_BROADCAST_H\n+\n+#include <primitives/transaction.h>\n+#include <sync.h>\n+#include <threadsafety.h>\n+#include <util/hasher.h>\n+\n+#include <chrono>\n+#include <map>\n+#include <unordered_map>\n+\n+/**\n+ * Store a list of transactions to be broadcast privately. Supports the following operations:\n+ * - Add a new transaction\n+ * - Remove a transaction, after it has been seen by the network\n+ * - Mark a broadcast of a transaction (remember when and how many times)\n+ * - Get a transaction for broadcast, the one that has been broadcast fewer times and least recently",
      "path": "src/private_broadcast.h",
      "position": 26,
      "original_position": 22,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "434a20371e441660147da6d0c6c1832cb0d0073b",
      "in_reply_to_id": 1596842874,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Right! Moved to the corresponding commits.",
      "created_at": "2024-05-21T11:54:33Z",
      "updated_at": "2024-05-21T11:54:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608191485",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608191485"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 24,
      "original_start_line": 20,
      "start_side": "RIGHT",
      "line": 26,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608192497",
      "pull_request_review_id": 2068415979,
      "id": 1608192497,
      "node_id": "PRRC_kwDOABII585f2xHx",
      "diff_hunk": "@@ -0,0 +1,23 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers",
      "path": "src/private_broadcast.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "434a20371e441660147da6d0c6c1832cb0d0073b",
      "in_reply_to_id": 1596847026,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Some of the code was written in 2023",
      "created_at": "2024-05-21T11:55:20Z",
      "updated_at": "2024-05-21T11:55:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608192497",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608192497"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608193117",
      "pull_request_review_id": 2068416937,
      "id": 1608193117,
      "node_id": "PRRC_kwDOABII585f2xRd",
      "diff_hunk": "@@ -0,0 +1,55 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers",
      "path": "src/private_broadcast.h",
      "position": 1,
      "original_position": 1,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "434a20371e441660147da6d0c6c1832cb0d0073b",
      "in_reply_to_id": 1596847172,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Same, some of the code was written in 2023",
      "created_at": "2024-05-21T11:55:49Z",
      "updated_at": "2024-05-21T11:55:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608193117",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608193117"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608200672",
      "pull_request_review_id": 2068429816,
      "id": 1608200672,
      "node_id": "PRRC_kwDOABII585f2zHg",
      "diff_hunk": "@@ -1622,26 +1630,66 @@ void PeerManagerImpl::FindNextBlocks(std::vector<const CBlockIndex*>& vBlocks, c\n \n void PeerManagerImpl::PushNodeVersion(CNode& pnode, const Peer& peer)\n {\n-    uint64_t my_services{peer.m_our_services};\n-    const int64_t nTime{count_seconds(GetTime<std::chrono::seconds>())};\n-    uint64_t nonce = pnode.GetLocalNonce();\n-    const int nNodeStartingHeight{m_best_height};\n-    NodeId nodeid = pnode.GetId();\n-    CAddress addr = pnode.addr;\n-\n-    CService addr_you = addr.IsRoutable() && !IsProxy(addr) && addr.IsAddrV1Compatible() ? addr : CService();\n-    uint64_t your_services{addr.nServices};\n-\n-    const bool tx_relay{!RejectIncomingTxs(pnode)};\n-    MakeAndPushMessage(pnode, NetMsgType::VERSION, PROTOCOL_VERSION, my_services, nTime,\n-            your_services, CNetAddr::V1(addr_you), // Together the pre-version-31402 serialization of CAddress \"addrYou\" (without nTime)\n-            my_services, CNetAddr::V1(CService{}), // Together the pre-version-31402 serialization of CAddress \"addrMe\" (without nTime)\n-            nonce, strSubVersion, nNodeStartingHeight, tx_relay);\n-\n+    uint64_t my_services;\n+    int64_t my_time;\n+    uint64_t your_services;\n+    CService your_addr;\n+    std::string my_user_agent;\n+    int my_height;\n+    bool my_tx_relay;",
      "path": "src/net_processing.cpp",
      "position": 127,
      "original_position": 52,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "fecab592de8d0994e6d61e454e118d652ffd7b93",
      "in_reply_to_id": 1596947249,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I prefixed everything with `my_` or `your_` because otherwise it is unclear whether it is mine or yours. Deducting that without my/yours prefix requires an extra effort.",
      "created_at": "2024-05-21T12:00:52Z",
      "updated_at": "2024-05-21T12:00:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608200672",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608200672"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1548,
      "original_start_line": 1637,
      "start_side": "RIGHT",
      "line": 1550,
      "original_line": 1550,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608216424",
      "pull_request_review_id": 2068456409,
      "id": 1608216424,
      "node_id": "PRRC_kwDOABII585f229o",
      "diff_hunk": "@@ -5155,6 +5282,17 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                     if (ping_time.count() >= 0) {\n                         // Let connman know about this successful ping-pong\n                         pfrom.PongReceived(ping_time);\n+                        if (pfrom.IsPrivateBroadcastConn()) {\n+                            m_tx_for_private_broadcast.BroadcastEnd(pfrom.GetId(), /*confirmed_by_node=*/true);\n+                            LogPrintLevel(\n+                                BCLog::PRIVATE_BROADCAST,\n+                                BCLog::Level::Info,\n+                                \"Got a PONG (probably the transaction will reach the network), \"",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 243,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "fecab592de8d0994e6d61e454e118d652ffd7b93",
      "in_reply_to_id": 1596957262,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2024-05-21T12:09:01Z",
      "updated_at": "2024-05-21T12:09:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608216424",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608216424"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 5290,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608216576",
      "pull_request_review_id": 2068456627,
      "id": 1608216576,
      "node_id": "PRRC_kwDOABII585f23AA",
      "diff_hunk": "@@ -1790,6 +1838,17 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n         LOCK(m_headers_presync_mutex);\n         m_headers_presync_stats.erase(nodeid);\n     }\n+    // This is done when we get a PONG from the peer. Repeat here too in case we never receive a PONG.\n+    if (node.IsPrivateBroadcastConn() &&\n+        m_tx_for_private_broadcast.BroadcastEnd(nodeid, /*confirmed_by_node=*/false)) {\n+\n+        LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                      BCLog::Level::Info,\n+                      \"Never got a PONG (probably the transaction will not \"",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 121,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "fecab592de8d0994e6d61e454e118d652ffd7b93",
      "in_reply_to_id": 1596958082,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2024-05-21T12:09:08Z",
      "updated_at": "2024-05-21T12:09:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608216576",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608216576"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1847,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608218540",
      "pull_request_review_id": 2068459695,
      "id": 1608218540,
      "node_id": "PRRC_kwDOABII585f23es",
      "diff_hunk": "@@ -26,6 +29,26 @@ class PrivateBroadcast\n public:\n     void Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n \n+    /**\n+     * Get the transaction that has been broadcast fewest times and least recently.\n+     */\n+    std::optional<CTransactionRef> GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+    /**\n+     * Mark a transaction as pushed to a given node. This is an intermediate state before\n+     * we get a PONG from the node which would confirm that the transaction has been received.\n+     * At the time we get the PONG we need to know which transaction we sent to that node,\n+     * so that we can account how many times we broadcast each transaction.\n+     */\n+    void PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+    /**\n+     * Mark the end of a broadcast of a transaction. Either successful by receiving a PONG,\n+     * or unsuccessful by closing the connection to the node without getting PONG.\n+     * @return true if the reference by the given node id was removed\n+     */\n+    bool BroadcastEnd(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);",
      "path": "src/private_broadcast.h",
      "position": 1,
      "original_position": 39,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "fecab592de8d0994e6d61e454e118d652ffd7b93",
      "in_reply_to_id": 1596988561,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Renamed to `FinishBroadcast()`.",
      "created_at": "2024-05-21T12:10:39Z",
      "updated_at": "2024-05-21T12:10:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608218540",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608218540"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 50,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608255803",
      "pull_request_review_id": 2068518702,
      "id": 1608255803,
      "node_id": "PRRC_kwDOABII585f3Ak7",
      "diff_hunk": "@@ -14,10 +15,78 @@ void PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!\n     }\n }\n \n+std::optional<CTransactionRef> PrivateBroadcast::GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    if (m_by_priority.empty()) {\n+        return std::nullopt;\n+    }\n+    const Txid& txid = m_by_priority.begin()->second;\n+    auto it = m_by_txid.find(txid);\n+    if (Assume(it != m_by_txid.end())) {\n+        return it->second.tx;\n+    }\n+    m_by_priority.erase(m_by_priority.begin());\n+    return std::nullopt;\n+}\n+\n+void PrivateBroadcast::PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    m_by_nodeid.emplace(nodeid, txid);\n+}\n+\n+bool PrivateBroadcast::BroadcastEnd(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    auto it = m_by_nodeid.find(nodeid);\n+    if (it == m_by_nodeid.end()) {\n+        return false;\n+    }\n+    const Txid txid{it->second};\n+    m_by_nodeid.erase(it);\n+\n+    if (!confirmed_by_node) {\n+        return true;\n+    }\n+\n+    // Update broadcast stats.\n+\n+    auto iters = Find(txid);\n+    if (!iters) {\n+        return true;\n+    }\n+    Priority& priority = iters->by_txid->second.priority;\n+\n+    ++priority.num_broadcasted;\n+    priority.last_broadcasted = GetTime<std::chrono::microseconds>();\n+\n+    m_by_priority.erase(iters->by_priority);\n+    m_by_priority.emplace(priority, iters->by_txid->first);",
      "path": "src/private_broadcast.cpp",
      "position": 1,
      "original_position": 59,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "fecab592de8d0994e6d61e454e118d652ffd7b93",
      "in_reply_to_id": 1597007136,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, `iters->by_txid->first` is the same as `txid`, changed it to use `txid` which is shorter.\r\n\r\nIt is necessary to remove and re-add because we have changed the key and C++ maps do not support modifying of the keys. That is, changing the key means that the entry will have to be in another place in the map, so it has to be removed from the old place and added to the new one.",
      "created_at": "2024-05-21T12:38:43Z",
      "updated_at": "2024-05-21T12:38:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608255803",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608255803"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 65,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608284734",
      "pull_request_review_id": 2068564986,
      "id": 1608284734,
      "node_id": "PRRC_kwDOABII585f3Ho-",
      "diff_hunk": "@@ -4658,6 +4658,21 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         const uint256& hash = peer->m_wtxid_relay ? wtxid : txid;\n         AddKnownTx(*peer, hash);\n \n+        if (auto num_broadcasted = m_tx_for_private_broadcast.Remove(ptx)) {\n+            LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                          BCLog::Level::Info,\n+                          \"Received our privately broadcast transaction (txid=%s) from the \"\n+                          \"network from peer=%d%s; stopping private broadcast attempts\\n\",\n+                          txid.ToString(),\n+                          pfrom.GetId(),\n+                          fLogIPs ? strprintf(\", peeraddr=%s\", pfrom.addr.ToStringAddrPort()) : \"\");\n+            if (NUM_PRIVATE_BROADCAST_PER_TX > num_broadcasted.value()) {\n+                // Not all of the initial NUM_PRIVATE_BROADCAST_PER_TX connections were needed.\n+                // Tell CConnman it does not need to start the remaining ones.\n+                m_connman.PrivateBroadcastSub(NUM_PRIVATE_BROADCAST_PER_TX - num_broadcasted.value());",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 15,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "bb697ba5f51f5e31ec472f32682fbb6eb692fa37",
      "in_reply_to_id": 1597146275,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, if there is only one transaction submitted for broadcast. But if there is more than one, then `m_private_broadcast_connections_to_open` should not be set to `0`.\r\n\r\nFor example:\r\n* 3 transactions are submitted at approximately the same time: tx1, tx2, tx3.\r\n* NUM_PRIVATE_BROADCAST_PER_TX=5 for each one, so `m_private_broadcast_connections_to_open` is set to 15.\r\n* tx1 is broadcast 2 times, tx2 once and tx3 once, `m_private_broadcast_connections_to_open` is now 15-2-1-1=11.\r\n* tx1 is received back from the network. We come to this code and see that tx1 has been broadcast two times and deduce that the other 5-2=3 we created are not needed and call `PrivateBroadcastSub(3)`. `m_private_broadcast_connections_to_open` should be set to 11-3=8 (4 for tx2 and 4 for tx3), not 0.",
      "created_at": "2024-05-21T12:58:14Z",
      "updated_at": "2024-05-21T12:58:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608284734",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608284734"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4768,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608293544",
      "pull_request_review_id": 2068579532,
      "id": 1608293544,
      "node_id": "PRRC_kwDOABII585f3Jyo",
      "diff_hunk": "@@ -1498,6 +1514,7 @@ class CConnman\n     int m_max_outbound_block_relay;\n \n     int m_max_addnode{MAX_ADDNODE_CONNECTIONS};\n+    int m_max_private_broadcast{MAX_PRIVATE_BROADCAST_CONNECTIONS};",
      "path": "src/net.h",
      "position": 1,
      "original_position": 34,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": 1598646404,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Right! Removed.",
      "created_at": "2024-05-21T13:04:18Z",
      "updated_at": "2024-05-21T13:04:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608293544",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608293544"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1517,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608306032",
      "pull_request_review_id": 2068601743,
      "id": 1608306032,
      "node_id": "PRRC_kwDOABII585f3M1w",
      "diff_hunk": "@@ -655,11 +656,12 @@ class NetinfoRequestHandler : public BaseRequestHandler\n         \"           \\\"in\\\"  - inbound connections are those initiated by the peer\\n\"\n         \"           \\\"out\\\" - outbound connections are those initiated by us\\n\"\n         \"  type     Type of peer connection\\n\"\n-        \"           \\\"full\\\"   - full relay, the default\\n\"\n-        \"           \\\"block\\\"  - block relay; like full relay but does not relay transactions or addresses\\n\"\n-        \"           \\\"manual\\\" - peer we manually added using RPC addnode or the -addnode/-connect config options\\n\"\n-        \"           \\\"feeler\\\" - short-lived connection for testing addresses\\n\"\n-        \"           \\\"addr\\\"   - address fetch; short-lived connection for requesting addresses\\n\"\n+        \"           \\\"full\\\"      - full relay, the default\\n\"\n+        \"           \\\"block\\\"     - block relay; like full relay but does not relay transactions or addresses\\n\"\n+        \"           \\\"manual\\\"    - peer we manually added using RPC addnode or the -addnode/-connect config options\\n\"\n+        \"           \\\"feeler\\\"    - short-lived connection for testing addresses\\n\"\n+        \"           \\\"addr\\\"      - address fetch; short-lived connection for requesting addresses\\n\"\n+        \"           \\\"privat\\\"    - private broadcast; short-lived connection for broadcasting our transactions\\n\"",
      "path": "src/bitcoin-cli.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "c7e4d5cb2bf01d9719702e71c8d6264ee670e988",
      "in_reply_to_id": 1545397035,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Changed to `\"priv\"`.",
      "created_at": "2024-05-21T13:08:28Z",
      "updated_at": "2024-05-21T13:08:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608306032",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608306032"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 691,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608308448",
      "pull_request_review_id": 2068605490,
      "id": 1608308448,
      "node_id": "PRRC_kwDOABII585f3Nbg",
      "diff_hunk": "@@ -386,6 +386,27 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+/**\n+ * Check if private broadcast can be done to clearnet peers and if yes via which proxy.",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 5,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": 1595748248,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2024-05-21T13:09:50Z",
      "updated_at": "2024-05-21T13:09:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608308448",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608308448"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 390,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608310055",
      "pull_request_review_id": 2068608035,
      "id": 1608310055,
      "node_id": "PRRC_kwDOABII585f3N0n",
      "diff_hunk": "@@ -386,6 +386,27 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+/**\n+ * Check if private broadcast can be done to clearnet peers and if yes via which proxy.\n+ * If private broadcast connections should not be opened to `net`, then this will return an empty optional.\n+ */\n+static std::optional<Proxy> ProxyForClearnetPrivateBroadcast(Network clearnet)",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 8,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0ba30dec085f860c89f4fd8c8a398aa8a13b5ebd",
      "in_reply_to_id": 1595750204,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I removed the argument to this function and renamed it to `ProxyForIPv4or6PrivateBroadcast()`. It is a bit more simpler now.",
      "created_at": "2024-05-21T13:10:56Z",
      "updated_at": "2024-05-21T13:10:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608310055",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608310055"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 393,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608327017",
      "pull_request_review_id": 2068635557,
      "id": 1608327017,
      "node_id": "PRRC_kwDOABII585f3R9p",
      "diff_hunk": "@@ -1547,6 +1577,12 @@ class CConnman\n      */\n     std::atomic_bool m_start_extra_block_relay_peers{false};\n \n+    /**\n+     * Number of `ConnectionType::PRIVATE_BROADCAST` connections to open.\n+     * Whenever such a connection is opened this is decremented with 1.\n+     */\n+    std::atomic_size_t m_private_broadcast_connections_to_open{0};",
      "path": "src/net.h",
      "position": 1,
      "original_position": 87,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e85cc59badd357219213a6bda985a9fd93910a5c",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "_from the main thread at https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2041604763_\r\n\r\n> The main thing I'm wondering currently is why are we tacking `m_private_broadcast_connections_to_open` loosely? It feels harder to reason about, but I don't see what the benefit of it is.\r\n\r\nThe reason for this is that it is simpler to implement that way (I think, somebody has a simpler proposal?). This is because the connman thread is creating the connections, they are consumed/used by the peerman thread and the requests for new connections can come from yet another (3rd) thread. For example, while connman is creating a new connection which is needed to broadcast a given transaction, that transaction may be successfully broadcast by peerman and received back from the network, rendering the just created new connection by connman unnecessary. This is harmless and I accept it because avoiding it would make things too complicated or slow.\r\n",
      "created_at": "2024-05-21T13:21:58Z",
      "updated_at": "2024-05-21T13:21:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1608327017",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1608327017"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1584,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1610296362",
      "pull_request_review_id": 2071772676,
      "id": 1610296362,
      "node_id": "PRRC_kwDOABII585f-ywq",
      "diff_hunk": "@@ -386,6 +386,27 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+/**\n+ * Check if private broadcast can be done to clearnet peers and if yes via which proxy.\n+ * If private broadcast connections should not be opened to `net`, then this will return an empty optional.\n+ */\n+static std::optional<Proxy> ProxyForClearnetPrivateBroadcast(Network clearnet)\n+{\n+    if (clearnet != NET_IPV4 && clearnet != NET_IPV6) {\n+        return std::nullopt;\n+    }\n+    Proxy tor_proxy;\n+    const std::string onion_arg{gArgs.GetArg(\"-onion\", \"\")};\n+    if (onion_arg != \"\" && onion_arg == \"0\" && GetProxy(NET_ONION, tor_proxy)) {\n+        // Use the Tor proxy (if provided) for private broadcast connections to clearnet peers.\n+        // Note: we check whether -onion is explicitly used because GetProxy(NET_ONION) may",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 17,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "6b4693ee859d6bddf559a0b32749b1dafe015ef4",
      "in_reply_to_id": 1579852847,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> > Is there no better way of checking whether `-proxy` is an actual Tor proxy or just a regular SOCKS5 proxy?\r\n\r\n> maybe we can keep track of whether we have successfully managed to connect to at least one `.onion` address\r\n\r\nDone in `e85cc59bad...057c79365c`, see https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2125213533, also dropped the change in `tor.md` because that is not needed anymore.\r\n\r\nLooks better now, thank you!",
      "created_at": "2024-05-22T16:26:14Z",
      "updated_at": "2024-05-22T16:26:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1610296362",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1610296362"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 406,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1655262092",
      "pull_request_review_id": 2142526715,
      "id": 1655262092,
      "node_id": "PRRC_kwDOABII585iqUuM",
      "diff_hunk": "@@ -120,6 +120,12 @@ bool WalletInit::ParameterInteraction() const\n         LogPrintf(\"%s: parameter interaction: -blocksonly=1 -> setting -walletbroadcast=0\\n\", __func__);\n     }\n \n+    if (gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST) &&",
      "path": "src/wallet/init.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "1407b3fa264b096813281a767da3cd3ca80ed096",
      "in_reply_to_id": 1578537557,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I wonder if the option should be renamed `-privaterpcbroadcast` for now, and we can add `-privatewalletbroadcast` later. \r\n\r\nWe also won't be able to prevent users from using their wallet with `sendrawtransaction` anyway. So if the goal here is to prevent accidental privacy leaks from confused users, we might want to consider \"hiding\" the option or restricting it to test networks until wallet integration is complete.",
      "created_at": "2024-06-26T17:19:52Z",
      "updated_at": "2024-06-26T17:19:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1655262092",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1655262092"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 122,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1655351745",
      "pull_request_review_id": 2142672720,
      "id": 1655351745,
      "node_id": "PRRC_kwDOABII585iqqnB",
      "diff_hunk": "@@ -1127,6 +1129,71 @@ class CConnman\n     bool GetUseAddrmanOutgoing() const { return m_use_addrman_outgoing; };\n     void SetNetworkActive(bool active);\n     void OpenNetworkConnection(const CAddress& addrConnect, bool fCountFailure, CSemaphoreGrant&& grant_outbound, const char* strDest, ConnectionType conn_type, bool use_v2transport) EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\n+\n+    /// Group of private broadcast related members.\n+    class PrivateBroadcast\n+    {\n+    public:\n+        /**\n+         * Remember if we ever established at least one outbound connection to a\n+         * Tor peer, including sending and receiving P2P messages. If this is\n+         * true then the Tor proxy indeed works and is a proxy to the Tor network,\n+         * not a misconfigured ordinary SOCKS5 proxy as -proxy or -onion. If that\n+         * is the case, then we assume that connecting to an IPv4 or IPv6 address\n+         * via that proxy will be done trough the Tor network and a Tor exit node.\n+         */\n+        std::atomic_bool m_outbound_tor_ok_at_least_once{false};\n+\n+        /**\n+         * Check if private broadcast can be done to IPv4 or IPv6 peers and if so via which proxy.\n+         * If private broadcast connections should not be opened to IPv4 or IPv6, then this will\n+         * return an empty optional.\n+         */\n+        std::optional<Proxy> ProxyForIPv4or6() const;\n+\n+        /**\n+         * Decide whether to open a private broadcast connection and if yes, to which network.\n+         * We try to open a connection of this type only if there are transactions pending, but\n+         * up to a limit.\n+         * @param[in] prev_was_private_broadcast Whether the previous attempt to open a connection\n+         * was an attempt to open a private broadcast connection (successful or not).\n+         * @param[in] num_opened Number of private broadcast connections that are currently opened.\n+         * @retval !std::nullopt The network to which to open the private broadcast connection.\n+         * @retval std::nullopt Open any other connection (non-private broadcast).\n+         */\n+        std::optional<Network>\n+        ShouldOpen(bool prev_was_private_broadcast, size_t num_opened) const;\n+\n+        /**\n+         * Decrement by `n` the number of new connections of type `ConnectionType::PRIVATE_BROADCAST`\n+         * to be opened by `CConnman::ThreadOpenConnections()`. Will not go negative, for example a\n+         * value of 4 is ok to be decremented by 5 and will result in 0.\n+         * @return the value preceding this operation\n+         */\n+        size_t NumToOpen() const;",
      "path": "src/net.h",
      "position": 1,
      "original_position": 54,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "ba75010289f1d9bd3d3a6c635ad18b07cf914041",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "ba75010289f1d9bd3d3a6c635ad18b07cf914041\r\n\r\nThis is copy/paste the comment for `NumToOpenSub()` but doesn't apply to this get-only method.\r\n\r\nAlso, the comments for the two following functions are missing `@param[in] n ...` but I don't know how strict you need to be about doxygen comments for everything.",
      "created_at": "2024-06-26T18:31:39Z",
      "updated_at": "2024-06-26T19:49:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1655351745",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1655351745"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 1167,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1188,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1655358621",
      "pull_request_review_id": 2142672720,
      "id": 1655358621,
      "node_id": "PRRC_kwDOABII585iqsSd",
      "diff_hunk": "@@ -2932,6 +2974,117 @@ void CConnman::OpenNetworkConnection(const CAddress& addrConnect, bool fCountFai\n     }\n }\n \n+std::optional<Proxy> CConnman::PrivateBroadcast::ProxyForIPv4or6() const\n+{\n+    if (!m_outbound_tor_ok_at_least_once.load()) {\n+        return std::nullopt;\n+    }\n+    Proxy tor_proxy;\n+    Assume(GetProxy(NET_ONION, tor_proxy));\n+    return tor_proxy;\n+}\n+\n+std::optional<Network>\n+CConnman::PrivateBroadcast::ShouldOpen(bool prev_was_private_broadcast, size_t num_opened) const\n+{\n+    if (prev_was_private_broadcast) {\n+        // Yield to other connection types.\n+        return std::nullopt;\n+    }",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 157,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "ba75010289f1d9bd3d3a6c635ad18b07cf914041",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "ba75010289f1d9bd3d3a6c635ad18b07cf914041\r\n\r\nWhy pass this in here instead of just checking it before calling?",
      "created_at": "2024-06-26T18:37:50Z",
      "updated_at": "2024-06-26T19:49:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1655358621",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1655358621"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 2990,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 3002,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1655402373",
      "pull_request_review_id": 2142672720,
      "id": 1655402373,
      "node_id": "PRRC_kwDOABII585iq2-F",
      "diff_hunk": "@@ -0,0 +1,52 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_PRIVATE_BROADCAST_H\n+#define BITCOIN_PRIVATE_BROADCAST_H\n+\n+#include <primitives/transaction.h>\n+#include <sync.h>\n+#include <threadsafety.h>\n+#include <util/hasher.h>\n+\n+#include <chrono>\n+#include <map>\n+#include <unordered_map>\n+\n+/**\n+ * Store a list of transactions to be broadcast privately. Supports the following operations:",
      "path": "src/private_broadcast.h",
      "position": 22,
      "original_position": 18,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cade8e833197a202dbb03c50359396ecd437ac8c",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "cade8e833197a202dbb03c50359396ecd437ac8c\r\n\r\n~optional, could use a comment explaining the priority metric. Looks like transactions with fewer broadcasts or older broadcasts are prioritized. A unit test would help make that clear as well.~\r\n\r\nnm, added later",
      "created_at": "2024-06-26T19:15:32Z",
      "updated_at": "2024-06-26T19:50:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1655402373",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1655402373"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 22,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1655423362",
      "pull_request_review_id": 2142672720,
      "id": 1655423362,
      "node_id": "PRRC_kwDOABII585iq8GC",
      "diff_hunk": "@@ -4133,6 +4248,18 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         return;\n     }\n \n+    if (pfrom.IsPrivateBroadcastConn()) {\n+        if (msg_type != NetMsgType::PONG) {\n+            LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                          BCLog::Level::Debug,\n+                          \"Ignoring incoming message '%s', peer=%d%s\\n\",\n+                          msg_type,\n+                          pfrom.GetId(),\n+                          fLogIPs ? strprintf(\", peeraddr=%s\", pfrom.addr.ToStringAddrPort()) : \"\");\n+            return;\n+        }\n+    }\n+",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 230,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b81c3cc19ec8055d04b38a72fdfabbfcb2ed2358",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "b81c3cc19ec8055d04b38a72fdfabbfcb2ed2358\r\n\r\nWhy isn't this at the top of the super long function (and include `VERACK` also?)",
      "created_at": "2024-06-26T19:36:54Z",
      "updated_at": "2024-06-26T19:49:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1655423362",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1655423362"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 4031,
      "original_start_line": 4251,
      "start_side": "RIGHT",
      "line": 4041,
      "original_line": 4041,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1655427794",
      "pull_request_review_id": 2142672720,
      "id": 1655427794,
      "node_id": "PRRC_kwDOABII585iq9LS",
      "diff_hunk": "@@ -14,10 +15,79 @@ void PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!\n     }\n }\n \n+std::optional<CTransactionRef> PrivateBroadcast::GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    if (m_by_priority.empty()) {\n+        return std::nullopt;\n+    }\n+    const Txid& txid = m_by_priority.begin()->second;\n+    auto it = m_by_txid.find(txid);\n+    if (Assume(it != m_by_txid.end())) {\n+        return it->second.tx;\n+    }\n+    m_by_priority.erase(m_by_priority.begin());",
      "path": "src/private_broadcast.cpp",
      "position": 47,
      "original_position": 23,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "b81c3cc19ec8055d04b38a72fdfabbfcb2ed2358",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "b81c3cc19ec8055d04b38a72fdfabbfcb2ed2358\r\n\r\nIs it ok to erase from this map now? What if none of our connections are successful ?",
      "created_at": "2024-06-26T19:41:24Z",
      "updated_at": "2024-06-26T19:49:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1655427794",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1655427794"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 47,
      "original_line": 47,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1655433726",
      "pull_request_review_id": 2142672720,
      "id": 1655433726,
      "node_id": "PRRC_kwDOABII585iq-n-",
      "diff_hunk": "@@ -14,10 +15,79 @@ void PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!\n     }\n }\n \n+std::optional<CTransactionRef> PrivateBroadcast::GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    if (m_by_priority.empty()) {\n+        return std::nullopt;\n+    }\n+    const Txid& txid = m_by_priority.begin()->second;\n+    auto it = m_by_txid.find(txid);\n+    if (Assume(it != m_by_txid.end())) {\n+        return it->second.tx;\n+    }\n+    m_by_priority.erase(m_by_priority.begin());\n+    return std::nullopt;\n+}\n+\n+void PrivateBroadcast::PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    m_by_nodeid.emplace(nodeid, txid);\n+}\n+\n+bool PrivateBroadcast::FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    auto it = m_by_nodeid.find(nodeid);\n+    if (it == m_by_nodeid.end()) {\n+        return false;\n+    }\n+    const Txid txid{it->second};\n+    m_by_nodeid.erase(it);\n+\n+    if (!confirmed_by_node) {\n+        return true;\n+    }\n+\n+    // Update broadcast stats.\n+\n+    auto iters = Find(txid);\n+    if (!iters) {\n+        return true;\n+    }\n+    Priority& priority = iters->by_txid->second.priority;\n+\n+    ++priority.num_broadcasted;\n+    priority.last_broadcasted = GetTime<std::chrono::microseconds>();",
      "path": "src/private_broadcast.cpp",
      "position": 1,
      "original_position": 56,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b81c3cc19ec8055d04b38a72fdfabbfcb2ed2358",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "b81c3cc19ec8055d04b38a72fdfabbfcb2ed2358\r\n\r\nIsn't this `GetTime()` deprecated?\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/7a7e7d189dfe5efa6ab3c644f55f410412163503/src/util/time.h#L95-L100",
      "created_at": "2024-06-26T19:47:45Z",
      "updated_at": "2024-06-26T19:49:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1655433726",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1655433726"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 62,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1657739692",
      "pull_request_review_id": 2146390857,
      "id": 1657739692,
      "node_id": "PRRC_kwDOABII585izxms",
      "diff_hunk": "@@ -4701,6 +4701,21 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         const uint256& hash = peer->m_wtxid_relay ? wtxid : txid;\n         AddKnownTx(*peer, hash);\n \n+        if (auto num_broadcasted = m_tx_for_private_broadcast.Remove(ptx)) {\n+            LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                          BCLog::Level::Info,\n+                          \"Received our privately broadcast transaction (txid=%s) from the \"\n+                          \"network from peer=%d%s; stopping private broadcast attempts\\n\",",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 8,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "3f5a4187a9e5d2bbb65c06c1799155fd7dd0d132",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "3f5a4187a9e5d2bbb65c06c1799155fd7dd0d132\r\n\r\nThis made me wonder, if the tx gets confirmed in a block before we get it via relay, will it ever get removed?\r\n\r\nupdate: looks like this will happen in `ReattemptPrivateBroadcast()` when we call `m_chainman.ProcessTransaction()` ?",
      "created_at": "2024-06-27T19:55:10Z",
      "updated_at": "2024-06-28T15:36:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1657739692",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1657739692"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 4707,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 4478,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1657757991",
      "pull_request_review_id": 2146390857,
      "id": 1657757991,
      "node_id": "PRRC_kwDOABII585iz2En",
      "diff_hunk": "@@ -4701,6 +4701,21 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         const uint256& hash = peer->m_wtxid_relay ? wtxid : txid;\n         AddKnownTx(*peer, hash);\n \n+        if (auto num_broadcasted = m_tx_for_private_broadcast.Remove(ptx)) {\n+            LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                          BCLog::Level::Info,\n+                          \"Received our privately broadcast transaction (txid=%s) from the \"\n+                          \"network from peer=%d%s; stopping private broadcast attempts\\n\",\n+                          txid.ToString(),\n+                          pfrom.GetId(),\n+                          fLogIPs ? strprintf(\", peeraddr=%s\", pfrom.addr.ToStringAddrPort()) : \"\");\n+            if (NUM_PRIVATE_BROADCAST_PER_TX > num_broadcasted.value()) {\n+                // Not all of the initial NUM_PRIVATE_BROADCAST_PER_TX connections were needed.\n+                // Tell CConnman it does not need to start the remaining ones.\n+                m_connman.m_private_broadcast.NumToOpenSub(NUM_PRIVATE_BROADCAST_PER_TX - num_broadcasted.value());",
      "path": "src/net_processing.cpp",
      "position": 584,
      "original_position": 15,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "3f5a4187a9e5d2bbb65c06c1799155fd7dd0d132",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "3f5a4187a9e5d2bbb65c06c1799155fd7dd0d132\r\n\r\nFeels like this should be part of `Remove()`, which I think highlights some possible confusion between the two `class PrivateBroadcast` you have. One in ConnMan and one in its own unit, used in PeerManager.\r\n\r\nI dunno if there's a cleaner approach available, to ensure that the two objects don't get out of sync? Like instead of `m_num_to_open` in ConnMan, could you refer to the size of the `ByNodeId` map?",
      "created_at": "2024-06-27T20:10:34Z",
      "updated_at": "2024-06-27T20:20:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1657757991",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1657757991"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 4525,
      "original_start_line": 4714,
      "start_side": "RIGHT",
      "line": 4526,
      "original_line": 4526,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1657760369",
      "pull_request_review_id": 2146390857,
      "id": 1657760369,
      "node_id": "PRRC_kwDOABII585iz2px",
      "diff_hunk": "@@ -15,6 +15,19 @@ void PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!\n     }\n }\n \n+std::optional<size_t> PrivateBroadcast::Remove(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    auto iters = Find(tx->GetHash());\n+    if (!iters) {\n+        return std::nullopt;\n+    }\n+    const size_t num_broadcasted{iters->by_priority->first.num_broadcasted};\n+    m_by_priority.erase(iters->by_priority);\n+    m_by_txid.erase(iters->by_txid);",
      "path": "src/private_broadcast.cpp",
      "position": 32,
      "original_position": 13,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "3f5a4187a9e5d2bbb65c06c1799155fd7dd0d132",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "what about `m_by_nodeid`?",
      "created_at": "2024-06-27T20:11:08Z",
      "updated_at": "2024-06-27T20:20:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1657760369",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1657760369"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 31,
      "original_start_line": 26,
      "start_side": "RIGHT",
      "line": 32,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1658932157",
      "pull_request_review_id": 2148337702,
      "id": 1658932157,
      "node_id": "PRRC_kwDOABII585i4Uu9",
      "diff_hunk": "@@ -81,6 +81,19 @@ bool PrivateBroadcast::FinishBroadcast(const NodeId& nodeid, bool confirmed_by_n\n     return true;\n }\n \n+std::vector<CTransactionRef> PrivateBroadcast::GetStale() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    const auto stale_time = GetTime<std::chrono::microseconds>() - 1min;",
      "path": "src/private_broadcast.cpp",
      "position": 1,
      "original_position": 7,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "a86785dc29faa2dcff301641e2f823b73089dae2",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "a86785dc29faa2dcff301641e2f823b73089dae2\r\n\r\nshould `1min` be defined as a constant in the header file? This is what we consider stale?",
      "created_at": "2024-06-28T15:38:41Z",
      "updated_at": "2024-06-28T17:51:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1658932157",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1658932157"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 87,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1658942976",
      "pull_request_review_id": 2148337702,
      "id": 1658942976,
      "node_id": "PRRC_kwDOABII585i4XYA",
      "diff_hunk": "@@ -93,11 +105,23 @@ static RPCHelpMan sendrawtransaction()\n             std::string err_string;\n             AssertLockNotHeld(cs_main);\n             NodeContext& node = EnsureAnyNodeContext(request.context);\n+            const bool private_broadcast_enabled{gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)};\n+            if (private_broadcast_enabled &&\n+                !g_reachable_nets.Contains(NET_ONION) &&\n+                !g_reachable_nets.Contains(NET_I2P)) {",
      "path": "src/rpc/mempool.cpp",
      "position": 46,
      "original_position": 44,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "5f49e61ffa576aa6c27de30a7db51d17c4f5c516",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "5f49e61ffa576aa6c27de30a7db51d17c4f5c516\r\n\r\nHow could this be condition be different now than when it is checked in init.cpp?",
      "created_at": "2024-06-28T15:46:47Z",
      "updated_at": "2024-06-28T17:51:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1658942976",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1658942976"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 114,
      "original_start_line": 109,
      "start_side": "RIGHT",
      "line": 116,
      "original_line": 116,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1659087156",
      "pull_request_review_id": 2148337702,
      "id": 1659087156,
      "node_id": "PRRC_kwDOABII585i46k0",
      "diff_hunk": "@@ -217,7 +217,12 @@ def peer_disconnect(self):\n     def connection_made(self, transport):\n         \"\"\"asyncio callback when a connection is opened.\"\"\"\n         assert not self._transport\n-        logger.debug(\"Connected & Listening: %s:%d\" % (self.dstaddr, self.dstport))\n+        info = transport.get_extra_info(\"socket\")\n+        us = info.getsockname()\n+        them = info.getpeername()\n+        logger.debug(f\"Connected: us={us[0]}:{us[1]}, them={them[0]}:{them[1]}\")\n+        self.dstaddr = them[0]\n+        self.dstport = them[1]",
      "path": "test/functional/test_framework/p2p.py",
      "position": 1,
      "original_position": 10,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0a6797ffb3eb2d45bce1dc68e830efd89ac2a442",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "0a6797ffb3eb2d45bce1dc68e830efd89ac2a442\r\n\r\nTeleporting the comment from https://github.com/bitcoin/bitcoin/pull/29420#discussion_r1592701864\r\n\r\nWhy didn't we need to do this on master?\r\n\r\nThe old log message was `Connected & Listening: 127.0.0.1:15689` not `Connected & Listening: 0:0`",
      "created_at": "2024-06-28T17:28:15Z",
      "updated_at": "2024-06-28T17:51:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1659087156",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1659087156"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 226,
      "original_start_line": 224,
      "start_side": "RIGHT",
      "line": 227,
      "original_line": 227,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1660978352",
      "pull_request_review_id": 2151261412,
      "id": 1660978352,
      "node_id": "PRRC_kwDOABII585jAISw",
      "diff_hunk": "@@ -120,6 +120,12 @@ bool WalletInit::ParameterInteraction() const\n         LogPrintf(\"%s: parameter interaction: -blocksonly=1 -> setting -walletbroadcast=0\\n\", __func__);\n     }\n \n+    if (gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST) &&",
      "path": "src/wallet/init.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "1407b3fa264b096813281a767da3cd3ca80ed096",
      "in_reply_to_id": 1578537557,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I thought about this further and removed the requirement to set `-walletbroadcast=0` when `-privatebroadcast=1`. The description of `-privatebroadcast` begins with\r\n\r\n> Broadcast transactions submitted via sendrawtransaction RPC using short lived connections...\r\n\r\nso it should be clear that this applies to the `sendrawtransaction` RPC. In addition I extended the text with\r\n\r\n> Transactions submitted through the wallet are not affected by this option",
      "created_at": "2024-07-01T12:28:45Z",
      "updated_at": "2024-07-01T12:28:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1660978352",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1660978352"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 122,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1660993146",
      "pull_request_review_id": 2151286672,
      "id": 1660993146,
      "node_id": "PRRC_kwDOABII585jAL56",
      "diff_hunk": "@@ -1127,6 +1129,71 @@ class CConnman\n     bool GetUseAddrmanOutgoing() const { return m_use_addrman_outgoing; };\n     void SetNetworkActive(bool active);\n     void OpenNetworkConnection(const CAddress& addrConnect, bool fCountFailure, CSemaphoreGrant&& grant_outbound, const char* strDest, ConnectionType conn_type, bool use_v2transport) EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\n+\n+    /// Group of private broadcast related members.\n+    class PrivateBroadcast\n+    {\n+    public:\n+        /**\n+         * Remember if we ever established at least one outbound connection to a\n+         * Tor peer, including sending and receiving P2P messages. If this is\n+         * true then the Tor proxy indeed works and is a proxy to the Tor network,\n+         * not a misconfigured ordinary SOCKS5 proxy as -proxy or -onion. If that\n+         * is the case, then we assume that connecting to an IPv4 or IPv6 address\n+         * via that proxy will be done trough the Tor network and a Tor exit node.\n+         */\n+        std::atomic_bool m_outbound_tor_ok_at_least_once{false};\n+\n+        /**\n+         * Check if private broadcast can be done to IPv4 or IPv6 peers and if so via which proxy.\n+         * If private broadcast connections should not be opened to IPv4 or IPv6, then this will\n+         * return an empty optional.\n+         */\n+        std::optional<Proxy> ProxyForIPv4or6() const;\n+\n+        /**\n+         * Decide whether to open a private broadcast connection and if yes, to which network.\n+         * We try to open a connection of this type only if there are transactions pending, but\n+         * up to a limit.\n+         * @param[in] prev_was_private_broadcast Whether the previous attempt to open a connection\n+         * was an attempt to open a private broadcast connection (successful or not).\n+         * @param[in] num_opened Number of private broadcast connections that are currently opened.\n+         * @retval !std::nullopt The network to which to open the private broadcast connection.\n+         * @retval std::nullopt Open any other connection (non-private broadcast).\n+         */\n+        std::optional<Network>\n+        ShouldOpen(bool prev_was_private_broadcast, size_t num_opened) const;\n+\n+        /**\n+         * Decrement by `n` the number of new connections of type `ConnectionType::PRIVATE_BROADCAST`\n+         * to be opened by `CConnman::ThreadOpenConnections()`. Will not go negative, for example a\n+         * value of 4 is ok to be decremented by 5 and will result in 0.\n+         * @return the value preceding this operation\n+         */\n+        size_t NumToOpen() const;",
      "path": "src/net.h",
      "position": 1,
      "original_position": 54,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "ba75010289f1d9bd3d3a6c635ad18b07cf914041",
      "in_reply_to_id": 1655351745,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Fixed and added `@param[in]` comments.\r\n\r\nWhat is enforced by clang (not by doxygen) via `-Wdocumentation` is a mismatch in the parameter names - e.g. if there is `@param[in] throughput ...` and the actual parameter is `int thrughput`, then it will give a warning (or error if `-Werror` is used).",
      "created_at": "2024-07-01T12:40:54Z",
      "updated_at": "2024-07-01T12:40:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1660993146",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1660993146"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 1167,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1188,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1660998055",
      "pull_request_review_id": 2151295387,
      "id": 1660998055,
      "node_id": "PRRC_kwDOABII585jANGn",
      "diff_hunk": "@@ -2932,6 +2974,117 @@ void CConnman::OpenNetworkConnection(const CAddress& addrConnect, bool fCountFai\n     }\n }\n \n+std::optional<Proxy> CConnman::PrivateBroadcast::ProxyForIPv4or6() const\n+{\n+    if (!m_outbound_tor_ok_at_least_once.load()) {\n+        return std::nullopt;\n+    }\n+    Proxy tor_proxy;\n+    Assume(GetProxy(NET_ONION, tor_proxy));\n+    return tor_proxy;\n+}\n+\n+std::optional<Network>\n+CConnman::PrivateBroadcast::ShouldOpen(bool prev_was_private_broadcast, size_t num_opened) const\n+{\n+    if (prev_was_private_broadcast) {\n+        // Yield to other connection types.\n+        return std::nullopt;\n+    }",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 157,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "ba75010289f1d9bd3d3a6c635ad18b07cf914041",
      "in_reply_to_id": 1655358621,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Could be either way. If there is more than one caller of this function, then having it here would avoid duplicating the check in every caller, but there is one caller so far.",
      "created_at": "2024-07-01T12:44:33Z",
      "updated_at": "2024-07-01T12:44:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1660998055",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1660998055"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 2990,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 3002,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1661016997",
      "pull_request_review_id": 2151329216,
      "id": 1661016997,
      "node_id": "PRRC_kwDOABII585jARul",
      "diff_hunk": "@@ -4133,6 +4248,18 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         return;\n     }\n \n+    if (pfrom.IsPrivateBroadcastConn()) {\n+        if (msg_type != NetMsgType::PONG) {\n+            LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                          BCLog::Level::Debug,\n+                          \"Ignoring incoming message '%s', peer=%d%s\\n\",\n+                          msg_type,\n+                          pfrom.GetId(),\n+                          fLogIPs ? strprintf(\", peeraddr=%s\", pfrom.addr.ToStringAddrPort()) : \"\");\n+            return;\n+        }\n+    }\n+",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 230,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b81c3cc19ec8055d04b38a72fdfabbfcb2ed2358",
      "in_reply_to_id": 1655423362,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Because we want to ignore incoming messages after a successful handshake. Ignoring the `VERACK` would disturb the handshake.",
      "created_at": "2024-07-01T12:58:38Z",
      "updated_at": "2024-07-01T12:58:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1661016997",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1661016997"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 4031,
      "original_start_line": 4251,
      "start_side": "RIGHT",
      "line": 4041,
      "original_line": 4041,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1661030282",
      "pull_request_review_id": 2151353211,
      "id": 1661030282,
      "node_id": "PRRC_kwDOABII585jAU-K",
      "diff_hunk": "@@ -14,10 +15,79 @@ void PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!\n     }\n }\n \n+std::optional<CTransactionRef> PrivateBroadcast::GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    if (m_by_priority.empty()) {\n+        return std::nullopt;\n+    }\n+    const Txid& txid = m_by_priority.begin()->second;\n+    auto it = m_by_txid.find(txid);\n+    if (Assume(it != m_by_txid.end())) {\n+        return it->second.tx;\n+    }\n+    m_by_priority.erase(m_by_priority.begin());",
      "path": "src/private_broadcast.cpp",
      "position": 47,
      "original_position": 23,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "b81c3cc19ec8055d04b38a72fdfabbfcb2ed2358",
      "in_reply_to_id": 1655427794,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Note that this would only be reached if `m_by_priority` contains txid that does not have an entry in `m_by_txid` which is a gross bug in the `PrivateBroadast` class. IIRC this was an assert before but somebody suggested to use `Assume()` instead.",
      "created_at": "2024-07-01T13:09:06Z",
      "updated_at": "2024-07-01T13:09:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1661030282",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1661030282"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 47,
      "original_line": 47,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1661067868",
      "pull_request_review_id": 2151418242,
      "id": 1661067868,
      "node_id": "PRRC_kwDOABII585jAeJc",
      "diff_hunk": "@@ -14,10 +15,79 @@ void PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!\n     }\n }\n \n+std::optional<CTransactionRef> PrivateBroadcast::GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    if (m_by_priority.empty()) {\n+        return std::nullopt;\n+    }\n+    const Txid& txid = m_by_priority.begin()->second;\n+    auto it = m_by_txid.find(txid);\n+    if (Assume(it != m_by_txid.end())) {\n+        return it->second.tx;\n+    }\n+    m_by_priority.erase(m_by_priority.begin());\n+    return std::nullopt;\n+}\n+\n+void PrivateBroadcast::PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    m_by_nodeid.emplace(nodeid, txid);\n+}\n+\n+bool PrivateBroadcast::FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    auto it = m_by_nodeid.find(nodeid);\n+    if (it == m_by_nodeid.end()) {\n+        return false;\n+    }\n+    const Txid txid{it->second};\n+    m_by_nodeid.erase(it);\n+\n+    if (!confirmed_by_node) {\n+        return true;\n+    }\n+\n+    // Update broadcast stats.\n+\n+    auto iters = Find(txid);\n+    if (!iters) {\n+        return true;\n+    }\n+    Priority& priority = iters->by_txid->second.priority;\n+\n+    ++priority.num_broadcasted;\n+    priority.last_broadcasted = GetTime<std::chrono::microseconds>();",
      "path": "src/private_broadcast.cpp",
      "position": 1,
      "original_position": 56,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b81c3cc19ec8055d04b38a72fdfabbfcb2ed2358",
      "in_reply_to_id": 1655433726,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Replaced with `NodeClock::now()`.",
      "created_at": "2024-07-01T13:34:28Z",
      "updated_at": "2024-07-01T13:34:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1661067868",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1661067868"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 62,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1661325008",
      "pull_request_review_id": 2151847905,
      "id": 1661325008,
      "node_id": "PRRC_kwDOABII585jBc7Q",
      "diff_hunk": "@@ -4701,6 +4701,21 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         const uint256& hash = peer->m_wtxid_relay ? wtxid : txid;\n         AddKnownTx(*peer, hash);\n \n+        if (auto num_broadcasted = m_tx_for_private_broadcast.Remove(ptx)) {\n+            LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                          BCLog::Level::Info,\n+                          \"Received our privately broadcast transaction (txid=%s) from the \"\n+                          \"network from peer=%d%s; stopping private broadcast attempts\\n\",",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 8,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "3f5a4187a9e5d2bbb65c06c1799155fd7dd0d132",
      "in_reply_to_id": 1657739692,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, it will return something other than `MempoolAcceptResult::ResultType::VALID`. Would happen as well if a conflicting transaction is mined in the meantime.",
      "created_at": "2024-07-01T17:01:00Z",
      "updated_at": "2024-07-01T17:01:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1661325008",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1661325008"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 4707,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 4478,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1661339294",
      "pull_request_review_id": 2151879192,
      "id": 1661339294,
      "node_id": "PRRC_kwDOABII585jBgae",
      "diff_hunk": "@@ -4701,6 +4701,21 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         const uint256& hash = peer->m_wtxid_relay ? wtxid : txid;\n         AddKnownTx(*peer, hash);\n \n+        if (auto num_broadcasted = m_tx_for_private_broadcast.Remove(ptx)) {\n+            LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                          BCLog::Level::Info,\n+                          \"Received our privately broadcast transaction (txid=%s) from the \"\n+                          \"network from peer=%d%s; stopping private broadcast attempts\\n\",\n+                          txid.ToString(),\n+                          pfrom.GetId(),\n+                          fLogIPs ? strprintf(\", peeraddr=%s\", pfrom.addr.ToStringAddrPort()) : \"\");\n+            if (NUM_PRIVATE_BROADCAST_PER_TX > num_broadcasted.value()) {\n+                // Not all of the initial NUM_PRIVATE_BROADCAST_PER_TX connections were needed.\n+                // Tell CConnman it does not need to start the remaining ones.\n+                m_connman.m_private_broadcast.NumToOpenSub(NUM_PRIVATE_BROADCAST_PER_TX - num_broadcasted.value());",
      "path": "src/net_processing.cpp",
      "position": 584,
      "original_position": 15,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "3f5a4187a9e5d2bbb65c06c1799155fd7dd0d132",
      "in_reply_to_id": 1657757991,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "There is some layer separation between `net`/`CConnman` and `net_processing`/`PeerManager` which I am trying not to blur too much. The lower `net` level only knows about connections and things like \"I need to open N connections of type X\". It does not know anything about transactions, or P2P messages which are handled by the `net_processing` layer.\r\n\r\nThe constant `NUM_PRIVATE_BROADCAST_PER_TX` (_send a transaction to this many peers_) belongs to the `net_processing` layer. Calling this `NumToOpenSub()` is only done if `Remove()` succeeds and `NUM_PRIVATE_BROADCAST_PER_TX > num_broadcasted.value()` holds. So, no way to do it in `CConnman` because that would mean accessing `NUM_PRIVATE_BROADCAST_PER_TX` from `CConnman`.\r\n\r\n> could you refer to the size of the `ByNodeId` map?\r\n\r\nThat is a \"transaction id mapped by node id\". Couldn't deal with transactions from within `CConnman`.",
      "created_at": "2024-07-01T17:16:58Z",
      "updated_at": "2024-07-01T17:16:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1661339294",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1661339294"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 4525,
      "original_start_line": 4714,
      "start_side": "RIGHT",
      "line": 4526,
      "original_line": 4526,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1662139846",
      "pull_request_review_id": 2153183459,
      "id": 1662139846,
      "node_id": "PRRC_kwDOABII585jEj3G",
      "diff_hunk": "@@ -15,6 +15,19 @@ void PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!\n     }\n }\n \n+std::optional<size_t> PrivateBroadcast::Remove(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    auto iters = Find(tx->GetHash());\n+    if (!iters) {\n+        return std::nullopt;\n+    }\n+    const size_t num_broadcasted{iters->by_priority->first.num_broadcasted};\n+    m_by_priority.erase(iters->by_priority);\n+    m_by_txid.erase(iters->by_txid);",
      "path": "src/private_broadcast.cpp",
      "position": 32,
      "original_position": 13,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "3f5a4187a9e5d2bbb65c06c1799155fd7dd0d132",
      "in_reply_to_id": 1657760369,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`m_by_nodeid` is managed by `PrivateBroadcast::PushedToNode()` and `PrivateBroadcast::FinishBroadcast()`.",
      "created_at": "2024-07-02T09:04:07Z",
      "updated_at": "2024-07-02T09:04:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1662139846",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1662139846"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 31,
      "original_start_line": 26,
      "start_side": "RIGHT",
      "line": 32,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1662227439",
      "pull_request_review_id": 2153324654,
      "id": 1662227439,
      "node_id": "PRRC_kwDOABII585jE5Pv",
      "diff_hunk": "@@ -81,6 +81,19 @@ bool PrivateBroadcast::FinishBroadcast(const NodeId& nodeid, bool confirmed_by_n\n     return true;\n }\n \n+std::vector<CTransactionRef> PrivateBroadcast::GetStale() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    const auto stale_time = GetTime<std::chrono::microseconds>() - 1min;",
      "path": "src/private_broadcast.cpp",
      "position": 1,
      "original_position": 7,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "a86785dc29faa2dcff301641e2f823b73089dae2",
      "in_reply_to_id": 1658932157,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, moved to a constant and added a comment to it. Placed the constant in the `.cpp` file since it is only used in that `.cpp` file, to limit its scope. It is not part of the \"public\" `private_broadcast.h/cpp` interface",
      "created_at": "2024-07-02T09:53:47Z",
      "updated_at": "2024-07-02T09:53:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1662227439",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1662227439"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 87,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1662247336",
      "pull_request_review_id": 2153355154,
      "id": 1662247336,
      "node_id": "PRRC_kwDOABII585jE-Go",
      "diff_hunk": "@@ -93,11 +105,23 @@ static RPCHelpMan sendrawtransaction()\n             std::string err_string;\n             AssertLockNotHeld(cs_main);\n             NodeContext& node = EnsureAnyNodeContext(request.context);\n+            const bool private_broadcast_enabled{gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)};\n+            if (private_broadcast_enabled &&\n+                !g_reachable_nets.Contains(NET_ONION) &&\n+                !g_reachable_nets.Contains(NET_I2P)) {",
      "path": "src/rpc/mempool.cpp",
      "position": 46,
      "original_position": 44,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "5f49e61ffa576aa6c27de30a7db51d17c4f5c516",
      "in_reply_to_id": 1658942976,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The Tor connectivity could be \"off\" during startup and become \"on\" later at runtime, when we connect to the Tor daemon and it tells us the Tor proxy address. This is why the startup condition is a bit different, it has the `onion_may_become_reachable` variable.",
      "created_at": "2024-07-02T10:05:52Z",
      "updated_at": "2024-07-02T10:05:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1662247336",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1662247336"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 114,
      "original_start_line": 109,
      "start_side": "RIGHT",
      "line": 116,
      "original_line": 116,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1662271368",
      "pull_request_review_id": 2153394349,
      "id": 1662271368,
      "node_id": "PRRC_kwDOABII585jFD-I",
      "diff_hunk": "@@ -217,7 +217,12 @@ def peer_disconnect(self):\n     def connection_made(self, transport):\n         \"\"\"asyncio callback when a connection is opened.\"\"\"\n         assert not self._transport\n-        logger.debug(\"Connected & Listening: %s:%d\" % (self.dstaddr, self.dstport))\n+        info = transport.get_extra_info(\"socket\")\n+        us = info.getsockname()\n+        them = info.getpeername()\n+        logger.debug(f\"Connected: us={us[0]}:{us[1]}, them={them[0]}:{them[1]}\")\n+        self.dstaddr = them[0]\n+        self.dstport = them[1]",
      "path": "test/functional/test_framework/p2p.py",
      "position": 1,
      "original_position": 10,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "0a6797ffb3eb2d45bce1dc68e830efd89ac2a442",
      "in_reply_to_id": 1659087156,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I [replied](https://github.com/bitcoin/bitcoin/pull/29420#discussion_r1662270745) to that thread to keep the discussion in one place.",
      "created_at": "2024-07-02T10:23:35Z",
      "updated_at": "2024-07-02T10:24:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1662271368",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1662271368"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 226,
      "original_start_line": 224,
      "start_side": "RIGHT",
      "line": 227,
      "original_line": 227,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1662855604",
      "pull_request_review_id": 2154365549,
      "id": 1662855604,
      "node_id": "PRRC_kwDOABII585jHSm0",
      "diff_hunk": "@@ -0,0 +1,307 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 68,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "3bd618a91fe3935399d380d254996e4263586c80",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "```Suggestion\r\nADDRMAN_ADDRESSES = [\r\n```",
      "created_at": "2024-07-02T16:42:20Z",
      "updated_at": "2024-07-02T19:18:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1662855604",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1662855604"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 68,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1662998546",
      "pull_request_review_id": 2154365549,
      "id": 1662998546,
      "node_id": "PRRC_kwDOABII585jH1gS",
      "diff_hunk": "@@ -0,0 +1,307 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"to_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"to_port\": p2p_port(1), # nodes[1] listen port\n+                    \"node\": None,\n+                    \"requested_to_addr\": None,\n+                })\n+            else:\n+                # Create a Python P2P listening node and add it to self.socks5_server.conf.destinations[]\n+                listener = P2PInterface()\n+                listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                listener.peer_connect_send_version(services=P2P_SERVICES)\n+                self.network_thread.listen(\n+                    p2p=listener,\n+                    # Instruct the SOCKS5 server to redirect a connection to this Python P2P listener.\n+                    callback=lambda addr, port: self.socks5_server.conf.destinations.append({\n+                        \"to_addr\": addr,\n+                        \"to_port\": port,\n+                        \"node\": None,\n+                        \"requested_to_addr\": None,\n+                    }),\n+                    addr=\"127.0.0.1\",\n+                    port=ports_base + i)\n+                # Wait until the callback has been called and it has done append().\n+                self.wait_until(lambda: len(self.socks5_server.conf.destinations) == i + 1)\n+\n+                self.socks5_server.conf.destinations[i][\"node\"] = listener\n+\n+        self.extra_args = [\n+            [\n+                \"-cjdnsreachable\", # needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{p2p_port(1)}=onion\", # consider all incoming as coming from Tor\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+\n+        observer_inbound = tx_originator.add_p2p_connection(P2PDataStore())\n+\n+        # Fill tx_originator's addrman.\n+        for addr in addresses:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: self.socks5_server.conf.destinations_used == NUM_INITIAL_CONNECTIONS)\n+\n+        node1 = self.nodes[1]",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 236,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "3bd618a91fe3935399d380d254996e4263586c80",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "s/node1/tx_receiver/",
      "created_at": "2024-07-02T18:38:42Z",
      "updated_at": "2024-07-02T19:18:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1662998546",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1662998546"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 236,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1663040526",
      "pull_request_review_id": 2154365549,
      "id": 1663040526,
      "node_id": "PRRC_kwDOABII585jH_wO",
      "diff_hunk": "@@ -0,0 +1,307 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"to_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"to_port\": p2p_port(1), # nodes[1] listen port\n+                    \"node\": None,\n+                    \"requested_to_addr\": None,\n+                })\n+            else:\n+                # Create a Python P2P listening node and add it to self.socks5_server.conf.destinations[]\n+                listener = P2PInterface()\n+                listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                listener.peer_connect_send_version(services=P2P_SERVICES)\n+                self.network_thread.listen(\n+                    p2p=listener,\n+                    # Instruct the SOCKS5 server to redirect a connection to this Python P2P listener.\n+                    callback=lambda addr, port: self.socks5_server.conf.destinations.append({\n+                        \"to_addr\": addr,\n+                        \"to_port\": port,\n+                        \"node\": None,\n+                        \"requested_to_addr\": None,\n+                    }),\n+                    addr=\"127.0.0.1\",\n+                    port=ports_base + i)\n+                # Wait until the callback has been called and it has done append().\n+                self.wait_until(lambda: len(self.socks5_server.conf.destinations) == i + 1)\n+\n+                self.socks5_server.conf.destinations[i][\"node\"] = listener\n+\n+        self.extra_args = [\n+            [\n+                \"-cjdnsreachable\", # needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{p2p_port(1)}=onion\", # consider all incoming as coming from Tor\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+\n+        observer_inbound = tx_originator.add_p2p_connection(P2PDataStore())\n+\n+        # Fill tx_originator's addrman.\n+        for addr in addresses:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: self.socks5_server.conf.destinations_used == NUM_INITIAL_CONNECTIONS)\n+\n+        node1 = self.nodes[1]\n+        far_observer = node1.add_p2p_connection(P2PInterface())\n+\n+        # The next opened connections should be \"private broadcast\" for sending the transaction.\n+\n+        miniwallet = MiniWallet(tx_originator)\n+        tx = miniwallet.send_self_transfer(from_node=tx_originator)\n+        self.log.info(f\"Created transaction txid={tx['txid']}\")\n+\n+        self.log.debug(f\"Inspecting outbound connection i={NUM_INITIAL_CONNECTIONS}, must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(node1.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(tx[\"txid\"])\n+        self.log.debug(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: the private broadcast target received and further relayed the transaction\")\n+\n+        num_private_broadcast_opened = 1 # already 1 connection to node1, confirmed by far_observer getting the tx\n+        for i in range(NUM_INITIAL_CONNECTIONS + 1, len(self.socks5_server.conf.destinations)):\n+            self.log.debug(f\"Inspecting outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            peer = self.socks5_server.conf.destinations[i][\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            requested_to_addr = self.socks5_server.conf.destinations[i][\"requested_to_addr\"]\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"Outbound connection i={i} to {requested_to_addr} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"Outbound connection i={i} to {requested_to_addr} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.rehash(), tx[\"txid\"])\n+            self.log.debug(f\"Outbound connection i={i} is proper private broadcast, test ok\")\n+            num_private_broadcast_opened += 1\n+            if num_private_broadcast_opened == NUM_PRIVATE_BROADCAST_PER_TX:\n+                break\n+        assert_equal(num_private_broadcast_opened, NUM_PRIVATE_BROADCAST_PER_TX)\n+\n+        wtxid_int = int(tx[\"wtxid\"], 16)\n+        inv = CInv(MSG_WTX, wtxid_int)\n+\n+        self.log.info(\"Checking that the transaction is not in the originator node's mempool\")\n+        assert_equal(len(tx_originator.getrawmempool()), 0)\n+\n+        self.log.info(\"Sending INV from an observer and waiting for GETDATA from node\")\n+        observer_inbound.tx_store[wtxid_int] = tx[\"tx\"]\n+        assert \"getdata\" not in observer_inbound.last_message\n+        observer_inbound.send_message(msg_inv([inv]))\n+        observer_inbound.wait_until(lambda: \"getdata\" in observer_inbound.last_message)\n+        self.wait_until(lambda: len(tx_originator.getrawmempool()) > 0)\n+\n+        self.log.info(\"Waiting for normal broadcast to another observer\")\n+        observer_outbound = self.socks5_server.conf.destinations[0][\"node\"]\n+        observer_outbound.wait_for_inv([inv])",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 303,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "3bd618a91fe3935399d380d254996e4263586c80",
      "in_reply_to_id": null,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think the test needs coverage for:\r\n\r\n1) retrying broadcasts\r\n2) sending the same tx again via sendrawtransaction\r\n3) sending a different wtxid via sendrawtransaction\r\n4) sending a tx with in-mempool dependencies (both that succeed and fail due to existing/missing parent)\r\n5) rpc failing if it detects `!g_reachable_nets`\r\n6) what happens if there's not enough private connections when first broadcast attempt is tried, but more found later\r\n7) what happens to pending broadcasts on restart of node",
      "created_at": "2024-07-02T19:16:23Z",
      "updated_at": "2024-07-02T19:35:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1663040526",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1663040526"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 303,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1698508719",
      "pull_request_review_id": 2210168984,
      "id": 1698508719,
      "node_id": "PRRC_kwDOABII585lPS-v",
      "diff_hunk": "@@ -0,0 +1,307 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 68,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "3bd618a91fe3935399d380d254996e4263586c80",
      "in_reply_to_id": 1662855604,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2024-07-31T13:26:04Z",
      "updated_at": "2024-07-31T13:26:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1698508719",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1698508719"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 68,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1698509353",
      "pull_request_review_id": 2210169976,
      "id": 1698509353,
      "node_id": "PRRC_kwDOABII585lPTIp",
      "diff_hunk": "@@ -0,0 +1,307 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"to_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"to_port\": p2p_port(1), # nodes[1] listen port\n+                    \"node\": None,\n+                    \"requested_to_addr\": None,\n+                })\n+            else:\n+                # Create a Python P2P listening node and add it to self.socks5_server.conf.destinations[]\n+                listener = P2PInterface()\n+                listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                listener.peer_connect_send_version(services=P2P_SERVICES)\n+                self.network_thread.listen(\n+                    p2p=listener,\n+                    # Instruct the SOCKS5 server to redirect a connection to this Python P2P listener.\n+                    callback=lambda addr, port: self.socks5_server.conf.destinations.append({\n+                        \"to_addr\": addr,\n+                        \"to_port\": port,\n+                        \"node\": None,\n+                        \"requested_to_addr\": None,\n+                    }),\n+                    addr=\"127.0.0.1\",\n+                    port=ports_base + i)\n+                # Wait until the callback has been called and it has done append().\n+                self.wait_until(lambda: len(self.socks5_server.conf.destinations) == i + 1)\n+\n+                self.socks5_server.conf.destinations[i][\"node\"] = listener\n+\n+        self.extra_args = [\n+            [\n+                \"-cjdnsreachable\", # needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{p2p_port(1)}=onion\", # consider all incoming as coming from Tor\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+\n+        observer_inbound = tx_originator.add_p2p_connection(P2PDataStore())\n+\n+        # Fill tx_originator's addrman.\n+        for addr in addresses:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: self.socks5_server.conf.destinations_used == NUM_INITIAL_CONNECTIONS)\n+\n+        node1 = self.nodes[1]",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 236,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "3bd618a91fe3935399d380d254996e4263586c80",
      "in_reply_to_id": 1662998546,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done, even though there is more than one tx receiver.",
      "created_at": "2024-07-31T13:26:27Z",
      "updated_at": "2024-07-31T13:26:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1698509353",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1698509353"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 236,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1698517255",
      "pull_request_review_id": 2210183207,
      "id": 1698517255,
      "node_id": "PRRC_kwDOABII585lPVEH",
      "diff_hunk": "@@ -0,0 +1,307 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"to_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"to_port\": p2p_port(1), # nodes[1] listen port\n+                    \"node\": None,\n+                    \"requested_to_addr\": None,\n+                })\n+            else:\n+                # Create a Python P2P listening node and add it to self.socks5_server.conf.destinations[]\n+                listener = P2PInterface()\n+                listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                listener.peer_connect_send_version(services=P2P_SERVICES)\n+                self.network_thread.listen(\n+                    p2p=listener,\n+                    # Instruct the SOCKS5 server to redirect a connection to this Python P2P listener.\n+                    callback=lambda addr, port: self.socks5_server.conf.destinations.append({\n+                        \"to_addr\": addr,\n+                        \"to_port\": port,\n+                        \"node\": None,\n+                        \"requested_to_addr\": None,\n+                    }),\n+                    addr=\"127.0.0.1\",\n+                    port=ports_base + i)\n+                # Wait until the callback has been called and it has done append().\n+                self.wait_until(lambda: len(self.socks5_server.conf.destinations) == i + 1)\n+\n+                self.socks5_server.conf.destinations[i][\"node\"] = listener\n+\n+        self.extra_args = [\n+            [\n+                \"-cjdnsreachable\", # needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{p2p_port(1)}=onion\", # consider all incoming as coming from Tor\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+\n+        observer_inbound = tx_originator.add_p2p_connection(P2PDataStore())\n+\n+        # Fill tx_originator's addrman.\n+        for addr in addresses:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: self.socks5_server.conf.destinations_used == NUM_INITIAL_CONNECTIONS)\n+\n+        node1 = self.nodes[1]\n+        far_observer = node1.add_p2p_connection(P2PInterface())\n+\n+        # The next opened connections should be \"private broadcast\" for sending the transaction.\n+\n+        miniwallet = MiniWallet(tx_originator)\n+        tx = miniwallet.send_self_transfer(from_node=tx_originator)\n+        self.log.info(f\"Created transaction txid={tx['txid']}\")\n+\n+        self.log.debug(f\"Inspecting outbound connection i={NUM_INITIAL_CONNECTIONS}, must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(node1.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(tx[\"txid\"])\n+        self.log.debug(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: the private broadcast target received and further relayed the transaction\")\n+\n+        num_private_broadcast_opened = 1 # already 1 connection to node1, confirmed by far_observer getting the tx\n+        for i in range(NUM_INITIAL_CONNECTIONS + 1, len(self.socks5_server.conf.destinations)):\n+            self.log.debug(f\"Inspecting outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            peer = self.socks5_server.conf.destinations[i][\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            requested_to_addr = self.socks5_server.conf.destinations[i][\"requested_to_addr\"]\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"Outbound connection i={i} to {requested_to_addr} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"Outbound connection i={i} to {requested_to_addr} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.rehash(), tx[\"txid\"])\n+            self.log.debug(f\"Outbound connection i={i} is proper private broadcast, test ok\")\n+            num_private_broadcast_opened += 1\n+            if num_private_broadcast_opened == NUM_PRIVATE_BROADCAST_PER_TX:\n+                break\n+        assert_equal(num_private_broadcast_opened, NUM_PRIVATE_BROADCAST_PER_TX)\n+\n+        wtxid_int = int(tx[\"wtxid\"], 16)\n+        inv = CInv(MSG_WTX, wtxid_int)\n+\n+        self.log.info(\"Checking that the transaction is not in the originator node's mempool\")\n+        assert_equal(len(tx_originator.getrawmempool()), 0)\n+\n+        self.log.info(\"Sending INV from an observer and waiting for GETDATA from node\")\n+        observer_inbound.tx_store[wtxid_int] = tx[\"tx\"]\n+        assert \"getdata\" not in observer_inbound.last_message\n+        observer_inbound.send_message(msg_inv([inv]))\n+        observer_inbound.wait_until(lambda: \"getdata\" in observer_inbound.last_message)\n+        self.wait_until(lambda: len(tx_originator.getrawmempool()) > 0)\n+\n+        self.log.info(\"Waiting for normal broadcast to another observer\")\n+        observer_outbound = self.socks5_server.conf.destinations[0][\"node\"]\n+        observer_outbound.wait_for_inv([inv])",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 303,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "3bd618a91fe3935399d380d254996e4263586c80",
      "in_reply_to_id": 1663040526,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> I think the test needs coverage for:\r\n\r\nI was stuck at https://github.com/bitcoin/bitcoin/issues/30543, thank you @mzumsande for resolving it!\r\n\r\n>     1. retrying broadcasts\r\n\r\nDone.\r\n\r\n>     2. sending the same tx again via sendrawtransaction\r\n\r\nDone.\r\n\r\n>     3. sending a different wtxid via sendrawtransaction\r\n\r\nDone, but the new tx has garbage witness. Would be nice to add one more test with a valid but different witness.\r\n\r\n>     4. sending a tx with in-mempool dependencies (both that succeed and fail due to existing/missing parent)\r\n\r\nDone, both.\r\n\r\n>     5. rpc failing if it detects `!g_reachable_nets`\r\n\r\nDone.\r\n\r\n>     6. what happens if there's not enough private connections when first broadcast attempt is tried, but more found later\r\n\r\nPrivate broadcast connections are created on demand. When first broadcast attempt is tried they are 0 (I did not add new test).\r\n\r\n>     7. what happens to pending broadcasts on restart of node\r\n\r\nThey are lost. Persistence over restart is not in this PR, but will be in a subsequent one (I did not add new test).",
      "created_at": "2024-07-31T13:31:32Z",
      "updated_at": "2024-07-31T13:31:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1698517255",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1698517255"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 303,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1698661559",
      "pull_request_review_id": 2210418587,
      "id": 1698661559,
      "node_id": "PRRC_kwDOABII585lP4S3",
      "diff_hunk": "@@ -0,0 +1,307 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\n+The topology in the test is:\n+\n+Bitcoin Core (tx_originator)\n+               ^   v       The default full-outbound + block-only connections\n+               |   |       (MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS):\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[0][\"node\"])\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[1][\"node\"])\n+               |   ...\n+               |   |       The private broadcast TX recipients\n+               |   |       (NUM_PRIVATE_BROADCAST_PER_TX)\n+               |   |       plus maybe some feeler or extra block only connections:\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> Bitcoin Core (node1) (self.socks5_server.conf.destinations[i][\"node\"] is None)\n+               |   |                          ^\n+               |   |                          *----< P2PInterface (far_observer) (to check Bitcoin Core relays the tx)\n+               |   |\n+               |   *-----> SOCKS5 Proxy ---> P2PInterface (self.socks5_server.conf.destinations[i + 1][\"node\"])\n+               |   ...\n+               |\n+               *---------< P2PDataStore (observer_inbound)\n+\"\"\"\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    msg_inv,\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    p2p_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 5\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+addresses = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        ports_base = p2p_port(MAX_NODES) + 15000\n+\n+        # Add 2 because one feeler and one extra block relay connections may\n+        # sneak in between the private broadcast connections.\n+        for i in range(NUM_INITIAL_CONNECTIONS + NUM_PRIVATE_BROADCAST_PER_TX + 2):\n+            if i == NUM_INITIAL_CONNECTIONS:\n+                # Instruct the SOCKS5 server to redirect the first private\n+                # broadcast connection from nodes[0] to nodes[1]\n+                self.socks5_server.conf.destinations.append({\n+                    \"to_addr\": \"127.0.0.1\", # nodes[1] listen address\n+                    \"to_port\": p2p_port(1), # nodes[1] listen port\n+                    \"node\": None,\n+                    \"requested_to_addr\": None,\n+                })\n+            else:\n+                # Create a Python P2P listening node and add it to self.socks5_server.conf.destinations[]\n+                listener = P2PInterface()\n+                listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                listener.peer_connect_send_version(services=P2P_SERVICES)\n+                self.network_thread.listen(\n+                    p2p=listener,\n+                    # Instruct the SOCKS5 server to redirect a connection to this Python P2P listener.\n+                    callback=lambda addr, port: self.socks5_server.conf.destinations.append({\n+                        \"to_addr\": addr,\n+                        \"to_port\": port,\n+                        \"node\": None,\n+                        \"requested_to_addr\": None,\n+                    }),\n+                    addr=\"127.0.0.1\",\n+                    port=ports_base + i)\n+                # Wait until the callback has been called and it has done append().\n+                self.wait_until(lambda: len(self.socks5_server.conf.destinations) == i + 1)\n+\n+                self.socks5_server.conf.destinations[i][\"node\"] = listener\n+\n+        self.extra_args = [\n+            [\n+                \"-cjdnsreachable\", # needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{p2p_port(1)}=onion\", # consider all incoming as coming from Tor\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+\n+        observer_inbound = tx_originator.add_p2p_connection(P2PDataStore())\n+\n+        # Fill tx_originator's addrman.\n+        for addr in addresses:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: self.socks5_server.conf.destinations_used == NUM_INITIAL_CONNECTIONS)\n+\n+        node1 = self.nodes[1]\n+        far_observer = node1.add_p2p_connection(P2PInterface())\n+\n+        # The next opened connections should be \"private broadcast\" for sending the transaction.\n+\n+        miniwallet = MiniWallet(tx_originator)\n+        tx = miniwallet.send_self_transfer(from_node=tx_originator)\n+        self.log.info(f\"Created transaction txid={tx['txid']}\")\n+\n+        self.log.debug(f\"Inspecting outbound connection i={NUM_INITIAL_CONNECTIONS}, must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(node1.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(tx[\"txid\"])\n+        self.log.debug(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: the private broadcast target received and further relayed the transaction\")\n+\n+        num_private_broadcast_opened = 1 # already 1 connection to node1, confirmed by far_observer getting the tx\n+        for i in range(NUM_INITIAL_CONNECTIONS + 1, len(self.socks5_server.conf.destinations)):\n+            self.log.debug(f\"Inspecting outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            peer = self.socks5_server.conf.destinations[i][\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            requested_to_addr = self.socks5_server.conf.destinations[i][\"requested_to_addr\"]\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"Outbound connection i={i} to {requested_to_addr} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"Outbound connection i={i} to {requested_to_addr} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.rehash(), tx[\"txid\"])\n+            self.log.debug(f\"Outbound connection i={i} is proper private broadcast, test ok\")\n+            num_private_broadcast_opened += 1\n+            if num_private_broadcast_opened == NUM_PRIVATE_BROADCAST_PER_TX:\n+                break\n+        assert_equal(num_private_broadcast_opened, NUM_PRIVATE_BROADCAST_PER_TX)\n+\n+        wtxid_int = int(tx[\"wtxid\"], 16)\n+        inv = CInv(MSG_WTX, wtxid_int)\n+\n+        self.log.info(\"Checking that the transaction is not in the originator node's mempool\")\n+        assert_equal(len(tx_originator.getrawmempool()), 0)\n+\n+        self.log.info(\"Sending INV from an observer and waiting for GETDATA from node\")\n+        observer_inbound.tx_store[wtxid_int] = tx[\"tx\"]\n+        assert \"getdata\" not in observer_inbound.last_message\n+        observer_inbound.send_message(msg_inv([inv]))\n+        observer_inbound.wait_until(lambda: \"getdata\" in observer_inbound.last_message)\n+        self.wait_until(lambda: len(tx_originator.getrawmempool()) > 0)\n+\n+        self.log.info(\"Waiting for normal broadcast to another observer\")\n+        observer_outbound = self.socks5_server.conf.destinations[0][\"node\"]\n+        observer_outbound.wait_for_inv([inv])",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 303,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "3bd618a91fe3935399d380d254996e4263586c80",
      "in_reply_to_id": 1663040526,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "thanks for attending to this laundry list :+1: \r\n\r\n",
      "created_at": "2024-07-31T14:54:18Z",
      "updated_at": "2024-07-31T14:54:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1698661559",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1698661559"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 303,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1699598317",
      "pull_request_review_id": 2211902032,
      "id": 1699598317,
      "node_id": "PRRC_kwDOABII585lTc_t",
      "diff_hunk": "@@ -2932,6 +2974,117 @@ void CConnman::OpenNetworkConnection(const CAddress& addrConnect, bool fCountFai\n     }\n }\n \n+std::optional<Proxy> CConnman::PrivateBroadcast::ProxyForIPv4or6() const\n+{\n+    if (!m_outbound_tor_ok_at_least_once.load()) {\n+        return std::nullopt;\n+    }\n+    Proxy tor_proxy;\n+    Assume(GetProxy(NET_ONION, tor_proxy));\n+    return tor_proxy;\n+}\n+\n+std::optional<Network>\n+CConnman::PrivateBroadcast::ShouldOpen(bool prev_was_private_broadcast, size_t num_opened) const\n+{\n+    if (prev_was_private_broadcast) {\n+        // Yield to other connection types.\n+        return std::nullopt;\n+    }",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 157,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "ba75010289f1d9bd3d3a6c635ad18b07cf914041",
      "in_reply_to_id": 1655358621,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In the [latest push](https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2260523021) I moved this logic to the caller.",
      "created_at": "2024-08-01T07:47:13Z",
      "updated_at": "2024-08-01T07:47:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1699598317",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1699598317"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 2990,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 3002,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700042799",
      "pull_request_review_id": 2212563874,
      "id": 1700042799,
      "node_id": "PRRC_kwDOABII585lVJgv",
      "diff_hunk": "@@ -643,6 +643,18 @@ void SetupServerArgs(ArgsManager& argsman)\n                    OptionsCategory::NODE_RELAY);\n     argsman.AddArg(\"-minrelaytxfee=<amt>\", strprintf(\"Fees (in %s/kvB) smaller than this are considered zero fee for relaying, mining and transaction creation (default: %s)\",\n         CURRENCY_UNIT, FormatMoney(DEFAULT_MIN_RELAY_TX_FEE)), ArgsManager::ALLOW_ANY, OptionsCategory::NODE_RELAY);\n+    argsman.AddArg(\"-privatebroadcast\",\n+                   strprintf(\n+                       \"Broadcast transactions submitted via sendrawtransaction RPC using short lived \"\n+                       \"connections to Tor or I2P peers without putting them in the mempool first. \"",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 16,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": null,
      "user": {
        "login": "MarnixCroes",
        "id": 93143998,
        "node_id": "U_kgDOBY1Dvg",
        "avatar_url": "https://avatars.githubusercontent.com/u/93143998?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarnixCroes",
        "html_url": "https://github.com/MarnixCroes",
        "followers_url": "https://api.github.com/users/MarnixCroes/followers",
        "following_url": "https://api.github.com/users/MarnixCroes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarnixCroes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarnixCroes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarnixCroes/subscriptions",
        "organizations_url": "https://api.github.com/users/MarnixCroes/orgs",
        "repos_url": "https://api.github.com/users/MarnixCroes/repos",
        "events_url": "https://api.github.com/users/MarnixCroes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarnixCroes/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`to Tor or I2P peers`,\r\nthis should be updated? or maybe rewrite to simplify, something like: _broadcast via short-lived Tor or I2P connection_\r\nAs it can also broadcast to ipv4 and ipv6 peers now (https://github.com/bitcoin/bitcoin/pull/29415/files#r1576619537)",
      "created_at": "2024-08-01T12:18:42Z",
      "updated_at": "2024-08-01T13:52:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1700042799",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700042799"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 649,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700052316",
      "pull_request_review_id": 2212563874,
      "id": 1700052316,
      "node_id": "PRRC_kwDOABII585lVL1c",
      "diff_hunk": "@@ -2496,6 +2517,11 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         LogPrintf(\"Fixed seeds are disabled\\n\");\n     }\n \n+    // Private broadcast connections are opened with priority over others, but only half\n+    // of the time to avoid depriving other connection types if private broadcast is\n+    // needed but opening such connections is unsuccessful for some reason.\n+    std::optional<Network> open_private_broadcast_to;",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 61,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": null,
      "user": {
        "login": "MarnixCroes",
        "id": 93143998,
        "node_id": "U_kgDOBY1Dvg",
        "avatar_url": "https://avatars.githubusercontent.com/u/93143998?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarnixCroes",
        "html_url": "https://github.com/MarnixCroes",
        "followers_url": "https://api.github.com/users/MarnixCroes/followers",
        "following_url": "https://api.github.com/users/MarnixCroes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarnixCroes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarnixCroes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarnixCroes/subscriptions",
        "organizations_url": "https://api.github.com/users/MarnixCroes/orgs",
        "repos_url": "https://api.github.com/users/MarnixCroes/repos",
        "events_url": "https://api.github.com/users/MarnixCroes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarnixCroes/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "on debian12, during compiling it shows this warning\r\n```\r\nnet.cpp: In member function â€˜void CConnman::ThreadOpenConnections(std::vector<std::__cxx11::basic_string<char> >)â€™:\r\nnet.cpp:2523:28: note: â€˜*(unsigned int*)((char*)&open_private_broadcast_to + offsetof(std::optional<Network>,std::optional<Network>::<unnamed>.std::_Optional_base<Network, true, true>::<unnamed>))â€™ was declared here\r\n 2523 |     std::optional<Network> open_private_broadcast_to;\r\n      |                            ^~~~~~~~~~~~~~~~~~~~~~~~~\r\n```\r\n(there are also other unrelated warnings, https://github.com/bitcoin/bitcoin/issues/29359)",
      "created_at": "2024-08-01T12:26:28Z",
      "updated_at": "2024-08-01T13:52:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1700052316",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700052316"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2586,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700086637",
      "pull_request_review_id": 2212563874,
      "id": 1700086637,
      "node_id": "PRRC_kwDOABII585lVUNt",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": null,
      "user": {
        "login": "MarnixCroes",
        "id": 93143998,
        "node_id": "U_kgDOBY1Dvg",
        "avatar_url": "https://avatars.githubusercontent.com/u/93143998?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarnixCroes",
        "html_url": "https://github.com/MarnixCroes",
        "followers_url": "https://api.github.com/users/MarnixCroes/followers",
        "following_url": "https://api.github.com/users/MarnixCroes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarnixCroes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarnixCroes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarnixCroes/subscriptions",
        "organizations_url": "https://api.github.com/users/MarnixCroes/orgs",
        "repos_url": "https://api.github.com/users/MarnixCroes/repos",
        "events_url": "https://api.github.com/users/MarnixCroes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarnixCroes/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "question: when running with -connect and privatebroadcast=1, bitcoind will immediately shutdown.\r\nshouldn't the node just run, but fail to broadcast when using the rpc?\r\nadditionally, bitcoin-qt fails to run too which doesn't use the private broadcast (when using GUI).",
      "created_at": "2024-08-01T12:51:35Z",
      "updated_at": "2024-08-01T13:52:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1700086637",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700086637"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700564090",
      "pull_request_review_id": 2213455212,
      "id": 1700564090,
      "node_id": "PRRC_kwDOABII585lXIx6",
      "diff_hunk": "@@ -643,6 +643,18 @@ void SetupServerArgs(ArgsManager& argsman)\n                    OptionsCategory::NODE_RELAY);\n     argsman.AddArg(\"-minrelaytxfee=<amt>\", strprintf(\"Fees (in %s/kvB) smaller than this are considered zero fee for relaying, mining and transaction creation (default: %s)\",\n         CURRENCY_UNIT, FormatMoney(DEFAULT_MIN_RELAY_TX_FEE)), ArgsManager::ALLOW_ANY, OptionsCategory::NODE_RELAY);\n+    argsman.AddArg(\"-privatebroadcast\",\n+                   strprintf(\n+                       \"Broadcast transactions submitted via sendrawtransaction RPC using short lived \"\n+                       \"connections to Tor or I2P peers without putting them in the mempool first. \"",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 16,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700042799,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, it needs to be updated, thanks for spotting this! How about this:\r\n\r\n```diff\r\n +                       \"Broadcast transactions submitted via sendrawtransaction RPC using short lived \"\r\n-+                       \"connections to Tor or I2P peers without putting them in the mempool first. \"\r\n++                       \"connections through the Tor or I2P networks without putting them in the mempool first. \"\r\n```",
      "created_at": "2024-08-01T17:37:04Z",
      "updated_at": "2024-08-01T17:37:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1700564090",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700564090"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 649,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700566275",
      "pull_request_review_id": 2213458821,
      "id": 1700566275,
      "node_id": "PRRC_kwDOABII585lXJUD",
      "diff_hunk": "@@ -2496,6 +2517,11 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         LogPrintf(\"Fixed seeds are disabled\\n\");\n     }\n \n+    // Private broadcast connections are opened with priority over others, but only half\n+    // of the time to avoid depriving other connection types if private broadcast is\n+    // needed but opening such connections is unsuccessful for some reason.\n+    std::optional<Network> open_private_broadcast_to;",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 61,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700052316,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This does not look like the whole warning? I only see `in member function ... : note: '...' was declared here`.",
      "created_at": "2024-08-01T17:39:03Z",
      "updated_at": "2024-08-01T17:39:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1700566275",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700566275"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2586,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700571980",
      "pull_request_review_id": 2213469059,
      "id": 1700571980,
      "node_id": "PRRC_kwDOABII585lXKtM",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Emitting errors from the RPC is also an option, but I prefer to keep the current way because it clearly shows something is misconfigured and starting up knowing that the RPC will never work and always give errors seems like a bad user experience. I would prefer that the user stops and is forced to fix the misconfiguration of the node. `bitcoin-qt` also has a RPC console.",
      "created_at": "2024-08-01T17:44:15Z",
      "updated_at": "2024-08-01T17:44:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1700571980",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700571980"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701501465",
      "pull_request_review_id": 2215012587,
      "id": 1701501465,
      "node_id": "PRRC_kwDOABII585latoZ",
      "diff_hunk": "@@ -2496,6 +2517,11 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         LogPrintf(\"Fixed seeds are disabled\\n\");\n     }\n \n+    // Private broadcast connections are opened with priority over others, but only half\n+    // of the time to avoid depriving other connection types if private broadcast is\n+    // needed but opening such connections is unsuccessful for some reason.\n+    std::optional<Network> open_private_broadcast_to;",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 61,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700052316,
      "user": {
        "login": "MarnixCroes",
        "id": 93143998,
        "node_id": "U_kgDOBY1Dvg",
        "avatar_url": "https://avatars.githubusercontent.com/u/93143998?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarnixCroes",
        "html_url": "https://github.com/MarnixCroes",
        "followers_url": "https://api.github.com/users/MarnixCroes/followers",
        "following_url": "https://api.github.com/users/MarnixCroes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarnixCroes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarnixCroes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarnixCroes/subscriptions",
        "organizations_url": "https://api.github.com/users/MarnixCroes/orgs",
        "repos_url": "https://api.github.com/users/MarnixCroes/repos",
        "events_url": "https://api.github.com/users/MarnixCroes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarnixCroes/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "oh sry.\r\nthis is the full warning:\r\n```\r\nIn file included from ./bip324.h:10,\r\n                 from ./net.h:9,\r\n                 from net.cpp:8:\r\nIn constructor â€˜constexpr std::_Optional_payload_base<_Tp>::_Storage<_Up, <anonymous> >::_Storage(std::in_place_t, _Args&& ...) [with _Args = {Network&}; _Up = Network; bool <anonymous> = true; _Tp = Network]â€™,\r\n    inlined from â€˜constexpr std::_Optional_payload_base<_Tp>::_Optional_payload_base(std::in_place_t, _Args&& ...) [with _Args = {Network&}; _Tp = Network]â€™ at /usr/include/c++/12/optional:126:4,\r\n    inlined from â€˜constexpr std::_Optional_payload<Network, true, true, true>::_Optional_payload(std::in_place_t, _Args&& ...) [with _Args = {Network&}][inherited from std::_Optional_payload_base<Network>]â€™ at /usr/include/c++/12/optional:339:42,\r\n    inlined from â€˜constexpr std::_Optional_base<_Tp, true, true>::_Optional_base(std::in_place_t, _Args&& ...) [with _Args = {Network&}; typename std::enable_if<is_constructible_v<_Tp, _Args ...>, bool>::type <anonymous> = false; _Tp = Network]â€™ at /usr/include/c++/12/optional:650:4,\r\n    inlined from â€˜constexpr std::optional<_Tp>::optional(_Up&&) [with _Up = Network&; typename std::enable_if<__and_v<std::__not_<std::is_same<std::optional<_Tp>, typename std::remove_cv<typename std::remove_reference<_Iter>::type>::type> >, std::__not_<std::is_same<std::in_place_t, typename std::remove_cv<typename std::remove_reference<_Iter>::type>::type> >, std::is_constructible<_Tp, _Up>, std::is_convertible<_Iter, _Iterator> >, bool>::type <anonymous> = true; _Tp = Network]â€™ at /usr/include/c++/12/optional:749:47,\r\n    inlined from â€˜void CConnman::ThreadOpenConnections(std::vector<std::__cxx11::basic_string<char> >)â€™ at net.cpp:2741:63:\r\n/usr/include/c++/12/optional:214:15: warning: â€˜*(unsigned int*)((char*)&open_private_broadcast_to + offsetof(std::optional<Network>,std::optional<Network>::<unnamed>.std::_Optional_base<Network, true, true>::<unnamed>))â€™ may be used uninitialized [-Wmaybe-uninitialized]\r\n  214 |             : _M_value(std::forward<_Args>(__args)...)\r\n      |               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nnet.cpp: In member function â€˜void CConnman::ThreadOpenConnections(std::vector<std::__cxx11::basic_string<char> >)â€™:\r\nnet.cpp:2523:28: note: â€˜*(unsigned int*)((char*)&open_private_broadcast_to + offsetof(std::optional<Network>,std::optional<Network>::<unnamed>.std::_Optional_base<Network, true, true>::<unnamed>))â€™ was declared here\r\n 2523 |     std::optional<Network> open_private_broadcast_to;\r\n      |                            ^~~~~~~~~~~~~~~~~~~~~~~~~\r\n```",
      "created_at": "2024-08-02T08:33:24Z",
      "updated_at": "2024-08-02T08:33:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1701501465",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701501465"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2586,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701501758",
      "pull_request_review_id": 2215013049,
      "id": 1701501758,
      "node_id": "PRRC_kwDOABII585lats-",
      "diff_hunk": "@@ -2496,6 +2517,11 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         LogPrintf(\"Fixed seeds are disabled\\n\");\n     }\n \n+    // Private broadcast connections are opened with priority over others, but only half\n+    // of the time to avoid depriving other connection types if private broadcast is\n+    // needed but opening such connections is unsuccessful for some reason.\n+    std::optional<Network> open_private_broadcast_to;",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 61,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700052316,
      "user": {
        "login": "MarnixCroes",
        "id": 93143998,
        "node_id": "U_kgDOBY1Dvg",
        "avatar_url": "https://avatars.githubusercontent.com/u/93143998?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarnixCroes",
        "html_url": "https://github.com/MarnixCroes",
        "followers_url": "https://api.github.com/users/MarnixCroes/followers",
        "following_url": "https://api.github.com/users/MarnixCroes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarnixCroes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarnixCroes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarnixCroes/subscriptions",
        "organizations_url": "https://api.github.com/users/MarnixCroes/orgs",
        "repos_url": "https://api.github.com/users/MarnixCroes/repos",
        "events_url": "https://api.github.com/users/MarnixCroes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarnixCroes/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "maybe it is ok as it is, I'm just mentioning it",
      "created_at": "2024-08-02T08:33:40Z",
      "updated_at": "2024-08-02T08:33:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1701501758",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701501758"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2586,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701512954",
      "pull_request_review_id": 2215031320,
      "id": 1701512954,
      "node_id": "PRRC_kwDOABII585lawb6",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "MarnixCroes",
        "id": 93143998,
        "node_id": "U_kgDOBY1Dvg",
        "avatar_url": "https://avatars.githubusercontent.com/u/93143998?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarnixCroes",
        "html_url": "https://github.com/MarnixCroes",
        "followers_url": "https://api.github.com/users/MarnixCroes/followers",
        "following_url": "https://api.github.com/users/MarnixCroes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarnixCroes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarnixCroes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarnixCroes/subscriptions",
        "organizations_url": "https://api.github.com/users/MarnixCroes/orgs",
        "repos_url": "https://api.github.com/users/MarnixCroes/repos",
        "events_url": "https://api.github.com/users/MarnixCroes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarnixCroes/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "ok thanks for the answer.\r\nI also thought about that it might make sense to have an optional argument for _sendrawtransaction_ rpc, whether to use privatebroadcast or not (for example in the case when it cannot be used, but user still wants to broadcast without restarting bitcoind)\r\nSame answer also applies to that I guess",
      "created_at": "2024-08-02T08:42:26Z",
      "updated_at": "2024-08-02T08:42:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1701512954",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701512954"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701553624",
      "pull_request_review_id": 2215097083,
      "id": 1701553624,
      "node_id": "PRRC_kwDOABII585la6XY",
      "diff_hunk": "@@ -2496,6 +2517,11 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         LogPrintf(\"Fixed seeds are disabled\\n\");\n     }\n \n+    // Private broadcast connections are opened with priority over others, but only half\n+    // of the time to avoid depriving other connection types if private broadcast is\n+    // needed but opening such connections is unsuccessful for some reason.\n+    std::optional<Network> open_private_broadcast_to;",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 61,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700052316,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Alright, it is upset that `std::optional<Network> open_private_broadcast_to` may be used uninitialized. But `std::optional` has a well defined default constructor - https://en.cppreference.com/w/cpp/utility/optional/optional, so this warning seems bogus. I will leave it as is. Which compiler it is? `c++ --version`",
      "created_at": "2024-08-02T09:08:17Z",
      "updated_at": "2024-08-02T09:08:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1701553624",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701553624"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2586,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701558489",
      "pull_request_review_id": 2215105944,
      "id": 1701558489,
      "node_id": "PRRC_kwDOABII585la7jZ",
      "diff_hunk": "@@ -2496,6 +2517,11 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         LogPrintf(\"Fixed seeds are disabled\\n\");\n     }\n \n+    // Private broadcast connections are opened with priority over others, but only half\n+    // of the time to avoid depriving other connection types if private broadcast is\n+    // needed but opening such connections is unsuccessful for some reason.\n+    std::optional<Network> open_private_broadcast_to;",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 61,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700052316,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Looks like a duplicate of https://github.com/bitcoin/bitcoin/issues/29359 (known gcc bug)",
      "created_at": "2024-08-02T09:12:09Z",
      "updated_at": "2024-08-02T09:12:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1701558489",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701558489"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2586,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701560062",
      "pull_request_review_id": 2215108322,
      "id": 1701560062,
      "node_id": "PRRC_kwDOABII585la77-",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yeah. Also, having an extra argument to the RPC is an alternative of the `-privatebroadcast` config option that would be maybe viable if the plan was to stop with the RPC, but having in mind that the wallet will eventually also use private broadcast, I would like to avoid having to configure each module separately for private broadcast, so a single global config option seems to fit best.",
      "created_at": "2024-08-02T09:12:50Z",
      "updated_at": "2024-08-02T09:12:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1701560062",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701560062"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701562902",
      "pull_request_review_id": 2215112604,
      "id": 1701562902,
      "node_id": "PRRC_kwDOABII585la8oW",
      "diff_hunk": "@@ -643,6 +643,18 @@ void SetupServerArgs(ArgsManager& argsman)\n                    OptionsCategory::NODE_RELAY);\n     argsman.AddArg(\"-minrelaytxfee=<amt>\", strprintf(\"Fees (in %s/kvB) smaller than this are considered zero fee for relaying, mining and transaction creation (default: %s)\",\n         CURRENCY_UNIT, FormatMoney(DEFAULT_MIN_RELAY_TX_FEE)), ArgsManager::ALLOW_ANY, OptionsCategory::NODE_RELAY);\n+    argsman.AddArg(\"-privatebroadcast\",\n+                   strprintf(\n+                       \"Broadcast transactions submitted via sendrawtransaction RPC using short lived \"\n+                       \"connections to Tor or I2P peers without putting them in the mempool first. \"",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 16,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700042799,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2024-08-02T09:14:16Z",
      "updated_at": "2024-08-02T09:14:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1701562902",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701562902"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 649,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701615628",
      "pull_request_review_id": 2215200101,
      "id": 1701615628,
      "node_id": "PRRC_kwDOABII585lbJgM",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "MarnixCroes",
        "id": 93143998,
        "node_id": "U_kgDOBY1Dvg",
        "avatar_url": "https://avatars.githubusercontent.com/u/93143998?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarnixCroes",
        "html_url": "https://github.com/MarnixCroes",
        "followers_url": "https://api.github.com/users/MarnixCroes/followers",
        "following_url": "https://api.github.com/users/MarnixCroes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarnixCroes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarnixCroes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarnixCroes/subscriptions",
        "organizations_url": "https://api.github.com/users/MarnixCroes/orgs",
        "repos_url": "https://api.github.com/users/MarnixCroes/repos",
        "events_url": "https://api.github.com/users/MarnixCroes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarnixCroes/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "makes sense, thanks",
      "created_at": "2024-08-02T09:49:45Z",
      "updated_at": "2024-08-02T09:49:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1701615628",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1701615628"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1715690103",
      "pull_request_review_id": 2236191698,
      "id": 1715690103,
      "node_id": "PRRC_kwDOABII585mQ1p3",
      "diff_hunk": "@@ -15,10 +16,79 @@ bool PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!\n     return inserted;\n }\n \n+std::optional<CTransactionRef> PrivateBroadcast::GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    if (m_by_priority.empty()) {\n+        return std::nullopt;\n+    }\n+    const Txid& txid = m_by_priority.begin()->second;\n+    auto it = m_by_txid.find(txid);\n+    if (Assume(it != m_by_txid.end())) {\n+        return it->second.tx;\n+    }\n+    m_by_priority.erase(m_by_priority.begin());\n+    return std::nullopt;\n+}\n+\n+void PrivateBroadcast::PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    m_by_nodeid.emplace(nodeid, txid);\n+}\n+\n+bool PrivateBroadcast::FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)",
      "path": "src/private_broadcast.cpp",
      "position": 75,
      "original_position": 33,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "4a955955ec587120fb121e5068e3bc1f80406ac5",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In 4a955955ec587120fb121e5068e3bc1f80406ac5 \"net_processing: handle ConnectionType::PRIVATE_BROADCAST connections\": It seems `FinishBroadcast` returns a `bool`, but this value is never used.\r\n",
      "created_at": "2024-08-13T17:42:30Z",
      "updated_at": "2024-08-13T17:42:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1715690103",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1715690103"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 75,
      "original_line": 75,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1716512192",
      "pull_request_review_id": 2237488280,
      "id": 1716512192,
      "node_id": "PRRC_kwDOABII585mT-XA",
      "diff_hunk": "@@ -15,10 +16,79 @@ bool PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!\n     return inserted;\n }\n \n+std::optional<CTransactionRef> PrivateBroadcast::GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    if (m_by_priority.empty()) {\n+        return std::nullopt;\n+    }\n+    const Txid& txid = m_by_priority.begin()->second;\n+    auto it = m_by_txid.find(txid);\n+    if (Assume(it != m_by_txid.end())) {\n+        return it->second.tx;\n+    }\n+    m_by_priority.erase(m_by_priority.begin());\n+    return std::nullopt;\n+}\n+\n+void PrivateBroadcast::PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    m_by_nodeid.emplace(nodeid, txid);\n+}\n+\n+bool PrivateBroadcast::FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)",
      "path": "src/private_broadcast.cpp",
      "position": 75,
      "original_position": 33,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "4a955955ec587120fb121e5068e3bc1f80406ac5",
      "in_reply_to_id": 1715690103,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The return value is used here:\r\n\r\n```cpp\r\n    // This is done when we get a PONG from the peer. Repeat here too in case we never receive a PONG.\r\n    if (node.IsPrivateBroadcastConn() &&\r\n        m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false)) {\r\n...\r\n        log a message that we never got a PONG response\r\n```\r\n\r\nThe point is to avoid printing this log message in the happy path where we do get a PONG response.",
      "created_at": "2024-08-14T08:26:43Z",
      "updated_at": "2024-08-14T08:26:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1716512192",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1716512192"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 75,
      "original_line": 75,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1716596528",
      "pull_request_review_id": 2237623788,
      "id": 1716596528,
      "node_id": "PRRC_kwDOABII585mUS8w",
      "diff_hunk": "@@ -15,10 +16,79 @@ bool PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!\n     return inserted;\n }\n \n+std::optional<CTransactionRef> PrivateBroadcast::GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    if (m_by_priority.empty()) {\n+        return std::nullopt;\n+    }\n+    const Txid& txid = m_by_priority.begin()->second;\n+    auto it = m_by_txid.find(txid);\n+    if (Assume(it != m_by_txid.end())) {\n+        return it->second.tx;\n+    }\n+    m_by_priority.erase(m_by_priority.begin());\n+    return std::nullopt;\n+}\n+\n+void PrivateBroadcast::PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    m_by_nodeid.emplace(nodeid, txid);\n+}\n+\n+bool PrivateBroadcast::FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)",
      "path": "src/private_broadcast.cpp",
      "position": 75,
      "original_position": 33,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "4a955955ec587120fb121e5068e3bc1f80406ac5",
      "in_reply_to_id": 1715690103,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Oh sorry, missed that. It's fine.",
      "created_at": "2024-08-14T09:21:43Z",
      "updated_at": "2024-08-14T09:21:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1716596528",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1716596528"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 75,
      "original_line": 75,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1781381298",
      "pull_request_review_id": 2337970767,
      "id": 1781381298,
      "node_id": "PRRC_kwDOABII585qLbiy",
      "diff_hunk": "@@ -640,6 +640,18 @@ void SetupServerArgs(ArgsManager& argsman, bool can_listen_ipc)\n                    OptionsCategory::NODE_RELAY);\n     argsman.AddArg(\"-minrelaytxfee=<amt>\", strprintf(\"Fees (in %s/kvB) smaller than this are considered zero fee for relaying, mining and transaction creation (default: %s)\",\n         CURRENCY_UNIT, FormatMoney(DEFAULT_MIN_RELAY_TX_FEE)), ArgsManager::ALLOW_ANY, OptionsCategory::NODE_RELAY);\n+    argsman.AddArg(\"-privatebroadcast\",\n+                   strprintf(\n+                       \"Broadcast transactions submitted via sendrawtransaction RPC using short lived \"\n+                       \"connections through the Tor or I2P networks without putting them in the mempool first. \"\n+                       \"There are two aspects of this - delinking transaction-origin/Bitcoin-owner from \"\n+                       \"IP-address/geolocation and delinking onchain-unrelated transactions from their \"",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 9,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "bc1b5670ecec737deafe7e9426c0c672fd9080ce",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I found this help text hard to parse with all the \"/\" (had to read it multiple times to understand it). I'm not sure if the rpc help is the best place to give motivation for why features exist (instead of just describing them), but maybe this could be a bit more succinct?",
      "created_at": "2024-09-30T15:51:33Z",
      "updated_at": "2024-09-30T23:09:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1781381298",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1781381298"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 648,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1781677003",
      "pull_request_review_id": 2337970767,
      "id": 1781677003,
      "node_id": "PRRC_kwDOABII585qMjvL",
      "diff_hunk": "@@ -2571,7 +2590,18 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect, Spa\n             }\n         }\n \n-        CSemaphoreGrant grant(*semOutbound);\n+        CSemaphoreGrant grant{*semOutbound, /*fTry=*/true};\n+        if (open_private_broadcast_to.has_value() && grant) {\n+            // Previous connection was private broadcast, thus yield to other connection types\n+            // if we are ready to do so (the outbound semaphore gave green light).\n+            open_private_broadcast_to.reset();\n+        } else if (!(open_private_broadcast_to = m_private_broadcast.ShouldOpen(num_private_broadcast_opened))) {",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 68,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e24c2706f755853fb9f4abe681342620f3f721f2",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I would find the ThreadOpenConnection logic (which is already convoluted in master) easier to understand if the private broadcast related logic would be separated more clearly, e.g. this whole thing could be behind some bool `private_broadcast_enabled` so `m_private_broadcast.ShouldOpen` wouldn't be called in normal mode and one wouldn't need to scroll down and verify that this function does nothing then. Of course there is no functional difference, so it may be a matter of taste.",
      "created_at": "2024-09-30T20:07:34Z",
      "updated_at": "2024-09-30T23:09:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1781677003",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1781677003"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2608,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1781701897",
      "pull_request_review_id": 2337970767,
      "id": 1781701897,
      "node_id": "PRRC_kwDOABII585qMp0J",
      "diff_hunk": "@@ -44,6 +45,20 @@ struct BlockCreateOptions {\n      */\n     size_t coinbase_output_max_additional_sigops{400};\n };\n+\n+/**\n+ * Methods to broadcast a local transaction.\n+ * Used to influence `BroadcastTransaction()` and its callers.\n+ */\n+enum TxBroadcastMethod : uint8_t {\n+    /// Add the transaction to the mempool and broadcast to all currently connected peers.",
      "path": "src/node/types.h",
      "position": 1,
      "original_position": 18,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "f945fd5eb2c8830d63f584114a890224a3079e3a",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: all peers for which tx relay is enabled (so not blocks-only, feelers etc.).",
      "created_at": "2024-09-30T20:32:37Z",
      "updated_at": "2024-09-30T23:09:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1781701897",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1781701897"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 54,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1781704314",
      "pull_request_review_id": 2337970767,
      "id": 1781704314,
      "node_id": "PRRC_kwDOABII585qMqZ6",
      "diff_hunk": "@@ -2031,7 +2033,19 @@ bool CWallet::SubmitTxMemoryPoolAndRelay(CWalletTx& wtx, std::string& err_string\n     if (GetTxDepthInMainChain(wtx) != 0) return false;\n \n     // Submit transaction to mempool for relay\n-    WalletLogPrintf(\"Submitting wtx %s to mempool for relay\\n\", wtx.GetHash().ToString());\n+    const char* what{\"\"};\n+    switch (broadcast_method) {\n+    case node::ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL:\n+        what = \"to mempool and for broadcast to all peers\";",
      "path": "src/wallet/wallet.cpp",
      "position": 1,
      "original_position": 19,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "f945fd5eb2c8830d63f584114a890224a3079e3a",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: same here, I'd remove \"all\"",
      "created_at": "2024-09-30T20:34:53Z",
      "updated_at": "2024-09-30T23:09:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1781704314",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1781704314"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2039,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1781795191",
      "pull_request_review_id": 2337970767,
      "id": 1781795191,
      "node_id": "PRRC_kwDOABII585qNAl3",
      "diff_hunk": "@@ -3867,6 +3854,47 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             if (fRelay) pfrom.m_relays_txs = true;\n         }\n \n+        if (!pfrom.IsInboundConn()) {\n+            // For non-inbound connections, we update the addrman to record\n+            // connection success so that addrman will have an up-to-date\n+            // notion of which peers are online and available.\n+            //\n+            // While we strive to not leak information about block-relay-only\n+            // connections via the addrman, not moving an address to the tried\n+            // table is also potentially detrimental because new-table entries\n+            // are subject to eviction in the event of addrman collisions.  We\n+            // mitigate the information-leak by never calling\n+            // AddrMan::Connected() on block-relay-only peers; see\n+            // FinalizeNode().\n+            //\n+            // This moves an address from New to Tried table in Addrman,\n+            // resolves tried-table collisions, etc.\n+            m_addrman.Good(pfrom.addr);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 39,
      "commit_id": "7547f915bc6cb0425b46234df486e0de34cad3b3",
      "original_commit_id": "b628d96f21d9c7e6e4a9e1c944fa7a9668d1e1af",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I've been thinking about leaking information about private broadcast via addrman:\r\n1.) Here, we call `Good()`, possibly moving the peer from new to tried. Since tried table is smaller and sparsely filled especially for newer nodes, and addrs are picked with 50% probability from new/tried, this usually means that we are more likely to connect to them in the future - maybe via clearnet, maybe via future private connections.\r\n2.) On disconnection, we call `Connected()`, changing the `nTime` of an address (that could be included in getaddr answers).\r\n\r\nNot super easy to use either of these methods as an attack, but I still think it would be better not to do change addrman based on what happens in private connections.\r\n\r\nEven if we disabled that, an existing addrman that has only a few Tor peers in `tried` could make it likely that subsequent private txns would be made to the same node (which could help that peer connect these two transactions). That is a separate problem I don't see a straightforward solution for, but it would be mitigated by 1.) gathering more tried peers over time 2.) having many peers in the network make use of private broadcast.",
      "created_at": "2024-09-30T21:50:30Z",
      "updated_at": "2024-09-30T23:09:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1781795191",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1781795191"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3730,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1781868981",
      "pull_request_review_id": 2337970767,
      "id": 1781868981,
      "node_id": "PRRC_kwDOABII585qNSm1",
      "diff_hunk": "@@ -0,0 +1,58 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_PRIVATE_BROADCAST_H\n+#define BITCOIN_PRIVATE_BROADCAST_H\n+\n+#include <primitives/transaction.h>\n+#include <sync.h>\n+#include <threadsafety.h>\n+#include <util/hasher.h>\n+#include <util/time.h>\n+\n+#include <map>\n+#include <unordered_map>\n+\n+/**\n+ * Store a list of transactions to be broadcast privately. Supports the following operations:\n+ * - Add a new transaction\n+ */\n+class PrivateBroadcast\n+{\n+public:\n+    /**\n+     * Add a transaction to the storage.\n+     * @param[in] tx The transaction to add.\n+     * @retval true The transaction was added.\n+     * @retval false The transaction was already present.\n+     */\n+    bool Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+private:\n+    struct Priority {\n+        size_t num_broadcasted{0};\n+        NodeClock::time_point last_broadcasted{};\n+\n+        bool operator<(const Priority& other) const;\n+    };\n+\n+    struct TxWithPriority {\n+        CTransactionRef tx;\n+        Priority priority;\n+    };\n+\n+    using ByTxid = std::unordered_map<Txid, TxWithPriority, SaltedTxidHasher>;",
      "path": "src/private_broadcast.h",
      "position": 91,
      "original_position": 45,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "80246442b80ae2abd2ca6921f4eeb348f4f819e0",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Why store by `TxId` instead of `WtxId`? Would this add some attack surface, e.g. an attacker with many connections to peers receiving a private tx, and then sending each of their peers a modified version of the same tx with invalid witness data (but same TxId), in the hope of connecting to the originating node and clearing any further attempts to broadcast the transaction (note that `m_tx_for_private_broadcast.Remove()` also happens for invalid txs becaust it's done before validation)",
      "created_at": "2024-09-30T22:54:59Z",
      "updated_at": "2024-10-01T01:04:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1781868981",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1781868981"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 91,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785630298",
      "pull_request_review_id": 2344649420,
      "id": 1785630298,
      "node_id": "PRRC_kwDOABII585qbo5a",
      "diff_hunk": "@@ -2571,7 +2590,18 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect, Spa\n             }\n         }\n \n-        CSemaphoreGrant grant(*semOutbound);\n+        CSemaphoreGrant grant{*semOutbound, /*fTry=*/true};\n+        if (open_private_broadcast_to.has_value() && grant) {\n+            // Previous connection was private broadcast, thus yield to other connection types\n+            // if we are ready to do so (the outbound semaphore gave green light).\n+            open_private_broadcast_to.reset();\n+        } else if (!(open_private_broadcast_to = m_private_broadcast.ShouldOpen(num_private_broadcast_opened))) {",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 68,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e24c2706f755853fb9f4abe681342620f3f721f2",
      "in_reply_to_id": 1781677003,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This code in `CConnman::ThreadOpenConnections()` is not checking whether private broadcast is enabled because it is just a servant, its logic is: \"if there is a request to open private broadcast connections, then I will open them\". The higher level code is making the decision (currently in RPC only, but eventually in the wallet as well) - \"if private broadcast is enabled, then open such connections because I am now broadcasting a transaction (and don't put it in the mempool)\". This is why there is no check in `net.cpp` whether `-privatebroadcast` is enabled.\r\n\r\nI also find this snippet non-trivial to understand:\r\n\r\n```cpp\r\nCSemaphoreGrant grant{*semOutbound, /*fTry=*/true};\r\nif (open_private_broadcast_to.has_value() && grant) {\r\n    // Previous connection was private broadcast, thus yield to other connection types\r\n    // if we are ready to do so (the outbound semaphore gave green light).\r\n    open_private_broadcast_to.reset();\r\n} else if (!(open_private_broadcast_to = m_private_broadcast.ShouldOpen(num_private_broadcast_opened))) {\r\n    // No need for private broadcast connections, go with other ones. Acquire the\r\n    // grant if not already acquired. \r\n    grant.Acquire();\r\n}\r\n// else private broadcast is needed to network *open_private_broadcast_to, try to open one.\r\n```\r\n\r\nLet me summarize why the logic is like that:\r\n* since private broadcast connections are needed now and are short lived, they override all others\r\n* however if there is a lot of demand for private broadcast connections we want to avoid starving other connection types, so we don't open two consecutive private broadcast connections and instead yield to others\r\n* but this yield to others may end up blocking on the grant for a long time because we are not ready to open other connection types whereas private broadcast connections are needed now.\r\n\r\nI am open to suggestions on how to implement that in a simpler way or how to simplify the logic itself (without sacrificing the functionality).",
      "created_at": "2024-10-03T04:56:32Z",
      "updated_at": "2024-10-03T04:56:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1785630298",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785630298"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2608,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785842290",
      "pull_request_review_id": 2344982177,
      "id": 1785842290,
      "node_id": "PRRC_kwDOABII585qccpy",
      "diff_hunk": "@@ -0,0 +1,58 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_PRIVATE_BROADCAST_H\n+#define BITCOIN_PRIVATE_BROADCAST_H\n+\n+#include <primitives/transaction.h>\n+#include <sync.h>\n+#include <threadsafety.h>\n+#include <util/hasher.h>\n+#include <util/time.h>\n+\n+#include <map>\n+#include <unordered_map>\n+\n+/**\n+ * Store a list of transactions to be broadcast privately. Supports the following operations:\n+ * - Add a new transaction\n+ */\n+class PrivateBroadcast\n+{\n+public:\n+    /**\n+     * Add a transaction to the storage.\n+     * @param[in] tx The transaction to add.\n+     * @retval true The transaction was added.\n+     * @retval false The transaction was already present.\n+     */\n+    bool Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+private:\n+    struct Priority {\n+        size_t num_broadcasted{0};\n+        NodeClock::time_point last_broadcasted{};\n+\n+        bool operator<(const Priority& other) const;\n+    };\n+\n+    struct TxWithPriority {\n+        CTransactionRef tx;\n+        Priority priority;\n+    };\n+\n+    using ByTxid = std::unordered_map<Txid, TxWithPriority, SaltedTxidHasher>;",
      "path": "src/private_broadcast.h",
      "position": 91,
      "original_position": 45,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "80246442b80ae2abd2ca6921f4eeb348f4f819e0",
      "in_reply_to_id": 1781868981,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Because if stored by wtxid then the same could happen, but the attacker malleates the transaction to a valid witness data, so it has same txid, different wtxid, and is valid. When we receive that transaction we would not recognize it because we look at the wtxid, so we would keep broadcasting the original one, until the code in `PeerManagerImpl::ReattemptPrivateBroadcast()` gives up on it because it is not acceptable in the mempool.\r\n\r\nDo you think we should check both txid and wtxid when we receive a transaction from the network, or try to validate the transaction before removing it via `m_tx_for_private_broadcast.Remove(ptx)`?",
      "created_at": "2024-10-03T08:34:23Z",
      "updated_at": "2024-10-03T08:34:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1785842290",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785842290"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 91,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785884527",
      "pull_request_review_id": 2345048939,
      "id": 1785884527,
      "node_id": "PRRC_kwDOABII585qcm9v",
      "diff_hunk": "@@ -640,6 +640,18 @@ void SetupServerArgs(ArgsManager& argsman, bool can_listen_ipc)\n                    OptionsCategory::NODE_RELAY);\n     argsman.AddArg(\"-minrelaytxfee=<amt>\", strprintf(\"Fees (in %s/kvB) smaller than this are considered zero fee for relaying, mining and transaction creation (default: %s)\",\n         CURRENCY_UNIT, FormatMoney(DEFAULT_MIN_RELAY_TX_FEE)), ArgsManager::ALLOW_ANY, OptionsCategory::NODE_RELAY);\n+    argsman.AddArg(\"-privatebroadcast\",\n+                   strprintf(\n+                       \"Broadcast transactions submitted via sendrawtransaction RPC using short lived \"\n+                       \"connections through the Tor or I2P networks without putting them in the mempool first. \"\n+                       \"There are two aspects of this - delinking transaction-origin/Bitcoin-owner from \"\n+                       \"IP-address/geolocation and delinking onchain-unrelated transactions from their \"",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 9,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "bc1b5670ecec737deafe7e9426c0c672fd9080ce",
      "in_reply_to_id": 1781381298,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> I'm not sure if the rpc help is the best place to give motivation for why features exist\r\n\r\nRight. I dropped some of the text. I will apply further rewording if you suggest some.",
      "created_at": "2024-10-03T09:05:07Z",
      "updated_at": "2024-10-03T09:05:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1785884527",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785884527"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 648,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785885728",
      "pull_request_review_id": 2345050942,
      "id": 1785885728,
      "node_id": "PRRC_kwDOABII585qcnQg",
      "diff_hunk": "@@ -44,6 +45,20 @@ struct BlockCreateOptions {\n      */\n     size_t coinbase_output_max_additional_sigops{400};\n };\n+\n+/**\n+ * Methods to broadcast a local transaction.\n+ * Used to influence `BroadcastTransaction()` and its callers.\n+ */\n+enum TxBroadcastMethod : uint8_t {\n+    /// Add the transaction to the mempool and broadcast to all currently connected peers.",
      "path": "src/node/types.h",
      "position": 1,
      "original_position": 18,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "f945fd5eb2c8830d63f584114a890224a3079e3a",
      "in_reply_to_id": 1781701897,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Changed, thanks!",
      "created_at": "2024-10-03T09:06:06Z",
      "updated_at": "2024-10-03T09:06:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1785885728",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785885728"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 54,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785886009",
      "pull_request_review_id": 2345051432,
      "id": 1785886009,
      "node_id": "PRRC_kwDOABII585qcnU5",
      "diff_hunk": "@@ -2031,7 +2033,19 @@ bool CWallet::SubmitTxMemoryPoolAndRelay(CWalletTx& wtx, std::string& err_string\n     if (GetTxDepthInMainChain(wtx) != 0) return false;\n \n     // Submit transaction to mempool for relay\n-    WalletLogPrintf(\"Submitting wtx %s to mempool for relay\\n\", wtx.GetHash().ToString());\n+    const char* what{\"\"};\n+    switch (broadcast_method) {\n+    case node::ADD_TO_MEMPOOL_AND_BROADCAST_TO_ALL:\n+        what = \"to mempool and for broadcast to all peers\";",
      "path": "src/wallet/wallet.cpp",
      "position": 1,
      "original_position": 19,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "f945fd5eb2c8830d63f584114a890224a3079e3a",
      "in_reply_to_id": 1781704314,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Removed.",
      "created_at": "2024-10-03T09:06:20Z",
      "updated_at": "2024-10-03T09:06:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1785886009",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785886009"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2039,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785892026",
      "pull_request_review_id": 2345061522,
      "id": 1785892026,
      "node_id": "PRRC_kwDOABII585qcoy6",
      "diff_hunk": "@@ -3867,6 +3854,47 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             if (fRelay) pfrom.m_relays_txs = true;\n         }\n \n+        if (!pfrom.IsInboundConn()) {\n+            // For non-inbound connections, we update the addrman to record\n+            // connection success so that addrman will have an up-to-date\n+            // notion of which peers are online and available.\n+            //\n+            // While we strive to not leak information about block-relay-only\n+            // connections via the addrman, not moving an address to the tried\n+            // table is also potentially detrimental because new-table entries\n+            // are subject to eviction in the event of addrman collisions.  We\n+            // mitigate the information-leak by never calling\n+            // AddrMan::Connected() on block-relay-only peers; see\n+            // FinalizeNode().\n+            //\n+            // This moves an address from New to Tried table in Addrman,\n+            // resolves tried-table collisions, etc.\n+            m_addrman.Good(pfrom.addr);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 39,
      "commit_id": "7547f915bc6cb0425b46234df486e0de34cad3b3",
      "original_commit_id": "b628d96f21d9c7e6e4a9e1c944fa7a9668d1e1af",
      "in_reply_to_id": 1781795191,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> it would be better not to do change addrman based on what happens in private connections\r\n\r\nI agree! Changed to avoid the `Good()` and `Connected()` calls for private broadcast.\r\n\r\nOn the second problem - I agree that more tried peers (which happens naturally over time) and more people using private broadcast would help because then the recipient just sees multiple broadcasts and has no way to relate them.",
      "created_at": "2024-10-03T09:11:05Z",
      "updated_at": "2024-10-03T09:11:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1785892026",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1785892026"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3730,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1786435183",
      "pull_request_review_id": 2345955695,
      "id": 1786435183,
      "node_id": "PRRC_kwDOABII585qetZv",
      "diff_hunk": "@@ -0,0 +1,58 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_PRIVATE_BROADCAST_H\n+#define BITCOIN_PRIVATE_BROADCAST_H\n+\n+#include <primitives/transaction.h>\n+#include <sync.h>\n+#include <threadsafety.h>\n+#include <util/hasher.h>\n+#include <util/time.h>\n+\n+#include <map>\n+#include <unordered_map>\n+\n+/**\n+ * Store a list of transactions to be broadcast privately. Supports the following operations:\n+ * - Add a new transaction\n+ */\n+class PrivateBroadcast\n+{\n+public:\n+    /**\n+     * Add a transaction to the storage.\n+     * @param[in] tx The transaction to add.\n+     * @retval true The transaction was added.\n+     * @retval false The transaction was already present.\n+     */\n+    bool Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+private:\n+    struct Priority {\n+        size_t num_broadcasted{0};\n+        NodeClock::time_point last_broadcasted{};\n+\n+        bool operator<(const Priority& other) const;\n+    };\n+\n+    struct TxWithPriority {\n+        CTransactionRef tx;\n+        Priority priority;\n+    };\n+\n+    using ByTxid = std::unordered_map<Txid, TxWithPriority, SaltedTxidHasher>;",
      "path": "src/private_broadcast.h",
      "position": 91,
      "original_position": 45,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "80246442b80ae2abd2ca6921f4eeb348f4f819e0",
      "in_reply_to_id": 1781868981,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'd say it might be a good idea to keep using `TxIDs`, but move the removal until after validation - that should address both scenarios.\r\nWe are going to validate it anyway, so I don't really see any downsides to that.\r\n",
      "created_at": "2024-10-03T15:27:41Z",
      "updated_at": "2024-10-03T15:29:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1786435183",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1786435183"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 91,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1787644002",
      "pull_request_review_id": 2347941870,
      "id": 1787644002,
      "node_id": "PRRC_kwDOABII585qjUhi",
      "diff_hunk": "@@ -0,0 +1,58 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_PRIVATE_BROADCAST_H\n+#define BITCOIN_PRIVATE_BROADCAST_H\n+\n+#include <primitives/transaction.h>\n+#include <sync.h>\n+#include <threadsafety.h>\n+#include <util/hasher.h>\n+#include <util/time.h>\n+\n+#include <map>\n+#include <unordered_map>\n+\n+/**\n+ * Store a list of transactions to be broadcast privately. Supports the following operations:\n+ * - Add a new transaction\n+ */\n+class PrivateBroadcast\n+{\n+public:\n+    /**\n+     * Add a transaction to the storage.\n+     * @param[in] tx The transaction to add.\n+     * @retval true The transaction was added.\n+     * @retval false The transaction was already present.\n+     */\n+    bool Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+private:\n+    struct Priority {\n+        size_t num_broadcasted{0};\n+        NodeClock::time_point last_broadcasted{};\n+\n+        bool operator<(const Priority& other) const;\n+    };\n+\n+    struct TxWithPriority {\n+        CTransactionRef tx;\n+        Priority priority;\n+    };\n+\n+    using ByTxid = std::unordered_map<Txid, TxWithPriority, SaltedTxidHasher>;",
      "path": "src/private_broadcast.h",
      "position": 91,
      "original_position": 45,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "80246442b80ae2abd2ca6921f4eeb348f4f819e0",
      "in_reply_to_id": 1781868981,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Here is the change:\r\n\r\n<details>\r\n<summary>[patch] only remove if accepted in mempool</summary>\r\n\r\n```diff\r\n--- i/src/net_processing.cpp\r\n+++ w/src/net_processing.cpp\r\n@@ -4803,27 +4803,12 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\r\n         const uint256& txid = ptx->GetHash();\r\n         const uint256& wtxid = ptx->GetWitnessHash();\r\n \r\n         const uint256& hash = peer->m_wtxid_relay ? wtxid : txid;\r\n         AddKnownTx(*peer, hash);\r\n \r\n-        if (auto num_broadcasted = m_tx_for_private_broadcast.Remove(ptx)) {\r\n-            LogPrintLevel(BCLog::PRIVATE_BROADCAST,\r\n-                          BCLog::Level::Info,\r\n-                          \"Received our privately broadcast transaction (txid=%s) from the \"\r\n-                          \"network from peer=%d%s; stopping private broadcast attempts\\n\",\r\n-                          txid.ToString(),\r\n-                          pfrom.GetId(),\r\n-                          fLogIPs ? strprintf(\", peeraddr=%s\", pfrom.addr.ToStringAddrPort()) : \"\");\r\n-            if (NUM_PRIVATE_BROADCAST_PER_TX > num_broadcasted.value()) {\r\n-                // Not all of the initial NUM_PRIVATE_BROADCAST_PER_TX connections were needed.\r\n-                // Tell CConnman it does not need to start the remaining ones.\r\n-                m_connman.m_private_broadcast.NumToOpenSub(NUM_PRIVATE_BROADCAST_PER_TX - num_broadcasted.value());\r\n-            }\r\n-        }\r\n-\r\n         LOCK2(cs_main, m_tx_download_mutex);\r\n \r\n         m_txrequest.ReceivedResponse(pfrom.GetId(), txid);\r\n         if (tx.HasWitness()) m_txrequest.ReceivedResponse(pfrom.GetId(), wtxid);\r\n \r\n         // We do the AlreadyHaveTx() check using wtxid, rather than txid - in the\r\n@@ -4878,21 +4863,37 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\r\n             //\r\n             // Note that m_lazy_recent_rejects doesn't just record DoSy or invalid\r\n             // transactions, but any tx not accepted by the mempool, which may be\r\n             // due to node policy (vs. consensus). So we can't blanket penalize a\r\n             // peer simply for relaying a tx that our m_lazy_recent_rejects has caught,\r\n             // regardless of false positives.\r\n+            // XXX what about Remove() also here?\r\n             return;\r\n         }\r\n \r\n         const MempoolAcceptResult result = m_chainman.ProcessTransaction(ptx);\r\n         const TxValidationState& state = result.m_state;\r\n \r\n         if (result.m_result_type == MempoolAcceptResult::ResultType::VALID) {\r\n             ProcessValidTx(pfrom.GetId(), ptx, result.m_replaced_transactions);\r\n             pfrom.m_last_tx_time = GetTime<std::chrono::seconds>();\r\n+\r\n+            if (auto num_broadcasted = m_tx_for_private_broadcast.Remove(ptx)) {\r\n+                LogPrintLevel(BCLog::PRIVATE_BROADCAST,\r\n+                              BCLog::Level::Info,\r\n+                              \"Received our privately broadcast transaction (txid=%s) from the \"\r\n+                              \"network from peer=%d%s; stopping private broadcast attempts\\n\",\r\n+                              txid.ToString(),\r\n+                              pfrom.GetId(),\r\n+                              fLogIPs ? strprintf(\", peeraddr=%s\", pfrom.addr.ToStringAddrPort()) : \"\");\r\n+                if (NUM_PRIVATE_BROADCAST_PER_TX > num_broadcasted.value()) {\r\n+                    // Not all of the initial NUM_PRIVATE_BROADCAST_PER_TX connections were needed.\r\n+                    // Tell CConnman it does not need to start the remaining ones.\r\n+                    m_connman.m_private_broadcast.NumToOpenSub(NUM_PRIVATE_BROADCAST_PER_TX - num_broadcasted.value());\r\n+                }\r\n+            }\r\n         }\r\n         else if (state.GetResult() == TxValidationResult::TX_MISSING_INPUTS)\r\n         {\r\n             bool fRejectedParents = false; // It may be the case that the orphans parents have all been rejected\r\n \r\n             // Deduplicate parent txids, so that we don't have to loop over\r\n```\r\n</details>\r\n\r\nNote that if the tx is not accepted in our mempool because it has too low fee for our mempool, but is accepted in everybody else's mempool, then we would do the remaining broadcasts up to `NUM_PRIVATE_BROADCAST_PER_TX` (5), then it would get stale and will be removed by `PeerManagerImpl::ReattemptPrivateBroadcast()`. Whereas currently, without this change it will be removed right away and we will not do the remaining broadcasts (up to 5).\r\n\r\nI got another idea - remove the transaction only if the received tx has the same txid and the same wtxid as the one that we broadcast. Currently we only compare the txid.\r\n\r\n<details>\r\n<summary>[patch] check also wtxid</summary>\r\n\r\n```diff\r\n--- i/src/private_broadcast.cpp\r\n+++ w/src/private_broadcast.cpp\r\n@@ -21,13 +21,13 @@ bool PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!\r\n }\r\n \r\n std::optional<size_t> PrivateBroadcast::Remove(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n {                 \r\n     LOCK(m_mutex);\r\n     auto iters = Find(tx->GetHash());\r\n-    if (!iters) {\r\n+    if (!iters || iters->by_txid->second.tx->GetWitnessHash() != tx->GetWitnessHash()) {\r\n         return std::nullopt;\r\n     }\r\n     const size_t num_broadcasted{iters->by_priority->first.num_broadcasted};\r\n     m_by_priority.erase(iters->by_priority);\r\n     m_by_txid.erase(iters->by_txid);\r\n     return num_broadcasted;\r\n```\r\n</details>\r\n\r\nWith this, if a malleated and valid transaction makes it to our mempool, then we would keep broadcasting the original one, up to 5 times, and then it will be removed by `PeerManagerImpl::ReattemptPrivateBroadcast()`.\r\n\r\nWhich one?",
      "created_at": "2024-10-04T12:28:52Z",
      "updated_at": "2024-10-05T05:20:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1787644002",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1787644002"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 91,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1790649950",
      "pull_request_review_id": 2352597568,
      "id": 1790649950,
      "node_id": "PRRC_kwDOABII585quyZe",
      "diff_hunk": "@@ -4537,6 +4535,41 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             LogDebug(BCLog::NET, \"received getdata for: %s peer=%d\\n\", vInv[0].ToString(), pfrom.GetId());\n         }\n \n+        if (pfrom.IsPrivateBroadcastConn()) {",
      "path": "src/net_processing.cpp",
      "position": 533,
      "original_position": 49,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "f9b2eaf96cf32dae53a0c00a30fe32f38dc9def6",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The final fixup commit leads to the question what should happen if the peer doesn't send a GETDATA to our INV. I think this would happen in practice if they are one of the later broadcast attempts and already received the tx from someone else (as a result of our first attempts). I think that we would currently never disconnect on our end, but they might disconnect us after `TIMEOUT_INTERVAL=20min` because we don't answer their ping. But if they don't have this logic the connection might stay open indefinitely, whicih seems unfortunate, so we'd probably need some kind of timer here (see also other related comment)?\r\n",
      "created_at": "2024-10-07T17:54:18Z",
      "updated_at": "2024-10-07T18:36:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1790649950",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1790649950"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4245,
      "original_line": 4245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1790666758",
      "pull_request_review_id": 2352597568,
      "id": 1790666758,
      "node_id": "PRRC_kwDOABII585qu2gG",
      "diff_hunk": "@@ -4028,6 +4130,19 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         }\n \n         pfrom.fSuccessfullyConnected = true;\n+\n+        if (pfrom.IsPrivateBroadcastConn()) {\n+            // The peer may intend to later send us NetMsgType::FEEFILTER limiting\n+            // cheap transactions, but we don't wait for that and thus we may send\n+            // them a transaction below their threshold. This is ok because this\n+            // relay logic is designed to work even in cases when the peer drops\n+            // the transaction (due to it being too cheap, or for other reasons).\n+            PushPrivateBroadcastTx(pfrom);\n+\n+            peer->m_ping_queued = true; // Ensure a ping will be sent: mimick a request via RPC.\n+            MaybeSendPing(pfrom, *peer, GetTime<std::chrono::microseconds>());",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 227,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "d8325e33e2cbab3c43c1ee0cfe17da1cc8943c5d",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "What if the peer doesn't answer our ping (because they are broken / malicious)? I think we would never disconnect them because the disconnection logic is inside of `MaybeSendPing()`, which will never be called again for private peers.",
      "created_at": "2024-10-07T18:07:53Z",
      "updated_at": "2024-10-07T18:36:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1790666758",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1790666758"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4143,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1790699672",
      "pull_request_review_id": 2352597568,
      "id": 1790699672,
      "node_id": "PRRC_kwDOABII585qu-iY",
      "diff_hunk": "@@ -2571,7 +2590,18 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect, Spa\n             }\n         }\n \n-        CSemaphoreGrant grant(*semOutbound);\n+        CSemaphoreGrant grant{*semOutbound, /*fTry=*/true};\n+        if (open_private_broadcast_to.has_value() && grant) {\n+            // Previous connection was private broadcast, thus yield to other connection types\n+            // if we are ready to do so (the outbound semaphore gave green light).\n+            open_private_broadcast_to.reset();\n+        } else if (!(open_private_broadcast_to = m_private_broadcast.ShouldOpen(num_private_broadcast_opened))) {",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 68,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e24c2706f755853fb9f4abe681342620f3f721f2",
      "in_reply_to_id": 1781677003,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I didn't mean to suggest a change to the logic, just to make it more conditional on `-privatebroadcast`, so that in principle we wouldn't even need to initiate a `m_private_broadcast` object unless the user is running in `-privatebroadcast` mode. But I don't have a concrete suggestion right now (I might suggest on at a later point but need to look deeper into the grant logic for that) so it's fine to resolve for now.",
      "created_at": "2024-10-07T18:34:33Z",
      "updated_at": "2024-10-07T18:36:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1790699672",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1790699672"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2608,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1790700993",
      "pull_request_review_id": 2352597568,
      "id": 1790700993,
      "node_id": "PRRC_kwDOABII585qu-3B",
      "diff_hunk": "@@ -0,0 +1,58 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_PRIVATE_BROADCAST_H\n+#define BITCOIN_PRIVATE_BROADCAST_H\n+\n+#include <primitives/transaction.h>\n+#include <sync.h>\n+#include <threadsafety.h>\n+#include <util/hasher.h>\n+#include <util/time.h>\n+\n+#include <map>\n+#include <unordered_map>\n+\n+/**\n+ * Store a list of transactions to be broadcast privately. Supports the following operations:\n+ * - Add a new transaction\n+ */\n+class PrivateBroadcast\n+{\n+public:\n+    /**\n+     * Add a transaction to the storage.\n+     * @param[in] tx The transaction to add.\n+     * @retval true The transaction was added.\n+     * @retval false The transaction was already present.\n+     */\n+    bool Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+private:\n+    struct Priority {\n+        size_t num_broadcasted{0};\n+        NodeClock::time_point last_broadcasted{};\n+\n+        bool operator<(const Priority& other) const;\n+    };\n+\n+    struct TxWithPriority {\n+        CTransactionRef tx;\n+        Priority priority;\n+    };\n+\n+    using ByTxid = std::unordered_map<Txid, TxWithPriority, SaltedTxidHasher>;",
      "path": "src/private_broadcast.h",
      "position": 91,
      "original_position": 45,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "80246442b80ae2abd2ca6921f4eeb348f4f819e0",
      "in_reply_to_id": 1781868981,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Which one?\r\n\r\nNo strong opinion (I think that both should work), but the second one (also check wtxid) seems simpler.\r\n\r\n",
      "created_at": "2024-10-07T18:35:36Z",
      "updated_at": "2024-10-07T18:36:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1790700993",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1790700993"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 91,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1791688265",
      "pull_request_review_id": 2354186579,
      "id": 1791688265,
      "node_id": "PRRC_kwDOABII585qyv5J",
      "diff_hunk": "@@ -4028,6 +4130,19 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         }\n \n         pfrom.fSuccessfullyConnected = true;\n+\n+        if (pfrom.IsPrivateBroadcastConn()) {\n+            // The peer may intend to later send us NetMsgType::FEEFILTER limiting\n+            // cheap transactions, but we don't wait for that and thus we may send\n+            // them a transaction below their threshold. This is ok because this\n+            // relay logic is designed to work even in cases when the peer drops\n+            // the transaction (due to it being too cheap, or for other reasons).\n+            PushPrivateBroadcastTx(pfrom);\n+\n+            peer->m_ping_queued = true; // Ensure a ping will be sent: mimick a request via RPC.\n+            MaybeSendPing(pfrom, *peer, GetTime<std::chrono::microseconds>());",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 227,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "d8325e33e2cbab3c43c1ee0cfe17da1cc8943c5d",
      "in_reply_to_id": 1790666758,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Continuing at https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1790649950",
      "created_at": "2024-10-08T11:19:11Z",
      "updated_at": "2024-10-08T11:19:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1791688265",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1791688265"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4143,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1791692868",
      "pull_request_review_id": 2354194407,
      "id": 1791692868,
      "node_id": "PRRC_kwDOABII585qyxBE",
      "diff_hunk": "@@ -4537,6 +4535,41 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             LogDebug(BCLog::NET, \"received getdata for: %s peer=%d\\n\", vInv[0].ToString(), pfrom.GetId());\n         }\n \n+        if (pfrom.IsPrivateBroadcastConn()) {",
      "path": "src/net_processing.cpp",
      "position": 533,
      "original_position": 49,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "f9b2eaf96cf32dae53a0c00a30fe32f38dc9def6",
      "in_reply_to_id": 1790649950,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Right. To resolve this and the issue at https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1790666758 I introduced a maximum lifetime of a private broadcast connection, after which time, we disconnect the peer regardless of the state the connection is in.",
      "created_at": "2024-10-08T11:22:37Z",
      "updated_at": "2024-10-08T11:22:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1791692868",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1791692868"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4245,
      "original_line": 4245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1791695089",
      "pull_request_review_id": 2354198058,
      "id": 1791695089,
      "node_id": "PRRC_kwDOABII585qyxjx",
      "diff_hunk": "@@ -0,0 +1,58 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_PRIVATE_BROADCAST_H\n+#define BITCOIN_PRIVATE_BROADCAST_H\n+\n+#include <primitives/transaction.h>\n+#include <sync.h>\n+#include <threadsafety.h>\n+#include <util/hasher.h>\n+#include <util/time.h>\n+\n+#include <map>\n+#include <unordered_map>\n+\n+/**\n+ * Store a list of transactions to be broadcast privately. Supports the following operations:\n+ * - Add a new transaction\n+ */\n+class PrivateBroadcast\n+{\n+public:\n+    /**\n+     * Add a transaction to the storage.\n+     * @param[in] tx The transaction to add.\n+     * @retval true The transaction was added.\n+     * @retval false The transaction was already present.\n+     */\n+    bool Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+private:\n+    struct Priority {\n+        size_t num_broadcasted{0};\n+        NodeClock::time_point last_broadcasted{};\n+\n+        bool operator<(const Priority& other) const;\n+    };\n+\n+    struct TxWithPriority {\n+        CTransactionRef tx;\n+        Priority priority;\n+    };\n+\n+    using ByTxid = std::unordered_map<Txid, TxWithPriority, SaltedTxidHasher>;",
      "path": "src/private_broadcast.h",
      "position": 91,
      "original_position": 45,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "80246442b80ae2abd2ca6921f4eeb348f4f819e0",
      "in_reply_to_id": 1781868981,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I went for the second one being simpler and also easier to reason about - if we received something other than what we broadcasted, then keep broadcasting (but not infinitely).",
      "created_at": "2024-10-08T11:24:22Z",
      "updated_at": "2024-10-08T11:24:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1791695089",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1791695089"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 91,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1834004515",
      "pull_request_review_id": 2423184815,
      "id": 1834004515,
      "node_id": "PRRC_kwDOABII585tULAj",
      "diff_hunk": "@@ -4537,6 +4535,41 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             LogDebug(BCLog::NET, \"received getdata for: %s peer=%d\\n\", vInv[0].ToString(), pfrom.GetId());\n         }\n \n+        if (pfrom.IsPrivateBroadcastConn()) {",
      "path": "src/net_processing.cpp",
      "position": 533,
      "original_position": 49,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "f9b2eaf96cf32dae53a0c00a30fe32f38dc9def6",
      "in_reply_to_id": 1790649950,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Marking this as resolved, feel free to comment if you have concerns with the \"maximum lifetime\" solution.",
      "created_at": "2024-11-08T09:27:10Z",
      "updated_at": "2024-11-08T09:27:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1834004515",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1834004515"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4245,
      "original_line": 4245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1834010212",
      "pull_request_review_id": 2423194241,
      "id": 1834010212,
      "node_id": "PRRC_kwDOABII585tUMZk",
      "diff_hunk": "@@ -120,6 +120,12 @@ bool WalletInit::ParameterInteraction() const\n         LogPrintf(\"%s: parameter interaction: -blocksonly=1 -> setting -walletbroadcast=0\\n\", __func__);\n     }\n \n+    if (gArgs.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST) &&",
      "path": "src/wallet/init.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "1407b3fa264b096813281a767da3cd3ca80ed096",
      "in_reply_to_id": 1578537557,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Marking this as resolved because I removed the requirement to set `-walletbroadcast=0` and extended the `-privatebroadcast` doc.\r\n\r\n> My understanding was that anything done via the wallet would work as usual, but that transactions sent via sendrawtransaction would use the private broadcast mechanism if set\r\n\r\nYes, this is exactly how it works now.",
      "created_at": "2024-11-08T09:31:22Z",
      "updated_at": "2024-11-08T09:31:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1834010212",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1834010212"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 122,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1835766013",
      "pull_request_review_id": 2425833661,
      "id": 1835766013,
      "node_id": "PRRC_kwDOABII585ta5D9",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This is unfortunate that `privatebroadcast` is incompatible with `connect`. The use case would be to connect to a single trusted peer for listening, but broadcast through ephemeral connections to not link the trusted peer to our wallet.",
      "created_at": "2024-11-10T19:30:02Z",
      "updated_at": "2024-11-10T19:30:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1835766013",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1835766013"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1839750202",
      "pull_request_review_id": 2432301407,
      "id": 1839750202,
      "node_id": "PRRC_kwDOABII585tqFw6",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "By \"for listening\" you mean \"for learning new transactions and blocks\", right? So, in that setup the node is not listening (not accepting inbound connections), has only one connection to a known honest node and broadcasts its own transactions using private broadcast? That seems like an useful setup that would be nice to have support for. But the current semantic of `-connect` is \"only connect to the specified node(s)\" which is at odds with \"connect to random nodes for transaction broadcast\". I don't like changing the semantic of `-connect` like that.\r\n\r\nI wonder if this can be supported and to keep the current meaning of `-connect`... don't use `-connect` but somehow restrict our node to be able to only connect to 1 address :thinking: ",
      "created_at": "2024-11-13T08:39:41Z",
      "updated_at": "2024-11-13T08:39:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1839750202",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1839750202"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1840396964",
      "pull_request_review_id": 2433397041,
      "id": 1840396964,
      "node_id": "PRRC_kwDOABII585tsjqk",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "But we are adding a new option here `privatebroadcast`. Could we not change the semantics of `connect` *if* the new option `privatebroadcast` is used?",
      "created_at": "2024-11-13T14:22:21Z",
      "updated_at": "2024-11-13T14:22:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1840396964",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1840396964"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1840474930",
      "pull_request_review_id": 2433480585,
      "id": 1840474930,
      "node_id": "PRRC_kwDOABII585ts2sy",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yeah, you are right that `-connect=0 -privatebroadcast=1` did not exist before because `-privatebroadcast=` did not exist. Then the semantic of `-connect=0` would be \"do this if privatebroadcast=0 and do something else if privatebroadcast=1\". I do not like that, seems convoluted and a possible source of confusion to make the behavior of one option dependent on the value of another option. I would like to have less of that stuff, not more.",
      "created_at": "2024-11-13T14:49:14Z",
      "updated_at": "2024-11-13T14:49:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1840474930",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1840474930"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1840503929",
      "pull_request_review_id": 2433509987,
      "id": 1840503929,
      "node_id": "PRRC_kwDOABII585ts9x5",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I suppose I can `addnode` my trusted node for now, but I will be leaking other outbound connections.\nI'm not sure how to handle my case unless we don't consider the ephemeral broadcast connections as true \"connections\" in the sense of `connect` option.",
      "created_at": "2024-11-13T14:58:35Z",
      "updated_at": "2024-11-13T14:58:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1840503929",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1840503929"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1840691067",
      "pull_request_review_id": 2433698243,
      "id": 1840691067,
      "node_id": "PRRC_kwDOABII585ttrd7",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Just an idea - if the trusted node is accepting inbound Tor connections, then run the private node with `-onlynet=onion -addnode=trusted.onion:8333 -privatebroadcast=1`. Benefit of connecting to the trusted node over Tor - you know that you actually connected to the trusted node (or somebody who owns the private key for the `trusted.onion` service). If you connect over clearnet to an IP address, then you have to use v2 (bip324) _and_ verify that the session ids match (`session_id` in `getpeerinfo` RPC output on both sides of the connection).",
      "created_at": "2024-11-13T16:00:48Z",
      "updated_at": "2024-11-13T16:00:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1840691067",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1840691067"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1840705057",
      "pull_request_review_id": 2433713028,
      "id": 1840705057,
      "node_id": "PRRC_kwDOABII585ttu4h",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This is a hack and I haven't tested it, but instead of using `-connect`,  `-maxconnections=0` `-privatebrodcast` and then addnode your trusted peer might work for your use case?",
      "created_at": "2024-11-13T16:05:56Z",
      "updated_at": "2024-11-13T16:05:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1840705057",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1840705057"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1862855947",
      "pull_request_review_id": 2468984613,
      "id": 1862855947,
      "node_id": "PRRC_kwDOABII585vCO0L",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> -maxconnections=0 -privatebrodcast and then addnode your trusted peer\r\n\r\nThanks for the idea, but sadly this does not work for this either. It will happily add only my trusted node, but it will not create the private broadcast connections when actually trying to send. It will just wait at 0 connections.\r\n\r\nSince we break the maxconnections value already for the addnode exception, could we make an exception for private broadcast connections as well?",
      "created_at": "2024-11-29T02:32:24Z",
      "updated_at": "2024-11-29T02:32:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1862855947",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1862855947"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1869695020",
      "pull_request_review_id": 2478953690,
      "id": 1869695020,
      "node_id": "PRRC_kwDOABII585vcUgs",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, that is the case:\r\n\r\n> argsman.AddArg(\"-maxconnections=<n>\", ... It does not apply to short-lived private broadcast connections either, which have a separate limit of MAX_PRIVATE_BROADCAST_CONNECTIONS\r\n\r\nYou can run with `-debug=privatebroadcast` and see what happens when you send a new transaction.",
      "created_at": "2024-12-04T14:57:21Z",
      "updated_at": "2024-12-04T14:57:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1869695020",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1869695020"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1997696790",
      "pull_request_review_id": 2688783411,
      "id": 1997696790,
      "node_id": "PRRC_kwDOABII5853Em8W",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I tried again with `-debug=privatebroadcast`. It does indeed just wait at 0 connections. The only relevant logs are\r\n```\r\n[privatebroadcast] Requesting 5 new connections due to txid=<redacted>, wtxid=<redacted>\r\n[privatebroadcast] Request to increment the needed new connections by 5, changed from 0 to 5\r\n```\r\n\r\nAlso had `-debug=net -debug=tor`, and no new connections were attempted.",
      "created_at": "2025-03-16T20:06:40Z",
      "updated_at": "2025-03-16T20:06:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1997696790",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1997696790"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1997703505",
      "pull_request_review_id": 2688791010,
      "id": 1997703505,
      "node_id": "PRRC_kwDOABII5853EolR",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "What did work was setting `-maxconnections=1` and then `-addnode=<local node>`. This did create a single blocks only peer along with the addnode peer, but it was able to use private broadcast. So, seems like there is a switch somewhere that disables this if `-maxconnections=0` exactly?",
      "created_at": "2025-03-16T20:44:03Z",
      "updated_at": "2025-03-16T20:44:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1997703505",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1997703505"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1997875119",
      "pull_request_review_id": 2689027728,
      "id": 1997875119,
      "node_id": "PRRC_kwDOABII5853FSev",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Hmm actually it stops opening new connections after all connection slots and the addnode are filled. It logs request to open 5, but then never manages to open one if I set maxconnections below 10. It only works if I call sendrawtransaction shortly after startup before all slots are filled.",
      "created_at": "2025-03-17T03:18:37Z",
      "updated_at": "2025-03-17T03:18:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1997875119",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1997875119"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1999120268",
      "pull_request_review_id": 2691182621,
      "id": 1999120268,
      "node_id": "PRRC_kwDOABII5853KCeM",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Right, it is because of this:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/e150e3064b4c8165a0429a536d5235e8475e0045/src/net.cpp#L2663-L2676\r\n\r\nwhat happens is that there are no free slots, so the grant is not acquired immediately at line 2663. No private broadcast is needed, so it goes to line 2673 to wait for the grant, \"indefinitely\", until some peer is disconnected. Then a transaction is submitted and a private broadcast is needed, but the code is waiting here on line 2673. Hmm...",
      "created_at": "2025-03-17T16:10:07Z",
      "updated_at": "2025-03-17T16:10:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r1999120268",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1999120268"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2024427126",
      "pull_request_review_id": 2735562385,
      "id": 2024427126,
      "node_id": "PRRC_kwDOABII5854qk52",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This should be resolved in the latest push: https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2771929840 because now opening private broadcast connections runs in a separate thread and is not subject to the blocking by `semOutbound`. Much simpler! Thank you, @andrewtoth for persisting here :sparkles: ",
      "created_at": "2025-04-02T09:14:45Z",
      "updated_at": "2025-04-02T09:14:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2024427126",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2024427126"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2029586461",
      "pull_request_review_id": 2744359641,
      "id": 2029586461,
      "node_id": "PRRC_kwDOABII5854-Qgd",
      "diff_hunk": "@@ -1952,6 +1984,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"",
      "path": "src/init.cpp",
      "position": 96,
      "original_position": 110,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "30ec819596f4000b46c9b7bf8d3ee1518af5d533",
      "in_reply_to_id": 1700086637,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Confirmed the latest works with `-maxconnections=0 -addnode=<localnode>` :tada: \r\nThanks @vasild for the fix and @mzumsande for the suggestion!",
      "created_at": "2025-04-05T00:44:45Z",
      "updated_at": "2025-04-05T00:44:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2029586461",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2029586461"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2203,
      "original_line": 2203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030206886",
      "pull_request_review_id": 2745195105,
      "id": 2030206886,
      "node_id": "PRRC_kwDOABII5855An-m",
      "diff_hunk": "@@ -2055,6 +2064,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"\n+                               \"but none of Tor or I2P networks is reachable\"));\n+        }\n+        if (!connOptions.m_use_addrman_outgoing) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"\n+                               \"but -connect is also configured. They are incompatible because the \"\n+                               \"private broadcast needs to open new connections to randomly \"\n+                               \"chosen Tor or I2P peers\"));",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 60,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "3eb2ee0fbb1fe1e6d16e4f004841cf960bead6a8",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Maybe add a hint here to configure `-maxconnections=0 -addnode=<connect node>` to bypass this?",
      "created_at": "2025-04-06T17:05:43Z",
      "updated_at": "2025-04-06T19:04:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2030206886",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030206886"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2082,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030209842",
      "pull_request_review_id": 2745195105,
      "id": 2030209842,
      "node_id": "PRRC_kwDOABII5855Aosy",
      "diff_hunk": "@@ -3051,6 +3054,68 @@ bool CConnman::OpenNetworkConnection(const CAddress& addrConnect,\n     return true;\n }\n \n+std::optional<Proxy> CConnman::PrivateBroadcast::ProxyForIPv4or6() const\n+{\n+    Proxy tor_proxy;\n+    if (m_outbound_tor_ok_at_least_once.load() && GetProxy(NET_ONION, tor_proxy)) {\n+        return tor_proxy;\n+    }\n+    return std::nullopt;\n+}\n+\n+bool CConnman::PrivateBroadcast::PickNetwork(Network& net, std::optional<Proxy>& proxy) const",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 25,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "cb503ef72cdf326f301d1bbb7d7cd6dcc761937d",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Wouldn't a `std::option<Network>` work better here as a return value?",
      "created_at": "2025-04-06T17:19:50Z",
      "updated_at": "2025-04-06T19:04:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2030209842",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030209842"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3066,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030212088",
      "pull_request_review_id": 2745195105,
      "id": 2030212088,
      "node_id": "PRRC_kwDOABII5855ApP4",
      "diff_hunk": "@@ -3135,6 +3200,69 @@ void CConnman::ThreadI2PAcceptIncoming()\n     }\n }\n \n+void CConnman::ThreadPrivateBroadcast()\n+{\n+    AssertLockNotHeld(m_unused_i2p_sessions_mutex);\n+\n+    size_t addrman_num_bad_addresses{0};\n+    while (!interruptNet) {\n+\n+        if (!fNetworkActive) {\n+            interruptNet.sleep_for(5s);\n+            continue;\n+        }\n+\n+        CSemaphoreGrant conn_max_grant{m_private_broadcast.m_sem_conn_max}; // Would block if too many are opened.\n+\n+        m_private_broadcast.NumToOpenWait();\n+\n+        if (interruptNet) {\n+            break;\n+        }\n+\n+        Network net;\n+        std::optional<Proxy> proxy;\n+        if (!m_private_broadcast.PickNetwork(net, proxy)) {\n+            LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                          BCLog::Level::Warning,\n+                          \"Connections needed but none of the Tor or I2P networks is reachable\");\n+            interruptNet.sleep_for(5s);\n+            continue;\n+        }\n+\n+        const auto [addr, _] = addrman.Select(/*new_only=*/false, {net});\n+\n+        if (!addr.IsValid() || IsLocal(addr)) {\n+            ++addrman_num_bad_addresses;\n+            if (addrman_num_bad_addresses > 100) {\n+                interruptNet.sleep_for(500ms);\n+            }\n+            continue;\n+        }\n+        addrman_num_bad_addresses = 0;\n+\n+        auto target_str{addr.ToStringAddrPort()};\n+        if ((net == NET_IPV4 || net == NET_IPV6) && proxy.has_value()) {",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 127,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "cb503ef72cdf326f301d1bbb7d7cd6dcc761937d",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Based on implementation of `PickNetwork` the `proxy.has_value()` will always be true and is redundant here, no?",
      "created_at": "2025-04-06T17:30:11Z",
      "updated_at": "2025-04-06T19:04:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2030212088",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030212088"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030214671",
      "pull_request_review_id": 2745195105,
      "id": 2030214671,
      "node_id": "PRRC_kwDOABII5855Ap4P",
      "diff_hunk": "@@ -2057,7 +2059,19 @@ bool CWallet::SubmitTxMemoryPoolAndRelay(CWalletTx& wtx, std::string& err_string\n     if (GetTxDepthInMainChain(wtx) != 0) return false;\n \n     // Submit transaction to mempool for relay",
      "path": "src/wallet/wallet.cpp",
      "position": 1,
      "original_position": 14,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b77bd663e9e4ac4f5cad3e55fe2cc392e5cd2e1e",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This comment is now stale.",
      "created_at": "2025-04-06T17:41:52Z",
      "updated_at": "2025-04-06T19:04:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2030214671",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030214671"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2061,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030223629",
      "pull_request_review_id": 2745195105,
      "id": 2030223629,
      "node_id": "PRRC_kwDOABII5855AsEN",
      "diff_hunk": "@@ -1566,26 +1665,53 @@ void PeerManagerImpl::FindNextBlocks(std::vector<const CBlockIndex*>& vBlocks, c\n \n void PeerManagerImpl::PushNodeVersion(CNode& pnode, const Peer& peer)\n {\n-    uint64_t my_services{peer.m_our_services};\n-    const int64_t nTime{count_seconds(GetTime<std::chrono::seconds>())};\n-    uint64_t nonce = pnode.GetLocalNonce();\n-    const int nNodeStartingHeight{m_best_height};\n-    NodeId nodeid = pnode.GetId();\n-    CAddress addr = pnode.addr;\n-\n-    CService addr_you = addr.IsRoutable() && !IsProxy(addr) && addr.IsAddrV1Compatible() ? addr : CService();\n-    uint64_t your_services{addr.nServices};\n-\n-    const bool tx_relay{!RejectIncomingTxs(pnode)};\n-    MakeAndPushMessage(pnode, NetMsgType::VERSION, PROTOCOL_VERSION, my_services, nTime,\n-            your_services, CNetAddr::V1(addr_you), // Together the pre-version-31402 serialization of CAddress \"addrYou\" (without nTime)\n-            my_services, CNetAddr::V1(CService{}), // Together the pre-version-31402 serialization of CAddress \"addrMe\" (without nTime)\n-            nonce, strSubVersion, nNodeStartingHeight, tx_relay);\n-\n+    uint64_t my_services;\n+    int64_t my_time;\n+    uint64_t your_services;\n+    CService your_addr;\n+    std::string my_user_agent;\n+    int my_height;\n+    bool my_tx_relay;\n+    if (pnode.IsPrivateBroadcastConn()) {\n+        my_services = NODE_NONE;\n+        my_time = 0;\n+        your_services = NODE_NONE;\n+        your_addr = CService{};\n+        my_user_agent = \"/pynode:0.0.1/\";",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 172,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "07dee91112189be02c6694385de261570725b56b",
      "in_reply_to_id": 1518263617,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Agree with @sr-gi that having a comment explaining why this ua was chosen would be helpful.",
      "created_at": "2025-04-06T18:23:04Z",
      "updated_at": "2025-04-06T19:04:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2030223629",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030223629"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1528,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030224619",
      "pull_request_review_id": 2745195105,
      "id": 2030224619,
      "node_id": "PRRC_kwDOABII5855AsTr",
      "diff_hunk": "@@ -1627,7 +1675,7 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n     }\n     } // cs_main\n     if (node.fSuccessfullyConnected &&\n-        !node.IsBlockOnlyConn() && !node.IsInboundConn()) {\n+        !node.IsBlockOnlyConn() && !node.IsPrivateBroadcastConn() && !node.IsInboundConn()) {\n         // Only change visible addrman state for full outbound peers.  We don't\n         // call Connected() for feeler connections since they don't have",
      "path": "src/net_processing.cpp",
      "position": 272,
      "original_position": 125,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "12f6e7f3d35d0d0a35b63d70d1dd752932d64a7d",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Maybe add `// We don't call Connected() for private broadcast connections since they could leak information in addrman.`",
      "created_at": "2025-04-06T18:27:05Z",
      "updated_at": "2025-04-06T19:04:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2030224619",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030224619"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1763,
      "original_line": 1763,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030225474",
      "pull_request_review_id": 2745195105,
      "id": 2030225474,
      "node_id": "PRRC_kwDOABII5855AshC",
      "diff_hunk": "@@ -3525,7 +3611,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             if (fRelay) pfrom.m_relays_txs = true;\n         }\n \n-        if (!pfrom.IsInboundConn()) {\n+        if (!pfrom.IsInboundConn() && !pfrom.IsPrivateBroadcastConn()) {",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 184,
      "commit_id": "7547f915bc6cb0425b46234df486e0de34cad3b3",
      "original_commit_id": "12f6e7f3d35d0d0a35b63d70d1dd752932d64a7d",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Could expand on the comment below about why we don't do this for private broadcast connections either. We don't want to modify the addrman based on private broadcast connections in case they leak information about our node connecting to peers via those connections.",
      "created_at": "2025-04-06T18:30:39Z",
      "updated_at": "2025-04-06T19:04:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2030225474",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030225474"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3711,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030231815",
      "pull_request_review_id": 2745195105,
      "id": 2030231815,
      "node_id": "PRRC_kwDOABII5855AuEH",
      "diff_hunk": "@@ -42,11 +44,20 @@ using util::ToString;\n static RPCHelpMan sendrawtransaction()\n {\n     return RPCHelpMan{\"sendrawtransaction\",\n-        \"\\nSubmit a raw transaction (serialized, hex-encoded) to local node and network.\\n\"\n-        \"\\nThe transaction will be sent unconditionally to all peers, so using sendrawtransaction\\n\"\n-        \"for manual rebroadcast may degrade privacy by leaking the transaction's origin, as\\n\"\n-        \"nodes will normally not rebroadcast non-wallet transactions already in their mempool.\\n\"\n+        \"\\nSubmit a raw transaction (serialized, hex-encoded) to the network.\\n\"\n+\n+        \"\\nIf -privatebroadcast is disabled, then the transaction will be sent\\n\"",
      "path": "src/rpc/mempool.cpp",
      "position": 1,
      "original_position": 23,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "7d6fbced107259e8c70ebcd05d15ceb1305ce010",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Might be worth clarifying that in this case the the tx will be submitted to the local node immediately before broadcasting, whereas privatebroadcast it will not be.",
      "created_at": "2025-04-06T18:57:43Z",
      "updated_at": "2025-04-06T19:04:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2030231815",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2030231815"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 49,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2031548641",
      "pull_request_review_id": 2747338325,
      "id": 2031548641,
      "node_id": "PRRC_kwDOABII5855Fvjh",
      "diff_hunk": "@@ -3375,6 +3515,34 @@ void PeerManagerImpl::ProcessCompactBlockTxns(CNode& pfrom, Peer& peer, const Bl\n     return;\n }\n \n+void PeerManagerImpl::PushPrivateBroadcastTx(CNode& node)\n+{\n+    Assume(node.IsPrivateBroadcastConn());\n+\n+    auto opt_tx = m_tx_for_private_broadcast.GetTxForBroadcast();\n+    if (!opt_tx) {\n+        LogDebug(BCLog::PRIVATE_BROADCAST,\n+                 \"Disconnecting: no more transactions for private broadcast (connected in vain), peer=%d%s\",\n+                 node.GetId(),\n+                 node.LogIP(fLogIPs));\n+        node.fDisconnect = true;\n+        return;\n+    }\n+    const CTransactionRef& tx{*opt_tx};",
      "path": "src/net_processing.cpp",
      "position": 367,
      "original_position": 340,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Reaching here can be quite delayed from when the tx was actually scheduled. Could we check here that the tx is still acceptable to our mempool before pushing?",
      "created_at": "2025-04-07T15:53:26Z",
      "updated_at": "2025-04-07T15:53:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2031548641",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2031548641"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3572,
      "original_line": 3572,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2032895434",
      "pull_request_review_id": 2749487666,
      "id": 2032895434,
      "node_id": "PRRC_kwDOABII5855K4XK",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "_Continuing from https://github.com/bitcoin/bitcoin/pull/29415#pullrequestreview-2745195105_\r\n\r\n> ... maybe we could have a shorter duration stale tx check to have faster feedback than 10 minutes ...\r\n\r\nCould reduce those 10+5 mins to e.g. 5+2 mins? The `NextTxBroadcast()` method is reused from both private and non-private broadcast (the current one that sends to everybody). Is it worth having a separate method or parametrizing this one to cover a quick repeat of `walletcreatefundedpsbt` RPC with a sooner feedback? Is that also a realistic scenario or more of a testing one? In my testing the window of \"broadcast but not received back\" is just a few seconds. Maybe having this retry every 5 instead of 10 minutes will not make much of a difference?\r\n\r\nIMO the best is to have the wallet account the \"broadcast but not received back and not in the mempool\" transaction - for balance display and for selecting inputs for subsequent transactions. That will be in a followup after this PR.\r\n\r\nAnother thing that will help with a loop of `walletcreatefundedpsbt` RPCs is a way to monitor the status of a transaction, e.g. \"no sent\", \"sent to 2 peers\", \"received back from the network\". That is also for a followup. Both are mentioned in \"Further extensions of this planned for subsequent PRs\" as a reminder.",
      "created_at": "2025-04-08T10:30:45Z",
      "updated_at": "2025-04-08T10:30:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2032895434",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2032895434"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2032964470",
      "pull_request_review_id": 2749601907,
      "id": 2032964470,
      "node_id": "PRRC_kwDOABII5855LJN2",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2032895434,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yeah it's probably not worth changing the interval. I think the suggestion [here](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2031548641) would work better.",
      "created_at": "2025-04-08T11:14:35Z",
      "updated_at": "2025-04-08T11:14:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2032964470",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2032964470"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033211274",
      "pull_request_review_id": 2750013885,
      "id": 2033211274,
      "node_id": "PRRC_kwDOABII5855MFeK",
      "diff_hunk": "@@ -2055,6 +2064,31 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"\n+                               \"but none of Tor or I2P networks is reachable\"));\n+        }\n+        if (!connOptions.m_use_addrman_outgoing) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"\n+                               \"but -connect is also configured. They are incompatible because the \"\n+                               \"private broadcast needs to open new connections to randomly \"\n+                               \"chosen Tor or I2P peers\"));",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 60,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "3eb2ee0fbb1fe1e6d16e4f004841cf960bead6a8",
      "in_reply_to_id": 2030206886,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2025-04-08T13:35:41Z",
      "updated_at": "2025-04-08T13:35:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2033211274",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033211274"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2082,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033213265",
      "pull_request_review_id": 2750017417,
      "id": 2033213265,
      "node_id": "PRRC_kwDOABII5855MF9R",
      "diff_hunk": "@@ -3051,6 +3054,68 @@ bool CConnman::OpenNetworkConnection(const CAddress& addrConnect,\n     return true;\n }\n \n+std::optional<Proxy> CConnman::PrivateBroadcast::ProxyForIPv4or6() const\n+{\n+    Proxy tor_proxy;\n+    if (m_outbound_tor_ok_at_least_once.load() && GetProxy(NET_ONION, tor_proxy)) {\n+        return tor_proxy;\n+    }\n+    return std::nullopt;\n+}\n+\n+bool CConnman::PrivateBroadcast::PickNetwork(Network& net, std::optional<Proxy>& proxy) const",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 25,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "cb503ef72cdf326f301d1bbb7d7cd6dcc761937d",
      "in_reply_to_id": 2030209842,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, changed.",
      "created_at": "2025-04-08T13:36:42Z",
      "updated_at": "2025-04-08T13:36:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2033213265",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033213265"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3066,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033219193",
      "pull_request_review_id": 2750027604,
      "id": 2033219193,
      "node_id": "PRRC_kwDOABII5855MHZ5",
      "diff_hunk": "@@ -3135,6 +3200,69 @@ void CConnman::ThreadI2PAcceptIncoming()\n     }\n }\n \n+void CConnman::ThreadPrivateBroadcast()\n+{\n+    AssertLockNotHeld(m_unused_i2p_sessions_mutex);\n+\n+    size_t addrman_num_bad_addresses{0};\n+    while (!interruptNet) {\n+\n+        if (!fNetworkActive) {\n+            interruptNet.sleep_for(5s);\n+            continue;\n+        }\n+\n+        CSemaphoreGrant conn_max_grant{m_private_broadcast.m_sem_conn_max}; // Would block if too many are opened.\n+\n+        m_private_broadcast.NumToOpenWait();\n+\n+        if (interruptNet) {\n+            break;\n+        }\n+\n+        Network net;\n+        std::optional<Proxy> proxy;\n+        if (!m_private_broadcast.PickNetwork(net, proxy)) {\n+            LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                          BCLog::Level::Warning,\n+                          \"Connections needed but none of the Tor or I2P networks is reachable\");\n+            interruptNet.sleep_for(5s);\n+            continue;\n+        }\n+\n+        const auto [addr, _] = addrman.Select(/*new_only=*/false, {net});\n+\n+        if (!addr.IsValid() || IsLocal(addr)) {\n+            ++addrman_num_bad_addresses;\n+            if (addrman_num_bad_addresses > 100) {\n+                interruptNet.sleep_for(500ms);\n+            }\n+            continue;\n+        }\n+        addrman_num_bad_addresses = 0;\n+\n+        auto target_str{addr.ToStringAddrPort()};\n+        if ((net == NET_IPV4 || net == NET_IPV6) && proxy.has_value()) {",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 127,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "cb503ef72cdf326f301d1bbb7d7cd6dcc761937d",
      "in_reply_to_id": 2030212088,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, it is best if this code in `ThreadPrivateBroadcast()` does not rely too much on the internal decisions made by `PickNetwork()` whose promise is that `proxy` will be set if there is a need to override the normal proxy selection. Nothing more and no details about which networks need proxy override. I changed this code and dropped `net == NET_IPV4 || net == NET_IPV6` and changed the log message from \"Tor proxy\" or just \"proxy\".",
      "created_at": "2025-04-08T13:39:47Z",
      "updated_at": "2025-04-08T13:39:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2033219193",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033219193"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033219480",
      "pull_request_review_id": 2750028082,
      "id": 2033219480,
      "node_id": "PRRC_kwDOABII5855MHeY",
      "diff_hunk": "@@ -2057,7 +2059,19 @@ bool CWallet::SubmitTxMemoryPoolAndRelay(CWalletTx& wtx, std::string& err_string\n     if (GetTxDepthInMainChain(wtx) != 0) return false;\n \n     // Submit transaction to mempool for relay",
      "path": "src/wallet/wallet.cpp",
      "position": 1,
      "original_position": 14,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b77bd663e9e4ac4f5cad3e55fe2cc392e5cd2e1e",
      "in_reply_to_id": 2030214671,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Removed.",
      "created_at": "2025-04-08T13:39:55Z",
      "updated_at": "2025-04-08T13:39:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2033219480",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033219480"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2061,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033219983",
      "pull_request_review_id": 2750028957,
      "id": 2033219983,
      "node_id": "PRRC_kwDOABII5855MHmP",
      "diff_hunk": "@@ -1566,26 +1665,53 @@ void PeerManagerImpl::FindNextBlocks(std::vector<const CBlockIndex*>& vBlocks, c\n \n void PeerManagerImpl::PushNodeVersion(CNode& pnode, const Peer& peer)\n {\n-    uint64_t my_services{peer.m_our_services};\n-    const int64_t nTime{count_seconds(GetTime<std::chrono::seconds>())};\n-    uint64_t nonce = pnode.GetLocalNonce();\n-    const int nNodeStartingHeight{m_best_height};\n-    NodeId nodeid = pnode.GetId();\n-    CAddress addr = pnode.addr;\n-\n-    CService addr_you = addr.IsRoutable() && !IsProxy(addr) && addr.IsAddrV1Compatible() ? addr : CService();\n-    uint64_t your_services{addr.nServices};\n-\n-    const bool tx_relay{!RejectIncomingTxs(pnode)};\n-    MakeAndPushMessage(pnode, NetMsgType::VERSION, PROTOCOL_VERSION, my_services, nTime,\n-            your_services, CNetAddr::V1(addr_you), // Together the pre-version-31402 serialization of CAddress \"addrYou\" (without nTime)\n-            my_services, CNetAddr::V1(CService{}), // Together the pre-version-31402 serialization of CAddress \"addrMe\" (without nTime)\n-            nonce, strSubVersion, nNodeStartingHeight, tx_relay);\n-\n+    uint64_t my_services;\n+    int64_t my_time;\n+    uint64_t your_services;\n+    CService your_addr;\n+    std::string my_user_agent;\n+    int my_height;\n+    bool my_tx_relay;\n+    if (pnode.IsPrivateBroadcastConn()) {\n+        my_services = NODE_NONE;\n+        my_time = 0;\n+        your_services = NODE_NONE;\n+        your_addr = CService{};\n+        my_user_agent = \"/pynode:0.0.1/\";",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 172,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "07dee91112189be02c6694385de261570725b56b",
      "in_reply_to_id": 1518263617,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Added a comment.",
      "created_at": "2025-04-08T13:40:10Z",
      "updated_at": "2025-04-08T13:40:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2033219983",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033219983"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1528,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033220427",
      "pull_request_review_id": 2750029658,
      "id": 2033220427,
      "node_id": "PRRC_kwDOABII5855MHtL",
      "diff_hunk": "@@ -1627,7 +1675,7 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n     }\n     } // cs_main\n     if (node.fSuccessfullyConnected &&\n-        !node.IsBlockOnlyConn() && !node.IsInboundConn()) {\n+        !node.IsBlockOnlyConn() && !node.IsPrivateBroadcastConn() && !node.IsInboundConn()) {\n         // Only change visible addrman state for full outbound peers.  We don't\n         // call Connected() for feeler connections since they don't have",
      "path": "src/net_processing.cpp",
      "position": 272,
      "original_position": 125,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "12f6e7f3d35d0d0a35b63d70d1dd752932d64a7d",
      "in_reply_to_id": 2030224619,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2025-04-08T13:40:22Z",
      "updated_at": "2025-04-08T13:40:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2033220427",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033220427"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1763,
      "original_line": 1763,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033220926",
      "pull_request_review_id": 2750030580,
      "id": 2033220926,
      "node_id": "PRRC_kwDOABII5855MH0-",
      "diff_hunk": "@@ -3525,7 +3611,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             if (fRelay) pfrom.m_relays_txs = true;\n         }\n \n-        if (!pfrom.IsInboundConn()) {\n+        if (!pfrom.IsInboundConn() && !pfrom.IsPrivateBroadcastConn()) {",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 184,
      "commit_id": "7547f915bc6cb0425b46234df486e0de34cad3b3",
      "original_commit_id": "12f6e7f3d35d0d0a35b63d70d1dd752932d64a7d",
      "in_reply_to_id": 2030225474,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2025-04-08T13:40:40Z",
      "updated_at": "2025-04-08T13:40:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2033220926",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033220926"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3711,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033221633",
      "pull_request_review_id": 2750031708,
      "id": 2033221633,
      "node_id": "PRRC_kwDOABII5855MIAB",
      "diff_hunk": "@@ -42,11 +44,20 @@ using util::ToString;\n static RPCHelpMan sendrawtransaction()\n {\n     return RPCHelpMan{\"sendrawtransaction\",\n-        \"\\nSubmit a raw transaction (serialized, hex-encoded) to local node and network.\\n\"\n-        \"\\nThe transaction will be sent unconditionally to all peers, so using sendrawtransaction\\n\"\n-        \"for manual rebroadcast may degrade privacy by leaking the transaction's origin, as\\n\"\n-        \"nodes will normally not rebroadcast non-wallet transactions already in their mempool.\\n\"\n+        \"\\nSubmit a raw transaction (serialized, hex-encoded) to the network.\\n\"\n+\n+        \"\\nIf -privatebroadcast is disabled, then the transaction will be sent\\n\"",
      "path": "src/rpc/mempool.cpp",
      "position": 1,
      "original_position": 23,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "7d6fbced107259e8c70ebcd05d15ceb1305ce010",
      "in_reply_to_id": 2030231815,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2025-04-08T13:40:58Z",
      "updated_at": "2025-04-08T13:40:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2033221633",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033221633"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 49,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033227029",
      "pull_request_review_id": 2750040604,
      "id": 2033227029,
      "node_id": "PRRC_kwDOABII5855MJUV",
      "diff_hunk": "@@ -3375,6 +3515,34 @@ void PeerManagerImpl::ProcessCompactBlockTxns(CNode& pfrom, Peer& peer, const Bl\n     return;\n }\n \n+void PeerManagerImpl::PushPrivateBroadcastTx(CNode& node)\n+{\n+    Assume(node.IsPrivateBroadcastConn());\n+\n+    auto opt_tx = m_tx_for_private_broadcast.GetTxForBroadcast();\n+    if (!opt_tx) {\n+        LogDebug(BCLog::PRIVATE_BROADCAST,\n+                 \"Disconnecting: no more transactions for private broadcast (connected in vain), peer=%d%s\",\n+                 node.GetId(),\n+                 node.LogIP(fLogIPs));\n+        node.fDisconnect = true;\n+        return;\n+    }\n+    const CTransactionRef& tx{*opt_tx};",
      "path": "src/net_processing.cpp",
      "position": 367,
      "original_position": 340,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2031548641,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Looks a bit of an overkill to me. It could be delayed but normally it is not and the worst that can happen is that this will be detected later during the rebroadcast attempt. No strong opinion but I somewhat lean on leaving it as it is.",
      "created_at": "2025-04-08T13:43:36Z",
      "updated_at": "2025-04-08T13:43:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2033227029",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033227029"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3572,
      "original_line": 3572,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033240261",
      "pull_request_review_id": 2750063216,
      "id": 2033240261,
      "node_id": "PRRC_kwDOABII5855MMjF",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2032895434,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Hmm, would it? If there is a script which runs `walletcreatefundedpsbt` RPC in quick succession, then all the transactions it generates will pass the mempool acceptance check, even if it is added to `PushPrivateBroadcastTx()`?",
      "created_at": "2025-04-08T13:49:54Z",
      "updated_at": "2025-04-08T13:49:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2033240261",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033240261"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033482630",
      "pull_request_review_id": 2750468030,
      "id": 2033482630,
      "node_id": "PRRC_kwDOABII5855NHuG",
      "diff_hunk": "@@ -1136,7 +1147,97 @@ class CConnman\n     bool GetNetworkActive() const { return fNetworkActive; };\n     bool GetUseAddrmanOutgoing() const { return m_use_addrman_outgoing; };\n     void SetNetworkActive(bool active);\n-    void OpenNetworkConnection(const CAddress& addrConnect, bool fCountFailure, CSemaphoreGrant&& grant_outbound, const char* strDest, ConnectionType conn_type, bool use_v2transport) EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\n+\n+    /**\n+     * Open a new P2P connection and initialize it with the PeerManager at `m_msgproc`.\n+     * @param[in] addrConnect Address to connect to, if `strDest` is `nullptr`.\n+     * @param[in] fCountFailure Increment the number of connection attempts to this address in Addrman.\n+     * @param[in] grant_outbound Take ownership of this grant, to be released later when the connection is closed.\n+     * @param[in] strDest Address to resolve and connect to.\n+     * @param[in] conn_type Type of the connection to open, must not be `ConnectionType::INBOUND`.\n+     * @param[in] use_v2transport Use P2P encryption, (aka V2 transport, BIP324).\n+     * @param[in] proxy Optional proxy to use and override normal proxy selection.\n+     * @retval true The connection was opened successfully.\n+     * @retval false The connection attempt failed.\n+     */\n+    bool OpenNetworkConnection(const CAddress& addrConnect,\n+                               bool fCountFailure,\n+                               CSemaphoreGrant&& grant_outbound,\n+                               const char* strDest,\n+                               ConnectionType conn_type,\n+                               bool use_v2transport,\n+                               std::optional<Proxy> proxy = std::nullopt)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\n+\n+    /// Group of private broadcast related members.\n+    class PrivateBroadcast\n+    {\n+    public:\n+        /**\n+         * Remember if we ever established at least one outbound connection to a\n+         * Tor peer, including sending and receiving P2P messages. If this is\n+         * true then the Tor proxy indeed works and is a proxy to the Tor network,\n+         * not a misconfigured ordinary SOCKS5 proxy as -proxy or -onion. If that\n+         * is the case, then we assume that connecting to an IPv4 or IPv6 address\n+         * via that proxy will be done trough the Tor network and a Tor exit node.\n+         */\n+        std::atomic_bool m_outbound_tor_ok_at_least_once{false};\n+\n+        /**\n+         * Check if private broadcast can be done to IPv4 or IPv6 peers and if so via which proxy.\n+         * If private broadcast connections should not be opened to IPv4 or IPv6, then this will\n+         * return an empty optional.\n+         */\n+        std::optional<Proxy> ProxyForIPv4or6() const;",
      "path": "src/net.h",
      "position": 1,
      "original_position": 99,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "14ebee8ea29e555caaeaa4e0a935f0897390bdfb",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This could be private.",
      "created_at": "2025-04-08T15:38:10Z",
      "updated_at": "2025-04-08T15:38:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2033482630",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033482630"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1191,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033762834",
      "pull_request_review_id": 2750944694,
      "id": 2033762834,
      "node_id": "PRRC_kwDOABII5855OMIS",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2032895434,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I've been testing sending multiple `walletcreatefundedpsbt`s in quick successions. Since we are single threaded, the first connection is opened and we send the tx. The second connection is opened and we send the tx. Sometimes before we even connect to the second peer to send the second tx we receive the first tx, so we stop connections for the first tx. However, we still go through the motions of sending the second tx three more times.\r\n\r\nI tried the same with the below patch, and before we push the tx in the second connection we will stop as well.\r\n\r\n```diff\r\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\r\nindex 94b398daf6..d76ebd3b6c 100644\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -3531,6 +3531,25 @@ void PeerManagerImpl::PushPrivateBroadcastTx(CNode& node)\r\n     }\r\n     const CTransactionRef& tx{*opt_tx};\r\n \r\n+    const auto mempool_acceptable{WITH_LOCK(cs_main, return m_chainman.ProcessTransaction(tx, /*test_accept=*/true))};\r\n+    if (mempool_acceptable.m_result_type != MempoolAcceptResult::ResultType::VALID) {\r\n+        LogPrintLevel(BCLog::PRIVATE_BROADCAST,\r\n+            BCLog::Level::Info,\r\n+            \"Giving up broadcast attempts for txid=%s wtxid=%s: %s\",\r\n+            tx->GetHash().ToString(),\r\n+            tx->GetWitnessHash().ToString(),\r\n+            mempool_acceptable.m_state.ToString());\r\n+        if (const auto num_broadcasted{m_tx_for_private_broadcast.Remove(tx)}) {\r\n+            if (NUM_PRIVATE_BROADCAST_PER_TX > num_broadcasted.value()) {\r\n+                // Not all of the initial NUM_PRIVATE_BROADCAST_PER_TX connections were needed.\r\n+                // Tell CConnman it does not need to start the remaining ones.\r\n+                m_connman.m_private_broadcast.NumToOpenSub(NUM_PRIVATE_BROADCAST_PER_TX - num_broadcasted.value());\r\n+            }\r\n+        }\r\n+        node.fDisconnect = true;\r\n+        return;\r\n+    }\r\n+\r\n     LogPrintLevel(BCLog::PRIVATE_BROADCAST,\r\n                   BCLog::Level::Info,\r\n                   \"P2P handshake completed, sending txid=%s%s, peer=%d%s\",\r\n\r\n```",
      "created_at": "2025-04-08T18:01:26Z",
      "updated_at": "2025-04-08T18:38:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2033762834",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033762834"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033983639",
      "pull_request_review_id": 2751328427,
      "id": 2033983639,
      "node_id": "PRRC_kwDOABII5855PCCX",
      "diff_hunk": "@@ -3051,6 +3054,72 @@ bool CConnman::OpenNetworkConnection(const CAddress& addrConnect,\n     return true;\n }\n \n+std::optional<Proxy> CConnman::PrivateBroadcast::ProxyForIPv4or6() const\n+{\n+    Proxy tor_proxy;\n+    if (m_outbound_tor_ok_at_least_once.load() && GetProxy(NET_ONION, tor_proxy)) {\n+        return tor_proxy;\n+    }\n+    return std::nullopt;\n+}\n+\n+std::optional<Network> CConnman::PrivateBroadcast::PickNetwork(std::optional<Proxy>& proxy) const\n+{\n+    prevector<4, Network> nets;\n+    std::optional<Proxy> clearnet_proxy;\n+    if (g_reachable_nets.Contains(NET_ONION)) {\n+        nets.push_back(NET_ONION);\n+\n+        clearnet_proxy = ProxyForIPv4or6();\n+        if (clearnet_proxy.has_value()) {\n+            nets.push_back(NET_IPV4);",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 34,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "530c186eecbf1a8e4f5525a18dcdd72d6c737f40",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This should respect `-onlynet` settings and only attempt connections via proxy to IPv4 addresses if that network is in `g_reachable_nets`. Same for IPv6 a line below.",
      "created_at": "2025-04-08T20:37:42Z",
      "updated_at": "2025-04-08T22:07:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2033983639",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2033983639"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3075,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2034084572",
      "pull_request_review_id": 2751328427,
      "id": 2034084572,
      "node_id": "PRRC_kwDOABII5855Parc",
      "diff_hunk": "@@ -1627,16 +1675,28 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n     }\n     } // cs_main\n     if (node.fSuccessfullyConnected &&\n-        !node.IsBlockOnlyConn() && !node.IsInboundConn()) {\n+        !node.IsBlockOnlyConn() && !node.IsPrivateBroadcastConn() && !node.IsInboundConn()) {\n         // Only change visible addrman state for full outbound peers.  We don't\n         // call Connected() for feeler connections since they don't have\n-        // fSuccessfullyConnected set.\n+        // fSuccessfullyConnected set. Also don't call Connected() for private broadcast\n+        // connections since they could leak information in addrman.\n         m_addrman.Connected(node.addr);\n     }\n     {\n         LOCK(m_headers_presync_mutex);\n         m_headers_presync_stats.erase(nodeid);\n     }\n+    // This is done when we get a PONG from the peer. Repeat here too in case we never receive a PONG.\n+    if (node.IsPrivateBroadcastConn() &&\n+        m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false)) {\n+\n+        LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                      BCLog::Level::Info,\n+                      \"Never got a PONG (the transaction will probably not \"",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 141,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e200bcbd4b1cef64bd70cc1b61bf7277e0dad066",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This log could be a bit more generic, especially in combination with the last commit - no need to mention PONG:\r\nIt happens pretty regularly that a node never answers our INV (because it is not the first one we connected to and they got it already from someone else first) we never sent a ping and the error message makes no sense.",
      "created_at": "2025-04-08T21:49:30Z",
      "updated_at": "2025-04-08T22:07:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2034084572",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2034084572"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1695,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035012202",
      "pull_request_review_id": 2752901260,
      "id": 2035012202,
      "node_id": "PRRC_kwDOABII5855S9Jq",
      "diff_hunk": "@@ -283,6 +283,7 @@ add_library(bitcoin_node STATIC EXCLUDE_FROM_ALL\n   policy/rbf.cpp\n   policy/settings.cpp",
      "path": "src/CMakeLists.txt",
      "position": 2,
      "original_position": 2,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "14ebee8ea29e555caaeaa4e0a935f0897390bdfb",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "_Continuing discussion from PR main thread to a dedicated thread here. Main thread discussions get intermixed with other discussions and are hard to follow._\r\n\r\nAt https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2295439986 @gmaxwell wrote:\r\n> Private broadcast can also reduce privacy. I think the weakness is a tossup vs the obvious alternative (run ordinary connections exclusively over Tor) so it's not a reason to not implement the feature, but it's worth discussing in order to understand the limits and see if mitigations are possible.\r\n>\r\n> The issue on my mind is that Tor has little to no resistance to traffic analysis. The small amount of resistance it has is by quantizing messages into fixed size cells. Otherwise, it essentially doesn't have much resistance because analysis resistance is incompatible with achieving low latency. Too bad for us because for txn broadcast latency is fairly irrelevant.\r\n>\r\n> We assume the attacker is able to passively monitor the internet connection of our victim. Lets also assume their non-blocksonly Bitcoin P2P connection is encrypted as is increasingly so (and it's a ~6 line change to add an option to make peer v2-only, which I assume someone will propose once they feel v2 listeners are widespread enough).\r\n>\r\n> The attacker is attempting to confirm that the monitored peer is the originator of specific transactions on the network, or alternatively is looking at all the transactions and try to determine which are likely authored by the monitored peer.\r\n>\r\n> Against this threat model, I think this PR creates a substantial weakness compared to not having it: any time the user transacts they will create a predictable amount of traffic to tor which is a somewhat a function of the size of the transaction. There may be enough noise that a single transaction isn't enough alone, but someone who transacted a couple times a day would likely be identifiable.\r\n>\r\n> Of course, this isn't the threat model this PR really hopes to address. This PR is strong against a threat model where the attacker cannot traffic analyze anyone but instead runs many bitcoin \"nodes\" and then is able to correlate incoming (decrypted) traffic to originating IP address. Of the two threat models I think this latter one is a greater concern.\r\n>\r\n> But, perhaps if there were padding traffic and a tiny amount of broadcast of third-party txn as if they were private broadcast then the weakness under the traffic analysis case would be improved to be no worse than you'd have from just running ordinary P2P across tor?\r\n\r\nAt https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2296543993 @instagibbs wrote:\r\n> > But, perhaps if there were padding traffic and a tiny amount of broadcast of third-party txn as if they were private broadcast then the weakness under the traffic analysis case would be improved to be no worse than you'd have from just running ordinary P2P across tor?\r\n>\r\n> Assuming a switch to INV-based private relay, you might need to take some care to make sure the decoy tx gets requested at high rates, since the real private relay will tend to result in the getadata for the tx?\r\n\r\nAt https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2303324108 @gmaxwell wrote:\r\n> It might be possible to conceal from a traffic analysis perspective what if anything was requested using padding.\r\n\r\nAt https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2788608403 @w0xlt wrote:\r\n> Would also broadcasting some random transactions through this same mechanism (also randomly) address the concern mentioned by @gmaxwell in https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2295439986 ?",
      "created_at": "2025-04-09T10:00:14Z",
      "updated_at": "2025-04-09T10:00:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035012202",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035012202"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 245,
      "original_line": 245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035018416",
      "pull_request_review_id": 2752910380,
      "id": 2035018416,
      "node_id": "PRRC_kwDOABII5855S-qw",
      "diff_hunk": "@@ -283,6 +283,7 @@ add_library(bitcoin_node STATIC EXCLUDE_FROM_ALL\n   policy/rbf.cpp\n   policy/settings.cpp",
      "path": "src/CMakeLists.txt",
      "position": 2,
      "original_position": 2,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "14ebee8ea29e555caaeaa4e0a935f0897390bdfb",
      "in_reply_to_id": 2035012202,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "@w0xlt, I do not think broadcasting existent transactions as decoy would bring us anything. A few considerations about the traffic analysis scenario:\r\n\r\n* The current \"broadcast to everybody\" is creating even more predictable traffic pattern.\r\n\r\n* There are at least a few new transactions per second on the network.\r\n\r\n* IMO padding does not belong to application level. Tor already has padding, search for \"padding\" in [tor(1)](https://manpages.ubuntu.com/manpages/focal/man1/tor.1.html).\r\n\r\n* If we do `INV` and wait for `GETDATA`, then the decoy broadcasts will not work because the recipient will not ask for the transaction because they already have it. We can force this to send the recipient a bogus, new transaction id, which they do not know for sure, then they and will send us `GETDATA`. Then we can feed the recipient any bogus transaction that does not match the id and close the connection. That seems too much of an overkill to me, or even an abuse, for little to no gain.\r\n",
      "created_at": "2025-04-09T10:03:12Z",
      "updated_at": "2025-04-09T10:03:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035018416",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035018416"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 245,
      "original_line": 245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035182312",
      "pull_request_review_id": 2753167507,
      "id": 2035182312,
      "node_id": "PRRC_kwDOABII5855Tmro",
      "diff_hunk": "@@ -283,6 +283,7 @@ add_library(bitcoin_node STATIC EXCLUDE_FROM_ALL\n   policy/rbf.cpp\n   policy/settings.cpp",
      "path": "src/CMakeLists.txt",
      "position": 2,
      "original_position": 2,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "14ebee8ea29e555caaeaa4e0a935f0897390bdfb",
      "in_reply_to_id": 2035012202,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Is there a threat model where an attacker is sophisticated enough to passively analyze traffic but not sophisticated enough to monitor originating invs?",
      "created_at": "2025-04-09T11:38:46Z",
      "updated_at": "2025-04-09T11:38:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035182312",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035182312"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 245,
      "original_line": 245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035354362",
      "pull_request_review_id": 2753453195,
      "id": 2035354362,
      "node_id": "PRRC_kwDOABII5855UQr6",
      "diff_hunk": "@@ -1136,7 +1147,97 @@ class CConnman\n     bool GetNetworkActive() const { return fNetworkActive; };\n     bool GetUseAddrmanOutgoing() const { return m_use_addrman_outgoing; };\n     void SetNetworkActive(bool active);\n-    void OpenNetworkConnection(const CAddress& addrConnect, bool fCountFailure, CSemaphoreGrant&& grant_outbound, const char* strDest, ConnectionType conn_type, bool use_v2transport) EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\n+\n+    /**\n+     * Open a new P2P connection and initialize it with the PeerManager at `m_msgproc`.\n+     * @param[in] addrConnect Address to connect to, if `strDest` is `nullptr`.\n+     * @param[in] fCountFailure Increment the number of connection attempts to this address in Addrman.\n+     * @param[in] grant_outbound Take ownership of this grant, to be released later when the connection is closed.\n+     * @param[in] strDest Address to resolve and connect to.\n+     * @param[in] conn_type Type of the connection to open, must not be `ConnectionType::INBOUND`.\n+     * @param[in] use_v2transport Use P2P encryption, (aka V2 transport, BIP324).\n+     * @param[in] proxy Optional proxy to use and override normal proxy selection.\n+     * @retval true The connection was opened successfully.\n+     * @retval false The connection attempt failed.\n+     */\n+    bool OpenNetworkConnection(const CAddress& addrConnect,\n+                               bool fCountFailure,\n+                               CSemaphoreGrant&& grant_outbound,\n+                               const char* strDest,\n+                               ConnectionType conn_type,\n+                               bool use_v2transport,\n+                               std::optional<Proxy> proxy = std::nullopt)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\n+\n+    /// Group of private broadcast related members.\n+    class PrivateBroadcast\n+    {\n+    public:\n+        /**\n+         * Remember if we ever established at least one outbound connection to a\n+         * Tor peer, including sending and receiving P2P messages. If this is\n+         * true then the Tor proxy indeed works and is a proxy to the Tor network,\n+         * not a misconfigured ordinary SOCKS5 proxy as -proxy or -onion. If that\n+         * is the case, then we assume that connecting to an IPv4 or IPv6 address\n+         * via that proxy will be done trough the Tor network and a Tor exit node.\n+         */\n+        std::atomic_bool m_outbound_tor_ok_at_least_once{false};\n+\n+        /**\n+         * Check if private broadcast can be done to IPv4 or IPv6 peers and if so via which proxy.\n+         * If private broadcast connections should not be opened to IPv4 or IPv6, then this will\n+         * return an empty optional.\n+         */\n+        std::optional<Proxy> ProxyForIPv4or6() const;",
      "path": "src/net.h",
      "position": 1,
      "original_position": 99,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "14ebee8ea29e555caaeaa4e0a935f0897390bdfb",
      "in_reply_to_id": 2033482630,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Right, done.",
      "created_at": "2025-04-09T13:18:20Z",
      "updated_at": "2025-04-09T13:18:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035354362",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035354362"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1191,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035355670",
      "pull_request_review_id": 2753455389,
      "id": 2035355670,
      "node_id": "PRRC_kwDOABII5855URAW",
      "diff_hunk": "@@ -3051,6 +3054,72 @@ bool CConnman::OpenNetworkConnection(const CAddress& addrConnect,\n     return true;\n }\n \n+std::optional<Proxy> CConnman::PrivateBroadcast::ProxyForIPv4or6() const\n+{\n+    Proxy tor_proxy;\n+    if (m_outbound_tor_ok_at_least_once.load() && GetProxy(NET_ONION, tor_proxy)) {\n+        return tor_proxy;\n+    }\n+    return std::nullopt;\n+}\n+\n+std::optional<Network> CConnman::PrivateBroadcast::PickNetwork(std::optional<Proxy>& proxy) const\n+{\n+    prevector<4, Network> nets;\n+    std::optional<Proxy> clearnet_proxy;\n+    if (g_reachable_nets.Contains(NET_ONION)) {\n+        nets.push_back(NET_ONION);\n+\n+        clearnet_proxy = ProxyForIPv4or6();\n+        if (clearnet_proxy.has_value()) {\n+            nets.push_back(NET_IPV4);",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 34,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "530c186eecbf1a8e4f5525a18dcdd72d6c737f40",
      "in_reply_to_id": 2033983639,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2025-04-09T13:18:59Z",
      "updated_at": "2025-04-09T13:19:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035355670",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035355670"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3075,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035371406",
      "pull_request_review_id": 2753481276,
      "id": 2035371406,
      "node_id": "PRRC_kwDOABII5855UU2O",
      "diff_hunk": "@@ -1627,16 +1675,28 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n     }\n     } // cs_main\n     if (node.fSuccessfullyConnected &&\n-        !node.IsBlockOnlyConn() && !node.IsInboundConn()) {\n+        !node.IsBlockOnlyConn() && !node.IsPrivateBroadcastConn() && !node.IsInboundConn()) {\n         // Only change visible addrman state for full outbound peers.  We don't\n         // call Connected() for feeler connections since they don't have\n-        // fSuccessfullyConnected set.\n+        // fSuccessfullyConnected set. Also don't call Connected() for private broadcast\n+        // connections since they could leak information in addrman.\n         m_addrman.Connected(node.addr);\n     }\n     {\n         LOCK(m_headers_presync_mutex);\n         m_headers_presync_stats.erase(nodeid);\n     }\n+    // This is done when we get a PONG from the peer. Repeat here too in case we never receive a PONG.\n+    if (node.IsPrivateBroadcastConn() &&\n+        m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false)) {\n+\n+        LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                      BCLog::Level::Info,\n+                      \"Never got a PONG (the transaction will probably not \"",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 141,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "e200bcbd4b1cef64bd70cc1b61bf7277e0dad066",
      "in_reply_to_id": 2034084572,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I agree. Further, this log is kind of redundant with the message that is logged earlier when `PRIVATE_BROADCAST_MAX_CONNECTION_LIFETIME` is exceeded:\r\n\r\n> Disconnecting: did not complete the transaction send within %d seconds, peer=%d%s\r\n\r\nand later:\r\n\r\n> Never got a PONG (the transaction will probably not reach the network), disconnected, peer=%d%s\r\n\r\nbasically, the second message does not bring new information and both will be logged one after another. So I removed the second message. Then `FinishBroadcast()` does not need to return `bool`, so I changed it to `void`, minor simplification.",
      "created_at": "2025-04-09T13:25:05Z",
      "updated_at": "2025-04-09T13:25:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035371406",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035371406"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1695,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035402138",
      "pull_request_review_id": 2753531683,
      "id": 2035402138,
      "node_id": "PRRC_kwDOABII5855UcWa",
      "diff_hunk": "@@ -283,6 +283,7 @@ add_library(bitcoin_node STATIC EXCLUDE_FROM_ALL\n   policy/rbf.cpp\n   policy/settings.cpp",
      "path": "src/CMakeLists.txt",
      "position": 2,
      "original_position": 2,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "14ebee8ea29e555caaeaa4e0a935f0897390bdfb",
      "in_reply_to_id": 2035012202,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, I think there are two different aspects here and we could have one without the other:\r\n\r\n1. Traffic monitoring, most easily done by the node's ISP.\r\n2. Near sybil, also through the Tor network, to monitor P2P traffic of the node.",
      "created_at": "2025-04-09T13:39:57Z",
      "updated_at": "2025-04-09T13:39:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035402138",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035402138"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 245,
      "original_line": 245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035414972",
      "pull_request_review_id": 2753552427,
      "id": 2035414972,
      "node_id": "PRRC_kwDOABII5855Ufe8",
      "diff_hunk": "@@ -283,6 +283,7 @@ add_library(bitcoin_node STATIC EXCLUDE_FROM_ALL\n   policy/rbf.cpp\n   policy/settings.cpp",
      "path": "src/CMakeLists.txt",
      "position": 2,
      "original_position": 2,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "14ebee8ea29e555caaeaa4e0a935f0897390bdfb",
      "in_reply_to_id": 2035012202,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In that case, not doing `INV` but pushing `TX` and sending recently received decoy txs like that once in a while as @w0xlt suggests defeats #1. This patch defeats #2.\r\n\r\nIn any case, adding something like that should be done in a follow-up IMO.",
      "created_at": "2025-04-09T13:46:14Z",
      "updated_at": "2025-04-09T15:15:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035414972",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035414972"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 245,
      "original_line": 245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035643498",
      "pull_request_review_id": 2753934046,
      "id": 2035643498,
      "node_id": "PRRC_kwDOABII5855VXRq",
      "diff_hunk": "@@ -5471,6 +5607,23 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n \n     const auto current_time{GetTime<std::chrono::microseconds>()};\n \n+    // The logic below does not apply to private broadcast peers, so skip it.\n+    // Also in CConnman::PushMessage() we make sure that unwanted messages are\n+    // not sent. This here is just an optimization.\n+    if (pto->IsPrivateBroadcastConn()) {\n+        if (pto->m_connected + PRIVATE_BROADCAST_MAX_CONNECTION_LIFETIME < current_time) {",
      "path": "src/net_processing.cpp",
      "position": 626,
      "original_position": 293,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "33f2770bc80316e65eb838bb63d3f38ab53dd27c",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "After thinking a bit more about the issue I mentioned before: I think we could also disconnect here if we have completed all outstanding broadcasts (we received any txn back from the network), no need to wait for the timeout then.\r\nThis is especially relevant if we do INV/GETDATA:\r\nBecause of the existing race between network propagation starting from the first peer / connection making to the second / third peer it occurs frequently that the later peers don't answer our INV because they already know about the transaction - in that case, it is likely we also will have received it from our other peers, so there is no need to keep the connection open for 180s.\r\n\r\nI guess it could also make sense in the case of ping timeouts without the last commit, although those are much less likely since they wouldn't occur naturally.\r\n\r\nAlthough on second thought I do wonder if that could be used for deanomyzation by a skilled attacker who knows when exactly each nodes receives each tx, so maybe it's safer to just wait out the 180s?",
      "created_at": "2025-04-09T15:38:30Z",
      "updated_at": "2025-04-09T15:43:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035643498",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035643498"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5756,
      "original_line": 5756,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035693786",
      "pull_request_review_id": 2754017763,
      "id": 2035693786,
      "node_id": "PRRC_kwDOABII5855Vjja",
      "diff_hunk": "@@ -5471,6 +5607,23 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n \n     const auto current_time{GetTime<std::chrono::microseconds>()};\n \n+    // The logic below does not apply to private broadcast peers, so skip it.\n+    // Also in CConnman::PushMessage() we make sure that unwanted messages are\n+    // not sent. This here is just an optimization.\n+    if (pto->IsPrivateBroadcastConn()) {\n+        if (pto->m_connected + PRIVATE_BROADCAST_MAX_CONNECTION_LIFETIME < current_time) {",
      "path": "src/net_processing.cpp",
      "position": 626,
      "original_position": 293,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "33f2770bc80316e65eb838bb63d3f38ab53dd27c",
      "in_reply_to_id": 2035643498,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Hmm, if this is a problem, it is probably also an issue without the suggested change of disconnecting early:\r\n\r\nWe only send the inv out if we haven't called `Remove()` : So the second peer we connect to (assuming it's evil and has network-monitoring abilities) could delay the VERACK a little bit, and depending on the timing when we received the tx from other peers due to the first peer we either send out an inv to them or don't. I'm not sure how viable this is in practice (you'd probably need a lot of transactions to gather statistics), but at least in theory it's a possible de-anonymization attack.",
      "created_at": "2025-04-09T16:07:37Z",
      "updated_at": "2025-04-09T16:07:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035693786",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035693786"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5756,
      "original_line": 5756,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035722743",
      "pull_request_review_id": 2754064797,
      "id": 2035722743,
      "node_id": "PRRC_kwDOABII5855Vqn3",
      "diff_hunk": "@@ -5471,6 +5607,23 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n \n     const auto current_time{GetTime<std::chrono::microseconds>()};\n \n+    // The logic below does not apply to private broadcast peers, so skip it.\n+    // Also in CConnman::PushMessage() we make sure that unwanted messages are\n+    // not sent. This here is just an optimization.\n+    if (pto->IsPrivateBroadcastConn()) {\n+        if (pto->m_connected + PRIVATE_BROADCAST_MAX_CONNECTION_LIFETIME < current_time) {",
      "path": "src/net_processing.cpp",
      "position": 626,
      "original_position": 293,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "33f2770bc80316e65eb838bb63d3f38ab53dd27c",
      "in_reply_to_id": 2035643498,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> we either send out an inv to them or don't.\r\n\r\nBut if we don't send out the inv, how will evil peer know it was because we received a specific tx vs any other?",
      "created_at": "2025-04-09T16:23:47Z",
      "updated_at": "2025-04-09T16:23:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035722743",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035722743"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5756,
      "original_line": 5756,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035775101",
      "pull_request_review_id": 2754151634,
      "id": 2035775101,
      "node_id": "PRRC_kwDOABII5855V3Z9",
      "diff_hunk": "@@ -5471,6 +5607,23 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n \n     const auto current_time{GetTime<std::chrono::microseconds>()};\n \n+    // The logic below does not apply to private broadcast peers, so skip it.\n+    // Also in CConnman::PushMessage() we make sure that unwanted messages are\n+    // not sent. This here is just an optimization.\n+    if (pto->IsPrivateBroadcastConn()) {\n+        if (pto->m_connected + PRIVATE_BROADCAST_MAX_CONNECTION_LIFETIME < current_time) {",
      "path": "src/net_processing.cpp",
      "position": 626,
      "original_position": 293,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "33f2770bc80316e65eb838bb63d3f38ab53dd27c",
      "in_reply_to_id": 2035643498,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This code here in `SendMessages()` in the message handler thread only sets `fDisconnect`. So, after the transaction is received back from some peer we have to cycle through some other peers in the message handler thread to get to this one to set the `fDisconnect` flag. Then the socket handler thread has to cycle through some further peers to call `DisconnectNodes()` which will actually close the socket. That said, we wouldn't disconnect immediately after receiving the transaction. I did not measure how much is the delay.\r\n\r\nSuch a deanon attack scenario looks far fetched to me because of the delay + the attacker must have network monitoring capabilities on the node, e.g. their ISP + near sybil the node, also via the Tor network, so that the node happens to select the attacker as a private broadcast recipient. We could skip a few loops here in `SendMessages()` or in `DisconnectNodes()` before closing the socket to magnify the existent delay. Looks like an overkill to me though.",
      "created_at": "2025-04-09T16:56:28Z",
      "updated_at": "2025-04-09T16:56:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035775101",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035775101"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5756,
      "original_line": 5756,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035781049",
      "pull_request_review_id": 2754160991,
      "id": 2035781049,
      "node_id": "PRRC_kwDOABII5855V425",
      "diff_hunk": "@@ -5471,6 +5607,23 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n \n     const auto current_time{GetTime<std::chrono::microseconds>()};\n \n+    // The logic below does not apply to private broadcast peers, so skip it.\n+    // Also in CConnman::PushMessage() we make sure that unwanted messages are\n+    // not sent. This here is just an optimization.\n+    if (pto->IsPrivateBroadcastConn()) {\n+        if (pto->m_connected + PRIVATE_BROADCAST_MAX_CONNECTION_LIFETIME < current_time) {",
      "path": "src/net_processing.cpp",
      "position": 626,
      "original_position": 293,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "33f2770bc80316e65eb838bb63d3f38ab53dd27c",
      "in_reply_to_id": 2035643498,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> But if we don't send out the inv, how will evil peer know it was because we received a specific tx vs any other?\r\n\r\nYes, it's harder if we don't send out the inv (they could guess among current new txns if there isn't too much traffic?), but there is also some information if we do send it out:\r\nIf they finish the handshake for a private tx just at the time where one half of the public network knows about a tx, and the other half doesn't (and they know which nodes belong to which half), and then they receive an INV from us on the private conn, the attacker could conclude that our public identity is not in the first half.\r\nI'm just saying that this connects our normal node activity a little bit with the private transaction via timing, not that there is a feasible attack making use of that information.",
      "created_at": "2025-04-09T17:00:17Z",
      "updated_at": "2025-04-09T17:00:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035781049",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035781049"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5756,
      "original_line": 5756,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035867449",
      "pull_request_review_id": 2754301225,
      "id": 2035867449,
      "node_id": "PRRC_kwDOABII5855WN85",
      "diff_hunk": "@@ -5471,6 +5607,23 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n \n     const auto current_time{GetTime<std::chrono::microseconds>()};\n \n+    // The logic below does not apply to private broadcast peers, so skip it.\n+    // Also in CConnman::PushMessage() we make sure that unwanted messages are\n+    // not sent. This here is just an optimization.\n+    if (pto->IsPrivateBroadcastConn()) {\n+        if (pto->m_connected + PRIVATE_BROADCAST_MAX_CONNECTION_LIFETIME < current_time) {",
      "path": "src/net_processing.cpp",
      "position": 626,
      "original_position": 293,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "33f2770bc80316e65eb838bb63d3f38ab53dd27c",
      "in_reply_to_id": 2035643498,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In this scenario the evil peer would also have to be the first peer or somehow know that the tx was sent initially to the first peer via private broadcast. Otherwise they would need to be tracking the network propagation of all txs all the time. They would have to finish these private broadcast handshakes whenever they get them at the moment of a specific tx propagating to exactly half the network and hope that the inv they receive is of that specific tx.\r\n\r\nDecoy txs being sent periodically would help here too.\r\n",
      "created_at": "2025-04-09T17:59:46Z",
      "updated_at": "2025-04-09T17:59:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2035867449",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2035867449"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5756,
      "original_line": 5756,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2036865206",
      "pull_request_review_id": 2755909339,
      "id": 2036865206,
      "node_id": "PRRC_kwDOABII5855aBi2",
      "diff_hunk": "@@ -283,6 +283,7 @@ add_library(bitcoin_node STATIC EXCLUDE_FROM_ALL\n   policy/rbf.cpp\n   policy/settings.cpp",
      "path": "src/CMakeLists.txt",
      "position": 2,
      "original_position": 2,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "14ebee8ea29e555caaeaa4e0a935f0897390bdfb",
      "in_reply_to_id": 2035012202,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Added \"Consider periodically sending transactions that did not originate from the node as decoy\" to \"Further extensions\" in the PR description.",
      "created_at": "2025-04-10T08:58:36Z",
      "updated_at": "2025-04-10T08:58:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2036865206",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2036865206"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 245,
      "original_line": 245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2036960560",
      "pull_request_review_id": 2756062155,
      "id": 2036960560,
      "node_id": "PRRC_kwDOABII5855aY0w",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2032895434,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "@mzumsande, what do you think about the above patch? Check mempool acceptance one more time, before sending the transaction?",
      "created_at": "2025-04-10T09:45:18Z",
      "updated_at": "2025-04-10T09:45:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2036960560",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2036960560"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037527330",
      "pull_request_review_id": 2757014589,
      "id": 2037527330,
      "node_id": "PRRC_kwDOABII5855cjMi",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2032895434,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Hmm I'm now of the view that we should not send INV but only push the TX, and always send 3 times regardless if the tx is received in our mempool or is otherwise invalid. We should also send 3 times when reattempting.\r\n- Traffic analysis will be identical for any private broadcast, vs different patterns depending on when we receive a tx or our peer receives it.\r\n- Any possible timing analysis based on delaying the verack is negated.\r\n- Connections will not timeout waiting for getdata.\r\n- Decoy txs will be easier to implement. We can just randomly schedule one of the more recent txs we saw as a private broadcast and it will look identical to traffic analysis.",
      "created_at": "2025-04-10T14:12:32Z",
      "updated_at": "2025-04-10T14:12:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2037527330",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037527330"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037534789",
      "pull_request_review_id": 2757026423,
      "id": 2037534789,
      "node_id": "PRRC_kwDOABII5855clBF",
      "diff_hunk": "@@ -283,6 +283,7 @@ add_library(bitcoin_node STATIC EXCLUDE_FROM_ALL\n   policy/rbf.cpp\n   policy/settings.cpp",
      "path": "src/CMakeLists.txt",
      "position": 2,
      "original_position": 2,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "14ebee8ea29e555caaeaa4e0a935f0897390bdfb",
      "in_reply_to_id": 2035012202,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Another aspect of decoy txs is a network observer correlating txs into wallets that use private broadcast. An attacker running many nodes accepting private broadcast connections would have a high likelihood of being selected for a private broadcast and could correlate private broadcast users' txs. If there is initially few users who use private broadcast, then these users could be grouped together.\r\nBy periodically sending decoy txs, the effectiveness of this is reduced.",
      "created_at": "2025-04-10T14:15:53Z",
      "updated_at": "2025-04-10T14:15:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2037534789",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037534789"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 245,
      "original_line": 245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037630912",
      "pull_request_review_id": 2757192243,
      "id": 2037630912,
      "node_id": "PRRC_kwDOABII5855c8fA",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2032895434,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Any possible timing analysis based on delaying the verack is negated.\r\n\r\nWhy? The peer can still delay the verack and then instead of checking for an inv they check whether they get sent a tx (we didn't receive it yet from someone else) or not (we removed it from the `m_tx_for_private_broadcast` map in the meantime) - I don't see any difference there.\r\n\r\n> @mzumsande, what do you think about the above patch? Check mempool acceptance one more time, before sending the transaction?\r\n\r\nHmm, it might be more helpful for the user if we didn't accept the tx in the first place so that they can see the reason in the `sendrawtransaction` rpc response and are not confused why the tx is never sent - would it be hard to implement a check in `BroadcastTransaction` that the submitted tx doesn't conflict with any other current private txns?",
      "created_at": "2025-04-10T14:58:49Z",
      "updated_at": "2025-04-10T14:59:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2037630912",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037630912"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037770624",
      "pull_request_review_id": 2757418719,
      "id": 2037770624,
      "node_id": "PRRC_kwDOABII5855demA",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2032895434,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Why? The peer can still delay the verack and then instead of checking for an inv they check whether they get sent a tx (we didn't receive it yet from someone else) or not (we removed it from the m_tx_for_private_broadcast map in the meantime)\r\n\r\nMy suggestion was\r\n\r\n> always send 3 times regardless if the tx is received in our mempool or is otherwise invalid",
      "created_at": "2025-04-10T16:08:55Z",
      "updated_at": "2025-04-10T16:08:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2037770624",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037770624"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037796995",
      "pull_request_review_id": 2757462997,
      "id": 2037796995,
      "node_id": "PRRC_kwDOABII5855dlCD",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2032895434,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "oh, sorry, I missed that part! I don't like that sending tx without invs would kill all attempts to restrict unrequested transactions for good. Even if #30572 was closed, I wouldn't say that the idea, which has been floating around for a long time, is dead.",
      "created_at": "2025-04-10T16:20:11Z",
      "updated_at": "2025-04-10T16:35:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2037796995",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037796995"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037824475",
      "pull_request_review_id": 2757508150,
      "id": 2037824475,
      "node_id": "PRRC_kwDOABII5855drvb",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2032895434,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Ok, it's unfortunate that it will make decoy txs less effective at camouflaging traffic analysis since the first private broadcast will likely not get a GETDATA response. But, better to keep the option open to restrict unrequested txs.\r\n@vasild what do you think of squashing the fixup commit?\r\n\r\n> would it be hard to implement a check in BroadcastTransaction that the submitted tx doesn't conflict with any other current private txns?\r\n\r\nCould this be done in a follow-up?",
      "created_at": "2025-04-10T16:33:37Z",
      "updated_at": "2025-04-10T16:33:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2037824475",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037824475"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037832070",
      "pull_request_review_id": 2757521200,
      "id": 2037832070,
      "node_id": "PRRC_kwDOABII5855dtmG",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2032895434,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> it might be more helpful for the user if we didn't accept the tx in the first place so that they can see the reason in the sendrawtransaction rpc response and are not confused why the tx is never sent - would it be hard to implement a check in BroadcastTransaction that the submitted tx doesn't conflict with any other current private txns?\r\n\r\nThis is already done:\r\n\r\n```\r\n$ bitcoin-cli sendrawtransaction ...\r\nerror code: -25\r\nerror message:\r\nbad-txns-inputs-missingorspent\r\n```\r\nThe check is in `BroadcastTransaction()` (diff from this PR):\r\n\r\n```diff\r\n-            if (max_tx_fee > 0) {\r\n+            if (max_tx_fee > 0 || broadcast_method == NO_MEMPOOL_PRIVATE_BROADCAST) {\r\n                 // First, call ATMP with test_accept and check the fee. If ATMP\r\n                 // fails here, return error immediately.\r\n                 const MempoolAcceptResult result = node.chainman->ProcessTransaction(tx, /*test_accept=*/ true);\r\n```\r\n\r\nThe [above patch](https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2033762834) which I asked for checks mempool acceptance **one more time**, before sending the transaction.",
      "created_at": "2025-04-10T16:36:38Z",
      "updated_at": "2025-04-10T16:36:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2037832070",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037832070"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037865938",
      "pull_request_review_id": 2757581896,
      "id": 2037865938,
      "node_id": "PRRC_kwDOABII5855d13S",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2032895434,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> @vasild what do you think of squashing the fixup commit?\r\n\r\nWould you both prefer the `INV` way? Then maybe it is time for a squash...",
      "created_at": "2025-04-10T16:50:45Z",
      "updated_at": "2025-04-10T16:50:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2037865938",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037865938"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037888422",
      "pull_request_review_id": 2757622326,
      "id": 2037888422,
      "node_id": "PRRC_kwDOABII5855d7Wm",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2032895434,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, it will always be possible to remove the INV/GETDATA later, but going the other way if we want to restrict unrequested txs in the future would be much more difficult.",
      "created_at": "2025-04-10T17:05:36Z",
      "updated_at": "2025-04-10T17:05:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2037888422",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2037888422"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2038796641",
      "pull_request_review_id": 2759139411,
      "id": 2038796641,
      "node_id": "PRRC_kwDOABII5855hZFh",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2032895434,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Squashed the `INV` fixup commit: https://github.com/bitcoin/bitcoin/pull/29415#issuecomment-2795829514\r\n\r\n@andrewtoth, is it the case that you no longer favor the above patch to check one more time mempool acceptance because it would be better to just try to send 3 times, if possible?",
      "created_at": "2025-04-11T04:54:10Z",
      "updated_at": "2025-04-11T04:54:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2038796641",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2038796641"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2039051751",
      "pull_request_review_id": 2759537626,
      "id": 2039051751,
      "node_id": "PRRC_kwDOABII5855iXXn",
      "diff_hunk": "@@ -5471,6 +5607,23 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n \n     const auto current_time{GetTime<std::chrono::microseconds>()};\n \n+    // The logic below does not apply to private broadcast peers, so skip it.\n+    // Also in CConnman::PushMessage() we make sure that unwanted messages are\n+    // not sent. This here is just an optimization.\n+    if (pto->IsPrivateBroadcastConn()) {\n+        if (pto->m_connected + PRIVATE_BROADCAST_MAX_CONNECTION_LIFETIME < current_time) {",
      "path": "src/net_processing.cpp",
      "position": 626,
      "original_position": 293,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "33f2770bc80316e65eb838bb63d3f38ab53dd27c",
      "in_reply_to_id": 2035643498,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "@mzumsande, is this what you mean (first message in this thread):\r\n\r\n```diff\r\n     if (pto->IsPrivateBroadcastConn()) {\r\n         if (pto->m_connected + PRIVATE_BROADCAST_MAX_CONNECTION_LIFETIME < current_time) {\r\n             LogPrintLevel(\r\n                 BCLog::PRIVATE_BROADCAST,\r\n                 BCLog::Level::Info,\r\n                 \"Disconnecting: did not complete the transaction send within %d seconds, peer=%d%s\",\r\n                 std::chrono::duration_cast<std::chrono::seconds>(PRIVATE_BROADCAST_MAX_CONNECTION_LIFETIME).count(),\r\n                 pto->GetId(),\r\n                 pto->LogIP(fLogIPs));\r\n             pto->fDisconnect = true;\r\n+        } else if (!m_tx_for_private_broadcast.GetTxForBroadcast()) {\r\n+            LogDebug(\r\n+                BCLog::PRIVATE_BROADCAST,\r\n+                \"Disconnecting: no more transactions for private broadcast (connected in vain), peer=%d%s\",\r\n+                pto->GetId(),\r\n+                pto->LogIP(fLogIPs));\r\n+            pto->fDisconnect = true;\r\n         }\r\n         return true;\r\n     }\r\n```\r\n\r\n?",
      "created_at": "2025-04-11T08:21:16Z",
      "updated_at": "2025-04-11T08:21:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2039051751",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2039051751"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5756,
      "original_line": 5756,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2039539173",
      "pull_request_review_id": 2760325919,
      "id": 2039539173,
      "node_id": "PRRC_kwDOABII5855kOXl",
      "diff_hunk": "@@ -1543,6 +1601,13 @@ void PeerManagerImpl::InitializeNode(const CNode& node, ServiceFlags our_service\n     }\n }\n \n+/** Calculate the delta time after which to run the next transactions broadcast. */\n+static std::chrono::milliseconds NextTxBroadcast()\n+{\n+    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n+    return 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n+}",
      "path": "src/net_processing.cpp",
      "position": 193,
      "original_position": 167,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "cae4c1134d2a55ff5c20c2ce78512b7682f6fa7c",
      "in_reply_to_id": 2032895434,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> @andrewtoth, is it the case that you no longer favor the above patch to check one more time mempool acceptance because it would be better to just try to send 3 times, if possible?\r\n\r\nYes, you can resolve this thread.",
      "created_at": "2025-04-11T13:10:10Z",
      "updated_at": "2025-04-11T13:10:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2039539173",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2039539173"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 1632,
      "original_start_line": 1604,
      "start_side": "RIGHT",
      "line": 1637,
      "original_line": 1637,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2040262171",
      "pull_request_review_id": 2761512756,
      "id": 2040262171,
      "node_id": "PRRC_kwDOABII5855m-4b",
      "diff_hunk": "@@ -5471,6 +5607,23 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n \n     const auto current_time{GetTime<std::chrono::microseconds>()};\n \n+    // The logic below does not apply to private broadcast peers, so skip it.\n+    // Also in CConnman::PushMessage() we make sure that unwanted messages are\n+    // not sent. This here is just an optimization.\n+    if (pto->IsPrivateBroadcastConn()) {\n+        if (pto->m_connected + PRIVATE_BROADCAST_MAX_CONNECTION_LIFETIME < current_time) {",
      "path": "src/net_processing.cpp",
      "position": 626,
      "original_position": 293,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "33f2770bc80316e65eb838bb63d3f38ab53dd27c",
      "in_reply_to_id": 2035643498,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "yes, that was my suggestion (I don't insist on it or anything, I just observed during testing that 180s timeouts happened frequently).",
      "created_at": "2025-04-11T20:29:32Z",
      "updated_at": "2025-04-11T20:29:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2040262171",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2040262171"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5756,
      "original_line": 5756,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2040875380",
      "pull_request_review_id": 2762519927,
      "id": 2040875380,
      "node_id": "PRRC_kwDOABII5855pUl0",
      "diff_hunk": "@@ -655,11 +656,12 @@ class NetinfoRequestHandler : public BaseRequestHandler\n         \"           \\\"in\\\"  - inbound connections are those initiated by the peer\\n\"\n         \"           \\\"out\\\" - outbound connections are those initiated by us\\n\"\n         \"  type     Type of peer connection\\n\"\n-        \"           \\\"full\\\"   - full relay, the default\\n\"\n-        \"           \\\"block\\\"  - block relay; like full relay but does not relay transactions or addresses\\n\"\n-        \"           \\\"manual\\\" - peer we manually added using RPC addnode or the -addnode/-connect config options\\n\"\n-        \"           \\\"feeler\\\" - short-lived connection for testing addresses\\n\"\n-        \"           \\\"addr\\\"   - address fetch; short-lived connection for requesting addresses\\n\"\n+        \"           \\\"full\\\"      - full relay, the default\\n\"\n+        \"           \\\"block\\\"     - block relay; like full relay but does not relay transactions or addresses\\n\"\n+        \"           \\\"manual\\\"    - peer we manually added using RPC addnode or the -addnode/-connect config options\\n\"\n+        \"           \\\"feeler\\\"    - short-lived connection for testing addresses\\n\"\n+        \"           \\\"addr\\\"      - address fetch; short-lived connection for requesting addresses\\n\"\n+        \"           \\\"privat\\\"    - private broadcast; short-lived connection for broadcasting our transactions\\n\"",
      "path": "src/bitcoin-cli.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "c7e4d5cb2bf01d9719702e71c8d6264ee670e988",
      "in_reply_to_id": 1545397035,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Still documented as \"privat\"",
      "created_at": "2025-04-13T02:47:41Z",
      "updated_at": "2025-04-13T02:47:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2040875380",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2040875380"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 691,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2040918702",
      "pull_request_review_id": 2762568536,
      "id": 2040918702,
      "node_id": "PRRC_kwDOABII5855pfKu",
      "diff_hunk": "@@ -655,11 +656,12 @@ class NetinfoRequestHandler : public BaseRequestHandler\n         \"           \\\"in\\\"  - inbound connections are those initiated by the peer\\n\"\n         \"           \\\"out\\\" - outbound connections are those initiated by us\\n\"\n         \"  type     Type of peer connection\\n\"\n-        \"           \\\"full\\\"   - full relay, the default\\n\"\n-        \"           \\\"block\\\"  - block relay; like full relay but does not relay transactions or addresses\\n\"\n-        \"           \\\"manual\\\" - peer we manually added using RPC addnode or the -addnode/-connect config options\\n\"\n-        \"           \\\"feeler\\\" - short-lived connection for testing addresses\\n\"\n-        \"           \\\"addr\\\"   - address fetch; short-lived connection for requesting addresses\\n\"\n+        \"           \\\"full\\\"      - full relay, the default\\n\"\n+        \"           \\\"block\\\"     - block relay; like full relay but does not relay transactions or addresses\\n\"\n+        \"           \\\"manual\\\"    - peer we manually added using RPC addnode or the -addnode/-connect config options\\n\"\n+        \"           \\\"feeler\\\"    - short-lived connection for testing addresses\\n\"\n+        \"           \\\"addr\\\"      - address fetch; short-lived connection for requesting addresses\\n\"\n+        \"           \\\"privat\\\"    - private broadcast; short-lived connection for broadcasting our transactions\\n\"",
      "path": "src/bitcoin-cli.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "c7e4d5cb2bf01d9719702e71c8d6264ee670e988",
      "in_reply_to_id": 1545397035,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Fixed, thanks!",
      "created_at": "2025-04-13T05:09:08Z",
      "updated_at": "2025-04-13T05:09:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2040918702",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2040918702"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 691,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2041159799",
      "pull_request_review_id": 2762792984,
      "id": 2041159799,
      "node_id": "PRRC_kwDOABII5855qaB3",
      "diff_hunk": "@@ -1620,16 +1730,23 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n     }\n     } // cs_main\n     if (node.fSuccessfullyConnected &&\n-        !node.IsBlockOnlyConn() && !node.IsInboundConn()) {\n+        !node.IsBlockOnlyConn() && !node.IsPrivateBroadcastConn() && !node.IsInboundConn()) {\n         // Only change visible addrman state for full outbound peers.  We don't\n         // call Connected() for feeler connections since they don't have\n-        // fSuccessfullyConnected set.\n+        // fSuccessfullyConnected set. Also don't call Connected() for private broadcast\n+        // connections since they could leak information in addrman.\n         m_addrman.Connected(node.addr);\n     }\n     {\n         LOCK(m_headers_presync_mutex);\n         m_headers_presync_stats.erase(nodeid);\n     }\n+    if (node.IsPrivateBroadcastConn()) {\n+        // FinishBroadcast() is called when we get a PONG from the peer which means that the send\n+        // has concluded successfully. Call FinishBroadcast() here as well in case we did not call\n+        // it before (unsuccessful, never concluded with the reception of a PONG).\n+        m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 260,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b8c8ff8968bf902abbc183c249ba8e7df8273a4a",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "There are many reasons why a private broadcast connection would be disconnected.  Many are outside of the checks added in this patch where we do `NumToOpenAdd(1)` before disconnecting (just skim `ProcessMessage`). In these cases, the peer will disconnect silently and we won't open a new one. We should instead track if we actually finish the connection (or time out after sending the INV) and then call `NumToOpenAdd(1)` here if we didn't.\r\nThis was happening frequently in my testing where peers would disconnect before handshake completion and no new connections were initiated.",
      "created_at": "2025-04-13T16:29:49Z",
      "updated_at": "2025-04-13T19:13:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2041159799",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2041159799"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1748,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2041567047",
      "pull_request_review_id": 2763382465,
      "id": 2041567047,
      "node_id": "PRRC_kwDOABII5855r9dH",
      "diff_hunk": "@@ -1620,16 +1730,23 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n     }\n     } // cs_main\n     if (node.fSuccessfullyConnected &&\n-        !node.IsBlockOnlyConn() && !node.IsInboundConn()) {\n+        !node.IsBlockOnlyConn() && !node.IsPrivateBroadcastConn() && !node.IsInboundConn()) {\n         // Only change visible addrman state for full outbound peers.  We don't\n         // call Connected() for feeler connections since they don't have\n-        // fSuccessfullyConnected set.\n+        // fSuccessfullyConnected set. Also don't call Connected() for private broadcast\n+        // connections since they could leak information in addrman.\n         m_addrman.Connected(node.addr);\n     }\n     {\n         LOCK(m_headers_presync_mutex);\n         m_headers_presync_stats.erase(nodeid);\n     }\n+    if (node.IsPrivateBroadcastConn()) {\n+        // FinishBroadcast() is called when we get a PONG from the peer which means that the send\n+        // has concluded successfully. Call FinishBroadcast() here as well in case we did not call\n+        // it before (unsuccessful, never concluded with the reception of a PONG).\n+        m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 260,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b8c8ff8968bf902abbc183c249ba8e7df8273a4a",
      "in_reply_to_id": 2041159799,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I see. Would this resolve it:\r\n\r\n<details>\r\n<summary>[patch] open one more connection at the end of unsuccessful one</summary>\r\n\r\n```diff\r\ndiff --git i/src/net_processing.cpp w/src/net_processing.cpp\r\nindex 6753a7dea0..2129c7d90c 100644\r\n--- i/src/net_processing.cpp\r\n+++ w/src/net_processing.cpp\r\n@@ -1742,13 +1742,15 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\r\n         m_headers_presync_stats.erase(nodeid);\r\n     }\r\n     if (node.IsPrivateBroadcastConn()) {\r\n         // FinishBroadcast() is called when we get a PONG from the peer which means that the send\r\n         // has concluded successfully. Call FinishBroadcast() here as well in case we did not call\r\n         // it before (unsuccessful, never concluded with the reception of a PONG).\r\n-        m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false);\r\n+        if (m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false)) {\r\n+            m_connman.m_private_broadcast.NumToOpenAdd(1);\r\n+        }\r\n     }\r\n     LogDebug(BCLog::NET, \"Cleared nodestate for peer=%d\\n\", nodeid);\r\n     if (node.IsPrivateBroadcastConn()) {\r\n         LogPrintLevel(BCLog::PRIVATE_BROADCAST, BCLog::Level::Debug, \"Cleared nodestate for peer=%d\\n\", nodeid);\r\n     }\r\n }\r\ndiff --git i/src/private_broadcast.cpp w/src/private_broadcast.cpp\r\nindex 8483c61829..25cc69f6a7 100644\r\n--- i/src/private_broadcast.cpp\r\n+++ w/src/private_broadcast.cpp\r\n@@ -69,40 +69,42 @@ std::optional<CTransactionRef> PrivateBroadcast::GetTxPushedToNode(const NodeId&\r\n     if (it_by_txid == m_by_txid.end()) {\r\n         return std::nullopt;\r\n     }\r\n     return it_by_txid->second.tx;\r\n }\r\n \r\n-void PrivateBroadcast::FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n+bool PrivateBroadcast::FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n {\r\n     LOCK(m_mutex);\r\n     auto it = m_by_nodeid.find(nodeid);\r\n     if (it == m_by_nodeid.end()) {\r\n-        return;\r\n+        return false;\r\n     }\r\n     const Txid txid{it->second};\r\n     m_by_nodeid.erase(it);\r\n \r\n     if (!confirmed_by_node) {\r\n-        return;\r\n+        return true;\r\n     }\r\n \r\n     // Update broadcast stats.\r\n \r\n     auto iters = Find(txid);\r\n     if (!iters) {\r\n-        return;\r\n+        return true;\r\n     }\r\n     Priority& priority = iters->by_txid->second.priority;\r\n \r\n     ++priority.num_broadcasted;\r\n     priority.last_broadcasted = NodeClock::now();\r\n \r\n     // Remove and re-add the entry in the m_by_priority map because we have changed the key.\r\n     m_by_priority.erase(iters->by_priority);\r\n     m_by_priority.emplace(priority, txid);\r\n+\r\n+    return true;\r\n }\r\n \r\n std::vector<CTransactionRef> PrivateBroadcast::GetStale() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n {\r\n     LOCK(m_mutex);\r\n     const auto stale_time = NodeClock::now() - STALE_DURATION;\r\ndiff --git i/src/private_broadcast.h w/src/private_broadcast.h\r\nindex 72183be7b2..239f3a7c99 100644\r\n--- i/src/private_broadcast.h\r\n+++ w/src/private_broadcast.h\r\n@@ -61,14 +61,15 @@ public:\r\n      */\r\n     std::optional<CTransactionRef> GetTxPushedToNode(const NodeId& nodeid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\r\n \r\n     /**\r\n      * Mark the end of a broadcast of a transaction. Either successful by receiving a PONG,\r\n      * or unsuccessful by closing the connection to the node without getting PONG.\r\n+     * @return true if the reference by the given node id was removed\r\n      */\r\n-    void FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\r\n+    bool FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\r\n \r\n     /**\r\n      * Get the transactions that have not been broadcast recently.\r\n      */\r\n     std::vector<CTransactionRef> GetStale() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\r\n```\r\n</details>",
      "created_at": "2025-04-14T07:29:25Z",
      "updated_at": "2025-04-14T07:29:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2041567047",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2041567047"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1748,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2041644069",
      "pull_request_review_id": 2763515026,
      "id": 2041644069,
      "node_id": "PRRC_kwDOABII5855sQQl",
      "diff_hunk": "@@ -2055,6 +2064,32 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"\n+                               \"but none of Tor or I2P networks is reachable\"));\n+        }\n+        if (!connOptions.m_use_addrman_outgoing) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"\n+                               \"but -connect is also configured. They are incompatible because the \"\n+                               \"private broadcast needs to open new connections to randomly \"\n+                               \"chosen Tor or I2P peers. Consider using -maxconnections=0 -addnode=... \"\n+                               \"instead\"));\n+        }\n+        if (!proxyRandomize && (g_reachable_nets.Contains(NET_ONION) || onion_may_become_reachable)) {\n+            InitWarning(strprintf(",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 64,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "9c4aad2a0111bf5b29f4613331f19ce994d089dd",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "9c4aad2a: could remove `strprintf`",
      "created_at": "2025-04-14T08:17:48Z",
      "updated_at": "2025-04-23T08:31:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2041644069",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2041644069"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2089,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2041693437",
      "pull_request_review_id": 2763515026,
      "id": 2041693437,
      "node_id": "PRRC_kwDOABII5855scT9",
      "diff_hunk": "@@ -517,7 +517,10 @@ RPCConsole::RPCConsole(interfaces::Node& node, const PlatformStyle *_platformSty\n         tr(\"Outbound Feeler: short-lived, for testing addresses\"),\n         /*: Explanatory text for a short-lived outbound peer connection that is used\n             to request addresses from a peer. */\n-        tr(\"Outbound Address Fetch: short-lived, for soliciting addresses\")};\n+        tr(\"Outbound Address Fetch: short-lived, for soliciting addresses\"),\n+        /*: Explanatory text for a short-lived outbound peer connection that is used\n+            to broadcast privacy-sensitive data (like our transactions). */\n+        tr(\"Private broadcast: short-lived, for broadcasting privacy-sensitive data\")};",
      "path": "src/qt/rpcconsole.cpp",
      "position": 1,
      "original_position": 8,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "030204c5bd1c6ceaab9e37d7d5ee0f157156bc90",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "4e45e9c: micro nit:  could we also mention \"transaction\" here and in `src/rpc/net.cpp`? people looking at help might be confused about what privacy-sensitive data is meant here.",
      "created_at": "2025-04-14T08:47:11Z",
      "updated_at": "2025-04-23T08:31:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2041693437",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2041693437"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 523,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2041903792",
      "pull_request_review_id": 2763515026,
      "id": 2041903792,
      "node_id": "PRRC_kwDOABII5855tPqw",
      "diff_hunk": "@@ -1167,6 +1169,74 @@ class CConnman\n                                std::optional<Proxy> proxy = std::nullopt)\n         EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\n \n+    /// Group of private broadcast related members.\n+    class PrivateBroadcast\n+    {\n+    public:\n+        /**\n+         * Remember if we ever established at least one outbound connection to a\n+         * Tor peer, including sending and receiving P2P messages. If this is\n+         * true then the Tor proxy indeed works and is a proxy to the Tor network,\n+         * not a misconfigured ordinary SOCKS5 proxy as -proxy or -onion. If that\n+         * is the case, then we assume that connecting to an IPv4 or IPv6 address\n+         * via that proxy will be done trough the Tor network and a Tor exit node.",
      "path": "src/net.h",
      "position": 1,
      "original_position": 23,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "3c1bb45fe7ce1995bf8820764c72a5c0675e047e",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "2acd12c: micro nit: s/trough/through.",
      "created_at": "2025-04-14T10:54:15Z",
      "updated_at": "2025-04-23T08:31:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2041903792",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2041903792"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1182,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042154376",
      "pull_request_review_id": 2764371838,
      "id": 2042154376,
      "node_id": "PRRC_kwDOABII5855uM2I",
      "diff_hunk": "@@ -1620,16 +1730,23 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n     }\n     } // cs_main\n     if (node.fSuccessfullyConnected &&\n-        !node.IsBlockOnlyConn() && !node.IsInboundConn()) {\n+        !node.IsBlockOnlyConn() && !node.IsPrivateBroadcastConn() && !node.IsInboundConn()) {\n         // Only change visible addrman state for full outbound peers.  We don't\n         // call Connected() for feeler connections since they don't have\n-        // fSuccessfullyConnected set.\n+        // fSuccessfullyConnected set. Also don't call Connected() for private broadcast\n+        // connections since they could leak information in addrman.\n         m_addrman.Connected(node.addr);\n     }\n     {\n         LOCK(m_headers_presync_mutex);\n         m_headers_presync_stats.erase(nodeid);\n     }\n+    if (node.IsPrivateBroadcastConn()) {\n+        // FinishBroadcast() is called when we get a PONG from the peer which means that the send\n+        // has concluded successfully. Call FinishBroadcast() here as well in case we did not call\n+        // it before (unsuccessful, never concluded with the reception of a PONG).\n+        m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 260,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b8c8ff8968bf902abbc183c249ba8e7df8273a4a",
      "in_reply_to_id": 2041159799,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This patch will always return true because `confirmed_by_node` is statically false, so it will be an endless loop of new connections.\r\n```\r\n     if (!confirmed_by_node) {\r\n-        return;\r\n+        return true;\r\n     }\r\n```\r\n\r\nWhat I suggest is tracking confirmed by node id, and set it to true if we receive the PONG or if we timeout after we already sent an INV. Then here check if the confirmed by node id is false, and if so call `NumToOpenAdd(1)`. Remove all other `NumToOpenAdd(1)` calls.\r\n\r\nRight now we pass confirmed by node id statically as true only when we receive a PONG, and false always when we finalize the node. Instead, track the confirmed by node status and use it in FinishBroadcast only here at FinalizeNode.",
      "created_at": "2025-04-14T13:34:25Z",
      "updated_at": "2025-04-14T13:45:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2042154376",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042154376"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1748,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042187911",
      "pull_request_review_id": 2764421173,
      "id": 2042187911,
      "node_id": "PRRC_kwDOABII5855uVCH",
      "diff_hunk": "@@ -1620,16 +1730,23 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n     }\n     } // cs_main\n     if (node.fSuccessfullyConnected &&\n-        !node.IsBlockOnlyConn() && !node.IsInboundConn()) {\n+        !node.IsBlockOnlyConn() && !node.IsPrivateBroadcastConn() && !node.IsInboundConn()) {\n         // Only change visible addrman state for full outbound peers.  We don't\n         // call Connected() for feeler connections since they don't have\n-        // fSuccessfullyConnected set.\n+        // fSuccessfullyConnected set. Also don't call Connected() for private broadcast\n+        // connections since they could leak information in addrman.\n         m_addrman.Connected(node.addr);\n     }\n     {\n         LOCK(m_headers_presync_mutex);\n         m_headers_presync_stats.erase(nodeid);\n     }\n+    if (node.IsPrivateBroadcastConn()) {\n+        // FinishBroadcast() is called when we get a PONG from the peer which means that the send\n+        // has concluded successfully. Call FinishBroadcast() here as well in case we did not call\n+        // it before (unsuccessful, never concluded with the reception of a PONG).\n+        m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 260,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b8c8ff8968bf902abbc183c249ba8e7df8273a4a",
      "in_reply_to_id": 2041159799,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Oh I see actually this works, because the first return will be false if we already called `FinishBroadcast` after we got the PONG. So yes, this will work.\r\nWe still need to remove all other `NumToOpenAdd` calls, and also call `FinishBroadcast` with true if we timeout after sending the INV.",
      "created_at": "2025-04-14T13:50:25Z",
      "updated_at": "2025-04-14T13:50:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2042187911",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042187911"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1748,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042286270",
      "pull_request_review_id": 2764585093,
      "id": 2042286270,
      "node_id": "PRRC_kwDOABII5855utC-",
      "diff_hunk": "@@ -1620,16 +1730,23 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n     }\n     } // cs_main\n     if (node.fSuccessfullyConnected &&\n-        !node.IsBlockOnlyConn() && !node.IsInboundConn()) {\n+        !node.IsBlockOnlyConn() && !node.IsPrivateBroadcastConn() && !node.IsInboundConn()) {\n         // Only change visible addrman state for full outbound peers.  We don't\n         // call Connected() for feeler connections since they don't have\n-        // fSuccessfullyConnected set.\n+        // fSuccessfullyConnected set. Also don't call Connected() for private broadcast\n+        // connections since they could leak information in addrman.\n         m_addrman.Connected(node.addr);\n     }\n     {\n         LOCK(m_headers_presync_mutex);\n         m_headers_presync_stats.erase(nodeid);\n     }\n+    if (node.IsPrivateBroadcastConn()) {\n+        // FinishBroadcast() is called when we get a PONG from the peer which means that the send\n+        // has concluded successfully. Call FinishBroadcast() here as well in case we did not call\n+        // it before (unsuccessful, never concluded with the reception of a PONG).\n+        m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 260,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b8c8ff8968bf902abbc183c249ba8e7df8273a4a",
      "in_reply_to_id": 2041159799,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> We still need to remove all other NumToOpenAdd calls\r\n\r\nRight! Here is an updated patch:\r\n<details>\r\n<summary>[patch] open one more connection at the end of unsuccessful one</summary>\r\n\r\n```diff\r\ndiff --git i/src/net_processing.cpp w/src/net_processing.cpp\r\nindex 6753a7dea0..d35601c7ce 100644\r\n--- i/src/net_processing.cpp\r\n+++ w/src/net_processing.cpp\r\n@@ -1742,13 +1742,15 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\r\n         m_headers_presync_stats.erase(nodeid);\r\n     }\r\n     if (node.IsPrivateBroadcastConn()) {\r\n         // FinishBroadcast() is called when we get a PONG from the peer which means that the send\r\n         // has concluded successfully. Call FinishBroadcast() here as well in case we did not call\r\n         // it before (unsuccessful, never concluded with the reception of a PONG).\r\n-        m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false);\r\n+        if (m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false)) {\r\n+            m_connman.m_private_broadcast.NumToOpenAdd(1);\r\n+        }\r\n     }\r\n     LogDebug(BCLog::NET, \"Cleared nodestate for peer=%d\\n\", nodeid);\r\n     if (node.IsPrivateBroadcastConn()) {\r\n         LogPrintLevel(BCLog::PRIVATE_BROADCAST, BCLog::Level::Debug, \"Cleared nodestate for peer=%d\\n\", nodeid);\r\n     }\r\n }\r\n@@ -3704,13 +3706,12 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\r\n                 LogPrintLevel(BCLog::PRIVATE_BROADCAST,\r\n                               BCLog::Level::Info,\r\n                               \"Disconnecting: does not support transactions relay (connected in vain), peer=%d%s\",\r\n                               pfrom.GetId(),\r\n                               pfrom.LogIP(fLogIPs));\r\n                 pfrom.fDisconnect = true;\r\n-                m_connman.m_private_broadcast.NumToOpenAdd(1);\r\n             }\r\n             return;\r\n         }\r\n \r\n         if (greatest_common_version >= WTXID_RELAY_VERSION) {\r\n             MakeAndPushMessage(pfrom, NetMsgType::WTXIDRELAY);\r\n@@ -4213,13 +4214,12 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\r\n                 LogPrintLevel(BCLog::PRIVATE_BROADCAST,\r\n                               BCLog::Level::Info,\r\n                               \"Disconnecting: got GETDATA without sending an INV, peer=%d%s\\n\",\r\n                               pfrom.GetId(),\r\n                               fLogIPs ? strprintf(\", peeraddr=%s\", pfrom.addr.ToStringAddrPort()) : \"\");\r\n                 pfrom.fDisconnect = true;\r\n-                m_connman.m_private_broadcast.NumToOpenAdd(1);\r\n                 return;\r\n             }\r\n \r\n             const CTransactionRef& pushed_tx{*pushed_tx_opt};\r\n \r\n             // The GETDATA request must contain exactly one inv and it must be for the transaction\r\n@@ -4234,13 +4234,12 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\r\n                 LogPrintLevel(BCLog::PRIVATE_BROADCAST,\r\n                               BCLog::Level::Info,\r\n                               \"Disconnecting: got an unexpected GETDATA message, peer=%d%s\\n\",\r\n                               pfrom.GetId(),\r\n                               fLogIPs ? strprintf(\", peeraddr=%s\", pfrom.addr.ToStringAddrPort()) : \"\");\r\n                 pfrom.fDisconnect = true;\r\n-                m_connman.m_private_broadcast.NumToOpenAdd(1);\r\n             }\r\n             return;\r\n         }\r\n \r\n         {\r\n             LOCK(peer->m_getdata_requests_mutex);\r\ndiff --git i/src/private_broadcast.cpp w/src/private_broadcast.cpp\r\nindex 8483c61829..25cc69f6a7 100644\r\n--- i/src/private_broadcast.cpp\r\n+++ w/src/private_broadcast.cpp\r\n@@ -69,40 +69,42 @@ std::optional<CTransactionRef> PrivateBroadcast::GetTxPushedToNode(const NodeId&\r\n     if (it_by_txid == m_by_txid.end()) {\r\n         return std::nullopt;\r\n     }\r\n     return it_by_txid->second.tx;\r\n }\r\n \r\n-void PrivateBroadcast::FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n+bool PrivateBroadcast::FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n {\r\n     LOCK(m_mutex);\r\n     auto it = m_by_nodeid.find(nodeid);\r\n     if (it == m_by_nodeid.end()) {\r\n-        return;\r\n+        return false;\r\n     }\r\n     const Txid txid{it->second};\r\n     m_by_nodeid.erase(it);\r\n \r\n     if (!confirmed_by_node) {\r\n-        return;\r\n+        return true;\r\n     }\r\n \r\n     // Update broadcast stats.\r\n \r\n     auto iters = Find(txid);\r\n     if (!iters) {\r\n-        return;\r\n+        return true;\r\n     }\r\n     Priority& priority = iters->by_txid->second.priority;\r\n \r\n     ++priority.num_broadcasted;\r\n     priority.last_broadcasted = NodeClock::now();\r\n \r\n     // Remove and re-add the entry in the m_by_priority map because we have changed the key.\r\n     m_by_priority.erase(iters->by_priority);\r\n     m_by_priority.emplace(priority, txid);\r\n+\r\n+    return true;\r\n }\r\n \r\n std::vector<CTransactionRef> PrivateBroadcast::GetStale() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n {\r\n     LOCK(m_mutex);\r\n     const auto stale_time = NodeClock::now() - STALE_DURATION;\r\ndiff --git i/src/private_broadcast.h w/src/private_broadcast.h\r\nindex 72183be7b2..239f3a7c99 100644\r\n--- i/src/private_broadcast.h\r\n+++ w/src/private_broadcast.h\r\n@@ -61,14 +61,15 @@ public:\r\n      */\r\n     std::optional<CTransactionRef> GetTxPushedToNode(const NodeId& nodeid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\r\n \r\n     /**\r\n      * Mark the end of a broadcast of a transaction. Either successful by receiving a PONG,\r\n      * or unsuccessful by closing the connection to the node without getting PONG.\r\n+     * @return true if the reference by the given node id was removed\r\n      */\r\n-    void FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\r\n+    bool FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\r\n \r\n     /**\r\n      * Get the transactions that have not been broadcast recently.\r\n      */\r\n     std::vector<CTransactionRef> GetStale() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\r\n \r\n\r\n```\r\n</details>\r\n\r\n> and also call FinishBroadcast with true if we timeout after sending the INV.\r\n\r\nI think not, because getting silence after sending `INV` does not equate to \"we sent the tx to the peer\". It could be that they have it already or it could be that they are just broken and misbehaving or the network connection is down or slow or whatever.\r\n\r\n> What I suggest is tracking confirmed by node id\r\n\r\nI like keeping track of more things especially wrt a future addition to expose the status via RPC. For example - I think it would be nice to keep status per peer, something like:\r\n\r\ntransaction | to | status | status timestamp\r\n---|---|---|---\r\ntx1 | 2ai...a.onion:8333 | sent INV | 16:29:31\r\ntx1 | do6...a.b32.i2p:0 | sending complete | 16:29:40\r\ntx1 | 87.211.224.212:8333 | connected | 16:30:01\r\n",
      "created_at": "2025-04-14T14:35:32Z",
      "updated_at": "2025-04-14T14:35:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2042286270",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042286270"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1748,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042370434",
      "pull_request_review_id": 2764725011,
      "id": 2042370434,
      "node_id": "PRRC_kwDOABII5855vBmC",
      "diff_hunk": "@@ -1620,16 +1730,23 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n     }\n     } // cs_main\n     if (node.fSuccessfullyConnected &&\n-        !node.IsBlockOnlyConn() && !node.IsInboundConn()) {\n+        !node.IsBlockOnlyConn() && !node.IsPrivateBroadcastConn() && !node.IsInboundConn()) {\n         // Only change visible addrman state for full outbound peers.  We don't\n         // call Connected() for feeler connections since they don't have\n-        // fSuccessfullyConnected set.\n+        // fSuccessfullyConnected set. Also don't call Connected() for private broadcast\n+        // connections since they could leak information in addrman.\n         m_addrman.Connected(node.addr);\n     }\n     {\n         LOCK(m_headers_presync_mutex);\n         m_headers_presync_stats.erase(nodeid);\n     }\n+    if (node.IsPrivateBroadcastConn()) {\n+        // FinishBroadcast() is called when we get a PONG from the peer which means that the send\n+        // has concluded successfully. Call FinishBroadcast() here as well in case we did not call\n+        // it before (unsuccessful, never concluded with the reception of a PONG).\n+        m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 260,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b8c8ff8968bf902abbc183c249ba8e7df8273a4a",
      "in_reply_to_id": 2041159799,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Here is an updated patch\r\n\r\nLooks good! Just one thing - if we receive the tx in our mempool before the node is finalized and disconnect before receiving a PONG, we will still increment the connection count. Then we would wastefully connect to another peer and disconnect in `PushPrivateBroadcastTx`. I think this can be fixed if we change the following:\r\n```\r\n     if (!confirmed_by_node) {\r\n-        return;\r\n+        return Find(txid).has_value();\r\n     }\r\n```\r\n\r\nThe comment about the return value would also have to be updated.\r\n\r\n> getting silence after sending INV does not equate to \"we sent the tx to the peer\".\r\n\r\nHere are some arguments for assuming silence after INV means a successful private broadcast connection:\r\n\r\n- Not receiving a GETDATA for 3 minutes and retaining the connection would mean it is highly likely the node already has seen the tx. Yes, there could be other issues with the node, but it is about probabilities. Receiving a PONG after we push the TX also does not guarantee the node will broadcast our tx. The node could die before it broadcasts our tx, or it is malicious and blackholes it. The same with silence after an INV.\r\n\r\n- If our node is not well connected, e.g. maxconnections=0, and we still want to use it to private broadcast txs, it will forever keep opening private broadcast connections that timeout since it would not receive our tx back.\r\n\r\n- This would make it very difficult to support decoy txs. If we schedule a tx that is already received to be a decoy to send to 3 peers, it will forever keep opening connections.",
      "created_at": "2025-04-14T15:16:20Z",
      "updated_at": "2025-04-15T14:08:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2042370434",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2042370434"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1748,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2043616439",
      "pull_request_review_id": 2766782776,
      "id": 2043616439,
      "node_id": "PRRC_kwDOABII5855zxy3",
      "diff_hunk": "@@ -1620,16 +1730,23 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n     }\n     } // cs_main\n     if (node.fSuccessfullyConnected &&\n-        !node.IsBlockOnlyConn() && !node.IsInboundConn()) {\n+        !node.IsBlockOnlyConn() && !node.IsPrivateBroadcastConn() && !node.IsInboundConn()) {\n         // Only change visible addrman state for full outbound peers.  We don't\n         // call Connected() for feeler connections since they don't have\n-        // fSuccessfullyConnected set.\n+        // fSuccessfullyConnected set. Also don't call Connected() for private broadcast\n+        // connections since they could leak information in addrman.\n         m_addrman.Connected(node.addr);\n     }\n     {\n         LOCK(m_headers_presync_mutex);\n         m_headers_presync_stats.erase(nodeid);\n     }\n+    if (node.IsPrivateBroadcastConn()) {\n+        // FinishBroadcast() is called when we get a PONG from the peer which means that the send\n+        // has concluded successfully. Call FinishBroadcast() here as well in case we did not call\n+        // it before (unsuccessful, never concluded with the reception of a PONG).\n+        m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 260,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b8c8ff8968bf902abbc183c249ba8e7df8273a4a",
      "in_reply_to_id": 2041159799,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> ```diff\r\n> -        return;\r\n> +        return Find(txid).has_value();\r\n> ```\r\n\r\nDone.\r\n\r\nGood arguments about the \"what to do with silence after `INV`\". I will consider this. One more possibility - the peer may not be interested in transactions relay and thus not be interested in `INV` (and mistakenly did not indicate that during the handshake).",
      "created_at": "2025-04-15T05:12:37Z",
      "updated_at": "2025-04-15T07:39:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2043616439",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2043616439"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1748,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2045034011",
      "pull_request_review_id": 2769080193,
      "id": 2045034011,
      "node_id": "PRRC_kwDOABII58555L4b",
      "diff_hunk": "@@ -0,0 +1,144 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <private_broadcast.h>\n+#include <util/check.h>\n+\n+/// If a transaction is not received back from the network for this duration\n+/// after it is broadcast, then we  consider it stale / for rebroadcasting.\n+static constexpr auto STALE_DURATION{1min};\n+\n+bool PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    const Txid& txid = tx->GetHash();\n+    LOCK(m_mutex);\n+    auto [pos, inserted] = m_by_txid.emplace(txid, TxWithPriority{.tx = tx, .priority = Priority{}});\n+    if (inserted) {\n+        m_by_priority.emplace(Priority{}, txid);\n+    }\n+    return inserted;\n+}\n+\n+std::optional<size_t> PrivateBroadcast::Remove(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    auto iters = Find(tx->GetHash());\n+    if (!iters || iters->by_txid->second.tx->GetWitnessHash() != tx->GetWitnessHash()) {\n+        return std::nullopt;\n+    }\n+    const size_t num_broadcasted{iters->by_priority->first.num_broadcasted};\n+    m_by_priority.erase(iters->by_priority);\n+    m_by_txid.erase(iters->by_txid);\n+    return num_broadcasted;\n+}\n+\n+std::optional<CTransactionRef> PrivateBroadcast::GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    if (m_by_priority.empty()) {\n+        return std::nullopt;\n+    }\n+    const Txid& txid = m_by_priority.begin()->second;\n+    auto it = m_by_txid.find(txid);\n+    if (Assume(it != m_by_txid.end())) {\n+        return it->second.tx;\n+    }\n+    m_by_priority.erase(m_by_priority.begin());\n+    return std::nullopt;\n+}\n+\n+void PrivateBroadcast::PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    m_by_nodeid.emplace(nodeid, txid);\n+}\n+\n+std::optional<CTransactionRef> PrivateBroadcast::GetTxPushedToNode(const NodeId& nodeid)\n+    EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+\n+    auto it_by_node = m_by_nodeid.find(nodeid);\n+    if (it_by_node == m_by_nodeid.end()) {\n+        return std::nullopt;\n+    }\n+    const Txid txid{it_by_node->second};\n+\n+    auto it_by_txid = m_by_txid.find(txid);\n+    if (it_by_txid == m_by_txid.end()) {\n+        return std::nullopt;\n+    }\n+    return it_by_txid->second.tx;\n+}\n+\n+bool PrivateBroadcast::FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    auto it = m_by_nodeid.find(nodeid);\n+    if (it == m_by_nodeid.end()) {\n+        return false;\n+    }\n+    const Txid txid{it->second};\n+    m_by_nodeid.erase(it);\n+\n+    auto iters = Find(txid);\n+\n+    if (!confirmed_by_node) {",
      "path": "src/private_broadcast.cpp",
      "position": 1,
      "original_position": 87,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "400e9b17649497e298f76bc420d1a4933d5a4568",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: we can remove the second `if` block below\r\n\r\n```suggestion\r\n    if (!confirmed_by_node || !iters.has_value()) {\r\n```",
      "created_at": "2025-04-15T16:30:40Z",
      "updated_at": "2025-04-15T16:30:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2045034011",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2045034011"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 87,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2046816762",
      "pull_request_review_id": 2772327887,
      "id": 2046816762,
      "node_id": "PRRC_kwDOABII5855__H6",
      "diff_hunk": "@@ -0,0 +1,144 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <private_broadcast.h>\n+#include <util/check.h>\n+\n+/// If a transaction is not received back from the network for this duration\n+/// after it is broadcast, then we  consider it stale / for rebroadcasting.\n+static constexpr auto STALE_DURATION{1min};\n+\n+bool PrivateBroadcast::Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    const Txid& txid = tx->GetHash();\n+    LOCK(m_mutex);\n+    auto [pos, inserted] = m_by_txid.emplace(txid, TxWithPriority{.tx = tx, .priority = Priority{}});\n+    if (inserted) {\n+        m_by_priority.emplace(Priority{}, txid);\n+    }\n+    return inserted;\n+}\n+\n+std::optional<size_t> PrivateBroadcast::Remove(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    auto iters = Find(tx->GetHash());\n+    if (!iters || iters->by_txid->second.tx->GetWitnessHash() != tx->GetWitnessHash()) {\n+        return std::nullopt;\n+    }\n+    const size_t num_broadcasted{iters->by_priority->first.num_broadcasted};\n+    m_by_priority.erase(iters->by_priority);\n+    m_by_txid.erase(iters->by_txid);\n+    return num_broadcasted;\n+}\n+\n+std::optional<CTransactionRef> PrivateBroadcast::GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    if (m_by_priority.empty()) {\n+        return std::nullopt;\n+    }\n+    const Txid& txid = m_by_priority.begin()->second;\n+    auto it = m_by_txid.find(txid);\n+    if (Assume(it != m_by_txid.end())) {\n+        return it->second.tx;\n+    }\n+    m_by_priority.erase(m_by_priority.begin());\n+    return std::nullopt;\n+}\n+\n+void PrivateBroadcast::PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    m_by_nodeid.emplace(nodeid, txid);\n+}\n+\n+std::optional<CTransactionRef> PrivateBroadcast::GetTxPushedToNode(const NodeId& nodeid)\n+    EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+\n+    auto it_by_node = m_by_nodeid.find(nodeid);\n+    if (it_by_node == m_by_nodeid.end()) {\n+        return std::nullopt;\n+    }\n+    const Txid txid{it_by_node->second};\n+\n+    auto it_by_txid = m_by_txid.find(txid);\n+    if (it_by_txid == m_by_txid.end()) {\n+        return std::nullopt;\n+    }\n+    return it_by_txid->second.tx;\n+}\n+\n+bool PrivateBroadcast::FinishBroadcast(const NodeId& nodeid, bool confirmed_by_node) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\n+{\n+    LOCK(m_mutex);\n+    auto it = m_by_nodeid.find(nodeid);\n+    if (it == m_by_nodeid.end()) {\n+        return false;\n+    }\n+    const Txid txid{it->second};\n+    m_by_nodeid.erase(it);\n+\n+    auto iters = Find(txid);\n+\n+    if (!confirmed_by_node) {",
      "path": "src/private_broadcast.cpp",
      "position": 1,
      "original_position": 87,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "400e9b17649497e298f76bc420d1a4933d5a4568",
      "in_reply_to_id": 2045034011,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Right, done.",
      "created_at": "2025-04-16T12:26:31Z",
      "updated_at": "2025-04-16T12:26:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2046816762",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2046816762"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 87,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2046825770",
      "pull_request_review_id": 2772343909,
      "id": 2046825770,
      "node_id": "PRRC_kwDOABII5856ABUq",
      "diff_hunk": "@@ -1620,16 +1730,23 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n     }\n     } // cs_main\n     if (node.fSuccessfullyConnected &&\n-        !node.IsBlockOnlyConn() && !node.IsInboundConn()) {\n+        !node.IsBlockOnlyConn() && !node.IsPrivateBroadcastConn() && !node.IsInboundConn()) {\n         // Only change visible addrman state for full outbound peers.  We don't\n         // call Connected() for feeler connections since they don't have\n-        // fSuccessfullyConnected set.\n+        // fSuccessfullyConnected set. Also don't call Connected() for private broadcast\n+        // connections since they could leak information in addrman.\n         m_addrman.Connected(node.addr);\n     }\n     {\n         LOCK(m_headers_presync_mutex);\n         m_headers_presync_stats.erase(nodeid);\n     }\n+    if (node.IsPrivateBroadcastConn()) {\n+        // FinishBroadcast() is called when we get a PONG from the peer which means that the send\n+        // has concluded successfully. Call FinishBroadcast() here as well in case we did not call\n+        // it before (unsuccessful, never concluded with the reception of a PONG).\n+        m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 260,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b8c8ff8968bf902abbc183c249ba8e7df8273a4a",
      "in_reply_to_id": 2041159799,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "@mzumsande, any thoughts on how to treat a timeout after we sent `INV` (no `GETDATA` request)? Treat as send failure and schedule a new connection or treat as successful send and do not schedule a new connection?",
      "created_at": "2025-04-16T12:31:39Z",
      "updated_at": "2025-04-16T12:31:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2046825770",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2046825770"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1748,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2047059613",
      "pull_request_review_id": 2763515026,
      "id": 2047059613,
      "node_id": "PRRC_kwDOABII5856A6ad",
      "diff_hunk": "@@ -1642,10 +1652,55 @@ void PeerManagerImpl::ReattemptInitialBroadcast(CScheduler& scheduler)\n         }\n     }\n \n-    // Schedule next run for 10-15 minutes in the future.\n-    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n-    const auto delta = 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n-    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, delta);\n+    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, NextTxBroadcast());\n+}\n+\n+void PeerManagerImpl::ReattemptPrivateBroadcast(CScheduler& scheduler)\n+{\n+    // The following heuristic is subject to races, but that is ok: if it overshoots,\n+    // we will open some private connections in vain, if it undershoots, the stale\n+    // transactions will be picked on the next run.\n+\n+    size_t active_connections{0};\n+    m_connman.ForEachNode([&active_connections](const CNode* node) {\n+        if (node->IsPrivateBroadcastConn()) {\n+            ++active_connections;\n+        }\n+    });\n+\n+    const size_t to_open_connections{m_connman.m_private_broadcast.NumToOpen()};\n+\n+    // Remove stale transactions that are no longer relevant (e.g. already in\n+    // the mempool or mined) and count the remaining ones.\n+    size_t num_for_rebroadcast{0};\n+    const auto stale_txs = m_tx_for_private_broadcast.GetStale();\n+    {\n+        LOCK(cs_main);\n+        for (const auto& stale_tx : stale_txs) {\n+            auto mempool_acceptable = m_chainman.ProcessTransaction(stale_tx, /*test_accept=*/true);\n+            if (mempool_acceptable.m_result_type == MempoolAcceptResult::ResultType::VALID) {\n+                LogDebug(BCLog::PRIVATE_BROADCAST,\n+                         \"Reattempting broadcast of stale txid=%s wtxid=%s\",\n+                         stale_tx->GetHash().ToString(),\n+                         stale_tx->GetWitnessHash().ToString());\n+                ++num_for_rebroadcast;\n+            } else {\n+                LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                              BCLog::Level::Info,\n+                              \"Giving up broadcast attempts for txid=%s wtxid=%s: %s\",\n+                              stale_tx->GetHash().ToString(),\n+                              stale_tx->GetWitnessHash().ToString(),\n+                              mempool_acceptable.m_state.ToString());\n+                m_tx_for_private_broadcast.Remove(stale_tx);",
      "path": "src/net_processing.cpp",
      "position": 252,
      "original_position": 71,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "655af5976571ec694ba5aa57b35b3882e0a48cab",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "655af59: \r\n> If the malleated transaction wins then we will eventually stop broadcasting the original when it gets stale and gets removed from the \"to broadcast\" storage cause it is not acceptable in our mempool.\" doesn't happen.\r\n\r\nlooks like `Remove(stale_tx)` doesn't happen here (returns `nullopt` without removing the transaction from `m_by_txid`) and we keep re-attempting private broadcast of this malleated transaction scenario every 10-15 mins.\r\n\r\nconstructing a malleated transaction wasn't as straightforward as I thought so I tested the code path in a hacky way - but I think this is what might happen if a malleated transaction was used:\r\n1. when we receive the malleated transaction in net_processing, we call [`Remove()` which returns `nullopt`](https://github.com/bitcoin/bitcoin/blob/4104e20781547b8cd916d6fbe73ac301598b6123/src/net_processing.cpp#L4446) since there is a wtxid mismatch. and we don't reach the code line where the transaction is removed from `m_by_txid`.\r\n2. eventually transaction gets stale and it gets picked up in `ReattemptPrivateBroadcast()` attempts\r\n3. but there since it's not acceptable to our mempool (`MempoolAcceptResult::ResultType::DIFFERENT_WITNESS`), it [calls `Remove()`](https://github.com/bitcoin/bitcoin/blob/655af5976571ec694ba5aa57b35b3882e0a48cab/src/net_processing.cpp#L1694) which again returns `nullopt` without removing the transaction from `m_by_txid`.",
      "created_at": "2025-04-16T14:25:52Z",
      "updated_at": "2025-04-23T08:31:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2047059613",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2047059613"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1692,
      "original_line": 1692,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2049127611",
      "pull_request_review_id": 2776054347,
      "id": 2049127611,
      "node_id": "PRRC_kwDOABII5856IzS7",
      "diff_hunk": "@@ -4260,6 +4498,21 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         const uint256& hash = peer->m_wtxid_relay ? wtxid : txid;\n         AddKnownTx(*peer, hash);\n \n+        if (auto num_broadcasted = m_tx_for_private_broadcast.Remove(ptx)) {",
      "path": "src/net_processing.cpp",
      "position": 573,
      "original_position": 560,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "2b34857ad54aebbf0a9271e742c2caee85577bc8",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Just noting here that this is also racy (like reattempt). If we have more than 1 connection open and more than 1 succeeds, it will decrement the extra successful connections count.\r\nBut, if there are any stale txs caused by this they will be picked up in reattempt.",
      "created_at": "2025-04-17T14:51:45Z",
      "updated_at": "2025-04-17T14:52:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2049127611",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2049127611"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4515,
      "original_line": 4515,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2051507464",
      "pull_request_review_id": 2780003837,
      "id": 2051507464,
      "node_id": "PRRC_kwDOABII5856R4UI",
      "diff_hunk": "@@ -0,0 +1,390 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\"\"\"\n+\n+import time\n+import threading\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    malleate_tx,\n+    msg_inv,\n+)\n+from test_framework.netutil import (\n+    format_addr_port\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    assert_raises_rpc_error,\n+    p2p_port,\n+    tor_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 3\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+ADDRMAN_ADDRESSES = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        # Tor ports are the highest among p2p/rpc/tor, so this should be the first available port.\n+        ports_base = tor_port(MAX_NODES) + 1\n+\n+        self.destinations = []\n+\n+        self.destinations_lock = threading.Lock()\n+\n+        def destinations_factory(requested_to_addr, requested_to_port):\n+            with self.destinations_lock:\n+                i = len(self.destinations)\n+                actual_to_addr = \"\"\n+                actual_to_port = 0\n+                listener = None\n+                if i == NUM_INITIAL_CONNECTIONS:\n+                    # Instruct the SOCKS5 server to redirect the first private\n+                    # broadcast connection from nodes[0] to nodes[1]\n+                    actual_to_addr = \"127.0.0.1\" # nodes[1] listen address\n+                    actual_to_port = tor_port(1) # nodes[1] listen port for Tor\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (nodes[1])\")\n+                else:\n+                    # Create a Python P2P listening node and instruct the SOCKS5 proxy to\n+                    # redirect the connection to it. The first outbound connection is used\n+                    # later to serve GETDATA, thus make it P2PDataStore().\n+                    listener = P2PDataStore() if i == 0 else P2PInterface()\n+                    listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                    listener.peer_connect_send_version(services=P2P_SERVICES)\n+\n+                    def on_listen_done(addr, port):\n+                        nonlocal actual_to_addr\n+                        nonlocal actual_to_port\n+                        actual_to_addr = addr\n+                        actual_to_port = port\n+\n+                    self.network_thread.listen(\n+                        addr=\"127.0.0.1\",\n+                        port=ports_base + i,\n+                        p2p=listener,\n+                        callback=on_listen_done)\n+                    # Wait until the callback has been called.\n+                    self.wait_until(lambda: actual_to_port != 0)\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (a Python node)\")\n+\n+                self.destinations.append({\n+                    \"requested_to\": format_addr_port(requested_to_addr, requested_to_port),\n+                    \"node\": listener,\n+                })\n+                assert_equal(len(self.destinations), i + 1)\n+\n+                return {\n+                    \"actual_to_addr\": actual_to_addr,\n+                    \"actual_to_port\": actual_to_port,\n+                }\n+\n+        self.socks5_server.conf.destinations_factory = destinations_factory\n+\n+        self.extra_args = [\n+            [\n+                # Needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-cjdnsreachable\",\n+                # Connecting, sending garbage, being disconnected messes up with this test's\n+                # check_broadcasts() which waits for a particular Python node to receive a connection.\n+                \"-v2transport=0\",\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{tor_port(1)}=onion\",\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def check_broadcasts(self, label, tx, broadcasts_to_expect, skip_destinations):\n+        broadcasts_done = 0\n+        i = skip_destinations - 1\n+        while broadcasts_done < broadcasts_to_expect:\n+            i += 1\n+            self.log.debug(f\"{label}: waiting for outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            self.wait_until(lambda: len(self.destinations) > i)\n+            dest = self.destinations[i]\n+            peer = dest[\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"inv\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.rehash(), tx[\"txid\"])\n+            self.log.info(f\"{label}: ok: outbound connection i={i} is private broadcast of txid={tx['txid']}\")\n+            broadcasts_done += 1\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+        tx_receiver = self.nodes[1]\n+        far_observer = tx_receiver.add_p2p_connection(P2PInterface())\n+\n+        wallet = MiniWallet(tx_originator)\n+\n+        # Fill tx_originator's addrman.\n+        for addr in ADDRMAN_ADDRESSES:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: len(self.destinations) == NUM_INITIAL_CONNECTIONS)\n+\n+        # The next opened connection by tx_originator should be \"private broadcast\"\n+        # for sending the transaction. The SOCKS5 proxy should redirect it to tx_receiver.\n+\n+        txs = wallet.create_self_transfer_chain(chain_length=3)\n+        self.log.info(f\"Created txid={txs[0]['txid']}: for basic test\")\n+        self.log.info(f\"Created txid={txs[1]['txid']}: for broadcast with dependency in mempool + rebroadcast\")\n+        self.log.info(f\"Created txid={txs[2]['txid']}: for broadcast with dependency not in mempool\")\n+        tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        self.log.debug(f\"Waiting for outbound connection i={NUM_INITIAL_CONNECTIONS}, \"\n+                       \"must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(txs[0][\"txid\"])\n+        self.log.info(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: \"\n+                      \"the private broadcast target received and further relayed the transaction\")\n+\n+        # One already checked above, check the other NUM_PRIVATE_BROADCAST_PER_TX - 1 broadcasts.\n+        self.check_broadcasts(\"Basic\", txs[0], NUM_PRIVATE_BROADCAST_PER_TX - 1, NUM_INITIAL_CONNECTIONS + 1)\n+\n+        self.log.info(\"Resending the same transaction via RPC again\")\n+        ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={txs[0]['txid']}, wtxid={txs[0]['wtxid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[ignoring_msg.encode()]):\n+            tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        # How to create a malleated valid witness?\n+        #self.log.info(\"Sending a malleated transaction with a valid witness via RPC\")\n+        #malleated_valid = malleate_tx(txs[0])",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 317,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "2b34857ad54aebbf0a9271e742c2caee85577bc8",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I don't understand why these lines are commented out. They seem incorrect, since `malleated_valid` is created the exact same way as `malleated_invalid` below. Uncommenting this results in the test failing because `sendrawtransaction` fails with `mandartory-script-verify-flag-failed` but is not caught.",
      "created_at": "2025-04-19T15:25:09Z",
      "updated_at": "2025-04-19T15:25:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2051507464",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2051507464"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 317,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2051515684",
      "pull_request_review_id": 2780015804,
      "id": 2051515684,
      "node_id": "PRRC_kwDOABII5856R6Uk",
      "diff_hunk": "@@ -0,0 +1,390 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\"\"\"\n+\n+import time\n+import threading\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    malleate_tx,\n+    msg_inv,\n+)\n+from test_framework.netutil import (\n+    format_addr_port\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    assert_raises_rpc_error,\n+    p2p_port,\n+    tor_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 3\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+ADDRMAN_ADDRESSES = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        # Tor ports are the highest among p2p/rpc/tor, so this should be the first available port.\n+        ports_base = tor_port(MAX_NODES) + 1\n+\n+        self.destinations = []\n+\n+        self.destinations_lock = threading.Lock()\n+\n+        def destinations_factory(requested_to_addr, requested_to_port):\n+            with self.destinations_lock:\n+                i = len(self.destinations)\n+                actual_to_addr = \"\"\n+                actual_to_port = 0\n+                listener = None\n+                if i == NUM_INITIAL_CONNECTIONS:\n+                    # Instruct the SOCKS5 server to redirect the first private\n+                    # broadcast connection from nodes[0] to nodes[1]\n+                    actual_to_addr = \"127.0.0.1\" # nodes[1] listen address\n+                    actual_to_port = tor_port(1) # nodes[1] listen port for Tor\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (nodes[1])\")\n+                else:\n+                    # Create a Python P2P listening node and instruct the SOCKS5 proxy to\n+                    # redirect the connection to it. The first outbound connection is used\n+                    # later to serve GETDATA, thus make it P2PDataStore().\n+                    listener = P2PDataStore() if i == 0 else P2PInterface()\n+                    listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                    listener.peer_connect_send_version(services=P2P_SERVICES)\n+\n+                    def on_listen_done(addr, port):\n+                        nonlocal actual_to_addr\n+                        nonlocal actual_to_port\n+                        actual_to_addr = addr\n+                        actual_to_port = port\n+\n+                    self.network_thread.listen(\n+                        addr=\"127.0.0.1\",\n+                        port=ports_base + i,\n+                        p2p=listener,\n+                        callback=on_listen_done)\n+                    # Wait until the callback has been called.\n+                    self.wait_until(lambda: actual_to_port != 0)\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (a Python node)\")\n+\n+                self.destinations.append({\n+                    \"requested_to\": format_addr_port(requested_to_addr, requested_to_port),\n+                    \"node\": listener,\n+                })\n+                assert_equal(len(self.destinations), i + 1)\n+\n+                return {\n+                    \"actual_to_addr\": actual_to_addr,\n+                    \"actual_to_port\": actual_to_port,\n+                }\n+\n+        self.socks5_server.conf.destinations_factory = destinations_factory\n+\n+        self.extra_args = [\n+            [\n+                # Needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-cjdnsreachable\",\n+                # Connecting, sending garbage, being disconnected messes up with this test's\n+                # check_broadcasts() which waits for a particular Python node to receive a connection.\n+                \"-v2transport=0\",\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{tor_port(1)}=onion\",\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def check_broadcasts(self, label, tx, broadcasts_to_expect, skip_destinations):\n+        broadcasts_done = 0\n+        i = skip_destinations - 1\n+        while broadcasts_done < broadcasts_to_expect:\n+            i += 1\n+            self.log.debug(f\"{label}: waiting for outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            self.wait_until(lambda: len(self.destinations) > i)\n+            dest = self.destinations[i]\n+            peer = dest[\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"inv\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.rehash(), tx[\"txid\"])\n+            self.log.info(f\"{label}: ok: outbound connection i={i} is private broadcast of txid={tx['txid']}\")\n+            broadcasts_done += 1\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+        tx_receiver = self.nodes[1]\n+        far_observer = tx_receiver.add_p2p_connection(P2PInterface())\n+\n+        wallet = MiniWallet(tx_originator)\n+\n+        # Fill tx_originator's addrman.\n+        for addr in ADDRMAN_ADDRESSES:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: len(self.destinations) == NUM_INITIAL_CONNECTIONS)\n+\n+        # The next opened connection by tx_originator should be \"private broadcast\"\n+        # for sending the transaction. The SOCKS5 proxy should redirect it to tx_receiver.\n+\n+        txs = wallet.create_self_transfer_chain(chain_length=3)\n+        self.log.info(f\"Created txid={txs[0]['txid']}: for basic test\")\n+        self.log.info(f\"Created txid={txs[1]['txid']}: for broadcast with dependency in mempool + rebroadcast\")\n+        self.log.info(f\"Created txid={txs[2]['txid']}: for broadcast with dependency not in mempool\")\n+        tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        self.log.debug(f\"Waiting for outbound connection i={NUM_INITIAL_CONNECTIONS}, \"\n+                       \"must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(txs[0][\"txid\"])\n+        self.log.info(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: \"\n+                      \"the private broadcast target received and further relayed the transaction\")\n+\n+        # One already checked above, check the other NUM_PRIVATE_BROADCAST_PER_TX - 1 broadcasts.\n+        self.check_broadcasts(\"Basic\", txs[0], NUM_PRIVATE_BROADCAST_PER_TX - 1, NUM_INITIAL_CONNECTIONS + 1)\n+\n+        self.log.info(\"Resending the same transaction via RPC again\")\n+        ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={txs[0]['txid']}, wtxid={txs[0]['wtxid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[ignoring_msg.encode()]):\n+            tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        # How to create a malleated valid witness?\n+        #self.log.info(\"Sending a malleated transaction with a valid witness via RPC\")\n+        #malleated_valid = malleate_tx(txs[0])",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 317,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "2b34857ad54aebbf0a9271e742c2caee85577bc8",
      "in_reply_to_id": 2051507464,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think I understand, the line `How to create a malleated valid witness?` is wondering if there is a way. Then instead of `malleate_tx` we can do the valid way instead.\r\nMaybe that can be made more clear with a comment like: \"TODO: Create a malleated valid witness (how?) and substitute `malleate_tx` below.\".",
      "created_at": "2025-04-19T16:05:15Z",
      "updated_at": "2025-04-19T16:17:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2051515684",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2051515684"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 317,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2052396373",
      "pull_request_review_id": 2781261301,
      "id": 2052396373,
      "node_id": "PRRC_kwDOABII5856VRVV",
      "diff_hunk": "@@ -0,0 +1,115 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_PRIVATE_BROADCAST_H\n+#define BITCOIN_PRIVATE_BROADCAST_H\n+\n+#include <net.h>\n+#include <primitives/transaction.h>\n+#include <sync.h>\n+#include <threadsafety.h>\n+#include <util/hasher.h>\n+#include <util/time.h>\n+#include <util/transaction_identifier.h>\n+\n+#include <map>\n+#include <optional>\n+#include <unordered_map>\n+#include <vector>\n+\n+/**\n+ * Store a list of transactions to be broadcast privately. Supports the following operations:\n+ * - Add a new transaction\n+ * - Remove a transaction, after it has been seen by the network\n+ * - Mark a broadcast of a transaction (remember when and how many times)\n+ * - Get a transaction for broadcast, the one that has been broadcast fewer times and least recently\n+ */\n+class PrivateBroadcast\n+{\n+public:\n+    /**\n+     * Add a transaction to the storage.\n+     * @param[in] tx The transaction to add.\n+     * @retval true The transaction was added.\n+     * @retval false The transaction was already present.\n+     */\n+    bool Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+    /**\n+     * Forget a transaction.\n+     * @return the number of times the transaction was broadcast if the transaction existed and was removed,\n+     * otherwise empty optional (the transaction was not in the storage).\n+     */\n+    std::optional<size_t> Remove(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+    /**\n+     * Get the transaction that has been broadcast fewest times and least recently.\n+     */\n+    std::optional<CTransactionRef> GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+    /**\n+     * Mark a transaction as pushed to a given node. This is an intermediate state before\n+     * we get a PONG from the node which would confirm that the transaction has been received.\n+     * At the time we get the PONG we need to know which transaction we sent to that node,\n+     * so that we can account how many times we broadcast each transaction.\n+     */\n+    void PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+    /**\n+     * Get the transaction that was pushed to a given node by PushedToNode().\n+     */\n+    std::optional<CTransactionRef> GetTxPushedToNode(const NodeId& nodeid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);",
      "path": "src/private_broadcast.h",
      "position": 1,
      "original_position": 62,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "2b34857ad54aebbf0a9271e742c2caee85577bc8",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: could be `const` method.",
      "created_at": "2025-04-21T13:39:29Z",
      "updated_at": "2025-04-21T13:39:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2052396373",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2052396373"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 62,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054684233",
      "pull_request_review_id": 2785050319,
      "id": 2054684233,
      "node_id": "PRRC_kwDOABII5856d_5J",
      "diff_hunk": "@@ -1620,16 +1730,23 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n     }\n     } // cs_main\n     if (node.fSuccessfullyConnected &&\n-        !node.IsBlockOnlyConn() && !node.IsInboundConn()) {\n+        !node.IsBlockOnlyConn() && !node.IsPrivateBroadcastConn() && !node.IsInboundConn()) {\n         // Only change visible addrman state for full outbound peers.  We don't\n         // call Connected() for feeler connections since they don't have\n-        // fSuccessfullyConnected set.\n+        // fSuccessfullyConnected set. Also don't call Connected() for private broadcast\n+        // connections since they could leak information in addrman.\n         m_addrman.Connected(node.addr);\n     }\n     {\n         LOCK(m_headers_presync_mutex);\n         m_headers_presync_stats.erase(nodeid);\n     }\n+    if (node.IsPrivateBroadcastConn()) {\n+        // FinishBroadcast() is called when we get a PONG from the peer which means that the send\n+        // has concluded successfully. Call FinishBroadcast() here as well in case we did not call\n+        // it before (unsuccessful, never concluded with the reception of a PONG).\n+        m_tx_for_private_broadcast.FinishBroadcast(nodeid, /*confirmed_by_node=*/false);",
      "path": "src/net_processing.cpp",
      "position": 1,
      "original_position": 260,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "b8c8ff8968bf902abbc183c249ba8e7df8273a4a",
      "in_reply_to_id": 2041159799,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> @mzumsande, any thoughts on how to treat a timeout after we sent `INV` (no `GETDATA` request)? Treat as send failure and schedule a new connection or treat as successful send and do not schedule a new connection?\r\n\r\nThe arguments from @andrewtoth make sense to me. I think all situations where we'd like to treat it as a send failure/schedule another connection involve a peer that is either broken in an unusual way or malicious. Malicious peers can act as a black hole, so they can be ignored here, while broken peers seem unlikely, when there is a natural cause that is much more likely.",
      "created_at": "2025-04-22T18:51:37Z",
      "updated_at": "2025-04-22T18:51:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2054684233",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054684233"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1748,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055753450",
      "pull_request_review_id": 2786810969,
      "id": 2055753450,
      "node_id": "PRRC_kwDOABII5856iE7q",
      "diff_hunk": "@@ -1642,10 +1652,55 @@ void PeerManagerImpl::ReattemptInitialBroadcast(CScheduler& scheduler)\n         }\n     }\n \n-    // Schedule next run for 10-15 minutes in the future.\n-    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n-    const auto delta = 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n-    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, delta);\n+    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, NextTxBroadcast());\n+}\n+\n+void PeerManagerImpl::ReattemptPrivateBroadcast(CScheduler& scheduler)\n+{\n+    // The following heuristic is subject to races, but that is ok: if it overshoots,\n+    // we will open some private connections in vain, if it undershoots, the stale\n+    // transactions will be picked on the next run.\n+\n+    size_t active_connections{0};\n+    m_connman.ForEachNode([&active_connections](const CNode* node) {\n+        if (node->IsPrivateBroadcastConn()) {\n+            ++active_connections;\n+        }\n+    });\n+\n+    const size_t to_open_connections{m_connman.m_private_broadcast.NumToOpen()};\n+\n+    // Remove stale transactions that are no longer relevant (e.g. already in\n+    // the mempool or mined) and count the remaining ones.\n+    size_t num_for_rebroadcast{0};\n+    const auto stale_txs = m_tx_for_private_broadcast.GetStale();\n+    {\n+        LOCK(cs_main);\n+        for (const auto& stale_tx : stale_txs) {\n+            auto mempool_acceptable = m_chainman.ProcessTransaction(stale_tx, /*test_accept=*/true);\n+            if (mempool_acceptable.m_result_type == MempoolAcceptResult::ResultType::VALID) {\n+                LogDebug(BCLog::PRIVATE_BROADCAST,\n+                         \"Reattempting broadcast of stale txid=%s wtxid=%s\",\n+                         stale_tx->GetHash().ToString(),\n+                         stale_tx->GetWitnessHash().ToString());\n+                ++num_for_rebroadcast;\n+            } else {\n+                LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                              BCLog::Level::Info,\n+                              \"Giving up broadcast attempts for txid=%s wtxid=%s: %s\",\n+                              stale_tx->GetHash().ToString(),\n+                              stale_tx->GetWitnessHash().ToString(),\n+                              mempool_acceptable.m_state.ToString());\n+                m_tx_for_private_broadcast.Remove(stale_tx);",
      "path": "src/net_processing.cpp",
      "position": 252,
      "original_position": 71,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "655af5976571ec694ba5aa57b35b3882e0a48cab",
      "in_reply_to_id": 2047059613,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think 1. and 2. are correct, but in 3. it would happen differently - it would remove the transaction because both txid and wtxid match. `stale_tx` came from the private broadcast storage, is the original transaction, not the malleated one.",
      "created_at": "2025-04-23T10:29:45Z",
      "updated_at": "2025-04-23T10:29:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2055753450",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055753450"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1692,
      "original_line": 1692,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055915118",
      "pull_request_review_id": 2787076498,
      "id": 2055915118,
      "node_id": "PRRC_kwDOABII5856isZu",
      "diff_hunk": "@@ -1642,10 +1652,55 @@ void PeerManagerImpl::ReattemptInitialBroadcast(CScheduler& scheduler)\n         }\n     }\n \n-    // Schedule next run for 10-15 minutes in the future.\n-    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n-    const auto delta = 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n-    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, delta);\n+    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, NextTxBroadcast());\n+}\n+\n+void PeerManagerImpl::ReattemptPrivateBroadcast(CScheduler& scheduler)\n+{\n+    // The following heuristic is subject to races, but that is ok: if it overshoots,\n+    // we will open some private connections in vain, if it undershoots, the stale\n+    // transactions will be picked on the next run.\n+\n+    size_t active_connections{0};\n+    m_connman.ForEachNode([&active_connections](const CNode* node) {\n+        if (node->IsPrivateBroadcastConn()) {\n+            ++active_connections;\n+        }\n+    });\n+\n+    const size_t to_open_connections{m_connman.m_private_broadcast.NumToOpen()};\n+\n+    // Remove stale transactions that are no longer relevant (e.g. already in\n+    // the mempool or mined) and count the remaining ones.\n+    size_t num_for_rebroadcast{0};\n+    const auto stale_txs = m_tx_for_private_broadcast.GetStale();\n+    {\n+        LOCK(cs_main);\n+        for (const auto& stale_tx : stale_txs) {\n+            auto mempool_acceptable = m_chainman.ProcessTransaction(stale_tx, /*test_accept=*/true);\n+            if (mempool_acceptable.m_result_type == MempoolAcceptResult::ResultType::VALID) {\n+                LogDebug(BCLog::PRIVATE_BROADCAST,\n+                         \"Reattempting broadcast of stale txid=%s wtxid=%s\",\n+                         stale_tx->GetHash().ToString(),\n+                         stale_tx->GetWitnessHash().ToString());\n+                ++num_for_rebroadcast;\n+            } else {\n+                LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                              BCLog::Level::Info,\n+                              \"Giving up broadcast attempts for txid=%s wtxid=%s: %s\",\n+                              stale_tx->GetHash().ToString(),\n+                              stale_tx->GetWitnessHash().ToString(),\n+                              mempool_acceptable.m_state.ToString());\n+                m_tx_for_private_broadcast.Remove(stale_tx);",
      "path": "src/net_processing.cpp",
      "position": 252,
      "original_position": 71,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "655af5976571ec694ba5aa57b35b3882e0a48cab",
      "in_reply_to_id": 2047059613,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> constructing a malleated transaction wasn't as straightforward as I thought\r\n\r\nThere is `malleate_tx()` Python function in the tests. It is used by the newly added `p2p_private_broadcast.py`. It creates an invalid witness. Did you create a valid one? If yes, then maybe you want to contribute to that function, to make it possible to create valid or invalid.",
      "created_at": "2025-04-23T12:13:43Z",
      "updated_at": "2025-04-23T12:13:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2055915118",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055915118"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1692,
      "original_line": 1692,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055989720",
      "pull_request_review_id": 2787195358,
      "id": 2055989720,
      "node_id": "PRRC_kwDOABII5856i-nY",
      "diff_hunk": "@@ -1167,6 +1169,74 @@ class CConnman\n                                std::optional<Proxy> proxy = std::nullopt)\n         EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\n \n+    /// Group of private broadcast related members.\n+    class PrivateBroadcast\n+    {\n+    public:\n+        /**\n+         * Remember if we ever established at least one outbound connection to a\n+         * Tor peer, including sending and receiving P2P messages. If this is\n+         * true then the Tor proxy indeed works and is a proxy to the Tor network,\n+         * not a misconfigured ordinary SOCKS5 proxy as -proxy or -onion. If that\n+         * is the case, then we assume that connecting to an IPv4 or IPv6 address\n+         * via that proxy will be done trough the Tor network and a Tor exit node.",
      "path": "src/net.h",
      "position": 1,
      "original_position": 23,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "3c1bb45fe7ce1995bf8820764c72a5c0675e047e",
      "in_reply_to_id": 2041903792,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-04-23T12:53:17Z",
      "updated_at": "2025-04-23T12:53:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2055989720",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055989720"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1182,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055990031",
      "pull_request_review_id": 2787195859,
      "id": 2055990031,
      "node_id": "PRRC_kwDOABII5856i-sP",
      "diff_hunk": "@@ -517,7 +517,10 @@ RPCConsole::RPCConsole(interfaces::Node& node, const PlatformStyle *_platformSty\n         tr(\"Outbound Feeler: short-lived, for testing addresses\"),\n         /*: Explanatory text for a short-lived outbound peer connection that is used\n             to request addresses from a peer. */\n-        tr(\"Outbound Address Fetch: short-lived, for soliciting addresses\")};\n+        tr(\"Outbound Address Fetch: short-lived, for soliciting addresses\"),\n+        /*: Explanatory text for a short-lived outbound peer connection that is used\n+            to broadcast privacy-sensitive data (like our transactions). */\n+        tr(\"Private broadcast: short-lived, for broadcasting privacy-sensitive data\")};",
      "path": "src/qt/rpcconsole.cpp",
      "position": 1,
      "original_position": 8,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "030204c5bd1c6ceaab9e37d7d5ee0f157156bc90",
      "in_reply_to_id": 2041693437,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-04-23T12:53:27Z",
      "updated_at": "2025-04-23T12:53:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2055990031",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055990031"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 523,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055990265",
      "pull_request_review_id": 2787196264,
      "id": 2055990265,
      "node_id": "PRRC_kwDOABII5856i-v5",
      "diff_hunk": "@@ -2055,6 +2064,32 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     connOptions.m_i2p_accept_incoming = args.GetBoolArg(\"-i2pacceptincoming\", DEFAULT_I2P_ACCEPT_INCOMING);\n \n+    if (args.GetBoolArg(\"-privatebroadcast\", DEFAULT_PRIVATE_BROADCAST)) {\n+        // If -listenonion is set, then NET_ONION may not be reachable now\n+        // but may become reachable later, thus only error here if it is not\n+        // reachable and will not become reachable for sure.\n+        const bool onion_may_become_reachable{listenonion && (!args.IsArgSet(\"-onlynet\") || onlynet_used_with_onion)};\n+        if (!g_reachable_nets.Contains(NET_I2P) &&\n+            !g_reachable_nets.Contains(NET_ONION) &&\n+            !onion_may_become_reachable) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"\n+                               \"but none of Tor or I2P networks is reachable\"));\n+        }\n+        if (!connOptions.m_use_addrman_outgoing) {\n+            return InitError(_(\"Private broadcast of own transactions requested (-privatebroadcast), \"\n+                               \"but -connect is also configured. They are incompatible because the \"\n+                               \"private broadcast needs to open new connections to randomly \"\n+                               \"chosen Tor or I2P peers. Consider using -maxconnections=0 -addnode=... \"\n+                               \"instead\"));\n+        }\n+        if (!proxyRandomize && (g_reachable_nets.Contains(NET_ONION) || onion_may_become_reachable)) {\n+            InitWarning(strprintf(",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 64,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "9c4aad2a0111bf5b29f4613331f19ce994d089dd",
      "in_reply_to_id": 2041644069,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-04-23T12:53:36Z",
      "updated_at": "2025-04-23T12:53:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2055990265",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055990265"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2089,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055990539",
      "pull_request_review_id": 2787196674,
      "id": 2055990539,
      "node_id": "PRRC_kwDOABII5856i-0L",
      "diff_hunk": "@@ -0,0 +1,115 @@\n+// Copyright (c) 2023-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_PRIVATE_BROADCAST_H\n+#define BITCOIN_PRIVATE_BROADCAST_H\n+\n+#include <net.h>\n+#include <primitives/transaction.h>\n+#include <sync.h>\n+#include <threadsafety.h>\n+#include <util/hasher.h>\n+#include <util/time.h>\n+#include <util/transaction_identifier.h>\n+\n+#include <map>\n+#include <optional>\n+#include <unordered_map>\n+#include <vector>\n+\n+/**\n+ * Store a list of transactions to be broadcast privately. Supports the following operations:\n+ * - Add a new transaction\n+ * - Remove a transaction, after it has been seen by the network\n+ * - Mark a broadcast of a transaction (remember when and how many times)\n+ * - Get a transaction for broadcast, the one that has been broadcast fewer times and least recently\n+ */\n+class PrivateBroadcast\n+{\n+public:\n+    /**\n+     * Add a transaction to the storage.\n+     * @param[in] tx The transaction to add.\n+     * @retval true The transaction was added.\n+     * @retval false The transaction was already present.\n+     */\n+    bool Add(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+    /**\n+     * Forget a transaction.\n+     * @return the number of times the transaction was broadcast if the transaction existed and was removed,\n+     * otherwise empty optional (the transaction was not in the storage).\n+     */\n+    std::optional<size_t> Remove(const CTransactionRef& tx) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+    /**\n+     * Get the transaction that has been broadcast fewest times and least recently.\n+     */\n+    std::optional<CTransactionRef> GetTxForBroadcast() EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+    /**\n+     * Mark a transaction as pushed to a given node. This is an intermediate state before\n+     * we get a PONG from the node which would confirm that the transaction has been received.\n+     * At the time we get the PONG we need to know which transaction we sent to that node,\n+     * so that we can account how many times we broadcast each transaction.\n+     */\n+    void PushedToNode(const NodeId& nodeid, const Txid& txid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);\n+\n+    /**\n+     * Get the transaction that was pushed to a given node by PushedToNode().\n+     */\n+    std::optional<CTransactionRef> GetTxPushedToNode(const NodeId& nodeid) EXCLUSIVE_LOCKS_REQUIRED(!m_mutex);",
      "path": "src/private_broadcast.h",
      "position": 1,
      "original_position": 62,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "2b34857ad54aebbf0a9271e742c2caee85577bc8",
      "in_reply_to_id": 2052396373,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-04-23T12:53:44Z",
      "updated_at": "2025-04-23T12:53:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2055990539",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055990539"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 62,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055992009",
      "pull_request_review_id": 2787198914,
      "id": 2055992009,
      "node_id": "PRRC_kwDOABII5856i_LJ",
      "diff_hunk": "@@ -0,0 +1,390 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\"\"\"\n+\n+import time\n+import threading\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    malleate_tx,\n+    msg_inv,\n+)\n+from test_framework.netutil import (\n+    format_addr_port\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    assert_raises_rpc_error,\n+    p2p_port,\n+    tor_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 3\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+ADDRMAN_ADDRESSES = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        # Tor ports are the highest among p2p/rpc/tor, so this should be the first available port.\n+        ports_base = tor_port(MAX_NODES) + 1\n+\n+        self.destinations = []\n+\n+        self.destinations_lock = threading.Lock()\n+\n+        def destinations_factory(requested_to_addr, requested_to_port):\n+            with self.destinations_lock:\n+                i = len(self.destinations)\n+                actual_to_addr = \"\"\n+                actual_to_port = 0\n+                listener = None\n+                if i == NUM_INITIAL_CONNECTIONS:\n+                    # Instruct the SOCKS5 server to redirect the first private\n+                    # broadcast connection from nodes[0] to nodes[1]\n+                    actual_to_addr = \"127.0.0.1\" # nodes[1] listen address\n+                    actual_to_port = tor_port(1) # nodes[1] listen port for Tor\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (nodes[1])\")\n+                else:\n+                    # Create a Python P2P listening node and instruct the SOCKS5 proxy to\n+                    # redirect the connection to it. The first outbound connection is used\n+                    # later to serve GETDATA, thus make it P2PDataStore().\n+                    listener = P2PDataStore() if i == 0 else P2PInterface()\n+                    listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                    listener.peer_connect_send_version(services=P2P_SERVICES)\n+\n+                    def on_listen_done(addr, port):\n+                        nonlocal actual_to_addr\n+                        nonlocal actual_to_port\n+                        actual_to_addr = addr\n+                        actual_to_port = port\n+\n+                    self.network_thread.listen(\n+                        addr=\"127.0.0.1\",\n+                        port=ports_base + i,\n+                        p2p=listener,\n+                        callback=on_listen_done)\n+                    # Wait until the callback has been called.\n+                    self.wait_until(lambda: actual_to_port != 0)\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (a Python node)\")\n+\n+                self.destinations.append({\n+                    \"requested_to\": format_addr_port(requested_to_addr, requested_to_port),\n+                    \"node\": listener,\n+                })\n+                assert_equal(len(self.destinations), i + 1)\n+\n+                return {\n+                    \"actual_to_addr\": actual_to_addr,\n+                    \"actual_to_port\": actual_to_port,\n+                }\n+\n+        self.socks5_server.conf.destinations_factory = destinations_factory\n+\n+        self.extra_args = [\n+            [\n+                # Needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-cjdnsreachable\",\n+                # Connecting, sending garbage, being disconnected messes up with this test's\n+                # check_broadcasts() which waits for a particular Python node to receive a connection.\n+                \"-v2transport=0\",\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{tor_port(1)}=onion\",\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def check_broadcasts(self, label, tx, broadcasts_to_expect, skip_destinations):\n+        broadcasts_done = 0\n+        i = skip_destinations - 1\n+        while broadcasts_done < broadcasts_to_expect:\n+            i += 1\n+            self.log.debug(f\"{label}: waiting for outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            self.wait_until(lambda: len(self.destinations) > i)\n+            dest = self.destinations[i]\n+            peer = dest[\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"inv\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.rehash(), tx[\"txid\"])\n+            self.log.info(f\"{label}: ok: outbound connection i={i} is private broadcast of txid={tx['txid']}\")\n+            broadcasts_done += 1\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+        tx_receiver = self.nodes[1]\n+        far_observer = tx_receiver.add_p2p_connection(P2PInterface())\n+\n+        wallet = MiniWallet(tx_originator)\n+\n+        # Fill tx_originator's addrman.\n+        for addr in ADDRMAN_ADDRESSES:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: len(self.destinations) == NUM_INITIAL_CONNECTIONS)\n+\n+        # The next opened connection by tx_originator should be \"private broadcast\"\n+        # for sending the transaction. The SOCKS5 proxy should redirect it to tx_receiver.\n+\n+        txs = wallet.create_self_transfer_chain(chain_length=3)\n+        self.log.info(f\"Created txid={txs[0]['txid']}: for basic test\")\n+        self.log.info(f\"Created txid={txs[1]['txid']}: for broadcast with dependency in mempool + rebroadcast\")\n+        self.log.info(f\"Created txid={txs[2]['txid']}: for broadcast with dependency not in mempool\")\n+        tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        self.log.debug(f\"Waiting for outbound connection i={NUM_INITIAL_CONNECTIONS}, \"\n+                       \"must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(txs[0][\"txid\"])\n+        self.log.info(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: \"\n+                      \"the private broadcast target received and further relayed the transaction\")\n+\n+        # One already checked above, check the other NUM_PRIVATE_BROADCAST_PER_TX - 1 broadcasts.\n+        self.check_broadcasts(\"Basic\", txs[0], NUM_PRIVATE_BROADCAST_PER_TX - 1, NUM_INITIAL_CONNECTIONS + 1)\n+\n+        self.log.info(\"Resending the same transaction via RPC again\")\n+        ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={txs[0]['txid']}, wtxid={txs[0]['wtxid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[ignoring_msg.encode()]):\n+            tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        # How to create a malleated valid witness?\n+        #self.log.info(\"Sending a malleated transaction with a valid witness via RPC\")\n+        #malleated_valid = malleate_tx(txs[0])",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 317,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "2b34857ad54aebbf0a9271e742c2caee85577bc8",
      "in_reply_to_id": 2051507464,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done, reworded the comment.",
      "created_at": "2025-04-23T12:54:29Z",
      "updated_at": "2025-04-23T12:54:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2055992009",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055992009"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 317,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2056022026",
      "pull_request_review_id": 2787252483,
      "id": 2056022026,
      "node_id": "PRRC_kwDOABII5856jGgK",
      "diff_hunk": "@@ -4260,6 +4498,21 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         const uint256& hash = peer->m_wtxid_relay ? wtxid : txid;\n         AddKnownTx(*peer, hash);\n \n+        if (auto num_broadcasted = m_tx_for_private_broadcast.Remove(ptx)) {",
      "path": "src/net_processing.cpp",
      "position": 573,
      "original_position": 560,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "2b34857ad54aebbf0a9271e742c2caee85577bc8",
      "in_reply_to_id": 2049127611,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes, this loose handling makes it possible to do the job with less code. My reasoning is that the worst outcome from the race is acceptable.\r\n\r\nI am looking into keeping track of more stuff with respect to the future RPC stats (see at the bottom of https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2042286270) which would also give us more fine grained control here. If it looks reasonable and is not too much code, I will propose the change in https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2042286270.",
      "created_at": "2025-04-23T13:10:28Z",
      "updated_at": "2025-04-23T13:10:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2056022026",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2056022026"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4515,
      "original_line": 4515,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2068135636",
      "pull_request_review_id": 2806190197,
      "id": 2068135636,
      "node_id": "PRRC_kwDOABII5857RT7U",
      "diff_hunk": "@@ -1642,10 +1652,55 @@ void PeerManagerImpl::ReattemptInitialBroadcast(CScheduler& scheduler)\n         }\n     }\n \n-    // Schedule next run for 10-15 minutes in the future.\n-    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n-    const auto delta = 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n-    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, delta);\n+    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, NextTxBroadcast());\n+}\n+\n+void PeerManagerImpl::ReattemptPrivateBroadcast(CScheduler& scheduler)\n+{\n+    // The following heuristic is subject to races, but that is ok: if it overshoots,\n+    // we will open some private connections in vain, if it undershoots, the stale\n+    // transactions will be picked on the next run.\n+\n+    size_t active_connections{0};\n+    m_connman.ForEachNode([&active_connections](const CNode* node) {\n+        if (node->IsPrivateBroadcastConn()) {\n+            ++active_connections;\n+        }\n+    });\n+\n+    const size_t to_open_connections{m_connman.m_private_broadcast.NumToOpen()};\n+\n+    // Remove stale transactions that are no longer relevant (e.g. already in\n+    // the mempool or mined) and count the remaining ones.\n+    size_t num_for_rebroadcast{0};\n+    const auto stale_txs = m_tx_for_private_broadcast.GetStale();\n+    {\n+        LOCK(cs_main);\n+        for (const auto& stale_tx : stale_txs) {\n+            auto mempool_acceptable = m_chainman.ProcessTransaction(stale_tx, /*test_accept=*/true);\n+            if (mempool_acceptable.m_result_type == MempoolAcceptResult::ResultType::VALID) {\n+                LogDebug(BCLog::PRIVATE_BROADCAST,\n+                         \"Reattempting broadcast of stale txid=%s wtxid=%s\",\n+                         stale_tx->GetHash().ToString(),\n+                         stale_tx->GetWitnessHash().ToString());\n+                ++num_for_rebroadcast;\n+            } else {\n+                LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                              BCLog::Level::Info,\n+                              \"Giving up broadcast attempts for txid=%s wtxid=%s: %s\",\n+                              stale_tx->GetHash().ToString(),\n+                              stale_tx->GetWitnessHash().ToString(),\n+                              mempool_acceptable.m_state.ToString());\n+                m_tx_for_private_broadcast.Remove(stale_tx);",
      "path": "src/net_processing.cpp",
      "position": 252,
      "original_position": 71,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "655af5976571ec694ba5aa57b35b3882e0a48cab",
      "in_reply_to_id": 2047059613,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Here's something we can play with in this PR - https://github.com/stratospher/bitcoin/commit/dace16b34f31f6ad97ab21c66f3e65274cdace8c\r\n\r\nIt's not a pretty and compact method of generating like `malleate_tx()` but it works.\r\nI've also opened #32385 to discuss how this could be done better!",
      "created_at": "2025-04-30T08:15:50Z",
      "updated_at": "2025-04-30T08:15:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2068135636",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2068135636"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1692,
      "original_line": 1692,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2068145404",
      "pull_request_review_id": 2806205447,
      "id": 2068145404,
      "node_id": "PRRC_kwDOABII5857RWT8",
      "diff_hunk": "@@ -1642,10 +1652,55 @@ void PeerManagerImpl::ReattemptInitialBroadcast(CScheduler& scheduler)\n         }\n     }\n \n-    // Schedule next run for 10-15 minutes in the future.\n-    // We add randomness on every cycle to avoid the possibility of P2P fingerprinting.\n-    const auto delta = 10min + FastRandomContext().randrange<std::chrono::milliseconds>(5min);\n-    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, delta);\n+    scheduler.scheduleFromNow([&] { ReattemptInitialBroadcast(scheduler); }, NextTxBroadcast());\n+}\n+\n+void PeerManagerImpl::ReattemptPrivateBroadcast(CScheduler& scheduler)\n+{\n+    // The following heuristic is subject to races, but that is ok: if it overshoots,\n+    // we will open some private connections in vain, if it undershoots, the stale\n+    // transactions will be picked on the next run.\n+\n+    size_t active_connections{0};\n+    m_connman.ForEachNode([&active_connections](const CNode* node) {\n+        if (node->IsPrivateBroadcastConn()) {\n+            ++active_connections;\n+        }\n+    });\n+\n+    const size_t to_open_connections{m_connman.m_private_broadcast.NumToOpen()};\n+\n+    // Remove stale transactions that are no longer relevant (e.g. already in\n+    // the mempool or mined) and count the remaining ones.\n+    size_t num_for_rebroadcast{0};\n+    const auto stale_txs = m_tx_for_private_broadcast.GetStale();\n+    {\n+        LOCK(cs_main);\n+        for (const auto& stale_tx : stale_txs) {\n+            auto mempool_acceptable = m_chainman.ProcessTransaction(stale_tx, /*test_accept=*/true);\n+            if (mempool_acceptable.m_result_type == MempoolAcceptResult::ResultType::VALID) {\n+                LogDebug(BCLog::PRIVATE_BROADCAST,\n+                         \"Reattempting broadcast of stale txid=%s wtxid=%s\",\n+                         stale_tx->GetHash().ToString(),\n+                         stale_tx->GetWitnessHash().ToString());\n+                ++num_for_rebroadcast;\n+            } else {\n+                LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                              BCLog::Level::Info,\n+                              \"Giving up broadcast attempts for txid=%s wtxid=%s: %s\",\n+                              stale_tx->GetHash().ToString(),\n+                              stale_tx->GetWitnessHash().ToString(),\n+                              mempool_acceptable.m_state.ToString());\n+                m_tx_for_private_broadcast.Remove(stale_tx);",
      "path": "src/net_processing.cpp",
      "position": 252,
      "original_position": 71,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "655af5976571ec694ba5aa57b35b3882e0a48cab",
      "in_reply_to_id": 2047059613,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> stale_tx came from the private broadcast storage, is the original transaction, not the malleated one.\r\n\r\nohh missed that, will check it again.\r\n\r\nEDIT: ok got it now. 1st `Remove()` is called with the malleated tx and that doesn't remove it from `m_by_txid` but the 2nd `Remove()` is called with our original tx and that does remove it from `m_by_txid`. Feel free to mark this as resolved!",
      "created_at": "2025-04-30T08:21:29Z",
      "updated_at": "2025-05-01T04:33:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2068145404",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2068145404"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1692,
      "original_line": 1692,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2150303487",
      "pull_request_review_id": 2932613802,
      "id": 2150303487,
      "node_id": "PRRC_kwDOABII586AKwb_",
      "diff_hunk": "@@ -3451,10 +3606,16 @@ void CConnman::Interrupt()\n             semAddnode->release();\n         }\n     }\n+\n+    m_private_broadcast.m_sem_conn_max.release();\n+    m_private_broadcast.NumToOpenAdd(1);",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 191,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "cd862a990fd04166a7e065848cf45b6779530171",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: this could have a comment (we don't really want to add a request, just unblock `NumToOpenWait` to be able to continue with shutdown).",
      "created_at": "2025-06-16T15:31:50Z",
      "updated_at": "2025-06-16T15:37:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2150303487",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2150303487"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3611,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2154241299",
      "pull_request_review_id": 2938647318,
      "id": 2154241299,
      "node_id": "PRRC_kwDOABII586AZx0T",
      "diff_hunk": "@@ -3451,10 +3606,16 @@ void CConnman::Interrupt()\n             semAddnode->release();\n         }\n     }\n+\n+    m_private_broadcast.m_sem_conn_max.release();\n+    m_private_broadcast.NumToOpenAdd(1);",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 191,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "cd862a990fd04166a7e065848cf45b6779530171",
      "in_reply_to_id": 2150303487,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Added a comment.",
      "created_at": "2025-06-18T10:21:34Z",
      "updated_at": "2025-06-18T10:21:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2154241299",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2154241299"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3611,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2160495059",
      "pull_request_review_id": 2948341713,
      "id": 2160495059,
      "node_id": "PRRC_kwDOABII586AxonT",
      "diff_hunk": "@@ -0,0 +1,390 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\"\"\"\n+\n+import time\n+import threading\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    malleate_tx,\n+    msg_inv,\n+)\n+from test_framework.netutil import (\n+    format_addr_port\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    assert_raises_rpc_error,\n+    p2p_port,\n+    tor_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 3\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+ADDRMAN_ADDRESSES = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        # Tor ports are the highest among p2p/rpc/tor, so this should be the first available port.\n+        ports_base = tor_port(MAX_NODES) + 1\n+\n+        self.destinations = []\n+\n+        self.destinations_lock = threading.Lock()\n+\n+        def destinations_factory(requested_to_addr, requested_to_port):\n+            with self.destinations_lock:\n+                i = len(self.destinations)\n+                actual_to_addr = \"\"\n+                actual_to_port = 0\n+                listener = None\n+                if i == NUM_INITIAL_CONNECTIONS:\n+                    # Instruct the SOCKS5 server to redirect the first private\n+                    # broadcast connection from nodes[0] to nodes[1]\n+                    actual_to_addr = \"127.0.0.1\" # nodes[1] listen address\n+                    actual_to_port = tor_port(1) # nodes[1] listen port for Tor\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (nodes[1])\")\n+                else:\n+                    # Create a Python P2P listening node and instruct the SOCKS5 proxy to\n+                    # redirect the connection to it. The first outbound connection is used\n+                    # later to serve GETDATA, thus make it P2PDataStore().\n+                    listener = P2PDataStore() if i == 0 else P2PInterface()\n+                    listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                    listener.peer_connect_send_version(services=P2P_SERVICES)\n+\n+                    def on_listen_done(addr, port):\n+                        nonlocal actual_to_addr\n+                        nonlocal actual_to_port\n+                        actual_to_addr = addr\n+                        actual_to_port = port\n+\n+                    self.network_thread.listen(\n+                        addr=\"127.0.0.1\",\n+                        port=ports_base + i,\n+                        p2p=listener,\n+                        callback=on_listen_done)\n+                    # Wait until the callback has been called.\n+                    self.wait_until(lambda: actual_to_port != 0)\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (a Python node)\")\n+\n+                self.destinations.append({\n+                    \"requested_to\": format_addr_port(requested_to_addr, requested_to_port),\n+                    \"node\": listener,\n+                })\n+                assert_equal(len(self.destinations), i + 1)\n+\n+                return {\n+                    \"actual_to_addr\": actual_to_addr,\n+                    \"actual_to_port\": actual_to_port,\n+                }\n+\n+        self.socks5_server.conf.destinations_factory = destinations_factory\n+\n+        self.extra_args = [\n+            [\n+                # Needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-cjdnsreachable\",\n+                # Connecting, sending garbage, being disconnected messes up with this test's\n+                # check_broadcasts() which waits for a particular Python node to receive a connection.\n+                \"-v2transport=0\",\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{tor_port(1)}=onion\",\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def check_broadcasts(self, label, tx, broadcasts_to_expect, skip_destinations):\n+        broadcasts_done = 0\n+        i = skip_destinations - 1\n+        while broadcasts_done < broadcasts_to_expect:\n+            i += 1\n+            self.log.debug(f\"{label}: waiting for outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            self.wait_until(lambda: len(self.destinations) > i)\n+            dest = self.destinations[i]\n+            peer = dest[\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"inv\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.txid_hex, tx[\"txid\"])\n+            self.log.info(f\"{label}: ok: outbound connection i={i} is private broadcast of txid={tx['txid']}\")\n+            broadcasts_done += 1\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+        tx_receiver = self.nodes[1]\n+        far_observer = tx_receiver.add_p2p_connection(P2PInterface())\n+\n+        wallet = MiniWallet(tx_originator)\n+\n+        # Fill tx_originator's addrman.\n+        for addr in ADDRMAN_ADDRESSES:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: len(self.destinations) == NUM_INITIAL_CONNECTIONS)\n+\n+        # The next opened connection by tx_originator should be \"private broadcast\"\n+        # for sending the transaction. The SOCKS5 proxy should redirect it to tx_receiver.\n+\n+        txs = wallet.create_self_transfer_chain(chain_length=3)\n+        self.log.info(f\"Created txid={txs[0]['txid']}: for basic test\")\n+        self.log.info(f\"Created txid={txs[1]['txid']}: for broadcast with dependency in mempool + rebroadcast\")\n+        self.log.info(f\"Created txid={txs[2]['txid']}: for broadcast with dependency not in mempool\")\n+        tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        self.log.debug(f\"Waiting for outbound connection i={NUM_INITIAL_CONNECTIONS}, \"\n+                       \"must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(txs[0][\"txid\"])\n+        self.log.info(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: \"\n+                      \"the private broadcast target received and further relayed the transaction\")\n+\n+        # One already checked above, check the other NUM_PRIVATE_BROADCAST_PER_TX - 1 broadcasts.\n+        self.check_broadcasts(\"Basic\", txs[0], NUM_PRIVATE_BROADCAST_PER_TX - 1, NUM_INITIAL_CONNECTIONS + 1)\n+\n+        self.log.info(\"Resending the same transaction via RPC again\")\n+        ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={txs[0]['txid']}, wtxid={txs[0]['wtxid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[ignoring_msg.encode()]):\n+            tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        # TODO: Create a malleated valid witness (how?) and substitute malleate_tx() below:\n+        #self.log.info(\"Sending a malleated transaction with a valid witness via RPC\")\n+        #malleated_valid = malleate_tx(txs[0])\n+        #ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={malleated_valid.txid_hex}, wtxid={malleated_valid.getwtxid()}\"",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 318,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4a873c2a67fd33111da97ce675aee7994b99546c",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "```suggestion\r\n        #ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={malleated_valid.txid_hex}, wtxid={malleated_valid.wtxid_hex}\"\r\n```",
      "created_at": "2025-06-22T21:15:48Z",
      "updated_at": "2025-06-22T21:15:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2160495059",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2160495059"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 318,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2160767733",
      "pull_request_review_id": 2948737924,
      "id": 2160767733,
      "node_id": "PRRC_kwDOABII586AyrL1",
      "diff_hunk": "@@ -0,0 +1,390 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\"\"\"\n+\n+import time\n+import threading\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    malleate_tx,\n+    msg_inv,\n+)\n+from test_framework.netutil import (\n+    format_addr_port\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    assert_raises_rpc_error,\n+    p2p_port,\n+    tor_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 3\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+ADDRMAN_ADDRESSES = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        # Tor ports are the highest among p2p/rpc/tor, so this should be the first available port.\n+        ports_base = tor_port(MAX_NODES) + 1\n+\n+        self.destinations = []\n+\n+        self.destinations_lock = threading.Lock()\n+\n+        def destinations_factory(requested_to_addr, requested_to_port):\n+            with self.destinations_lock:\n+                i = len(self.destinations)\n+                actual_to_addr = \"\"\n+                actual_to_port = 0\n+                listener = None\n+                if i == NUM_INITIAL_CONNECTIONS:\n+                    # Instruct the SOCKS5 server to redirect the first private\n+                    # broadcast connection from nodes[0] to nodes[1]\n+                    actual_to_addr = \"127.0.0.1\" # nodes[1] listen address\n+                    actual_to_port = tor_port(1) # nodes[1] listen port for Tor\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (nodes[1])\")\n+                else:\n+                    # Create a Python P2P listening node and instruct the SOCKS5 proxy to\n+                    # redirect the connection to it. The first outbound connection is used\n+                    # later to serve GETDATA, thus make it P2PDataStore().\n+                    listener = P2PDataStore() if i == 0 else P2PInterface()\n+                    listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                    listener.peer_connect_send_version(services=P2P_SERVICES)\n+\n+                    def on_listen_done(addr, port):\n+                        nonlocal actual_to_addr\n+                        nonlocal actual_to_port\n+                        actual_to_addr = addr\n+                        actual_to_port = port\n+\n+                    self.network_thread.listen(\n+                        addr=\"127.0.0.1\",\n+                        port=ports_base + i,\n+                        p2p=listener,\n+                        callback=on_listen_done)\n+                    # Wait until the callback has been called.\n+                    self.wait_until(lambda: actual_to_port != 0)\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (a Python node)\")\n+\n+                self.destinations.append({\n+                    \"requested_to\": format_addr_port(requested_to_addr, requested_to_port),\n+                    \"node\": listener,\n+                })\n+                assert_equal(len(self.destinations), i + 1)\n+\n+                return {\n+                    \"actual_to_addr\": actual_to_addr,\n+                    \"actual_to_port\": actual_to_port,\n+                }\n+\n+        self.socks5_server.conf.destinations_factory = destinations_factory\n+\n+        self.extra_args = [\n+            [\n+                # Needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-cjdnsreachable\",\n+                # Connecting, sending garbage, being disconnected messes up with this test's\n+                # check_broadcasts() which waits for a particular Python node to receive a connection.\n+                \"-v2transport=0\",\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{tor_port(1)}=onion\",\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def check_broadcasts(self, label, tx, broadcasts_to_expect, skip_destinations):\n+        broadcasts_done = 0\n+        i = skip_destinations - 1\n+        while broadcasts_done < broadcasts_to_expect:\n+            i += 1\n+            self.log.debug(f\"{label}: waiting for outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            self.wait_until(lambda: len(self.destinations) > i)\n+            dest = self.destinations[i]\n+            peer = dest[\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"inv\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.txid_hex, tx[\"txid\"])\n+            self.log.info(f\"{label}: ok: outbound connection i={i} is private broadcast of txid={tx['txid']}\")\n+            broadcasts_done += 1\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+        tx_receiver = self.nodes[1]\n+        far_observer = tx_receiver.add_p2p_connection(P2PInterface())\n+\n+        wallet = MiniWallet(tx_originator)\n+\n+        # Fill tx_originator's addrman.\n+        for addr in ADDRMAN_ADDRESSES:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: len(self.destinations) == NUM_INITIAL_CONNECTIONS)\n+\n+        # The next opened connection by tx_originator should be \"private broadcast\"\n+        # for sending the transaction. The SOCKS5 proxy should redirect it to tx_receiver.\n+\n+        txs = wallet.create_self_transfer_chain(chain_length=3)\n+        self.log.info(f\"Created txid={txs[0]['txid']}: for basic test\")\n+        self.log.info(f\"Created txid={txs[1]['txid']}: for broadcast with dependency in mempool + rebroadcast\")\n+        self.log.info(f\"Created txid={txs[2]['txid']}: for broadcast with dependency not in mempool\")\n+        tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        self.log.debug(f\"Waiting for outbound connection i={NUM_INITIAL_CONNECTIONS}, \"\n+                       \"must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(txs[0][\"txid\"])\n+        self.log.info(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: \"\n+                      \"the private broadcast target received and further relayed the transaction\")\n+\n+        # One already checked above, check the other NUM_PRIVATE_BROADCAST_PER_TX - 1 broadcasts.\n+        self.check_broadcasts(\"Basic\", txs[0], NUM_PRIVATE_BROADCAST_PER_TX - 1, NUM_INITIAL_CONNECTIONS + 1)\n+\n+        self.log.info(\"Resending the same transaction via RPC again\")\n+        ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={txs[0]['txid']}, wtxid={txs[0]['wtxid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[ignoring_msg.encode()]):\n+            tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        # TODO: Create a malleated valid witness (how?) and substitute malleate_tx() below:\n+        #self.log.info(\"Sending a malleated transaction with a valid witness via RPC\")\n+        #malleated_valid = malleate_tx(txs[0])\n+        #ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={malleated_valid.txid_hex}, wtxid={malleated_valid.getwtxid()}\"",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 318,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4a873c2a67fd33111da97ce675aee7994b99546c",
      "in_reply_to_id": 2160495059,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "i've tried this test in https://github.com/stratospher/bitcoin/commit/c14812402aa370b448a46efad1b0e5a5af1199ee (built on top of https://github.com/bitcoin/bitcoin/pull/32385 )",
      "created_at": "2025-06-23T05:51:25Z",
      "updated_at": "2025-06-23T05:51:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2160767733",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2160767733"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 318,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2163681310",
      "pull_request_review_id": 2953341899,
      "id": 2163681310,
      "node_id": "PRRC_kwDOABII586A9yge",
      "diff_hunk": "@@ -0,0 +1,390 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\"\"\"\n+\n+import time\n+import threading\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    malleate_tx,\n+    msg_inv,\n+)\n+from test_framework.netutil import (\n+    format_addr_port\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    assert_raises_rpc_error,\n+    p2p_port,\n+    tor_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 3\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+ADDRMAN_ADDRESSES = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        # Tor ports are the highest among p2p/rpc/tor, so this should be the first available port.\n+        ports_base = tor_port(MAX_NODES) + 1\n+\n+        self.destinations = []\n+\n+        self.destinations_lock = threading.Lock()\n+\n+        def destinations_factory(requested_to_addr, requested_to_port):\n+            with self.destinations_lock:\n+                i = len(self.destinations)\n+                actual_to_addr = \"\"\n+                actual_to_port = 0\n+                listener = None\n+                if i == NUM_INITIAL_CONNECTIONS:\n+                    # Instruct the SOCKS5 server to redirect the first private\n+                    # broadcast connection from nodes[0] to nodes[1]\n+                    actual_to_addr = \"127.0.0.1\" # nodes[1] listen address\n+                    actual_to_port = tor_port(1) # nodes[1] listen port for Tor\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (nodes[1])\")\n+                else:\n+                    # Create a Python P2P listening node and instruct the SOCKS5 proxy to\n+                    # redirect the connection to it. The first outbound connection is used\n+                    # later to serve GETDATA, thus make it P2PDataStore().\n+                    listener = P2PDataStore() if i == 0 else P2PInterface()\n+                    listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                    listener.peer_connect_send_version(services=P2P_SERVICES)\n+\n+                    def on_listen_done(addr, port):\n+                        nonlocal actual_to_addr\n+                        nonlocal actual_to_port\n+                        actual_to_addr = addr\n+                        actual_to_port = port\n+\n+                    self.network_thread.listen(\n+                        addr=\"127.0.0.1\",\n+                        port=ports_base + i,\n+                        p2p=listener,\n+                        callback=on_listen_done)\n+                    # Wait until the callback has been called.\n+                    self.wait_until(lambda: actual_to_port != 0)\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (a Python node)\")\n+\n+                self.destinations.append({\n+                    \"requested_to\": format_addr_port(requested_to_addr, requested_to_port),\n+                    \"node\": listener,\n+                })\n+                assert_equal(len(self.destinations), i + 1)\n+\n+                return {\n+                    \"actual_to_addr\": actual_to_addr,\n+                    \"actual_to_port\": actual_to_port,\n+                }\n+\n+        self.socks5_server.conf.destinations_factory = destinations_factory\n+\n+        self.extra_args = [\n+            [\n+                # Needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-cjdnsreachable\",\n+                # Connecting, sending garbage, being disconnected messes up with this test's\n+                # check_broadcasts() which waits for a particular Python node to receive a connection.\n+                \"-v2transport=0\",\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{tor_port(1)}=onion\",\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def check_broadcasts(self, label, tx, broadcasts_to_expect, skip_destinations):\n+        broadcasts_done = 0\n+        i = skip_destinations - 1\n+        while broadcasts_done < broadcasts_to_expect:\n+            i += 1\n+            self.log.debug(f\"{label}: waiting for outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            self.wait_until(lambda: len(self.destinations) > i)\n+            dest = self.destinations[i]\n+            peer = dest[\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"inv\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.txid_hex, tx[\"txid\"])\n+            self.log.info(f\"{label}: ok: outbound connection i={i} is private broadcast of txid={tx['txid']}\")\n+            broadcasts_done += 1\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+        tx_receiver = self.nodes[1]\n+        far_observer = tx_receiver.add_p2p_connection(P2PInterface())\n+\n+        wallet = MiniWallet(tx_originator)\n+\n+        # Fill tx_originator's addrman.\n+        for addr in ADDRMAN_ADDRESSES:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: len(self.destinations) == NUM_INITIAL_CONNECTIONS)\n+\n+        # The next opened connection by tx_originator should be \"private broadcast\"\n+        # for sending the transaction. The SOCKS5 proxy should redirect it to tx_receiver.\n+\n+        txs = wallet.create_self_transfer_chain(chain_length=3)\n+        self.log.info(f\"Created txid={txs[0]['txid']}: for basic test\")\n+        self.log.info(f\"Created txid={txs[1]['txid']}: for broadcast with dependency in mempool + rebroadcast\")\n+        self.log.info(f\"Created txid={txs[2]['txid']}: for broadcast with dependency not in mempool\")\n+        tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        self.log.debug(f\"Waiting for outbound connection i={NUM_INITIAL_CONNECTIONS}, \"\n+                       \"must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(txs[0][\"txid\"])\n+        self.log.info(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: \"\n+                      \"the private broadcast target received and further relayed the transaction\")\n+\n+        # One already checked above, check the other NUM_PRIVATE_BROADCAST_PER_TX - 1 broadcasts.\n+        self.check_broadcasts(\"Basic\", txs[0], NUM_PRIVATE_BROADCAST_PER_TX - 1, NUM_INITIAL_CONNECTIONS + 1)\n+\n+        self.log.info(\"Resending the same transaction via RPC again\")\n+        ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={txs[0]['txid']}, wtxid={txs[0]['wtxid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[ignoring_msg.encode()]):\n+            tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        # TODO: Create a malleated valid witness (how?) and substitute malleate_tx() below:\n+        #self.log.info(\"Sending a malleated transaction with a valid witness via RPC\")\n+        #malleated_valid = malleate_tx(txs[0])\n+        #ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={malleated_valid.txid_hex}, wtxid={malleated_valid.getwtxid()}\"",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 318,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4a873c2a67fd33111da97ce675aee7994b99546c",
      "in_reply_to_id": 2160495059,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "@andrewtoth, right! I will change that next time I retouch, \"resolving\" this.\r\n\r\n@stratospher, thanks! Lets continue the discussion in https://github.com/bitcoin/bitcoin/pull/32385#discussion_r2163643282",
      "created_at": "2025-06-24T11:13:04Z",
      "updated_at": "2025-06-24T11:13:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2163681310",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2163681310"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 318,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2175685307",
      "pull_request_review_id": 2972293733,
      "id": 2175685307,
      "node_id": "PRRC_kwDOABII586BrlK7",
      "diff_hunk": "@@ -43,11 +45,21 @@ static RPCHelpMan sendrawtransaction()\n {\n     return RPCHelpMan{\n         \"sendrawtransaction\",\n-        \"Submit a raw transaction (serialized, hex-encoded) to local node and network.\\n\"\n-        \"\\nThe transaction will be sent unconditionally to all peers, so using sendrawtransaction\\n\"\n-        \"for manual rebroadcast may degrade privacy by leaking the transaction's origin, as\\n\"\n-        \"nodes will normally not rebroadcast non-wallet transactions already in their mempool.\\n\"\n+        \"Submit a raw transaction (serialized, hex-encoded) to the network.\\n\"\n+\n+        \"\\nIf -privatebroadcast is disabled, then the transaction will be put into the\\n\"\n+        \"local mempool of the node and will be sent unconditionally to all currently\\n\"\n+        \"connected peers, so using sendrawtransaction for manual rebroadcast will degrade\\n\"\n+        \"privacy by leaking the transaction's origin, as nodes will normally not\\n\"\n+        \"rebroadcast non-wallet transactions already in their mempool.\\n\"\n+\n+        \"\\nIf -privatebroadcast is enabled, then the transaction will be sent only via\\n\"\n+        \"dedicated, short-lived connections to Tor or I2P peers or IPv4/IPv6 peers\\n\"\n+        \"through the Tor network. This conceals the transaction origin. The transaction\\n\"\n+        \"will only enter the local mempool when it is received back from the network.\\n\"",
      "path": "src/rpc/mempool.cpp",
      "position": 32,
      "original_position": 32,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "a4c4dd9138d3eca68d483c3a0ecb1e013659d485",
      "in_reply_to_id": null,
      "user": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This should be in doc?",
      "created_at": "2025-06-30T18:47:49Z",
      "updated_at": "2025-06-30T19:07:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2175685307",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2175685307"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 51,
      "original_start_line": 50,
      "start_side": "RIGHT",
      "line": 60,
      "original_line": 60,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2189573061",
      "pull_request_review_id": 2993079818,
      "id": 2189573061,
      "node_id": "PRRC_kwDOABII586CgjvF",
      "diff_hunk": "@@ -43,11 +45,21 @@ static RPCHelpMan sendrawtransaction()\n {\n     return RPCHelpMan{\n         \"sendrawtransaction\",\n-        \"Submit a raw transaction (serialized, hex-encoded) to local node and network.\\n\"\n-        \"\\nThe transaction will be sent unconditionally to all peers, so using sendrawtransaction\\n\"\n-        \"for manual rebroadcast may degrade privacy by leaking the transaction's origin, as\\n\"\n-        \"nodes will normally not rebroadcast non-wallet transactions already in their mempool.\\n\"\n+        \"Submit a raw transaction (serialized, hex-encoded) to the network.\\n\"\n+\n+        \"\\nIf -privatebroadcast is disabled, then the transaction will be put into the\\n\"\n+        \"local mempool of the node and will be sent unconditionally to all currently\\n\"\n+        \"connected peers, so using sendrawtransaction for manual rebroadcast will degrade\\n\"\n+        \"privacy by leaking the transaction's origin, as nodes will normally not\\n\"\n+        \"rebroadcast non-wallet transactions already in their mempool.\\n\"\n+\n+        \"\\nIf -privatebroadcast is enabled, then the transaction will be sent only via\\n\"\n+        \"dedicated, short-lived connections to Tor or I2P peers or IPv4/IPv6 peers\\n\"\n+        \"through the Tor network. This conceals the transaction origin. The transaction\\n\"\n+        \"will only enter the local mempool when it is received back from the network.\\n\"",
      "path": "src/rpc/mempool.cpp",
      "position": 32,
      "original_position": 32,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "a4c4dd9138d3eca68d483c3a0ecb1e013659d485",
      "in_reply_to_id": 2175685307,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Which doc? This is in the output of `bitcoin-cli help sendrawtransaction`.",
      "created_at": "2025-07-07T10:05:12Z",
      "updated_at": "2025-07-07T10:05:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2189573061",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2189573061"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 51,
      "original_start_line": 50,
      "start_side": "RIGHT",
      "line": 60,
      "original_line": 60,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2190771746",
      "pull_request_review_id": 2994903297,
      "id": 2190771746,
      "node_id": "PRRC_kwDOABII586ClIYi",
      "diff_hunk": "@@ -43,11 +45,21 @@ static RPCHelpMan sendrawtransaction()\n {\n     return RPCHelpMan{\n         \"sendrawtransaction\",\n-        \"Submit a raw transaction (serialized, hex-encoded) to local node and network.\\n\"\n-        \"\\nThe transaction will be sent unconditionally to all peers, so using sendrawtransaction\\n\"\n-        \"for manual rebroadcast may degrade privacy by leaking the transaction's origin, as\\n\"\n-        \"nodes will normally not rebroadcast non-wallet transactions already in their mempool.\\n\"\n+        \"Submit a raw transaction (serialized, hex-encoded) to the network.\\n\"\n+\n+        \"\\nIf -privatebroadcast is disabled, then the transaction will be put into the\\n\"\n+        \"local mempool of the node and will be sent unconditionally to all currently\\n\"\n+        \"connected peers, so using sendrawtransaction for manual rebroadcast will degrade\\n\"\n+        \"privacy by leaking the transaction's origin, as nodes will normally not\\n\"\n+        \"rebroadcast non-wallet transactions already in their mempool.\\n\"\n+\n+        \"\\nIf -privatebroadcast is enabled, then the transaction will be sent only via\\n\"\n+        \"dedicated, short-lived connections to Tor or I2P peers or IPv4/IPv6 peers\\n\"\n+        \"through the Tor network. This conceals the transaction origin. The transaction\\n\"\n+        \"will only enter the local mempool when it is received back from the network.\\n\"",
      "path": "src/rpc/mempool.cpp",
      "position": 32,
      "original_position": 32,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "a4c4dd9138d3eca68d483c3a0ecb1e013659d485",
      "in_reply_to_id": 2175685307,
      "user": {
        "login": "ismaelsadeeq",
        "id": 48946461,
        "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ismaelsadeeq",
        "html_url": "https://github.com/ismaelsadeeq",
        "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
        "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
        "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
        "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
        "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "\r\n> \"So using `sendrawtransaction` for manual rebroadcast will degrade privacy by leaking the transaction's origin.\"\r\n> \"This conceals the transaction origin.\"\r\n\r\nWhat I meant is that this seems to go beyond the scope of API docs imo? Perhaps we should have a dedicated privacy section in the docs maybe something like `doc/privacy` which could include:\r\n\r\n* The existing content from [[doc/tor.md#4-privacy-recommendations](https://github.com/bitcoin/bitcoin/blob/master/doc/tor.md#4-privacy-recommendations)](https://github.com/bitcoin/bitcoin/blob/master/doc/tor.md#4-privacy-recommendations)\r\n* Brief overviews of I2P and CJDNS, with links to them and what they provide\r\n* Documentation of the newly introduced `-privatebroadcast` option\r\n",
      "created_at": "2025-07-07T18:21:13Z",
      "updated_at": "2025-07-07T18:21:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2190771746",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2190771746"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 51,
      "original_start_line": 50,
      "start_side": "RIGHT",
      "line": 60,
      "original_line": 60,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2207333383",
      "pull_request_review_id": 3020057278,
      "id": 2207333383,
      "node_id": "PRRC_kwDOABII586DkTwH",
      "diff_hunk": "@@ -43,11 +45,21 @@ static RPCHelpMan sendrawtransaction()\n {\n     return RPCHelpMan{\n         \"sendrawtransaction\",\n-        \"Submit a raw transaction (serialized, hex-encoded) to local node and network.\\n\"\n-        \"\\nThe transaction will be sent unconditionally to all peers, so using sendrawtransaction\\n\"\n-        \"for manual rebroadcast may degrade privacy by leaking the transaction's origin, as\\n\"\n-        \"nodes will normally not rebroadcast non-wallet transactions already in their mempool.\\n\"\n+        \"Submit a raw transaction (serialized, hex-encoded) to the network.\\n\"\n+\n+        \"\\nIf -privatebroadcast is disabled, then the transaction will be put into the\\n\"\n+        \"local mempool of the node and will be sent unconditionally to all currently\\n\"\n+        \"connected peers, so using sendrawtransaction for manual rebroadcast will degrade\\n\"\n+        \"privacy by leaking the transaction's origin, as nodes will normally not\\n\"\n+        \"rebroadcast non-wallet transactions already in their mempool.\\n\"\n+\n+        \"\\nIf -privatebroadcast is enabled, then the transaction will be sent only via\\n\"\n+        \"dedicated, short-lived connections to Tor or I2P peers or IPv4/IPv6 peers\\n\"\n+        \"through the Tor network. This conceals the transaction origin. The transaction\\n\"\n+        \"will only enter the local mempool when it is received back from the network.\\n\"",
      "path": "src/rpc/mempool.cpp",
      "position": 32,
      "original_position": 32,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "a4c4dd9138d3eca68d483c3a0ecb1e013659d485",
      "in_reply_to_id": 2175685307,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> something like `doc/privacy`\r\n\r\nConcept ACK. Out of the scope of this PR.",
      "created_at": "2025-07-15T12:22:28Z",
      "updated_at": "2025-07-15T12:22:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2207333383",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2207333383"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": 51,
      "original_start_line": 50,
      "start_side": "RIGHT",
      "line": 60,
      "original_line": 60,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2214749431",
      "pull_request_review_id": 3031612913,
      "id": 2214749431,
      "node_id": "PRRC_kwDOABII586EAmT3",
      "diff_hunk": "@@ -0,0 +1,390 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\"\"\"\n+\n+import time\n+import threading\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    MSG_WTX,\n+    malleate_tx,\n+    msg_inv,\n+)\n+from test_framework.netutil import (\n+    format_addr_port\n+)\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    assert_raises_rpc_error,\n+    p2p_port,\n+    tor_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 3\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+ADDRMAN_ADDRESSES = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        # Tor ports are the highest among p2p/rpc/tor, so this should be the first available port.\n+        ports_base = tor_port(MAX_NODES) + 1\n+\n+        self.destinations = []\n+\n+        self.destinations_lock = threading.Lock()\n+\n+        def destinations_factory(requested_to_addr, requested_to_port):\n+            with self.destinations_lock:\n+                i = len(self.destinations)\n+                actual_to_addr = \"\"\n+                actual_to_port = 0\n+                listener = None\n+                if i == NUM_INITIAL_CONNECTIONS:\n+                    # Instruct the SOCKS5 server to redirect the first private\n+                    # broadcast connection from nodes[0] to nodes[1]\n+                    actual_to_addr = \"127.0.0.1\" # nodes[1] listen address\n+                    actual_to_port = tor_port(1) # nodes[1] listen port for Tor\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (nodes[1])\")\n+                else:\n+                    # Create a Python P2P listening node and instruct the SOCKS5 proxy to\n+                    # redirect the connection to it. The first outbound connection is used\n+                    # later to serve GETDATA, thus make it P2PDataStore().\n+                    listener = P2PDataStore() if i == 0 else P2PInterface()\n+                    listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                    listener.peer_connect_send_version(services=P2P_SERVICES)\n+\n+                    def on_listen_done(addr, port):\n+                        nonlocal actual_to_addr\n+                        nonlocal actual_to_port\n+                        actual_to_addr = addr\n+                        actual_to_port = port\n+\n+                    self.network_thread.listen(\n+                        addr=\"127.0.0.1\",\n+                        port=ports_base + i,\n+                        p2p=listener,\n+                        callback=on_listen_done)\n+                    # Wait until the callback has been called.\n+                    self.wait_until(lambda: actual_to_port != 0)\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (a Python node)\")\n+\n+                self.destinations.append({\n+                    \"requested_to\": format_addr_port(requested_to_addr, requested_to_port),\n+                    \"node\": listener,\n+                })\n+                assert_equal(len(self.destinations), i + 1)\n+\n+                return {\n+                    \"actual_to_addr\": actual_to_addr,\n+                    \"actual_to_port\": actual_to_port,\n+                }\n+\n+        self.socks5_server.conf.destinations_factory = destinations_factory\n+\n+        self.extra_args = [\n+            [\n+                # Needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-cjdnsreachable\",\n+                # Connecting, sending garbage, being disconnected messes up with this test's\n+                # check_broadcasts() which waits for a particular Python node to receive a connection.\n+                \"-v2transport=0\",\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{tor_port(1)}=onion\",\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def check_broadcasts(self, label, tx, broadcasts_to_expect, skip_destinations):\n+        broadcasts_done = 0\n+        i = skip_destinations - 1\n+        while broadcasts_done < broadcasts_to_expect:\n+            i += 1\n+            self.log.debug(f\"{label}: waiting for outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            self.wait_until(lambda: len(self.destinations) > i)\n+            dest = self.destinations[i]\n+            peer = dest[\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"inv\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.txid_hex, tx[\"txid\"])\n+            self.log.info(f\"{label}: ok: outbound connection i={i} is private broadcast of txid={tx['txid']}\")\n+            broadcasts_done += 1\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+        tx_receiver = self.nodes[1]\n+        far_observer = tx_receiver.add_p2p_connection(P2PInterface())\n+\n+        wallet = MiniWallet(tx_originator)\n+\n+        # Fill tx_originator's addrman.\n+        for addr in ADDRMAN_ADDRESSES:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: len(self.destinations) == NUM_INITIAL_CONNECTIONS)\n+\n+        # The next opened connection by tx_originator should be \"private broadcast\"\n+        # for sending the transaction. The SOCKS5 proxy should redirect it to tx_receiver.\n+\n+        txs = wallet.create_self_transfer_chain(chain_length=3)\n+        self.log.info(f\"Created txid={txs[0]['txid']}: for basic test\")\n+        self.log.info(f\"Created txid={txs[1]['txid']}: for broadcast with dependency in mempool + rebroadcast\")\n+        self.log.info(f\"Created txid={txs[2]['txid']}: for broadcast with dependency not in mempool\")\n+        tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        self.log.debug(f\"Waiting for outbound connection i={NUM_INITIAL_CONNECTIONS}, \"\n+                       \"must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(txs[0][\"txid\"])\n+        self.log.info(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: \"\n+                      \"the private broadcast target received and further relayed the transaction\")\n+\n+        # One already checked above, check the other NUM_PRIVATE_BROADCAST_PER_TX - 1 broadcasts.\n+        self.check_broadcasts(\"Basic\", txs[0], NUM_PRIVATE_BROADCAST_PER_TX - 1, NUM_INITIAL_CONNECTIONS + 1)\n+\n+        self.log.info(\"Resending the same transaction via RPC again\")\n+        ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={txs[0]['txid']}, wtxid={txs[0]['wtxid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[ignoring_msg.encode()]):\n+            tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        # TODO: Create a malleated valid witness (how?) and substitute malleate_tx() below:\n+        #self.log.info(\"Sending a malleated transaction with a valid witness via RPC\")\n+        #malleated_valid = malleate_tx(txs[0])\n+        #ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={malleated_valid.txid_hex}, wtxid={malleated_valid.getwtxid()}\"",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 318,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4a873c2a67fd33111da97ce675aee7994b99546c",
      "in_reply_to_id": 2160495059,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "You did not change it :(. It is commented out so it's not a deal breaker here.",
      "created_at": "2025-07-18T02:39:36Z",
      "updated_at": "2025-07-18T02:39:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2214749431",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2214749431"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 318,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2274730057",
      "pull_request_review_id": 3117833369,
      "id": 2274730057,
      "node_id": "PRRC_kwDOABII586HlaBJ",
      "diff_hunk": "@@ -655,6 +655,15 @@ void SetupServerArgs(ArgsManager& argsman, bool can_listen_ipc)\n                    OptionsCategory::NODE_RELAY);\n     argsman.AddArg(\"-minrelaytxfee=<amt>\", strprintf(\"Fees (in %s/kvB) smaller than this are considered zero fee for relaying, mining and transaction creation (default: %s)\",\n         CURRENCY_UNIT, FormatMoney(DEFAULT_MIN_RELAY_TX_FEE)), ArgsManager::ALLOW_ANY, OptionsCategory::NODE_RELAY);\n+    argsman.AddArg(\"-privatebroadcast\",\n+                   strprintf(\n+                       \"Broadcast transactions submitted via sendrawtransaction RPC using short lived \"",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 15,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "dbd76e68c3fd86814e96be85a2d23eb542df6e55",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "ee752253 two minor grammar touch-ups\r\n\r\n```suggestion\r\n                       \"Broadcast transactions submitted via sendrawtransaction RPC using short-lived \"\r\n```\r\n\r\nand on the next line, `s/networks without/networks, without/`",
      "created_at": "2025-08-13T21:51:20Z",
      "updated_at": "2025-08-13T22:07:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2274730057",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2274730057"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 660,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2314191993",
      "pull_request_review_id": 3173993648,
      "id": 2314191993,
      "node_id": "PRRC_kwDOABII586J78R5",
      "diff_hunk": "@@ -655,6 +655,15 @@ void SetupServerArgs(ArgsManager& argsman, bool can_listen_ipc)\n                    OptionsCategory::NODE_RELAY);\n     argsman.AddArg(\"-minrelaytxfee=<amt>\", strprintf(\"Fees (in %s/kvB) smaller than this are considered zero fee for relaying, mining and transaction creation (default: %s)\",\n         CURRENCY_UNIT, FormatMoney(DEFAULT_MIN_RELAY_TX_FEE)), ArgsManager::ALLOW_ANY, OptionsCategory::NODE_RELAY);\n+    argsman.AddArg(\"-privatebroadcast\",\n+                   strprintf(\n+                       \"Broadcast transactions submitted via sendrawtransaction RPC using short lived \"",
      "path": "src/init.cpp",
      "position": 1,
      "original_position": 15,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "dbd76e68c3fd86814e96be85a2d23eb542df6e55",
      "in_reply_to_id": 2274730057,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2025-09-01T15:06:09Z",
      "updated_at": "2025-09-01T15:06:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2314191993",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2314191993"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 660,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2328909174",
      "pull_request_review_id": 3194671681,
      "id": 2328909174,
      "node_id": "PRRC_kwDOABII586K0FV2",
      "diff_hunk": "@@ -0,0 +1,409 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\"\"\"\n+\n+import time\n+import threading\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    COIN,\n+    MSG_WTX,\n+    malleate_tx,\n+    msg_inv,\n+    msg_tx,\n+)\n+from test_framework.netutil import (\n+    format_addr_port\n+)\n+from test_framework.script_util import ValidWitnessMalleatedTx\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    assert_not_equal,\n+    assert_raises_rpc_error,\n+    p2p_port,\n+    tor_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 3\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+ADDRMAN_ADDRESSES = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        # Tor ports are the highest among p2p/rpc/tor, so this should be the first available port.\n+        ports_base = tor_port(MAX_NODES) + 1\n+\n+        self.destinations = []\n+\n+        self.destinations_lock = threading.Lock()\n+\n+        def destinations_factory(requested_to_addr, requested_to_port):\n+            with self.destinations_lock:\n+                i = len(self.destinations)\n+                actual_to_addr = \"\"\n+                actual_to_port = 0\n+                listener = None\n+                if i == NUM_INITIAL_CONNECTIONS:\n+                    # Instruct the SOCKS5 server to redirect the first private\n+                    # broadcast connection from nodes[0] to nodes[1]\n+                    actual_to_addr = \"127.0.0.1\" # nodes[1] listen address\n+                    actual_to_port = tor_port(1) # nodes[1] listen port for Tor\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (nodes[1])\")\n+                else:\n+                    # Create a Python P2P listening node and instruct the SOCKS5 proxy to\n+                    # redirect the connection to it. The first outbound connection is used\n+                    # later to serve GETDATA, thus make it P2PDataStore().\n+                    listener = P2PDataStore() if i == 0 else P2PInterface()\n+                    listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                    listener.peer_connect_send_version(services=P2P_SERVICES)\n+\n+                    def on_listen_done(addr, port):\n+                        nonlocal actual_to_addr\n+                        nonlocal actual_to_port\n+                        actual_to_addr = addr\n+                        actual_to_port = port\n+\n+                    self.network_thread.listen(\n+                        addr=\"127.0.0.1\",\n+                        port=ports_base + i,\n+                        p2p=listener,\n+                        callback=on_listen_done)\n+                    # Wait until the callback has been called.\n+                    self.wait_until(lambda: actual_to_port != 0)\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (a Python node)\")\n+\n+                self.destinations.append({\n+                    \"requested_to\": format_addr_port(requested_to_addr, requested_to_port),\n+                    \"node\": listener,\n+                })\n+                assert_equal(len(self.destinations), i + 1)\n+\n+                return {\n+                    \"actual_to_addr\": actual_to_addr,\n+                    \"actual_to_port\": actual_to_port,\n+                }\n+\n+        self.socks5_server.conf.destinations_factory = destinations_factory\n+\n+        self.extra_args = [\n+            [\n+                # Needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-cjdnsreachable\",\n+                # Connecting, sending garbage, being disconnected messes up with this test's\n+                # check_broadcasts() which waits for a particular Python node to receive a connection.\n+                \"-v2transport=0\",\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{tor_port(1)}=onion\",\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def check_broadcasts(self, label, tx, broadcasts_to_expect, skip_destinations):\n+        broadcasts_done = 0\n+        i = skip_destinations - 1\n+        while broadcasts_done < broadcasts_to_expect:\n+            i += 1\n+            self.log.debug(f\"{label}: waiting for outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            self.wait_until(lambda: len(self.destinations) > i)\n+            dest = self.destinations[i]\n+            peer = dest[\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"inv\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.txid_hex, tx[\"txid\"])\n+            self.log.info(f\"{label}: ok: outbound connection i={i} is private broadcast of txid={tx['txid']}\")\n+            broadcasts_done += 1\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+        tx_receiver = self.nodes[1]\n+        far_observer = tx_receiver.add_p2p_connection(P2PInterface())\n+\n+        wallet = MiniWallet(tx_originator)\n+\n+        # Fill tx_originator's addrman.\n+        for addr in ADDRMAN_ADDRESSES:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: len(self.destinations) == NUM_INITIAL_CONNECTIONS)\n+\n+        # The next opened connection by tx_originator should be \"private broadcast\"\n+        # for sending the transaction. The SOCKS5 proxy should redirect it to tx_receiver.\n+\n+        txs = wallet.create_self_transfer_chain(chain_length=3)\n+        self.log.info(f\"Created txid={txs[0]['txid']}: for basic test\")\n+        self.log.info(f\"Created txid={txs[1]['txid']}: for broadcast with dependency in mempool + rebroadcast\")\n+        self.log.info(f\"Created txid={txs[2]['txid']}: for broadcast with dependency not in mempool\")\n+        tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        self.log.debug(f\"Waiting for outbound connection i={NUM_INITIAL_CONNECTIONS}, \"\n+                       \"must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(txs[0][\"txid\"])\n+        self.log.info(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: \"\n+                      \"the private broadcast target received and further relayed the transaction\")\n+\n+        # One already checked above, check the other NUM_PRIVATE_BROADCAST_PER_TX - 1 broadcasts.\n+        self.check_broadcasts(\"Basic\", txs[0], NUM_PRIVATE_BROADCAST_PER_TX - 1, NUM_INITIAL_CONNECTIONS + 1)\n+\n+        self.log.info(\"Resending the same transaction via RPC again\")\n+        ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={txs[0]['txid']}, wtxid={txs[0]['wtxid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[ignoring_msg.encode()]):\n+            tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0)\n+\n+        self.log.info(\"Sending a malleated transaction with an invalid witness via RPC\")\n+        malleated_invalid = malleate_tx(txs[0])\n+        assert_raises_rpc_error(-26, \"mempool-script-verify-flag-failed\",\n+                                tx_originator.sendrawtransaction,\n+                                hexstring=malleated_invalid.serialize_with_witness().hex(),\n+                                maxfeerate=0.1)\n+\n+        self.log.info(\"Checking that the transaction is not in the originator node's mempool\")\n+        assert_equal(len(tx_originator.getrawmempool()), 0)\n+\n+        wtxid_int = int(txs[0][\"wtxid\"], 16)\n+        inv = CInv(MSG_WTX, wtxid_int)\n+\n+        self.log.info(\"Sending INV and waiting for GETDATA from node\")\n+        tx_returner = self.destinations[0][\"node\"] # Will return the transaction back to the originator.\n+        tx_returner.tx_store[wtxid_int] = txs[0][\"tx\"]\n+        assert \"getdata\" not in tx_returner.last_message\n+        received_back_msg = f\"Received our privately broadcast transaction (txid={txs[0]['txid']}) from the network\"\n+        with tx_originator.assert_debug_log(expected_msgs=[received_back_msg]):\n+            tx_returner.send_without_ping(msg_inv([inv]))\n+            tx_returner.wait_until(lambda: \"getdata\" in tx_returner.last_message)\n+            self.wait_until(lambda: len(tx_originator.getrawmempool()) > 0)\n+\n+        self.log.info(\"Waiting for normal broadcast to another peer\")\n+        self.destinations[1][\"node\"].wait_for_inv([inv])\n+\n+        self.log.info(\"Sending a transaction with a dependency in the mempool\")\n+        skip_destinations = len(self.destinations)\n+        tx_originator.sendrawtransaction(hexstring=txs[1][\"hex\"], maxfeerate=0.1)\n+        self.check_broadcasts(\"Dependency in mempool\", txs[1], NUM_PRIVATE_BROADCAST_PER_TX, skip_destinations)\n+\n+        self.log.info(\"Sending a transaction with a dependency not in the mempool (should be rejected)\")\n+        assert_equal(len(tx_originator.getrawmempool()), 1)\n+        assert_raises_rpc_error(-25, \"bad-txns-inputs-missingorspent\",\n+                                tx_originator.sendrawtransaction, hexstring=txs[2][\"hex\"], maxfeerate=0.1)\n+        assert_raises_rpc_error(-25, \"bad-txns-inputs-missingorspent\",\n+                                tx_originator.sendrawtransaction, hexstring=txs[2][\"hex\"], maxfeerate=0)\n+\n+        # Since txs[1] has not been received back by tx_originator,\n+        # it should be re-broadcast after a while. Advance tx_originator's clock\n+        # to trigger a re-broadcast. Should be more than the maximum returned by\n+        # NextTxBroadcast() in net_processing.cpp.\n+        self.log.info(\"Checking that rebroadcast works\")\n+        delta = 20 * 60 # 20min\n+        skip_destinations = len(self.destinations)\n+        rebroadcast_msg = f\"Reattempting broadcast of stale txid={txs[1]['txid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[rebroadcast_msg.encode()]):\n+            tx_originator.setmocktime(int(time.time()) + delta)\n+            tx_originator.mockscheduler(delta)\n+        self.check_broadcasts(\"Rebroadcast\", txs[1], 1, skip_destinations)\n+        tx_originator.setmocktime(0) # Let the clock tick again (it will go backwards due to this).\n+\n+        self.log.info(\"Sending a pair of transactions with same txid and different and valid wtxid via RPC\")",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 371,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4327327dd07457621fe1a9c88dfbf6fccb0e8854",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "grammar nit:\r\n```suggestion\r\n        self.log.info(\"Sending a pair of transactions with the same txid but different valid wtxids via RPC\")\r\n```",
      "created_at": "2025-09-08T00:15:28Z",
      "updated_at": "2025-09-08T00:27:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2328909174",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2328909174"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 371,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2329682120",
      "pull_request_review_id": 3195721839,
      "id": 2329682120,
      "node_id": "PRRC_kwDOABII586K3CDI",
      "diff_hunk": "@@ -0,0 +1,409 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\"\"\"\n+\n+import time\n+import threading\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    COIN,\n+    MSG_WTX,\n+    malleate_tx,\n+    msg_inv,\n+    msg_tx,\n+)\n+from test_framework.netutil import (\n+    format_addr_port\n+)\n+from test_framework.script_util import ValidWitnessMalleatedTx\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    assert_not_equal,\n+    assert_raises_rpc_error,\n+    p2p_port,\n+    tor_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 3\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+ADDRMAN_ADDRESSES = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        # Tor ports are the highest among p2p/rpc/tor, so this should be the first available port.\n+        ports_base = tor_port(MAX_NODES) + 1\n+\n+        self.destinations = []\n+\n+        self.destinations_lock = threading.Lock()\n+\n+        def destinations_factory(requested_to_addr, requested_to_port):\n+            with self.destinations_lock:\n+                i = len(self.destinations)\n+                actual_to_addr = \"\"\n+                actual_to_port = 0\n+                listener = None\n+                if i == NUM_INITIAL_CONNECTIONS:\n+                    # Instruct the SOCKS5 server to redirect the first private\n+                    # broadcast connection from nodes[0] to nodes[1]\n+                    actual_to_addr = \"127.0.0.1\" # nodes[1] listen address\n+                    actual_to_port = tor_port(1) # nodes[1] listen port for Tor\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (nodes[1])\")\n+                else:\n+                    # Create a Python P2P listening node and instruct the SOCKS5 proxy to\n+                    # redirect the connection to it. The first outbound connection is used\n+                    # later to serve GETDATA, thus make it P2PDataStore().\n+                    listener = P2PDataStore() if i == 0 else P2PInterface()\n+                    listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                    listener.peer_connect_send_version(services=P2P_SERVICES)\n+\n+                    def on_listen_done(addr, port):\n+                        nonlocal actual_to_addr\n+                        nonlocal actual_to_port\n+                        actual_to_addr = addr\n+                        actual_to_port = port\n+\n+                    self.network_thread.listen(\n+                        addr=\"127.0.0.1\",\n+                        port=ports_base + i,\n+                        p2p=listener,\n+                        callback=on_listen_done)\n+                    # Wait until the callback has been called.\n+                    self.wait_until(lambda: actual_to_port != 0)\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (a Python node)\")\n+\n+                self.destinations.append({\n+                    \"requested_to\": format_addr_port(requested_to_addr, requested_to_port),\n+                    \"node\": listener,\n+                })\n+                assert_equal(len(self.destinations), i + 1)\n+\n+                return {\n+                    \"actual_to_addr\": actual_to_addr,\n+                    \"actual_to_port\": actual_to_port,\n+                }\n+\n+        self.socks5_server.conf.destinations_factory = destinations_factory\n+\n+        self.extra_args = [\n+            [\n+                # Needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-cjdnsreachable\",\n+                # Connecting, sending garbage, being disconnected messes up with this test's\n+                # check_broadcasts() which waits for a particular Python node to receive a connection.\n+                \"-v2transport=0\",\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{tor_port(1)}=onion\",\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def check_broadcasts(self, label, tx, broadcasts_to_expect, skip_destinations):\n+        broadcasts_done = 0\n+        i = skip_destinations - 1\n+        while broadcasts_done < broadcasts_to_expect:\n+            i += 1\n+            self.log.debug(f\"{label}: waiting for outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            self.wait_until(lambda: len(self.destinations) > i)\n+            dest = self.destinations[i]\n+            peer = dest[\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"inv\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.txid_hex, tx[\"txid\"])\n+            self.log.info(f\"{label}: ok: outbound connection i={i} is private broadcast of txid={tx['txid']}\")\n+            broadcasts_done += 1\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+        tx_receiver = self.nodes[1]\n+        far_observer = tx_receiver.add_p2p_connection(P2PInterface())\n+\n+        wallet = MiniWallet(tx_originator)\n+\n+        # Fill tx_originator's addrman.\n+        for addr in ADDRMAN_ADDRESSES:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: len(self.destinations) == NUM_INITIAL_CONNECTIONS)\n+\n+        # The next opened connection by tx_originator should be \"private broadcast\"\n+        # for sending the transaction. The SOCKS5 proxy should redirect it to tx_receiver.\n+\n+        txs = wallet.create_self_transfer_chain(chain_length=3)\n+        self.log.info(f\"Created txid={txs[0]['txid']}: for basic test\")\n+        self.log.info(f\"Created txid={txs[1]['txid']}: for broadcast with dependency in mempool + rebroadcast\")\n+        self.log.info(f\"Created txid={txs[2]['txid']}: for broadcast with dependency not in mempool\")\n+        tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        self.log.debug(f\"Waiting for outbound connection i={NUM_INITIAL_CONNECTIONS}, \"\n+                       \"must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(txs[0][\"txid\"])\n+        self.log.info(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: \"\n+                      \"the private broadcast target received and further relayed the transaction\")\n+\n+        # One already checked above, check the other NUM_PRIVATE_BROADCAST_PER_TX - 1 broadcasts.\n+        self.check_broadcasts(\"Basic\", txs[0], NUM_PRIVATE_BROADCAST_PER_TX - 1, NUM_INITIAL_CONNECTIONS + 1)\n+\n+        self.log.info(\"Resending the same transaction via RPC again\")\n+        ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={txs[0]['txid']}, wtxid={txs[0]['wtxid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[ignoring_msg.encode()]):\n+            tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0)\n+\n+        self.log.info(\"Sending a malleated transaction with an invalid witness via RPC\")\n+        malleated_invalid = malleate_tx(txs[0])\n+        assert_raises_rpc_error(-26, \"mempool-script-verify-flag-failed\",\n+                                tx_originator.sendrawtransaction,\n+                                hexstring=malleated_invalid.serialize_with_witness().hex(),\n+                                maxfeerate=0.1)\n+\n+        self.log.info(\"Checking that the transaction is not in the originator node's mempool\")\n+        assert_equal(len(tx_originator.getrawmempool()), 0)\n+\n+        wtxid_int = int(txs[0][\"wtxid\"], 16)\n+        inv = CInv(MSG_WTX, wtxid_int)\n+\n+        self.log.info(\"Sending INV and waiting for GETDATA from node\")\n+        tx_returner = self.destinations[0][\"node\"] # Will return the transaction back to the originator.\n+        tx_returner.tx_store[wtxid_int] = txs[0][\"tx\"]\n+        assert \"getdata\" not in tx_returner.last_message\n+        received_back_msg = f\"Received our privately broadcast transaction (txid={txs[0]['txid']}) from the network\"\n+        with tx_originator.assert_debug_log(expected_msgs=[received_back_msg]):\n+            tx_returner.send_without_ping(msg_inv([inv]))\n+            tx_returner.wait_until(lambda: \"getdata\" in tx_returner.last_message)\n+            self.wait_until(lambda: len(tx_originator.getrawmempool()) > 0)\n+\n+        self.log.info(\"Waiting for normal broadcast to another peer\")\n+        self.destinations[1][\"node\"].wait_for_inv([inv])\n+\n+        self.log.info(\"Sending a transaction with a dependency in the mempool\")\n+        skip_destinations = len(self.destinations)\n+        tx_originator.sendrawtransaction(hexstring=txs[1][\"hex\"], maxfeerate=0.1)\n+        self.check_broadcasts(\"Dependency in mempool\", txs[1], NUM_PRIVATE_BROADCAST_PER_TX, skip_destinations)\n+\n+        self.log.info(\"Sending a transaction with a dependency not in the mempool (should be rejected)\")\n+        assert_equal(len(tx_originator.getrawmempool()), 1)\n+        assert_raises_rpc_error(-25, \"bad-txns-inputs-missingorspent\",\n+                                tx_originator.sendrawtransaction, hexstring=txs[2][\"hex\"], maxfeerate=0.1)\n+        assert_raises_rpc_error(-25, \"bad-txns-inputs-missingorspent\",\n+                                tx_originator.sendrawtransaction, hexstring=txs[2][\"hex\"], maxfeerate=0)\n+\n+        # Since txs[1] has not been received back by tx_originator,\n+        # it should be re-broadcast after a while. Advance tx_originator's clock\n+        # to trigger a re-broadcast. Should be more than the maximum returned by\n+        # NextTxBroadcast() in net_processing.cpp.\n+        self.log.info(\"Checking that rebroadcast works\")\n+        delta = 20 * 60 # 20min\n+        skip_destinations = len(self.destinations)\n+        rebroadcast_msg = f\"Reattempting broadcast of stale txid={txs[1]['txid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[rebroadcast_msg.encode()]):\n+            tx_originator.setmocktime(int(time.time()) + delta)\n+            tx_originator.mockscheduler(delta)\n+        self.check_broadcasts(\"Rebroadcast\", txs[1], 1, skip_destinations)\n+        tx_originator.setmocktime(0) # Let the clock tick again (it will go backwards due to this).\n+\n+        self.log.info(\"Sending a pair of transactions with same txid and different and valid wtxid via RPC\")",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 371,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4327327dd07457621fe1a9c88dfbf6fccb0e8854",
      "in_reply_to_id": 2328909174,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Changed locally, will be in the next push, thanks!",
      "created_at": "2025-09-08T09:29:35Z",
      "updated_at": "2025-09-08T09:29:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2329682120",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2329682120"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 371,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2340272853",
      "pull_request_review_id": 3210852105,
      "id": 2340272853,
      "node_id": "PRRC_kwDOABII586LfbrV",
      "diff_hunk": "@@ -0,0 +1,409 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\"\"\"\n+\n+import time\n+import threading\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    COIN,\n+    MSG_WTX,\n+    malleate_tx,\n+    msg_inv,\n+    msg_tx,\n+)\n+from test_framework.netutil import (\n+    format_addr_port\n+)\n+from test_framework.script_util import ValidWitnessMalleatedTx\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    assert_not_equal,\n+    assert_raises_rpc_error,\n+    p2p_port,\n+    tor_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 3\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+ADDRMAN_ADDRESSES = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        # Tor ports are the highest among p2p/rpc/tor, so this should be the first available port.\n+        ports_base = tor_port(MAX_NODES) + 1\n+\n+        self.destinations = []\n+\n+        self.destinations_lock = threading.Lock()\n+\n+        def destinations_factory(requested_to_addr, requested_to_port):\n+            with self.destinations_lock:\n+                i = len(self.destinations)\n+                actual_to_addr = \"\"\n+                actual_to_port = 0\n+                listener = None\n+                if i == NUM_INITIAL_CONNECTIONS:\n+                    # Instruct the SOCKS5 server to redirect the first private\n+                    # broadcast connection from nodes[0] to nodes[1]\n+                    actual_to_addr = \"127.0.0.1\" # nodes[1] listen address\n+                    actual_to_port = tor_port(1) # nodes[1] listen port for Tor\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (nodes[1])\")\n+                else:\n+                    # Create a Python P2P listening node and instruct the SOCKS5 proxy to\n+                    # redirect the connection to it. The first outbound connection is used\n+                    # later to serve GETDATA, thus make it P2PDataStore().\n+                    listener = P2PDataStore() if i == 0 else P2PInterface()\n+                    listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                    listener.peer_connect_send_version(services=P2P_SERVICES)\n+\n+                    def on_listen_done(addr, port):\n+                        nonlocal actual_to_addr\n+                        nonlocal actual_to_port\n+                        actual_to_addr = addr\n+                        actual_to_port = port\n+\n+                    self.network_thread.listen(\n+                        addr=\"127.0.0.1\",\n+                        port=ports_base + i,\n+                        p2p=listener,\n+                        callback=on_listen_done)\n+                    # Wait until the callback has been called.\n+                    self.wait_until(lambda: actual_to_port != 0)\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (a Python node)\")\n+\n+                self.destinations.append({\n+                    \"requested_to\": format_addr_port(requested_to_addr, requested_to_port),\n+                    \"node\": listener,\n+                })\n+                assert_equal(len(self.destinations), i + 1)\n+\n+                return {\n+                    \"actual_to_addr\": actual_to_addr,\n+                    \"actual_to_port\": actual_to_port,\n+                }\n+\n+        self.socks5_server.conf.destinations_factory = destinations_factory\n+\n+        self.extra_args = [\n+            [\n+                # Needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-cjdnsreachable\",\n+                # Connecting, sending garbage, being disconnected messes up with this test's\n+                # check_broadcasts() which waits for a particular Python node to receive a connection.\n+                \"-v2transport=0\",\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{tor_port(1)}=onion\",\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def check_broadcasts(self, label, tx, broadcasts_to_expect, skip_destinations):\n+        broadcasts_done = 0\n+        i = skip_destinations - 1\n+        while broadcasts_done < broadcasts_to_expect:\n+            i += 1\n+            self.log.debug(f\"{label}: waiting for outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            self.wait_until(lambda: len(self.destinations) > i)\n+            dest = self.destinations[i]\n+            peer = dest[\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"inv\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.txid_hex, tx[\"txid\"])\n+            self.log.info(f\"{label}: ok: outbound connection i={i} is private broadcast of txid={tx['txid']}\")\n+            broadcasts_done += 1\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+        tx_receiver = self.nodes[1]\n+        far_observer = tx_receiver.add_p2p_connection(P2PInterface())\n+\n+        wallet = MiniWallet(tx_originator)\n+\n+        # Fill tx_originator's addrman.\n+        for addr in ADDRMAN_ADDRESSES:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: len(self.destinations) == NUM_INITIAL_CONNECTIONS)\n+\n+        # The next opened connection by tx_originator should be \"private broadcast\"\n+        # for sending the transaction. The SOCKS5 proxy should redirect it to tx_receiver.\n+\n+        txs = wallet.create_self_transfer_chain(chain_length=3)\n+        self.log.info(f\"Created txid={txs[0]['txid']}: for basic test\")\n+        self.log.info(f\"Created txid={txs[1]['txid']}: for broadcast with dependency in mempool + rebroadcast\")\n+        self.log.info(f\"Created txid={txs[2]['txid']}: for broadcast with dependency not in mempool\")\n+        tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        self.log.debug(f\"Waiting for outbound connection i={NUM_INITIAL_CONNECTIONS}, \"\n+                       \"must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(txs[0][\"txid\"])\n+        self.log.info(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: \"\n+                      \"the private broadcast target received and further relayed the transaction\")\n+\n+        # One already checked above, check the other NUM_PRIVATE_BROADCAST_PER_TX - 1 broadcasts.\n+        self.check_broadcasts(\"Basic\", txs[0], NUM_PRIVATE_BROADCAST_PER_TX - 1, NUM_INITIAL_CONNECTIONS + 1)\n+\n+        self.log.info(\"Resending the same transaction via RPC again\")\n+        ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={txs[0]['txid']}, wtxid={txs[0]['wtxid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[ignoring_msg.encode()]):\n+            tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0)\n+\n+        self.log.info(\"Sending a malleated transaction with an invalid witness via RPC\")\n+        malleated_invalid = malleate_tx(txs[0])\n+        assert_raises_rpc_error(-26, \"mempool-script-verify-flag-failed\",\n+                                tx_originator.sendrawtransaction,\n+                                hexstring=malleated_invalid.serialize_with_witness().hex(),\n+                                maxfeerate=0.1)\n+\n+        self.log.info(\"Checking that the transaction is not in the originator node's mempool\")\n+        assert_equal(len(tx_originator.getrawmempool()), 0)\n+\n+        wtxid_int = int(txs[0][\"wtxid\"], 16)\n+        inv = CInv(MSG_WTX, wtxid_int)\n+\n+        self.log.info(\"Sending INV and waiting for GETDATA from node\")\n+        tx_returner = self.destinations[0][\"node\"] # Will return the transaction back to the originator.\n+        tx_returner.tx_store[wtxid_int] = txs[0][\"tx\"]\n+        assert \"getdata\" not in tx_returner.last_message\n+        received_back_msg = f\"Received our privately broadcast transaction (txid={txs[0]['txid']}) from the network\"\n+        with tx_originator.assert_debug_log(expected_msgs=[received_back_msg]):\n+            tx_returner.send_without_ping(msg_inv([inv]))\n+            tx_returner.wait_until(lambda: \"getdata\" in tx_returner.last_message)\n+            self.wait_until(lambda: len(tx_originator.getrawmempool()) > 0)\n+\n+        self.log.info(\"Waiting for normal broadcast to another peer\")\n+        self.destinations[1][\"node\"].wait_for_inv([inv])\n+\n+        self.log.info(\"Sending a transaction with a dependency in the mempool\")\n+        skip_destinations = len(self.destinations)\n+        tx_originator.sendrawtransaction(hexstring=txs[1][\"hex\"], maxfeerate=0.1)\n+        self.check_broadcasts(\"Dependency in mempool\", txs[1], NUM_PRIVATE_BROADCAST_PER_TX, skip_destinations)\n+\n+        self.log.info(\"Sending a transaction with a dependency not in the mempool (should be rejected)\")\n+        assert_equal(len(tx_originator.getrawmempool()), 1)\n+        assert_raises_rpc_error(-25, \"bad-txns-inputs-missingorspent\",\n+                                tx_originator.sendrawtransaction, hexstring=txs[2][\"hex\"], maxfeerate=0.1)\n+        assert_raises_rpc_error(-25, \"bad-txns-inputs-missingorspent\",\n+                                tx_originator.sendrawtransaction, hexstring=txs[2][\"hex\"], maxfeerate=0)\n+\n+        # Since txs[1] has not been received back by tx_originator,\n+        # it should be re-broadcast after a while. Advance tx_originator's clock\n+        # to trigger a re-broadcast. Should be more than the maximum returned by\n+        # NextTxBroadcast() in net_processing.cpp.\n+        self.log.info(\"Checking that rebroadcast works\")\n+        delta = 20 * 60 # 20min\n+        skip_destinations = len(self.destinations)\n+        rebroadcast_msg = f\"Reattempting broadcast of stale txid={txs[1]['txid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[rebroadcast_msg.encode()]):\n+            tx_originator.setmocktime(int(time.time()) + delta)\n+            tx_originator.mockscheduler(delta)\n+        self.check_broadcasts(\"Rebroadcast\", txs[1], 1, skip_destinations)\n+        tx_originator.setmocktime(0) # Let the clock tick again (it will go backwards due to this).\n+\n+        self.log.info(\"Sending a pair of transactions with same txid and different and valid wtxid via RPC\")",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 371,
      "commit_id": "3f6a61e3c59f3d1f193d79f1a5f4c7b379f05fb7",
      "original_commit_id": "4327327dd07457621fe1a9c88dfbf6fccb0e8854",
      "in_reply_to_id": 2328909174,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2025-09-11T11:20:46Z",
      "updated_at": "2025-09-11T11:20:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2340272853",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2340272853"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 371,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2493783865",
      "pull_request_review_id": 3420985495,
      "id": 2493783865,
      "node_id": "PRRC_kwDOABII586UpB85",
      "diff_hunk": "@@ -0,0 +1,409 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\"\"\"\n+\n+import time\n+import threading\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    COIN,\n+    MSG_WTX,\n+    malleate_tx,\n+    msg_inv,\n+    msg_tx,\n+)\n+from test_framework.netutil import (\n+    format_addr_port\n+)\n+from test_framework.script_util import ValidWitnessMalleatedTx\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    assert_not_equal,\n+    assert_raises_rpc_error,\n+    p2p_port,\n+    tor_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 3\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+ADDRMAN_ADDRESSES = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        # Tor ports are the highest among p2p/rpc/tor, so this should be the first available port.\n+        ports_base = tor_port(MAX_NODES) + 1\n+\n+        self.destinations = []\n+\n+        self.destinations_lock = threading.Lock()\n+\n+        def destinations_factory(requested_to_addr, requested_to_port):\n+            with self.destinations_lock:\n+                i = len(self.destinations)\n+                actual_to_addr = \"\"\n+                actual_to_port = 0\n+                listener = None\n+                if i == NUM_INITIAL_CONNECTIONS:\n+                    # Instruct the SOCKS5 server to redirect the first private\n+                    # broadcast connection from nodes[0] to nodes[1]\n+                    actual_to_addr = \"127.0.0.1\" # nodes[1] listen address\n+                    actual_to_port = tor_port(1) # nodes[1] listen port for Tor\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (nodes[1])\")\n+                else:\n+                    # Create a Python P2P listening node and instruct the SOCKS5 proxy to\n+                    # redirect the connection to it. The first outbound connection is used\n+                    # later to serve GETDATA, thus make it P2PDataStore().\n+                    listener = P2PDataStore() if i == 0 else P2PInterface()\n+                    listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                    listener.peer_connect_send_version(services=P2P_SERVICES)\n+\n+                    def on_listen_done(addr, port):\n+                        nonlocal actual_to_addr\n+                        nonlocal actual_to_port\n+                        actual_to_addr = addr\n+                        actual_to_port = port\n+\n+                    self.network_thread.listen(\n+                        addr=\"127.0.0.1\",\n+                        port=ports_base + i,\n+                        p2p=listener,\n+                        callback=on_listen_done)\n+                    # Wait until the callback has been called.\n+                    self.wait_until(lambda: actual_to_port != 0)\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (a Python node)\")\n+\n+                self.destinations.append({\n+                    \"requested_to\": format_addr_port(requested_to_addr, requested_to_port),\n+                    \"node\": listener,\n+                })\n+                assert_equal(len(self.destinations), i + 1)\n+\n+                return {\n+                    \"actual_to_addr\": actual_to_addr,\n+                    \"actual_to_port\": actual_to_port,\n+                }\n+\n+        self.socks5_server.conf.destinations_factory = destinations_factory\n+\n+        self.extra_args = [\n+            [\n+                # Needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-cjdnsreachable\",\n+                # Connecting, sending garbage, being disconnected messes up with this test's\n+                # check_broadcasts() which waits for a particular Python node to receive a connection.\n+                \"-v2transport=0\",\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{tor_port(1)}=onion\",\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def check_broadcasts(self, label, tx, broadcasts_to_expect, skip_destinations):\n+        broadcasts_done = 0\n+        i = skip_destinations - 1\n+        while broadcasts_done < broadcasts_to_expect:\n+            i += 1\n+            self.log.debug(f\"{label}: waiting for outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            self.wait_until(lambda: len(self.destinations) > i)\n+            dest = self.destinations[i]\n+            peer = dest[\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"inv\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.txid_hex, tx[\"txid\"])\n+            self.log.info(f\"{label}: ok: outbound connection i={i} is private broadcast of txid={tx['txid']}\")\n+            broadcasts_done += 1\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+        tx_receiver = self.nodes[1]\n+        far_observer = tx_receiver.add_p2p_connection(P2PInterface())\n+\n+        wallet = MiniWallet(tx_originator)\n+\n+        # Fill tx_originator's addrman.\n+        for addr in ADDRMAN_ADDRESSES:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: len(self.destinations) == NUM_INITIAL_CONNECTIONS)\n+\n+        # The next opened connection by tx_originator should be \"private broadcast\"\n+        # for sending the transaction. The SOCKS5 proxy should redirect it to tx_receiver.\n+\n+        txs = wallet.create_self_transfer_chain(chain_length=3)\n+        self.log.info(f\"Created txid={txs[0]['txid']}: for basic test\")\n+        self.log.info(f\"Created txid={txs[1]['txid']}: for broadcast with dependency in mempool + rebroadcast\")\n+        self.log.info(f\"Created txid={txs[2]['txid']}: for broadcast with dependency not in mempool\")\n+        tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        self.log.debug(f\"Waiting for outbound connection i={NUM_INITIAL_CONNECTIONS}, \"\n+                       \"must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(txs[0][\"txid\"])\n+        self.log.info(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: \"\n+                      \"the private broadcast target received and further relayed the transaction\")\n+\n+        # One already checked above, check the other NUM_PRIVATE_BROADCAST_PER_TX - 1 broadcasts.\n+        self.check_broadcasts(\"Basic\", txs[0], NUM_PRIVATE_BROADCAST_PER_TX - 1, NUM_INITIAL_CONNECTIONS + 1)\n+\n+        self.log.info(\"Resending the same transaction via RPC again\")\n+        ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={txs[0]['txid']}, wtxid={txs[0]['wtxid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[ignoring_msg.encode()]):\n+            tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0)",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 317,
      "commit_id": "ada059e714d66fede8b1323aec890f7da8589e7e",
      "original_commit_id": "ada059e714d66fede8b1323aec890f7da8589e7e",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I had a f2f discussion with somebody (forgot who?) of what happens if a transaction is submitted for private broadcast and is:\r\n\r\n1. previously submitted but not yet in the mempool\r\n2. in the mempool (and thus not in the for-private-broadcast list)\r\n\r\nThis part of the test answers 1. - if a transaction is already in the internal for-private-broadcast list then `sendrawtransaction` will error with \"Ignoring unnecessary request...\".\r\n\r\n\"2.\" is not exercised in the test, but what will happen is that the transaction will be broadcast. This will test it:\r\n\r\n```py\r\n        self.log.info(\"Sending a transaction that is already in the mempool\")\r\n        skip_destinations = len(self.destinations)\r\n        tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0)\r\n        self.check_broadcasts(\"Broadcast of mempool transaction\", txs[0], NUM_PRIVATE_BROADCAST_PER_TX, skip_destinations)\r\n```",
      "created_at": "2025-11-05T10:01:07Z",
      "updated_at": "2025-11-05T10:01:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2493783865",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2493783865"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 314,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 317,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2501363004",
      "pull_request_review_id": 3431175370,
      "id": 2501363004,
      "node_id": "PRRC_kwDOABII586VF8U8",
      "diff_hunk": "@@ -3131,6 +3215,83 @@ void CConnman::ThreadI2PAcceptIncoming()\n     }\n }\n \n+void CConnman::ThreadPrivateBroadcast()\n+{\n+    AssertLockNotHeld(m_unused_i2p_sessions_mutex);\n+\n+    size_t addrman_num_bad_addresses{0};\n+    while (!m_interrupt_net->interrupted()) {\n+\n+        if (!fNetworkActive) {\n+            m_interrupt_net->sleep_for(5s);\n+            continue;\n+        }\n+\n+        CountingSemaphoreGrant<> conn_max_grant{m_private_broadcast.m_sem_conn_max}; // Would block if too many are opened.\n+\n+        m_private_broadcast.NumToOpenWait();\n+\n+        if (m_interrupt_net->interrupted()) {\n+            break;\n+        }\n+\n+        std::optional<Proxy> proxy;\n+        const std::optional<Network> net{m_private_broadcast.PickNetwork(proxy)};\n+        if (!net.has_value()) {\n+            LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                          BCLog::Level::Warning,\n+                          \"Connections needed but none of the Tor or I2P networks is reachable\");\n+            m_interrupt_net->sleep_for(5s);\n+            continue;\n+        }\n+\n+        const auto [addr, _] = addrman.Select(/*new_only=*/false, {net.value()});\n+\n+        if (!addr.IsValid() || IsLocal(addr)) {\n+            ++addrman_num_bad_addresses;\n+            if (addrman_num_bad_addresses > 100) {\n+                m_interrupt_net->sleep_for(500ms);",
      "path": "src/net.cpp",
      "position": 162,
      "original_position": 162,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "ada059e714d66fede8b1323aec890f7da8589e7e",
      "in_reply_to_id": null,
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Perhaps a debug-level log here indicating poor quality addresses ?",
      "created_at": "2025-11-07T01:15:40Z",
      "updated_at": "2025-11-07T01:15:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2501363004",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2501363004"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3253,
      "original_line": 3253,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2502844387",
      "pull_request_review_id": 3433108197,
      "id": 2502844387,
      "node_id": "PRRC_kwDOABII586VLl_j",
      "diff_hunk": "@@ -3131,6 +3215,83 @@ void CConnman::ThreadI2PAcceptIncoming()\n     }\n }\n \n+void CConnman::ThreadPrivateBroadcast()\n+{\n+    AssertLockNotHeld(m_unused_i2p_sessions_mutex);\n+\n+    size_t addrman_num_bad_addresses{0};\n+    while (!m_interrupt_net->interrupted()) {\n+\n+        if (!fNetworkActive) {\n+            m_interrupt_net->sleep_for(5s);\n+            continue;\n+        }\n+\n+        CountingSemaphoreGrant<> conn_max_grant{m_private_broadcast.m_sem_conn_max}; // Would block if too many are opened.\n+\n+        m_private_broadcast.NumToOpenWait();\n+\n+        if (m_interrupt_net->interrupted()) {\n+            break;\n+        }\n+\n+        std::optional<Proxy> proxy;\n+        const std::optional<Network> net{m_private_broadcast.PickNetwork(proxy)};\n+        if (!net.has_value()) {\n+            LogPrintLevel(BCLog::PRIVATE_BROADCAST,\n+                          BCLog::Level::Warning,\n+                          \"Connections needed but none of the Tor or I2P networks is reachable\");\n+            m_interrupt_net->sleep_for(5s);\n+            continue;\n+        }\n+\n+        const auto [addr, _] = addrman.Select(/*new_only=*/false, {net.value()});\n+\n+        if (!addr.IsValid() || IsLocal(addr)) {\n+            ++addrman_num_bad_addresses;\n+            if (addrman_num_bad_addresses > 100) {\n+                m_interrupt_net->sleep_for(500ms);",
      "path": "src/net.cpp",
      "position": 162,
      "original_position": 162,
      "commit_id": "3e6b5a9ec460e763b62624c5cea7178975e804eb",
      "original_commit_id": "ada059e714d66fede8b1323aec890f7da8589e7e",
      "in_reply_to_id": 2501363004,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Added.",
      "created_at": "2025-11-07T11:06:05Z",
      "updated_at": "2025-11-07T11:06:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2502844387",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2502844387"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3253,
      "original_line": 3253,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2502847950",
      "pull_request_review_id": 3433111978,
      "id": 2502847950,
      "node_id": "PRRC_kwDOABII586VLm3O",
      "diff_hunk": "@@ -0,0 +1,409 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test how locally submitted transactions are sent to the network when private broadcast is used.\n+\"\"\"\n+\n+import time\n+import threading\n+\n+from test_framework.p2p import (\n+    P2PDataStore,\n+    P2PInterface,\n+    P2P_SERVICES,\n+    P2P_VERSION,\n+)\n+from test_framework.messages import (\n+    CAddress,\n+    CInv,\n+    COIN,\n+    MSG_WTX,\n+    malleate_tx,\n+    msg_inv,\n+    msg_tx,\n+)\n+from test_framework.netutil import (\n+    format_addr_port\n+)\n+from test_framework.script_util import ValidWitnessMalleatedTx\n+from test_framework.socks5 import (\n+    Socks5Configuration,\n+    Socks5Server,\n+)\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import (\n+    MAX_NODES,\n+    assert_equal,\n+    assert_not_equal,\n+    assert_raises_rpc_error,\n+    p2p_port,\n+    tor_port,\n+)\n+from test_framework.wallet import (\n+    MiniWallet,\n+)\n+\n+MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8\n+MAX_BLOCK_RELAY_ONLY_CONNECTIONS = 2\n+NUM_INITIAL_CONNECTIONS = MAX_OUTBOUND_FULL_RELAY_CONNECTIONS + MAX_BLOCK_RELAY_ONLY_CONNECTIONS\n+NUM_PRIVATE_BROADCAST_PER_TX = 3\n+\n+# Fill addrman with these addresses. Must have enough Tor addresses, so that even\n+# if all 10 default connections are opened to a Tor address (!?) there must be more\n+# for private broadcast.\n+ADDRMAN_ADDRESSES = [\n+    \"1.65.195.98\",\n+    \"2.59.236.56\",\n+    \"2.83.114.20\",\n+    \"2.248.194.16\",\n+    \"5.2.154.6\",\n+    \"5.101.140.30\",\n+    \"5.128.87.126\",\n+    \"5.144.21.49\",\n+    \"5.172.132.104\",\n+    \"5.188.62.18\",\n+    \"5.200.2.180\",\n+    \"8.129.184.255\",\n+    \"8.209.105.138\",\n+    \"12.34.98.148\",\n+    \"14.199.102.151\",\n+    \"18.27.79.17\",\n+    \"18.27.124.231\",\n+    \"18.216.249.151\",\n+    \"23.88.155.58\",\n+    \"23.93.101.158\",\n+    \"[2001:19f0:1000:1db3:5400:4ff:fe56:5a8d]\",\n+    \"[2001:19f0:5:24da:3eec:efff:feb9:f36e]\",\n+    \"[2001:19f0:5:24da::]\",\n+    \"[2001:19f0:5:4535:3eec:efff:feb9:87e4]\",\n+    \"[2001:19f0:5:4535::]\",\n+    \"[2001:1bc0:c1::2000]\",\n+    \"[2001:1c04:4008:6300:8a5f:2678:114b:a660]\",\n+    \"[2001:41d0:203:3739::]\",\n+    \"[2001:41d0:203:8f49::]\",\n+    \"[2001:41d0:203:bb0a::]\",\n+    \"[2001:41d0:2:bf8f::]\",\n+    \"[2001:41d0:303:de8b::]\",\n+    \"[2001:41d0:403:3d61::]\",\n+    \"[2001:41d0:405:9600::]\",\n+    \"[2001:41d0:8:ed7f::1]\",\n+    \"[2001:41d0:a:69a2::1]\",\n+    \"[2001:41f0::62:6974:636f:696e]\",\n+    \"[2001:470:1b62::]\",\n+    \"[2001:470:1f05:43b:2831:8530:7179:5864]\",\n+    \"[2001:470:1f09:b14::11]\",\n+    \"2bqghnldu6mcug4pikzprwhtjjnsyederctvci6klcwzepnjd46ikjyd.onion\",\n+    \"4lr3w2iyyl5u5l6tosizclykf5v3smqroqdn2i4h3kq6pfbbjb2xytad.onion\",\n+    \"5g72ppm3krkorsfopcm2bi7wlv4ohhs4u4mlseymasn7g7zhdcyjpfid.onion\",\n+    \"5sbmcl4m5api5tqafi4gcckrn3y52sz5mskxf3t6iw4bp7erwiptrgqd.onion\",\n+    \"776aegl7tfhg6oiqqy76jnwrwbvcytsx2qegcgh2mjqujll4376ohlid.onion\",\n+    \"77mdte42srl42shdh2mhtjr7nf7dmedqrw6bkcdekhdvmnld6ojyyiad.onion\",\n+    \"azbpsh4arqlm6442wfimy7qr65bmha2zhgjg7wbaji6vvaug53hur2qd.onion\",\n+    \"b64xcbleqmwgq2u46bh4hegnlrzzvxntyzbmucn3zt7cssm7y4ubv3id.onion\",\n+    \"bsqbtcparrfihlwolt4xgjbf4cgqckvrvsfyvy6vhiqrnh4w6ghixoid.onion\",\n+    \"bsqbtctulf2g4jtjsdfgl2ed7qs6zz5wqx27qnyiik7laockryvszqqd.onion\",\n+    \"cwi3ekrwhig47dhhzfenr5hbvckj7fzaojygvazi2lucsenwbzwoyiqd.onion\",\n+    \"devinbtcmwkuitvxl3tfi5of4zau46ymeannkjv6fpnylkgf3q5fa3id.onion\",\n+    \"devinbtcyk643iruzfpaxw3on2jket7rbjmwygm42dmdyub3ietrbmid.onion\",\n+    \"dtql5vci4iaml4anmueftqr7bfgzqlauzfy4rc2tfgulldd3ekyijjyd.onion\",\n+    \"emzybtc25oddoa2prol2znpz2axnrg6k77xwgirmhv7igoiucddsxiad.onion\",\n+    \"emzybtc3ewh7zihpkdvuwlgxrhzcxy2p5fvjggp7ngjbxcytxvt4rjid.onion\",\n+    \"emzybtc454ewbviqnmgtgx3rgublsgkk23r4onbhidcv36wremue4kqd.onion\",\n+    \"emzybtc5bnpb2o6gh54oquiox54o4r7yn4a2wiiwzrjonlouaibm2zid.onion\",\n+    \"fpz6r5ppsakkwypjcglz6gcnwt7ytfhxskkfhzu62tnylcknh3eq6pad.onion\",\n+    \"255fhcp6ajvftnyo7bwz3an3t4a4brhopm3bamyh2iu5r3gnr2rq.b32.i2p\",\n+    \"27yrtht5b5bzom2w5ajb27najuqvuydtzb7bavlak25wkufec5mq.b32.i2p\",\n+    \"3gocb7wc4zvbmmebktet7gujccuux4ifk3kqilnxnj5wpdpqx2hq.b32.i2p\",\n+    \"4fcc23wt3hyjk3csfzcdyjz5pcwg5dzhdqgma6bch2qyiakcbboa.b32.i2p\",\n+    \"4osyqeknhx5qf3a73jeimexwclmt42cju6xdp7icja4ixxguu2hq.b32.i2p\",\n+    \"4umsi4nlmgyp4rckosg4vegd2ysljvid47zu7pqsollkaszcbpqq.b32.i2p\",\n+    \"6j2ezegd3e2e2x3o3pox335f5vxfthrrigkdrbgfbdjchm5h4awa.b32.i2p\",\n+    \"6n36ljyr55szci5ygidmxqer64qr24f4qmnymnbvgehz7qinxnla.b32.i2p\",\n+    \"72yjs6mvlby3ky6mgpvvlemmwq5pfcznrzd34jkhclgrishqdxva.b32.i2p\",\n+    \"a5qsnv3maw77mlmmzlcglu6twje6ttctd3fhpbfwcbpmewx6fczq.b32.i2p\",\n+    \"aovep2pco7v2k4rheofrgytbgk23eg22dczpsjqgqtxcqqvmxk6a.b32.i2p\",\n+    \"bitcoi656nll5hu6u7ddzrmzysdtwtnzcnrjd4rfdqbeey7dmn5a.b32.i2p\",\n+    \"brifkruhlkgrj65hffybrjrjqcgdgqs2r7siizb5b2232nruik3a.b32.i2p\",\n+    \"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+    \"day3hgxyrtwjslt54sikevbhxxs4qzo7d6vi72ipmscqtq3qmijq.b32.i2p\",\n+    \"du5kydummi23bjfp6bd7owsvrijgt7zhvxmz5h5f5spcioeoetwq.b32.i2p\",\n+    \"e55k6wu46rzp4pg5pk5npgbr3zz45bc3ihtzu2xcye5vwnzdy7pq.b32.i2p\",\n+    \"eciohu5nq7vsvwjjc52epskuk75d24iccgzmhbzrwonw6lx4gdva.b32.i2p\",\n+    \"ejlnngarmhqvune74ko7kk55xtgbz5i5ncs4vmnvjpy3l7y63xaa.b32.i2p\",\n+    \"fhzlp3xroabohnmjonu5iqazwhlbbwh5cpujvw2azcu3srqdceja.b32.i2p\",\n+    \"[fc32:17ea:e415:c3bf:9808:149d:b5a2:c9aa]\",\n+    \"[fcc7:be49:ccd1:dc91:3125:f0da:457d:8ce]\",\n+    \"[fcdc:73ae:b1a9:1bf8:d4c2:811:a4c7:c34e]\",\n+]\n+\n+\n+class P2PPrivateBroadcast(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.disable_autoconnect = False\n+        self.num_nodes = 2\n+\n+    def setup_nodes(self):\n+        # Start a SOCKS5 proxy server.\n+        socks5_server_config = Socks5Configuration()\n+        # self.nodes[0] listens on p2p_port(0),\n+        # self.nodes[1] listens on p2p_port(1),\n+        # thus we tell the SOCKS5 server to listen on p2p_port(self.num_nodes (which is 2))\n+        socks5_server_config.addr = (\"127.0.0.1\", p2p_port(self.num_nodes))\n+        socks5_server_config.unauth = True\n+        socks5_server_config.auth = True\n+\n+        self.socks5_server = Socks5Server(socks5_server_config)\n+        self.socks5_server.start()\n+\n+        # Tor ports are the highest among p2p/rpc/tor, so this should be the first available port.\n+        ports_base = tor_port(MAX_NODES) + 1\n+\n+        self.destinations = []\n+\n+        self.destinations_lock = threading.Lock()\n+\n+        def destinations_factory(requested_to_addr, requested_to_port):\n+            with self.destinations_lock:\n+                i = len(self.destinations)\n+                actual_to_addr = \"\"\n+                actual_to_port = 0\n+                listener = None\n+                if i == NUM_INITIAL_CONNECTIONS:\n+                    # Instruct the SOCKS5 server to redirect the first private\n+                    # broadcast connection from nodes[0] to nodes[1]\n+                    actual_to_addr = \"127.0.0.1\" # nodes[1] listen address\n+                    actual_to_port = tor_port(1) # nodes[1] listen port for Tor\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (nodes[1])\")\n+                else:\n+                    # Create a Python P2P listening node and instruct the SOCKS5 proxy to\n+                    # redirect the connection to it. The first outbound connection is used\n+                    # later to serve GETDATA, thus make it P2PDataStore().\n+                    listener = P2PDataStore() if i == 0 else P2PInterface()\n+                    listener.peer_connect_helper(dstaddr=\"0.0.0.0\", dstport=0, net=self.chain, timeout_factor=self.options.timeout_factor)\n+                    listener.peer_connect_send_version(services=P2P_SERVICES)\n+\n+                    def on_listen_done(addr, port):\n+                        nonlocal actual_to_addr\n+                        nonlocal actual_to_port\n+                        actual_to_addr = addr\n+                        actual_to_port = port\n+\n+                    self.network_thread.listen(\n+                        addr=\"127.0.0.1\",\n+                        port=ports_base + i,\n+                        p2p=listener,\n+                        callback=on_listen_done)\n+                    # Wait until the callback has been called.\n+                    self.wait_until(lambda: actual_to_port != 0)\n+                    self.log.debug(f\"Instructing the SOCKS5 proxy to redirect connection i={i} to \"\n+                                   f\"{format_addr_port(actual_to_addr, actual_to_port)} (a Python node)\")\n+\n+                self.destinations.append({\n+                    \"requested_to\": format_addr_port(requested_to_addr, requested_to_port),\n+                    \"node\": listener,\n+                })\n+                assert_equal(len(self.destinations), i + 1)\n+\n+                return {\n+                    \"actual_to_addr\": actual_to_addr,\n+                    \"actual_to_port\": actual_to_port,\n+                }\n+\n+        self.socks5_server.conf.destinations_factory = destinations_factory\n+\n+        self.extra_args = [\n+            [\n+                # Needed to be able to add CJDNS addresses to addrman (otherwise they are unroutable).\n+                \"-cjdnsreachable\",\n+                # Connecting, sending garbage, being disconnected messes up with this test's\n+                # check_broadcasts() which waits for a particular Python node to receive a connection.\n+                \"-v2transport=0\",\n+                \"-test=addrman\",\n+                \"-privatebroadcast\",\n+                f\"-proxy={socks5_server_config.addr[0]}:{socks5_server_config.addr[1]}\",\n+            ],\n+            [\n+                \"-connect=0\",\n+                f\"-bind=127.0.0.1:{tor_port(1)}=onion\",\n+            ],\n+        ]\n+        super().setup_nodes()\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def check_broadcasts(self, label, tx, broadcasts_to_expect, skip_destinations):\n+        broadcasts_done = 0\n+        i = skip_destinations - 1\n+        while broadcasts_done < broadcasts_to_expect:\n+            i += 1\n+            self.log.debug(f\"{label}: waiting for outbound connection i={i}\")\n+            # At this point the connection may not yet have been established (A),\n+            # may be active (B), or may have already been closed (C).\n+            self.wait_until(lambda: len(self.destinations) > i)\n+            dest = self.destinations[i]\n+            peer = dest[\"node\"]\n+            peer.wait_until(lambda: peer.message_count[\"version\"] == 1, check_connected=False)\n+            # Now it is either (B) or (C).\n+            if peer.last_message[\"version\"].nServices != 0:\n+                self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} not a private broadcast, ignoring it (maybe feeler or extra block only)\")\n+                continue\n+            self.log.debug(f\"{label}: outbound connection i={i} to {dest['requested_to']} must be a private broadcast, checking it\")\n+            peer.wait_for_disconnect()\n+            # Now it is (C).\n+            assert_equal(peer.message_count, {\n+                \"version\": 1,\n+                \"verack\": 1,\n+                \"inv\": 1,\n+                \"tx\": 1,\n+                \"ping\": 1\n+            })\n+            dummy_address = CAddress()\n+            dummy_address.nServices = 0\n+            assert_equal(peer.last_message[\"version\"].nVersion, P2P_VERSION)\n+            assert_equal(peer.last_message[\"version\"].nServices, 0)\n+            assert_equal(peer.last_message[\"version\"].nTime, 0)\n+            assert_equal(peer.last_message[\"version\"].addrTo, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].addrFrom, dummy_address)\n+            assert_equal(peer.last_message[\"version\"].strSubVer, \"/pynode:0.0.1/\")\n+            assert_equal(peer.last_message[\"version\"].nStartingHeight, 0)\n+            assert_equal(peer.last_message[\"version\"].relay, 0)\n+            assert_equal(peer.last_message[\"tx\"].tx.txid_hex, tx[\"txid\"])\n+            self.log.info(f\"{label}: ok: outbound connection i={i} is private broadcast of txid={tx['txid']}\")\n+            broadcasts_done += 1\n+\n+    def run_test(self):\n+        tx_originator = self.nodes[0]\n+        tx_receiver = self.nodes[1]\n+        far_observer = tx_receiver.add_p2p_connection(P2PInterface())\n+\n+        wallet = MiniWallet(tx_originator)\n+\n+        # Fill tx_originator's addrman.\n+        for addr in ADDRMAN_ADDRESSES:\n+            res = tx_originator.addpeeraddress(address=addr, port=8333, tried=False)\n+            if not res[\"success\"]:\n+                self.log.debug(f\"Could not add {addr} to tx_originator's addrman (collision?)\")\n+\n+        self.wait_until(lambda: len(self.destinations) == NUM_INITIAL_CONNECTIONS)\n+\n+        # The next opened connection by tx_originator should be \"private broadcast\"\n+        # for sending the transaction. The SOCKS5 proxy should redirect it to tx_receiver.\n+\n+        txs = wallet.create_self_transfer_chain(chain_length=3)\n+        self.log.info(f\"Created txid={txs[0]['txid']}: for basic test\")\n+        self.log.info(f\"Created txid={txs[1]['txid']}: for broadcast with dependency in mempool + rebroadcast\")\n+        self.log.info(f\"Created txid={txs[2]['txid']}: for broadcast with dependency not in mempool\")\n+        tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0.1)\n+\n+        self.log.debug(f\"Waiting for outbound connection i={NUM_INITIAL_CONNECTIONS}, \"\n+                       \"must be the first private broadcast connection\")\n+        self.wait_until(lambda: len(tx_receiver.getrawmempool()) > 0)\n+        far_observer.wait_for_tx(txs[0][\"txid\"])\n+        self.log.info(f\"Outbound connection i={NUM_INITIAL_CONNECTIONS}: \"\n+                      \"the private broadcast target received and further relayed the transaction\")\n+\n+        # One already checked above, check the other NUM_PRIVATE_BROADCAST_PER_TX - 1 broadcasts.\n+        self.check_broadcasts(\"Basic\", txs[0], NUM_PRIVATE_BROADCAST_PER_TX - 1, NUM_INITIAL_CONNECTIONS + 1)\n+\n+        self.log.info(\"Resending the same transaction via RPC again\")\n+        ignoring_msg = f\"Ignoring unnecessary request to schedule an already scheduled transaction: txid={txs[0]['txid']}, wtxid={txs[0]['wtxid']}\"\n+        with tx_originator.busy_wait_for_debug_log(expected_msgs=[ignoring_msg.encode()]):\n+            tx_originator.sendrawtransaction(hexstring=txs[0][\"hex\"], maxfeerate=0)",
      "path": "test/functional/p2p_private_broadcast.py",
      "position": 1,
      "original_position": 317,
      "commit_id": "ada059e714d66fede8b1323aec890f7da8589e7e",
      "original_commit_id": "ada059e714d66fede8b1323aec890f7da8589e7e",
      "in_reply_to_id": 2493783865,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Extended the test with the above to cover the case where the transaction is already in the mempool.",
      "created_at": "2025-11-07T11:06:56Z",
      "updated_at": "2025-11-07T11:06:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2502847950",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2502847950"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": 314,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 317,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2525677364",
      "pull_request_review_id": 3462686432,
      "id": 2525677364,
      "node_id": "PRRC_kwDOABII586Wisc0",
      "diff_hunk": "@@ -1180,6 +1182,74 @@ class CConnman\n                                const std::optional<Proxy>& proxy_override = std::nullopt)\n         EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\n \n+    /// Group of private broadcast related members.\n+    class PrivateBroadcast\n+    {\n+    public:\n+        /**\n+         * Remember if we ever established at least one outbound connection to a\n+         * Tor peer, including sending and receiving P2P messages. If this is\n+         * true then the Tor proxy indeed works and is a proxy to the Tor network,\n+         * not a misconfigured ordinary SOCKS5 proxy as -proxy or -onion. If that\n+         * is the case, then we assume that connecting to an IPv4 or IPv6 address\n+         * via that proxy will be done through the Tor network and a Tor exit node.\n+         */\n+        std::atomic_bool m_outbound_tor_ok_at_least_once{false};\n+\n+        /**\n+         * Semaphore used to guard against opening too many connections.\n+         * Opening private broadcast connections will be paused if this is equal to 0.\n+         */\n+        std::counting_semaphore<> m_sem_conn_max{MAX_PRIVATE_BROADCAST_CONNECTIONS};\n+\n+        /**\n+         * Choose a network to open a connection to.\n+         * @param[out] proxy Optional proxy to override the normal proxy selection.\n+         * Will be set if !std::nullopt is returned. Could be set to `std::nullopt`\n+         * if there is no need to override the proxy that would be used for connecting\n+         * to the returned network.\n+         * @retval std::nullopt No network could be selected.\n+         * @retval !std::nullopt The network was selected and `proxy` is set (maybe to `std::nullopt`).\n+         */\n+        std::optional<Network> PickNetwork(std::optional<Proxy>& proxy) const;\n+\n+        /// Get the pending number of connections to open.\n+        size_t NumToOpen() const EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+        /**\n+         * Increment the number of new connections of type `ConnectionType::PRIVATE_BROADCAST`\n+         * to be opened by `CConnman::ThreadPrivateBroadcast()`.\n+         * @param[in] n Increment by this number.\n+         */\n+        void NumToOpenAdd(size_t n) EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+        /**\n+         * Decrement the number of new connections of type `ConnectionType::PRIVATE_BROADCAST`\n+         * to be opened by `CConnman::ThreadPrivateBroadcast()`.\n+         * @param[in] n Decrement by this number.\n+         * @return The number of connections that remain to be opened after the operation.\n+         */\n+        size_t NumToOpenSub(size_t n) EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+        /// Wait for the number of needed connections to become greater than 0.\n+        void NumToOpenWait() const EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+    private:\n+        /**\n+         * Check if private broadcast can be done to IPv4 or IPv6 peers and if so via which proxy.\n+         * If private broadcast connections should not be opened to IPv4 or IPv6, then this will\n+         * return an empty optional.\n+         */\n+        std::optional<Proxy> ProxyForIPv4or6() const;\n+\n+        /// Condition variable to wait for `m_num_to_open` to change.\n+        mutable std::condition_variable m_num_to_open_cond;\n+        /// Mutex protecting `m_num_to_open`.\n+        mutable Mutex m_num_to_open_mutex;\n+        /// Number of `ConnectionType::PRIVATE_BROADCAST` connections to open.\n+        size_t m_num_to_open GUARDED_BY(m_num_to_open_mutex){0};",
      "path": "src/net.h",
      "position": 1,
      "original_position": 78,
      "commit_id": "36ae854b1ddf98edce7adfe6448e3a57f36267e8",
      "original_commit_id": "11a339437b88ef739bc309f3f9ba90cf35d0a76f",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Would it be simpler to not bother with the mutex and condvar here?\r\n\r\n```diff\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex cd4bcf0ea3..16b2d61b60 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -3095,31 +3095,29 @@ std::optional<Network> CConnman::PrivateBroadcast::PickNetwork(std::optional<Pro\r\n \r\n size_t CConnman::PrivateBroadcast::NumToOpen() const\r\n {\r\n-    LOCK(m_num_to_open_mutex);\r\n     return m_num_to_open;\r\n }\r\n \r\n void CConnman::PrivateBroadcast::NumToOpenAdd(size_t n)\r\n {\r\n-    WITH_LOCK(m_num_to_open_mutex, m_num_to_open += n);\r\n-    m_num_to_open_cond.notify_all();\r\n+    m_num_to_open += n;\r\n+    m_num_to_open.notify_all();\r\n }\r\n \r\n size_t CConnman::PrivateBroadcast::NumToOpenSub(size_t n)\r\n {\r\n-    LOCK(m_num_to_open_mutex);\r\n-    if (m_num_to_open > n) {\r\n-        m_num_to_open -= n;\r\n-    } else {\r\n-        m_num_to_open = 0;\r\n-    }\r\n-    return m_num_to_open;\r\n+    size_t current_value{0};\r\n+    size_t new_value{0};\r\n+    do {\r\n+        current_value = m_num_to_open;\r\n+        new_value = current_value > n ? current_value - n : 0;\r\n+    } while (!m_num_to_open.compare_exchange_weak(current_value, new_value));\r\n+    return new_value;\r\n }\r\n \r\n void CConnman::PrivateBroadcast::NumToOpenWait() const\r\n {\r\n-    WAIT_LOCK(m_num_to_open_mutex, lock);\r\n-    m_num_to_open_cond.wait(lock, [&]() EXCLUSIVE_LOCKS_REQUIRED(m_num_to_open_mutex) { return m_num_to_open > 0; });\r\n+    m_num_to_open.wait(0);\r\n }\r\n \r\n std::optional<Proxy> CConnman::PrivateBroadcast::ProxyForIPv4or6() const\r\ndiff --git a/src/net.h b/src/net.h\r\nindex 2a9264066a..dbc01d8a03 100644\r\n--- a/src/net.h\r\n+++ b/src/net.h\r\n@@ -1214,14 +1214,14 @@ public:\r\n         std::optional<Network> PickNetwork(std::optional<Proxy>& proxy) const;\r\n \r\n         /// Get the pending number of connections to open.\r\n-        size_t NumToOpen() const EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\r\n+        size_t NumToOpen() const;\r\n \r\n         /**\r\n          * Increment the number of new connections of type `ConnectionType::PRIVATE_BROADCAST`\r\n          * to be opened by `CConnman::ThreadPrivateBroadcast()`.\r\n          * @param[in] n Increment by this number.\r\n          */\r\n-        void NumToOpenAdd(size_t n) EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\r\n+        void NumToOpenAdd(size_t n);\r\n \r\n         /**\r\n          * Decrement the number of new connections of type `ConnectionType::PRIVATE_BROADCAST`\r\n@@ -1229,10 +1229,10 @@ public:\r\n          * @param[in] n Decrement by this number.\r\n          * @return The number of connections that remain to be opened after the operation.\r\n          */\r\n-        size_t NumToOpenSub(size_t n) EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\r\n+        size_t NumToOpenSub(size_t n);\r\n \r\n         /// Wait for the number of needed connections to become greater than 0.\r\n-        void NumToOpenWait() const EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\r\n+        void NumToOpenWait() const;\r\n \r\n     private:\r\n         /**\r\n@@ -1242,12 +1242,8 @@ public:\r\n          */\r\n         std::optional<Proxy> ProxyForIPv4or6() const;\r\n \r\n-        /// Condition variable to wait for `m_num_to_open` to change.\r\n-        mutable std::condition_variable m_num_to_open_cond;\r\n-        /// Mutex protecting `m_num_to_open`.\r\n-        mutable Mutex m_num_to_open_mutex;\r\n         /// Number of `ConnectionType::PRIVATE_BROADCAST` connections to open.\r\n-        size_t m_num_to_open GUARDED_BY(m_num_to_open_mutex){0};\r\n+        std::atomic_size_t m_num_to_open{0};\r\n     } m_private_broadcast;\r\n \r\n     bool CheckIncomingNonce(uint64_t nonce);\r\n```\r\n     ",
      "created_at": "2025-11-14T04:09:44Z",
      "updated_at": "2025-11-14T04:09:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2525677364",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2525677364"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1250,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2526732684",
      "pull_request_review_id": 3463971437,
      "id": 2526732684,
      "node_id": "PRRC_kwDOABII586WmuGM",
      "diff_hunk": "@@ -1180,6 +1182,74 @@ class CConnman\n                                const std::optional<Proxy>& proxy_override = std::nullopt)\n         EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\n \n+    /// Group of private broadcast related members.\n+    class PrivateBroadcast\n+    {\n+    public:\n+        /**\n+         * Remember if we ever established at least one outbound connection to a\n+         * Tor peer, including sending and receiving P2P messages. If this is\n+         * true then the Tor proxy indeed works and is a proxy to the Tor network,\n+         * not a misconfigured ordinary SOCKS5 proxy as -proxy or -onion. If that\n+         * is the case, then we assume that connecting to an IPv4 or IPv6 address\n+         * via that proxy will be done through the Tor network and a Tor exit node.\n+         */\n+        std::atomic_bool m_outbound_tor_ok_at_least_once{false};\n+\n+        /**\n+         * Semaphore used to guard against opening too many connections.\n+         * Opening private broadcast connections will be paused if this is equal to 0.\n+         */\n+        std::counting_semaphore<> m_sem_conn_max{MAX_PRIVATE_BROADCAST_CONNECTIONS};\n+\n+        /**\n+         * Choose a network to open a connection to.\n+         * @param[out] proxy Optional proxy to override the normal proxy selection.\n+         * Will be set if !std::nullopt is returned. Could be set to `std::nullopt`\n+         * if there is no need to override the proxy that would be used for connecting\n+         * to the returned network.\n+         * @retval std::nullopt No network could be selected.\n+         * @retval !std::nullopt The network was selected and `proxy` is set (maybe to `std::nullopt`).\n+         */\n+        std::optional<Network> PickNetwork(std::optional<Proxy>& proxy) const;\n+\n+        /// Get the pending number of connections to open.\n+        size_t NumToOpen() const EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+        /**\n+         * Increment the number of new connections of type `ConnectionType::PRIVATE_BROADCAST`\n+         * to be opened by `CConnman::ThreadPrivateBroadcast()`.\n+         * @param[in] n Increment by this number.\n+         */\n+        void NumToOpenAdd(size_t n) EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+        /**\n+         * Decrement the number of new connections of type `ConnectionType::PRIVATE_BROADCAST`\n+         * to be opened by `CConnman::ThreadPrivateBroadcast()`.\n+         * @param[in] n Decrement by this number.\n+         * @return The number of connections that remain to be opened after the operation.\n+         */\n+        size_t NumToOpenSub(size_t n) EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+        /// Wait for the number of needed connections to become greater than 0.\n+        void NumToOpenWait() const EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+    private:\n+        /**\n+         * Check if private broadcast can be done to IPv4 or IPv6 peers and if so via which proxy.\n+         * If private broadcast connections should not be opened to IPv4 or IPv6, then this will\n+         * return an empty optional.\n+         */\n+        std::optional<Proxy> ProxyForIPv4or6() const;\n+\n+        /// Condition variable to wait for `m_num_to_open` to change.\n+        mutable std::condition_variable m_num_to_open_cond;\n+        /// Mutex protecting `m_num_to_open`.\n+        mutable Mutex m_num_to_open_mutex;\n+        /// Number of `ConnectionType::PRIVATE_BROADCAST` connections to open.\n+        size_t m_num_to_open GUARDED_BY(m_num_to_open_mutex){0};",
      "path": "src/net.h",
      "position": 1,
      "original_position": 78,
      "commit_id": "36ae854b1ddf98edce7adfe6448e3a57f36267e8",
      "original_commit_id": "11a339437b88ef739bc309f3f9ba90cf35d0a76f",
      "in_reply_to_id": 2525677364,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Amazing! TIL atomics can be used as condition variables (since C++20). It is simpler this way, thanks!\r\n\r\nI copied the above verbatim, so put you as co-author of that commit.\r\n\r\nMy only \"review\" nit is that here:\r\n\r\n```cpp\r\n        size_t current_value{0};\r\n        size_t new_value{0};\r\n        do {\r\n            current_value = ...\r\n            new_value = ...\r\n        } while ...\r\n```\r\nthe initialization of the two variables to `0` can be omitted since they are assigned unconditionally right after, so `{0}` can be dropped. But I left it as it is.",
      "created_at": "2025-11-14T09:39:22Z",
      "updated_at": "2025-11-14T09:39:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2526732684",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2526732684"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1250,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2527749355",
      "pull_request_review_id": 3465259630,
      "id": 2527749355,
      "node_id": "PRRC_kwDOABII586WqmTr",
      "diff_hunk": "@@ -1180,6 +1182,74 @@ class CConnman\n                                const std::optional<Proxy>& proxy_override = std::nullopt)\n         EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\n \n+    /// Group of private broadcast related members.\n+    class PrivateBroadcast\n+    {\n+    public:\n+        /**\n+         * Remember if we ever established at least one outbound connection to a\n+         * Tor peer, including sending and receiving P2P messages. If this is\n+         * true then the Tor proxy indeed works and is a proxy to the Tor network,\n+         * not a misconfigured ordinary SOCKS5 proxy as -proxy or -onion. If that\n+         * is the case, then we assume that connecting to an IPv4 or IPv6 address\n+         * via that proxy will be done through the Tor network and a Tor exit node.\n+         */\n+        std::atomic_bool m_outbound_tor_ok_at_least_once{false};\n+\n+        /**\n+         * Semaphore used to guard against opening too many connections.\n+         * Opening private broadcast connections will be paused if this is equal to 0.\n+         */\n+        std::counting_semaphore<> m_sem_conn_max{MAX_PRIVATE_BROADCAST_CONNECTIONS};\n+\n+        /**\n+         * Choose a network to open a connection to.\n+         * @param[out] proxy Optional proxy to override the normal proxy selection.\n+         * Will be set if !std::nullopt is returned. Could be set to `std::nullopt`\n+         * if there is no need to override the proxy that would be used for connecting\n+         * to the returned network.\n+         * @retval std::nullopt No network could be selected.\n+         * @retval !std::nullopt The network was selected and `proxy` is set (maybe to `std::nullopt`).\n+         */\n+        std::optional<Network> PickNetwork(std::optional<Proxy>& proxy) const;\n+\n+        /// Get the pending number of connections to open.\n+        size_t NumToOpen() const EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+        /**\n+         * Increment the number of new connections of type `ConnectionType::PRIVATE_BROADCAST`\n+         * to be opened by `CConnman::ThreadPrivateBroadcast()`.\n+         * @param[in] n Increment by this number.\n+         */\n+        void NumToOpenAdd(size_t n) EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+        /**\n+         * Decrement the number of new connections of type `ConnectionType::PRIVATE_BROADCAST`\n+         * to be opened by `CConnman::ThreadPrivateBroadcast()`.\n+         * @param[in] n Decrement by this number.\n+         * @return The number of connections that remain to be opened after the operation.\n+         */\n+        size_t NumToOpenSub(size_t n) EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+        /// Wait for the number of needed connections to become greater than 0.\n+        void NumToOpenWait() const EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+    private:\n+        /**\n+         * Check if private broadcast can be done to IPv4 or IPv6 peers and if so via which proxy.\n+         * If private broadcast connections should not be opened to IPv4 or IPv6, then this will\n+         * return an empty optional.\n+         */\n+        std::optional<Proxy> ProxyForIPv4or6() const;\n+\n+        /// Condition variable to wait for `m_num_to_open` to change.\n+        mutable std::condition_variable m_num_to_open_cond;\n+        /// Mutex protecting `m_num_to_open`.\n+        mutable Mutex m_num_to_open_mutex;\n+        /// Number of `ConnectionType::PRIVATE_BROADCAST` connections to open.\n+        size_t m_num_to_open GUARDED_BY(m_num_to_open_mutex){0};",
      "path": "src/net.h",
      "position": 1,
      "original_position": 78,
      "commit_id": "36ae854b1ddf98edce7adfe6448e3a57f36267e8",
      "original_commit_id": "11a339437b88ef739bc309f3f9ba90cf35d0a76f",
      "in_reply_to_id": 2525677364,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Ahh right, and we don't have to recheck `current_value` each time which will have 1 less atomic operation if there is a lost race. If you push again maybe touch up to:\r\n```C++\r\n    size_t current_value{m_num_to_open};\r\n    size_t new_value;\r\n    do {\r\n        new_value = current_value > n ? current_value - n : 0;\r\n    } while (!m_num_to_open.compare_exchange_weak(current_value, new_value));\r\n```",
      "created_at": "2025-11-14T14:40:37Z",
      "updated_at": "2025-11-14T14:40:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2527749355",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2527749355"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1250,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2528472456",
      "pull_request_review_id": 3466158330,
      "id": 2528472456,
      "node_id": "PRRC_kwDOABII586WtW2I",
      "diff_hunk": "@@ -1180,6 +1182,74 @@ class CConnman\n                                const std::optional<Proxy>& proxy_override = std::nullopt)\n         EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\n \n+    /// Group of private broadcast related members.\n+    class PrivateBroadcast\n+    {\n+    public:\n+        /**\n+         * Remember if we ever established at least one outbound connection to a\n+         * Tor peer, including sending and receiving P2P messages. If this is\n+         * true then the Tor proxy indeed works and is a proxy to the Tor network,\n+         * not a misconfigured ordinary SOCKS5 proxy as -proxy or -onion. If that\n+         * is the case, then we assume that connecting to an IPv4 or IPv6 address\n+         * via that proxy will be done through the Tor network and a Tor exit node.\n+         */\n+        std::atomic_bool m_outbound_tor_ok_at_least_once{false};\n+\n+        /**\n+         * Semaphore used to guard against opening too many connections.\n+         * Opening private broadcast connections will be paused if this is equal to 0.\n+         */\n+        std::counting_semaphore<> m_sem_conn_max{MAX_PRIVATE_BROADCAST_CONNECTIONS};\n+\n+        /**\n+         * Choose a network to open a connection to.\n+         * @param[out] proxy Optional proxy to override the normal proxy selection.\n+         * Will be set if !std::nullopt is returned. Could be set to `std::nullopt`\n+         * if there is no need to override the proxy that would be used for connecting\n+         * to the returned network.\n+         * @retval std::nullopt No network could be selected.\n+         * @retval !std::nullopt The network was selected and `proxy` is set (maybe to `std::nullopt`).\n+         */\n+        std::optional<Network> PickNetwork(std::optional<Proxy>& proxy) const;\n+\n+        /// Get the pending number of connections to open.\n+        size_t NumToOpen() const EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+        /**\n+         * Increment the number of new connections of type `ConnectionType::PRIVATE_BROADCAST`\n+         * to be opened by `CConnman::ThreadPrivateBroadcast()`.\n+         * @param[in] n Increment by this number.\n+         */\n+        void NumToOpenAdd(size_t n) EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+        /**\n+         * Decrement the number of new connections of type `ConnectionType::PRIVATE_BROADCAST`\n+         * to be opened by `CConnman::ThreadPrivateBroadcast()`.\n+         * @param[in] n Decrement by this number.\n+         * @return The number of connections that remain to be opened after the operation.\n+         */\n+        size_t NumToOpenSub(size_t n) EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+        /// Wait for the number of needed connections to become greater than 0.\n+        void NumToOpenWait() const EXCLUSIVE_LOCKS_REQUIRED(!m_num_to_open_mutex);\n+\n+    private:\n+        /**\n+         * Check if private broadcast can be done to IPv4 or IPv6 peers and if so via which proxy.\n+         * If private broadcast connections should not be opened to IPv4 or IPv6, then this will\n+         * return an empty optional.\n+         */\n+        std::optional<Proxy> ProxyForIPv4or6() const;\n+\n+        /// Condition variable to wait for `m_num_to_open` to change.\n+        mutable std::condition_variable m_num_to_open_cond;\n+        /// Mutex protecting `m_num_to_open`.\n+        mutable Mutex m_num_to_open_mutex;\n+        /// Number of `ConnectionType::PRIVATE_BROADCAST` connections to open.\n+        size_t m_num_to_open GUARDED_BY(m_num_to_open_mutex){0};",
      "path": "src/net.h",
      "position": 1,
      "original_position": 78,
      "commit_id": "36ae854b1ddf98edce7adfe6448e3a57f36267e8",
      "original_commit_id": "11a339437b88ef739bc309f3f9ba90cf35d0a76f",
      "in_reply_to_id": 2525677364,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Also, just thinking about 32-bit systems and possibility of overflows here. Although unlikely unless spammed with many `sendrawtransaction` for a long time, would it be best to maybe make `m_num_to_open` a `atomic_uint64_t` to remove all doubt?",
      "created_at": "2025-11-14T18:14:22Z",
      "updated_at": "2025-11-14T18:14:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29415#discussion_r2528472456",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2528472456"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1250,
      "side": "RIGHT"
    }
  ]
}