{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663",
    "id": 2930696206,
    "node_id": "PR_kwDOABII586uruAO",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/33663",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/33663.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/33663.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33663",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33663/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/33e59cf4ece4f91304500cce3e827ec80250d843",
    "number": 33663,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "net: Filter addrman during address selection via AddrPolicy to avoid underfill",
    "user": {
      "login": "waketraindev",
      "id": 175499942,
      "node_id": "U_kgDOCnXqpg",
      "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/waketraindev",
      "html_url": "https://github.com/waketraindev",
      "followers_url": "https://api.github.com/users/waketraindev/followers",
      "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
      "organizations_url": "https://api.github.com/users/waketraindev/orgs",
      "repos_url": "https://api.github.com/users/waketraindev/repos",
      "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/waketraindev/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "This PR introduces `AddrMan::AddrPolicy`, a predicate that allows callers to\r\nexclude addresses during selection. The policy returns true to skip a given\r\nentry and is evaluated while holding `AddrMan::cs`.\r\n\r\nThe mechanism is used in `CConnman::GetAddressesUnsafe()` to filter out\r\nbanned and discouraged peers during address selection instead of removing\r\nthem afterward. This prevents P2P responses (`GETADDR`) and RPCs (`getnodeaddresses)` from\r\nreturning fewer results than requested when large portions of the address space are filtered.\r\n\r\nAdditional improvements:\r\n- Logs the number of filtered entries for diagnostics\r\n- Avoids redundant filtering passes in higher-level callers\r\n- Keeps locking behavior unchanged (the policy runs under `AddrMan::cs`)\r\n\r\n**Testing**\r\n- Repro: ban or discourage a large set of addresses, then call\r\n  `getnodeaddresses 1`,  previously underfilled.\r\n- After this change, the RPC returns up to the requested count as expected.\r\n\r\nNo behavior change for unaffected callers.\r\n",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "created_at": "2025-10-20T18:03:51Z",
    "updated_at": "2026-01-19T17:40:06Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "497392e535331abd1b7f3520623c4e9e69bcbbfd",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "frankomosh",
        "id": 33951953,
        "node_id": "MDQ6VXNlcjMzOTUxOTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33951953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/frankomosh",
        "html_url": "https://github.com/frankomosh",
        "followers_url": "https://api.github.com/users/frankomosh/followers",
        "following_url": "https://api.github.com/users/frankomosh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/frankomosh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/frankomosh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/frankomosh/subscriptions",
        "organizations_url": "https://api.github.com/users/frankomosh/orgs",
        "repos_url": "https://api.github.com/users/frankomosh/repos",
        "events_url": "https://api.github.com/users/frankomosh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/frankomosh/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "waketraindev:2025-10-getaddressesunsafe-underfill",
      "ref": "2025-10-getaddressesunsafe-underfill",
      "sha": "33e59cf4ece4f91304500cce3e827ec80250d843",
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 982826890,
        "node_id": "R_kgDOOpS_ig",
        "name": "bitcoin",
        "full_name": "waketraindev/bitcoin",
        "owner": {
          "login": "waketraindev",
          "id": 175499942,
          "node_id": "U_kgDOCnXqpg",
          "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/waketraindev",
          "html_url": "https://github.com/waketraindev",
          "followers_url": "https://api.github.com/users/waketraindev/followers",
          "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
          "organizations_url": "https://api.github.com/users/waketraindev/orgs",
          "repos_url": "https://api.github.com/users/waketraindev/repos",
          "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/waketraindev/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/waketraindev/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/waketraindev/bitcoin",
        "archive_url": "https://api.github.com/repos/waketraindev/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/waketraindev/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/waketraindev/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/waketraindev/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/waketraindev/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/waketraindev/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/waketraindev/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/waketraindev/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/waketraindev/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/waketraindev/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/waketraindev/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/waketraindev/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/waketraindev/bitcoin/events",
        "forks_url": "https://api.github.com/repos/waketraindev/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/waketraindev/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/waketraindev/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/waketraindev/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/waketraindev/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/waketraindev/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/waketraindev/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/waketraindev/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/waketraindev/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/waketraindev/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/waketraindev/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/waketraindev/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/waketraindev/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/waketraindev/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/waketraindev/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/waketraindev/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:waketraindev/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/waketraindev/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/waketraindev/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/waketraindev/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/waketraindev/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/waketraindev/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/waketraindev/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/waketraindev/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/waketraindev/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/waketraindev/bitcoin/hooks",
        "svn_url": "https://github.com/waketraindev/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 319727,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-19T15:33:01Z",
        "created_at": "2025-05-13T13:15:17Z",
        "updated_at": "2026-01-16T19:06:19Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "5e49f5d63c74512c8f46fe7de7deb0341f13244a",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38735,
        "stargazers_count": 87708,
        "watchers_count": 87708,
        "size": 301988,
        "default_branch": "master",
        "open_issues_count": 757,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-19T16:45:55Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2026-01-19T17:00:50Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 86,
    "deletions": 18,
    "changed_files": 6,
    "commits": 1,
    "review_comments": 27,
    "comments": 12
  },
  "events": [
    {
      "event": "commented",
      "id": 3423193183,
      "node_id": "IC_kwDOABII587MCchf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3423193183",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-20T18:03:56Z",
      "updated_at": "2026-01-19T15:33:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33663.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [frankomosh](https://github.com/bitcoin/bitcoin/pull/33663#pullrequestreview-3464332521) |\n| Stale ACK | [mzumsande](https://github.com/bitcoin/bitcoin/pull/33663#pullrequestreview-3605973252) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#34302](https://github.com/bitcoin/bitcoin/pull/34302) (fuzz: Restore SendMessages coverage in process_message(s) fuzz targets by maflcko)\n* [#34162](https://github.com/bitcoin/bitcoin/pull/34162) (net: Avoid undershooting in GetAddressesUnsafe by fjahr)\n* [#31650](https://github.com/bitcoin/bitcoin/pull/31650) (refactor: Avoid copies by using const references or by move-construction by maflcko)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (âœ¨ experimental)\n\n\n\nPossible places where named args for integral literals may be used (e.g. `func(x, /*named_arg=*/0)` in C++, and `func(x, named_arg=0)` in Python):\n\n- addrman->GetAddr(/*max_addresses=*/0, /*max_pct=*/0, /*network=*/std::nullopt, /*filtered=*/false) in src/test/addrman_tests.cpp\n- addrman->GetAddr(/*max_addresses=*/0, /*max_pct=*/0, /*network=*/std::nullopt, /*filtered=*/false, /*policy=*/policyNoSkip) in src/test/addrman_tests.cpp\n- addrman->GetAddr(/*max_addresses=*/0, /*max_pct=*/0, /*network=*/std::nullopt, /*filtered=*/false, /*policy=*/policySkipAll) in src/test/addrman_tests.cpp\n- addrman->GetAddr(/*max_addresses=*/0, /*max_pct=*/0, /*network=*/std::nullopt, /*filtered=*/false, /*policy=*/policyPortPolicy) in src/test/addrman_tests.cpp\n\n\n\n<sup>2026-01-19</sup>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#issuecomment-3423193183",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33663"
    },
    {
      "event": "ready_for_review",
      "id": 20386185048,
      "node_id": "RFRE_lADOABII587Sm3TCzwAAAAS_HH9Y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20386185048",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-20T18:17:15Z"
    },
    {
      "event": "reviewed",
      "id": 3360827654,
      "node_id": "PRR_kwDOABII587IUikG",
      "url": null,
      "actor": null,
      "commit_id": "c8cb2ea11454a6edd8d8a8a83bb1be3596e9ff17",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-10-22T08:18:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nThe main function of this is p2p  (answering GetAddr requests from peers), RPCs like `getnodeaddresses` are of secondary importance. \r\nSince the p2p use is also affected by this, the PR description should be changed to reflect this. \r\n\r\nThat said, it seems good to always try to return 1000 addresses in a GetAddr answer, so that peers don't know whether we have a long list of banned addresses or not.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#pullrequestreview-3360827654",
      "submitted_at": "2025-10-22T08:18:50Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20428245088,
      "node_id": "HRFPE_lADOABII587Sm3TCzwAAAATBnkhg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20428245088",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "70e2204b614af0d83e138b060de1139b651e5445",
      "commit_url": "https://api.github.com/repos/waketraindev/bitcoin/commits/70e2204b614af0d83e138b060de1139b651e5445",
      "created_at": "2025-10-22T10:55:36Z"
    },
    {
      "event": "commented",
      "id": 3432260201,
      "node_id": "IC_kwDOABII587MlCJp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3432260201",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-22T13:02:01Z",
      "updated_at": "2025-10-22T13:02:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "* updated PR description and commit message to highlight P2p getaddr responses\n* corrected formatting ",
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#issuecomment-3432260201",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33663"
    },
    {
      "event": "review_requested",
      "id": 20485105183,
      "node_id": "RRE_lADOABII587Sm3TCzwAAAATFAeYf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20485105183",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-24T14:06:56Z",
      "requested_reviewer": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 3377288982,
      "node_id": "PRR_kwDOABII587JTVcW",
      "url": null,
      "actor": null,
      "commit_id": "70e2204b614af0d83e138b060de1139b651e5445",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-10-24T14:49:02Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#pullrequestreview-3377288982",
      "submitted_at": "2025-10-24T14:49:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20544775608,
      "node_id": "HRFPE_lADOABII587Sm3TCzwAAAATIkGW4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20544775608",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "934a7819ff038ff2cf9a62d8e9b5f64df39b006d",
      "commit_url": "https://api.github.com/repos/waketraindev/bitcoin/commits/934a7819ff038ff2cf9a62d8e9b5f64df39b006d",
      "created_at": "2025-10-28T06:51:38Z"
    },
    {
      "event": "commented",
      "id": 3454896610,
      "node_id": "IC_kwDOABII587N7Yni",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3454896610",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-28T06:55:33Z",
      "updated_at": "2025-10-28T06:55:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "Added AddrPolicy coverage in addrman_tests",
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#issuecomment-3454896610",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33663"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20544919003,
      "node_id": "HRFPE_lADOABII587Sm3TCzwAAAATIkpXb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20544919003",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "1a89761e128d96ea49fe45fc10ef3dc95d9e0f99",
      "commit_url": "https://api.github.com/repos/waketraindev/bitcoin/commits/1a89761e128d96ea49fe45fc10ef3dc95d9e0f99",
      "created_at": "2025-10-28T07:01:49Z"
    },
    {
      "event": "review_requested",
      "id": 20544931347,
      "node_id": "RRE_lADOABII587Sm3TCzwAAAATIksYT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20544931347",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-28T07:02:38Z",
      "requested_reviewer": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20549047810,
      "node_id": "HRFPE_lADOABII587Sm3TCzwAAAATI0ZYC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20549047810",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "d7c5cbb7f9ad13b6fa7f8d359d86c68f512749af",
      "commit_url": "https://api.github.com/repos/waketraindev/bitcoin/commits/d7c5cbb7f9ad13b6fa7f8d359d86c68f512749af",
      "created_at": "2025-10-28T10:07:33Z"
    },
    {
      "event": "reviewed",
      "id": 3388934345,
      "node_id": "PRR_kwDOABII587J_wjJ",
      "url": null,
      "actor": null,
      "commit_id": "d7c5cbb7f9ad13b6fa7f8d359d86c68f512749af",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-10-28T13:59:08Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#pullrequestreview-3388934345",
      "submitted_at": "2025-10-28T13:59:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20555759483,
      "node_id": "HRFPE_lADOABII587Sm3TCzwAAAATJN_97",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20555759483",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "commit_url": "https://api.github.com/repos/waketraindev/bitcoin/commits/4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "created_at": "2025-10-28T14:34:33Z"
    },
    {
      "event": "commented",
      "id": 3456841808,
      "node_id": "IC_kwDOABII587OCzhQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3456841808",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-28T14:39:34Z",
      "updated_at": "2025-10-28T14:39:34Z",
      "author_association": "CONTRIBUTOR",
      "body": "Added test verifying only expected addresses are returned and filtered ones excluded.",
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#issuecomment-3456841808",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33663"
    },
    {
      "event": "review_requested",
      "id": 20577243915,
      "node_id": "RRE_lADOABII587Sm3TCzwAAAATKf9ML",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20577243915",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-29T11:34:20Z",
      "requested_reviewer": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "renamed",
      "id": 20681534174,
      "node_id": "RTE_lADOABII587Sm3TCzwAAAATQtyre",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20681534174",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-03T18:02:02Z",
      "rename": {
        "from": "addrman, net: filter during address selection via AddrPolicy to avoid underfill",
        "to": "addrman, net: Filter during address selection via AddrPolicy to avoid underfill"
      }
    },
    {
      "event": "renamed",
      "id": 20807203811,
      "node_id": "RTE_lADOABII587Sm3TCzwAAAATYNLvj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20807203811",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-08T11:17:16Z",
      "rename": {
        "from": "addrman, net: Filter during address selection via AddrPolicy to avoid underfill",
        "to": "net: Filter during address selection via AddrPolicy to avoid underfill"
      }
    },
    {
      "event": "labeled",
      "id": 20807203973,
      "node_id": "LE_lADOABII587Sm3TCzwAAAATYNLyF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20807203973",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-08T11:17:19Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "renamed",
      "id": 20807207240,
      "node_id": "RTE_lADOABII587Sm3TCzwAAAATYNMlI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20807207240",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-08T11:17:41Z",
      "rename": {
        "from": "net: Filter during address selection via AddrPolicy to avoid underfill",
        "to": "net: Filter addrman during address selection via AddrPolicy to avoid underfill"
      }
    },
    {
      "event": "reviewed",
      "id": 3464332521,
      "node_id": "PRR_kwDOABII587OfYTp",
      "url": null,
      "actor": null,
      "commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-14T10:54:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "frankomosh",
        "id": 33951953,
        "node_id": "MDQ6VXNlcjMzOTUxOTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33951953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/frankomosh",
        "html_url": "https://github.com/frankomosh",
        "followers_url": "https://api.github.com/users/frankomosh/followers",
        "following_url": "https://api.github.com/users/frankomosh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/frankomosh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/frankomosh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/frankomosh/subscriptions",
        "organizations_url": "https://api.github.com/users/frankomosh/orgs",
        "repos_url": "https://api.github.com/users/frankomosh/repos",
        "events_url": "https://api.github.com/users/frankomosh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/frankomosh/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#pullrequestreview-3464332521",
      "submitted_at": "2025-11-14T10:54:01Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 20984705410,
      "node_id": "HRFPE_lADOABII587Sm3TCzwAAAATiyTGC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20984705410",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "commit_url": "https://api.github.com/repos/waketraindev/bitcoin/commits/fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "created_at": "2025-11-17T11:19:14Z"
    },
    {
      "event": "reviewed",
      "id": 3605973252,
      "node_id": "PRR_kwDOABII587W7skE",
      "url": null,
      "actor": null,
      "commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-22T23:00:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "Code Review ACK fb3efdb3d267924266134f63b1ba6ddda0b6ce81\r\n\r\nAs far as I can see, the reason for creating and passing an `AddrPolicy` is that the alternative (having `addrman` reach into `banman` to request if an addr is banned) would introduce coupling between the modules, while the current approach only introduces an implied lock order, which is somewhat of a potential footgun - but I don't really see a better solution. \r\nFor example, we probably wouldn't want to remove entries from addrman when they are banned, because bans are often temporary.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#pullrequestreview-3605973252",
      "submitted_at": "2025-12-22T23:00:46Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
    },
    {
      "event": "review_requested",
      "id": 21714569668,
      "node_id": "RRE_lADOABII587Sm3TCzwAAAAUOSgnE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21714569668",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-22T23:00:49Z",
      "requested_reviewer": {
        "login": "frankomosh",
        "id": 33951953,
        "node_id": "MDQ6VXNlcjMzOTUxOTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33951953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/frankomosh",
        "html_url": "https://github.com/frankomosh",
        "followers_url": "https://api.github.com/users/frankomosh/followers",
        "following_url": "https://api.github.com/users/frankomosh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/frankomosh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/frankomosh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/frankomosh/subscriptions",
        "organizations_url": "https://api.github.com/users/frankomosh/orgs",
        "repos_url": "https://api.github.com/users/frankomosh/repos",
        "events_url": "https://api.github.com/users/frankomosh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/frankomosh/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 3612547519,
      "node_id": "PRR_kwDOABII587XUxm_",
      "url": null,
      "actor": null,
      "commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-25T22:29:39Z",
      "author_association": "CONTRIBUTOR",
      "body": "While leaving some nit-ish comments I have realized that if we want to add such a generalized concept for filtering, we should implement the current filtering with it as well. E.g. `network` and `filtered` params go away and we only have `AddrPolicy` as param to `GetAddr`. Then use `AddrPolicy` to implement what `network` and `filtered` were doing. That's a bigger refactor but having this current mix with this redundancy is kind of ugly and I don't really think it's worth it alone.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#pullrequestreview-3612547519",
      "submitted_at": "2025-12-25T22:29:39Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
    },
    {
      "event": "commented",
      "id": 3693676606,
      "node_id": "IC_kwDOABII587cKQg-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3693676606",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-27T04:55:38Z",
      "updated_at": "2025-12-27T04:55:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "> While leaving some nit-ish comments I have realized that if we want to add such a generalized concept for filtering, we should implement the current filtering with it as well. E.g. `network` and `filtered` params go away and we only have `AddrPolicy` as param to `GetAddr`. Then use `AddrPolicy` to implement what `network` and `filtered` were doing. That's a bigger refactor but having this current mix with this redundancy is kind of ugly and I don't really think it's worth it alone.\n\nThanks for the suggestion! network and filtered serve distinct, standard purposes (network filters by network, filtered disables quality filtering), while AddrPolicy is specifically for custom filters that skip entries without reducing the returned count. Using AddrPolicy also avoids coupling AddrMan to other modules (like BanMan) for filtering.",
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#issuecomment-3693676606",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33663"
    },
    {
      "event": "commented",
      "id": 3693996982,
      "node_id": "IC_kwDOABII587cLeu2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3693996982",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-27T14:03:42Z",
      "updated_at": "2025-12-27T14:03:42Z",
      "author_association": "CONTRIBUTOR",
      "body": "> network and filtered serve distinct, standard purposes (network filters by network, filtered disables quality filtering), while AddrPolicy is specifically for custom filters\r\n\r\nWhat distinguishes a \"standard\" from a \"custom\" filter? Is that documented somewhere? And if we need to add another filter that is \"standard\" we would add another param to the function rather than using `AddrPolicy`?\r\n\r\n> that skip entries without reducing the returned count\r\n\r\nHuh? If they don't reduce the count how are they filtering anything? This is not what the code is doing, the code is filtering and reducing the returned count with it as well of course. Also demonstrated by the tests. Am I misunderstanding what you mean with count?\r\n\r\n> Using AddrPolicy also avoids coupling AddrMan to other modules (like BanMan) for filtering.\r\n\r\nI don't see how that is an argument against using it for network and quality filters.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#issuecomment-3693996982",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33663"
    },
    {
      "event": "commented",
      "id": 3694142629,
      "node_id": "IC_kwDOABII587cMCSl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3694142629",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-27T18:25:26Z",
      "updated_at": "2025-12-27T18:25:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > network and filtered serve distinct, standard purposes (network filters by network, filtered disables quality filtering), while AddrPolicy is specifically for custom filters\r\n> \r\n> What distinguishes a \"standard\" from a \"custom\" filter? Is that documented somewhere? And if we need to add another filter that is \"standard\" we would add another param to the function rather than using `AddrPolicy`?\r\n\r\nBy \"standard\" I mean filters that are intrinsic to `AddrMan` and operate on `AddrInfo` (for example network classification and quality filtering via `ai.IsTerrible(now)`), and whose logic does not depend on external subsystems. By \"custom\" I mean filters that depend on external state or policy decisions outside of `AddrMan` (for example `BanMan`), which is what `AddrPolicy` is intended to support.\r\nIf a future filter is intrinsic to `AddrMan` and depends on `AddrInfo`, adding it as a separate parameter would be consistent with the existing design. If it depends on external state, `AddrPolicy` is the appropriate mechanism.\r\n\r\n> > that skip entries without reducing the returned count\r\n> \r\n> Huh? If they don't reduce the count how are they filtering anything? This is not what the code is doing, the code is filtering and reducing the returned count with it as well of course. Also demonstrated by the tests. Am I misunderstanding what you mean with count?\r\n\r\nCandidates are filtered and skipped during selection. The change here is *when* filtering happens. Previously, addresses were selected up to the target count and then banned or discouraged addresses were removed afterward, which caused the final `CConnman::GetAddressesUnsafe` result to be underfilled. With the current approach, filtering happens during selection, and the loop continues until the requested number of unfiltered addresses is reached or the address space is exhausted. So filtering still occurs, but it no longer causes `CConnman::GetAddressesUnsafe` to be underfilled relative to the request.\r\n\r\n> > Using AddrPolicy also avoids coupling AddrMan to other modules (like BanMan) for filtering.\r\n> \r\n> I don't see how that is an argument against using it for network and quality filters.\r\n\r\nThe point is not that `AddrPolicy` cannot express network or quality filters, but that doing so would conflate concerns and duplicate logic. Network and quality filtering are `AddrMan` responsibilities and require access to `AddrInfo`. Expressing them via `AddrPolicy` would either broaden the policy contract or require reimplementing intrinsic `AddrMan` logic in call sites, without addressing a concrete issue in this PR. This change keeps the PR scoped to fixing underfilling and avoids introducing additional coupling or refactors.\r\n\r\n---\r\n\r\nTo keep this PR focused: its purpose is to fix the underfilling issue by moving ban and discourage filtering into the selection phase. The current design achieves that with minimal surface area change and without refactoring existing `AddrMan` responsibilities or introducing new abstractions. Broader refactors (for example unifying all filters behind `AddrPolicy` or introducing builders/factories) can be explored separately if there is concrete motivation, but are out of scope for this change. Unless there are functional issues with the current approach, I intend to keep the implementation as is.\r\n",
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#issuecomment-3694142629",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33663"
    },
    {
      "event": "reviewed",
      "id": 3614441070,
      "node_id": "PRR_kwDOABII587Xb_5u",
      "url": null,
      "actor": null,
      "commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-28T00:22:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "> By \"standard\" I mean filters that are intrinsic to `AddrMan` and operate on `AddrInfo` (for example network classification and quality filtering via `ai.IsTerrible(now)`), and whose logic does not depend on external subsystems. By \"custom\" I mean filters that depend on external state or policy decisions outside of `AddrMan` (for example `BanMan`), which is what `AddrPolicy` is intended to support.\r\n> If a future filter is intrinsic to `AddrMan` and depends on `AddrInfo`, adding it as a separate parameter would be consistent with the existing design. If it depends on external state, `AddrPolicy` is the appropriate mechanism.\r\n\r\nThe docs don't mention any of this but instead the naming `AddrPolicy` and the docs suggest that it's a generalized concept and could be used for any kind of filtering. I still think there is no reason to restrict usage of `AddrPolicy` in this way when it appears to be possible to just do both. \r\n\r\n> To keep this PR focused: its purpose is to fix the underfilling issue by moving ban and discourage filtering into the selection phase. The current design achieves that with minimal surface area change and without refactoring existing `AddrMan` responsibilities or introducing new abstractions.\r\n\r\nIf preventing underfilling is the only goal of this PR I would suggest a simpler approach: For example request more addresses than `max_addresses` and then trim at the end. Could be done smartly with using `m_banned.size()` to make sure we only overshoot as much as necessary. But simplest would be to just request with `max_addresses = 0`. The current approach doesn't seem minimal and if there is no plan to use it more broadly it seems like overengineering. At least the conceptual limitations and \"policy contract\" that you are describing would need to be documented clearly in the code as well.\r\n\r\n",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#pullrequestreview-3614441070",
      "submitted_at": "2025-12-28T00:22:33Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21769866759,
      "node_id": "HRFPE_lADOABII587Sm3TCzwAAAAURlc4H",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21769866759",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "33e7b6647979112fbe657e5c70790b869fa7af57",
      "commit_url": "https://api.github.com/repos/waketraindev/bitcoin/commits/33e7b6647979112fbe657e5c70790b869fa7af57",
      "created_at": "2025-12-28T13:16:07Z"
    },
    {
      "event": "commented",
      "id": 3694743744,
      "node_id": "IC_kwDOABII587cOVDA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3694743744",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T13:21:50Z",
      "updated_at": "2025-12-28T13:21:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "added fuzz coverage, fixed identation, removed hints, ordered includes, cleared nits",
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#issuecomment-3694743744",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33663"
    },
    {
      "event": "reviewed",
      "id": 3614704810,
      "node_id": "PRR_kwDOABII587XdASq",
      "url": null,
      "actor": null,
      "commit_id": "33e7b6647979112fbe657e5c70790b869fa7af57",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-28T14:23:31Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#pullrequestreview-3614704810",
      "submitted_at": "2025-12-28T14:23:31Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21770187364,
      "node_id": "HRFPE_lADOABII587Sm3TCzwAAAAURmrJk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21770187364",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "bb637a85c6d0fec27dbcdd24cf04ae3118bc7b60",
      "commit_url": "https://api.github.com/repos/waketraindev/bitcoin/commits/bb637a85c6d0fec27dbcdd24cf04ae3118bc7b60",
      "created_at": "2025-12-28T14:45:54Z"
    },
    {
      "event": "commented",
      "id": 3694889631,
      "node_id": "IC_kwDOABII587cO4qf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3694889631",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T17:02:53Z",
      "updated_at": "2025-12-28T17:02:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "It appears you aren't interested in addressing the rest of my comments @waketraindev so I have implemented my suggested approach in #34162 instead. I prefer this approach due to its simplicity, as stated above. It fixes the overshooting problem in 2 lines and adds a functional test case for the behavior change. I will leave it to the other reviewers to decide which approach they prefer.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#issuecomment-3694889631",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33663"
    },
    {
      "event": "mentioned",
      "id": 21770696122,
      "node_id": "MEE_lADOABII587Sm3TCzwAAAAURonW6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21770696122",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T17:02:55Z"
    },
    {
      "event": "subscribed",
      "id": 21770696141,
      "node_id": "SE_lADOABII587Sm3TCzwAAAAURonXN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21770696141",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T17:02:55Z"
    },
    {
      "event": "commented",
      "id": 3695127117,
      "node_id": "IC_kwDOABII587cPypN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3695127117",
      "actor": {
        "login": "Bicaru20",
        "id": 91594426,
        "node_id": "U_kgDOBXWeug",
        "avatar_url": "https://avatars.githubusercontent.com/u/91594426?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Bicaru20",
        "html_url": "https://github.com/Bicaru20",
        "followers_url": "https://api.github.com/users/Bicaru20/followers",
        "following_url": "https://api.github.com/users/Bicaru20/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Bicaru20/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Bicaru20/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Bicaru20/subscriptions",
        "organizations_url": "https://api.github.com/users/Bicaru20/orgs",
        "repos_url": "https://api.github.com/users/Bicaru20/repos",
        "events_url": "https://api.github.com/users/Bicaru20/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Bicaru20/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T23:17:11Z",
      "updated_at": "2025-12-28T23:17:11Z",
      "author_association": "NONE",
      "body": "I think @fjahr has a good point. If the main goal is simply to always return 1000 addresses in `GetAddr`, introducing a predicate feels like adding unnecessary complexity. I believe his solution is cleaner. \r\n\r\n> While leaving some nit-ish comments I have realized that if we want to add such a generalized concept for filtering, we should implement the current filtering with it as well. E.g. `network` and `filtered` params go away and we only have `AddrPolicy` as param to `GetAddr`. Then use `AddrPolicy` to implement what `network` and `filtered` were doing. That's a bigger refactor but having this current mix with this redundancy is kind of ugly and I don't really think it's worth it alone.\r\n\r\nI agree. If a generalized filtering concept is added, it should replace the current filtering mechanism. This would make it easier to add new filters in the future. However, for the problem trying to be solved, I think itâ€™s complicating things too much.",
      "user": {
        "login": "Bicaru20",
        "id": 91594426,
        "node_id": "U_kgDOBXWeug",
        "avatar_url": "https://avatars.githubusercontent.com/u/91594426?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Bicaru20",
        "html_url": "https://github.com/Bicaru20",
        "followers_url": "https://api.github.com/users/Bicaru20/followers",
        "following_url": "https://api.github.com/users/Bicaru20/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Bicaru20/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Bicaru20/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Bicaru20/subscriptions",
        "organizations_url": "https://api.github.com/users/Bicaru20/orgs",
        "repos_url": "https://api.github.com/users/Bicaru20/repos",
        "events_url": "https://api.github.com/users/Bicaru20/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Bicaru20/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#issuecomment-3695127117",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33663"
    },
    {
      "event": "mentioned",
      "id": 21771957669,
      "node_id": "MEE_lADOABII587Sm3TCzwAAAAURtbWl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21771957669",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T23:17:12Z"
    },
    {
      "event": "subscribed",
      "id": 21771957678,
      "node_id": "SE_lADOABII587Sm3TCzwAAAAURtbWu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21771957678",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T23:17:12Z"
    },
    {
      "event": "commented",
      "id": 3697274537,
      "node_id": "IC_kwDOABII587cX-6p",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3697274537",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-29T19:02:31Z",
      "updated_at": "2025-12-29T19:02:31Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I think @fjahr has a good point. If the main goal is simply to always return 1000 addresses in GetAddr, introducing a predicate feels like adding unnecessary complexity. I believe his solution is cleaner.\r\n\r\nRegarding the \"over-engineering\" concerns, the lambda(the predicate) here is inline, concise, and used only once.\r\nIt encapsulates a simple banned/discouraged filter applied during selection to ensure max_addresses are correctly returned.\r\nThis approach is both functionally necessary and efficient, and does not introduce unnecessary complexity, so I do not consider it over-engineering.\r\n\r\nOn the other hand, introducing a Builder to craft the policy, include other \"generalized\" filters, and export AddrInfo would be over-engineering in this context.\r\n\r\nThe #34162 approach is highly inefficient for a database of 70k+ records, with on-demand calls through RPC with a max_addresses limit, and whitelisted nodes. It is insufficient for my use cases. \r\n\r\nThough both performance and simplicity are in the eyes of the beholder ig.\r\n\r\nThanks for your feedback!",
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#issuecomment-3697274537",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33663"
    },
    {
      "event": "mentioned",
      "id": 21782955621,
      "node_id": "MEE_lADOABII587Sm3TCzwAAAAUSXYZl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21782955621",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-29T19:02:33Z"
    },
    {
      "event": "subscribed",
      "id": 21782955641,
      "node_id": "SE_lADOABII587Sm3TCzwAAAAUSXYZ5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21782955641",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-29T19:02:33Z"
    },
    {
      "event": "commented",
      "id": 3710882202,
      "node_id": "IC_kwDOABII587dL5Ga",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3710882202",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-05T15:24:19Z",
      "updated_at": "2026-01-05T15:24:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "> The https://github.com/bitcoin/bitcoin/pull/34162 approach is highly inefficient for a database of 70k+ records, with on-demand calls through RPC with a max_addresses limit, and whitelisted nodes. It is insufficient for my use cases.\r\n\r\nIf you could be more explicit with what your use-case is then maybe you could convince more people that your approach is really necessary, even when you refuse to use it more broadly. It comes down to if core wants to support your use case bad enough to take on the extra code to maintain, I guess. You have a lot of addresses, ok! But I don't understand how whitelists play into this. Can you elaborate on that?  And why would you do frequent calls to `getnodeaddresses` with a max_addresses limit, couldn't you just increase the limit?\r\n\r\nI did some rough high-level benchmarking using the functional test from my PR ([code](https://github.com/fjahr/bitcoin/commit/8f2b63286386b8dbd83981a4c33a4634530323d8)). Due to the bucket collisions I couldn't get beyond 64k addresses, but I guess this is close enough and I didn't try to get to an even higher number. I am using an arbitrary 1k banned addresses and 1k max limit.\r\n\r\nThis PR (#33663) has the best performance, not surprising:\r\n\r\n```\r\n2025-12-30T14:34:41.400316Z TestFramework (INFO): Test that getnodeaddresses returns max count even with banned addresses\r\n2025-12-30T14:34:41.770049Z TestFramework (INFO): Adding addresses to addrman...\r\n2025-12-30T14:36:31.483147Z TestFramework (INFO): Successfully added 62636 addresses\r\n2025-12-30T14:36:31.483466Z TestFramework (INFO): Banning 1000 addresses...\r\n2025-12-30T14:36:32.511395Z TestFramework (INFO): Requesting 1000 addresses...\r\n2025-12-30T14:36:32.523990Z TestFramework (INFO): getnodeaddresses returned 1000 addresses in 0.013s\r\n```\r\n\r\nMy alternative approach (#34162) is much slower, also not surprising, but at 0.5s it doesn't seem like this would break any workflows I can imagine:\r\n\r\n```\r\n2025-12-30T14:18:12.848562Z TestFramework (INFO): Test that getnodeaddresses returns max count even with banned addresses\r\n2025-12-30T14:18:13.218102Z TestFramework (INFO): Adding addresses to addrman...\r\n2025-12-30T14:19:58.335032Z TestFramework (INFO): Successfully added 63471 addresses\r\n2025-12-30T14:19:58.335895Z TestFramework (INFO): Banning 1000 addresses...\r\n2025-12-30T14:19:59.381759Z TestFramework (INFO): Requesting 1000 addresses...\r\n2025-12-30T14:19:59.940406Z TestFramework (INFO): getnodeaddresses returned 1000 addresses in 0.559s\r\n```\r\n\r\nAs I had said previously, my suggest PR could be tweaked to get a middle ground between performance and simplicity, like for example fetch not all but only 2x max limit addresses to get to comparable performance and this should really work in 99% percent of the cases I can imagine. But sure, it's not as clean as #34162 but performance is comparable to this PR ( [demo code](https://github.com/fjahr/bitcoin/commit/556dcada56aca9136184098e61a07526ab408009)):\r\n\r\n```\r\n2025-12-30T14:52:23.292663Z TestFramework (INFO): Test that getnodeaddresses returns max count even with banned addresses\r\n2025-12-30T14:52:23.663001Z TestFramework (INFO): Adding addresses to addrman...\r\n2025-12-30T14:54:09.192166Z TestFramework (INFO): Successfully added 63395 addresses\r\n2025-12-30T14:54:09.193381Z TestFramework (INFO): Banning 1000 addresses...\r\n2025-12-30T14:54:10.218400Z TestFramework (INFO): Requesting 1000 addresses...\r\n2025-12-30T14:54:10.238231Z TestFramework (INFO): getnodeaddresses returned 1000 addresses in 0.020s\r\n2025-12-30T14:54:11.333769Z TestFramework (INFO): Stopping nodes\r\n```\r\n\r\nI also learned from playing around with the numbers that the total number of addresses only has minor impact on the performance. The big performance impact is coming from the number of banned addresses. So maybe that's where the discussion on performance (aside from the goals) should focus. I am not sure I have a good grasp on what % of addresses are realistically banned or discouraged. @0xB10C maybe you can weigh in?",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#issuecomment-3710882202",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33663"
    },
    {
      "event": "mentioned",
      "id": 21856535685,
      "node_id": "MEE_lADOABII587Sm3TCzwAAAAUWwESF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21856535685",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-05T15:24:20Z"
    },
    {
      "event": "subscribed",
      "id": 21856535734,
      "node_id": "SE_lADOABII587Sm3TCzwAAAAUWwES2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21856535734",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-05T15:24:21Z"
    },
    {
      "event": "labeled",
      "id": 22136626591,
      "node_id": "LE_lADOABII587Sm3TCzwAAAAUnch2f",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22136626591",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-19T12:05:17Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDMzZTU5Y2Y0ZWNlNGY5MTMwNDUwMGNjZTNlODI3ZWM4MDI1MGQ4NDM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/33e59cf4ece4f91304500cce3e827ec80250d843",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/33e59cf4ece4f91304500cce3e827ec80250d843",
      "tree": {
        "sha": "d5051697202a567ba8f0ce920fc805667f890e9e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d5051697202a567ba8f0ce920fc805667f890e9e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5e49f5d63c74512c8f46fe7de7deb0341f13244a",
          "sha": "5e49f5d63c74512c8f46fe7de7deb0341f13244a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5e49f5d63c74512c8f46fe7de7deb0341f13244a"
        }
      ],
      "message": "addrman, net: filter during selection via AddrPolicy to avoid underfill\n\nAdd AddrMan::AddrPolicy, a predicate returning true to exclude an address\nduring selection. This allows callers to apply custom filtering directly in\nAddrMan rather than post-processing results.\n\nUse the new policy in CConnman::GetAddressesUnsafe to exclude banned and\ndiscouraged peers while filling address requests. This fixes underfilled\nresults observed when banned peers were removed after selection, causing\nP2P responses from `GETADDR` to return fewer entries than requested.\n\nAlso log the number of filtered entries for debugging and diagnostics.",
      "committer": {
        "name": "WakeTrainDev",
        "email": "175499942+waketraindev@users.noreply.github.com",
        "date": "2026-01-19T15:26:19Z"
      },
      "author": {
        "name": "WakeTrainDev",
        "email": "175499942+waketraindev@users.noreply.github.com",
        "date": "2026-01-19T15:25:06Z"
      },
      "sha": "33e59cf4ece4f91304500cce3e827ec80250d843"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22141490034,
      "node_id": "HRFPE_lADOABII587Sm3TCzwAAAAUnvFNy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22141490034",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "33e59cf4ece4f91304500cce3e827ec80250d843",
      "commit_url": "https://api.github.com/repos/waketraindev/bitcoin/commits/33e59cf4ece4f91304500cce3e827ec80250d843",
      "created_at": "2026-01-19T15:33:03Z"
    },
    {
      "event": "unlabeled",
      "id": 22144100125,
      "node_id": "UNLE_lADOABII587Sm3TCzwAAAAUn5Ccd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22144100125",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-19T17:40:04Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2448349379",
      "pull_request_review_id": 3360827654,
      "id": 2448349379,
      "node_id": "PRRC_kwDOABII586R7tjD",
      "diff_hunk": "@@ -839,14 +840,17 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\n         const AddrInfo& ai{it->second};\n \n         // Filter by network (optional)\n-        if (network != std::nullopt && ai.GetNetClass() != network) continue;\n+        if (network != std::nullopt && ai.GetNetClass() != network) { ++filtered_addresses; continue; }",
      "path": "src/addrman.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "c8cb2ea11454a6edd8d8a8a83bb1be3596e9ff17",
      "original_commit_id": "c8cb2ea11454a6edd8d8a8a83bb1be3596e9ff17",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "here and below: would be good to expand this over multiple lines (clang-format)",
      "created_at": "2025-10-21T13:38:12Z",
      "updated_at": "2025-10-22T08:18:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2448349379",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2448349379"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 843,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2460863763",
      "pull_request_review_id": 3377288982,
      "id": 2460863763,
      "node_id": "PRRC_kwDOABII586Src0T",
      "diff_hunk": "@@ -839,14 +840,26 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\n         const AddrInfo& ai{it->second};\n \n         // Filter by network (optional)\n-        if (network != std::nullopt && ai.GetNetClass() != network) continue;\n+        if (network != std::nullopt && ai.GetNetClass() != network) {\n+            ++filtered_addresses;\n+            continue;\n+        }\n \n         // Filter for quality\n-        if (ai.IsTerrible(now) && filtered) continue;\n+        if (ai.IsTerrible(now) && filtered) {\n+            ++filtered_addresses;\n+            continue;\n+        }\n+\n+        // Filter by policy",
      "path": "src/addrman.cpp",
      "position": 42,
      "original_position": 34,
      "commit_id": "33e59cf4ece4f91304500cce3e827ec80250d843",
      "original_commit_id": "70e2204b614af0d83e138b060de1139b651e5445",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "You should add a functional/unit test for this. See uncovered new code: https://corecheck.dev/bitcoin/bitcoin/pulls/33663",
      "created_at": "2025-10-24T14:49:01Z",
      "updated_at": "2025-10-24T14:49:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2460863763",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2460863763"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 855,
      "original_line": 855,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2460878690",
      "pull_request_review_id": 3377308347,
      "id": 2460878690,
      "node_id": "PRRC_kwDOABII586Srgdi",
      "diff_hunk": "@@ -839,14 +840,26 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\n         const AddrInfo& ai{it->second};\n \n         // Filter by network (optional)\n-        if (network != std::nullopt && ai.GetNetClass() != network) continue;\n+        if (network != std::nullopt && ai.GetNetClass() != network) {\n+            ++filtered_addresses;\n+            continue;\n+        }\n \n         // Filter for quality\n-        if (ai.IsTerrible(now) && filtered) continue;\n+        if (ai.IsTerrible(now) && filtered) {\n+            ++filtered_addresses;\n+            continue;\n+        }\n+\n+        // Filter by policy",
      "path": "src/addrman.cpp",
      "position": 42,
      "original_position": 34,
      "commit_id": "33e59cf4ece4f91304500cce3e827ec80250d843",
      "original_commit_id": "70e2204b614af0d83e138b060de1139b651e5445",
      "in_reply_to_id": 2460863763,
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Will do, looking into coverege *and sonarcloud* right now",
      "created_at": "2025-10-24T14:51:26Z",
      "updated_at": "2025-10-24T14:51:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2460878690",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2460878690"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 855,
      "original_line": 855,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2469690257",
      "pull_request_review_id": 3388934345,
      "id": 2469690257,
      "node_id": "PRRC_kwDOABII586TNHuR",
      "diff_hunk": "@@ -839,14 +840,26 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\n         const AddrInfo& ai{it->second};\n \n         // Filter by network (optional)\n-        if (network != std::nullopt && ai.GetNetClass() != network) continue;\n+        if (network != std::nullopt && ai.GetNetClass() != network) {\n+            ++filtered_addresses;\n+            continue;\n+        }\n \n         // Filter for quality\n-        if (ai.IsTerrible(now) && filtered) continue;\n+        if (ai.IsTerrible(now) && filtered) {\n+            ++filtered_addresses;\n+            continue;\n+        }\n+\n+        // Filter by policy\n+        if (policy && policy(ai)) {\n+            ++filtered_addresses;\n+            continue;",
      "path": "src/addrman.cpp",
      "position": 45,
      "original_position": 37,
      "commit_id": "33e59cf4ece4f91304500cce3e827ec80250d843",
      "original_commit_id": "d7c5cbb7f9ad13b6fa7f8d359d86c68f512749af",
      "in_reply_to_id": null,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Thanks for adding test coverage. By doing mutation testing for this PR, I noticed that the following mutant has not been killed (it means tests were not able to detect this change):\r\n\r\n```diff\r\ndiff --git a/src/addrman.cpp b/src/addrman.cpp\r\nindex c06fbb0673..4cc7073c3b 100644\r\n--- a/src/addrman.cpp\r\n+++ b/src/addrman.cpp\r\n@@ -854,7 +854,7 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\r\n         // Filter by policy\r\n         if (policy && policy(ai)) {\r\n             ++filtered_addresses;\r\n-            continue;\r\n+            break;\r\n         }\r\n```\r\n\r\nThis is because you're checking that the addresses that are returned when filtering by port are - de facto - according to the policy. However, you could also check that all the proper addresses are being returned, I think just adding the following check would be enough:\r\n\r\n```diff\r\ndiff --git a/src/test/addrman_tests.cpp b/src/test/addrman_tests.cpp\r\nindex 987249104d..3073656ed5 100644\r\n--- a/src/test/addrman_tests.cpp\r\n+++ b/src/test/addrman_tests.cpp\r\n@@ -421,6 +421,7 @@ BOOST_AUTO_TEST_CASE(addrman_getaddr)\r\n     BOOST_CHECK_EQUAL(vAddrNoPolicy.size(), addedAddresses);\r\n     BOOST_CHECK_EQUAL(vAddrPolicyNoSkip.size(), vAddrNoPolicy.size());\r\n     BOOST_CHECK_EQUAL(vAddrPolicySkipAll.size(), 0);\r\n+    BOOST_CHECK_EQUAL(vAddrPolicyPort.size(), 4U);\r\n     BOOST_CHECK(std::none_of(vAddrPolicyPort.begin(), vAddrPolicyPort.end(), policyPortPolicy));\r\n```",
      "created_at": "2025-10-28T13:59:08Z",
      "updated_at": "2025-10-28T13:59:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2469690257",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2469690257"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 858,
      "original_line": 858,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2469805737",
      "pull_request_review_id": 3389099121,
      "id": 2469805737,
      "node_id": "PRRC_kwDOABII586TNj6p",
      "diff_hunk": "@@ -839,14 +840,26 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\n         const AddrInfo& ai{it->second};\n \n         // Filter by network (optional)\n-        if (network != std::nullopt && ai.GetNetClass() != network) continue;\n+        if (network != std::nullopt && ai.GetNetClass() != network) {\n+            ++filtered_addresses;\n+            continue;\n+        }\n \n         // Filter for quality\n-        if (ai.IsTerrible(now) && filtered) continue;\n+        if (ai.IsTerrible(now) && filtered) {\n+            ++filtered_addresses;\n+            continue;\n+        }\n+\n+        // Filter by policy\n+        if (policy && policy(ai)) {\n+            ++filtered_addresses;\n+            continue;",
      "path": "src/addrman.cpp",
      "position": 45,
      "original_position": 37,
      "commit_id": "33e59cf4ece4f91304500cce3e827ec80250d843",
      "original_commit_id": "d7c5cbb7f9ad13b6fa7f8d359d86c68f512749af",
      "in_reply_to_id": 2469690257,
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Thanks for running mutation testing and for review!\r\n\r\nI'm thinking:\r\n```cpp\r\n    const std::set<CAddress> vExpectedAddresses = {addr1, addr3, addr4, addr5};\r\n    BOOST_CHECK_EQUAL(vAddrPolicyPort.size(), vExpectedAddresses.size());\r\n    BOOST_CHECK(std::all_of(vAddrPolicyPort.begin(), vAddrPolicyPort.end(), [&](const CAddress& a){ return vExpectedAddresses.contains(a); }));\r\n    BOOST_CHECK(std::none_of(vAddrPolicyPort.begin(), vAddrPolicyPort.end(), policyPortPolicy));\r\n```",
      "created_at": "2025-10-28T14:29:39Z",
      "updated_at": "2025-10-28T14:29:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2469805737",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2469805737"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 858,
      "original_line": 858,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2527033639",
      "pull_request_review_id": 3464332521,
      "id": 2527033639,
      "node_id": "PRRC_kwDOABII586Wn3kn",
      "diff_hunk": "@@ -3527,13 +3527,10 @@ CConnman::~CConnman()\n \n std::vector<CAddress> CConnman::GetAddressesUnsafe(size_t max_addresses, size_t max_pct, std::optional<Network> network, const bool filtered) const\n {\n-    std::vector<CAddress> addresses = addrman.GetAddr(max_addresses, max_pct, network, filtered);\n-    if (m_banman) {\n-        addresses.erase(std::remove_if(addresses.begin(), addresses.end(),\n-                        [this](const CAddress& addr){return m_banman->IsDiscouraged(addr) || m_banman->IsBanned(addr);}),\n-                        addresses.end());\n-    }\n-    return addresses;\n+        const AddrMan::AddrPolicy policy = [this](const CAddress& addr) {",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 11,
      "commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "original_commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "in_reply_to_id": null,
      "user": {
        "login": "frankomosh",
        "id": 33951953,
        "node_id": "MDQ6VXNlcjMzOTUxOTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33951953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/frankomosh",
        "html_url": "https://github.com/frankomosh",
        "followers_url": "https://api.github.com/users/frankomosh/followers",
        "following_url": "https://api.github.com/users/frankomosh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/frankomosh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/frankomosh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/frankomosh/subscriptions",
        "organizations_url": "https://api.github.com/users/frankomosh/orgs",
        "repos_url": "https://api.github.com/users/frankomosh/repos",
        "events_url": "https://api.github.com/users/frankomosh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/frankomosh/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Is there a way/test to verify that the `BanMan` methods here are safe to call while `AddrMan`'s lock is held? \r\n\r\nCan see a comment in `addrman.h` says the policy \"must not acquire locks that can conflict with `AddrMan::cs`\". So it would make sense to ensure deadlock scenario is not accidentally created.",
      "created_at": "2025-11-14T10:46:55Z",
      "updated_at": "2025-11-14T10:54:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2527033639",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2527033639"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3532,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2527062353",
      "pull_request_review_id": 3464332521,
      "id": 2527062353,
      "node_id": "PRRC_kwDOABII586Wn-lR",
      "diff_hunk": "@@ -839,14 +840,26 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\n         const AddrInfo& ai{it->second};\n \n         // Filter by network (optional)\n-        if (network != std::nullopt && ai.GetNetClass() != network) continue;\n+        if (network != std::nullopt && ai.GetNetClass() != network) {\n+            ++filtered_addresses;",
      "path": "src/addrman.cpp",
      "position": 1,
      "original_position": 23,
      "commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "original_commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "in_reply_to_id": null,
      "user": {
        "login": "frankomosh",
        "id": 33951953,
        "node_id": "MDQ6VXNlcjMzOTUxOTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33951953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/frankomosh",
        "html_url": "https://github.com/frankomosh",
        "followers_url": "https://api.github.com/users/frankomosh/followers",
        "following_url": "https://api.github.com/users/frankomosh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/frankomosh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/frankomosh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/frankomosh/subscriptions",
        "organizations_url": "https://api.github.com/users/frankomosh/orgs",
        "repos_url": "https://api.github.com/users/frankomosh/repos",
        "events_url": "https://api.github.com/users/frankomosh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/frankomosh/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Would network mismatches also count as `filtered` i this case?",
      "created_at": "2025-11-14T10:53:36Z",
      "updated_at": "2025-11-14T10:54:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2527062353",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2527062353"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 844,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2527423684",
      "pull_request_review_id": 3464836555,
      "id": 2527423684,
      "node_id": "PRRC_kwDOABII586WpWzE",
      "diff_hunk": "@@ -3527,13 +3527,10 @@ CConnman::~CConnman()\n \n std::vector<CAddress> CConnman::GetAddressesUnsafe(size_t max_addresses, size_t max_pct, std::optional<Network> network, const bool filtered) const\n {\n-    std::vector<CAddress> addresses = addrman.GetAddr(max_addresses, max_pct, network, filtered);\n-    if (m_banman) {\n-        addresses.erase(std::remove_if(addresses.begin(), addresses.end(),\n-                        [this](const CAddress& addr){return m_banman->IsDiscouraged(addr) || m_banman->IsBanned(addr);}),\n-                        addresses.end());\n-    }\n-    return addresses;\n+        const AddrMan::AddrPolicy policy = [this](const CAddress& addr) {",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 11,
      "commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "original_commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "in_reply_to_id": 2527033639,
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The BanMan methods used here take `m_banned_mutex` and never call back into `AddrMan`, so the lock order in this policy is currently `AddrMan::cs`>`BanMan::m_banned_mutex` with no reverse lock order in the codebase.\r\n\r\nUsing the predicate here also enforces that `AddrMan::cs` is always taken first, before any `BanMan` locks which helps maintain a consistent lock order.\r\n\r\n`GetAddressesUnsafe()` is invoked on startup to load `peers.dat` with the responses being cached for `CConnman::GetAddresses()`, every 24h for `CConnman::ASMapHealthCheck()`, when a GETADDR message is called and the peer has permission `NetPermissionFlags::Addr` and finally by RPC `getnodeaddresses`.  I tested each of these manually and checked the lock ordering and lock wait times.\r\n\r\nRegarding ways to test for lock ordering, a debug build will enable `DEBUG_LOCKORDER` and `DEBUG_LOCKCONTENTION` which will log issues with lock ordering or lock waits (`--debug=lock`).\r\n(see: https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#debug_lockorder) ",
      "created_at": "2025-11-14T13:01:46Z",
      "updated_at": "2025-11-14T13:01:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2527423684",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2527423684"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3532,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2527436474",
      "pull_request_review_id": 3464854203,
      "id": 2527436474,
      "node_id": "PRRC_kwDOABII586WpZ66",
      "diff_hunk": "@@ -839,14 +840,26 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\n         const AddrInfo& ai{it->second};\n \n         // Filter by network (optional)\n-        if (network != std::nullopt && ai.GetNetClass() != network) continue;\n+        if (network != std::nullopt && ai.GetNetClass() != network) {\n+            ++filtered_addresses;",
      "path": "src/addrman.cpp",
      "position": 1,
      "original_position": 23,
      "commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "original_commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "in_reply_to_id": 2527062353,
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yes; Currently all skipped addresses in `AddrMan::GetAddr` are counted as `filtered`; If you'd prefer (or find it useful) separate counters for each reason (Network, Quality or Policy), I can add that.",
      "created_at": "2025-11-14T13:06:01Z",
      "updated_at": "2025-11-14T13:06:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2527436474",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2527436474"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 844,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2533079324",
      "pull_request_review_id": 3471451595,
      "id": 2533079324,
      "node_id": "PRRC_kwDOABII586W-7kc",
      "diff_hunk": "@@ -839,14 +840,26 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\n         const AddrInfo& ai{it->second};\n \n         // Filter by network (optional)\n-        if (network != std::nullopt && ai.GetNetClass() != network) continue;\n+        if (network != std::nullopt && ai.GetNetClass() != network) {\n+            ++filtered_addresses;",
      "path": "src/addrman.cpp",
      "position": 1,
      "original_position": 23,
      "commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "original_commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "in_reply_to_id": 2527062353,
      "user": {
        "login": "frankomosh",
        "id": 33951953,
        "node_id": "MDQ6VXNlcjMzOTUxOTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33951953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/frankomosh",
        "html_url": "https://github.com/frankomosh",
        "followers_url": "https://api.github.com/users/frankomosh/followers",
        "following_url": "https://api.github.com/users/frankomosh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/frankomosh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/frankomosh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/frankomosh/subscriptions",
        "organizations_url": "https://api.github.com/users/frankomosh/orgs",
        "repos_url": "https://api.github.com/users/frankomosh/repos",
        "events_url": "https://api.github.com/users/frankomosh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/frankomosh/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Maybe separate would be clearer for diagnostics. Up to you though,.. if you think the current logging is clear enough then that's fine too. ",
      "created_at": "2025-11-17T08:07:01Z",
      "updated_at": "2025-11-17T08:07:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2533079324",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2533079324"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 844,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2533096852",
      "pull_request_review_id": 3471474397,
      "id": 2533096852,
      "node_id": "PRRC_kwDOABII586W-_2U",
      "diff_hunk": "@@ -3527,13 +3527,10 @@ CConnman::~CConnman()\n \n std::vector<CAddress> CConnman::GetAddressesUnsafe(size_t max_addresses, size_t max_pct, std::optional<Network> network, const bool filtered) const\n {\n-    std::vector<CAddress> addresses = addrman.GetAddr(max_addresses, max_pct, network, filtered);\n-    if (m_banman) {\n-        addresses.erase(std::remove_if(addresses.begin(), addresses.end(),\n-                        [this](const CAddress& addr){return m_banman->IsDiscouraged(addr) || m_banman->IsBanned(addr);}),\n-                        addresses.end());\n-    }\n-    return addresses;\n+        const AddrMan::AddrPolicy policy = [this](const CAddress& addr) {",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 11,
      "commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "original_commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "in_reply_to_id": 2527033639,
      "user": {
        "login": "frankomosh",
        "id": 33951953,
        "node_id": "MDQ6VXNlcjMzOTUxOTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33951953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/frankomosh",
        "html_url": "https://github.com/frankomosh",
        "followers_url": "https://api.github.com/users/frankomosh/followers",
        "following_url": "https://api.github.com/users/frankomosh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/frankomosh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/frankomosh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/frankomosh/subscriptions",
        "organizations_url": "https://api.github.com/users/frankomosh/orgs",
        "repos_url": "https://api.github.com/users/frankomosh/repos",
        "events_url": "https://api.github.com/users/frankomosh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/frankomosh/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> The BanMan methods used here take `m_banned_mutex` and never call back into `AddrMan`, so the lock order in this policy is currently `AddrMan::cs`>`BanMan::m_banned_mutex` with no reverse lock order in the codebase.\r\n> \r\nThanks. Might be worth a comment somewhere in the code documenting this ordering requirement so someone does not accidentally introduce the reverse path in future ?\r\n\r\n",
      "created_at": "2025-11-17T08:13:40Z",
      "updated_at": "2025-11-17T08:13:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2533096852",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2533096852"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3532,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2533700190",
      "pull_request_review_id": 3472243618,
      "id": 2533700190,
      "node_id": "PRRC_kwDOABII586XBTJe",
      "diff_hunk": "@@ -839,14 +840,26 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\n         const AddrInfo& ai{it->second};\n \n         // Filter by network (optional)\n-        if (network != std::nullopt && ai.GetNetClass() != network) continue;\n+        if (network != std::nullopt && ai.GetNetClass() != network) {\n+            ++filtered_addresses;",
      "path": "src/addrman.cpp",
      "position": 1,
      "original_position": 23,
      "commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "original_commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "in_reply_to_id": 2527062353,
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Went with separate counters and also added the selected network to the log output for clarity.\r\nExample log entry:\r\n```\r\n[addrman] GetAddr returned 62823 random addresses from ipv4; 1104 filtered (0 network, 0 quality, 1104 policy)\r\n[addrman] GetAddr returned 0 random addresses from ipv6; 63927 filtered (63927 network, 0 quality, 0 policy)\r\n[addrman] GetAddr returned 0 random addresses from onion; 63927 filtered (66927 network, 0 quality, 0 policy)\r\n```",
      "created_at": "2025-11-17T11:25:35Z",
      "updated_at": "2025-11-17T11:25:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2533700190",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2533700190"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 844,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2533706305",
      "pull_request_review_id": 3472250381,
      "id": 2533706305,
      "node_id": "PRRC_kwDOABII586XBUpB",
      "diff_hunk": "@@ -3527,13 +3527,10 @@ CConnman::~CConnman()\n \n std::vector<CAddress> CConnman::GetAddressesUnsafe(size_t max_addresses, size_t max_pct, std::optional<Network> network, const bool filtered) const\n {\n-    std::vector<CAddress> addresses = addrman.GetAddr(max_addresses, max_pct, network, filtered);\n-    if (m_banman) {\n-        addresses.erase(std::remove_if(addresses.begin(), addresses.end(),\n-                        [this](const CAddress& addr){return m_banman->IsDiscouraged(addr) || m_banman->IsBanned(addr);}),\n-                        addresses.end());\n-    }\n-    return addresses;\n+        const AddrMan::AddrPolicy policy = [this](const CAddress& addr) {",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 11,
      "commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "original_commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "in_reply_to_id": 2527033639,
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Updated comments for more clarity\r\nin addrman.h:\r\n```cpp\r\n    /** Predicate used to exclude addresses during selection.\r\n     *  Return true to skip the given address.\r\n     *\r\n     *  Runs while holding AddrMan::cs, so it must be non-blocking, must not\r\n     *  attempt to reacquire AddrMan::cs, and must preserve lock ordering to\r\n     *  avoid deadlocks.\r\n     */\r\n```\r\nin net.cpp -> GetAddressesUnsafe()\r\n```cpp\r\n        // This runs under AddrMan::cs, and BanMan checks take m_banned_mutex.\r\n        // The lock order here is AddrMan::cs -> m_banned_mutex.\r\n```\r\n",
      "created_at": "2025-11-17T11:27:38Z",
      "updated_at": "2025-11-17T11:27:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2533706305",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2533706305"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3532,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2534658896",
      "pull_request_review_id": 3473458139,
      "id": 2534658896,
      "node_id": "PRRC_kwDOABII586XE9NQ",
      "diff_hunk": "@@ -3527,13 +3527,10 @@ CConnman::~CConnman()\n \n std::vector<CAddress> CConnman::GetAddressesUnsafe(size_t max_addresses, size_t max_pct, std::optional<Network> network, const bool filtered) const\n {\n-    std::vector<CAddress> addresses = addrman.GetAddr(max_addresses, max_pct, network, filtered);\n-    if (m_banman) {\n-        addresses.erase(std::remove_if(addresses.begin(), addresses.end(),\n-                        [this](const CAddress& addr){return m_banman->IsDiscouraged(addr) || m_banman->IsBanned(addr);}),\n-                        addresses.end());\n-    }\n-    return addresses;\n+        const AddrMan::AddrPolicy policy = [this](const CAddress& addr) {",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 11,
      "commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "original_commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "in_reply_to_id": 2527033639,
      "user": {
        "login": "frankomosh",
        "id": 33951953,
        "node_id": "MDQ6VXNlcjMzOTUxOTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33951953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/frankomosh",
        "html_url": "https://github.com/frankomosh",
        "followers_url": "https://api.github.com/users/frankomosh/followers",
        "following_url": "https://api.github.com/users/frankomosh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/frankomosh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/frankomosh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/frankomosh/subscriptions",
        "organizations_url": "https://api.github.com/users/frankomosh/orgs",
        "repos_url": "https://api.github.com/users/frankomosh/repos",
        "events_url": "https://api.github.com/users/frankomosh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/frankomosh/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Thanks",
      "created_at": "2025-11-17T16:01:57Z",
      "updated_at": "2025-11-17T16:01:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2534658896",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2534658896"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3532,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2534681621",
      "pull_request_review_id": 3473487530,
      "id": 2534681621,
      "node_id": "PRRC_kwDOABII586XFCwV",
      "diff_hunk": "@@ -839,14 +840,26 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\n         const AddrInfo& ai{it->second};\n \n         // Filter by network (optional)\n-        if (network != std::nullopt && ai.GetNetClass() != network) continue;\n+        if (network != std::nullopt && ai.GetNetClass() != network) {\n+            ++filtered_addresses;",
      "path": "src/addrman.cpp",
      "position": 1,
      "original_position": 23,
      "commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "original_commit_id": "4f39b9255bcb2d116e776e41beaef7817f9a734d",
      "in_reply_to_id": 2527062353,
      "user": {
        "login": "frankomosh",
        "id": 33951953,
        "node_id": "MDQ6VXNlcjMzOTUxOTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33951953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/frankomosh",
        "html_url": "https://github.com/frankomosh",
        "followers_url": "https://api.github.com/users/frankomosh/followers",
        "following_url": "https://api.github.com/users/frankomosh/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/frankomosh/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/frankomosh/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/frankomosh/subscriptions",
        "organizations_url": "https://api.github.com/users/frankomosh/orgs",
        "repos_url": "https://api.github.com/users/frankomosh/repos",
        "events_url": "https://api.github.com/users/frankomosh/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/frankomosh/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Awesome",
      "created_at": "2025-11-17T16:08:36Z",
      "updated_at": "2025-11-17T16:08:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2534681621",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2534681621"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 844,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2641433669",
      "pull_request_review_id": 3605973252,
      "id": 2641433669,
      "node_id": "PRRC_kwDOABII586dcRRF",
      "diff_hunk": "@@ -3527,13 +3527,12 @@ CConnman::~CConnman()\n \n std::vector<CAddress> CConnman::GetAddressesUnsafe(size_t max_addresses, size_t max_pct, std::optional<Network> network, const bool filtered) const\n {\n-    std::vector<CAddress> addresses = addrman.GetAddr(max_addresses, max_pct, network, filtered);\n-    if (m_banman) {\n-        addresses.erase(std::remove_if(addresses.begin(), addresses.end(),\n-                        [this](const CAddress& addr){return m_banman->IsDiscouraged(addr) || m_banman->IsBanned(addr);}),\n-                        addresses.end());\n-    }\n-    return addresses;\n+        // This runs under AddrMan::cs, and BanMan checks take m_banned_mutex.\n+        // The lock order here is AddrMan::cs -> m_banned_mutex.\n+        const AddrMan::AddrPolicy policy = [this](const CAddress& addr) {\n+            return m_banman && (m_banman->IsDiscouraged(addr) || m_banman->IsBanned(addr));\n+        };\n+        return addrman.GetAddr(/*max_addresses=*/max_addresses, /*max_pct=*/max_pct, /*network=*/network, /*filtered=*/filtered, /*policy=*/policy);",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 16,
      "commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "original_commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: I don't think hints are helpful if the passed variables already have the same name, they just add noise.",
      "created_at": "2025-12-22T22:33:35Z",
      "updated_at": "2025-12-22T23:00:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2641433669",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2641433669"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3535,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2641437673",
      "pull_request_review_id": 3605973252,
      "id": 2641437673,
      "node_id": "PRRC_kwDOABII586dcSPp",
      "diff_hunk": "@@ -3527,13 +3527,12 @@ CConnman::~CConnman()\n \n std::vector<CAddress> CConnman::GetAddressesUnsafe(size_t max_addresses, size_t max_pct, std::optional<Network> network, const bool filtered) const\n {\n-    std::vector<CAddress> addresses = addrman.GetAddr(max_addresses, max_pct, network, filtered);\n-    if (m_banman) {\n-        addresses.erase(std::remove_if(addresses.begin(), addresses.end(),\n-                        [this](const CAddress& addr){return m_banman->IsDiscouraged(addr) || m_banman->IsBanned(addr);}),\n-                        addresses.end());\n-    }\n-    return addresses;\n+        // This runs under AddrMan::cs, and BanMan checks take m_banned_mutex.",
      "path": "src/net.cpp",
      "position": 1,
      "original_position": 11,
      "commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "original_commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "indentation is incorrect here.",
      "created_at": "2025-12-22T22:35:50Z",
      "updated_at": "2025-12-22T23:00:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2641437673",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2641437673"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3530,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2641461802",
      "pull_request_review_id": 3605973252,
      "id": 2641461802,
      "node_id": "PRRC_kwDOABII586dcYIq",
      "diff_hunk": "@@ -407,6 +407,27 @@ BOOST_AUTO_TEST_CASE(addrman_getaddr)\n     // Net processing asks for 23% of addresses. 23% of 5 is 1 rounded down.\n     BOOST_CHECK_EQUAL(addrman->GetAddr(/*max_addresses=*/2500, /*max_pct=*/23, /*network=*/std::nullopt).size(), 1U);\n \n+    // Test AddrMan::GetAddr filtering with various AddrPolicy rules.",
      "path": "src/test/addrman_tests.cpp",
      "position": 4,
      "original_position": 4,
      "commit_id": "33e59cf4ece4f91304500cce3e827ec80250d843",
      "original_commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Would be nice to also have some coverage in the addrman fuzz test.",
      "created_at": "2025-12-22T22:50:51Z",
      "updated_at": "2025-12-22T23:00:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2641461802",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2641461802"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 410,
      "original_line": 410,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2647287373",
      "pull_request_review_id": 3612547519,
      "id": 2647287373,
      "node_id": "PRRC_kwDOABII586dymZN",
      "diff_hunk": "@@ -169,10 +179,11 @@ class AddrMan\n      * @param[in] max_pct        Maximum percentage of addresses to return (0 = all). Value must be from 0 to 100.\n      * @param[in] network        Select only addresses of this network (nullopt = all).\n      * @param[in] filtered       Select only addresses that are considered good quality (false = all).\n+     * @param[in] policy         Optional predicate to exclude candidates during selection (true = exclude).",
      "path": "src/addrman.h",
      "position": 1,
      "original_position": 28,
      "commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "original_commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Hm, the `true = exclude` part doesn't have the same meaning as above because this is not a bool parameter. Maybe update this to be more precise. The `filtered` option doesn't say that it's optional so you might add that while you touch this.",
      "created_at": "2025-12-25T22:05:39Z",
      "updated_at": "2025-12-25T22:29:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2647287373",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2647287373"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 182,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2647288578",
      "pull_request_review_id": 3612547519,
      "id": 2647288578,
      "node_id": "PRRC_kwDOABII586dymsC",
      "diff_hunk": "@@ -827,6 +828,7 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\n     const auto now{Now<NodeSeconds>()};\n     std::vector<CAddress> addresses;\n     addresses.reserve(nNodes);\n+    size_t filtered_addr_net = 0, filtered_addr_quality = 0, filtered_addr_policy = 0;",
      "path": "src/addrman.cpp",
      "position": 21,
      "original_position": 21,
      "commit_id": "33e59cf4ece4f91304500cce3e827ec80250d843",
      "original_commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "A general problem with the separate tracking like this is that it's order dependent and so the values may actually be somewhat misleading. I.e. if there are some addrs filtered by policy but they are already caught by the net filter they won't be included here. Doing this in a cleaner way may be overengineering but I wanted to mention that this isn't ideal.",
      "created_at": "2025-12-25T22:09:40Z",
      "updated_at": "2025-12-25T22:29:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2647288578",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2647288578"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 831,
      "original_line": 831,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2647290335",
      "pull_request_review_id": 3612547519,
      "id": 2647290335,
      "node_id": "PRRC_kwDOABII586dynHf",
      "diff_hunk": "@@ -827,6 +828,7 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\n     const auto now{Now<NodeSeconds>()};\n     std::vector<CAddress> addresses;\n     addresses.reserve(nNodes);\n+    size_t filtered_addr_net = 0, filtered_addr_quality = 0, filtered_addr_policy = 0;",
      "path": "src/addrman.cpp",
      "position": 21,
      "original_position": 21,
      "commit_id": "33e59cf4ece4f91304500cce3e827ec80250d843",
      "original_commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "in_reply_to_id": 2647288578,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Adding to that: the non-optional filter is now in between two optional filters. Feels to me like the optional checks should go after the mandatory but maybe there are arguments for doing it the other way around.",
      "created_at": "2025-12-25T22:15:10Z",
      "updated_at": "2025-12-25T22:29:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2647290335",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2647290335"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 831,
      "original_line": 831,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2647292284",
      "pull_request_review_id": 3612547519,
      "id": 2647292284,
      "node_id": "PRRC_kwDOABII586dynl8",
      "diff_hunk": "@@ -839,14 +841,31 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\n         const AddrInfo& ai{it->second};\n \n         // Filter by network (optional)\n-        if (network != std::nullopt && ai.GetNetClass() != network) continue;\n+        if (network != std::nullopt && ai.GetNetClass() != network) {\n+            ++filtered_addr_net;\n+            continue;\n+        }\n \n         // Filter for quality\n-        if (ai.IsTerrible(now) && filtered) continue;\n+        if (ai.IsTerrible(now) && filtered) {\n+            ++filtered_addr_quality;\n+            continue;\n+        }\n+\n+        // Filter by policy\n+        if (policy && policy(ai)) {\n+            ++filtered_addr_policy;\n+            continue;\n+        }\n \n         addresses.push_back(ai);\n     }\n-    LogDebug(BCLog::ADDRMAN, \"GetAddr returned %d random addresses\\n\", addresses.size());\n+    LogDebug(BCLog::ADDRMAN, \"GetAddr returned %zu random addresses from %s; %zu filtered \"\n+                             \"(%zu network, %zu quality, %zu policy)\\n\",",
      "path": "src/addrman.cpp",
      "position": 52,
      "original_position": 52,
      "commit_id": "33e59cf4ece4f91304500cce3e827ec80250d843",
      "original_commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Would be generally nice if the options that weren't used are also not logged.",
      "created_at": "2025-12-25T22:21:15Z",
      "updated_at": "2025-12-25T22:29:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2647292284",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2647292284"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 864,
      "original_line": 864,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2647296111",
      "pull_request_review_id": 3612553186,
      "id": 2647296111,
      "node_id": "PRRC_kwDOABII586dyohv",
      "diff_hunk": "@@ -827,6 +828,7 @@ std::vector<CAddress> AddrManImpl::GetAddr_(size_t max_addresses, size_t max_pct\n     const auto now{Now<NodeSeconds>()};\n     std::vector<CAddress> addresses;\n     addresses.reserve(nNodes);\n+    size_t filtered_addr_net = 0, filtered_addr_quality = 0, filtered_addr_policy = 0;",
      "path": "src/addrman.cpp",
      "position": 21,
      "original_position": 21,
      "commit_id": "33e59cf4ece4f91304500cce3e827ec80250d843",
      "original_commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "in_reply_to_id": 2647288578,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "If my suggestion from the top level comment is taken this is kind of obsolete but if not i think rather than trying to count each filter individually I would rather just log the total filtered count and which filters were active. I think that's simpler and least confusing.",
      "created_at": "2025-12-25T22:31:55Z",
      "updated_at": "2025-12-25T22:31:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2647296111",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2647296111"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 831,
      "original_line": 831,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2649339695",
      "pull_request_review_id": 3614441070,
      "id": 2649339695,
      "node_id": "PRRC_kwDOABII586d6bcv",
      "diff_hunk": "@@ -23,6 +23,7 @@\n \n #include <cmath>\n #include <optional>\n+#include <netbase.h>",
      "path": "src/addrman.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "original_commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: ordering",
      "created_at": "2025-12-27T21:42:41Z",
      "updated_at": "2025-12-28T00:22:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2649339695",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2649339695"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2649339737",
      "pull_request_review_id": 3614441070,
      "id": 2649339737,
      "node_id": "PRRC_kwDOABII586d6bdZ",
      "diff_hunk": "@@ -18,6 +18,7 @@\n #include <unordered_set>\n #include <utility>\n #include <vector>\n+#include <functional>",
      "path": "src/addrman.h",
      "position": 1,
      "original_position": 4,
      "commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "original_commit_id": "fb3efdb3d267924266134f63b1ba6ddda0b6ce81",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: ordering",
      "created_at": "2025-12-27T21:42:50Z",
      "updated_at": "2025-12-28T00:22:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2649339737",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2649339737"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 21,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2649731154",
      "pull_request_review_id": 3614704810,
      "id": 2649731154,
      "node_id": "PRRC_kwDOABII586d77BS",
      "diff_hunk": "@@ -179,6 +179,27 @@ FUZZ_TARGET(addrman, .init = initialize_addrman)\n     auto filtered = fuzzed_data_provider.ConsumeBool();\n     (void)const_addr_man.GetAddr(max_addresses, max_pct, network, filtered);\n \n+    CallOneOf(\n+        fuzzed_data_provider,\n+        [&] {\n+            (void)const_addr_man.GetAddr(max_addresses, max_pct, network, filtered);",
      "path": "src/test/fuzz/addrman.cpp",
      "position": 1,
      "original_position": 7,
      "commit_id": "33e7b6647979112fbe657e5c70790b869fa7af57",
      "original_commit_id": "33e7b6647979112fbe657e5c70790b869fa7af57",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Why would you call the same line as above again? This line is completely redundant.",
      "created_at": "2025-12-28T14:23:31Z",
      "updated_at": "2025-12-28T14:23:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2649731154",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2649731154"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 185,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2649746770",
      "pull_request_review_id": 3614716391,
      "id": 2649746770,
      "node_id": "PRRC_kwDOABII586d7-1S",
      "diff_hunk": "@@ -179,6 +179,27 @@ FUZZ_TARGET(addrman, .init = initialize_addrman)\n     auto filtered = fuzzed_data_provider.ConsumeBool();\n     (void)const_addr_man.GetAddr(max_addresses, max_pct, network, filtered);\n \n+    CallOneOf(\n+        fuzzed_data_provider,\n+        [&] {\n+            (void)const_addr_man.GetAddr(max_addresses, max_pct, network, filtered);",
      "path": "src/test/fuzz/addrman.cpp",
      "position": 1,
      "original_position": 7,
      "commit_id": "33e7b6647979112fbe657e5c70790b869fa7af57",
      "original_commit_id": "33e7b6647979112fbe657e5c70790b869fa7af57",
      "in_reply_to_id": 2649731154,
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "oopsie",
      "created_at": "2025-12-28T14:52:09Z",
      "updated_at": "2025-12-28T14:52:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33663#discussion_r2649746770",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2649746770"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33663"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 185,
      "side": "RIGHT"
    }
  ]
}