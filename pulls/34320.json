{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320",
    "id": 3181854676,
    "node_id": "PR_kwDOABII5869pz_U",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/34320",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/34320.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/34320.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34320",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34320/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/dd76338a57b9b1169ac27f7b783d6d0d4c6e38ab",
    "number": 34320,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "coins: remove redundant and confusing `CCoinsViewDB::HaveCoin`",
    "user": {
      "login": "l0rinc",
      "id": 1841944,
      "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/l0rinc",
      "html_url": "https://github.com/l0rinc",
      "followers_url": "https://api.github.com/users/l0rinc/followers",
      "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
      "organizations_url": "https://api.github.com/users/l0rinc/orgs",
      "repos_url": "https://api.github.com/users/l0rinc/repos",
      "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/l0rinc/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "Split out of https://github.com/bitcoin/bitcoin/pull/34132#discussion_r2692307054.\r\n\r\n### Problem\r\nWe have two ways to check if a coin exists in the DB.\r\nOne tries to deserialize; the other just returns whether any value is associated with the key.\r\nBut we usually need the full value we probed for, and `HaveCoin` cannot cache the returned value, so it can trigger an extra lookup if `HaveCoin` uses `Exists` and the caller later needs the actual value.\r\nWe're already delegating most `HaveCoin` calls to `GetCoin` anyway for the above reasons, so the `CCoinsViewDB` implementation of `HaveCoin` is redundant.\r\n\r\n### Fix\r\nRemove `CCoinsViewDB::HaveCoin` (falls back to the base `CCoinsView::HaveCoin`, which delegates to `GetCoin`) and simplify `CCoinsViewCache::HaveCoin` to use `AccessCoin`.\r\n\r\n### Testing\r\nA unit test was added to confirm that `HaveInputs` calls the database's `::GetCoin` (not `::HaveCoin`) on cache miss and checks the cache first.\r\nAlso added a benchmark to track throughput before/after changes to ensure no regression.\r\n\r\n----\r\n\r\nNote: The latest version of the change keeps most `HaveCoin` calls for convenience; a previous version removed all of them.",
    "labels": [
      {
        "id": 97470796,
        "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
        "name": "UTXO Db and Indexes",
        "color": "fbca04",
        "default": false
      },
      {
        "id": 5334691551,
        "node_id": "LA_kwDOABII588AAAABPfju3w",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
        "name": "CI failed",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2026-01-16T16:17:29Z",
    "updated_at": "2026-02-20T18:15:48Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "be46a169211035374864ee2ede7f9de22b145356",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "l0rinc:l0rinc/remove-HaveCoin",
      "ref": "l0rinc/remove-HaveCoin",
      "sha": "dd76338a57b9b1169ac27f7b783d6d0d4c6e38ab",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 674169038,
        "node_id": "R_kgDOKC8Azg",
        "name": "bitcoin",
        "full_name": "l0rinc/bitcoin",
        "owner": {
          "login": "l0rinc",
          "id": 1841944,
          "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/l0rinc",
          "html_url": "https://github.com/l0rinc",
          "followers_url": "https://api.github.com/users/l0rinc/followers",
          "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
          "organizations_url": "https://api.github.com/users/l0rinc/orgs",
          "repos_url": "https://api.github.com/users/l0rinc/repos",
          "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/l0rinc/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/l0rinc/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/l0rinc/bitcoin",
        "archive_url": "https://api.github.com/repos/l0rinc/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/l0rinc/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/l0rinc/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/l0rinc/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/l0rinc/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/l0rinc/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/l0rinc/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/l0rinc/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/l0rinc/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/l0rinc/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/l0rinc/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/l0rinc/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/l0rinc/bitcoin/events",
        "forks_url": "https://api.github.com/repos/l0rinc/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/l0rinc/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/l0rinc/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/l0rinc/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/l0rinc/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/l0rinc/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/l0rinc/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/l0rinc/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/l0rinc/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/l0rinc/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/l0rinc/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/l0rinc/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/l0rinc/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/l0rinc/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/l0rinc/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/l0rinc/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:l0rinc/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/l0rinc/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/l0rinc/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/l0rinc/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/l0rinc/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/l0rinc/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/l0rinc/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/l0rinc/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/l0rinc/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/l0rinc/bitcoin/hooks",
        "svn_url": "https://github.com/l0rinc/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 4,
        "watchers_count": 4,
        "size": 292703,
        "default_branch": "master",
        "open_issues_count": 45,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-02-20T18:14:24Z",
        "created_at": "2023-08-03T09:49:12Z",
        "updated_at": "2026-02-20T11:05:38Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "a2fd558760abdbc41dd8b451cc4e6727cbc05cb9",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38920,
        "stargazers_count": 88200,
        "watchers_count": 88200,
        "size": 305452,
        "default_branch": "master",
        "open_issues_count": 721,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-02-20T11:13:08Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2026-02-20T18:22:34Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 131,
    "deletions": 35,
    "changed_files": 8,
    "commits": 4,
    "review_comments": 36,
    "comments": 10
  },
  "events": [
    {
      "event": "labeled",
      "id": 22099797162,
      "node_id": "LE_lADOABII587j2bERzwAAAAUlQCSq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22099797162",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-16T16:17:33Z",
      "label": {
        "name": "UTXO Db and Indexes",
        "color": "fbca04"
      }
    },
    {
      "event": "commented",
      "id": 3760801609,
      "node_id": "IC_kwDOABII587gKUdJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3760801609",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-16T16:17:39Z",
      "updated_at": "2026-02-20T15:57:14Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34320.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [Eunovo](https://github.com/bitcoin/bitcoin/pull/34320#pullrequestreview-3831369297) |\n| Stale ACK | [andrewtoth](https://github.com/bitcoin/bitcoin/pull/34320#pullrequestreview-3802394912) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#34132](https://github.com/bitcoin/bitcoin/pull/34132) (coins: drop error catcher, centralize fatal read handling by l0rinc)\n* [#34124](https://github.com/bitcoin/bitcoin/pull/34124) (refactor: make `CCoinsView` a pure virtual interface by l0rinc)\n* [#32427](https://github.com/bitcoin/bitcoin/pull/32427) ((RFC) kernel: Replace leveldb-based BlockTreeDB with flat-file based store by sedited)\n* [#32317](https://github.com/bitcoin/bitcoin/pull/32317) (kernel: Separate UTXO set access from validation functions by sedited)\n* [#31132](https://github.com/bitcoin/bitcoin/pull/31132) (validation: fetch block inputs on parallel threads 3x faster IBD by andrewtoth)\n* [#30342](https://github.com/bitcoin/bitcoin/pull/30342) (kernel, logging: Pass Logger instances to kernel objects by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (âœ¨ experimental)\n\n\n\nPossible places where named args for integral literals may be used (e.g. `func(x, /*named_arg=*/0)` in C++, and `func(x, named_arg=0)` in Python):\n\n- Coin{CTxOut{1, CScript{}}, 1, false} in src/test/coins_tests.cpp\n- Coin{CTxOut{1, CScript{}}, 1, false} in src/test/coins_tests.cpp\n\n\n\n<sup>2026-02-20 15:57:14</sup>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#issuecomment-3760801609",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34320"
    },
    {
      "event": "commented",
      "id": 3773430088,
      "node_id": "IC_kwDOABII587g6flI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3773430088",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-20T15:22:55Z",
      "updated_at": "2026-01-20T15:22:55Z",
      "author_association": "MEMBER",
      "body": "> One tries to deserialize, the other just returns whether any value is associated with the key.\r\n> But we usually need the full value we probed for, and `HaveCoin` cannot cache the returned value, so it can trigger an extra lookup if `HaveCoin` uses `Exists` and the caller later needs the actual value.\r\n\r\nAre there any flamegraphs or benchmarks, to see how this affects performance?",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#issuecomment-3773430088",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34320"
    },
    {
      "event": "commented",
      "id": 3773551201,
      "node_id": "IC_kwDOABII587g69Jh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3773551201",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-20T15:43:13Z",
      "updated_at": "2026-01-20T15:44:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Are there any flamegraphs or benchmarks, to see how this affects performance?\r\n\r\nI'm not sure what to measure exactly because the current code was already delegating to `GetCoin` in most places.\r\nThe pruned IBD and `-reindex-chainstate` and `AssumeUTXO` loading benchmarks I started haven't finished yet - but I don't expect *any* change there.\r\nIf you can describe a scenario that you would find helpful, please let me know.",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#issuecomment-3773551201",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34320"
    },
    {
      "event": "commented",
      "id": 3786631676,
      "node_id": "IC_kwDOABII587hs2n8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3786631676",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T20:50:56Z",
      "updated_at": "2026-01-22T20:50:56Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Are there any flamegraphs or benchmarks, to see how this affects performance?\r\n\r\nAdded assumeutxo load, reindex-chainstate and pruned IBD measurements to the PR description",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#issuecomment-3786631676",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34320"
    },
    {
      "event": "commented",
      "id": 3795502194,
      "node_id": "IC_kwDOABII587iOsRy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3795502194",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-24T20:56:43Z",
      "updated_at": "2026-01-24T20:57:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I'm not sure what to measure exactly because the current code was already delegating to GetCoin in most places.\r\n\r\nI'm not sure about this. `CCoinsViewCache::HaveCoin` seems to be the implementation that is called in all non-test places outside of `coins.cpp`, and only delegates to `GetCoin` if there's a cache miss. In `CCoinsViewCache::HaveCoin` we avoid copying `Coin`:\r\n\r\n```C++\r\nbool CCoinsViewCache::HaveCoin(const COutPoint &outpoint) const {\r\n    CCoinsMap::const_iterator it = FetchCoin(outpoint);\r\n    return (it != cacheCoins.end() && !it->second.coin.IsSpent());\r\n}\r\n```\r\n\r\nvs `CCoinsViewCache::GetCoin` where we return a copy of `Coin`:\r\n\r\n```C++\r\nstd::optional<Coin> CCoinsViewCache::GetCoin(const COutPoint& outpoint) const\r\n{\r\n    if (auto it{FetchCoin(outpoint)}; it != cacheCoins.end() && !it->second.coin.IsSpent()) return it->second.coin;\r\n    return std::nullopt;\r\n}\r\n```",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#issuecomment-3795502194",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34320"
    },
    {
      "event": "commented",
      "id": 3795574265,
      "node_id": "IC_kwDOABII587iO935",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3795574265",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-24T21:38:02Z",
      "updated_at": "2026-01-24T23:03:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "> we usually need the full value we probed for, and HaveCoin cannot cache the returned value, so it can trigger an extra lookup if HaveCoin uses Exists and the caller later needs the actual value.\r\n\r\nI see 4 uses of `HaveCoin`\r\n1. In `ConnectBlock`, we ensure we do not already have outputs of a block for BIP30 checks.\r\n2. In `ApplyTxInUndo`, we ensure we do not already have the coin we are about to roll back to unspent.\r\n3. In `MemPoolAccept::PreChecks`, where we check that we have all inputs of a tx we are accepting to the mempool.\r\n4. In `TxVerify`, where we call `HaveInputs`.\r\n\r\nFor 1 and 2, we are checking for the non-existence of the coin so we won't need the full value. In this case not caching the value makes sense.\r\nFor 3, it is explicitly relying on the fact that the value is cached. The backend is thrown away after all input prevouts are added to the top level cache.\r\nFor 4, it is a peformance improvement that the value is cached.\r\n\r\nI think 1 and 2 would benefit from `CCoinsViewCache::HaveCoin` delegating to the base's `HaveCoin` and not going through `FetchCoin`.\r\nFor 3 this seems like an abuse of the `CCoinsView` API. But, calling `GetCoin` instead there would result in unnecessary copying of the `Coin`. I'm not sure what the best solution is here.\r\nFor 4 the current behavior makes sense.\r\n",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#issuecomment-3795574265",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34320"
    },
    {
      "event": "commented",
      "id": 3796835980,
      "node_id": "IC_kwDOABII587iTx6M",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3796835980",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-25T15:28:29Z",
      "updated_at": "2026-01-25T16:28:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "> only delegates to GetCoin if there's a cache miss. In CCoinsViewCache::HaveCoin we avoid copying Coin\r\n\r\nDisassembly with separate translation units indicates `GetCoin()` does a new + memcpy of the Coin and the caller immediately deletes it, even when only checking `.has_value()`. `HaveCoin()` does indeed avoid it, but the extra copy only happens on the unexpectedly-present coin path, since if it's expected, we usually want to cache it. If we want to avoid the extra copy, we can use `AccessCoin`, but we would duplicate the spentness check.\r\n\r\n> In this case not caching the value makes sense.\r\n\r\nBut there's nothing to cache since these will return an empty optional. For BIP30 and `ApplyTxInUndo` the missing-coin path dominates, so `GetCoin()` short-circuits on `Read()` failure without deserialization, so I/O is the same as `Exists()`, no coin-copy happens (and when it does we crash or reorg anyway). But given that validation until bip30-end takes less than 3 minutes on my benchmarking server (see https://github.com/bitcoin/bitcoin/pull/33817), I'd say it's irrelevant either way.\r\n\r\n> For 3 this seems like an abuse of the CCoinsView API. But, calling GetCoin instead there would result in unnecessary copying of the Coin. I'm not sure what the best solution is here.\r\n\r\nThis is a good point, the disassembly indicates there's no devirtualization and no inlining in `CCoinsViewCache::HaveInputs` and `MemPoolAccept::PreChecks`, so the copy is real - though a lot faster than disk access, so it's not actually measurable.\r\nWe can use `AccessCoin` here and with explicit `IsSpent` call instead which would avoid the call (according to the assembly):\r\n```C++\r\nif (AccessCoin(tx.vin[i].prevout).IsSpent()) {\r\n```\r\nand\r\n```C++\r\nif (m_view.AccessCoin(txin.prevout).IsSpent()) {\r\n```\r\n\r\n----\r\n\r\nI have added a new benchmark as a first commit to check the performance of on-disk `HaveInputs` to make sure the performance is retained.\r\n\r\nBenchmark baseline:\r\n|               ns/tx |                tx/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|              998.95 |        1,001,046.69 |    0.8% |      1.09 | `HaveInputsOnDisk`\r\n\r\nBenchmark with `!GetCoin()` instead of `HaveCoin`:\r\n\r\n|               ns/tx |                tx/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|              985.57 |        1,014,640.63 |    0.8% |      1.10 | `HaveInputsOnDisk`\r\n\r\nReplace remaining `HaveCoin` calls with `GetCoin()`/`AccessCoin` and remove the former\r\n\r\n|               ns/tx |                tx/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|              983.17 |        1,017,118.55 |    0.3% |      1.10 | `HaveInputsOnDisk`\r\n\r\n(ran it 5 times for each commit and copied the fastest (with smallest noise). The small difference is reproducible, but not very important as long as it's not measurably slower)\r\n\r\n<details>\r\n<summary>Benchmarking script and results on Linux</summary>\r\n\r\n```bash\r\nfor commit in 3544b98927050956f68cb183bf2686f5c65e5ebb 8c568500442144fbcd457eccda5a1956aa98ca81; do \\                                        \r\n    git fetch origin $commit >/dev/null 2>&1 && git checkout $commit >/dev/null 2>&1 && echo \"\" && git log -1 --pretty='%h %s' && \\\r\n    rm -rf build >/dev/null 2>&1 && cmake -B build -DBUILD_BENCH=ON -DCMAKE_BUILD_TYPE=Release >/dev/null 2>&1 && \\\r\n    cmake --build build -j$(nproc) >/dev/null 2>&1 && \\\r\n    for _ in $(seq 5); do \\\r\n      sleep 5; \\\r\n      ./build/bin/bench_bitcoin -filter='HaveInputsOnDisk' -min-time=1000; \\\r\n    done; \\\r\ndone\r\n```\r\nresulting in\r\n> 3544b98927 bench: add on-disk `HaveInputs` benchmark\r\n\r\n|               ns/tx |                tx/s |    err% |          ins/tx |          cyc/tx |    IPC |         bra/tx |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|            2,137.20 |          467,902.92 |    0.0% |       16,874.42 |        7,673.54 |  2.199 |       2,895.01 |    0.8% |      1.09 | `HaveInputsOnDisk`\r\n\r\n|               ns/tx |                tx/s |    err% |          ins/tx |          cyc/tx |    IPC |         bra/tx |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|            2,153.41 |          464,380.56 |    0.0% |       16,873.94 |        7,729.93 |  2.183 |       2,894.99 |    0.8% |      1.10 | `HaveInputsOnDisk`\r\n\r\n|               ns/tx |                tx/s |    err% |          ins/tx |          cyc/tx |    IPC |         bra/tx |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|            2,148.36 |          465,471.81 |    0.1% |       16,873.92 |        7,709.74 |  2.189 |       2,894.98 |    0.8% |      1.10 | `HaveInputsOnDisk`\r\n\r\n|               ns/tx |                tx/s |    err% |          ins/tx |          cyc/tx |    IPC |         bra/tx |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|            2,150.10 |          465,095.33 |    0.1% |       16,873.85 |        7,718.44 |  2.186 |       2,894.99 |    0.8% |      1.10 | `HaveInputsOnDisk`\r\n\r\n|               ns/tx |                tx/s |    err% |          ins/tx |          cyc/tx |    IPC |         bra/tx |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|            2,135.95 |          468,175.11 |    0.0% |       16,874.21 |        7,669.12 |  2.200 |       2,894.99 |    0.8% |      1.10 | `HaveInputsOnDisk`\r\n\r\n> 8c56850044 coins: replace remaining `HaveCoin` calls with `GetCoin()`/`AccessCoin` and remove the former\r\n\r\n|               ns/tx |                tx/s |    err% |          ins/tx |          cyc/tx |    IPC |         bra/tx |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|            2,120.50 |          471,586.34 |    0.0% |       16,874.75 |        7,611.58 |  2.217 |       2,897.27 |    0.8% |      1.10 | `HaveInputsOnDisk`\r\n\r\n|               ns/tx |                tx/s |    err% |          ins/tx |          cyc/tx |    IPC |         bra/tx |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|            2,178.86 |          458,955.50 |    0.5% |       16,875.34 |        7,821.05 |  2.158 |       2,897.29 |    1.0% |      1.08 | `HaveInputsOnDisk`\r\n\r\n|               ns/tx |                tx/s |    err% |          ins/tx |          cyc/tx |    IPC |         bra/tx |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|            2,153.54 |          464,352.06 |    0.0% |       16,875.12 |        7,731.71 |  2.183 |       2,897.26 |    0.8% |      1.10 | `HaveInputsOnDisk`\r\n\r\n|               ns/tx |                tx/s |    err% |          ins/tx |          cyc/tx |    IPC |         bra/tx |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|            2,137.40 |          467,857.52 |    0.0% |       16,875.16 |        7,673.32 |  2.199 |       2,897.26 |    0.8% |      1.10 | `HaveInputsOnDisk`\r\n\r\n|               ns/tx |                tx/s |    err% |          ins/tx |          cyc/tx |    IPC |         bra/tx |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|            2,135.08 |          468,365.96 |    0.0% |       16,875.23 |        7,663.44 |  2.202 |       2,897.27 |    0.8% |      1.11 | `HaveInputsOnDisk`\r\n\r\n</details>",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#issuecomment-3796835980",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34320"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22274900599,
      "node_id": "HRFPE_lADOABII587j2bERzwAAAAUvsAJ3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22274900599",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "8c568500442144fbcd457eccda5a1956aa98ca81",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/8c568500442144fbcd457eccda5a1956aa98ca81",
      "created_at": "2026-01-25T15:28:30Z"
    },
    {
      "event": "commented",
      "id": 3815084392,
      "node_id": "IC_kwDOABII587jZZFo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3815084392",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-29T02:37:26Z",
      "updated_at": "2026-01-29T02:37:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "> If we want to avoid the extra copy, we can use AccessCoin, but we would duplicate the spentness check.\r\n\r\nThis tells us that `HaveCoin` is the right level of abstraction then, and is a useful method, no?\r\n\r\n> In this case not caching the value makes sense.\r\n>>But there's nothing to cache since these will return an empty optional\r\n\r\nSame as above.\r\n\r\n> We can use AccessCoin here and with explicit IsSpent call instead which would avoid the call (according to the assembly)\r\n\r\nI think everywhere we use AccessCoin we assert the unspentness. This would now break that pattern and use AccessCoin to check existence via spentness. I think HaveCoin conveys intent better here.\r\n\r\nCan we instead just remove HaveCoin on the db then, and the default implementation would just forward to `!!GetCoin` for it?",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#issuecomment-3815084392",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34320"
    },
    {
      "event": "renamed",
      "id": 22443808251,
      "node_id": "RTE_lADOABII587j2bERzwAAAAU5wVX7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22443808251",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-01T13:34:35Z",
      "rename": {
        "from": "coins: replace remaining `HaveCoin` calls with `GetCoin`",
        "to": "coins: remove redundant and confusing `CCoinsViewDB::HaveCoin`"
      }
    },
    {
      "event": "commented",
      "id": 3831067474,
      "node_id": "IC_kwDOABII587kWXNS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3831067474",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-01T13:38:06Z",
      "updated_at": "2026-02-01T13:38:06Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks @andrewtoth, I didn't like the suggestion at first since we keep polluting the interface, but after applying your suggestion I'm fine with the results, it's simpler and better separated from the other similar PRs.",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#issuecomment-3831067474",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34320"
    },
    {
      "event": "mentioned",
      "id": 22443845821,
      "node_id": "MEE_lADOABII587j2bERzwAAAAU5wei9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22443845821",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-01T13:38:07Z"
    },
    {
      "event": "subscribed",
      "id": 22443845861,
      "node_id": "SE_lADOABII587j2bERzwAAAAU5wejl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22443845861",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-01T13:38:07Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22443860285,
      "node_id": "HRFPE_lADOABII587j2bERzwAAAAU5wiE9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22443860285",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "67068eea16002e533d62481ffe1fc705ef80353e",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/67068eea16002e533d62481ffe1fc705ef80353e",
      "created_at": "2026-02-01T13:39:28Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22443882119,
      "node_id": "HRFPE_lADOABII587j2bERzwAAAAU5wnaH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22443882119",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "3d25cbf3c805752220de79acd281064725254613",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/3d25cbf3c805752220de79acd281064725254613",
      "created_at": "2026-02-01T13:42:14Z"
    },
    {
      "event": "labeled",
      "id": 22443884792,
      "node_id": "LE_lADOABII587j2bERzwAAAAU5woD4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22443884792",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-01T13:42:42Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22443886528,
      "node_id": "HRFPE_lADOABII587j2bERzwAAAAU5wofA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22443886528",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "4166ee8f0175a440f461320165ce8cea9207c22e",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/4166ee8f0175a440f461320165ce8cea9207c22e",
      "created_at": "2026-02-01T13:43:00Z"
    },
    {
      "event": "unlabeled",
      "id": 22444328375,
      "node_id": "UNLE_lADOABII587j2bERzwAAAAU5yUW3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22444328375",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-01T14:43:42Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3736369272,
      "node_id": "PRR_kwDOABII587etHh4",
      "url": null,
      "actor": null,
      "commit_id": "4166ee8f0175a440f461320165ce8cea9207c22e",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-01T18:24:44Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#pullrequestreview-3736369272",
      "submitted_at": "2026-02-01T18:24:44Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22449412556,
      "node_id": "HRFPE_lADOABII587j2bERzwAAAAU6FtnM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22449412556",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "23dd085872bc0f01309260e00cce239a9512b45e",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/23dd085872bc0f01309260e00cce239a9512b45e",
      "created_at": "2026-02-01T22:19:55Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22504855541,
      "node_id": "HRFPE_lADOABII587j2bERzwAAAAU9ZNf1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22504855541",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "69fa15aaad06abf7af2d24e76eeb8f417cd66a37",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/69fa15aaad06abf7af2d24e76eeb8f417cd66a37",
      "created_at": "2026-02-03T17:56:52Z"
    },
    {
      "event": "labeled",
      "id": 22506254385,
      "node_id": "LE_lADOABII587j2bERzwAAAAU9ejAx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22506254385",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T18:55:14Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3843080702,
      "node_id": "IC_kwDOABII587lEMH-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3843080702",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T18:55:22Z",
      "updated_at": "2026-02-03T18:55:22Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/actions/runs/21641577498/job/62382439018</sub>\n<sub>LLM reason (âœ¨ experimental): Lint check failed: direct use of std::filesystem was flagged by the std_filesystem lint rule.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#issuecomment-3843080702",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34320"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22507532843,
      "node_id": "HRFPE_lADOABII587j2bERzwAAAAU9jbIr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22507532843",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/d957b36ab55633f51fe38f97409c184ef632a5b2",
      "created_at": "2026-02-03T19:49:48Z"
    },
    {
      "event": "unlabeled",
      "id": 22509260910,
      "node_id": "UNLE_lADOABII587j2bERzwAAAAU9qBBu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22509260910",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T20:57:52Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3748424271,
      "node_id": "PRR_kwDOABII587fbGpP",
      "url": null,
      "actor": null,
      "commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-04T01:06:32Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#pullrequestreview-3748424271",
      "submitted_at": "2026-02-04T01:06:32Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
    },
    {
      "event": "reviewed",
      "id": 3749394865,
      "node_id": "PRR_kwDOABII587fezmx",
      "url": null,
      "actor": null,
      "commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-04T07:18:10Z",
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#pullrequestreview-3749394865",
      "submitted_at": "2026-02-04T07:18:10Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22521404634,
      "node_id": "HRFPE_lADOABII587j2bERzwAAAAU-YVza",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22521404634",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "15223505a7a0475d751c3ebf22d7e06995ee5d7a",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/15223505a7a0475d751c3ebf22d7e06995ee5d7a",
      "created_at": "2026-02-04T08:25:29Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22521434317,
      "node_id": "HRFPE_lADOABII587j2bERzwAAAAU-YdDN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22521434317",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "d1a8a1bc5692e1b38932f3bef36da8500614e569",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/d1a8a1bc5692e1b38932f3bef36da8500614e569",
      "created_at": "2026-02-04T08:26:53Z"
    },
    {
      "event": "labeled",
      "id": 22521449475,
      "node_id": "LE_lADOABII587j2bERzwAAAAU-YgwD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22521449475",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T08:27:36Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 22522865338,
      "node_id": "UNLE_lADOABII587j2bERzwAAAAU-d6a6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22522865338",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T09:26:25Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3802394912,
      "node_id": "PRR_kwDOABII587io_Eg",
      "url": null,
      "actor": null,
      "commit_id": "d1a8a1bc5692e1b38932f3bef36da8500614e569",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-14T19:47:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK d1a8a1bc5692e1b38932f3bef36da8500614e569\n\n`CCoinsViewDB::HaveCoin` is dead code, good to remove it and prevent confusion.\nAlso, adding test coverage and a benchmark to prevent regressions is good.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#pullrequestreview-3802394912",
      "submitted_at": "2026-02-14T19:47:33Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22808909208,
      "node_id": "HRFPE_lADOABII587j2bERzwAAAAVPhFWY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22808909208",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "e4613ee137e3bfbc00c749b2608f567b96523e13",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/e4613ee137e3bfbc00c749b2608f567b96523e13",
      "created_at": "2026-02-15T20:56:36Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22808970976,
      "node_id": "HRFPE_lADOABII587j2bERzwAAAAVPhUbg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22808970976",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "ff338fdb53a66ab40a36e1277e7371941fc89840",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/ff338fdb53a66ab40a36e1277e7371941fc89840",
      "created_at": "2026-02-15T21:03:00Z"
    },
    {
      "event": "labeled",
      "id": 22808976344,
      "node_id": "LE_lADOABII587j2bERzwAAAAVPhVvY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22808976344",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-15T21:03:30Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 22809625216,
      "node_id": "UNLE_lADOABII587j2bERzwAAAAVPj0KA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22809625216",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-15T22:26:17Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3831369297,
      "node_id": "PRR_kwDOABII587kXg5R",
      "url": null,
      "actor": null,
      "commit_id": "ff338fdb53a66ab40a36e1277e7371941fc89840",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-20T11:29:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK https://github.com/bitcoin/bitcoin/pull/34320/commits/ff338fdb53a66ab40a36e1277e7371941fc89840:\r\n\r\nLeft some comments.",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#pullrequestreview-3831369297",
      "submitted_at": "2026-02-20T11:29:26Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDEzOWFhNGIyN2U0ODM5MjkxYzgzYTA0ZGNkMTY0OWM1NTk1ODE0Y2E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/139aa4b27e4839291c83a04dcd1649c5595814ca",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/139aa4b27e4839291c83a04dcd1649c5595814ca",
      "tree": {
        "sha": "7dedd598680e1ef26333960e40da35d3c70c5640",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7dedd598680e1ef26333960e40da35d3c70c5640"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 7dedd598680e1ef26333960e40da35d3c70c5640\nparent a2fd558760abdbc41dd8b451cc4e6727cbc05cb9\nauthor LÅ‘rinc <pap.lorinc@gmail.com> 1769349649 +0100\ncommitter LÅ‘rinc <pap.lorinc@gmail.com> 1771601738 +0100\n\nbench: add on-disk `HaveInputs` benchmark\n\n`CCoinsViewCache::HaveInputs()` is used by `Consensus::CheckTxInputs()` and currently exercises the `HaveCoin()` path in the UTXO cache.\nPerformance could be affected due to `Coin` copying and different cache warming behavior.\n\nAdd a benchmark to track `HaveInputs()` throughput before and after the `HaveCoin()` changes in this series to make sure the performance is retained.\nThe benchmark populates an on-disk `CCoinsViewDB` with dummy unspent coins for all block inputs and then calls `HaveInputs()` for each non-coinbase transaction using a fresh `CCoinsViewCache` (to avoid cross-iteration caching).\nIt calls `HaveInputs()` twice to exercise the cache-hit path as well.\n\nBenchmark baseline:\n|               ns/tx |                tx/s |    err% |     total | benchmark\n|--------------------:|--------------------:|--------:|----------:|:----------\n|            1,004.58 |          995,437.07 |    0.7% |      1.10 | `HaveInputsOnDisk`\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEqXy8dDLWkKQdUrTAZp//D/pHenYFAmmYf0oACgkQZp//D/pH\nenbjBA/+If0hpmvFRAY9vDk0WK6mLeLejjhgfwvrJY6GmCIO/HO2GALofYYlC556\nMAE1lfOqUJe70ytu1s/nvnCLw42SjhTUy17JHo202EsBfm2/VheM7Pii4yv8OUmD\nGEusvLojFY9PSthZq7+loADnlyNzxuFLdj5bIKwxfS6vh0zpyTwzh1xwpZnywN3O\nVfyGtlj0fQD0w792ZWrxwewrmSyF+NS/+T98pxrC5u4Od4+XCcNbTxbd4kOHIT2j\ncUsSJuwmeqc5t7bfEbWDeGEaziTR6zdra58Ld7qMuEwuGfrtFtINhen4hyrD7DCN\nS4XCzyRhG9VgbUwJwY+R8zSCuthMcJYesM19yy+RWpUQxR3FGnK0QVD3Fn5qMLtE\nRKZxXLt8xyJbTq/2Wv4uArgo68mtrOSE9HzzVkqpmskzE26VNqppczf4qkn+mWhT\nXqskj2mZrpZ8cKR6iSfWXLyZ/iBZo7PlTzvIvktp2qItT44O6VkxTUrCwPRjL6he\nrgWMNV1sVuw2eE4mJCIPwD6PBnz03L7NTlyAYvRJDHTEG36ZB6tE/ML5vZtReZVI\nb0dytxQF2262IXYj5VW1j7u1qT12jgtEkdIZ/QBLmUWCIYmPxWRI3XSd+TSHU3Wr\n+FbExI1pjlWISGrOTj3jylUIm8MPzr0krLv2nbUrOkvch7AOqyA=\n=pL4M\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a2fd558760abdbc41dd8b451cc4e6727cbc05cb9",
          "sha": "a2fd558760abdbc41dd8b451cc4e6727cbc05cb9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a2fd558760abdbc41dd8b451cc4e6727cbc05cb9"
        }
      ],
      "message": "bench: add on-disk `HaveInputs` benchmark\n\n`CCoinsViewCache::HaveInputs()` is used by `Consensus::CheckTxInputs()` and currently exercises the `HaveCoin()` path in the UTXO cache.\nPerformance could be affected due to `Coin` copying and different cache warming behavior.\n\nAdd a benchmark to track `HaveInputs()` throughput before and after the `HaveCoin()` changes in this series to make sure the performance is retained.\nThe benchmark populates an on-disk `CCoinsViewDB` with dummy unspent coins for all block inputs and then calls `HaveInputs()` for each non-coinbase transaction using a fresh `CCoinsViewCache` (to avoid cross-iteration caching).\nIt calls `HaveInputs()` twice to exercise the cache-hit path as well.\n\nBenchmark baseline:\n|               ns/tx |                tx/s |    err% |     total | benchmark\n|--------------------:|--------------------:|--------:|----------:|:----------\n|            1,004.58 |          995,437.07 |    0.7% |      1.10 | `HaveInputsOnDisk`",
      "committer": {
        "name": "LÅ‘rinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2026-02-20T15:35:38Z"
      },
      "author": {
        "name": "LÅ‘rinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2026-01-25T14:00:49Z"
      },
      "sha": "139aa4b27e4839291c83a04dcd1649c5595814ca"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDI3N2M1N2YwYzU5MDBmYjhiYzYzNmNlNzYzMjQ1MmIyNDVkMjk2YzQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/277c57f0c5900fb8bc636ce7632452b245d296c4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/277c57f0c5900fb8bc636ce7632452b245d296c4",
      "tree": {
        "sha": "9a9416222d858206a126c181213992ff606b9430",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9a9416222d858206a126c181213992ff606b9430"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 9a9416222d858206a126c181213992ff606b9430\nparent 139aa4b27e4839291c83a04dcd1649c5595814ca\nauthor LÅ‘rinc <pap.lorinc@gmail.com> 1768430604 +0100\ncommitter LÅ‘rinc <pap.lorinc@gmail.com> 1771602757 +0100\n\ntest: add `HaveInputs` call-path unit tests\n\nAdd unit tests covering `CCoinsViewCache::HaveInputs()`.\n\nThe tests document that `HaveInputs()` consults the cache first and that a cache miss pulls from the backing view via `GetCoin()`.\n\nCo-authored-by: Novo <eunovo9@gmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEqXy8dDLWkKQdUrTAZp//D/pHenYFAmmYg0UACgkQZp//D/pH\nenZGpBAAr6Y01BVJ/raPJwgfjyCzZ5vmGcWh6ryxo71CjYS6XFCf291ptcr1dwkg\n0AVvIPb3pCVR+R1S00eKals2bjfRadyW2wMxqtkVmWoPX0ynW4ec+ENTeiiUsfaz\nT5kTcXEWqoLlYyy7xNd97TA0n2MowEvmxKsunaLyrz/LzfhF2OhsgxYqyz4noEbc\nnBNZgpuZFSfl1bc1MYz1KNnOkXChwlhgLdNK3mh5Kr7dfskamhdUAq05OO9+7Jbe\npbCWug2ivmDRfqBA6aKp/foAyrvJFG9HZyCQst39XjqB/wFbQjb9Klk6et+4vy7a\nTyPBMaPjP5M58niHbsubwKKxP4fjBgmDS+V70AnknOtaTs6DLrCzxntGxmyzWwIH\nCvGW1Jf7MuUZH1NNA/6+CEiHz/hyxe8DhxXEWlt24aXKacU38qIdw3H8/UjyvMla\nYRbAAXDYLoUFsnbAv0f2QYvZxrExYRbL9bDVO0gS1AUQXdl20xEEl4cuVU/JlpPI\nRreInJPt0qspyjaljdDtiMMpbYIQ5K1nzqHUEDBxEa0lZU5l9KRvn+Fp03Q9mbvw\npagK12U9ehYx4A0BW8vR0DT7EHCbZED4wAK0jg0ApkRyPD8gB7VH6cvRNyn3qe7/\ngMgFR8GhJGIsMTZ5IxiseU6gMsD4Debd+nq3h6aePVTojKomzwI=\n=/c1c\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/139aa4b27e4839291c83a04dcd1649c5595814ca",
          "sha": "139aa4b27e4839291c83a04dcd1649c5595814ca",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/139aa4b27e4839291c83a04dcd1649c5595814ca"
        }
      ],
      "message": "test: add `HaveInputs` call-path unit tests\n\nAdd unit tests covering `CCoinsViewCache::HaveInputs()`.\n\nThe tests document that `HaveInputs()` consults the cache first and that a cache miss pulls from the backing view via `GetCoin()`.\n\nCo-authored-by: Novo <eunovo9@gmail.com>",
      "committer": {
        "name": "LÅ‘rinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2026-02-20T15:52:37Z"
      },
      "author": {
        "name": "LÅ‘rinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2026-01-14T22:43:24Z"
      },
      "sha": "277c57f0c5900fb8bc636ce7632452b245d296c4"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGMwYzk0ZWM5ODYwYWMxMjFlMzQyZTZjMjEwMmZmYWYzMDYzMGMyNDQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c0c94ec9860ac121e342e6c2102ffaf30630c244",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c0c94ec9860ac121e342e6c2102ffaf30630c244",
      "tree": {
        "sha": "cbe04f1202f8cf8671de8e91c7f5e3195a4c9172",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cbe04f1202f8cf8671de8e91c7f5e3195a4c9172"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree cbe04f1202f8cf8671de8e91c7f5e3195a4c9172\nparent 277c57f0c5900fb8bc636ce7632452b245d296c4\nauthor LÅ‘rinc <pap.lorinc@gmail.com> 1768430928 +0100\ncommitter LÅ‘rinc <pap.lorinc@gmail.com> 1771602986 +0100\n\ndbwrapper: have `Read` and `Exists` reuse `ReadRaw`\n\n`ExistsImpl` was removed since it duplicates `CDBWrapper::ReadImpl`.\nThe only difference is that `ExistsImpl` discards the value while `ReadImpl` returns it as `std::string`.\nIn this series, `HaveCoin` database lookups go through `GetCoin`/`Read`, and successful reads are cached in `CCoinsViewCache`, so this copy is not a separate recurring cost.\n`CDBWrapper::Exists()` and `::ReadRaw()` both issue a LevelDB `::Get`.\n\nIntroduce a small helper returning the raw value bytes (as `std::string`) for a given key.\nMove `Exists` closer to the read methods.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEqXy8dDLWkKQdUrTAZp//D/pHenYFAmmYhCsACgkQZp//D/pH\nenY9oxAAzCywhplhXCvb59Ji5ezvOLY1uCJ8OdA8OMq/bELXuxhp/FjoHRK1KxZT\nmmXjRvXXpZxQsSfpIEfK+uIMNyZpcCRiyTiPdN43jEl9nHB4QAcw8DJbCWnu4zpZ\nUKVZW3oKiD5ubRR9Z6mn6lP18CwvMmzj+0E1+hB2Br/ns1Bvx4Uv8vkZMwdwsOgp\nYEPqQIiGCjHQKQkhpHQZ7OKfaiq2OtRxtcF8Nh/PmsXAbpg8WTNBbCHG71FKdIAY\nvDhFFfH1M0BuDoELkp5ZgK/eq1dvsA8p66WMhNjrVbPEOaZY1rWBzYu5OBm/Fd5s\n8V6QBpsUj3OVzxUhDGvpccysx8xdpqHH3eWm8qgop3VNizSFl8jnBQ1tGrMhBCXA\nBrtcw21Kh/5Ybx/8R/UMjqumFY6unwA/Ci37eUS4xItTeTTxdeT7jKmnF6Ug+sKw\nuud8KDbpy3FlcDt80kBDm8+IokQ9MljQ7PdQzNpOwPNN0TTMKPPSAPmU6JqqJ/df\nz4G6NK4uO7fnQF804KHfGOJHie8MaCjHBu+RKHqjxneuej+jsjRilHIeclUs7hHn\nVgtLXY99kEx7NWWDlYk7/TS/PuhLuXh0QC9NqVWd3GxQPcJwR0T7xGzjzXPWtmjM\n80gIxcS5o8RjE+SOaeSXNhVNZt01DTFeEYGdBcl/AencVwcjdrc=\n=uf6t\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/277c57f0c5900fb8bc636ce7632452b245d296c4",
          "sha": "277c57f0c5900fb8bc636ce7632452b245d296c4",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/277c57f0c5900fb8bc636ce7632452b245d296c4"
        }
      ],
      "message": "dbwrapper: have `Read` and `Exists` reuse `ReadRaw`\n\n`ExistsImpl` was removed since it duplicates `CDBWrapper::ReadImpl`.\nThe only difference is that `ExistsImpl` discards the value while `ReadImpl` returns it as `std::string`.\nIn this series, `HaveCoin` database lookups go through `GetCoin`/`Read`, and successful reads are cached in `CCoinsViewCache`, so this copy is not a separate recurring cost.\n`CDBWrapper::Exists()` and `::ReadRaw()` both issue a LevelDB `::Get`.\n\nIntroduce a small helper returning the raw value bytes (as `std::string`) for a given key.\nMove `Exists` closer to the read methods.",
      "committer": {
        "name": "LÅ‘rinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2026-02-20T15:56:26Z"
      },
      "author": {
        "name": "LÅ‘rinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2026-01-14T22:48:48Z"
      },
      "sha": "c0c94ec9860ac121e342e6c2102ffaf30630c244"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGRkNzYzMzhhNTdiOWIxMTY5YWMyN2Y3Yjc4M2Q2ZDBkNGM2ZTM4YWI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dd76338a57b9b1169ac27f7b783d6d0d4c6e38ab",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/dd76338a57b9b1169ac27f7b783d6d0d4c6e38ab",
      "tree": {
        "sha": "37c21c6ae73d5e6558adcf1f31d7f0a7830ae61e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/37c21c6ae73d5e6558adcf1f31d7f0a7830ae61e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 37c21c6ae73d5e6558adcf1f31d7f0a7830ae61e\nparent c0c94ec9860ac121e342e6c2102ffaf30630c244\nauthor LÅ‘rinc <pap.lorinc@gmail.com> 1769950968 +0100\ncommitter LÅ‘rinc <pap.lorinc@gmail.com> 1771602987 +0100\n\ncoins: simplify `HaveCoin` usages\n\nDirect `CCoinsViewDB::HaveCoin` calls aren't called in production anyway, so let's just revert to delegating to `::GetCoin`.\n\nBenchmark at this commit:\n|               ns/tx |                tx/s |    err% |     total | benchmark\n|--------------------:|--------------------:|--------:|----------:|:----------\n|              995.62 |        1,004,398.82 |    0.9% |      1.10 | `HaveInputsOnDisk`\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEqXy8dDLWkKQdUrTAZp//D/pHenYFAmmYhCsACgkQZp//D/pH\nenZxeRAAgi4eV+LSiGugicTjva1leKHcvIKeUtRlVwLkC82CaPYGYr81Veaslq0H\nzNqf7R8YNtjsshUQBNElT1zDm6kFzJ5ZVO7O9G4StxqbAo5ltzs+SBnleNaq/zkN\nZCafv8i9i1Yo0axU2rY1d51WXj1MRSQXgbKsE8SsRFoHohBOmItaswo/kYhbGrSZ\n7YxsfyFg1/MGsNdsEAsO3jPbyzmf0/i4rsGEJdKxLib43gYCinaMO79gNbubm8x5\nMYJDqkYnhFE0eEmuavOgzV4rUQSMrROlaiaTW6z17fYUFJuVXz1dHv9P+olwrto3\n0eeVnAtsfGYjp5pRnr2iXDhtSlplvzhFQWbNk5KN5bnCLQL/dReTi0eR1sgtavHK\nHhYYwfVQk5+UK7paqy5+NHovB8tgYgwTRco8H/cZv1flyob/7QviF2xM6kJ8PETr\nMYVHbYYk23eI6PXTym7jW6CcRpmWuK3qu1We4OPeKis0XUjlFWKIjAACzs9a75Us\n0DvH9NcVTUkx3kCZ4pY6QNP52XsQWQqtpoGn4KLQaitcGtv43BfExfIHbwTxfTG/\nuHy8HxnOjwr57A2HygRnu1bKRsMUZQg6JNJr7Xp63K7JZwIM+eYzmsoOWfShpgcy\nZR9csvPsjFzNvh/GaCC5ky0mf+cdXkfmvs6MV1mF8n6EdI6fECw=\n=yBtR\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c0c94ec9860ac121e342e6c2102ffaf30630c244",
          "sha": "c0c94ec9860ac121e342e6c2102ffaf30630c244",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c0c94ec9860ac121e342e6c2102ffaf30630c244"
        }
      ],
      "message": "coins: simplify `HaveCoin` usages\n\nDirect `CCoinsViewDB::HaveCoin` calls aren't called in production anyway, so let's just revert to delegating to `::GetCoin`.\n\nBenchmark at this commit:\n|               ns/tx |                tx/s |    err% |     total | benchmark\n|--------------------:|--------------------:|--------:|----------:|:----------\n|              995.62 |        1,004,398.82 |    0.9% |      1.10 | `HaveInputsOnDisk`",
      "committer": {
        "name": "LÅ‘rinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2026-02-20T15:56:27Z"
      },
      "author": {
        "name": "LÅ‘rinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2026-02-01T13:02:48Z"
      },
      "sha": "dd76338a57b9b1169ac27f7b783d6d0d4c6e38ab"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22952778160,
      "node_id": "HRFPE_lADOABII587j2bERzwAAAAVYF5mw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22952778160",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "dd76338a57b9b1169ac27f7b783d6d0d4c6e38ab",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/dd76338a57b9b1169ac27f7b783d6d0d4c6e38ab",
      "created_at": "2026-02-20T15:56:41Z"
    },
    {
      "event": "labeled",
      "id": 22954767689,
      "node_id": "LE_lADOABII587j2bERzwAAAAVYNfVJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22954767689",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-20T17:14:59Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "closed",
      "id": 22956163895,
      "node_id": "CE_lADOABII587j2bERzwAAAAVYS0M3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22956163895",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-20T18:15:45Z"
    },
    {
      "event": "reopened",
      "id": 22956165338,
      "node_id": "REE_lADOABII587j2bERzwAAAAVYS0ja",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22956165338",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-20T18:15:48Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2751741957",
      "pull_request_review_id": 3736369272,
      "id": 2751741957,
      "node_id": "PRRC_kwDOABII586kBEAF",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const fs::path path{fs::current_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "23dd085872bc0f01309260e00cce239a9512b45e",
      "original_commit_id": "267af2c925618bf502adb6412ca34cba016f5cdd",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "We should use `std::filesystem::temp_directory_path()` instead of current path, and then we don't have to cleanup.",
      "created_at": "2026-02-01T18:08:26Z",
      "updated_at": "2026-02-01T18:24:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2751741957",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2751741957"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2751755475",
      "pull_request_review_id": 3736369272,
      "id": 2751755475,
      "node_id": "PRRC_kwDOABII586kBHTT",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const fs::path path{fs::current_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};\n+    CCoinsViewDB db{{.path = path, .cache_bytes = 1_MiB, .memory_only = false, .wipe_data = true}, {}};\n+\n+    CBlock block;\n+    DataStream{benchmark::data::block413567} >> TX_WITH_WITNESS(block);\n+\n+    CCoinsViewCache cache{&db};\n+    cache.SetBestBlock(uint256::ONE);\n+    for (auto& tx : block.vtx | std::views::drop(1)) {\n+        for (auto& txin : tx->vin) {\n+            cache.AddCoin(txin.prevout, {{COIN, CScript()}, /*nHeightIn=*/1, /*fCoinBaseIn=*/false}, /*possible_overwrite=*/false);\n+        }\n+    }\n+    cache.Flush();\n+\n+    bench.batch(block.vtx.size() - 1).unit(\"tx\").run([&] {\n+        CCoinsViewCache view{&db}; // Recreate to avoid caching\n+        for (auto& tx : block.vtx | std::views::drop(1)) {\n+            if (view.GetCacheSize() % 10 == 0) (void)view.HaveInputs(*tx); // Exercise the cache-hit path as well.",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 40,
      "commit_id": "23dd085872bc0f01309260e00cce239a9512b45e",
      "original_commit_id": "267af2c925618bf502adb6412ca34cba016f5cdd",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Why only every 10th iteration? Why not just do it every time?",
      "created_at": "2026-02-01T18:13:05Z",
      "updated_at": "2026-02-01T18:24:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2751755475",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2751755475"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 40,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2751764873",
      "pull_request_review_id": 3736369272,
      "id": 2751764873,
      "node_id": "PRRC_kwDOABII586kBJmJ",
      "diff_hunk": "@@ -1059,6 +1061,86 @@ BOOST_FIXTURE_TEST_CASE(ccoins_flush_behavior, FlushTest)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(ccoins_haveinputs_uses_base_getcoin)\n+{\n+    const COutPoint prevout{Txid::FromUint256(m_rng.rand256()), 0};\n+\n+    CCoinsViewDB db{{.path = \"test\", .cache_bytes = 1_MiB, .memory_only = true}, {}};\n+    {\n+        CCoinsViewCache write_cache{&db};\n+        write_cache.SetBestBlock(m_rng.rand256());\n+        write_cache.AddCoin(prevout, MakeTestCoin(), /*possible_overwrite=*/false);\n+        write_cache.Flush();\n+    }\n+\n+    class CCoinsViewSpy final : public CCoinsViewBacked\n+    {\n+    public:\n+        const COutPoint expected;\n+        mutable size_t havecoin_calls{0}, getcoin_calls{0};\n+\n+        explicit CCoinsViewSpy(CCoinsView* view, COutPoint out) : CCoinsViewBacked(view), expected{std::move(out)} {}",
      "path": "src/test/coins_tests.cpp",
      "position": 1,
      "original_position": 31,
      "commit_id": "6f533a0f3c29446b42797c08a537de743bbb226f",
      "original_commit_id": "6f533a0f3c29446b42797c08a537de743bbb226f",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "There's nothing to move for a `COutPoint`. Some code does that erroneously, but we should not.",
      "created_at": "2026-02-01T18:16:31Z",
      "updated_at": "2026-02-01T18:24:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2751764873",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2751764873"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1082,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2751766997",
      "pull_request_review_id": 3736369272,
      "id": 2751766997,
      "node_id": "PRRC_kwDOABII586kBKHV",
      "diff_hunk": "@@ -1059,6 +1061,86 @@ BOOST_FIXTURE_TEST_CASE(ccoins_flush_behavior, FlushTest)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(ccoins_haveinputs_uses_base_getcoin)\n+{\n+    const COutPoint prevout{Txid::FromUint256(m_rng.rand256()), 0};\n+\n+    CCoinsViewDB db{{.path = \"test\", .cache_bytes = 1_MiB, .memory_only = true}, {}};\n+    {\n+        CCoinsViewCache write_cache{&db};\n+        write_cache.SetBestBlock(m_rng.rand256());\n+        write_cache.AddCoin(prevout, MakeTestCoin(), /*possible_overwrite=*/false);\n+        write_cache.Flush();\n+    }\n+\n+    class CCoinsViewSpy final : public CCoinsViewBacked\n+    {\n+    public:\n+        const COutPoint expected;\n+        mutable size_t havecoin_calls{0}, getcoin_calls{0};\n+\n+        explicit CCoinsViewSpy(CCoinsView* view, COutPoint out) : CCoinsViewBacked(view), expected{std::move(out)} {}\n+\n+        std::optional<Coin> GetCoin(const COutPoint& out) const override\n+        {\n+            ++getcoin_calls;\n+            BOOST_CHECK(out == expected);",
      "path": "src/test/coins_tests.cpp",
      "position": 17,
      "original_position": 36,
      "commit_id": "dd76338a57b9b1169ac27f7b783d6d0d4c6e38ab",
      "original_commit_id": "6f533a0f3c29446b42797c08a537de743bbb226f",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: `BOOST_CHECK_EQUAL(out, expected);`",
      "created_at": "2026-02-01T18:17:26Z",
      "updated_at": "2026-02-01T18:24:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2751766997",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2751766997"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1075,
      "original_line": 1087,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2751767358",
      "pull_request_review_id": 3736369272,
      "id": 2751767358,
      "node_id": "PRRC_kwDOABII586kBKM-",
      "diff_hunk": "@@ -1059,6 +1061,86 @@ BOOST_FIXTURE_TEST_CASE(ccoins_flush_behavior, FlushTest)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(ccoins_haveinputs_uses_base_getcoin)\n+{\n+    const COutPoint prevout{Txid::FromUint256(m_rng.rand256()), 0};\n+\n+    CCoinsViewDB db{{.path = \"test\", .cache_bytes = 1_MiB, .memory_only = true}, {}};\n+    {\n+        CCoinsViewCache write_cache{&db};\n+        write_cache.SetBestBlock(m_rng.rand256());\n+        write_cache.AddCoin(prevout, MakeTestCoin(), /*possible_overwrite=*/false);\n+        write_cache.Flush();\n+    }\n+\n+    class CCoinsViewSpy final : public CCoinsViewBacked\n+    {\n+    public:\n+        const COutPoint expected;\n+        mutable size_t havecoin_calls{0}, getcoin_calls{0};\n+\n+        explicit CCoinsViewSpy(CCoinsView* view, COutPoint out) : CCoinsViewBacked(view), expected{std::move(out)} {}\n+\n+        std::optional<Coin> GetCoin(const COutPoint& out) const override\n+        {\n+            ++getcoin_calls;\n+            BOOST_CHECK(out == expected);\n+            return CCoinsViewBacked::GetCoin(out);\n+        }\n+\n+        bool HaveCoin(const COutPoint& out) const override\n+        {\n+            ++havecoin_calls;\n+            BOOST_CHECK(out == expected);",
      "path": "src/test/coins_tests.cpp",
      "position": 28,
      "original_position": 43,
      "commit_id": "dd76338a57b9b1169ac27f7b783d6d0d4c6e38ab",
      "original_commit_id": "6f533a0f3c29446b42797c08a537de743bbb226f",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Same as above.",
      "created_at": "2026-02-01T18:17:36Z",
      "updated_at": "2026-02-01T18:24:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2751767358",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2751767358"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1086,
      "original_line": 1094,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2751783265",
      "pull_request_review_id": 3736369272,
      "id": 2751783265,
      "node_id": "PRRC_kwDOABII586kBOFh",
      "diff_hunk": "@@ -167,12 +167,13 @@ const Coin& CCoinsViewCache::AccessCoin(const COutPoint &outpoint) const {\n     }\n }\n \n-bool CCoinsViewCache::HaveCoin(const COutPoint &outpoint) const {\n-    CCoinsMap::const_iterator it = FetchCoin(outpoint);\n-    return (it != cacheCoins.end() && !it->second.coin.IsSpent());\n+bool CCoinsViewCache::HaveCoin(const COutPoint& outpoint) const\n+{\n+    return !AccessCoin(outpoint).IsSpent();",
      "path": "src/coins.cpp",
      "position": 1,
      "original_position": 9,
      "commit_id": "23dd085872bc0f01309260e00cce239a9512b45e",
      "original_commit_id": "4166ee8f0175a440f461320165ce8cea9207c22e",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'm not sure why we are touching this.\nThis does an extra `IsSpent()` check now on an empty coin, instead of just short circuiting at `it != cacheCoins.end()`.",
      "created_at": "2026-02-01T18:24:13Z",
      "updated_at": "2026-02-01T18:24:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2751783265",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2751783265"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 172,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752025202",
      "pull_request_review_id": 3736717096,
      "id": 2752025202,
      "node_id": "PRRC_kwDOABII586kCJJy",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const fs::path path{fs::current_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "23dd085872bc0f01309260e00cce239a9512b45e",
      "original_commit_id": "267af2c925618bf502adb6412ca34cba016f5cdd",
      "in_reply_to_id": 2751741957,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Wouldn't that store the blocks in memory in [tmpfs](https://en.wikipedia.org/wiki/Tmpfs)?\r\nThough in reality after the first read it will likely be in cache already...",
      "created_at": "2026-02-01T21:59:38Z",
      "updated_at": "2026-02-01T21:59:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2752025202",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752025202"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752025560",
      "pull_request_review_id": 3736717344,
      "id": 2752025560,
      "node_id": "PRRC_kwDOABII586kCJPY",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const fs::path path{fs::current_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};\n+    CCoinsViewDB db{{.path = path, .cache_bytes = 1_MiB, .memory_only = false, .wipe_data = true}, {}};\n+\n+    CBlock block;\n+    DataStream{benchmark::data::block413567} >> TX_WITH_WITNESS(block);\n+\n+    CCoinsViewCache cache{&db};\n+    cache.SetBestBlock(uint256::ONE);\n+    for (auto& tx : block.vtx | std::views::drop(1)) {\n+        for (auto& txin : tx->vin) {\n+            cache.AddCoin(txin.prevout, {{COIN, CScript()}, /*nHeightIn=*/1, /*fCoinBaseIn=*/false}, /*possible_overwrite=*/false);\n+        }\n+    }\n+    cache.Flush();\n+\n+    bench.batch(block.vtx.size() - 1).unit(\"tx\").run([&] {\n+        CCoinsViewCache view{&db}; // Recreate to avoid caching\n+        for (auto& tx : block.vtx | std::views::drop(1)) {\n+            if (view.GetCacheSize() % 10 == 0) (void)view.HaveInputs(*tx); // Exercise the cache-hit path as well.",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 40,
      "commit_id": "23dd085872bc0f01309260e00cce239a9512b45e",
      "original_commit_id": "267af2c925618bf502adb6412ca34cba016f5cdd",
      "in_reply_to_id": 2751755475,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Isn't it more realistic if some of the data comes from cache and some from disk?",
      "created_at": "2026-02-01T22:00:11Z",
      "updated_at": "2026-02-01T22:00:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2752025560",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752025560"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 40,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752035102",
      "pull_request_review_id": 3736725300,
      "id": 2752035102,
      "node_id": "PRRC_kwDOABII586kCLke",
      "diff_hunk": "@@ -1059,6 +1061,86 @@ BOOST_FIXTURE_TEST_CASE(ccoins_flush_behavior, FlushTest)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(ccoins_haveinputs_uses_base_getcoin)\n+{\n+    const COutPoint prevout{Txid::FromUint256(m_rng.rand256()), 0};\n+\n+    CCoinsViewDB db{{.path = \"test\", .cache_bytes = 1_MiB, .memory_only = true}, {}};\n+    {\n+        CCoinsViewCache write_cache{&db};\n+        write_cache.SetBestBlock(m_rng.rand256());\n+        write_cache.AddCoin(prevout, MakeTestCoin(), /*possible_overwrite=*/false);\n+        write_cache.Flush();\n+    }\n+\n+    class CCoinsViewSpy final : public CCoinsViewBacked\n+    {\n+    public:\n+        const COutPoint expected;\n+        mutable size_t havecoin_calls{0}, getcoin_calls{0};\n+\n+        explicit CCoinsViewSpy(CCoinsView* view, COutPoint out) : CCoinsViewBacked(view), expected{std::move(out)} {}\n+\n+        std::optional<Coin> GetCoin(const COutPoint& out) const override\n+        {\n+            ++getcoin_calls;\n+            BOOST_CHECK(out == expected);",
      "path": "src/test/coins_tests.cpp",
      "position": 17,
      "original_position": 36,
      "commit_id": "dd76338a57b9b1169ac27f7b783d6d0d4c6e38ab",
      "original_commit_id": "6f533a0f3c29446b42797c08a537de743bbb226f",
      "in_reply_to_id": 2751766997,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I thought of that, but didn't want to add a new `std::ostream&` for `COutPoint`:\r\n```patch\r\ndiff --git a/src/test/coins_tests.cpp b/src/test/coins_tests.cpp\r\n--- a/src/test/coins_tests.cpp\t(revision 4166ee8f0175a440f461320165ce8cea9207c22e)\r\n+++ b/src/test/coins_tests.cpp\t(date 1769983694317)\r\n@@ -105,6 +105,11 @@\r\n \r\n } // namespace\r\n \r\n+std::ostream& operator<<(std::ostream& os, const COutPoint& outpoint)\r\n+{\r\n+    return os << outpoint.ToString();\r\n+}\r\n+\r\n static const unsigned int NUM_SIMULATION_ITERATIONS = 40000;\r\n \r\n struct CacheTest : BasicTestingSetup {\r\n@@ -1084,14 +1089,14 @@\r\n         std::optional<Coin> GetCoin(const COutPoint& out) const override\r\n         {\r\n             ++getcoin_calls;\r\n-            BOOST_CHECK(out == expected);\r\n+            BOOST_CHECK_EQUAL(out, expected);\r\n             return CCoinsViewBacked::GetCoin(out);\r\n         }\r\n \r\n         bool HaveCoin(const COutPoint& out) const override\r\n         {\r\n             ++havecoin_calls;\r\n-            BOOST_CHECK(out == expected);\r\n+            BOOST_CHECK_EQUAL(out, expected);\r\n             return CCoinsViewBacked::HaveCoin(out);\r\n         }\r\n     };\r\n```",
      "created_at": "2026-02-01T22:10:05Z",
      "updated_at": "2026-02-01T22:10:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2752035102",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752035102"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1075,
      "original_line": 1087,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752035193",
      "pull_request_review_id": 3736725362,
      "id": 2752035193,
      "node_id": "PRRC_kwDOABII586kCLl5",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const fs::path path{fs::current_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "23dd085872bc0f01309260e00cce239a9512b45e",
      "original_commit_id": "267af2c925618bf502adb6412ca34cba016f5cdd",
      "in_reply_to_id": 2751741957,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "No, it will be on disk. In `/tmp` on Linux.",
      "created_at": "2026-02-01T22:10:12Z",
      "updated_at": "2026-02-01T22:10:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2752035193",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752035193"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752037691",
      "pull_request_review_id": 3736728232,
      "id": 2752037691,
      "node_id": "PRRC_kwDOABII586kCMM7",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const fs::path path{fs::current_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "23dd085872bc0f01309260e00cce239a9512b45e",
      "original_commit_id": "267af2c925618bf502adb6412ca34cba016f5cdd",
      "in_reply_to_id": 2751741957,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "yes, isn't that using tmpfs?\r\n> Many Unix [distributions](https://en.wikipedia.org/wiki/Distribution_(software)) enable and use tmpfs by default for the [/tmp](https://en.wikipedia.org/wiki//tmp) branch of the file system or for [shared memory](https://en.wikipedia.org/wiki/Shared_memory_(interprocess_communication)).\r\n\r\nand\r\n> tmpfs (short for temporary file system) is a [temporary file](https://en.wikipedia.org/wiki/Temporary_file) storage paradigm implemented in many [Unix-like](https://en.wikipedia.org/wiki/Unix-like) operating systems. It is intended to appear as a mounted [file system](https://en.wikipedia.org/wiki/File_system), but data is stored in [volatile memory](https://en.wikipedia.org/wiki/Volatile_memory) rather than on a persistent storage device.",
      "created_at": "2026-02-01T22:13:02Z",
      "updated_at": "2026-02-01T22:13:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2752037691",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752037691"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752040726",
      "pull_request_review_id": 3736731178,
      "id": 2752040726,
      "node_id": "PRRC_kwDOABII586kCM8W",
      "diff_hunk": "@@ -167,12 +167,13 @@ const Coin& CCoinsViewCache::AccessCoin(const COutPoint &outpoint) const {\n     }\n }\n \n-bool CCoinsViewCache::HaveCoin(const COutPoint &outpoint) const {\n-    CCoinsMap::const_iterator it = FetchCoin(outpoint);\n-    return (it != cacheCoins.end() && !it->second.coin.IsSpent());\n+bool CCoinsViewCache::HaveCoin(const COutPoint& outpoint) const\n+{\n+    return !AccessCoin(outpoint).IsSpent();",
      "path": "src/coins.cpp",
      "position": 1,
      "original_position": 9,
      "commit_id": "23dd085872bc0f01309260e00cce239a9512b45e",
      "original_commit_id": "4166ee8f0175a440f461320165ce8cea9207c22e",
      "in_reply_to_id": 2751783265,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The simplification deduplicates the other `FetchCoin` + iterator, why wouldn't we reuse code here?\r\nAnd `IsSpent()` call on `coinEmpty` is just a null check, do you think that would matter anywhere?",
      "created_at": "2026-02-01T22:16:56Z",
      "updated_at": "2026-02-01T22:21:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2752040726",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752040726"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 172,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752043095",
      "pull_request_review_id": 3736733231,
      "id": 2752043095,
      "node_id": "PRRC_kwDOABII586kCNhX",
      "diff_hunk": "@@ -1059,6 +1061,86 @@ BOOST_FIXTURE_TEST_CASE(ccoins_flush_behavior, FlushTest)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(ccoins_haveinputs_uses_base_getcoin)\n+{\n+    const COutPoint prevout{Txid::FromUint256(m_rng.rand256()), 0};\n+\n+    CCoinsViewDB db{{.path = \"test\", .cache_bytes = 1_MiB, .memory_only = true}, {}};\n+    {\n+        CCoinsViewCache write_cache{&db};\n+        write_cache.SetBestBlock(m_rng.rand256());\n+        write_cache.AddCoin(prevout, MakeTestCoin(), /*possible_overwrite=*/false);\n+        write_cache.Flush();\n+    }\n+\n+    class CCoinsViewSpy final : public CCoinsViewBacked\n+    {\n+    public:\n+        const COutPoint expected;\n+        mutable size_t havecoin_calls{0}, getcoin_calls{0};\n+\n+        explicit CCoinsViewSpy(CCoinsView* view, COutPoint out) : CCoinsViewBacked(view), expected{std::move(out)} {}",
      "path": "src/test/coins_tests.cpp",
      "position": 1,
      "original_position": 31,
      "commit_id": "6f533a0f3c29446b42797c08a537de743bbb226f",
      "original_commit_id": "6f533a0f3c29446b42797c08a537de743bbb226f",
      "in_reply_to_id": 2751764873,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Because it's trivially copyable and we're in a test? Ok, made it `const COutPoint& out` like we have in `GetCoin`: https://github.com/bitcoin/bitcoin/compare/4166ee8f0175a440f461320165ce8cea9207c22e..23dd085872bc0f01309260e00cce239a9512b45e",
      "created_at": "2026-02-01T22:19:55Z",
      "updated_at": "2026-02-01T22:20:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2752043095",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752043095"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1082,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752062444",
      "pull_request_review_id": 3736760002,
      "id": 2752062444,
      "node_id": "PRRC_kwDOABII586kCSPs",
      "diff_hunk": "@@ -1059,6 +1061,86 @@ BOOST_FIXTURE_TEST_CASE(ccoins_flush_behavior, FlushTest)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(ccoins_haveinputs_uses_base_getcoin)\n+{\n+    const COutPoint prevout{Txid::FromUint256(m_rng.rand256()), 0};\n+\n+    CCoinsViewDB db{{.path = \"test\", .cache_bytes = 1_MiB, .memory_only = true}, {}};\n+    {\n+        CCoinsViewCache write_cache{&db};\n+        write_cache.SetBestBlock(m_rng.rand256());\n+        write_cache.AddCoin(prevout, MakeTestCoin(), /*possible_overwrite=*/false);\n+        write_cache.Flush();\n+    }\n+\n+    class CCoinsViewSpy final : public CCoinsViewBacked\n+    {\n+    public:\n+        const COutPoint expected;\n+        mutable size_t havecoin_calls{0}, getcoin_calls{0};\n+\n+        explicit CCoinsViewSpy(CCoinsView* view, COutPoint out) : CCoinsViewBacked(view), expected{std::move(out)} {}",
      "path": "src/test/coins_tests.cpp",
      "position": 1,
      "original_position": 31,
      "commit_id": "6f533a0f3c29446b42797c08a537de743bbb226f",
      "original_commit_id": "6f533a0f3c29446b42797c08a537de743bbb226f",
      "in_reply_to_id": 2751764873,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Because there's nothing to move, so using std::move with it doesn't make sense.",
      "created_at": "2026-02-01T22:41:04Z",
      "updated_at": "2026-02-01T22:41:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2752062444",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752062444"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1082,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752063322",
      "pull_request_review_id": 3736760619,
      "id": 2752063322,
      "node_id": "PRRC_kwDOABII586kCSda",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const fs::path path{fs::current_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};\n+    CCoinsViewDB db{{.path = path, .cache_bytes = 1_MiB, .memory_only = false, .wipe_data = true}, {}};\n+\n+    CBlock block;\n+    DataStream{benchmark::data::block413567} >> TX_WITH_WITNESS(block);\n+\n+    CCoinsViewCache cache{&db};\n+    cache.SetBestBlock(uint256::ONE);\n+    for (auto& tx : block.vtx | std::views::drop(1)) {\n+        for (auto& txin : tx->vin) {\n+            cache.AddCoin(txin.prevout, {{COIN, CScript()}, /*nHeightIn=*/1, /*fCoinBaseIn=*/false}, /*possible_overwrite=*/false);\n+        }\n+    }\n+    cache.Flush();\n+\n+    bench.batch(block.vtx.size() - 1).unit(\"tx\").run([&] {\n+        CCoinsViewCache view{&db}; // Recreate to avoid caching\n+        for (auto& tx : block.vtx | std::views::drop(1)) {\n+            if (view.GetCacheSize() % 10 == 0) (void)view.HaveInputs(*tx); // Exercise the cache-hit path as well.",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 40,
      "commit_id": "23dd085872bc0f01309260e00cce239a9512b45e",
      "original_commit_id": "267af2c925618bf502adb6412ca34cba016f5cdd",
      "in_reply_to_id": 2751755475,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yeah, so if we call twice for every tx then half are coming from cache and half not?",
      "created_at": "2026-02-01T22:42:10Z",
      "updated_at": "2026-02-01T22:42:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2752063322",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752063322"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 40,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752073667",
      "pull_request_review_id": 3736771852,
      "id": 2752073667,
      "node_id": "PRRC_kwDOABII586kCU_D",
      "diff_hunk": "@@ -1059,6 +1061,86 @@ BOOST_FIXTURE_TEST_CASE(ccoins_flush_behavior, FlushTest)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(ccoins_haveinputs_uses_base_getcoin)\n+{\n+    const COutPoint prevout{Txid::FromUint256(m_rng.rand256()), 0};\n+\n+    CCoinsViewDB db{{.path = \"test\", .cache_bytes = 1_MiB, .memory_only = true}, {}};\n+    {\n+        CCoinsViewCache write_cache{&db};\n+        write_cache.SetBestBlock(m_rng.rand256());\n+        write_cache.AddCoin(prevout, MakeTestCoin(), /*possible_overwrite=*/false);\n+        write_cache.Flush();\n+    }\n+\n+    class CCoinsViewSpy final : public CCoinsViewBacked\n+    {\n+    public:\n+        const COutPoint expected;\n+        mutable size_t havecoin_calls{0}, getcoin_calls{0};\n+\n+        explicit CCoinsViewSpy(CCoinsView* view, COutPoint out) : CCoinsViewBacked(view), expected{std::move(out)} {}",
      "path": "src/test/coins_tests.cpp",
      "position": 1,
      "original_position": 31,
      "commit_id": "6f533a0f3c29446b42797c08a537de743bbb226f",
      "original_commit_id": "6f533a0f3c29446b42797c08a537de743bbb226f",
      "in_reply_to_id": 2751764873,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Can you please expand on that? It's not a primitive type, but it is trivially copyable which should likely be similar in speed - is that what you mean?",
      "created_at": "2026-02-01T22:53:14Z",
      "updated_at": "2026-02-01T22:53:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2752073667",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752073667"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1082,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752075584",
      "pull_request_review_id": 3736774645,
      "id": 2752075584,
      "node_id": "PRRC_kwDOABII586kCVdA",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const fs::path path{fs::current_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};\n+    CCoinsViewDB db{{.path = path, .cache_bytes = 1_MiB, .memory_only = false, .wipe_data = true}, {}};\n+\n+    CBlock block;\n+    DataStream{benchmark::data::block413567} >> TX_WITH_WITNESS(block);\n+\n+    CCoinsViewCache cache{&db};\n+    cache.SetBestBlock(uint256::ONE);\n+    for (auto& tx : block.vtx | std::views::drop(1)) {\n+        for (auto& txin : tx->vin) {\n+            cache.AddCoin(txin.prevout, {{COIN, CScript()}, /*nHeightIn=*/1, /*fCoinBaseIn=*/false}, /*possible_overwrite=*/false);\n+        }\n+    }\n+    cache.Flush();\n+\n+    bench.batch(block.vtx.size() - 1).unit(\"tx\").run([&] {\n+        CCoinsViewCache view{&db}; // Recreate to avoid caching\n+        for (auto& tx : block.vtx | std::views::drop(1)) {\n+            if (view.GetCacheSize() % 10 == 0) (void)view.HaveInputs(*tx); // Exercise the cache-hit path as well.",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 40,
      "commit_id": "23dd085872bc0f01309260e00cce239a9512b45e",
      "original_commit_id": "267af2c925618bf502adb6412ca34cba016f5cdd",
      "in_reply_to_id": 2751755475,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Not sure what you mean, if you feel strongly about doing both in every step, I don't mind, just let me know if you think that's more representative",
      "created_at": "2026-02-01T22:55:17Z",
      "updated_at": "2026-02-01T22:55:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2752075584",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2752075584"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 40,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2760303170",
      "pull_request_review_id": 3746722565,
      "id": 2760303170,
      "node_id": "PRRC_kwDOABII586khuJC",
      "diff_hunk": "@@ -167,12 +167,13 @@ const Coin& CCoinsViewCache::AccessCoin(const COutPoint &outpoint) const {\n     }\n }\n \n-bool CCoinsViewCache::HaveCoin(const COutPoint &outpoint) const {\n-    CCoinsMap::const_iterator it = FetchCoin(outpoint);\n-    return (it != cacheCoins.end() && !it->second.coin.IsSpent());\n+bool CCoinsViewCache::HaveCoin(const COutPoint& outpoint) const\n+{\n+    return !AccessCoin(outpoint).IsSpent();",
      "path": "src/coins.cpp",
      "position": 1,
      "original_position": 9,
      "commit_id": "23dd085872bc0f01309260e00cce239a9512b45e",
      "original_commit_id": "4166ee8f0175a440f461320165ce8cea9207c22e",
      "in_reply_to_id": 2751783265,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Reverted, kept the formatting change.",
      "created_at": "2026-02-03T17:56:51Z",
      "updated_at": "2026-02-03T17:56:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2760303170",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2760303170"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 172,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2760303712",
      "pull_request_review_id": 3746723144,
      "id": 2760303712,
      "node_id": "PRRC_kwDOABII586khuRg",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const fs::path path{fs::current_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};\n+    CCoinsViewDB db{{.path = path, .cache_bytes = 1_MiB, .memory_only = false, .wipe_data = true}, {}};\n+\n+    CBlock block;\n+    DataStream{benchmark::data::block413567} >> TX_WITH_WITNESS(block);\n+\n+    CCoinsViewCache cache{&db};\n+    cache.SetBestBlock(uint256::ONE);\n+    for (auto& tx : block.vtx | std::views::drop(1)) {\n+        for (auto& txin : tx->vin) {\n+            cache.AddCoin(txin.prevout, {{COIN, CScript()}, /*nHeightIn=*/1, /*fCoinBaseIn=*/false}, /*possible_overwrite=*/false);\n+        }\n+    }\n+    cache.Flush();\n+\n+    bench.batch(block.vtx.size() - 1).unit(\"tx\").run([&] {\n+        CCoinsViewCache view{&db}; // Recreate to avoid caching\n+        for (auto& tx : block.vtx | std::views::drop(1)) {\n+            if (view.GetCacheSize() % 10 == 0) (void)view.HaveInputs(*tx); // Exercise the cache-hit path as well.",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 40,
      "commit_id": "23dd085872bc0f01309260e00cce239a9512b45e",
      "original_commit_id": "267af2c925618bf502adb6412ca34cba016f5cdd",
      "in_reply_to_id": 2751755475,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Changed it to:\r\n```C++\r\n            assert(view.HaveInputs(*tx));\r\n            assert(view.HaveInputs(*tx)); // Exercise the cache-hit path as well.\r\n```",
      "created_at": "2026-02-03T17:57:00Z",
      "updated_at": "2026-02-03T17:57:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2760303712",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2760303712"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 40,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2760304222",
      "pull_request_review_id": 3746723630,
      "id": 2760304222,
      "node_id": "PRRC_kwDOABII586khuZe",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const fs::path path{fs::current_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "23dd085872bc0f01309260e00cce239a9512b45e",
      "original_commit_id": "267af2c925618bf502adb6412ca34cba016f5cdd",
      "in_reply_to_id": 2751741957,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "On Mac this will create something like: `/var/folders/5t/04gq0pqj5yv4t8cxw51q0s2m0000gn/T/bench-HaveInputsOnDisk-1770141170` - changed.",
      "created_at": "2026-02-03T17:57:07Z",
      "updated_at": "2026-02-03T17:57:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2760304222",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2760304222"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2761699189",
      "pull_request_review_id": 3748424271,
      "id": 2761699189,
      "node_id": "PRRC_kwDOABII586knC91",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const auto path{fs::temp_directory_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};\n+    CCoinsViewDB db{{.path = path, .cache_bytes = 1_MiB, .memory_only = false, .wipe_data = true}, {}};\n+\n+    CBlock block;\n+    DataStream{benchmark::data::block413567} >> TX_WITH_WITNESS(block);\n+\n+    CCoinsViewCache cache{&db};\n+    cache.SetBestBlock(uint256::ONE);\n+    for (auto& tx : block.vtx | std::views::drop(1)) {\n+        for (auto& txin : tx->vin) {\n+            cache.AddCoin(txin.prevout, {{COIN, CScript()}, /*nHeightIn=*/1, /*fCoinBaseIn=*/false}, /*possible_overwrite=*/false);\n+        }\n+    }\n+    cache.Flush();\n+\n+    bench.batch(block.vtx.size() - 1).unit(\"tx\").run([&] {\n+        CCoinsViewCache view{&db}; // Recreate to avoid caching\n+        for (auto& tx : block.vtx | std::views::drop(1)) {\n+            assert(view.HaveInputs(*tx));\n+            assert(view.HaveInputs(*tx)); // Exercise the cache-hit path as well.\n+        }\n+    });\n+\n+    std::error_code ec;\n+    fs::remove_all(path, ec); // Remove the temporary directory we just created",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 46,
      "commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "original_commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "No need to do this now that we're using the temp directory. The OS will take care of this.",
      "created_at": "2026-02-04T01:06:32Z",
      "updated_at": "2026-02-04T01:06:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2761699189",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2761699189"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2762562619",
      "pull_request_review_id": 3749394865,
      "id": 2762562619,
      "node_id": "PRRC_kwDOABII586kqVw7",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const auto path{fs::temp_directory_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "original_commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "this looks like it is re-inventing the wheel in a brittle and confusing way. You can use `BasicTestingSetup` to get a m_path_root, which you can join with `bench.name()` to get your temp coinsview db path. The current code seems not ideal for several reasons:\r\n\r\n* It is re-inventing the wheel for no given reason, which is confusing\r\n* It is using the deprecated `GetTime` helper\r\n* It is brittle, because it does create a temp dir, bug ignores the `-testdatadir` arg.\r\n* Manual cleanup code is added below, when a context manager could take care of it instead.",
      "created_at": "2026-02-04T07:18:10Z",
      "updated_at": "2026-02-04T07:18:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2762562619",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2762562619"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2762780546",
      "pull_request_review_id": 3749642710,
      "id": 2762780546,
      "node_id": "PRRC_kwDOABII586krK-C",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const auto path{fs::temp_directory_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "original_commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "in_reply_to_id": 2762562619,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> re-inventing the wheel\r\n\r\nI didn't want to use a test setup in a non-test, but if you think that's better, I don't mind.\r\n\r\n> It is using the deprecated GetTime helper\r\n\r\nFair, [changed](https://github.com/bitcoin/bitcoin/compare/d957b36ab55633f51fe38f97409c184ef632a5b2..d1a8a1bc5692e1b38932f3bef36da8500614e569).\r\n\r\n> It is brittle, because it does create a temp dir, bug ignores the -testdatadir arg.\r\n\r\nGood point, done.\r\n\r\n> Manual cleanup code is added below, when a context manager could take care of it instead.\r\n\r\nIndeed, leftover that @andrewtoth also reported.",
      "created_at": "2026-02-04T08:25:29Z",
      "updated_at": "2026-02-04T08:27:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2762780546",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2762780546"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2762782316",
      "pull_request_review_id": 3749644667,
      "id": 2762782316,
      "node_id": "PRRC_kwDOABII586krLZs",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const auto path{fs::temp_directory_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};\n+    CCoinsViewDB db{{.path = path, .cache_bytes = 1_MiB, .memory_only = false, .wipe_data = true}, {}};\n+\n+    CBlock block;\n+    DataStream{benchmark::data::block413567} >> TX_WITH_WITNESS(block);\n+\n+    CCoinsViewCache cache{&db};\n+    cache.SetBestBlock(uint256::ONE);\n+    for (auto& tx : block.vtx | std::views::drop(1)) {\n+        for (auto& txin : tx->vin) {\n+            cache.AddCoin(txin.prevout, {{COIN, CScript()}, /*nHeightIn=*/1, /*fCoinBaseIn=*/false}, /*possible_overwrite=*/false);\n+        }\n+    }\n+    cache.Flush();\n+\n+    bench.batch(block.vtx.size() - 1).unit(\"tx\").run([&] {\n+        CCoinsViewCache view{&db}; // Recreate to avoid caching\n+        for (auto& tx : block.vtx | std::views::drop(1)) {\n+            assert(view.HaveInputs(*tx));\n+            assert(view.HaveInputs(*tx)); // Exercise the cache-hit path as well.\n+        }\n+    });\n+\n+    std::error_code ec;\n+    fs::remove_all(path, ec); // Remove the temporary directory we just created",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 46,
      "commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "original_commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "in_reply_to_id": 2761699189,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "[Fixed](https://github.com/bitcoin/bitcoin/compare/d957b36ab55633f51fe38f97409c184ef632a5b2..d1a8a1bc5692e1b38932f3bef36da8500614e569), thanks",
      "created_at": "2026-02-04T08:25:51Z",
      "updated_at": "2026-02-04T08:27:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2762782316",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2762782316"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2763080582",
      "pull_request_review_id": 3750001634,
      "id": 2763080582,
      "node_id": "PRRC_kwDOABII586ksUOG",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const auto path{fs::temp_directory_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "original_commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "in_reply_to_id": 2762562619,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> > re-inventing the wheel\r\n> \r\n> I didn't want to use a test setup in a non-test, but if you think that's better, I don't mind.\r\n\r\nI don't understand this. How is a benchmark not a test? The goal is to test the performance.",
      "created_at": "2026-02-04T09:38:02Z",
      "updated_at": "2026-02-04T09:38:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2763080582",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2763080582"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2763148061",
      "pull_request_review_id": 3750076030,
      "id": 2763148061,
      "node_id": "PRRC_kwDOABII586ksksd",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const auto path{fs::temp_directory_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "original_commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "in_reply_to_id": 2762562619,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The distinction I have is that a test assumes a hypothesis of precise behavior, we assert against expected values. https://en.wikipedia.org/wiki/Software_testing writes:\r\n> Software testing can determine the correctness of software for specific scenarios\r\n\r\nStrictly speaking, benchmarks are for measuring change, not testing expectations or correctness, it's mostly meant for catching regressions.\r\nI wouldn't call the compiler or linter or static analysis tests (even though they are definitely checking for correctness), but I don't mind if others do, I was simply explaining why:\r\n```C++\r\nconst auto path{fs::temp_directory_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};\r\n```\r\nseemed simpler to me than\r\n```C++\r\nconst auto testing_setup{MakeNoLogFileContext<const BasicTestingSetup>(ChainType::REGTEST)};\r\nconst auto path{testing_setup->m_path_root / fs::PathFromString(bench.name())};\r\n```\r\n\r\n----\r\n\r\nBut I have already applied your suggestions, thanks for the reviews! :)",
      "created_at": "2026-02-04T09:54:38Z",
      "updated_at": "2026-02-04T16:39:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2763148061",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2763148061"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2763232096",
      "pull_request_review_id": 3750171130,
      "id": 2763232096,
      "node_id": "PRRC_kwDOABII586ks5Ng",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+#include <util/time.h>\n+\n+#include <cassert>\n+#include <ranges>\n+#include <system_error>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const auto path{fs::temp_directory_path() / strprintf(\"bench-%s-%lld\", bench.name(), GetTime())};",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 22,
      "commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "original_commit_id": "d957b36ab55633f51fe38f97409c184ef632a5b2",
      "in_reply_to_id": 2762562619,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> seeed simpler to me than\r\n\r\nRight, it seems superficially simpler. However, if every test was brewing their own setup code, all behavior risks to be inconsistent and brittle. For example, I haven't mentioned it, but the prior version also silently conflicted with the effort from https://github.com/bitcoin/bitcoin/pull/34439. Also, without the cleanup, it may introduce an out-of-storage issue (if the bench is run in a loop, similar to the symptoms of https://github.com/bitcoin/bitcoin/pull/34445)\r\n\r\nI think generally it is best to come up with common re-usable concepts and then apply them consistently in the whole codebase.\r\n\r\nIf you think the docs imply that the common test utils are not applicable to bench tests, the docs can be improved. But the intent is certainly that the common test utils are to be used for all QA efforts.",
      "created_at": "2026-02-04T10:13:34Z",
      "updated_at": "2026-02-04T10:13:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2763232096",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2763232096"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2807839758",
      "pull_request_review_id": 3802394912,
      "id": 2807839758,
      "node_id": "PRRC_kwDOABII586nXDwO",
      "diff_hunk": "@@ -37,6 +37,8 @@ bool operator==(const Coin &a, const Coin &b) {\n            a.out == b.out;\n }\n \n+Coin MakeTestCoin() { return Coin{CTxOut{1, CScript{}}, 1, false}; }",
      "path": "src/test/coins_tests.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "a35526553833749e27d16b3003b9913b32a44014",
      "original_commit_id": "a35526553833749e27d16b3003b9913b32a44014",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: not sure we really need this helper? It's a one liner called in two places.",
      "created_at": "2026-02-14T19:37:10Z",
      "updated_at": "2026-02-14T19:47:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2807839758",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2807839758"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 40,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2807844641",
      "pull_request_review_id": 3802394912,
      "id": 2807844641,
      "node_id": "PRRC_kwDOABII586nXE8h",
      "diff_hunk": "@@ -1055,6 +1057,86 @@ BOOST_FIXTURE_TEST_CASE(ccoins_flush_behavior, FlushTest)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(ccoins_haveinputs_uses_base_getcoin)\n+{\n+    const COutPoint prevout{Txid::FromUint256(m_rng.rand256()), 0};\n+\n+    CCoinsViewDB db{{.path = \"test\", .cache_bytes = 1_MiB, .memory_only = true}, {}};\n+    {\n+        CCoinsViewCache write_cache{&db};\n+        write_cache.SetBestBlock(m_rng.rand256());\n+        write_cache.AddCoin(prevout, MakeTestCoin(), /*possible_overwrite=*/false);\n+        write_cache.Flush();\n+    }\n+\n+    class CCoinsViewSpy final : public CCoinsViewBacked\n+    {\n+    public:\n+        const COutPoint expected;\n+        mutable size_t havecoin_calls{0}, getcoin_calls{0};\n+\n+        explicit CCoinsViewSpy(CCoinsView* view, const COutPoint& out) : CCoinsViewBacked(view), expected{out} {}\n+\n+        std::optional<Coin> GetCoin(const COutPoint& out) const override\n+        {\n+            ++getcoin_calls;\n+            BOOST_CHECK(out == expected);\n+            return CCoinsViewBacked::GetCoin(out);\n+        }\n+\n+        bool HaveCoin(const COutPoint& out) const override\n+        {\n+            ++havecoin_calls;\n+            BOOST_CHECK(out == expected);\n+            return CCoinsViewBacked::HaveCoin(out);\n+        }\n+    };\n+\n+    CCoinsViewSpy base{&db, prevout};\n+    CCoinsViewCache cache{&base};\n+\n+    CMutableTransaction mtx;\n+    mtx.vin.emplace_back(prevout);\n+    const CTransaction tx{mtx};\n+    BOOST_CHECK(!tx.IsCoinBase());\n+\n+    BOOST_CHECK(cache.HaveInputs(tx));\n+    BOOST_CHECK_EQUAL(base.getcoin_calls, 1);\n+    BOOST_CHECK_EQUAL(base.havecoin_calls, 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(ccoins_haveinputs_checks_cache_first)\n+{\n+    class CCoinsViewNoCall final : public CCoinsView\n+    {\n+    public:\n+        std::optional<Coin> GetCoin(const COutPoint&) const override\n+        {\n+            BOOST_FAIL(\"Base GetCoin should not be called when input is cached\");\n+            return std::nullopt;\n+        }\n+\n+        bool HaveCoin(const COutPoint&) const override\n+        {\n+            BOOST_FAIL(\"Base HaveCoin should not be called when input is cached\");\n+            return false;\n+        }\n+    };\n+\n+    const COutPoint prevout{Txid::FromUint256(m_rng.rand256()), 0};\n+    CCoinsViewNoCall base;\n+    CCoinsViewCache cache{&base};\n+\n+    cache.AddCoin(prevout, MakeTestCoin(), /*possible_overwrite=*/false);\n+    BOOST_CHECK(cache.HaveCoinInCache(prevout));\n+\n+    CMutableTransaction mtx;\n+    mtx.vin.emplace_back(prevout);\n+    const CTransaction tx{mtx};\n+    BOOST_CHECK(!tx.IsCoinBase());\n+    BOOST_CHECK(cache.HaveInputs(tx));",
      "path": "src/test/coins_tests.cpp",
      "position": 1,
      "original_position": 90,
      "commit_id": "ff338fdb53a66ab40a36e1277e7371941fc89840",
      "original_commit_id": "a35526553833749e27d16b3003b9913b32a44014",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This seems like a basic `CCoinsViewCache` test. Is this behavior not covered elsewhere? If not, should we extend this to test that `AccessCoin`, `GetCoin`, `HaveCoin`, `SpendCoin` do not access base when the coin is cached?",
      "created_at": "2026-02-14T19:43:53Z",
      "updated_at": "2026-02-14T19:47:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2807844641",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2807844641"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2807846211",
      "pull_request_review_id": 3802394912,
      "id": 2807846211,
      "node_id": "PRRC_kwDOABII586nXFVD",
      "diff_hunk": "@@ -0,0 +1,46 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <test/util/setup_common.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+\n+#include <cassert>\n+#include <ranges>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const auto testing_setup{MakeNoLogFileContext<const BasicTestingSetup>(ChainType::REGTEST)};\n+    const auto path{testing_setup->m_path_root / fs::PathFromString(bench.name())};\n+    CCoinsViewDB db{{.path = path, .cache_bytes = 1_MiB, .memory_only = false, .wipe_data = true}, {}};\n+\n+    CBlock block;\n+    DataStream{benchmark::data::block413567} >> TX_WITH_WITNESS(block);\n+\n+    CCoinsViewCache cache{&db};\n+    cache.SetBestBlock(uint256::ONE);",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 29,
      "commit_id": "45b1b5baabd7dc7bdd1708996a5ccc828d02c263",
      "original_commit_id": "45b1b5baabd7dc7bdd1708996a5ccc828d02c263",
      "in_reply_to_id": null,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: doesn't really matter, but we could set this to `block.GetBlockHeader().GetHash()`.",
      "created_at": "2026-02-14T19:45:56Z",
      "updated_at": "2026-02-14T19:47:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2807846211",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2807846211"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2809954013",
      "pull_request_review_id": 3805554286,
      "id": 2809954013,
      "node_id": "PRRC_kwDOABII586nfH7d",
      "diff_hunk": "@@ -0,0 +1,46 @@\n+// Copyright (c) 2026-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bench/bench.h>\n+#include <bench/data/block413567.raw.h>\n+#include <coins.h>\n+#include <consensus/amount.h>\n+#include <primitives/block.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <test/util/setup_common.h>\n+#include <txdb.h>\n+#include <util/fs.h>\n+\n+#include <cassert>\n+#include <ranges>\n+\n+static void HaveInputsOnDisk(benchmark::Bench& bench)\n+{\n+    const auto testing_setup{MakeNoLogFileContext<const BasicTestingSetup>(ChainType::REGTEST)};\n+    const auto path{testing_setup->m_path_root / fs::PathFromString(bench.name())};\n+    CCoinsViewDB db{{.path = path, .cache_bytes = 1_MiB, .memory_only = false, .wipe_data = true}, {}};\n+\n+    CBlock block;\n+    DataStream{benchmark::data::block413567} >> TX_WITH_WITNESS(block);\n+\n+    CCoinsViewCache cache{&db};\n+    cache.SetBestBlock(uint256::ONE);",
      "path": "src/bench/coins_haveinputs.cpp",
      "position": 1,
      "original_position": 29,
      "commit_id": "45b1b5baabd7dc7bdd1708996a5ccc828d02c263",
      "original_commit_id": "45b1b5baabd7dc7bdd1708996a5ccc828d02c263",
      "in_reply_to_id": 2807846211,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done, thanks",
      "created_at": "2026-02-15T20:56:42Z",
      "updated_at": "2026-02-15T21:04:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2809954013",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2809954013"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2809954143",
      "pull_request_review_id": 3805554286,
      "id": 2809954143,
      "node_id": "PRRC_kwDOABII586nfH9f",
      "diff_hunk": "@@ -37,6 +37,8 @@ bool operator==(const Coin &a, const Coin &b) {\n            a.out == b.out;\n }\n \n+Coin MakeTestCoin() { return Coin{CTxOut{1, CScript{}}, 1, false}; }",
      "path": "src/test/coins_tests.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "a35526553833749e27d16b3003b9913b32a44014",
      "original_commit_id": "a35526553833749e27d16b3003b9913b32a44014",
      "in_reply_to_id": 2807839758,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I don't like duplication, but I agree it's not needed here",
      "created_at": "2026-02-15T20:56:50Z",
      "updated_at": "2026-02-15T21:04:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2809954143",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2809954143"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 40,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2809956436",
      "pull_request_review_id": 3805554286,
      "id": 2809956436,
      "node_id": "PRRC_kwDOABII586nfIhU",
      "diff_hunk": "@@ -1055,6 +1057,86 @@ BOOST_FIXTURE_TEST_CASE(ccoins_flush_behavior, FlushTest)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(ccoins_haveinputs_uses_base_getcoin)\n+{\n+    const COutPoint prevout{Txid::FromUint256(m_rng.rand256()), 0};\n+\n+    CCoinsViewDB db{{.path = \"test\", .cache_bytes = 1_MiB, .memory_only = true}, {}};\n+    {\n+        CCoinsViewCache write_cache{&db};\n+        write_cache.SetBestBlock(m_rng.rand256());\n+        write_cache.AddCoin(prevout, MakeTestCoin(), /*possible_overwrite=*/false);\n+        write_cache.Flush();\n+    }\n+\n+    class CCoinsViewSpy final : public CCoinsViewBacked\n+    {\n+    public:\n+        const COutPoint expected;\n+        mutable size_t havecoin_calls{0}, getcoin_calls{0};\n+\n+        explicit CCoinsViewSpy(CCoinsView* view, const COutPoint& out) : CCoinsViewBacked(view), expected{out} {}\n+\n+        std::optional<Coin> GetCoin(const COutPoint& out) const override\n+        {\n+            ++getcoin_calls;\n+            BOOST_CHECK(out == expected);\n+            return CCoinsViewBacked::GetCoin(out);\n+        }\n+\n+        bool HaveCoin(const COutPoint& out) const override\n+        {\n+            ++havecoin_calls;\n+            BOOST_CHECK(out == expected);\n+            return CCoinsViewBacked::HaveCoin(out);\n+        }\n+    };\n+\n+    CCoinsViewSpy base{&db, prevout};\n+    CCoinsViewCache cache{&base};\n+\n+    CMutableTransaction mtx;\n+    mtx.vin.emplace_back(prevout);\n+    const CTransaction tx{mtx};\n+    BOOST_CHECK(!tx.IsCoinBase());\n+\n+    BOOST_CHECK(cache.HaveInputs(tx));\n+    BOOST_CHECK_EQUAL(base.getcoin_calls, 1);\n+    BOOST_CHECK_EQUAL(base.havecoin_calls, 0);\n+}\n+\n+BOOST_AUTO_TEST_CASE(ccoins_haveinputs_checks_cache_first)\n+{\n+    class CCoinsViewNoCall final : public CCoinsView\n+    {\n+    public:\n+        std::optional<Coin> GetCoin(const COutPoint&) const override\n+        {\n+            BOOST_FAIL(\"Base GetCoin should not be called when input is cached\");\n+            return std::nullopt;\n+        }\n+\n+        bool HaveCoin(const COutPoint&) const override\n+        {\n+            BOOST_FAIL(\"Base HaveCoin should not be called when input is cached\");\n+            return false;\n+        }\n+    };\n+\n+    const COutPoint prevout{Txid::FromUint256(m_rng.rand256()), 0};\n+    CCoinsViewNoCall base;\n+    CCoinsViewCache cache{&base};\n+\n+    cache.AddCoin(prevout, MakeTestCoin(), /*possible_overwrite=*/false);\n+    BOOST_CHECK(cache.HaveCoinInCache(prevout));\n+\n+    CMutableTransaction mtx;\n+    mtx.vin.emplace_back(prevout);\n+    const CTransaction tx{mtx};\n+    BOOST_CHECK(!tx.IsCoinBase());\n+    BOOST_CHECK(cache.HaveInputs(tx));",
      "path": "src/test/coins_tests.cpp",
      "position": 1,
      "original_position": 90,
      "commit_id": "ff338fdb53a66ab40a36e1277e7371941fc89840",
      "original_commit_id": "a35526553833749e27d16b3003b9913b32a44014",
      "in_reply_to_id": 2807844641,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "`HaveInputs()` had no unit coverage at all.\r\nThese new tests cover the \"cache hit should not consult base\" and \"cache miss should consult `base` via `GetCoin()`\" usecases - if you think there's a better location for these, let me know.\r\nI've extended it with the mentioned methods, thanks",
      "created_at": "2026-02-15T20:59:23Z",
      "updated_at": "2026-02-15T21:04:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2809956436",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2809956436"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2832582656",
      "pull_request_review_id": 3831369297,
      "id": 2832582656,
      "node_id": "PRRC_kwDOABII586o1cgA",
      "diff_hunk": "@@ -1050,6 +1050,93 @@ BOOST_FIXTURE_TEST_CASE(ccoins_flush_behavior, FlushTest)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(ccoins_haveinputs_cache_miss_uses_base_getcoin)",
      "path": "src/test/coins_tests.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "ff338fdb53a66ab40a36e1277e7371941fc89840",
      "original_commit_id": "4b32181dbbe32f9cd9f8c2063bd31b27746f794d",
      "in_reply_to_id": null,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/34320/commits/4b32181dbbe32f9cd9f8c2063bd31b27746f794d:\r\n\r\nConsider merging both tests as done in the diff below. I also replaced the DB view with a dummy view because CCoinsViewDB is not under test here; the dummy is sufficient to test the cache.\r\n```diff\r\ndiff --git a/src/test/coins_tests.cpp b/src/test/coins_tests.cpp\r\nindex ad182559a3..baba9c4e75 100644\r\n--- a/src/test/coins_tests.cpp\r\n+++ b/src/test/coins_tests.cpp\r\n@@ -1050,23 +1050,13 @@ BOOST_FIXTURE_TEST_CASE(ccoins_flush_behavior, FlushTest)\r\n     }\r\n }\r\n \r\n-BOOST_AUTO_TEST_CASE(ccoins_haveinputs_cache_miss_uses_base_getcoin)\r\n+BOOST_AUTO_TEST_CASE(ccoins_cache_behavior)\r\n {\r\n-    const COutPoint prevout{Txid::FromUint256(m_rng.rand256()), 0};\r\n-\r\n-    CCoinsViewDB db{{.path = \"test\", .cache_bytes = 1_MiB, .memory_only = true}, {}};\r\n-    {\r\n-        CCoinsViewCache write_cache{&db};\r\n-        write_cache.SetBestBlock(m_rng.rand256());\r\n-        write_cache.AddCoin(prevout, Coin{CTxOut{1, CScript{}}, 1, false}, /*possible_overwrite=*/false);\r\n-        write_cache.Flush();\r\n-    }\r\n-\r\n     class CCoinsViewSpy final : public CCoinsViewBacked\r\n     {\r\n     public:\r\n         const COutPoint expected;\r\n-        mutable size_t havecoin_calls{0}, getcoin_calls{0};\r\n+        mutable size_t getcoin_calls{0};\r\n \r\n         explicit CCoinsViewSpy(CCoinsView* view, const COutPoint& out) : CCoinsViewBacked(view), expected{out} {}\r\n \r\n@@ -1074,18 +1064,23 @@ BOOST_AUTO_TEST_CASE(ccoins_haveinputs_cache_miss_uses_base_getcoin)\r\n         {\r\n             ++getcoin_calls;\r\n             BOOST_CHECK(out == expected);\r\n-            return CCoinsViewBacked::GetCoin(out);\r\n+            return Coin{CTxOut{1, CScript{}}, 1, false};\r\n         }\r\n \r\n         bool HaveCoin(const COutPoint& out) const override\r\n         {\r\n-            ++havecoin_calls;\r\n-            BOOST_CHECK(out == expected);\r\n-            return CCoinsViewBacked::HaveCoin(out);\r\n+            // This should never be called, since HaveInputs() should call GetCoin()\r\n+            // and not call HaveCoin() at all. If this is called, it means that\r\n+            // HaveInputs() is calling HaveCoin() instead of GetCoin(), which\r\n+            // is less efficient since it may require two lookups instead of one.\r\n+            BOOST_FAIL(\"Base HaveCoin should never be called\");\r\n+            return false;\r\n         }\r\n     };\r\n \r\n-    CCoinsViewSpy base{&db, prevout};\r\n+    const COutPoint prevout{Txid::FromUint256(m_rng.rand256()), 0};\r\n+    CCoinsView dummy;\r\n+    CCoinsViewSpy base{&dummy, prevout};\r\n     CCoinsViewCache cache{&base};\r\n \r\n     CMutableTransaction mtx;\r\n@@ -1095,46 +1090,14 @@ BOOST_AUTO_TEST_CASE(ccoins_haveinputs_cache_miss_uses_base_getcoin)\r\n \r\n     BOOST_CHECK(cache.HaveInputs(tx));\r\n     BOOST_CHECK_EQUAL(base.getcoin_calls, 1);\r\n-    BOOST_CHECK_EQUAL(base.havecoin_calls, 0);\r\n-}\r\n \r\n-BOOST_AUTO_TEST_CASE(ccoins_cache_hit_does_not_call_base)\r\n-{\r\n-    class CCoinsViewNoCall final : public CCoinsView\r\n-    {\r\n-    public:\r\n-        std::optional<Coin> GetCoin(const COutPoint&) const override\r\n-        {\r\n-            BOOST_FAIL(\"Base GetCoin should not be called when input is cached\");\r\n-            return std::nullopt;\r\n-        }\r\n-\r\n-        bool HaveCoin(const COutPoint&) const override\r\n-        {\r\n-            BOOST_FAIL(\"Base HaveCoin should not be called when input is cached\");\r\n-            return false;\r\n-        }\r\n-    };\r\n-\r\n-    const COutPoint prevout{Txid::FromUint256(m_rng.rand256()), 0};\r\n-    CCoinsViewNoCall base;\r\n-    CCoinsViewCache cache{&base};\r\n-\r\n-    cache.AddCoin(prevout, Coin{CTxOut{1, CScript{}}, 1, false}, /*possible_overwrite=*/false);\r\n-    BOOST_CHECK(cache.HaveCoinInCache(prevout));\r\n-\r\n-    BOOST_CHECK(!cache.AccessCoin(prevout).IsSpent());\r\n-    BOOST_CHECK(cache.GetCoin(prevout));\r\n-    BOOST_CHECK(cache.HaveCoin(prevout));\r\n-\r\n-    CMutableTransaction mtx;\r\n-    mtx.vin.emplace_back(prevout);\r\n-    const CTransaction tx{mtx};\r\n-    BOOST_CHECK(!tx.IsCoinBase());\r\n     BOOST_CHECK(cache.HaveInputs(tx));\r\n-\r\n-    BOOST_CHECK(cache.SpendCoin(prevout));\r\n-    BOOST_CHECK(!cache.HaveCoinInCache(prevout));\r\n+    BOOST_CHECK(cache.GetCoin(prevout));\r\n+    BOOST_CHECK(!cache.AccessCoin(prevout).IsSpent());\r\n+    // GetCoin should only have been called once,\r\n+    // since the result should be cached after\r\n+    // the first call to HaveInputs().\r\n+    BOOST_CHECK_EQUAL(base.getcoin_calls, 1);\r\n }\r\n \r\n BOOST_AUTO_TEST_CASE(coins_resource_is_used)\r\n\r\n```",
      "created_at": "2026-02-20T10:45:59Z",
      "updated_at": "2026-02-20T11:29:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2832582656",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2832582656"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1053,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2832762340",
      "pull_request_review_id": 3831369297,
      "id": 2832762340,
      "node_id": "PRRC_kwDOABII586o2IXk",
      "diff_hunk": "",
      "path": "src/dbwrapper.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "dd76338a57b9b1169ac27f7b783d6d0d4c6e38ab",
      "original_commit_id": "8c57687f8626a0242d5488a7a95722895ec5fafc",
      "in_reply_to_id": null,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "From https://github.com/bitcoin/bitcoin/pull/34320/commits/8c57687f8626a0242d5488a7a95722895ec5fafc commit message:\r\n\r\n> `ExistsImpl` was removed since it duplicates `CDBWrapper::ReadImpl` (except that it copies the resulting string on success, but that will be needed for caching anyway).\r\n\r\nI was thrown off by the last part of this sentence because it's not clear why caching is being mentioned here. I believe you were referring to the fact that with this PR, the `HaveCoin` will lead to a  `Read` call instead of an `Exists` call and will cache the result so we can ignore the cost of the copy when doing the first `HaveCoin` call.\r\n\r\nIf I am correct, can you make your justification clearer in the commit message? To state clearly that `Read` is used over `Exists` and the result is cached to the cost of the copy can be ignored.",
      "created_at": "2026-02-20T11:28:33Z",
      "updated_at": "2026-02-20T12:12:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2832762340",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2832762340"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2833884464",
      "pull_request_review_id": 3832794505,
      "id": 2833884464,
      "node_id": "PRRC_kwDOABII586o6aUw",
      "diff_hunk": "@@ -1050,6 +1050,93 @@ BOOST_FIXTURE_TEST_CASE(ccoins_flush_behavior, FlushTest)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(ccoins_haveinputs_cache_miss_uses_base_getcoin)",
      "path": "src/test/coins_tests.cpp",
      "position": 1,
      "original_position": 4,
      "commit_id": "ff338fdb53a66ab40a36e1277e7371941fc89840",
      "original_commit_id": "4b32181dbbe32f9cd9f8c2063bd31b27746f794d",
      "in_reply_to_id": 2832582656,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Thanks for the hint, I simplified this into a single `ccoins_cache_behavior` test using a dummy spy base view. It covers the two behaviors that werenâ€™t explicitly pinned elsewhere: on cache miss, `HaveInputs()` must use base `GetCoin()` (not `HaveCoin()`), and once cached (including prefilled cache), lookups stay in cache without extra base calls, with `SpendCoin()` updating cache state as expected. So this keeps the original intent while adopting your simplification and removing the DB setup/duplication.\r\n",
      "created_at": "2026-02-20T15:52:54Z",
      "updated_at": "2026-02-20T15:52:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34320#discussion_r2833884464",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2833884464"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34320"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1053,
      "side": "RIGHT"
    }
  ]
}