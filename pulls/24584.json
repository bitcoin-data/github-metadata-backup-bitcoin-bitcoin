{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584",
    "id": 881343029,
    "node_id": "PR_kwDOABII5840iDo1",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/24584",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/24584.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/24584.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/71d1d13627ccd27319f347e2d8167c8fe8a433f4",
    "number": 24584,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "wallet: avoid mixing different `OutputTypes` during coin selection",
    "user": {
      "login": "josibake",
      "id": 7444140,
      "node_id": "MDQ6VXNlcjc0NDQxNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/josibake",
      "html_url": "https://github.com/josibake",
      "followers_url": "https://api.github.com/users/josibake/followers",
      "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
      "organizations_url": "https://api.github.com/users/josibake/orgs",
      "repos_url": "https://api.github.com/users/josibake/repos",
      "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/josibake/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "# Concept\r\n\r\nFollowing https://github.com/bitcoin/bitcoin/pull/23789, Bitcoin Core wallet will now generate a change address that matches the payment address type. This improves privacy by not revealing which of the outputs is the change at the time of the transaction in scenarios where the input address types differ from the payment address type. However, information about the change can be leaked in a later transaction. This proposal attempts to address that concern.\r\n\r\n## Leaking information in a later transaction\r\n\r\nConsider the following scenario:\r\n\r\n![mix input types(1)](https://user-images.githubusercontent.com/7444140/158597086-788339b0-c698-4b60-bd45-9ede4cd3a483.png)\r\n\r\n1. Alice has a wallet with bech32 type UTXOs and pays Bob, who gives her a P2SH address\r\n2. Alice's wallet generates a P2SH change output, preserving her privacy in `txid: a`\r\n3. Alice then pays Carol, who gives her a bech32 address\r\n4. Alice's wallet combines the P2SH UTXO with a bech32 UTXO and `txid: b` has two bech32 outputs\r\n\r\nFrom a chain analysis perspective, it is reasonable to infer that the P2SH input in `txid: b` was the change from `txid: a`. To avoid leaking information in this scenario, Alice's wallet should avoid picking the P2SH output and instead fund the transaction with only bech32 Outputs. If the payment to Carol can be funded with just the P2SH output, it should be preferred over the bech32 outputs as this will convert the P2SH UTXO to bech32 UTXOs via the payment and change outputs of the new transaction.\r\n\r\n**TLDR;** Avoid mixing output types, spend non-default `OutputTypes` when it is economical to do so.\r\n\r\n# Approach\r\n\r\n`AvailableCoins` now populates a struct, which makes it easier to access coins by `OutputType`. Coin selection tries to find a funding solution by each output type and chooses the most economical by waste metric. If a solution can't be found without mixing, coin selection runs over the entire wallet, allowing mixing, which is the same as the current behavior.\r\n\r\nI've also added a functional test (`test/functional/wallet_avoid_mixing_output_types.py`) and unit test (`src/wallet/test/availablecoins_tests.cpp`.",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      }
    ],
    "created_at": "2022-03-16T13:13:49Z",
    "updated_at": "2024-01-26T10:51:15Z",
    "closed_at": "2022-07-28T22:17:13Z",
    "mergeable_state": "unknown",
    "merged_at": "2022-07-28T22:17:13Z",
    "merge_commit_sha": "1abbae65eb9c99df5d8941008068d83ad99bf117",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "josibake:josibake-coin-selection-v2",
      "ref": "josibake-coin-selection-v2",
      "sha": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 344501009,
        "node_id": "MDEwOlJlcG9zaXRvcnkzNDQ1MDEwMDk=",
        "name": "bitcoin",
        "full_name": "josibake/bitcoin",
        "owner": {
          "login": "josibake",
          "id": 7444140,
          "node_id": "MDQ6VXNlcjc0NDQxNDA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/josibake",
          "html_url": "https://github.com/josibake",
          "followers_url": "https://api.github.com/users/josibake/followers",
          "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
          "organizations_url": "https://api.github.com/users/josibake/orgs",
          "repos_url": "https://api.github.com/users/josibake/repos",
          "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/josibake/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/josibake/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/josibake/bitcoin",
        "archive_url": "https://api.github.com/repos/josibake/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/josibake/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/josibake/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/josibake/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/josibake/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/josibake/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/josibake/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/josibake/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/josibake/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/josibake/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/josibake/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/josibake/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/josibake/bitcoin/events",
        "forks_url": "https://api.github.com/repos/josibake/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/josibake/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/josibake/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/josibake/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/josibake/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/josibake/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/josibake/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/josibake/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/josibake/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/josibake/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/josibake/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/josibake/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/josibake/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/josibake/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/josibake/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/josibake/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:josibake/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/josibake/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/josibake/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/josibake/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/josibake/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/josibake/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/josibake/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/josibake/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/josibake/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/josibake/bitcoin/hooks",
        "svn_url": "https://github.com/josibake/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 236496,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-01-26T10:51:55Z",
        "created_at": "2021-03-04T14:24:20Z",
        "updated_at": "2022-01-04T15:38:49Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "ad466b85cd8e6cd138518c3247086eaf83f427f1",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 36588,
        "stargazers_count": 73549,
        "watchers_count": 73549,
        "size": 247755,
        "default_branch": "master",
        "open_issues_count": 690,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-01-26T09:40:29Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-01-26T10:23:38Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 612,
    "deletions": 182,
    "changed_files": 11,
    "commits": 5,
    "review_comments": 138,
    "comments": 42
  },
  "events": [
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-16T13:37:03Z",
      "updated_at": "2022-03-16T13:37:03Z",
      "source": {
        "issue": {
          "id": 1140610177,
          "node_id": "PR_kwDOABII584y8_qK",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24362",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24362/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24362/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24362/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24362",
          "number": 24362,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: Do not match legacy addresses for change type",
          "body": "We've long since moved away from using the legacy address type unless the user explicitly wants it, so we should not re-introduce using it as change automatically.",
          "user": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 26,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24362",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24362",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24362.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24362.patch"
          },
          "closed_at": "2022-08-12T21:05:14Z",
          "created_at": "2022-02-16T21:36:43Z",
          "updated_at": "2023-08-12T10:19:54Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 911639998,
      "node_id": "PRR_kwDOABII5842VoW-",
      "url": null,
      "actor": null,
      "commit_id": "312d9347b3e5e611ab28c1307d73345576dc4d7d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "I think an argument against this change is that any privacy leaking tx could very well be a coin-join between two wallets that use different output types. Though, I don't think any such coin-join software exists today, so until then it probably makes sense to use inputs of a single type. https://github.com/bitcoin/bitcoin/pull/24362#pullrequestreview-909069657 mentions that legacy inputs could preferably be used during low-fee periods to reduce the fees paid by the user. Though, if #24362 is merged, then it would probably not be worth it to optimize for fees.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-911639998",
      "submitted_at": "2022-03-16T13:41:40Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6251097937,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAF0mC9R",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6251097937",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-16T13:48:09Z"
    },
    {
      "event": "commented",
      "id": 1069161907,
      "node_id": "IC_kwDOABII584_uh2z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1069161907",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-16T13:59:36Z",
      "updated_at": "2022-03-16T13:59:36Z",
      "author_association": "MEMBER",
      "body": "> I think an argument against this change is that any privacy leaking tx could very well be a coin-join between two wallets that use different output types. Though, I don't think any such coin-join software exists today, so until then it probably makes sense to use inputs of a single type. \r\n\r\nI agree, until mixed inputs in transactions are more common, this change should improve user privacy.\r\n\r\n> https://github.com/bitcoin/bitcoin/pull/24362#pullrequestreview-909069657 mentions that legacy inputs could preferably be used during low-fee periods to reduce the fees paid by the user. Though, if https://github.com/bitcoin/bitcoin/pull/24362 is merged, then it would probably not be worth it to optimize for fees.\r\n\r\nI prefer this approach over #24362 in order to keep the privacy benefits of matching change output addresses for all address types. I also see this as a small first step, where we can optimize for fees in a later PR if it is deemed useful/worth it. ",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1069161907",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6251350694,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAF0nAqm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6251350694",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-16T14:19:10Z"
    },
    {
      "event": "commented",
      "id": 1069182464,
      "node_id": "IC_kwDOABII584_um4A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1069182464",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-16T14:20:04Z",
      "updated_at": "2022-03-16T14:20:04Z",
      "author_association": "CONTRIBUTOR",
      "body": "Very exciting, I'm glad you're working on this. I was just discussing this idea with people yesterday.\r\n\r\nA couple comments on the approach described in the OP:\r\n- I noticed that you suggest preferring the spending of older types and compare it to spending newer types preferentially. While I do agree that the old types are the ones we'd want to get rid off rather, I am not sure this would lead to the optimal outcome. I would suggest running coin selection for each of the OutputGroup sets in parallel and then choosing the input set per the waste metric. Due to how the waste metric works, I'd expect this to lead to the older larger output types getting preferentially spent at lower feerates (and in the current feerate environment, usually first). What are your thoughts on that?\r\n- Regarding splitting the OutputGroups: since each OutputGroup will only have one type, you could just get the available set once and subdivide it from there to run the coin selection in parallel. Would that perhaps be easier?\r\n- CoinSelection is pretty fast, with the exception of Knapsack, so running it on subsets of the UTXO pool shouldn't be a huge issue, running it on all subsets in parallel may be even faster than running it on the whole UTXO pool once since the complexity of each subset would be much smaller.\r\n\r\nCeterum censeo Knapsackinem esse delendam.",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1069182464",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "commented",
      "id": 1069183242,
      "node_id": "IC_kwDOABII584_unEK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1069183242",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-16T14:20:53Z",
      "updated_at": "2022-03-16T14:30:56Z",
      "author_association": "MEMBER",
      "body": "force pushed to fix clang-formatting and add comments per @MarcoFalke 's suggestion. can be verified with `git range-diff master f900010 fdf1fa5`",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1069183242",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 6251365030,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAF0nEKm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6251365030",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-16T14:20:55Z"
    },
    {
      "event": "subscribed",
      "id": 6251365107,
      "node_id": "SE_lADOABII585FzCTjzwAAAAF0nELz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6251365107",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-16T14:20:55Z"
    },
    {
      "event": "labeled",
      "id": 6251480498,
      "node_id": "LE_lADOABII585FzCTjzwAAAAF0ngWy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6251480498",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-16T14:35:28Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "reviewed",
      "id": 912059789,
      "node_id": "PRR_kwDOABII5842XO2N",
      "url": null,
      "actor": null,
      "commit_id": "fdf1fa5e6c35564f33d874b86a45b7b0731f434d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-912059789",
      "submitted_at": "2022-03-16T18:07:57Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "reviewed",
      "id": 911730230,
      "node_id": "PRR_kwDOABII5842V-Y2",
      "url": null,
      "actor": null,
      "commit_id": "fdf1fa5e6c35564f33d874b86a45b7b0731f434d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-911730230",
      "submitted_at": "2022-03-16T18:41:43Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "commented",
      "id": 1069474564,
      "node_id": "IC_kwDOABII584_vuME",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1069474564",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-16T18:52:25Z",
      "updated_at": "2022-03-16T18:52:25Z",
      "author_association": "MEMBER",
      "body": "> I would suggest running coin selection for each of the OutputGroup sets in parallel and then choosing the input set per the waste metric. Due to how the waste metric works, I'd expect this to lead to the older larger output types getting preferentially spent at lower feerates (and in the current feerate environment, usually first). What are your thoughts on that?\r\n\r\nThis makes a lot of sense. By running coin selection on each OutputGroup set you are preserving privacy by avoiding mixing the inputs, but also still choosing the best spend w.r.t to fees. Running them in parallel (as opposed to sequentially) also helps speed things up (which you also mentioned).\r\n\r\nI'll work on refactoring to implement this.\r\n\r\n",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1069474564",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "reviewed",
      "id": 912136611,
      "node_id": "PRR_kwDOABII5842Xhmj",
      "url": null,
      "actor": null,
      "commit_id": "fdf1fa5e6c35564f33d874b86a45b7b0731f434d",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-912136611",
      "submitted_at": "2022-03-16T20:28:25Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "commented",
      "id": 1071243869,
      "node_id": "IC_kwDOABII584_2eJd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1071243869",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-17T19:22:06Z",
      "updated_at": "2022-07-28T03:45:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25685](https://github.com/bitcoin/bitcoin/pull/25685) (wallet: Faster transaction creation by removing pre-set-inputs fetching responsibility from Coin Selection by furszy)\n* [#25659](https://github.com/bitcoin/bitcoin/pull/25659) (wallet: simplify ListCoins implementation by furszy)\n* [#25647](https://github.com/bitcoin/bitcoin/pull/25647) (wallet: return change from SelectionResult by S3RK)\n* [#24814](https://github.com/bitcoin/bitcoin/pull/24814) (refactor: improve complexity of removing preselected coins by rag-hav)\n* [#24699](https://github.com/bitcoin/bitcoin/pull/24699) (wallet: Improve AvailableCoins performance by reducing duplicated operations by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1071243869",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-17T20:40:51Z",
      "updated_at": "2022-03-17T20:40:51Z",
      "source": {
        "issue": {
          "id": 1169917418,
          "node_id": "PR_kwDOABII5840eba6",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24570",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24570/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24570/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24570/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24570",
          "number": 24570,
          "state": "closed",
          "state_reason": null,
          "title": "test, refactor: fund tx deterministically in `feature_coinstatindex`",
          "body": "While working on some changes to coin selection in a separate branch, I noticed this test was failing. This is because the test expects exact values from `gettxoutsetinfo` to compare against, which relies on coin selection to be deterministic.\r\n\r\nIf coin selection is changed in any way, this test will fail and need to be updated with new values.\r\n\r\nInstead, we can make the test deterministic by filtering to a UTXO of a specific amount as our first input and then using `fundrawtransaction` to grab a second UTXO. This works because the remaining large UTXOs in the wallet are coinbase outputs. Creating a transaction in this way does not affect any of the logic in the test.\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
          "user": {
            "login": "josibake",
            "id": 7444140,
            "node_id": "MDQ6VXNlcjc0NDQxNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/josibake",
            "html_url": "https://github.com/josibake",
            "followers_url": "https://api.github.com/users/josibake/followers",
            "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
            "organizations_url": "https://api.github.com/users/josibake/orgs",
            "repos_url": "https://api.github.com/users/josibake/repos",
            "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/josibake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24570",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24570",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24570.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24570.patch"
          },
          "closed_at": "2022-03-18T10:15:28Z",
          "created_at": "2022-03-15T16:37:01Z",
          "updated_at": "2023-10-11T12:13:55Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 914956407,
      "node_id": "PRR_kwDOABII5842iSB3",
      "url": null,
      "actor": null,
      "commit_id": "fdf1fa5e6c35564f33d874b86a45b7b0731f434d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-914956407",
      "submitted_at": "2022-03-19T01:44:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "reviewed",
      "id": 914958148,
      "node_id": "PRR_kwDOABII5842iSdE",
      "url": null,
      "actor": null,
      "commit_id": "fdf1fa5e6c35564f33d874b86a45b7b0731f434d",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "user": {
        "login": "danai554",
        "id": 100536035,
        "node_id": "U_kgDOBf4O4w",
        "avatar_url": "https://avatars.githubusercontent.com/u/100536035?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/danai554",
        "html_url": "https://github.com/danai554",
        "followers_url": "https://api.github.com/users/danai554/followers",
        "following_url": "https://api.github.com/users/danai554/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/danai554/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/danai554/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/danai554/subscriptions",
        "organizations_url": "https://api.github.com/users/danai554/orgs",
        "repos_url": "https://api.github.com/users/danai554/repos",
        "events_url": "https://api.github.com/users/danai554/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/danai554/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-914958148",
      "submitted_at": "2022-03-19T02:04:36Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-19T12:21:31Z",
      "updated_at": "2022-03-19T12:21:31Z",
      "source": {
        "issue": {
          "id": 1172762748,
          "node_id": "PR_kwDOABII5840nfdL",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24605",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24605/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24605/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24605/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24605",
          "number": 24605,
          "state": "closed",
          "state_reason": null,
          "title": "test: Use MiniWallet in feature_coinstatsindex",
          "body": "Allows the test to be run even without a wallet compiled",
          "user": {
            "login": "maflcko",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/maflcko",
            "html_url": "https://github.com/maflcko",
            "followers_url": "https://api.github.com/users/maflcko/followers",
            "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
            "organizations_url": "https://api.github.com/users/maflcko/orgs",
            "repos_url": "https://api.github.com/users/maflcko/repos",
            "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/maflcko/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 4,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24605",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24605",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24605.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24605.patch"
          },
          "closed_at": "2022-03-22T06:57:39Z",
          "created_at": "2022-03-17T18:52:58Z",
          "updated_at": "2023-03-22T10:20:12Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 6281108370,
      "node_id": "LE_lADOABII585FzCTjzwAAAAF2YhuS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6281108370",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-22T07:05:18Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-23T16:02:38Z",
      "updated_at": "2022-03-23T16:02:38Z",
      "source": {
        "issue": {
          "id": 1178331779,
          "node_id": "PR_kwDOABII58405KQO",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24653",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24653/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24653/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24653/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24653",
          "number": 24653,
          "state": "closed",
          "state_reason": null,
          "title": "test: use `MiniWallet` in `test/functional/interface_zmq`",
          "body": "While working on #24584 , `interface_zmq` started failing due to coin selection not running deterministically. The test doesn't actually need the wallet, so this PR migrates it to use MiniWallet\r\n\r\n_Note for reviewers:_ the second commit moves large chunks of code out of an if block, so it may be helpful to review with something that ignores whitespace, e.g `git diff -w master`",
          "user": {
            "login": "josibake",
            "id": 7444140,
            "node_id": "MDQ6VXNlcjc0NDQxNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/josibake",
            "html_url": "https://github.com/josibake",
            "followers_url": "https://api.github.com/users/josibake/followers",
            "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
            "organizations_url": "https://api.github.com/users/josibake/orgs",
            "repos_url": "https://api.github.com/users/josibake/repos",
            "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/josibake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 2,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24653",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24653",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24653.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24653.patch"
          },
          "closed_at": "2022-03-24T18:59:25Z",
          "created_at": "2022-03-23T16:02:37Z",
          "updated_at": "2024-01-26T10:51:06Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "referenced",
      "id": 6301886821,
      "node_id": "REFE_lADOABII585FzCTjzwAAAAF3nyll",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6301886821",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "a697a3fc91561a509cbee571e3254a0e137d32d9",
      "commit_url": "https://api.github.com/repos/maflcko/bitcoin-core/commits/a697a3fc91561a509cbee571e3254a0e137d32d9",
      "created_at": "2022-03-24T18:59:19Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6317986671,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAF4lNNv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6317986671",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-28T12:16:35Z"
    },
    {
      "event": "renamed",
      "id": 6318294410,
      "node_id": "RTE_lADOABII585FzCTjzwAAAAF4mYWK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6318294410",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-28T12:59:40Z",
      "rename": {
        "from": "[RFC] wallet: avoid mixing different `OutputTypes` during coin selection",
        "to": "wallet: avoid mixing different `OutputTypes` during coin selection"
      }
    },
    {
      "event": "unlabeled",
      "id": 6318905828,
      "node_id": "UNLE_lADOABII585FzCTjzwAAAAF4otnk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6318905828",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-28T14:11:32Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 923394293,
      "node_id": "PRR_kwDOABII5843CeD1",
      "url": null,
      "actor": null,
      "commit_id": "072e755e553d3502572d7db1cbe04d73e31b6b2e",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for working on this, I like how you've split up availableCoins and how you have structured your tests. I have some ideas on some additional tests you might want to add, and a few questions.",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-923394293",
      "submitted_at": "2022-03-28T21:53:24Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-29T14:12:30Z",
      "updated_at": "2022-03-29T14:12:30Z",
      "source": {
        "issue": {
          "id": 1184048636,
          "node_id": "PR_kwDOABII5841MBLg",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24699",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24699/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24699/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24699/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24699",
          "number": 24699,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: Improve AvailableCoins performance by reducing duplicated operations",
          "body": "While running my coin selection simulations, I noticed that towards the end of the simulation, the wallet would become slow to make new transactions. The wallet generally performs much more slowly when there are a large number of transactions and/or a large number of keys. The improvements here are focused on wallets with a large number of transactions as that is what the simulations produce.\r\n\r\nMost of the slowdown I observed was due to `DescriptorScriptPubKeyMan::GetSigningProvider` re-deriving keys every time it is called. To avoid this, it will now cache the `SigningProvider` produced so that repeatedly fetching the `SigningProvider` for the same script will not result in the same key being derived over and over. This has a side effect of making the function non-const, which makes a lot of other functions non-const as well. This helps with wallets with lots of address reuse (as my coin selection simulations are), but not if addresses are not reused as keys will end up needing to be derived the first time `GetSigningProvider` is called for a script.\r\n\r\nThe `GetSigningProvider` problem was also exacerbated by unnecessarily fetching a `SigningProvider` for the same script multiple times. A `SigningProvider` is retrieved to be used inside of `IsSolvable`. A few lines later, we use `GetTxSpendSize` which fetches a `SigningProvider` and then calls `CalculateMaximumSignedInputSize`. We can avoid a second call to `GetSigningProvider` by using `CalculateMaximumSignedInputSize` directly with the `SigningProvider` already retrieved for `IsSolvable`.\r\n\r\nThere is an additional slowdown where `ProduceSignature` with a dummy signer is called twice for each output. The first time is `IsSolvable` checks that `ProduceSignature` succeeds, thereby informing whether we have solving data. The second is `CalculateMaximumSignedInputSize` which returns -1 if `ProduceSignature` fails, and returns the input size otherwise. We can reduce this to one call of `ProduceSignature` by using `CalculateMaximumSignedInputSize`'s result to set `solvable`.\r\n\r\nLastly, a lot of time is spent looking in `mapWallet` and `mapTxSpends` to determine whether an output is already spent. The performance of these lookups is slightly improved by changing those maps to use `std::unordered_map` and `std::unordered_multimap` respectively.",
          "user": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 14,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24699",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24699",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24699.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24699.patch"
          },
          "closed_at": "2022-08-05T19:32:03Z",
          "created_at": "2022-03-28T22:08:03Z",
          "updated_at": "2023-10-28T12:16:24Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-29T15:18:03Z",
      "updated_at": "2022-03-29T15:18:03Z",
      "source": {
        "issue": {
          "id": 1179794937,
          "node_id": "PR_kwDOABII58409z6c",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24661",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24661/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24661/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24661/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24661",
          "number": 24661,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Use clang-tidy syntax for C++ named arguments",
          "body": "> Incorrect named args are source of bugs, like https://github.com/bitcoin/bitcoin/pull/22979.\r\n\r\n> To allow them being checked by clang-tidy, use a format it can understand.\r\n\r\nPicks up #23545, with some additional changes and some feedback addressed.\r\n\r\nWith these changes invoking `./autogen.sh && ./configure CC=clang-12 CXX=clang++-12 && make clean && bear make -j9 && ( cd ./src/ && run-clang-tidy-12 -j9 )` no-longer results in named argument errors out of `clang-tidy`.\r\n\r\nUltimately I think we should just add `clang-tidy-*` jobs to the CI and automate things away.",
          "user": {
            "login": "fanquake",
            "id": 863730,
            "node_id": "MDQ6VXNlcjg2MzczMA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fanquake",
            "html_url": "https://github.com/fanquake",
            "followers_url": "https://api.github.com/users/fanquake/followers",
            "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
            "organizations_url": "https://api.github.com/users/fanquake/orgs",
            "repos_url": "https://api.github.com/users/fanquake/repos",
            "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/fanquake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 5,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24661",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24661",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24661.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24661.patch"
          },
          "closed_at": "2022-04-04T08:08:59Z",
          "created_at": "2022-03-24T17:06:55Z",
          "updated_at": "2023-04-04T14:41:41Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 925224036,
      "node_id": "PRR_kwDOABII5843Jcxk",
      "url": null,
      "actor": null,
      "commit_id": "072e755e553d3502572d7db1cbe04d73e31b6b2e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK\r\n\r\n> Since the UTXO pools divided by type are much smaller, the backoff steps allowing for unconfirmed change to be used may come into play much more often. Then, since the waste metric does not yet account for the unconfirmed inputs, we may spend unconfirmed UTXOs more often.\r\n\r\n> is it by design that the waste metric does not consider unconfirmed change?\r\n\r\nOur preference for different coin selection solutions is spread out over multiple places in the code, including the waste metric and the sequence of `CoinEligibilityFilter`s used in each `AttemptSelection()` call. The way we encode our preference for confirmed UTXOs is by attempting coin selection with confirmed UTXOs first, and *only* trying with unconfirmed UTXOs if that fails.\r\n\r\nApproach-wise, did you consider adding output type to `CoinEligibilityFilter` instead, and trying selection for each output type within `AttemptSelection()`? This way you try to do selection for every output type for confirmed UTXOs only, before you try unconfirmed.\r\n\r\nAnother possibility is adding the logic for preferring confirmed over unconfirmed UTXOs to `SelectionResult` and editing the `operator<` to account for it.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-925224036",
      "submitted_at": "2022-03-29T20:52:14Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "commented",
      "id": 1083129149,
      "node_id": "IC_kwDOABII585Ajz09",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1083129149",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-30T13:17:00Z",
      "updated_at": "2022-03-30T13:17:17Z",
      "author_association": "MEMBER",
      "body": "thanks for the review, @glozow !\r\n\r\n> Approach-wise, did you consider adding output type to `CoinEligibilityFilter` instead, and trying selection for each output type within `AttemptSelection()`? This way you try to do selection for every output type for confirmed UTXOs only, before you try unconfirmed.\r\n\r\nThis is how I wrote the code initially (by adding `OutputType` to `CoinEligibilityFilter`) but abandoned it in favor of separating the `OutputTypes` into different vectors during `GetAvailableCoins` and then running coin selection on each vector separately and comparing the results.\r\n\r\n> Another possibility is adding the logic for preferring confirmed over unconfirmed UTXOs to `SelectionResult` and editing the `operator<` to account for it.\r\n\r\nI like this idea. I think it keeps the logic a little cleaner.\r\n",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1083129149",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 6335059114,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAF5mVSq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6335059114",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-30T13:17:17Z"
    },
    {
      "event": "subscribed",
      "id": 6335059123,
      "node_id": "SE_lADOABII585FzCTjzwAAAAF5mVSz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6335059123",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-30T13:17:17Z"
    },
    {
      "event": "commented",
      "id": 1083136704,
      "node_id": "IC_kwDOABII585Aj1rA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1083136704",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-30T13:24:07Z",
      "updated_at": "2022-03-30T13:24:07Z",
      "author_association": "MEMBER",
      "body": "based on feedback so far (thanks, everyone!), I think next steps are:\r\n\r\n* Better break out `P2SH`, vs lumping all `P2SH` with `P2SH_SEGWIT`\r\n* Account for unconfirmed txs being preferred when picking the \"best\" solution\r\n* Refactor functional tests to be less tightly coupled to coin selection and better documented\r\n* Potentially move some tests out of functional into unit tests",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1083136704",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "referenced",
      "id": 6357121990,
      "node_id": "REFE_lADOABII585FzCTjzwAAAAF66fvG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6357121990",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "fad0b373172b2172e27d0fcbbd1ff11a8f029a43",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/fad0b373172b2172e27d0fcbbd1ff11a8f029a43",
      "created_at": "2022-04-02T16:12:41Z"
    },
    {
      "event": "labeled",
      "id": 6361438236,
      "node_id": "LE_lADOABII585FzCTjzwAAAAF7K9gc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6361438236",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T09:37:16Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 934837483,
      "node_id": "PRR_kwDOABII5843uHzr",
      "url": null,
      "actor": null,
      "commit_id": "072e755e553d3502572d7db1cbe04d73e31b6b2e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-934837483",
      "submitted_at": "2022-04-07T10:25:59Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6484543592,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGCgkho",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6484543592",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-23T18:14:30Z"
    },
    {
      "event": "commented",
      "id": 1107604826,
      "node_id": "IC_kwDOABII585CBLVa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1107604826",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-23T18:36:34Z",
      "updated_at": "2022-04-23T18:36:34Z",
      "author_association": "MEMBER",
      "body": "re-worked this based on feedback and overall much happier with the approach:\r\n\r\n* When output is P2SH, run the solver on the `redeemScript` to determine the true `OutputType`. This puts P2SH outputs which are multisig into the legacy bucket @achow101 \r\n* Instead of running `SelectCoins` multiple times over each `OutputType`, I moved the logic into `AttemptSelection`. This ensures that all of the existing back-offs are respected, which addressed the issue regarding unconfirmed change @Xekyo @glozow \r\n* Refactored the test to be better documented and less brittle w.r.t coin selection\r\n* Removed changes to existing functional tests as they are no longer failing after fixing the unconfirmed change issue. I do believe there is room for improvement if a test relies on specific behavior from coin selection, but that is out of the scope of this PR",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1107604826",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 6484772980,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGChch0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6484772980",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-23T18:36:34Z"
    },
    {
      "event": "subscribed",
      "id": 6484772981,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGChch1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6484772981",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-23T18:36:34Z"
    },
    {
      "event": "mentioned",
      "id": 6484772985,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGChch5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6484772985",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-23T18:36:34Z"
    },
    {
      "event": "subscribed",
      "id": 6484772988,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGChch8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6484772988",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-23T18:36:34Z"
    },
    {
      "event": "mentioned",
      "id": 6484772990,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGChch-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6484772990",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-23T18:36:34Z"
    },
    {
      "event": "subscribed",
      "id": 6484772992,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGChciA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6484772992",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-23T18:36:34Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6484821868,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGChods",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6484821868",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-23T18:50:12Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6484825970,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGChpdy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6484825970",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-23T18:54:49Z"
    },
    {
      "event": "commented",
      "id": 1107615725,
      "node_id": "IC_kwDOABII585CBN_t",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1107615725",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-23T18:57:02Z",
      "updated_at": "2022-04-24T11:10:13Z",
      "author_association": "MEMBER",
      "body": "force pushed a few minor code style edits. also noticed the branch is failing to build after rebasing on master. <strike>seems related to the fuzzer, will troubleshoot in the morning.</strike> fixed",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1107615725",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "unlabeled",
      "id": 6484917143,
      "node_id": "UNLE_lADOABII585FzCTjzwAAAAGCh_uX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6484917143",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-23T19:13:21Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-24T06:38:15Z",
      "updated_at": "2022-04-24T06:38:15Z",
      "source": {
        "issue": {
          "id": 1203525439,
          "node_id": "PR_kwDOABII5842MDDS",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24845",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24845/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24845/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24845/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24845",
          "number": 24845,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: return error msg for  \"too-long-mempool-chain\"",
          "body": "Fixes #23144.\r\n\r\nWe currently return a general \"Insufficient funds\" from Coin\r\nSelection when we actually skipped unconfirmed UTXOs that\r\nsurpassed the mempool ancestors limit.\r\n\r\nThis PR make the error clearer by returning:\r\n\"Unconfirmed UTXOs are available, but spending them creates\r\na chain of transactions that will be rejected by the mempool\"\r\n\r\nAlso, added an early return from Coin Selection if the sum of\r\nthe discarded coins decreases the available balance below the\r\ntarget amount.",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignee": {
            "login": "glozow",
            "id": 25183001,
            "node_id": "MDQ6VXNlcjI1MTgzMDAx",
            "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/glozow",
            "html_url": "https://github.com/glozow",
            "followers_url": "https://api.github.com/users/glozow/followers",
            "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
            "organizations_url": "https://api.github.com/users/glozow/orgs",
            "repos_url": "https://api.github.com/users/glozow/repos",
            "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/glozow/received_events",
            "type": "User",
            "site_admin": false
          },
          "assignees": [
            {
              "login": "glozow",
              "id": 25183001,
              "node_id": "MDQ6VXNlcjI1MTgzMDAx",
              "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/glozow",
              "html_url": "https://github.com/glozow",
              "followers_url": "https://api.github.com/users/glozow/followers",
              "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
              "organizations_url": "https://api.github.com/users/glozow/orgs",
              "repos_url": "https://api.github.com/users/glozow/repos",
              "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/glozow/received_events",
              "type": "User",
              "site_admin": false
            }
          ],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 14,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24845",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24845",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24845.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24845.patch"
          },
          "closed_at": "2023-03-23T15:54:35Z",
          "created_at": "2022-04-13T16:25:15Z",
          "updated_at": "2023-05-27T01:51:56Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-24T07:22:22Z",
      "updated_at": "2022-04-24T07:22:22Z",
      "source": {
        "issue": {
          "id": 1198613313,
          "node_id": "PR_kwDOABII58417_Jx",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24814",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24814/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24814/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24814/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24814",
          "number": 24814,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: improve complexity of removing preselected coins",
          "body": "Improve the complexity of removing pre-selected coins from the pool to linear from quadratic.\r\n\r\n",
          "user": {
            "login": "rag-hav",
            "id": 60528983,
            "node_id": "MDQ6VXNlcjYwNTI4OTgz",
            "avatar_url": "https://avatars.githubusercontent.com/u/60528983?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/rag-hav",
            "html_url": "https://github.com/rag-hav",
            "followers_url": "https://api.github.com/users/rag-hav/followers",
            "following_url": "https://api.github.com/users/rag-hav/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/rag-hav/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/rag-hav/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/rag-hav/subscriptions",
            "organizations_url": "https://api.github.com/users/rag-hav/orgs",
            "repos_url": "https://api.github.com/users/rag-hav/repos",
            "events_url": "https://api.github.com/users/rag-hav/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/rag-hav/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "NONE",
          "locked": true,
          "comments": 15,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24814",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24814",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24814.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24814.patch"
          },
          "closed_at": "2022-07-29T14:05:19Z",
          "created_at": "2022-04-09T13:48:54Z",
          "updated_at": "2023-07-29T10:17:19Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6485709246,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGClBG-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6485709246",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-24T11:08:23Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-24T14:02:36Z",
      "updated_at": "2022-04-24T14:02:36Z",
      "source": {
        "issue": {
          "id": 1085063009,
          "node_id": "PR_kwDOABII584wF-no",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23829",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23829/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23829/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23829/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/23829",
          "number": 23829,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: use braced init for integer literals instead of c style casts",
          "body": "See https://github.com/bitcoin/bitcoin/pull/23810 for more context. This is broken out from that PR, as it is less breaking, and should be trivial to review and merge.\r\n\r\nEDIT: Long term, the intention is to remove all C-style casts, as they can dangerously introduce reinterpret_casts. This is one step which removes a number of trivially removable C-style casts",
          "user": {
            "login": "PastaPastaPasta",
            "id": 6443210,
            "node_id": "MDQ6VXNlcjY0NDMyMTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/PastaPastaPasta",
            "html_url": "https://github.com/PastaPastaPasta",
            "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
            "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
            "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
            "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
            "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 12,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23829",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/23829",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/23829.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/23829.patch"
          },
          "closed_at": "2023-01-05T16:33:27Z",
          "created_at": "2021-12-20T18:02:00Z",
          "updated_at": "2023-02-19T17:44:34Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6488907787,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGCxOAL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6488907787",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-25T09:34:40Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-28T02:00:32Z",
      "updated_at": "2022-04-28T02:00:32Z",
      "source": {
        "issue": {
          "id": 1217495965,
          "node_id": "PR_kwDOABII58424ecR",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25005",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25005/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25005/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25005/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25005",
          "number": 25005,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: remove extra wtx lookup in 'AvailableCoins' + several code cleanups.",
          "body": "This started in #24845 but grew out of scope of it. \r\n\r\nSo, points tackled:\r\n\r\n1) Avoid extra `GetWalletTx` lookups inside `AvailableCoins -> IsSpentKey`.\r\n    `IsSpentKey` was receiving the tx hash and index to internally lookup the tx inside the wallet's map. As all the `IsSpentKey` function callers already have the wtx available, them can provide the `scriptPubKey` directly.\r\n\r\n2) Most of the time, we call `Wallet::AvailableCoins`, and later on the process, skip the non-spendable coins from the result in subsequent for-loops. So to speedup the process: introduced the ability to filter by \"only_spendable\" coins inside `Wallet::AvailableCoins` directly.\r\n(the non-spendable coins skip examples are inside `AttemptSelection->GroupOutputs` and `GetAvailableBalance`).\r\n\r\n4) Refactored `AvailableCoins` in several ways:\r\n\r\n   a) Now it will return a new struct `CoinsResult` instead of receiving the vCoins vector reference (which was being cleared at the beginning of the method anyway). --> this is coming from #24845 but cherry-picked it here too to make the following commits look nicer.\r\n\r\n   b) Unified all the 'wtx.tx->vout[I]' calls into a single call (coming from this comment https://github.com/bitcoin/bitcoin/pull/24699#discussion_r854163032). \r\n\r\n5) The wallet `IsLockedCoin` and `IsSpent` methods now accept an `OutPoint` instead of a hash:index. Which let me cleanup a bunch of extra code.\r\n\r\n6) Speeded up the wallet 'GetAvailableBalance': filtering `AvailableCoins` by spendable outputs only and using the 'AvailableCoins' retrieved `total_amount` instead of looping over all the retrieved coins once more.\r\n\r\n-------------------------------------------------------\r\n\r\nSide topic, all this process will look even nicer with #25218",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 12,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25005",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25005",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25005.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25005.patch"
          },
          "closed_at": "2022-06-17T22:03:07Z",
          "created_at": "2022-04-27T15:09:06Z",
          "updated_at": "2023-05-27T01:51:51Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1117544016,
      "node_id": "IC_kwDOABII585CnF5Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1117544016",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-04T16:14:01Z",
      "updated_at": "2022-05-04T16:14:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nThe second commit (68d96078714c1ed1804c293a2f05c3fb33092efa) doesn't compile due to the `allow_mixed_output_types` optional argument to `AttemptSelection()`. Fixed in the third commit, but it's good if each commit compiles.\r\n\r\nI would favor making `allow_mixed_output_types` non-optional.",
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1117544016",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "commented",
      "id": 1117547775,
      "node_id": "IC_kwDOABII585CnGz_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1117547775",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-04T16:17:49Z",
      "updated_at": "2022-05-04T16:17:49Z",
      "author_association": "MEMBER",
      "body": "> Concept ACK\r\n> \r\n> The second commit ([68d9607](https://github.com/bitcoin/bitcoin/commit/68d96078714c1ed1804c293a2f05c3fb33092efa)) doesn't compile due to the `allow_mixed_output_types` optional argument to `AttemptSelection()`. Fixed in the third commit, but it's good if each commit compiles.\r\n\r\nah, good catch! i must have broken it when trying to break up the commits more cleanly. \r\n\r\n> I would favor making `allow_mixed_output_types` non-optional.\r\n\r\ncan you explain a bit more what you mean by this?",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1117547775",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "commented",
      "id": 1117564294,
      "node_id": "IC_kwDOABII585CnK2G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1117564294",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-04T16:34:24Z",
      "updated_at": "2022-05-04T16:34:24Z",
      "author_association": "CONTRIBUTOR",
      "body": "> can you explain a bit more what you mean by this?\r\n\r\nIt's just that I prefer code to be more explicit rather than hidden. Optional arguments are good if an existing function has many callers, and it would be disruptive to change all of them. In this case, all the calls (except one in src/bench) are in the same file (spend.cpp), so it wouldn't be much to update the callers. But this is just a suggestion.",
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1117564294",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "commented",
      "id": 1117580305,
      "node_id": "IC_kwDOABII585CnOwR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1117580305",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-04T16:51:51Z",
      "updated_at": "2022-05-04T16:51:51Z",
      "author_association": "MEMBER",
      "body": "> It's just that I prefer code to be more explicit rather than hidden\r\n\r\nthis is a great point. ill update when fixing the compile issue",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1117580305",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "comment_deleted",
      "id": 6554269955,
      "node_id": "CDE_lADOABII585FzCTjzwAAAAGGqjkD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6554269955",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-05T07:16:48Z"
    },
    {
      "event": "comment_deleted",
      "id": 6554270357,
      "node_id": "CDE_lADOABII585FzCTjzwAAAAGGqjqV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6554270357",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-05T07:16:53Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6556231231,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGGyCY_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6556231231",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-05T12:44:30Z"
    },
    {
      "event": "commented",
      "id": 1118508095,
      "node_id": "IC_kwDOABII585CqxQ_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1118508095",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-05T12:50:08Z",
      "updated_at": "2022-05-05T12:50:08Z",
      "author_association": "MEMBER",
      "body": "fixed the compilation issue by my moving the `allow_mixed_output_types` bool to the correct commit and made the boolean non-optional (thanks @LarryRuane). having the bool non-optional helps the readability of the logic in coin selection.\r\n\r\nalso put the function comment changes for `AttemptSelection` in the correct commit.\r\n\r\n`git range-diff master 31895fb 12bb64f`",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1118508095",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 6556267760,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGGyLTw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6556267760",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-05T12:50:08Z"
    },
    {
      "event": "subscribed",
      "id": 6556267775,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGGyLT_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6556267775",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-05T12:50:08Z"
    },
    {
      "event": "comment_deleted",
      "id": 6558460989,
      "node_id": "CDE_lADOABII585FzCTjzwAAAAGG6iw9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6558460989",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-05T17:46:27Z"
    },
    {
      "event": "reviewed",
      "id": 963640800,
      "node_id": "PRR_kwDOABII5845b_3g",
      "url": null,
      "actor": null,
      "commit_id": "12bb64f9fcd11207e5996e41204ab2ea822379c1",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept, tested, and mostly code review ACK 12bb64f9fcd11207e5996e41204ab2ea822379c1\r\nSuggestions are minor. I would like to get a better understanding of the algorithm by studying the functional test, so I may have a few more comments. But this looks very good! Thanks for hosting review club!",
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-963640800",
      "submitted_at": "2022-05-05T18:05:00Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "commented",
      "id": 1118926345,
      "node_id": "IC_kwDOABII585CsXYJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1118926345",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-05T18:40:38Z",
      "updated_at": "2022-05-05T18:40:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "The description has a typo (**Aproach**). Also, for future reference, my understanding is that the description (initial comment) should be fairly concise and mostly plaintext, because it ends up in the git commit history. It's probably better to make the detailed description a separate comment. It's probably too late here, because if you added a comment with details, it would end up at the bottom.",
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1118926345",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "reviewed",
      "id": 963741120,
      "node_id": "PRR_kwDOABII5845cYXA",
      "url": null,
      "actor": null,
      "commit_id": "12bb64f9fcd11207e5996e41204ab2ea822379c1",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "I like the new approach much better.\r\n\r\nIt seems to me that there should be some tests for the new AvailableCoins struct that ensures that all types get sorted into the right buckets. For example I would have hoped to see all types getting generated and seeing that all buckets were populated. This only happens indirectly right now, by testing whether there are mixed inputs when sweeping the wallet.\r\n\r\nAlso, I would prefer if all four types were tested instead of just two.",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-963741120",
      "submitted_at": "2022-05-05T20:14:17Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "commented",
      "id": 1120179874,
      "node_id": "IC_kwDOABII585CxJai",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1120179874",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-07T10:04:09Z",
      "updated_at": "2022-05-07T10:04:09Z",
      "author_association": "MEMBER",
      "body": "thanks for the review, @Xekyo !\r\n\r\n> it seems to me that there should be some tests for the new AvailableCoins struct that ensures that all types get sorted into the right buckets\r\n\r\nI am working on a unit test for `GetAvailableCoins` which covers this. I think a unit test is more appropriate than a functional test in this case. I was planning to add the unit test in a follow-up PR, but also happy to add it here, so long as this PR isn't getting too big\r\n\r\n> Also, I would prefer if all four types were tested instead of just two.\r\n\r\nI'll update the functional test, because agreed, no reason not to ",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1120179874",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 6567314093,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGHcUKt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6567314093",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-07T10:04:09Z"
    },
    {
      "event": "subscribed",
      "id": 6567314094,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGHcUKu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6567314094",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-07T10:04:09Z"
    },
    {
      "event": "commented",
      "id": 1120180360,
      "node_id": "IC_kwDOABII585CxJiI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1120180360",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-07T10:07:12Z",
      "updated_at": "2022-05-07T10:07:12Z",
      "author_association": "MEMBER",
      "body": "thanks for the review @LarryRuane and suggestions on code style!\r\n\r\n> be fairly concise and mostly plaintext, because it ends up in the git commit history.\r\n\r\ncompletely forgot about this, thanks for the reminder! ",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1120180360",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 6567317244,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGHcU78",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6567317244",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-07T10:07:13Z"
    },
    {
      "event": "subscribed",
      "id": 6567317245,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGHcU79",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6567317245",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-07T10:07:13Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6567437757,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGHcyW9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6567437757",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-07T12:22:48Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6567443280,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGHcztQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6567443280",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-07T12:29:25Z"
    },
    {
      "event": "commented",
      "id": 1120201987,
      "node_id": "IC_kwDOABII585CxO0D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1120201987",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-07T12:31:54Z",
      "updated_at": "2022-05-07T12:31:54Z",
      "author_association": "MEMBER",
      "body": "force pushed to address feedback from @Xekyo and @LarryRuane \r\n\r\n`git range-diff master 12bb64f f73e545`",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1120201987",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 6567445339,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGHc0Nb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6567445339",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-07T12:31:54Z"
    },
    {
      "event": "subscribed",
      "id": 6567445342,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGHc0Ne",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6567445342",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-07T12:31:54Z"
    },
    {
      "event": "mentioned",
      "id": 6567445344,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGHc0Ng",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6567445344",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-07T12:31:54Z"
    },
    {
      "event": "subscribed",
      "id": 6567445345,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGHc0Nh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6567445345",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-07T12:31:54Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6567454327,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGHc2Z3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6567454327",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-07T12:42:30Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-08T06:24:09Z",
      "updated_at": "2022-05-08T06:24:09Z",
      "source": {
        "issue": {
          "id": 1228732502,
          "node_id": "PR_kwDOABII5843dCPk",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25083",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25083/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25083/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25083/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25083",
          "number": 25083,
          "state": "closed",
          "state_reason": null,
          "title": "Set effective_value when initializing a COutput",
          "body": "Previously in COutput, effective_value was initialized as the absolute value of the txout and the fee as 0. effective_value along with the fee was calculated outside of the COutput constructor and set after the object had been initialized.\r\nThese changes will allow either the fee or the feerate to be passed in a COutput constructor and the fee and effective_value are calculated and set in the constructor. As a result, AvailableCoins also needs to be passed the feerate when utxos are being spent. When balance is calculated or the coins are being listed and feerate is neither available nor required, AvailableCoinsListUnspent is used instead, which runs AvailableCoins while providing the default value for `feerate`. Unit tests for the calculation of effective value have also been added.",
          "user": {
            "login": "ishaanam",
            "id": 75942586,
            "node_id": "MDQ6VXNlcjc1OTQyNTg2",
            "avatar_url": "https://avatars.githubusercontent.com/u/75942586?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ishaanam",
            "html_url": "https://github.com/ishaanam",
            "followers_url": "https://api.github.com/users/ishaanam/followers",
            "following_url": "https://api.github.com/users/ishaanam/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ishaanam/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ishaanam/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ishaanam/subscriptions",
            "organizations_url": "https://api.github.com/users/ishaanam/orgs",
            "repos_url": "https://api.github.com/users/ishaanam/repos",
            "events_url": "https://api.github.com/users/ishaanam/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ishaanam/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignee": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "assignees": [
            {
              "login": "achow101",
              "id": 3782274,
              "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
              "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/achow101",
              "html_url": "https://github.com/achow101",
              "followers_url": "https://api.github.com/users/achow101/followers",
              "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
              "organizations_url": "https://api.github.com/users/achow101/orgs",
              "repos_url": "https://api.github.com/users/achow101/repos",
              "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/achow101/received_events",
              "type": "User",
              "site_admin": false
            }
          ],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 9,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25083",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25083",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25083.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25083.patch"
          },
          "closed_at": "2022-05-23T16:55:48Z",
          "created_at": "2022-05-07T22:00:44Z",
          "updated_at": "2023-06-23T10:07:52Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6607088169,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGJ0Cop",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6607088169",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-13T16:33:34Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6607103688,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGJ0GbI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6607103688",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-13T16:36:02Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6607269247,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGJ0u1_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6607269247",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-13T17:06:41Z"
    },
    {
      "event": "commented",
      "id": 1126272535,
      "node_id": "IC_kwDOABII585DIY4X",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1126272535",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-13T17:15:11Z",
      "updated_at": "2022-05-13T17:15:11Z",
      "author_association": "MEMBER",
      "body": "updated with a unit test for `GetAvailableCoins` and changed the logic to allow mixing `OutputTypes` before spending unconfirmed change (thanks @Xekyo for the detailed explanation on this), along with a few other stylistic changes.",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1126272535",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 6607309587,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGJ04sT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6607309587",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-13T17:15:11Z"
    },
    {
      "event": "subscribed",
      "id": 6607309595,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGJ04sb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6607309595",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-13T17:15:11Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6607358067,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGJ1Ehz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6607358067",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-13T17:25:22Z"
    },
    {
      "event": "reviewed",
      "id": 974551199,
      "node_id": "PRR_kwDOABII5846Fnif",
      "url": null,
      "actor": null,
      "commit_id": "59966ad7dbb036dd0065ee31781f22114eca3dc2",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-974551199",
      "submitted_at": "2022-05-16T21:13:38Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-19T15:52:49Z",
      "updated_at": "2022-05-19T15:52:49Z",
      "source": {
        "issue": {
          "id": 1234103780,
          "node_id": "PR_kwDOABII5843ugyU",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25118",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25118/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25118/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25118/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25118",
          "number": 25118,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: unify allow/block other inputs concept",
          "body": "Seeking to make the `CoinControl` options less confusing/redundant.\r\nIt should have no functional changes.\r\n\r\nThe too long to read technical description; remove `m_add_inputs`, we can use the already existent `fAllowOtherInputs` flag.\r\n\r\nIn #16377 the `CoinControl` flag m_add_inputs was added to tell the coin filtering and selection process two things:\r\n- Coin Filtering: Only use the provided inputs. Skip the Rest.\r\n- Coin Selection: Search the wtxs-outputs and append all the `CoinControl` internal and external selected outpoints to the selection result (skipping all the available output checks). Nothing else.\r\n\r\nMeanwhile, in `CoinControl` we already have a flag fAllowOtherInputs which is already saying:\r\n- Coin Filtering: Only use the provided inputs. Skip the Rest.\r\n- Coin Selection: If false, no selection process -> append all the `CoinControl` selected outpoints to the selection result (while they passed all the `AvailableCoins` checks and are available in the 'vCoins' vector).\r\n\r\n### Changes\r\n\r\nAs can notice, the first point in the coin filtering process is duplicated in the two option flags. And the second one, is slightly different merely because it takes into account whether the coin is on the `AvailableCoins` vector or not.\r\nSo it makes sense to merge m_add_inputs and fAllowOtherInputs into a single field for the coin filtering process while introduce other changes to add the missing/skipped internal and external coins into 'vCoins' vector if they were manually selected by the user.\r\n\r\n\r\n\r\nJust as an extra note:\r\nOn top of this, Im working on unifying/untangling further the coin filtering and selection processes so we have less duplicate functionality in both processes.",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 19,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25118",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25118",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25118.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25118.patch"
          },
          "closed_at": "2022-06-20T19:38:19Z",
          "created_at": "2022-05-12T14:49:17Z",
          "updated_at": "2023-03-23T14:57:20Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 6663467912,
      "node_id": "LE_lADOABII585FzCTjzwAAAAGNLHOI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6663467912",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-23T18:52:40Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-05-25T18:55:02Z",
      "updated_at": "2022-05-25T18:55:02Z",
      "source": {
        "issue": {
          "id": 1248570790,
          "node_id": "PR_kwDOAq6-K844eDOS",
          "url": "https://api.github.com/repos/achow101/bitcoin/issues/10",
          "repository_url": "https://api.github.com/repos/achow101/bitcoin",
          "labels_url": "https://api.github.com/repos/achow101/bitcoin/issues/10/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/achow101/bitcoin/issues/10/comments",
          "events_url": "https://api.github.com/repos/achow101/bitcoin/issues/10/events",
          "html_url": "https://github.com/achow101/bitcoin/pull/10",
          "number": 10,
          "state": "closed",
          "state_reason": null,
          "title": "update sim_coinselect.py to allow different output types",
          "body": "used for specifying weights for each address type. this is for testing #24584\r\n\r\n<!--\r\n*** Please remove the following help text before submitting: ***\r\n\r\nPull requests without a rationale and clear improvement may be closed\r\nimmediately.\r\n\r\nGUI-related pull requests should be opened against\r\nhttps://github.com/bitcoin-core/gui\r\nfirst. See CONTRIBUTING.md\r\n-->\r\n\r\n<!--\r\nPlease provide clear motivation for your patch and explain how it improves\r\nBitcoin Core user experience or Bitcoin Core developer experience\r\nsignificantly:\r\n\r\n* Any test improvements or new tests that improve coverage are always welcome.\r\n* All other changes should have accompanying unit tests (see `src/test/`) or\r\n  functional tests (see `test/`). Contributors should note which tests cover\r\n  modified code. If no tests exist for a region of modified code, new tests\r\n  should accompany the change.\r\n* Bug fixes are most welcome when they come with steps to reproduce or an\r\n  explanation of the potential issue as well as reasoning for the way the bug\r\n  was fixed.\r\n* Features are welcome, but might be rejected due to design or scope issues.\r\n  If a feature is based on a lot of dependencies, contributors should first\r\n  consider building the system outside of Bitcoin Core, if possible.\r\n* Refactoring changes are only accepted if they are required for a feature or\r\n  bug fix or otherwise improve developer experience significantly. For example,\r\n  most \"code style\" refactoring changes require a thorough explanation why they\r\n  are useful, what downsides they have and why they *significantly* improve\r\n  developer experience or avoid serious programming bugs. Note that code style\r\n  is often a subjective matter. Unless they are explicitly mentioned to be\r\n  preferred in the [developer notes](/doc/developer-notes.md), stylistic code\r\n  changes are usually rejected.\r\n-->\r\n\r\n<!--\r\nBitcoin Core has a thorough review process and even the most trivial change\r\nneeds to pass a lot of eyes and requires non-zero or even substantial time\r\neffort to review. There is a huge lack of active reviewers on the project, so\r\npatches often sit for a long time.\r\n-->\r\n",
          "user": {
            "login": "josibake",
            "id": 7444140,
            "node_id": "MDQ6VXNlcjc0NDQxNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/josibake",
            "html_url": "https://github.com/josibake",
            "followers_url": "https://api.github.com/users/josibake/followers",
            "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
            "organizations_url": "https://api.github.com/users/josibake/orgs",
            "repos_url": "https://api.github.com/users/josibake/repos",
            "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/josibake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "NONE",
          "locked": false,
          "comments": 2,
          "pull_request": {
            "url": "https://api.github.com/repos/achow101/bitcoin/pulls/10",
            "html_url": "https://github.com/achow101/bitcoin/pull/10",
            "diff_url": "https://github.com/achow101/bitcoin/pull/10.diff",
            "patch_url": "https://github.com/achow101/bitcoin/pull/10.patch"
          },
          "closed_at": "2022-06-09T16:25:14Z",
          "created_at": "2022-05-25T18:55:02Z",
          "updated_at": "2024-01-26T10:51:13Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6777904770,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGT_p6C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6777904770",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-09T13:18:27Z"
    },
    {
      "event": "commented",
      "id": 1151122713,
      "node_id": "IC_kwDOABII585EnL0Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1151122713",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-09T13:30:21Z",
      "updated_at": "2022-06-09T13:30:21Z",
      "author_association": "MEMBER",
      "body": "rebased and responded to feedback from @achow101, specifically, fixing the logic for how P2SH is handled when running available coins. \r\n\r\nI am confident this logic is correct for the standard output types (bech32m, bech32, p2sh-segwit, legacy), which covers > 95% of UTXOs (per https://transactionfee.info/charts/inputs-types-by-count/). I'd like to add more test cases for P2SH, but not considering that a blocker for right now",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1151122713",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 6778003911,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGUACHH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6778003911",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-09T13:30:21Z"
    },
    {
      "event": "subscribed",
      "id": 6778003923,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGUACHT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6778003923",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-09T13:30:21Z"
    },
    {
      "event": "unlabeled",
      "id": 6778925976,
      "node_id": "UNLE_lADOABII585FzCTjzwAAAAGUDjOY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6778925976",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-09T15:15:59Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-09T21:15:22Z",
      "updated_at": "2022-06-09T21:15:22Z",
      "source": {
        "issue": {
          "id": 1258250629,
          "node_id": "PR_kwDOABII5844-uf3",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25269",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25269/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25269/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25269/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25269",
          "number": 25269,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: re-activate the not triggered  \"AmountWithFeeExceedsBalance\" error",
          "body": "Please review #25806 first.\r\n\r\nCame up during a talk with @theStack: the `AmountWithFeeExceedsBalance` error inside `WalletModel:prepareTransaction` is never been thrown.\r\n\r\nThe explanation for it: `createTransaction` does not retrieve the fee if the process fail for insufficient funds (fee return argument is set only at the bottom of the process, when the transaction creation success). So, if the tx creation fails, it's not available inside `WalletModel::prepareTransaction` to be able to throw the `AmountWithFeeExceedsBalance` .\r\n\r\nThis PR re-implements the feature properly, inside `createTransaction` and add test coverage for it.",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 9,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25269",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25269",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25269.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25269.patch"
          },
          "closed_at": "2023-06-22T02:55:30Z",
          "created_at": "2022-06-02T14:17:15Z",
          "updated_at": "2023-06-22T02:55:30Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 1006463492,
      "node_id": "PRR_kwDOABII5847_WoE",
      "url": null,
      "actor": null,
      "commit_id": "c73671a41d4fc2c3258de1dbd33c0dbf3a6f326c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Looks pretty good, I think I'd consider this ready if the unnecessary additional back-off were removed.",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-1006463492",
      "submitted_at": "2022-06-14T20:52:14Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "labeled",
      "id": 6831866495,
      "node_id": "LE_lADOABII585FzCTjzwAAAAGXNgJ_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6831866495",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-17T22:57:21Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6834733412,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGXYcFk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6834733412",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-19T13:19:08Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6834759780,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGXYihk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6834759780",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-19T13:42:07Z"
    },
    {
      "event": "commented",
      "id": 1159732813,
      "node_id": "IC_kwDOABII585FIB5N",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1159732813",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-19T13:53:01Z",
      "updated_at": "2022-06-19T13:53:01Z",
      "author_association": "MEMBER",
      "body": "force-pushed for rebase (pretty big rebase following #25005) and also to address feedback from @Xekyo \r\n\r\na few notes:\r\n- after #25005 , it made more sense to leave the function named `AvailableCoins` (as opposed to changing it to `GetAvailableCoins`)\r\n- `available_coins` is the preferred variable name throughout (vs `coin`, `available`, `availableCoins`, `vCoins`, etc)\r\n- dropped a refactor commit after removing the extraneous step in the back-offs \r\n- fixed the functional test to be more clear and removed the unconfirmed tx test as mixing is allowed before spending unconfirmed change\r\n- fixed an error in `bench/coin_selection.cpp` after making `allow_mixed_output_types` boolean required for the function call",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1159732813",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 6834771985,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGXYlgR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6834771985",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-19T13:53:02Z"
    },
    {
      "event": "subscribed",
      "id": 6834771986,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGXYlgS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6834771986",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-19T13:53:02Z"
    },
    {
      "event": "unlabeled",
      "id": 6834820288,
      "node_id": "UNLE_lADOABII585FzCTjzwAAAAGXYxTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6834820288",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-19T14:32:57Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1012298271,
      "node_id": "PRR_kwDOABII5848VnIf",
      "url": null,
      "actor": null,
      "commit_id": "eca95887a541314e45c296a09faca2f22d154934",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Some initial, code-only, feedback so we can eliminate duplicated operations/code across the different vectors calls:\r\n\r\nWhat about using a single `map<OutputType, std::vector>` instead of have one vector definition per output type and encapsulate the vector push, shuffle and erase inside the `CoinsResult::push_back`, `CoinsResult::shuffle` and `CoinsResult::erase`  methods?\r\n\r\nChanges:\r\n\r\nFor d8cd07ec > https://github.com/furszy/bitcoin-core/commit/d28e2cacae5a12b34c1f87de7815462e6380b779\r\n\r\n\r\nFor 38295279 > https://github.com/furszy/bitcoin-core/commit/a5d4461eb30ad2da63a30a103ec16853689e3d38\r\n\r\n\r\nFor 27195339 > https://github.com/furszy/bitcoin-core/commit/49a045ac91c48a94573bde937d99e78b13167f09\r\n\r\n\r\nFor eca95887 > https://github.com/furszy/bitcoin-core/commit/f3d02885ec8a02dde5cf1721602a846bfbe0dfdb\r\n\r\n\r\n\r\nThen another point is that the bench binary isnt compiling:\r\n Need to add the new flag `allow_mixed_output_types` to `src/bench/coin_selection.cpp`, line 78. ",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-1012298271",
      "submitted_at": "2022-06-20T17:19:01Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "labeled",
      "id": 6841793026,
      "node_id": "LE_lADOABII585FzCTjzwAAAAGXzXoC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6841793026",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-20T19:54:06Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1161697801,
      "node_id": "IC_kwDOABII585FPhoJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1161697801",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-21T12:43:04Z",
      "updated_at": "2022-06-21T12:43:04Z",
      "author_association": "MEMBER",
      "body": "> Then another point is that the bench binary isnt compiling:\r\n> Need to add the new flag allow_mixed_output_types to src/bench/coin_selection.cpp, line 78.\r\n\r\nhey @furszy ! thanks for the review. still looking through your suggestions, but in the meantime, it looks like you might have an outdated branch. the flag for `bench/coin_selection.cpp` was added in https://github.com/bitcoin/bitcoin/pull/24584/commits/27195339c202d280e2c148b39c7ebaf1afbd24dd and i also just confirmed each commit compiles locally\r\n",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1161697801",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 6847107443,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGYHpFz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6847107443",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-21T12:43:04Z"
    },
    {
      "event": "subscribed",
      "id": 6847107453,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGYHpF9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6847107453",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-21T12:43:04Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6850159919,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGYTSUv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6850159919",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-21T18:57:01Z"
    },
    {
      "event": "unlabeled",
      "id": 6850208769,
      "node_id": "UNLE_lADOABII585FzCTjzwAAAAGYTeQB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6850208769",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-21T19:04:13Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6854729010,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGYkt0y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6854729010",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T09:40:32Z"
    },
    {
      "event": "commented",
      "id": 1162886423,
      "node_id": "IC_kwDOABII585FUD0X",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1162886423",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T09:46:50Z",
      "updated_at": "2022-06-22T09:47:28Z",
      "author_association": "MEMBER",
      "body": "rebased off master and took suggestions from @furszy (thanks for the review!); `git range-diff master eca9588 e04037c`\r\n\r\n> What about using a single map<OutputType, std::vector> instead of have one vector definition per output type and encapsulate the vector push, shuffle and erase inside the CoinsResult::push_back, CoinsResult::shuffle and CoinsResult::erase methods?\r\n\r\nthis is how i originally started prototyping this, but i realized there are quite a few places outside of coin selection that use the `OutputTypes` enum and decided against adding an \"OTHER\" `OutputType`. i do think your suggested approach  is better, but merits its own discussion in a follow-up PR. i also think we could improve the mapping from `TxoutType -> OutputType` in the same follow up (or a separate one)",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1162886423",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 6854774942,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGYk5Ce",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6854774942",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T09:46:50Z"
    },
    {
      "event": "subscribed",
      "id": 6854774949,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGYk5Cl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6854774949",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T09:46:51Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6854952707,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGYlkcD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6854952707",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T10:10:54Z"
    },
    {
      "event": "commented",
      "id": 1162911662,
      "node_id": "IC_kwDOABII585FUJ-u",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1162911662",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T10:12:50Z",
      "updated_at": "2022-06-22T11:22:33Z",
      "author_association": "MEMBER",
      "body": "small fix-up on the functional test removing some unneeded lines; `git range-diff master e04037c 7dfac26`",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1162911662",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6855419454,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGYnWY-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6855419454",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-22T11:21:37Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6873330056,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGZrrGI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6873330056",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-24T10:42:36Z"
    },
    {
      "event": "commented",
      "id": 1165448264,
      "node_id": "IC_kwDOABII585Fd1RI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1165448264",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-24T10:43:31Z",
      "updated_at": "2022-06-24T10:43:31Z",
      "author_association": "MEMBER",
      "body": "rebased master and force pushed to fix a ci issue",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1165448264",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "reviewed",
      "id": 1019324006,
      "node_id": "PRR_kwDOABII5848waZm",
      "url": null,
      "actor": null,
      "commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review ACK 838685a4d018961dcd8315a59028aaa262b61916\r\nLooks very good. My suggestions are all nits. I don't really understand the wallet code well; my review is pretty superficial so don't put much weight on my ACK.",
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-1019324006",
      "submitted_at": "2022-06-25T22:38:11Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "commented",
      "id": 1166432804,
      "node_id": "IC_kwDOABII585Fhlok",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1166432804",
      "actor": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-26T06:54:19Z",
      "updated_at": "2022-06-26T06:57:54Z",
      "author_association": "NONE",
      "body": "> Leaking information in a later transaction\r\n\r\nConcept ACK for fixing this\r\n\r\n> Accumulating older OutputType UTXOs\r\n\r\nNot sure about this because average users will use bech32/bech32m addresses. If some users prefer other addresses then it should be okay to accumulate other types in the wallet.\r\n\r\nStill need to review and test the approach. My first reaction after looking at the diagram was if the transaction has mixed inputs, will it be okay to use mixed outputs?\r\n\r\n![mixinmixout](https://user-images.githubusercontent.com/94559964/175802998-d7a3c840-5754-4575-8902-88c90fb8ab7d.png)\r\n\r\nOr never use mixed inputs in a transaction?\r\n",
      "user": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1166432804",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-27T16:16:51Z",
      "updated_at": "2022-06-27T16:16:51Z",
      "source": {
        "issue": {
          "id": 1285405425,
          "node_id": "PR_kwDOABII5846ZT20",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25481",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25481/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25481/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25481/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25481",
          "number": 25481,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: unify max signature logic",
          "body": "Currently `DummySignTx` and `DummySignInput` use different ways to determine signature size.\r\nThis PR unifies the way wallet estimates signature size for various inputs. \r\nInstead of passing boolean flags from calling code the `use_max_sig` is now calculated at the place of signature creation using information available in `CCoinControl`",
          "user": {
            "login": "S3RK",
            "id": 1466284,
            "node_id": "MDQ6VXNlcjE0NjYyODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/S3RK",
            "html_url": "https://github.com/S3RK",
            "followers_url": "https://api.github.com/users/S3RK/followers",
            "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
            "organizations_url": "https://api.github.com/users/S3RK/orgs",
            "repos_url": "https://api.github.com/users/S3RK/repos",
            "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/S3RK/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25481",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25481",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25481.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25481.patch"
          },
          "closed_at": "2022-07-08T14:27:47Z",
          "created_at": "2022-06-27T08:00:53Z",
          "updated_at": "2023-07-12T10:10:17Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 1020689658,
      "node_id": "PRR_kwDOABII58481nz6",
      "url": null,
      "actor": null,
      "commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "It would be nice to have a test for the backoff behavior where we don't do mixing of 6 conf funds.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-1020689658",
      "submitted_at": "2022-06-27T20:18:16Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "reviewed",
      "id": 1022229917,
      "node_id": "PRR_kwDOABII58487f2d",
      "url": null,
      "actor": null,
      "commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-1022229917",
      "submitted_at": "2022-06-28T19:48:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-30T20:00:08Z",
      "updated_at": "2022-06-30T20:00:08Z",
      "source": {
        "issue": {
          "id": 1289690968,
          "node_id": "PR_kwDOABII5846nkdi",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25507",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25507/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25507/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25507/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25507",
          "number": 25507,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: don't add change fee to target if subtracting fees from output",
          "body": "Change fee is payed by the recipient, so we don't need to add it to our target for coin selection.",
          "user": {
            "login": "S3RK",
            "id": 1466284,
            "node_id": "MDQ6VXNlcjE0NjYyODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/S3RK",
            "html_url": "https://github.com/S3RK",
            "followers_url": "https://api.github.com/users/S3RK/followers",
            "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
            "organizations_url": "https://api.github.com/users/S3RK/orgs",
            "repos_url": "https://api.github.com/users/S3RK/repos",
            "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/S3RK/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25507",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25507",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25507.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25507.patch"
          },
          "closed_at": "2022-07-06T15:01:38Z",
          "created_at": "2022-06-30T07:03:18Z",
          "updated_at": "2023-07-06T10:09:28Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1175282186,
      "node_id": "IC_kwDOABII585GDWIK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1175282186",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-05T16:53:29Z",
      "updated_at": "2022-07-05T16:53:29Z",
      "author_association": "MEMBER",
      "body": "> Not sure about this because average users will use bech32/bech32m addresses. If some users prefer other addresses then it should be okay to accumulate other types in the wallet.\r\n\r\nregardless of what the wallet default address type is, since https://github.com/bitcoin/bitcoin/pull/23789 , a user will accumulate non-default address types in their wallet based on the change address matching logic. this is the primary motivation for this PR. perhaps a better phrasing in the description would be \"non-default\" (instead of older types).",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1175282186",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6936269653,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGdbxNV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6936269653",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-05T17:34:26Z"
    },
    {
      "event": "commented",
      "id": 1175324748,
      "node_id": "IC_kwDOABII585GDghM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1175324748",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-05T17:37:52Z",
      "updated_at": "2022-07-05T17:37:52Z",
      "author_association": "MEMBER",
      "body": "sorry for the late response all, and thanks for the review! force-pushed to address feedback from @LarryRuane , @achow101 and @Xekyo ; changes can be verified with `git range-diff master 838685a 7f12300`",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1175324748",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 6936287619,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGdb1mD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6936287619",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-05T17:37:52Z"
    },
    {
      "event": "subscribed",
      "id": 6936287637,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGdb1mV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6936287637",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-05T17:37:52Z"
    },
    {
      "event": "mentioned",
      "id": 6936287649,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGdb1mh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6936287649",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-05T17:37:52Z"
    },
    {
      "event": "subscribed",
      "id": 6936287658,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGdb1mq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6936287658",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-05T17:37:52Z"
    },
    {
      "event": "mentioned",
      "id": 6936287672,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGdb1m4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6936287672",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-05T17:37:53Z"
    },
    {
      "event": "subscribed",
      "id": 6936287687,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGdb1nH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6936287687",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-05T17:37:53Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-06T15:38:43Z",
      "updated_at": "2022-07-06T15:38:43Z",
      "source": {
        "issue": {
          "id": 1243856335,
          "node_id": "PR_kwDOABII5844Oka6",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25183",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25183/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25183/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25183/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25183",
          "number": 25183,
          "state": "closed",
          "state_reason": null,
          "title": "rpc: Filter inputs by type during CoinSelection ",
          "body": "This PR adds a filter to the CoinControl to select only specific utxos by type. It allows the `fundrawtransaction` and `walletcreatefundedpsbt` rpc calls to filter inputs by type.\r\n\r\nCloses #25181.\r\n\r\n",
          "user": {
            "login": "aureleoules",
            "id": 22493292,
            "node_id": "MDQ6VXNlcjIyNDkzMjky",
            "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/aureleoules",
            "html_url": "https://github.com/aureleoules",
            "followers_url": "https://api.github.com/users/aureleoules/followers",
            "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
            "organizations_url": "https://api.github.com/users/aureleoules/orgs",
            "repos_url": "https://api.github.com/users/aureleoules/repos",
            "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/aureleoules/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 16,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25183",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25183",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25183.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25183.patch"
          },
          "closed_at": "2022-12-08T12:22:12Z",
          "created_at": "2022-05-21T03:44:14Z",
          "updated_at": "2023-12-08T12:21:35Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 6944595524,
      "node_id": "LE_lADOABII585FzCTjzwAAAAGd7h5E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6944595524",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-06T17:05:03Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6951096397,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGeUVBN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6951096397",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-07T12:03:09Z"
    },
    {
      "event": "commented",
      "id": 1177501508,
      "node_id": "IC_kwDOABII585GLz9E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177501508",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-07T12:04:13Z",
      "updated_at": "2022-07-07T12:04:13Z",
      "author_association": "MEMBER",
      "body": "force pushed for rebase; `git range-diff master 7f12300 2e30c09`",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1177501508",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "unlabeled",
      "id": 6952127345,
      "node_id": "UNLE_lADOABII585FzCTjzwAAAAGeYQtx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6952127345",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-07T14:01:07Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1177977052,
      "node_id": "IC_kwDOABII585GNoDc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177977052",
      "actor": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-07T17:34:21Z",
      "updated_at": "2022-07-07T17:34:21Z",
      "author_association": "NONE",
      "body": "> > Not sure about this because average users will use bech32/bech32m addresses. If some users prefer other addresses then it should be okay to accumulate other types in the wallet.\r\n> \r\n> regardless of what the wallet default address type is, since #23789 , a user will accumulate non-default address types in their wallet based on the change address matching logic. this is the primary motivation for this PR. perhaps a better phrasing in the description would be \"non-default\" (instead of older types).\r\n\r\nIt happens only when user sends bitcoin to non-default type. This was my point in the quoted part of comment.",
      "user": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1177977052",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "commented",
      "id": 1177991068,
      "node_id": "IC_kwDOABII585GNrec",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177991068",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-07T17:45:46Z",
      "updated_at": "2022-07-07T17:45:46Z",
      "author_association": "MEMBER",
      "body": "> It happens only when user sends bitcoin to non-default type. This was my point in the quoted part of comment.\r\n\r\ngotcha, i think we are on the same page, unless i am misunderstanding your comment. my point was this is not related to average user behavior. for example:\r\n\r\nif i have P2PKH as my default and i regularly pay to bech32/bech32m addresses, i will begin to accumulate non-default UTXOs in my wallet, which might be undesirable for me, the user.\r\n\r\nalthough, reading this again, that section of the description is a bit outdated. originally, i implemented this to prefer spending \"older types\" first, but it was pointed out by other reviewers that it would be better to always spend the most economical UTXOs without forcing an ordering by `OutputType`. ill update the the description to remove references to older type UTXOs as that is not really the primary concern of this PR: the issue this PR addresses is the privacy leak that can happen when different type UTXOs are mixed when funding a transaction.",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1177991068",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "commented",
      "id": 1178203503,
      "node_id": "IC_kwDOABII585GOfVv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1178203503",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-07T20:42:21Z",
      "updated_at": "2022-07-07T20:42:21Z",
      "author_association": "MEMBER",
      "body": "ACK 2e30c09e1ec488a0bd22c88b7f79d8d1bc3b098e",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1178203503",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "labeled",
      "id": 6960936713,
      "node_id": "LE_lADOABII585FzCTjzwAAAAGe53cJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6960936713",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-08T15:12:42Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6976409271,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGf0463",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6976409271",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-12T10:27:04Z"
    },
    {
      "event": "commented",
      "id": 1181592712,
      "node_id": "IC_kwDOABII585GbayI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181592712",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-12T10:28:43Z",
      "updated_at": "2022-07-12T10:28:43Z",
      "author_association": "MEMBER",
      "body": "force-pushed for a rebase; `git range-diff master 2e30c09 6530d19`",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1181592712",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "unlabeled",
      "id": 6976679619,
      "node_id": "UNLE_lADOABII585FzCTjzwAAAAGf167D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6976679619",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-12T11:10:21Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1037679184,
      "node_id": "PRR_kwDOABII58492bpQ",
      "url": null,
      "actor": null,
      "commit_id": "6530d1950e6f6d5e1e64a2d59f244bb8c6b3996a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 6530d1950e6f6d5e1e64a2d59f244bb8c6b3996a\r\n\r\nGot a few nits pertaining to comments and descriptions mostly. The code appears ready to ship. I think that some readability improvements could be made in a follow-up especially for instances where the same operations is performed for each output type. Basically the idea that @LarryRuane suggested would also apply where `AttemptSelection()` is called. The output types could be put in a list and the `AttemptSelection()` call could be made for each of the listed output types.",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-1037679184",
      "submitted_at": "2022-07-13T18:06:08Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "commented",
      "id": 1188247460,
      "node_id": "IC_kwDOABII585G0zek",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1188247460",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-18T20:04:26Z",
      "updated_at": "2022-07-18T20:04:26Z",
      "author_association": "MEMBER",
      "body": "re-ACK 6530d1950e6f6d5e1e64a2d59f244bb8c6b3996a",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1188247460",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "commented",
      "id": 1188454272,
      "node_id": "IC_kwDOABII585G1l-A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1188454272",
      "actor": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T00:06:04Z",
      "updated_at": "2022-07-19T00:06:04Z",
      "author_association": "MEMBER",
      "body": "I believe this PR conflicts with master silently?\r\nI cannot compile the code when rebasing with master but do not get any merge conflicts.\r\nIt looks like the issue comes from the last commit 6530d1950e6f6d5e1e64a2d59f244bb8c6b3996a.",
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1188454272",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "reviewed",
      "id": 1042685819,
      "node_id": "PRR_kwDOABII584-Jh97",
      "url": null,
      "actor": null,
      "commit_id": "6530d1950e6f6d5e1e64a2d59f244bb8c6b3996a",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-1042685819",
      "submitted_at": "2022-07-19T00:23:58Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDJlNjcyOTFjYTNhYjJkOGY0OThmYTkxMDczOGNhNjU1ZmRlMTFjNWU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2e67291ca3ab2d8f498fa910738ca655fde11c5e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/2e67291ca3ab2d8f498fa910738ca655fde11c5e",
      "tree": {
        "sha": "bfd63274c0a07242a4912638a6f966b60daa24f6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bfd63274c0a07242a4912638a6f966b60daa24f6"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree bfd63274c0a07242a4912638a6f966b60daa24f6\nparent 948f5ba6363fcc64f95fed3f04dbda3d50d61827\nauthor josibake <josibake@protonmail.com> 1647012604 +0100\ncommitter josibake <josibake@protonmail.com> 1658237457 +0200\n\nrefactor: store by OutputType in CoinsResult\n\nStore COutputs by OutputType in CoinsResult.\n\nThe struct stores vectors of `COutput`s by `OutputType`\nfor more convenient access\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmLWshEACgkQity1WMTz\nPWVapQ//ezufMNu9IyKY2/Gv5+/xDfEhbPR7Z6rhANzduV923S9Zswi1p0zBDhQ2\ntPgeqaqKIwE/1Rw69Y3m1G6W/DkAl8NS0LYABelnxtUVA7VKGFLQM/GWW8I86vou\nKI72pmJiAWoGpv++IkG4B3KDuVghEd5GwMGp1SE3uG4WjJudLREPb8KFvKXWMstg\n3IkZzyPdqSGpJpzGnRugYe+RxZrl6VMMMK0ybYwA56gdGgVaSU8cYeCjYzwI0azd\nFvTQLei5mFwToOp3A92H+fS/L6MRFFYYgTJ9jfeAW/jtBwuWWVhUPfuTUkHsK0CT\nywYESwkv08yP9XeVmv5ca4WAvkO0kwqMd6nSOObu4ZJoWV3QohhAAOpcNdgaM7Ug\nx4eXWemopJLudaQco0cSMo+UZBLw+jMQGaYOpWzmyi6VoI2zjNyYtSFentkYOLUK\nI0SaZm39y6i/5RiIbdqFvxNrk98wepoJt9vfRSNxXQ0d0uq20DdeXe1ddjWKIYae\nfVyE0th1NOUMvgB7CtsvPBlsqiK/PAPpe8ti+nuKinMBw80+d8G8HjgsP21gD8rr\n+LBkQbDc9cMnx19/Tm4PiiMFUlQgPocs+auYEnqwl+k9PQNQQuc8WrN8KGjLo3xY\nnT8Mt1riPfeMtnXT4eDeJyd6EGKeAfACy1vBbd3o8IZQ5KstRIA=\n=ex6P\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/948f5ba6363fcc64f95fed3f04dbda3d50d61827",
          "sha": "948f5ba6363fcc64f95fed3f04dbda3d50d61827",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/948f5ba6363fcc64f95fed3f04dbda3d50d61827"
        }
      ],
      "message": "refactor: store by OutputType in CoinsResult\n\nStore COutputs by OutputType in CoinsResult.\n\nThe struct stores vectors of `COutput`s by `OutputType`\nfor more convenient access",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2022-07-19T13:30:57Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2022-03-11T15:30:04Z"
      },
      "sha": "2e67291ca3ab2d8f498fa910738ca655fde11c5e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc3YjA3MDcyMDYxYzU5ZjUwYzY5YmUyOWZiY2RkZjBkNDMzZTEwNzc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/77b07072061c59f50c69be29fbcddf0d433e1077",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/77b07072061c59f50c69be29fbcddf0d433e1077",
      "tree": {
        "sha": "685292ffae1fc58fac084c92eabb9e7e9cdf329f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/685292ffae1fc58fac084c92eabb9e7e9cdf329f"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 685292ffae1fc58fac084c92eabb9e7e9cdf329f\nparent 2e67291ca3ab2d8f498fa910738ca655fde11c5e\nauthor josibake <josibake@protonmail.com> 1650454638 +0200\ncommitter josibake <josibake@protonmail.com> 1658237457 +0200\n\nrefactor: use CoinsResult struct in SelectCoins\n\nPass the whole CoinsResult struct to SelectCoins instead of only a\nvector. This means we now have to remove preselected coins from each\nOutputType vector and shuffle each vector individually.\n\nPass the whole CoinsResult struct to AttemptSelection. This involves\nmoving the logic in AttemptSelection to a newly named function,\nChooseSelectionResult. This will allow us to run ChooseSelectionResult\nover each OutputType in a later commit. This ensures the backoffs work\nproperly.\n\nUpdate unit and bench tests to use CoinResult.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmLWshEACgkQity1WMTz\nPWVDPg//eMsxHqKWn0IsUC8hZpinE/QKgksy0FTC1toPDAz7N5/BwL7kPH+CrQMJ\nbEMAajZN8pQB1RY1XxrDnodA20uOeQOmSIWwLTeKBpRsF7jeyA7GdIahWHWEy7OF\nYFfxptuwR+518zR4FZO+iBP1NFQBa2fHzlQIXVDxOTgCDrz8G/3wATb1/mSN3N0t\nJz5bR9s+YWBeoJt6izjaCtUAp6Y6yYIp2J2i9G7G7i3Epyxh8EOv3ll4AyWO5nnc\nCCiMWwOJCIAfgeoI+iESbhKUnuBP8yttyeaxVBRdKVtd4nlWAUZeH8jaIaZeYxr0\n5dJv8Nqv103+pV/SQAIsVHNL/lRc+2k1du7sYbSUHuwVjNkI9zwsTR0MXCYuNeRz\nlXMw7wdEgB9oM1uMZvlGw92OPbOxie7Vq0rkksplzvb2Lq4C+sLJxEa9GhWGQM79\nmhDOxjLsTMy7BPwoah8wbiRCZ51lJlzJhFePYHJXqAVC+RHSCB4m/cx0L6oi2UMg\nxvRO5DjRVUUxqSo9RITHYpz0ELdQ/8kC/yoWHCM+7swDxFAOZuIaEBs7vVKZk0V1\nYLQrTOtCqB48E3CyM5rJ0YcVqTdzUNvluIDvyRQrOtzOGrdsnORf+OGeto7P7TV/\n4HX5q4ED/nCloh8odH71BbpEDHMBQPmB1cPP3NSyai7bb/zln7o=\n=wppV\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2e67291ca3ab2d8f498fa910738ca655fde11c5e",
          "sha": "2e67291ca3ab2d8f498fa910738ca655fde11c5e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2e67291ca3ab2d8f498fa910738ca655fde11c5e"
        }
      ],
      "message": "refactor: use CoinsResult struct in SelectCoins\n\nPass the whole CoinsResult struct to SelectCoins instead of only a\nvector. This means we now have to remove preselected coins from each\nOutputType vector and shuffle each vector individually.\n\nPass the whole CoinsResult struct to AttemptSelection. This involves\nmoving the logic in AttemptSelection to a newly named function,\nChooseSelectionResult. This will allow us to run ChooseSelectionResult\nover each OutputType in a later commit. This ensures the backoffs work\nproperly.\n\nUpdate unit and bench tests to use CoinResult.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2022-07-19T13:30:57Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2022-04-20T11:37:18Z"
      },
      "sha": "77b07072061c59f50c69be29fbcddf0d433e1077"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7021605508,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGihTKE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7021605508",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T15:07:38Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7021694124,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGihoys",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7021694124",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T15:18:18Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQzOGUwNDg0NWJmMzMwMmI3ZjQ1OWE1MGU4OGExYjc3MjUyN2YxZTY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/438e04845bf3302b7f459a50e88a1b772527f1e6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/438e04845bf3302b7f459a50e88a1b772527f1e6",
      "tree": {
        "sha": "03d7d123182583c6e46b6525dd806ed15b908c5b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/03d7d123182583c6e46b6525dd806ed15b908c5b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 03d7d123182583c6e46b6525dd806ed15b908c5b\nparent 77b07072061c59f50c69be29fbcddf0d433e1077\nauthor josibake <josibake@protonmail.com> 1648238260 +0100\ncommitter josibake <josibake@protonmail.com> 1658248935 +0200\n\nwallet: run coin selection by `OutputType`\n\nRun coin selection on each OutputType separately, choosing the best\nsolution according to the waste metric.\n\nThis is to avoid mixing UTXOs that are of different OutputTypes,\nwhich can hurt privacy.\n\nIf no single OutputType can fund the transaction, then coin selection\nconsiders the entire wallet, potentially mixing (current behavior).\n\nThis is done inside AttemptSelection so that all OutputTypes are\nconsidered at each back-off in coin selection.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmLW3ugACgkQity1WMTz\nPWUVQhAAyFgddWf9zILThkqT5/Y4Lpjc29viM6ZlWD5myT/+jAcF01t2u7pjIwJD\nDkI39effOXfPhBat/+SbHy3u5zzrsZ38IXv67l+EDdQbTYrnj0YLEyW6tOiLP4xr\n/WJcilR1m/EpynAyh/OZWVniZi/9kCFkrno7RKIE+l+66EN4HEcNPgqK44r2yDW7\nUfXLaeV6SpRvBsOTq75/uikGqX8/F69/dqqduVdSz/+yQGtaiZOZ/rvPFughshOf\nNrwzL+80PBDSms00wRAxyBNWKiveKkJbg5QL5jorFUTwEz8CGD/TY/iPLeqKWU4X\nI4RIzkyilCi2ZyqgKyOFL+se89p+nHbH/ExNNWSajB76bb/uxZHUOr8lo9m5Xc3F\n7ZDu3WqXFBTrA6Z1UUT0+i96iSzOSB6VpDWx/BjUcx5Zt/OJLj+s79NXTOq6Vm8d\nO2tQ9PChMaZAAG7G2vjzgpwxntn1Uw/MPzLTUJb56TeLYM2kQHcuceR3ymc9EkDV\nrY/Q9B3fWfaYn4dKX0nOxpFVtlRdsc9co7LAY5NSR7vgzoTPwCtbOmSannpBHl1H\na++ZljDt1vSrOevrmodUBDinTgMmgPG7z2sN2lg4vna/soF8ykGuILMLvqdK96d9\n0NMANrg3wn5AX4R5QS81GrjdQTLCjqpaeMfwrcPZKtOVDWaoPT0=\n=iN0+\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/77b07072061c59f50c69be29fbcddf0d433e1077",
          "sha": "77b07072061c59f50c69be29fbcddf0d433e1077",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/77b07072061c59f50c69be29fbcddf0d433e1077"
        }
      ],
      "message": "wallet: run coin selection by `OutputType`\n\nRun coin selection on each OutputType separately, choosing the best\nsolution according to the waste metric.\n\nThis is to avoid mixing UTXOs that are of different OutputTypes,\nwhich can hurt privacy.\n\nIf no single OutputType can fund the transaction, then coin selection\nconsiders the entire wallet, potentially mixing (current behavior).\n\nThis is done inside AttemptSelection so that all OutputTypes are\nconsidered at each back-off in coin selection.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2022-07-19T16:42:15Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2022-03-25T19:57:40Z"
      },
      "sha": "438e04845bf3302b7f459a50e88a1b772527f1e6"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGRhMDNjYjQxYTRjZTE1ZWJjZWVlN2ZhNGE0ZmRkMmQzNjAyZmUyODQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/da03cb41a4ce15ebceee7fa4a4fdd2d3602fe284",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/da03cb41a4ce15ebceee7fa4a4fdd2d3602fe284",
      "tree": {
        "sha": "5f7867c60ed58f0dee1289be522826a30537c2f5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5f7867c60ed58f0dee1289be522826a30537c2f5"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 5f7867c60ed58f0dee1289be522826a30537c2f5\nparent 438e04845bf3302b7f459a50e88a1b772527f1e6\nauthor josibake <josibake@protonmail.com> 1647282117 +0100\ncommitter josibake <josibake@protonmail.com> 1658248941 +0200\n\ntest: functional test for new coin selection logic\n\nCreate a wallet with mixed OutputTypes and send a volley of payments,\nensuring that there are no mixed OutputTypes in the txs. Finally,\nverify that OutputTypes are mixed only when necessary.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmLW3u0ACgkQity1WMTz\nPWVotg/9GrISZrVOMJAma5inD4cEjQSI6Tfh1HgvlXNLuA07Hnve6gYoTZL5UiYe\nNRydeNrR7cysT6ktNMzPHArrCO5/5rfSarIduWstc5GYEr8TXIPOy7IVw0skQ5lH\nGzDK/gUpnLBcgDdWYELbZjCVlPlIFkbkwze49cHeBbaEoooClkrQ1dbj7kiDJhcn\n+rASc0X5uy0nEp6KQkTJAnUNjt4AYZ3Cyx1KDDWpFxMQl6z9MsfCcw1+AXU41+JV\nGxe7fHrNgJ5jE/r0IRGy4cnijkYjn1W5SDOXo2P5VEHcTKcC4IBtmhixEaO/hxZT\n71nYCXjtdtR4QXo204g+galsGTiSNKIYz0wrwIGzuR7u7Qf9P+ObFhaApUt+BpjW\nzpQPUMvHlBrmiJ31fGPjpJmQYOQoUeKE2XPQW1/sLrc+T2PZA0vODwl2YWaEr7fj\npWJn1mEkY5FYibf0rzLIxzAbNwfM9G5v4j1Cv+BFNz+hYRqV64mWA8sySiydQrvQ\nWe4b6iUjUbm6joYl0Oq6OvSCElNRVZ9jqFdsfIMQd/scPS6V4snIIJFiqBWAj8Re\nTbcD1NFEjSE6RTwezI20Y/XqF8HUlKAC3w7eHgCWPA51t23ZKkjRY5KgBntcC8kO\n80WU6jZSIm8kMnvHaEvQo5rgYdXIOJZ2Q4cNsA6daSYztgiarP0=\n=Uvst\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/438e04845bf3302b7f459a50e88a1b772527f1e6",
          "sha": "438e04845bf3302b7f459a50e88a1b772527f1e6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/438e04845bf3302b7f459a50e88a1b772527f1e6"
        }
      ],
      "message": "test: functional test for new coin selection logic\n\nCreate a wallet with mixed OutputTypes and send a volley of payments,\nensuring that there are no mixed OutputTypes in the txs. Finally,\nverify that OutputTypes are mixed only when necessary.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2022-07-19T16:42:21Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2022-03-14T18:21:57Z"
      },
      "sha": "da03cb41a4ce15ebceee7fa4a4fdd2d3602fe284"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDcxZDFkMTM2MjdjY2QyNzMxOWYzNDdlMmQ4MTY3YzhmZThhNDMzZjQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "tree": {
        "sha": "13913653325bc1717dbb3594e73dc203b6a3b36a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/13913653325bc1717dbb3594e73dc203b6a3b36a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 13913653325bc1717dbb3594e73dc203b6a3b36a\nparent da03cb41a4ce15ebceee7fa4a4fdd2d3602fe284\nauthor josibake <josibake@protonmail.com> 1651931582 +0200\ncommitter josibake <josibake@protonmail.com> 1658248941 +0200\n\ntest: add unit test for AvailableCoins\n\ntest that UTXOs are bucketed correctly after\nrunning AvailableCoins\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmLW3u0ACgkQity1WMTz\nPWXdAA/+KnfPaVLYVAKdpA/LO4xdGwE9GnbVruKx5ktVWN7NnuQr8jZ6Zah9rDnC\ne9NuBhXVsx68tGHPi3qP9TN+rNGqYGZ4xOHrBkuxJbIOuxP+m6jH/VffOmhe29Ur\n18kR+ulHVYWkIS0wPBcgQXZRGyKUbdudP3+/VywuugVUgZAr0Muph73tlQ+tIS68\n5eDLRSinlHSR7VDy+v8XKYpagJlCelnSXXWHBJ5k03iy9rF350wXbFXFs5cdpcOQ\nCVDl5C2zZQXp+RlEoDw38iqEIJLC5bTafEU73PYt/40VN2MRIHxtpkstrJAGY6Qj\n0YWiJqnLpc+i5Phje4iRwkjC2cGTnxn5A7vaThellZgIQbbdAcTN9IyriDPZfTEu\nrgN1U8lcci070EWjLceROrT3rL63UoWTrk+62+H+ti4ZjKDi1NsJixV2cbytOL6S\n8oTGyMBFvgiH8mvuDJHOCYq4lhCBykoHuzgvHLpL45/62NulPZIwLE3iwmCDMEQ4\nX1+D0zdv6S/j8VQKsmqyJm4CDQJjXvNVek4cQh8K6IJrNOgPq9HSB3PXYQHAyqF7\nYvDExkcQKDl4bSHiHFhxVX61ATrv+brfdYrvDVsqG/3IhsTvvD75ZTWDKYs/dbXJ\nVrhn6DywTcz1ntmFlrv+bW7SyWh6AkBQ0xalFinig5QGRQzXHI0=\n=D5Bf\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/da03cb41a4ce15ebceee7fa4a4fdd2d3602fe284",
          "sha": "da03cb41a4ce15ebceee7fa4a4fdd2d3602fe284",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/da03cb41a4ce15ebceee7fa4a4fdd2d3602fe284"
        }
      ],
      "message": "test: add unit test for AvailableCoins\n\ntest that UTXOs are bucketed correctly after\nrunning AvailableCoins",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2022-07-19T16:42:21Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2022-05-07T13:53:02Z"
      },
      "sha": "71d1d13627ccd27319f347e2d8167c8fe8a433f4"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7022354322,
      "node_id": "HRFPE_lADOABII585FzCTjzwAAAAGikJ-S",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7022354322",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T16:43:05Z"
    },
    {
      "event": "commented",
      "id": 1189324138,
      "node_id": "IC_kwDOABII585G46Vq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1189324138",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T16:47:21Z",
      "updated_at": "2022-07-19T16:47:21Z",
      "author_association": "MEMBER",
      "body": "responded to review from @Xekyo , fixed the silent merge (thanks @aureleoules , @furszy ); `git range-diff master 6530d19 71d1d13`\r\n\r\n> I think that some readability improvements could be made in a follow-up especially for instances where the same operations is performed for each output type. Basically the idea that @LarryRuane suggested would also apply where AttemptSelection() is called. The output types could be put in a list and the AttemptSelection() call could be made for each of the listed output types.\r\n\r\ndefinitely agree! both @furszy and @LarryRuane had some great suggestions which id like to tackle in a follow-up",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1189324138",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 7022384636,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGikRX8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7022384636",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T16:47:21Z"
    },
    {
      "event": "subscribed",
      "id": 7022384644,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGikRYE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7022384644",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T16:47:21Z"
    },
    {
      "event": "mentioned",
      "id": 7022384657,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGikRYR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7022384657",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T16:47:22Z"
    },
    {
      "event": "subscribed",
      "id": 7022384659,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGikRYT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7022384659",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T16:47:22Z"
    },
    {
      "event": "mentioned",
      "id": 7022384665,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGikRYZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7022384665",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T16:47:22Z"
    },
    {
      "event": "subscribed",
      "id": 7022384674,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGikRYi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7022384674",
      "actor": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T16:47:22Z"
    },
    {
      "event": "mentioned",
      "id": 7022384687,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGikRYv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7022384687",
      "actor": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T16:47:22Z"
    },
    {
      "event": "subscribed",
      "id": 7022384690,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGikRYy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7022384690",
      "actor": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-19T16:47:22Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-20T10:51:17Z",
      "updated_at": "2022-07-20T10:51:17Z",
      "source": {
        "issue": {
          "id": 1310606684,
          "node_id": "PR_kwDOABII5847tYCg",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25647",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25647/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25647/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25647/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25647",
          "number": 25647,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: return change from SelectionResult",
          "body": "Benefits:\r\n1. more accurate waste calculation for knapsack. Waste calculation is now consistent with tx building code. Before we always assumed change for knapsack even when the solution is changeless4. \r\n2. simpler tx building code. Only create change output when it's needed\r\n3. makes it easier to correctly account for fees for CPFP inputs (should be done in a follow up) \r\n\r\nIn the first three commits we fix the code to accurately track selection target in `SelectionResult::m_target`\r\nThen we introduce new variable `min_change` that represents the minimum viable change amount\r\nThen we introduce `SelectionResult::GetChange()` which incapsulates dropping change for fee logic and uses correct values of `SelectionResult::m_target`\r\nThen we use `SelectionResult::GetChange()` in both tx building and waste calculation code\r\n\r\nThis PR is a refactoring and shouldn't change the behaviour.\r\nThere is only one known small change (arguably a bug fix). Before we dropped change output if it's smaller than `cost_of_change` after paying change fees. This is incorrect as `cost_of_change` already includes `change_fee`. ",
          "user": {
            "login": "S3RK",
            "id": 1466284,
            "node_id": "MDQ6VXNlcjE0NjYyODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/S3RK",
            "html_url": "https://github.com/S3RK",
            "followers_url": "https://api.github.com/users/S3RK/followers",
            "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
            "organizations_url": "https://api.github.com/users/S3RK/orgs",
            "repos_url": "https://api.github.com/users/S3RK/repos",
            "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/S3RK/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25647",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25647",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25647.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25647.patch"
          },
          "closed_at": "2022-08-22T16:43:27Z",
          "created_at": "2022-07-20T07:54:57Z",
          "updated_at": "2023-08-22T10:21:17Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 1044787748,
      "node_id": "PRR_kwDOABII584-RjIk",
      "url": null,
      "actor": null,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK 71d1d13627ccd27319f347e2d8167c8fe8a433f4.\r\n\r\nI believe the `CoinsResult` struct is much easier to work with than the previous coin vector.\r\nThis PR does seems to fix the privacy issue explained in the description.",
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-1044787748",
      "submitted_at": "2022-07-20T11:20:36Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-21T06:45:40Z",
      "updated_at": "2022-07-21T06:45:40Z",
      "source": {
        "issue": {
          "id": 1312335928,
          "node_id": "PR_kwDOABII5847zel_",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25659",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25659/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25659/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25659/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25659",
          "number": 25659,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: simplify ListCoins implementation",
          "body": "Focused on the following changes:\r\n\r\n1) Removed the entire locked coins lookup that was inside `ListCoins` by including them directly on the `AvailableCoins` result (where we were skipping them before).\r\n2) Unified both `FindNonChangeParentOutput` functions (only called from `ListCoins`)\r\n",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 12,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25659",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25659",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25659.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25659.patch"
          },
          "closed_at": "2023-01-18T19:27:09Z",
          "created_at": "2022-07-21T02:06:56Z",
          "updated_at": "2023-05-27T01:49:09Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1191209099,
      "node_id": "IC_kwDOABII585HAGiL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1191209099",
      "actor": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-21T08:39:57Z",
      "updated_at": "2022-07-21T08:39:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1191209099",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "commented",
      "id": 1191895126,
      "node_id": "IC_kwDOABII585HCuBW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1191895126",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-21T20:19:27Z",
      "updated_at": "2022-07-21T20:19:27Z",
      "author_association": "MEMBER",
      "body": "re-ACK 71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1191895126",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "reviewed",
      "id": 1047227855,
      "node_id": "PRR_kwDOABII584-a23P",
      "url": null,
      "actor": null,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "body": "Approach NACK\r\n\r\nI was not able to achieve the privacy mentioned in PR description. Steps to reproduce:\r\n\r\n1. Create a wallet w1, send 0.001 four times from signet faucet to bech32 addresses, wait for confirmation and spend more than 0.002 to a legacy address.\r\n2. There will be 2 UTXO in wallet: 1 legacy and other bech32\r\n3. Send more than 0.001 to a bech32 address\r\n\r\n\r\n\r\nExample:\r\n\r\nhttps://mempool.space/signet/tx/6bb60f7dd4171d915b615030bc3cd2af785188834f38f391aa6b28e6a5359ecb:0\r\n\r\nhttps://mempool.space/signet/tx/2cd2821390126c5407f29be8669c612a4092d0bc11224811a0752ff7fa31d43a\r\n\r\n---\r\n\r\nThis is a valid argument and there can be multiple interpretations even without coinjoin: https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-911639998\r\n\r\nAlso still curious about the two questions/solutions I had about solving this problem in https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1166432804\r\n\r\n",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-1047227855",
      "submitted_at": "2022-07-21T23:13:21Z",
      "state": "CHANGES_REQUESTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "commented",
      "id": 1192024390,
      "node_id": "IC_kwDOABII585HDNlG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1192024390",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-21T23:25:08Z",
      "updated_at": "2022-07-21T23:25:08Z",
      "author_association": "MEMBER",
      "body": "> Approach NACK\r\n> \r\n> I was not able to achieve the privacy mentioned in PR description. Steps to reproduce:\r\n> \r\n>     1. Create a wallet w1, send 0.001 four times from signet faucet to bech32 addresses, wait for confirmation and spend more than 0.002 to a legacy address.\r\n> \r\n>     2. There will be 2 UTXO in wallet: 1 legacy and other bech32\r\n> \r\n>     3. Send more than 0.001 to a bech32 address\r\n> \r\n> \r\n> Example:\r\n> \r\n> https://mempool.space/signet/tx/6bb60f7dd4171d915b615030bc3cd2af785188834f38f391aa6b28e6a5359ecb:0\r\n> \r\n> https://mempool.space/signet/tx/2cd2821390126c5407f29be8669c612a4092d0bc11224811a0752ff7fa31d43a\r\n\r\nI don't see how this example tests what is described in the OP? You ended up making a transaction that has mixed inputs, but the that's because those are the only funds in your wallet. The point of this PR is to *avoid* mixing input types, not *never* mix input types.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1192024390",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "commented",
      "id": 1192390318,
      "node_id": "IC_kwDOABII585HEm6u",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1192390318",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-22T09:47:38Z",
      "updated_at": "2022-07-22T09:47:38Z",
      "author_association": "MEMBER",
      "body": "hey @1440000bytes , thanks for testing! as mentioned, the goal is not to _never_ mix; the goal is to avoid mixing if possible. I've updated the OP to explicitly state this. also, take a look at the functional test, as this demonstrates the desired behavior: creating a wallet with mixed UTXO types, funding several transactions without mixing, and finally emptying the wallet (which is impossible to do without mixing).\r\n\r\n> This is a valid argument and there can be multiple interpretations even without coinjoin: https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-911639998\r\n\r\nwhile there can be other interpretations, the most likely interpretation today is that the non-default input in the subsequent transaction is the change from the previous transaction (and in the majority of cases, this interpretation is correct).\r\n\r\n> Also still curious about the two questions/solutions I had about solving this problem in https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1166432804\r\n\r\ni responded here: https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1177991068 , please let me know which parts of your original question you feel are unaddressed.\r\n",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1192390318",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "mentioned",
      "id": 7045208351,
      "node_id": "MEE_lADOABII585FzCTjzwAAAAGj7Vkf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7045208351",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-22T09:47:38Z"
    },
    {
      "event": "subscribed",
      "id": 7045208358,
      "node_id": "SE_lADOABII585FzCTjzwAAAAGj7Vkm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7045208358",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-22T09:47:38Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-23T15:16:33Z",
      "updated_at": "2022-07-23T15:16:33Z",
      "source": {
        "issue": {
          "id": 1315657410,
          "node_id": "PR_kwDOABII5847-7hZ",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25685",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25685/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25685/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25685/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25685",
          "number": 25685,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: Faster transaction creation by removing pre-set-inputs fetching responsibility from Coin Selection",
          "body": "#### # Context (Current Flow on Master)\r\n\r\nIn the transaction creation process, in order to select which coins the new transaction will spend,\r\nwe first obtain all the available coins known by the wallet, which means walking-through the\r\nwallet txes map, gathering the ones that fulfill certain spendability requirements in a vector.\r\n\r\nThis coins vector is then provided to the Coin Selection process, which first checks if the user\r\nhas manually selected any input (which could be internal, aka known by the wallet, or external),\r\nand if it does, it fetches them by searching each of them inside the wallet and/or inside the\r\nCoin Control external tx data.\r\n\r\nThen, after finding the pre-selected-inputs and gathering them in a vector, the Coin Selection\r\nprocess walks-through the entire available coins vector once more just to erase coins that are\r\nin both vectors. So the Coin Selection process doesnt pick them twice (duplicate inputs inside\r\nthe same transaction).\r\n\r\n#### # Process Workflow Changes\r\n\r\nNow, a new method, `FetchCoins` will be responsible for:\r\n1) Lookup the user pre-selected-inputs (which can be internal or external).\r\n2) And, fetch the available coins in the wallet (excluding the already fetched ones).\r\n\r\nWhich will occur prior to the Coin Selection process. Which allows us to never include the\r\npre-selected-inputs inside the available coins vector in the first place, as well as doing other\r\nnice improvements (written below).\r\n\r\nSo, Coin Selection can perform its main responsibility without mixing it with having to fetch\r\ninternal/external coins nor any slow and unneeded duplicate coins verification.\r\n\r\n#### # Summarizing the Improvements:\r\n\r\n1) If any pre-selected-input lookup fail, the process will return the error right away.\r\n    (before, the wallet was fetching all the wallet available coins, walking through the\r\n    entire txes map, and then failing for an invalid pre-selected-input inside SelectCoins)\r\n\r\n2) The pre-selected-inputs lookup failure causes are properly described on the return error.\r\n    (before, we were returning an \"Insufficient Funds\" error for everything, even if the failure\r\n    was due a not solvable external input)\r\n\r\n3) **Faster Coin Selection**: no longer need to \"remove the pre-set inputs from the available coins\r\n    vector so that Coin Selection doesn't pick them\" (which meant to loop-over the entire\r\n    available coins vector at Coin Selection time, erasing duplicate coins that were pre-selected).\r\n   \r\n    Now, the available coins vector, which is built after the pre-selected-inputs fetching,\r\n    doesnt include the already selected inputs in the first place.\r\n\r\n4) **Faster transaction creation** for transactions that only use manually selected inputs.\r\n\r\n    We now will return early, as soon as we finish fetching the pre-selected-inputs and\r\n    not perform the resources expensive calculation of walking-through the entire wallet\r\n    txes map to obtain the available coins (coins that we will not use).\r\n\r\n---------------------------\r\n\r\nAdded a new bench (f6d0bb2) measuring the transaction creation process, for a wallet with ~250k UTXO, only using the pre-selected-inputs inside coin control. Setting `m_allow_other_inputs=false` to disallow the wallet to include coins automatically.\r\n\r\n#### Result on this PR (tip f6d0bb2d):\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|        1,048,675.00 |              953.58 |    0.3% |      0.06 | `WalletCreateTransaction`\r\n\r\nvs\r\n\r\n#### Result on master (tip 4a4289e2):\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|       96,373,458.20 |               10.38 |    0.2% |      5.30 | `WalletCreateTransaction`\r\n\r\nThe benchmark took to run in master: **96.37 milliseconds**, while in this PR: **1 millisecond**   .",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 30,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25685",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25685",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25685.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25685.patch"
          },
          "closed_at": "2022-10-27T21:49:29Z",
          "created_at": "2022-07-23T13:19:19Z",
          "updated_at": "2023-05-27T01:48:36Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1195096253,
      "node_id": "IC_kwDOABII585HO7i9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1195096253",
      "actor": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-26T07:12:24Z",
      "updated_at": "2022-07-26T07:12:24Z",
      "author_association": "NONE",
      "body": "How about insufficient funds error message or use mixed output types for change? This could happen even when some transactions are unconfirmed and confirmed UTXOs are of different types ",
      "user": {
        "login": "ghost",
        "id": 10137,
        "node_id": "MDQ6VXNlcjEwMTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ghost",
        "html_url": "https://github.com/ghost",
        "followers_url": "https://api.github.com/users/ghost/followers",
        "following_url": "https://api.github.com/users/ghost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ghost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ghost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
        "organizations_url": "https://api.github.com/users/ghost/orgs",
        "repos_url": "https://api.github.com/users/ghost/repos",
        "events_url": "https://api.github.com/users/ghost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ghost/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1195096253",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "commented",
      "id": 1195886286,
      "node_id": "IC_kwDOABII585HR8bO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1195886286",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-26T19:21:28Z",
      "updated_at": "2022-07-26T19:21:28Z",
      "author_association": "CONTRIBUTOR",
      "body": "> How about insufficient funds error message or use mixed output types for change? This could happen even when some transactions are unconfirmed and confirmed UTXOs are of different types\r\n\r\nAn advanced user that cares so much about not mixing inputs is probably already using coin control to manually select inputs. I think this PR is a reasonable middle-path of rolling out a privacy improvement while minimizing negative impact on the UX. Adding cases in which transaction building fails while there are sufficient funds available as the default behavior would be an unreasonable UX disimprovement. I would consider the addition of options for more strict behavior to be out of scope for this PR.",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#issuecomment-1195886286",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24584"
    },
    {
      "event": "reviewed",
      "id": 1051520158,
      "node_id": "PRR_kwDOABII584-rOye",
      "url": null,
      "actor": null,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "reACK 71d1d13627ccd27319f347e2d8167c8fe8a433f4 via `git range-diff master 6530d19 71d1d13`",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-1051520158",
      "submitted_at": "2022-07-26T19:42:16Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T12:33:06Z",
      "updated_at": "2022-07-28T12:33:06Z",
      "source": {
        "issue": {
          "id": 1320863837,
          "node_id": "PR_kwDOABII5848PxGI",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25729",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25729/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25729/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25729/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25729",
          "number": 25729,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: Check max transaction weight in CoinSelection",
          "body": "This PR is an attempt to fix #5782.\r\n\r\nI have added 4 test scenarios, 3 of them provided here https://github.com/bitcoin/bitcoin/issues/5782#issuecomment-73819058 (slightly modified to use a segwit wallet).\r\n\r\nHere are my benchmarks : \r\n## PR\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|        1,466,341.00 |              681.97 |    0.6% |   11,176,762.00 |    3,358,752.00 |  3.328 |   1,897,839.00 |    0.3% |      0.02 | `CoinSelection`\r\n\r\n## Master\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|        1,526,029.00 |              655.30 |    0.5% |   11,142,188.00 |    3,499,200.00 |  3.184 |   1,994,156.00 |    0.2% |      0.02 | `CoinSelection`",
          "user": {
            "login": "aureleoules",
            "id": 22493292,
            "node_id": "MDQ6VXNlcjIyNDkzMjky",
            "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/aureleoules",
            "html_url": "https://github.com/aureleoules",
            "followers_url": "https://api.github.com/users/aureleoules/followers",
            "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
            "organizations_url": "https://api.github.com/users/aureleoules/orgs",
            "repos_url": "https://api.github.com/users/aureleoules/repos",
            "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/aureleoules/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 28,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25729",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25729",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25729.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25729.patch"
          },
          "closed_at": "2022-12-06T17:09:51Z",
          "created_at": "2022-07-28T12:33:06Z",
          "updated_at": "2024-01-12T12:24:53Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 1054745390,
      "node_id": "PRR_kwDOABII584-3iMu",
      "url": null,
      "actor": null,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 71d1d13627ccd27319f347e2d8167c8fe8a433f4\r\nVery nice! (one small suggestion is optional)",
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#pullrequestreview-1054745390",
      "submitted_at": "2022-07-28T21:44:30Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
    },
    {
      "event": "merged",
      "id": 7085380808,
      "node_id": "ME_lADOABII585FzCTjzwAAAAGmUlTI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7085380808",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "1abbae65eb9c99df5d8941008068d83ad99bf117",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1abbae65eb9c99df5d8941008068d83ad99bf117",
      "created_at": "2022-07-28T22:17:13Z"
    },
    {
      "event": "closed",
      "id": 7085380819,
      "node_id": "CE_lADOABII585FzCTjzwAAAAGmUlTT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7085380819",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T22:17:13Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-29T11:16:21Z",
      "updated_at": "2022-07-29T11:16:21Z",
      "source": {
        "issue": {
          "id": 1322119635,
          "node_id": "PR_kwDOABII5848T94k",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25734",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25734/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25734/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25734/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25734",
          "number": 25734,
          "state": "closed",
          "state_reason": null,
          "title": "wallet, refactor: #24584 follow-ups",
          "body": "This PR is to address follow-ups for #24584, specifically:\r\n\r\n* Remove redundant, hard-to-read code by adding a new `OutputType` and adding shuffle, erase, and push_back methods for `CoinsResult`\r\n* Add missing `BOOST_ASSERT` to unit test\r\n* Ensure functional test only runs if using descriptor wallets\r\n* Improve readability of `AttemptSelection` by removing triple-nested if statement\r\n\r\nNote for reviewers: commit `refactor: add new helper methods` should throw an \"unused function warning\"; the function is used in the next commit. Also, commit `wallet: switch to new shuffle, erase, push_back` will fail to compile, but this is fixed in the next commit with a scripted-diff. the commits are separate like this (code change then scripted-diff) to improve legibility.\r\n",
          "user": {
            "login": "josibake",
            "id": 7444140,
            "node_id": "MDQ6VXNlcjc0NDQxNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/josibake",
            "html_url": "https://github.com/josibake",
            "followers_url": "https://api.github.com/users/josibake/followers",
            "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
            "organizations_url": "https://api.github.com/users/josibake/orgs",
            "repos_url": "https://api.github.com/users/josibake/repos",
            "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/josibake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 11,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25734",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25734",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25734.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25734.patch"
          },
          "closed_at": "2022-08-17T00:00:45Z",
          "created_at": "2022-07-29T11:16:21Z",
          "updated_at": "2024-01-26T10:50:34Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-30T06:47:56Z",
      "updated_at": "2022-07-30T06:47:56Z",
      "source": {
        "issue": {
          "id": 1042666928,
          "node_id": "PR_kwDOABII584t_2tt",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23417",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23417/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23417/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23417/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/23417",
          "number": 23417,
          "state": "closed",
          "state_reason": null,
          "title": "wallet, spkm: Move key management from DescriptorScriptPubKeyMan to wallet level KeyManager",
          "body": "This PR changes DescriptorScriptPubKeyMan to no longer handle relevant keys directly. Instead all keys for all DescriptorSPKMs will be handled by a new `KeyManager` class which exists within `CWallet` (a reference to it is passed to each DescriptorSPKM). This allows us to have a concept of a wallet HD key for descriptor wallets. This makes it easier to add new single key descriptors that use the same HD master key as the rest of the autogenerated descriptors (e.g. for taproot). Multisigs will also be easier as an xpub belonging to the wallet can be exported without needing to do weird things like descriptor introspection and guessing about which descriptor's key to use.\r\n\r\n`KeyManager` is a class which handles all of the keys for DescriptorSPKMs. It contains the maps that hold the keys, deals with writing those keys to disk, and handles their encryption. Encryption keys are still managed by `CWallet` but provided to `KeyManager` through the `WalletStorage` interface. Signing is still done through `DescriptorScriptPubKeyMan::SignTransaction` however this will fetch the keys from `KeyManager` rather than storing keys in the DescriptorSPKM to be used.\r\n\r\nThis change is backwards compatible. Although `KeyManager` writes and uses keys in new `keyman_key` and `keyman_ckey` records, it will still write keys for each descriptor in `walletdescriptorkey` and `walletdescriptorckey` records. This allows a descriptor wallet created using this change to be opened by 22.0 and 0.21. Additionally, wallets created with older software will automatically be upgraded to using the `KeyManager` at first loading. This is done in the background and does not require any user interaction (i.e. no passphrase required).",
          "user": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 1482182044,
              "node_id": "MDU6TGFiZWwxNDgyMTgyMDQ0",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Descriptors",
              "name": "Descriptors",
              "description": "",
              "color": "e9f76c",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 24,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23417",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/23417",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/23417.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/23417.patch"
          },
          "closed_at": "2022-12-19T22:35:38Z",
          "created_at": "2021-11-02T18:11:16Z",
          "updated_at": "2023-12-19T12:22:37Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-02T04:02:38Z",
      "updated_at": "2022-08-02T04:02:38Z",
      "source": {
        "issue": {
          "id": 1320033247,
          "node_id": "PR_kwDOABII5848NBqe",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25721",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25721/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25721/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25721/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25721",
          "number": 25721,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Replace BResult with util::Result",
          "body": "Rename `BResult` class to `util::Result` and update the class interface to be more compatible with `std::optional` and with a full-featured result class implemented in https://github.com/bitcoin/bitcoin/pull/25665. Motivation for this change is to update existing `BResult` usages now so they don't have to change later when more features are added in https://github.com/bitcoin/bitcoin/pull/25665.\r\n\r\nThis change makes the following improvements originally implemented in https://github.com/bitcoin/bitcoin/pull/25665:\r\n\r\n- More explicit API. Drops potentially misleading `BResult` constructor that treats any bilingual string argument as an error. Adds `util::Error` constructor so it is never ambiguous when a result is being assigned an error or non-error value.\r\n\r\n- Better type compatibility. Supports `util::Result<bilingual_str>` return values to hold translated messages which are not errors.\r\n\r\n- More standard and consistent API. `util::Result` supports most of the same operators and methods as `std::optional`. `BResult` had a less familiar interface with `HasRes`/`GetObj`/`ReleaseObj` methods. The Result/Res/Obj naming was also not internally consistent.\r\n\r\n- Better code organization. Puts `src/util/` code in the `util::` namespace so naming reflects code organization and it is obvious where the class is coming from. Drops \"B\" from name because it is undocumented what it stands for (bilingual?)\r\n\r\n- Has unit tests.\r\n",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "milestone": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/54",
            "html_url": "https://github.com/bitcoin/bitcoin/milestone/54",
            "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/54/labels",
            "id": 7150037,
            "node_id": "MI_kwDOABII584AbRnV",
            "number": 54,
            "state": "closed",
            "title": "24.0",
            "description": "",
            "creator": {
              "login": "laanwj",
              "id": 126646,
              "node_id": "MDQ6VXNlcjEyNjY0Ng==",
              "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/laanwj",
              "html_url": "https://github.com/laanwj",
              "followers_url": "https://api.github.com/users/laanwj/followers",
              "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
              "organizations_url": "https://api.github.com/users/laanwj/orgs",
              "repos_url": "https://api.github.com/users/laanwj/repos",
              "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/laanwj/received_events",
              "type": "User",
              "site_admin": false
            },
            "open_issues": 0,
            "closed_issues": 159,
            "created_at": "2021-09-14T08:27:02Z",
            "updated_at": "2022-11-29T15:44:44Z",
            "closed_at": "2022-11-29T15:44:44Z"
          },
          "locked": true,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25721",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25721",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25721.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25721.patch"
          },
          "closed_at": "2022-08-05T13:36:19Z",
          "created_at": "2022-07-27T19:26:41Z",
          "updated_at": "2023-08-09T10:19:06Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-10T16:24:38Z",
      "updated_at": "2022-08-10T16:24:38Z",
      "source": {
        "issue": {
          "id": 1322628326,
          "node_id": "PR_kwDOABII5848VpLa",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25742",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25742/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25742/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25742/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25742",
          "number": 25742,
          "state": "closed",
          "state_reason": null,
          "title": "Use change amount as tiebreaker for SelectionResults",
          "body": "This amends the sorting operator for SelectionResults to prefer\r\n1) lower waste\r\n2) higher input count\r\n3) lower change amount (*new*)\r\n\r\nThe reasoning is that all other things equal, we want to send less funds into unconfirmed state and tell counter-parties less about the value in our wallet.\r\n\r\nBuilds on #25647. If you're interested in this change, please review that PR first.",
          "user": {
            "login": "murchandamus",
            "id": 4060799,
            "node_id": "MDQ6VXNlcjQwNjA3OTk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/murchandamus",
            "html_url": "https://github.com/murchandamus",
            "followers_url": "https://api.github.com/users/murchandamus/followers",
            "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
            "organizations_url": "https://api.github.com/users/murchandamus/orgs",
            "repos_url": "https://api.github.com/users/murchandamus/repos",
            "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/murchandamus/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25742",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25742",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25742.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25742.patch"
          },
          "closed_at": "2022-08-10T16:24:38Z",
          "created_at": "2022-07-29T19:58:53Z",
          "updated_at": "2023-08-10T10:19:21Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-10T16:50:02Z",
      "updated_at": "2022-08-10T16:50:02Z",
      "source": {
        "issue": {
          "id": 1332409874,
          "node_id": "PR_kwDOABII584817t0",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25806",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25806/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25806/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25806/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25806",
          "number": 25806,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: group outputs only once, decouple it from Coin Selection",
          "body": "The idea originates from https://github.com/bitcoin/bitcoin/pull/24845#issuecomment-1130310321.\r\n\r\nNote:\r\nFor clarity, it's recommended to start reviewing from the end result to understand the structure of the flow.\r\n\r\n#### GroupOutputs function rationale:\r\nIf \"Avoid Partial Spends\" is enabled, the function gathers outputs with the same script together inside a container. So Coin Selection can treats them as if them were just one possible input and either select them all or not select them. \r\n\r\n#### How the Inputs Fetch + Selection process roughly works:\r\n\r\n```\r\n1. Fetch users manually selected inputs.\r\n2. Fetch wallet available coins (walks through the entire wallet txes map) and insert them into a set of vectors (each vector store outputs from a single type).\r\n3. Coin Selection Process:\r\n   Call `AttemptSelection` 8 times. Each of them expands the coin eligibility filter (accepting a larger subset of coins in the calculation) until it founds a solutions or completely fails if no solutions gets founds after the 8 rounds.\r\n\r\n   Each `AttemptSelection` call performs the following actions:\r\n     - For each output type supported by the wallet (P2SH, P2PK, P2WPKH, P2WSH and a combination of all of them):\r\n       Call ChooseSelectionResult providing the respective, filtered by type, coins vector. Which:\r\n           I. Groups the outputs vector twice (one for positive only and a second one who includes the negative ones as well).\r\n              - GroupOutputs walks-through the entire inputted coins vector one time at least, + more if we are avoiding partial spends, to generate a vector of OutputGroups.\r\n           II. Then performs every coin selection algorithm using the recently created vector of OutputGroup: (1) BnB, (2) knapsack and (3) SRD.\r\n           III. Then returns the best solution out of them.\r\n```\r\n\r\nWe perform the general operation of gathering outputs, with the same script, into a single container inside:\r\nEach coins selection attempt (8 times > each coin eligibility filter), for each of the outputs vector who were filtered by type (plus another one joining all the outputs as well if needed), twice (one for the positive only outputs effective value and a second one for all of them).\r\n\r\nSo, in the worst case scenario where no solution is found after the 8 Coin Selection attempts, the `GroupOutputs` function is called 80 times (8 * 5 * 2).\r\n\r\n#### Improvements:\r\n\r\nThis proposal streamlines the process so that the output groups, filtered by coin eligibility and type, are created in a single loop outside of the Coin Selection Process. \r\n\r\nThe new process is as follows:\r\n\r\n```\r\n1. Fetch users manually selected inputs.\r\n2. Fetch wallet available coins.\r\n3. Group outputs by each coin eligibility filter and each different output type found.\r\n4. Coin Selection Process: \r\n   Call AttemptSelection 8 times. Each of them expands the coin eligibility filter (accepting different output groups) until it founds a solutions or completely fails if no solutions gets founds after the 8 rounds.\r\n   \r\n   Each AttemptSelection call performs the following actions:\r\n      - For each output type supported by the wallet (P2SH, P2PK, P2WPKH, P2WSH and all of them):\r\n          A. Call ChooseSelectionResult providing the respective, filtered by type, output group. Which:\r\n             I. Performs every coin selection algorithm using the provided vector of OutputGroup: (1) BnB, (2) knapsack and (3) SRD.\r\n             II. Then returns the best solution out of them.\r\n```\r\n\r\nExtra Note:\r\nThe next steps after this PR will be to:\r\n1) Merge `AvailableCoins` and `GroupOutputs` processes.\r\n2) Skip entire coin selection rounds if no new coins are added into the subsequent round.\r\n3) Remove global feerates from the OutputGroup class.\r\n4) Remove secondary \"grouped\" tx creation from `CreateTransactionInternal` by running Coin Selection results over the aps grouped outputs vs non-aps ones.",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 13,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25806",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25806",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25806.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25806.patch"
          },
          "closed_at": "2023-03-06T23:52:42Z",
          "created_at": "2022-08-08T21:19:07Z",
          "updated_at": "2023-05-27T01:47:50Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-10T17:04:55Z",
      "updated_at": "2022-08-10T17:04:55Z",
      "source": {
        "issue": {
          "id": 1330290276,
          "node_id": "PR_kwDOABII5848vK5U",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25789",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25789/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25789/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25789/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25789",
          "number": 25789,
          "state": "closed",
          "state_reason": null,
          "title": "test: clean and extend availablecoins_tests coverage",
          "body": "Negative PR with extended test coverage :).\r\n\r\n1) Cleaned duplicated code and added coverage for the 'AvailableCoins' incremental result.\r\n\r\n2) The class `AvailableCoinsTestingSetup` inside `availablecoins_tests.cpp` is a plain copy\r\nof `ListCoinsTestingSetup` that is inside `wallet_tests.cpp`. \r\n\r\n    So, deleted the file and moved the `BasicOutputTypesTest` test case to `wallet_tests.cpp`.\r\n\r\n3) Added arg to include/skip locked coins from the `AvailableCoins` result. This is needed for point (1) as otherwise the wallet will spend the coins that we recently created due its closeness to the recipient amount.\r\nNote: this last point comes from #25659 where I'm using the same functionality to clean/speedup another flow as well.",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignee": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "assignees": [
            {
              "login": "achow101",
              "id": 3782274,
              "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
              "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/achow101",
              "html_url": "https://github.com/achow101",
              "followers_url": "https://api.github.com/users/achow101/followers",
              "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
              "organizations_url": "https://api.github.com/users/achow101/orgs",
              "repos_url": "https://api.github.com/users/achow101/repos",
              "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/achow101/received_events",
              "type": "User",
              "site_admin": false
            }
          ],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25789",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25789",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25789.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25789.patch"
          },
          "closed_at": "2023-01-03T17:53:12Z",
          "created_at": "2022-08-05T19:00:19Z",
          "updated_at": "2023-05-27T01:48:17Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-11T17:16:51Z",
      "updated_at": "2022-08-11T17:16:51Z",
      "source": {
        "issue": {
          "id": 930266556,
          "node_id": "MDExOlB1bGxSZXF1ZXN0Njc3OTg5MzM4",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22341",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22341/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22341/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22341/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/22341",
          "number": 22341,
          "state": "open",
          "state_reason": null,
          "title": "rpc: add path to gethdkey",
          "body": "Depends on #26728.\r\n\r\nThis PR expands the wallet RPC `gethdkey` introduced in #26728. It takes a BIP32 path as argument and returns the xpub, along with the master key fingerprint.\r\n\r\nTo test this PR:\r\n\r\n* create a regular descriptor wallet\r\n* call `getxpub m/86h/0h/0h`\r\n* call `listdescriptors`, compare the xpub in the `tr()` descriptor with the previous step\r\n\r\n## Bigger picture\r\n\r\nThis paves the way for using Bitcoin Core as one signer in a multisig setup. It simplifies the proposed flow in #22067.\r\n\r\nThe eventual flow would be:\r\n1. Create a blank wallet with a seed (either with no descriptors, or where its single key descriptors are not `active`, so they don't get used when calling `getnewaddress`). \r\n2. Call `getxpub m/87h/0h/0h` (as suggested in [BIP 87](https://github.com/bitcoin/bips/blob/master/bip-0087.mediawiki))\r\n3. (Manually, with Specter or with a simple Python utility - TBD): craft a multisig descriptor containing this xpub\r\n4. Call `importdescriptors` which will allow the import if its own fingerprint is recognized (and after checking the xpub)\r\n5. The usual flow with `getnewaddress`, `send` and `walletprocesspsbt` (and their GUI equivalents)\r\n\r\nThis PR makes step (2) possible.\r\n\r\nStep (1) would require a followup, because blank wallets currently can't have a seed. Step 4 would also require a followup,  so that `importdescriptors` treats an `xpub` as if it was an `xpriv`, after checking that it can derive the xpub from the seed (that matches the fingerprint)\r\n\r\nOn the GUI side a wizard could perform the above steps and guide the user, where they either:\r\n* export their own xpub and then import a descriptor from somewhere else (performing some sanity checks); or\r\n* import xpub(s) from other wallets, compose a multisig and get the descriptors for export; or\r\n* get xpub(s) from connected hardware devices and configure a multisig (with or without a key on their machine)",
          "user": {
            "login": "Sjors",
            "id": 10217,
            "node_id": "MDQ6VXNlcjEwMjE3",
            "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Sjors",
            "html_url": "https://github.com/Sjors",
            "followers_url": "https://api.github.com/users/Sjors/followers",
            "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
            "organizations_url": "https://api.github.com/users/Sjors/orgs",
            "repos_url": "https://api.github.com/users/Sjors/repos",
            "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/Sjors/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 35,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22341",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/22341",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/22341.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/22341.patch"
          },
          "created_at": "2021-06-25T15:12:03Z",
          "updated_at": "2024-01-12T18:19:35Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-11T18:24:37Z",
      "updated_at": "2022-08-11T18:24:37Z",
      "source": {
        "issue": {
          "id": 666560839,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDU3MzgyMzM0",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19602",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19602/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19602/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19602/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/19602",
          "number": 19602,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: Migrate legacy wallets to descriptor wallets",
          "body": "This PR adds a new `migratewallet` RPC which migrates a legacy wallet to a descriptor wallet. Migrated wallets will need a new backup. If a wallet has watchonly stuff in it, a new watchonly descriptor wallet will be created containing those watchonly things. The related transactions, labels, and descriptors for those watchonly things will be removed from the original wallet. Migrated wallets will not have any of the legacy things be available for fetching from `getnewaddress` or `getrawchangeaddress`. Wallets that have private keys enabled will have newly generated descriptors. Wallets with private keys disabled will not have any active `ScriptPubKeyMan`s.\r\n\r\nFor the basic HD wallet case of just generated keys, in addition to the standard descriptor wallet descriptors using the master key derived from the pre-existing hd seed, the migration will also create 3 descriptors for each HD chain in: a ranged combo external, a ranged combo internal, and a single key combo for the seed (the seed is a valid key that we can receive coins at!). The migrated wallet will then have newly generated descriptors as the active `ScriptPubKeyMan`s. This is equivalent to creating a new descriptor wallet and importing the 3 descriptors for each HD chain. For wallets containing non-HD keys, each key will have its own combo descriptor.\r\n\r\nThere are also tests.",
          "user": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "milestone": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/54",
            "html_url": "https://github.com/bitcoin/bitcoin/milestone/54",
            "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/54/labels",
            "id": 7150037,
            "node_id": "MI_kwDOABII584AbRnV",
            "number": 54,
            "state": "closed",
            "title": "24.0",
            "description": "",
            "creator": {
              "login": "laanwj",
              "id": 126646,
              "node_id": "MDQ6VXNlcjEyNjY0Ng==",
              "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/laanwj",
              "html_url": "https://github.com/laanwj",
              "followers_url": "https://api.github.com/users/laanwj/followers",
              "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
              "organizations_url": "https://api.github.com/users/laanwj/orgs",
              "repos_url": "https://api.github.com/users/laanwj/repos",
              "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/laanwj/received_events",
              "type": "User",
              "site_admin": false
            },
            "open_issues": 0,
            "closed_issues": 159,
            "created_at": "2021-09-14T08:27:02Z",
            "updated_at": "2022-11-29T15:44:44Z",
            "closed_at": "2022-11-29T15:44:44Z"
          },
          "locked": false,
          "comments": 50,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19602",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/19602",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/19602.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/19602.patch"
          },
          "closed_at": "2022-09-01T19:44:11Z",
          "created_at": "2020-07-27T20:22:25Z",
          "updated_at": "2023-03-13T22:00:30Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-16T23:29:00Z",
      "updated_at": "2022-08-16T23:29:00Z",
      "source": {
        "issue": {
          "id": 1206247497,
          "node_id": "PR_kwDOABII5842Uktn",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24897",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24897/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24897/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24897/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24897",
          "number": 24897,
          "state": "closed",
          "state_reason": null,
          "title": "[Draft / POC] Silent Payments",
          "body": "This PR proposes an early version of [Silent Payment](https://gist.github.com/RubenSomsen/c43b79517e7cb701ebf77eec6dbb46b8) (author:@RubenSomsen).\r\nIn this scheme, the recipient generates a public address, but the sender tweaks the address and the recipient detects the payment by verifying all transactions on the blockchain. An example use case would be private donations.\r\n\r\nThe purpose of this PR is not a final version, but to start the discussion and get benchmarks based on a real implementation.\r\n\r\nThis version is built on top of [#994](https://github.com/bitcoin-core/secp256k1/pull/994) (bitcoin-core/secp256k1) for x-only ECDH support and #23480 (bitcoin/bitcoin) for `rawtr()`. Each new silent transaction detected is stored in wallet as a `rawtr()` descriptor. \r\n\r\nIn this implementation, the sender can tweak the recipient address by passing the `silent_payment` option to send RPC. The transaction output will be different from the address entered.\r\n\r\nFor example `./src/bitcoin-cli -regtest -named send outputs=\"[{\\\"bcrt1pwlh5xuyrpgfunwyww8cfu78yfs2yqyevl7yturavahh5kgxwdd2q5hzgfu\\\": 1.1}]\" fee_rate=1 options=\"{ \\\"silent_payment\\\": true}\"`.\r\n\r\nwill generate `vout` with completely unrelated outputs:\r\n\r\n```\r\n\"vout\": [\r\n    {\r\n      \"value\": 1.10000000,\r\n      \"n\": 0,\r\n      \"scriptPubKey\": {\r\n        \"desc\": \"rawtr(65b19890c5ca40edb816d26f5f48cd9f3ed51121613b1c2405adc1a6dbbc824a)#8myx9tcu\",\r\n        \"address\": \"bcrt1pvkce3yx9efqwmwqk6fh47jxdnuld2yfpvya3cfq94hq6dkausf9qrfjkgz\",\r\n\r\n      }\r\n    },\r\n    {\r\n      \"value\": 2.02499835,\r\n      \"n\": 1,\r\n      \"scriptPubKey\": {\r\n        \"desc\": \"rawtr(c45cb3d500bbf8f0c8841e8e011b008781d826c16ee348edb822c0f97419bc4d)#26hcce63\",\r\n        \"address\": \"bcrt1pc3wt84gqh0u0pjyyr68qzxcqs7qasfkpdm353mdcytq0jaqeh3xsuvlykg\",\r\n      }\r\n    }\r\n  ]\r\n```\r\n\r\nAny wallet, as long as it has access to private keys, can send silent payments. Thus, this excludes watch-only wallets or wallets with external signers .\r\n\r\nBut the recipient's wallet needs a new flag called `SILENT_PAYMENT`. This flag allows an additional scan that verifies that the wallet keys match the silent payment scheme. When it detects a silent payment that belongs to the wallet, it is stored in a `rawtr()` descriptor.\r\n\r\n`./src/bitcoin-cli -regtest -named createwallet wallet_name=\"recipient\" silent_payment=true`\r\n\r\nTherefore, scanning each address for each transaction is potentially prohibitive overhead, so the node can be initialized with `keypool=1` or a descriptor with range [0,1] can be imported into a blank wallet. Until there is more benchmark data, it is the safest option. The proposal recommends one static address.\r\n\r\nI've been running some silent payments on signet using wallets with default keypool and default range, I haven't noticed any relevant performance drops on the signet node.\r\nApparently this implementation is working as expected but I can't guarantee that the scheme is implemented correctly or safely, so I'm opening this PR for reviews, modifications and improvements.\r\n\r\nThere is a new functional test (`test/functional/wallet_silentpayment.py`) that can help to better understand the implementation.",
          "user": {
            "login": "w0xlt",
            "id": 94266259,
            "node_id": "U_kgDOBZ5jkw",
            "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/w0xlt",
            "html_url": "https://github.com/w0xlt",
            "followers_url": "https://api.github.com/users/w0xlt/followers",
            "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
            "organizations_url": "https://api.github.com/users/w0xlt/orgs",
            "repos_url": "https://api.github.com/users/w0xlt/repos",
            "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/w0xlt/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 61889416,
              "node_id": "MDU6TGFiZWw2MTg4OTQxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Build%20system",
              "name": "Build system",
              "color": "5319e7",
              "default": false
            },
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            },
            {
              "id": 159815356,
              "node_id": "MDU6TGFiZWwxNTk4MTUzNTY=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Upstream",
              "name": "Upstream",
              "color": "bfd4f2",
              "default": false
            },
            {
              "id": 241832923,
              "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
              "name": "Utils/log/libs",
              "description": "",
              "color": "5319e7",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            },
            {
              "id": 1482182044,
              "node_id": "MDU6TGFiZWwxNDgyMTgyMDQ0",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Descriptors",
              "name": "Descriptors",
              "description": "",
              "color": "e9f76c",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 86,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24897",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24897",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24897.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24897.patch"
          },
          "closed_at": "2023-06-05T13:18:14Z",
          "created_at": "2022-04-17T00:37:23Z",
          "updated_at": "2023-06-27T11:03:39Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "referenced",
      "id": 7201257483,
      "node_id": "REFE_lADOABII585FzCTjzwAAAAGtOngL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7201257483",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "64f7a1940d738a9acd207883af1dfda3e00f4a21",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/64f7a1940d738a9acd207883af1dfda3e00f4a21",
      "created_at": "2022-08-17T00:00:41Z"
    },
    {
      "event": "referenced",
      "id": 7685149187,
      "node_id": "REFE_lADOABII585FzCTjzwAAAAHKEhID",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7685149187",
      "actor": {
        "login": "bitcoinhodler",
        "id": 31543633,
        "node_id": "MDQ6VXNlcjMxNTQzNjMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/31543633?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoinhodler",
        "html_url": "https://github.com/bitcoinhodler",
        "followers_url": "https://api.github.com/users/bitcoinhodler/followers",
        "following_url": "https://api.github.com/users/bitcoinhodler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoinhodler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoinhodler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoinhodler/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoinhodler/orgs",
        "repos_url": "https://api.github.com/users/bitcoinhodler/repos",
        "events_url": "https://api.github.com/users/bitcoinhodler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoinhodler/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "6ea220911d015e2c0484614f0ef2edc397b09b2c",
      "commit_url": "https://api.github.com/repos/bitcoinhodler/GlacierProtocol/commits/6ea220911d015e2c0484614f0ef2edc397b09b2c",
      "created_at": "2022-10-27T19:11:45Z"
    },
    {
      "event": "referenced",
      "id": 7685149194,
      "node_id": "REFE_lADOABII585FzCTjzwAAAAHKEhIK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7685149194",
      "actor": {
        "login": "bitcoinhodler",
        "id": 31543633,
        "node_id": "MDQ6VXNlcjMxNTQzNjMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/31543633?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoinhodler",
        "html_url": "https://github.com/bitcoinhodler",
        "followers_url": "https://api.github.com/users/bitcoinhodler/followers",
        "following_url": "https://api.github.com/users/bitcoinhodler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoinhodler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoinhodler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoinhodler/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoinhodler/orgs",
        "repos_url": "https://api.github.com/users/bitcoinhodler/repos",
        "events_url": "https://api.github.com/users/bitcoinhodler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoinhodler/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "24fdce59fc710a9cee8cdd52c87018ae611d46fa",
      "commit_url": "https://api.github.com/repos/bitcoinhodler/GlacierProtocol/commits/24fdce59fc710a9cee8cdd52c87018ae611d46fa",
      "created_at": "2022-10-27T19:11:45Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "bitcoinhodler",
        "id": 31543633,
        "node_id": "MDQ6VXNlcjMxNTQzNjMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/31543633?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoinhodler",
        "html_url": "https://github.com/bitcoinhodler",
        "followers_url": "https://api.github.com/users/bitcoinhodler/followers",
        "following_url": "https://api.github.com/users/bitcoinhodler/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoinhodler/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoinhodler/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoinhodler/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoinhodler/orgs",
        "repos_url": "https://api.github.com/users/bitcoinhodler/repos",
        "events_url": "https://api.github.com/users/bitcoinhodler/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoinhodler/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-28T00:28:00Z",
      "updated_at": "2022-10-28T00:28:00Z",
      "source": {
        "issue": {
          "id": 1426412581,
          "node_id": "I_kwDOABII585VBVQl",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26406",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26406/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26406/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26406/events",
          "html_url": "https://github.com/bitcoin/bitcoin/issues/26406",
          "number": 26406,
          "state": "closed",
          "state_reason": "not_planned",
          "title": "Instability in `listunspent` after #24699",
          "body": "I maintain a [wallet](https://github.com/bitcoinhodler/GlacierProtocol/tree/bitcoin-core-24) that uses `bitcoin-cli` for signing transactions, and its test system uses regtest to create a bunch of UTXOs for the signing tests to sign. These tests use a git-committed `wallet.dat` that is copied into the newly-created `datadir` before launching `bitcoind`.\r\n\r\nFor years, up until bc886fcb31e1afa7bbf7b86bfd93e51da7076ccf (part of #24699), this was stable and worked well. Occasionally I would need to recreate all the transactions when this project changed mining (#24732) or coin selection (#24584) but I could handle that.\r\n\r\nWhat I can't handle is having the generated transactions be different each time I run the exact same sequence of `bitcoin-cli` commands starting from the same `wallet.dat`. Starting with bc886fcb31e1afa7bbf7b86bfd93e51da7076ccf, that's what happens.\r\n\r\nIs this a supported use model, or is it unreasonable to expect this to be stable?\r\n\r\nSummarizing:\r\n* v0.20.0 -- stable\r\n* v0.21.0 -- stable\r\n* v22.0 -- stable\r\n* v23.0 -- stable\r\n* 272356024db978c92112167f8d8e4cc62adad63d (which is bc886fcb31e1afa7bbf7b86bfd93e51da7076ccf^) -- stable\r\n* bc886fcb31e1afa7bbf7b86bfd93e51da7076ccf -- unstable\r\n* v24.0rc2 -- unstable\r\n* Current master (f37bd15d472fdc7dd3d40cafaba9e8dfddd6b530) -- unstable\r\n\r\n\r\n<!-- Describe the issue -->\r\n\r\n**Expected behavior**\r\n\r\nThe generated transactions should be identical given an identical series of `bitcoin-cli` calls.\r\n\r\n**Actual behavior**\r\n\r\nThe generated transactions choose different input coins from the regtest blockchain every time I run.\r\n\r\n**To reproduce**\r\n\r\nIn my [Glacier wallet fork](https://github.com/bitcoinhodler/GlacierProtocol/tree/bitcoin-core-24), run `t/online_regtest_wallet.py recreate-all-tests`; git commit the result. Run the same command again -- `git status` should show no changes.\r\n\r\nWhen it's unstable, dozens of files change.\r\n\r\n**System information**\r\n\r\nRunning on Whonix 16. Building inside the git repo as such:\r\n```\r\n(cd depends && make -j4 NO_QT=1) && ./autogen.sh && ./configure --prefix=`pwd`/depends/x86_64-pc-linux-gnu && make -j4\r\n```",
          "user": {
            "login": "bitcoinhodler",
            "id": 31543633,
            "node_id": "MDQ6VXNlcjMxNTQzNjMz",
            "avatar_url": "https://avatars.githubusercontent.com/u/31543633?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/bitcoinhodler",
            "html_url": "https://github.com/bitcoinhodler",
            "followers_url": "https://api.github.com/users/bitcoinhodler/followers",
            "following_url": "https://api.github.com/users/bitcoinhodler/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/bitcoinhodler/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/bitcoinhodler/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/bitcoinhodler/subscriptions",
            "organizations_url": "https://api.github.com/users/bitcoinhodler/orgs",
            "repos_url": "https://api.github.com/users/bitcoinhodler/repos",
            "events_url": "https://api.github.com/users/bitcoinhodler/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/bitcoinhodler/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 64585,
              "node_id": "MDU6TGFiZWw2NDU4NQ==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug",
              "name": "Bug",
              "color": "FBBAAB",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 3,
          "closed_at": "2022-10-28T17:21:24Z",
          "created_at": "2022-10-28T00:28:00Z",
          "updated_at": "2023-10-28T12:16:18Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-11-28T14:03:16Z",
      "updated_at": "2022-11-28T14:03:16Z",
      "source": {
        "issue": {
          "id": 1461939996,
          "node_id": "PR_kwDOABII585Dkmyw",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26560",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26560/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26560/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26560/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26560",
          "number": 26560,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: bugfix, invalid CoinsResult cached total amount",
          "body": "This comes with #26559.\r\n\r\nSolving few bugs inside the wallet's transaction creation\r\nprocess and adding test coverage for them.\r\nPlus, making use of the `CoinsResult::total_amount` cached value\r\ninside the Coin Selection process to return early if we don't have\r\nenough funds to cover the target amount.\r\n\r\n### Bugs\r\n\r\n1) The `CoinsResult::Erase` method removes only one\r\noutput from the available coins vector (there is a [loop break](https://github.com/bitcoin/bitcoin/blob/c1061be14a515b0ed4f4d646fcd0378c62e6ded3/src/wallet/spend.cpp#L112)\r\nthat should have never been there) and not all the preset inputs.\r\n\r\n   Which on master is not a problem, because since [#25685](https://github.com/bitcoin/bitcoin/pull/25685)\r\n   we are no longer using the method. But, it's a bug on v24\r\n   (check [#26559](https://github.com/bitcoin/bitcoin/pull/26559)).\r\n\r\n   This method it's being fixed and not removed because I'm later using it to solve\r\n   another bug inside this PR.\r\n\r\n2) As we update the total cached amount of the `CoinsResult` object inside\r\n   `AvailableCoins` and we don't use such function inside the coin selection\r\n   tests (we manually load up the `CoinsResult` object), there is a discrepancy\r\n   between the outputs that we add/erase and the total amount cached value.\r\n\r\n### Improvements\r\n\r\n* This makes use of the `CoinsResult` total amount field to early return\r\n  with an \"Insufficient funds\" error inside Coin Selection if the tx target\r\n  amount is greater than the sum of all the wallet available coins plus the\r\n  preset inputs amounts (we don't need to perform the entire coin selection\r\n  process if we already know that there aren't enough funds inside our wallet).\r\n\r\n### Test Coverage\r\n\r\n1) Adds test coverage for the duplicated preset input selection bug that we have in v24.\r\n  Where the wallet invalidly selects the preset inputs twice during the Coin Selection\r\n  process. Which ends up with a \"good\" Coin Selection result that does not cover the\r\n  total tx target amount. Which, alone, crashes the wallet due an insane fee.\r\n  But.. to make it worst, adding the subtract fee from output functionality\r\n  to this mix ends up with the wallet by-passing the \"insane\" fee assertion,\r\n  decreasing the output amount to fulfill the insane fee, and.. sadly,\r\n  broadcasting the tx to the network.\r\n\r\n2) Adds test coverage for the `CoinsResult::Erase` method.",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 16,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26560",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26560",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26560.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26560.patch"
          },
          "closed_at": "2022-12-05T17:01:36Z",
          "created_at": "2022-11-23T15:13:40Z",
          "updated_at": "2023-09-01T14:47:21Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "notmandatory",
        "id": 4724730,
        "node_id": "MDQ6VXNlcjQ3MjQ3MzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4724730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/notmandatory",
        "html_url": "https://github.com/notmandatory",
        "followers_url": "https://api.github.com/users/notmandatory/followers",
        "following_url": "https://api.github.com/users/notmandatory/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/notmandatory/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/notmandatory/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/notmandatory/subscriptions",
        "organizations_url": "https://api.github.com/users/notmandatory/orgs",
        "repos_url": "https://api.github.com/users/notmandatory/repos",
        "events_url": "https://api.github.com/users/notmandatory/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/notmandatory/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-31T02:56:58Z",
      "updated_at": "2023-03-31T02:56:58Z",
      "source": {
        "issue": {
          "id": 1636168258,
          "node_id": "I_kwDODgwEWM5hhfJC",
          "url": "https://api.github.com/repos/bitcoindevkit/bdk/issues/918",
          "repository_url": "https://api.github.com/repos/bitcoindevkit/bdk",
          "labels_url": "https://api.github.com/repos/bitcoindevkit/bdk/issues/918/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoindevkit/bdk/issues/918/comments",
          "events_url": "https://api.github.com/repos/bitcoindevkit/bdk/issues/918/events",
          "html_url": "https://github.com/bitcoindevkit/bdk/issues/918",
          "number": 918,
          "state": "open",
          "state_reason": null,
          "title": "Improve bdk::Wallet API",
          "body": "Tracking issue for improvements we want to make in the 1.0.0 bdk::Wallet API.\n\n- [ ] #898 \n- [x] #922 \n- [ ] #923\n- [ ] #865",
          "user": {
            "login": "notmandatory",
            "id": 4724730,
            "node_id": "MDQ6VXNlcjQ3MjQ3MzA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4724730?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/notmandatory",
            "html_url": "https://github.com/notmandatory",
            "followers_url": "https://api.github.com/users/notmandatory/followers",
            "following_url": "https://api.github.com/users/notmandatory/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/notmandatory/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/notmandatory/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/notmandatory/subscriptions",
            "organizations_url": "https://api.github.com/users/notmandatory/orgs",
            "repos_url": "https://api.github.com/users/notmandatory/repos",
            "events_url": "https://api.github.com/users/notmandatory/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/notmandatory/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 2,
          "created_at": "2023-03-22T17:01:32Z",
          "updated_at": "2023-08-31T05:29:34Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DanGould",
        "id": 8525467,
        "node_id": "MDQ6VXNlcjg1MjU0Njc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8525467?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DanGould",
        "html_url": "https://github.com/DanGould",
        "followers_url": "https://api.github.com/users/DanGould/followers",
        "following_url": "https://api.github.com/users/DanGould/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DanGould/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DanGould/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DanGould/subscriptions",
        "organizations_url": "https://api.github.com/users/DanGould/orgs",
        "repos_url": "https://api.github.com/users/DanGould/repos",
        "events_url": "https://api.github.com/users/DanGould/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DanGould/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-14T20:26:22Z",
      "updated_at": "2023-07-14T20:26:22Z",
      "source": {
        "issue": {
          "id": 1069824100,
          "node_id": "PR_kwDOAN28mc4vUoBl",
          "url": "https://api.github.com/repos/bitcoin/bips/issues/1244",
          "repository_url": "https://api.github.com/repos/bitcoin/bips",
          "labels_url": "https://api.github.com/repos/bitcoin/bips/issues/1244/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bips/issues/1244/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bips/issues/1244/events",
          "html_url": "https://github.com/bitcoin/bips/pull/1244",
          "number": 1244,
          "state": "open",
          "state_reason": null,
          "title": "BIP78: Allow mixed inputs and clarify a few things",
          "body": "Disallowing mixed inputs was based on incorrect assumption that no\r\nwallet supports mixed inputs and thus mixed inputs imply PayJoin.\r\nHowever there are at least three wallets supporting mixed inputs.\r\n(Confirmed: Bitcoin Core, LND, Coinomi; I think I remember seeing\r\nSamourai doing mixed inputs too.) Thus it makes sense to enable mixed\r\ninputs. To avoid compatibility issues a grace period is suggested.\r\n\r\nAdditional clarifications were made:\r\n* Disallow reciever removing output - such would break the reference\r\n  implementation and seems better than changing the reference\r\n  implementation.\r\n* Forbid sender changing TXID in special case where no input is added.\r\n* Confirm that `amount` is *not* mandatory.\r\n\r\nWe discussed this with @NicolasDorier in the past. (Finally found the time! :))\r\nThis may interest wallet developers: @nopara73 @Overtorment @rage-proof @RCasatta ",
          "user": {
            "login": "Kixunil",
            "id": 1178779,
            "node_id": "MDQ6VXNlcjExNzg3Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1178779?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Kixunil",
            "html_url": "https://github.com/Kixunil",
            "followers_url": "https://api.github.com/users/Kixunil/followers",
            "following_url": "https://api.github.com/users/Kixunil/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/Kixunil/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/Kixunil/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/Kixunil/subscriptions",
            "organizations_url": "https://api.github.com/users/Kixunil/orgs",
            "repos_url": "https://api.github.com/users/Kixunil/repos",
            "events_url": "https://api.github.com/users/Kixunil/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/Kixunil/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 275846070,
              "node_id": "MDU6TGFiZWwyNzU4NDYwNzA=",
              "url": "https://api.github.com/repos/bitcoin/bips/labels/Proposed%20BIP%20modification",
              "name": "Proposed BIP modification",
              "color": "5319e7",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "NONE",
          "locked": false,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bips/pulls/1244",
            "html_url": "https://github.com/bitcoin/bips/pull/1244",
            "diff_url": "https://github.com/bitcoin/bips/pull/1244.diff",
            "patch_url": "https://github.com/bitcoin/bips/pull/1244.patch"
          },
          "created_at": "2021-12-02T17:48:18Z",
          "updated_at": "2023-10-27T10:40:26Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "locked",
      "id": 10095698467,
      "node_id": "LOE_lADOABII585FzCTjzwAAAAJZwCIj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10095698467",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-15T10:20:21Z"
    },
    {
      "event": "head_ref_deleted",
      "id": 11607481667,
      "node_id": "HRDE_lADOABII585FzCTjzwAAAAKz3B1D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11607481667",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-26T10:51:15Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828016527",
      "pull_request_review_id": 911639998,
      "id": 828016527,
      "node_id": "PRRC_kwDOABII584xWoeP",
      "diff_hunk": "@@ -767,10 +783,32 @@ static bool CreateTransactionInternal(\n \n     // Get available coins\n     std::vector<COutput> vAvailableCoins;\n-    AvailableCoins(wallet, vAvailableCoins, &coin_control, 1, MAX_MONEY, MAX_MONEY, 0);\n \n-    // Choose coins to use\n-    std::optional<SelectionResult> result = SelectCoins(wallet, vAvailableCoins, /* nTargetValue */ selection_target, coin_control, coin_selection_params);\n+    // First, do coin selection on a filtered subset of coins, filtered by OutputType\n+    // Attempt with older output types first (LEGACY > P2SH > BECH32 > BECH32M)\n+    std::optional<SelectionResult> result = [&] {\n+\tfor (const OutputType& type : OUTPUT_TYPES) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 52,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "312d9347b3e5e611ab28c1307d73345576dc4d7d",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This assumes that `OUTPUT_TYPES` is sorted by age? Maybe add a comment there to ensure this doesn't break?\r\n\r\nAlso, this is the wrong indentation? Maybe run clang-format?",
      "created_at": "2022-03-16T13:35:04Z",
      "updated_at": "2022-03-16T13:41:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r828016527",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828016527"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 790,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828065439",
      "pull_request_review_id": 911711048,
      "id": 828065439,
      "node_id": "PRRC_kwDOABII584xW0af",
      "diff_hunk": "@@ -767,10 +783,32 @@ static bool CreateTransactionInternal(\n \n     // Get available coins\n     std::vector<COutput> vAvailableCoins;\n-    AvailableCoins(wallet, vAvailableCoins, &coin_control, 1, MAX_MONEY, MAX_MONEY, 0);\n \n-    // Choose coins to use\n-    std::optional<SelectionResult> result = SelectCoins(wallet, vAvailableCoins, /* nTargetValue */ selection_target, coin_control, coin_selection_params);\n+    // First, do coin selection on a filtered subset of coins, filtered by OutputType\n+    // Attempt with older output types first (LEGACY > P2SH > BECH32 > BECH32M)\n+    std::optional<SelectionResult> result = [&] {\n+\tfor (const OutputType& type : OUTPUT_TYPES) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 52,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "312d9347b3e5e611ab28c1307d73345576dc4d7d",
      "in_reply_to_id": 828016527,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "good catch, fixed the formatting! also added a comment re: output_types",
      "created_at": "2022-03-16T14:19:48Z",
      "updated_at": "2022-03-16T14:19:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r828065439",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828065439"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 790,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828078777",
      "pull_request_review_id": 911730230,
      "id": 828078777,
      "node_id": "PRRC_kwDOABII584xW3q5",
      "diff_hunk": "@@ -22,6 +22,7 @@ enum class OutputType {\n     BECH32M,\n };\n \n+// Keep output types sorted by age, with older types first",
      "path": "src/outputtype.h",
      "position": null,
      "original_position": 4,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "fdf1fa5e6c35564f33d874b86a45b7b0731f434d",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Maybe also mention the places that require it (CreateTransactionInternal), so that when those go away, the comment can go away, too?",
      "created_at": "2022-03-16T14:31:27Z",
      "updated_at": "2022-03-16T18:41:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r828078777",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828078777"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828302619",
      "pull_request_review_id": 912059789,
      "id": 828302619,
      "node_id": "PRRC_kwDOABII584xXuUb",
      "diff_hunk": "@@ -186,6 +186,23 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n                 continue;\n             }\n \n+            OutputType output_type{wallet.m_default_address_type};\n+            std::vector<std::vector<uint8_t>> dummy;\n+            TxoutType type{Solver(wtx.tx->vout[i].scriptPubKey, dummy)};\n+            if (type == TxoutType::WITNESS_V1_TAPROOT) {\n+                output_type = OutputType::BECH32M;\n+            } else if (type == TxoutType::WITNESS_V0_KEYHASH) {\n+                output_type = OutputType::BECH32;\n+            } else if (type == TxoutType::SCRIPTHASH) {\n+                output_type = OutputType::P2SH_SEGWIT;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e27943dd91afbad679212d61b7b891f9f53818a0",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In b32b52c3e7360ecb30e1a46dfa06669bc4fcd4b3 \"wallet: avoid mixing ouput types in coin selection\"\r\n\r\nThis is not guaranteed to be true. We could have a P2SH multisig and that would be `LEGACY`.",
      "created_at": "2022-03-16T18:00:35Z",
      "updated_at": "2022-03-16T18:07:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r828302619",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828302619"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 197,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828330729",
      "pull_request_review_id": 912098744,
      "id": 828330729,
      "node_id": "PRRC_kwDOABII584xX1Lp",
      "diff_hunk": "@@ -186,6 +186,23 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n                 continue;\n             }\n \n+            OutputType output_type{wallet.m_default_address_type};\n+            std::vector<std::vector<uint8_t>> dummy;\n+            TxoutType type{Solver(wtx.tx->vout[i].scriptPubKey, dummy)};\n+            if (type == TxoutType::WITNESS_V1_TAPROOT) {\n+                output_type = OutputType::BECH32M;\n+            } else if (type == TxoutType::WITNESS_V0_KEYHASH) {\n+                output_type = OutputType::BECH32;\n+            } else if (type == TxoutType::SCRIPTHASH) {\n+                output_type = OutputType::P2SH_SEGWIT;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e27943dd91afbad679212d61b7b891f9f53818a0",
      "in_reply_to_id": 828302619,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "is there a cleaner way to go map a `COutput` to an `OutputType`? adding lots of if/else checks to go from a `TxoutType` to an `OutputType` seems clunky to me",
      "created_at": "2022-03-16T18:36:10Z",
      "updated_at": "2022-03-16T18:36:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r828330729",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828330729"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 197,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828335217",
      "pull_request_review_id": 911730230,
      "id": 828335217,
      "node_id": "PRRC_kwDOABII584xX2Rx",
      "diff_hunk": "@@ -186,6 +186,23 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n                 continue;\n             }\n \n+            OutputType output_type{wallet.m_default_address_type};\n+            std::vector<std::vector<uint8_t>> dummy;\n+            TxoutType type{Solver(wtx.tx->vout[i].scriptPubKey, dummy)};\n+            if (type == TxoutType::WITNESS_V1_TAPROOT) {\n+                output_type = OutputType::BECH32M;\n+            } else if (type == TxoutType::WITNESS_V0_KEYHASH) {\n+                output_type = OutputType::BECH32;\n+            } else if (type == TxoutType::SCRIPTHASH) {\n+                output_type = OutputType::P2SH_SEGWIT;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e27943dd91afbad679212d61b7b891f9f53818a0",
      "in_reply_to_id": 828302619,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is there any need to map to output type? Why not use `TxoutType` directly?",
      "created_at": "2022-03-16T18:41:36Z",
      "updated_at": "2022-03-16T18:41:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r828335217",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828335217"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 197,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828337242",
      "pull_request_review_id": 912107577,
      "id": 828337242,
      "node_id": "PRRC_kwDOABII584xX2xa",
      "diff_hunk": "@@ -186,6 +186,23 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n                 continue;\n             }\n \n+            OutputType output_type{wallet.m_default_address_type};\n+            std::vector<std::vector<uint8_t>> dummy;\n+            TxoutType type{Solver(wtx.tx->vout[i].scriptPubKey, dummy)};\n+            if (type == TxoutType::WITNESS_V1_TAPROOT) {\n+                output_type = OutputType::BECH32M;\n+            } else if (type == TxoutType::WITNESS_V0_KEYHASH) {\n+                output_type = OutputType::BECH32;\n+            } else if (type == TxoutType::SCRIPTHASH) {\n+                output_type = OutputType::P2SH_SEGWIT;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e27943dd91afbad679212d61b7b891f9f53818a0",
      "in_reply_to_id": 828302619,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Is there any need to map to output type? Why not use `TxoutType` directly?\r\n\r\nYes, `P2SH_SEGWIT` is distinct from other P2SH which would be legacy.\r\n\r\n> is there a cleaner way to go map a `COutput` to an `OutputType`? adding lots of if/else checks to go from a `TxoutType` to an `OutputType` seems clunky to me\r\n\r\nI don't think there exists one yet.",
      "created_at": "2022-03-16T18:44:03Z",
      "updated_at": "2022-03-16T18:44:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r828337242",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828337242"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 197,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828343513",
      "pull_request_review_id": 912116249,
      "id": 828343513,
      "node_id": "PRRC_kwDOABII584xX4TZ",
      "diff_hunk": "@@ -186,6 +186,23 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n                 continue;\n             }\n \n+            OutputType output_type{wallet.m_default_address_type};\n+            std::vector<std::vector<uint8_t>> dummy;\n+            TxoutType type{Solver(wtx.tx->vout[i].scriptPubKey, dummy)};\n+            if (type == TxoutType::WITNESS_V1_TAPROOT) {\n+                output_type = OutputType::BECH32M;\n+            } else if (type == TxoutType::WITNESS_V0_KEYHASH) {\n+                output_type = OutputType::BECH32;\n+            } else if (type == TxoutType::SCRIPTHASH) {\n+                output_type = OutputType::P2SH_SEGWIT;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e27943dd91afbad679212d61b7b891f9f53818a0",
      "in_reply_to_id": 828302619,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I mean multisig P2SH should not be mixed with legacy either? Mapping to `OutputType` can't fix this. In fact it will probably break anyway when the wallet can spend segwit v2 outputs.",
      "created_at": "2022-03-16T18:51:46Z",
      "updated_at": "2022-03-16T18:51:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r828343513",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828343513"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 197,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828357408",
      "pull_request_review_id": 912136611,
      "id": 828357408,
      "node_id": "PRRC_kwDOABII584xX7sg",
      "diff_hunk": "@@ -186,6 +186,23 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n                 continue;\n             }\n \n+            OutputType output_type{wallet.m_default_address_type};\n+            std::vector<std::vector<uint8_t>> dummy;\n+            TxoutType type{Solver(wtx.tx->vout[i].scriptPubKey, dummy)};\n+            if (type == TxoutType::WITNESS_V1_TAPROOT) {\n+                output_type = OutputType::BECH32M;\n+            } else if (type == TxoutType::WITNESS_V0_KEYHASH) {\n+                output_type = OutputType::BECH32;\n+            } else if (type == TxoutType::SCRIPTHASH) {\n+                output_type = OutputType::P2SH_SEGWIT;\n+            } else if (type == TxoutType::PUBKEYHASH) {\n+                output_type = OutputType::LEGACY;\n+            }",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "fdf1fa5e6c35564f33d874b86a45b7b0731f434d",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "We could perhaps amend `availableCoins` to just return the outputs grouped by type already. E.g. `availableCoins` could be a struct with a vector for each an output type, and a member `all` that returns the four vectors concatenated.",
      "created_at": "2022-03-16T19:08:56Z",
      "updated_at": "2022-03-16T20:28:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r828357408",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828357408"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 189,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 200,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828409065",
      "pull_request_review_id": 912209235,
      "id": 828409065,
      "node_id": "PRRC_kwDOABII584xYITp",
      "diff_hunk": "@@ -186,6 +186,23 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n                 continue;\n             }\n \n+            OutputType output_type{wallet.m_default_address_type};\n+            std::vector<std::vector<uint8_t>> dummy;\n+            TxoutType type{Solver(wtx.tx->vout[i].scriptPubKey, dummy)};\n+            if (type == TxoutType::WITNESS_V1_TAPROOT) {\n+                output_type = OutputType::BECH32M;\n+            } else if (type == TxoutType::WITNESS_V0_KEYHASH) {\n+                output_type = OutputType::BECH32;\n+            } else if (type == TxoutType::SCRIPTHASH) {\n+                output_type = OutputType::P2SH_SEGWIT;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e27943dd91afbad679212d61b7b891f9f53818a0",
      "in_reply_to_id": 828302619,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It's unlikely that multisig things would actually be mixed with single key things, but I think it would be incorrect to group P2SH with p2sh-segwit. Conceivably, the same multisig could have been p2sh, then upgraded to p2sh-segwit, and then to bech32. In that case, it would still be legacy, p2sh-segwit, and bech32.",
      "created_at": "2022-03-16T20:16:34Z",
      "updated_at": "2022-03-16T20:16:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r828409065",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/828409065"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 197,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830424080",
      "pull_request_review_id": 914956407,
      "id": 830424080,
      "node_id": "PRRC_kwDOABII584xf0QQ",
      "diff_hunk": "@@ -767,10 +783,32 @@ static bool CreateTransactionInternal(\n \n     // Get available coins\n     std::vector<COutput> vAvailableCoins;\n-    AvailableCoins(wallet, vAvailableCoins, &coin_control, 1, MAX_MONEY, MAX_MONEY, 0);\n \n-    // Choose coins to use\n-    std::optional<SelectionResult> result = SelectCoins(wallet, vAvailableCoins, /* nTargetValue */ selection_target, coin_control, coin_selection_params);\n+    // First, do coin selection on a filtered subset of coins, filtered by OutputType\n+    // Attempt with older output types first (LEGACY > P2SH > BECH32 > BECH32M)\n+    std::optional<SelectionResult> result = [&] {\n+        // This takes advantange of the fact that OUTPUT_TYPES is already sorted by age (LEGACY, P2SH, BECH32, BECH32M)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 52,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "fdf1fa5e6c35564f33d874b86a45b7b0731f434d",
      "in_reply_to_id": null,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This assumes there is a strict preference for newer UTXO types. Rather, it should try to prefer using UTXOs that are not the user's preferred address type(s).",
      "created_at": "2022-03-19T01:44:05Z",
      "updated_at": "2022-03-19T01:44:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r830424080",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/830424080"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 790,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832436604",
      "pull_request_review_id": 917608420,
      "id": 832436604,
      "node_id": "PRRC_kwDOABII584xnfl8",
      "diff_hunk": "@@ -767,10 +783,32 @@ static bool CreateTransactionInternal(\n \n     // Get available coins\n     std::vector<COutput> vAvailableCoins;\n-    AvailableCoins(wallet, vAvailableCoins, &coin_control, 1, MAX_MONEY, MAX_MONEY, 0);\n \n-    // Choose coins to use\n-    std::optional<SelectionResult> result = SelectCoins(wallet, vAvailableCoins, /* nTargetValue */ selection_target, coin_control, coin_selection_params);\n+    // First, do coin selection on a filtered subset of coins, filtered by OutputType\n+    // Attempt with older output types first (LEGACY > P2SH > BECH32 > BECH32M)\n+    std::optional<SelectionResult> result = [&] {\n+        // This takes advantange of the fact that OUTPUT_TYPES is already sorted by age (LEGACY, P2SH, BECH32, BECH32M)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 52,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "fdf1fa5e6c35564f33d874b86a45b7b0731f434d",
      "in_reply_to_id": 830424080,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think the amended approach is now that it would pick the input set with the best waste metric score from all SelectionResults of running coin selection on the separate output types.",
      "created_at": "2022-03-22T17:22:43Z",
      "updated_at": "2022-03-22T17:22:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r832436604",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832436604"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 790,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832440386",
      "pull_request_review_id": 917613804,
      "id": 832440386,
      "node_id": "PRRC_kwDOABII584xnghC",
      "diff_hunk": "@@ -767,10 +783,32 @@ static bool CreateTransactionInternal(\n \n     // Get available coins\n     std::vector<COutput> vAvailableCoins;\n-    AvailableCoins(wallet, vAvailableCoins, &coin_control, 1, MAX_MONEY, MAX_MONEY, 0);\n \n-    // Choose coins to use\n-    std::optional<SelectionResult> result = SelectCoins(wallet, vAvailableCoins, /* nTargetValue */ selection_target, coin_control, coin_selection_params);\n+    // First, do coin selection on a filtered subset of coins, filtered by OutputType\n+    // Attempt with older output types first (LEGACY > P2SH > BECH32 > BECH32M)\n+    std::optional<SelectionResult> result = [&] {\n+        // This takes advantange of the fact that OUTPUT_TYPES is already sorted by age (LEGACY, P2SH, BECH32, BECH32M)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 52,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "fdf1fa5e6c35564f33d874b86a45b7b0731f434d",
      "in_reply_to_id": 830424080,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "sorry, forgot to respond to this! yes, rather than rely on a forced ordering of old to new, I'm implementing @Xekyo 's suggestion of running coin selection on each output group and then picking the solution with the best waste metric. If no solution is found, then run coin selection over all coins (current behavior).",
      "created_at": "2022-03-22T17:26:32Z",
      "updated_at": "2022-03-22T17:26:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r832440386",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/832440386"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 790,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836366695",
      "pull_request_review_id": 923057173,
      "id": 836366695,
      "node_id": "PRRC_kwDOABII584x2fFn",
      "diff_hunk": "@@ -186,6 +186,23 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n                 continue;\n             }\n \n+            OutputType output_type{wallet.m_default_address_type};\n+            std::vector<std::vector<uint8_t>> dummy;\n+            TxoutType type{Solver(wtx.tx->vout[i].scriptPubKey, dummy)};\n+            if (type == TxoutType::WITNESS_V1_TAPROOT) {\n+                output_type = OutputType::BECH32M;\n+            } else if (type == TxoutType::WITNESS_V0_KEYHASH) {\n+                output_type = OutputType::BECH32;\n+            } else if (type == TxoutType::SCRIPTHASH) {\n+                output_type = OutputType::P2SH_SEGWIT;\n+            } else if (type == TxoutType::PUBKEYHASH) {\n+                output_type = OutputType::LEGACY;\n+            }",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "fdf1fa5e6c35564f33d874b86a45b7b0731f434d",
      "in_reply_to_id": 828357408,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done! ",
      "created_at": "2022-03-28T12:20:24Z",
      "updated_at": "2022-03-28T12:20:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836366695",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836366695"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 189,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 200,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836367260",
      "pull_request_review_id": 923058023,
      "id": 836367260,
      "node_id": "PRRC_kwDOABII584x2fOc",
      "diff_hunk": "@@ -767,10 +783,32 @@ static bool CreateTransactionInternal(\n \n     // Get available coins\n     std::vector<COutput> vAvailableCoins;\n-    AvailableCoins(wallet, vAvailableCoins, &coin_control, 1, MAX_MONEY, MAX_MONEY, 0);\n \n-    // Choose coins to use\n-    std::optional<SelectionResult> result = SelectCoins(wallet, vAvailableCoins, /* nTargetValue */ selection_target, coin_control, coin_selection_params);\n+    // First, do coin selection on a filtered subset of coins, filtered by OutputType\n+    // Attempt with older output types first (LEGACY > P2SH > BECH32 > BECH32M)\n+    std::optional<SelectionResult> result = [&] {\n+        // This takes advantange of the fact that OUTPUT_TYPES is already sorted by age (LEGACY, P2SH, BECH32, BECH32M)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 52,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "fdf1fa5e6c35564f33d874b86a45b7b0731f434d",
      "in_reply_to_id": 830424080,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I've updated it now to not force an ordering on OutputType.",
      "created_at": "2022-03-28T12:21:08Z",
      "updated_at": "2022-03-28T12:21:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836367260",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836367260"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 790,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836371561",
      "pull_request_review_id": 923064239,
      "id": 836371561,
      "node_id": "PRRC_kwDOABII584x2gRp",
      "diff_hunk": "@@ -22,6 +22,7 @@ enum class OutputType {\n     BECH32M,\n };\n \n+// Keep output types sorted by age, with older types first",
      "path": "src/outputtype.h",
      "position": null,
      "original_position": 4,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "fdf1fa5e6c35564f33d874b86a45b7b0731f434d",
      "in_reply_to_id": 828078777,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "removed, now that it is not dependent on ordering",
      "created_at": "2022-03-28T12:25:59Z",
      "updated_at": "2022-03-28T12:25:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836371561",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836371561"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836394171",
      "pull_request_review_id": 923096287,
      "id": 836394171,
      "node_id": "PRRC_kwDOABII584x2ly7",
      "diff_hunk": "@@ -186,6 +186,23 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n                 continue;\n             }\n \n+            OutputType output_type{wallet.m_default_address_type};\n+            std::vector<std::vector<uint8_t>> dummy;\n+            TxoutType type{Solver(wtx.tx->vout[i].scriptPubKey, dummy)};\n+            if (type == TxoutType::WITNESS_V1_TAPROOT) {\n+                output_type = OutputType::BECH32M;\n+            } else if (type == TxoutType::WITNESS_V0_KEYHASH) {\n+                output_type = OutputType::BECH32;\n+            } else if (type == TxoutType::SCRIPTHASH) {\n+                output_type = OutputType::P2SH_SEGWIT;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e27943dd91afbad679212d61b7b891f9f53818a0",
      "in_reply_to_id": 828302619,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> This is not guaranteed to be true. We could have a P2SH multisig and that would be `LEGACY`.\r\n\r\nso if a `P2SH_SEWGIT` and a `P2SH` multisig were spent together, when the UTXO is later spent it would reveal that some inputs were legacy multisig and others p2sh-segwit? \r\n\r\nAs an alternative, would it be better to map `WITNESS_V0_SCRIPTHASH` to `P2SH` and map `SCRIPTHASH` and `PUBKEYHASH` to `LEGACY`?",
      "created_at": "2022-03-28T12:50:53Z",
      "updated_at": "2022-03-28T12:50:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836394171",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836394171"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 197,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836525661",
      "pull_request_review_id": 923287227,
      "id": 836525661,
      "node_id": "PRRC_kwDOABII584x3F5d",
      "diff_hunk": "@@ -186,6 +186,23 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n                 continue;\n             }\n \n+            OutputType output_type{wallet.m_default_address_type};\n+            std::vector<std::vector<uint8_t>> dummy;\n+            TxoutType type{Solver(wtx.tx->vout[i].scriptPubKey, dummy)};\n+            if (type == TxoutType::WITNESS_V1_TAPROOT) {\n+                output_type = OutputType::BECH32M;\n+            } else if (type == TxoutType::WITNESS_V0_KEYHASH) {\n+                output_type = OutputType::BECH32;\n+            } else if (type == TxoutType::SCRIPTHASH) {\n+                output_type = OutputType::P2SH_SEGWIT;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e27943dd91afbad679212d61b7b891f9f53818a0",
      "in_reply_to_id": 828302619,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "By the time we get determining the output type, we already know that the output either belongs to the wallet, or is watch only. Thus we can do additional solver invocations for scripthash with the redeemScript in order to figure out the true type.\r\n\r\nFor watch only outputs, we may not be able to do that because not all of the scripts will necessarily be available. However we could still use solving data provided in `coinControl` to try to determine that.",
      "created_at": "2022-03-28T14:55:26Z",
      "updated_at": "2022-03-28T14:55:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836525661",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836525661"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 197,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836535681",
      "pull_request_review_id": 923301676,
      "id": 836535681,
      "node_id": "PRRC_kwDOABII584x3IWB",
      "diff_hunk": "@@ -186,6 +186,23 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n                 continue;\n             }\n \n+            OutputType output_type{wallet.m_default_address_type};\n+            std::vector<std::vector<uint8_t>> dummy;\n+            TxoutType type{Solver(wtx.tx->vout[i].scriptPubKey, dummy)};\n+            if (type == TxoutType::WITNESS_V1_TAPROOT) {\n+                output_type = OutputType::BECH32M;\n+            } else if (type == TxoutType::WITNESS_V0_KEYHASH) {\n+                output_type = OutputType::BECH32;\n+            } else if (type == TxoutType::SCRIPTHASH) {\n+                output_type = OutputType::P2SH_SEGWIT;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e27943dd91afbad679212d61b7b891f9f53818a0",
      "in_reply_to_id": 828302619,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "thanks for pointing me in the right direction! I'll take a stab at implementing this",
      "created_at": "2022-03-28T15:04:39Z",
      "updated_at": "2022-03-28T15:04:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836535681",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836535681"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 197,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836601796",
      "pull_request_review_id": 923394293,
      "id": 836601796,
      "node_id": "PRRC_kwDOABII584x3YfE",
      "diff_hunk": "@@ -36,9 +36,9 @@ def run_test(self):\n \n         self.generate(self.nodes[1], COINBASE_MATURITY)\n         balance = alice.getbalance()\n-        txA = alice.sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n-        txB = alice.sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n-        txC = alice.sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n+        txA = self.nodes[1].sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n+        txB = self.nodes[1].sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n+        txC = self.nodes[1].sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n         self.sync_mempools()\n         self.generate(self.nodes[1], 1)",
      "path": "test/functional/wallet_abandonconflict.py",
      "position": null,
      "original_position": 11,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e556ee628e97b10bc4f4d82036c9758d4e14d298",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Review note: I first thought that the `self.generate(self.nodes[1], 1)` here would of course confirm all of the above transactions, but this obviously only happens after all three transactions get built, which means that unconfirmed change UTXOs could have been used in construction of the latter.\r\n\r\nNote to author: This may point to an underlying problem. Since the UTXO pools divided by type are much smaller, the backoff steps allowing for unconfirmed change to be used may come into play much more often. Then, since the waste metric does not yet account for the unconfirmed inputs, we may spend unconfirmed UTXOs more often. This in turn may cause a problem especially if the follow-up transaction is aiming for a higher feerate than the transaction that created the unconfirmed input, at least while https://github.com/bitcoin/bitcoin/issues/15553 remains unsolved. ",
      "created_at": "2022-03-28T16:07:45Z",
      "updated_at": "2022-03-28T21:53:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836601796",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836601796"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 43,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836686905",
      "pull_request_review_id": 923394293,
      "id": 836686905,
      "node_id": "PRRC_kwDOABII584x3tQ5",
      "diff_hunk": "@@ -293,7 +293,7 @@ def test_getbalances_used(self):\n \n         # send multiple transactions, reusing one address\n         for _ in range(101):\n-            self.nodes[0].sendtoaddress(new_addr, 1)",
      "path": "test/functional/wallet_avoidreuse.py",
      "position": null,
      "original_position": 4,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "eaaece5598c713e4698c379dfbceefac4be44992",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It's not clear to me why this change is being made. There don't seem to be any checks or asserts referring to the UTXO pool of `nodes[0]`, and wouldn't all the coinbase outputs and change outputs be of the same type?",
      "created_at": "2022-03-28T17:41:07Z",
      "updated_at": "2022-03-28T21:53:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836686905",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836686905"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 307,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836690832",
      "pull_request_review_id": 923394293,
      "id": 836690832,
      "node_id": "PRRC_kwDOABII584x3uOQ",
      "diff_hunk": "@@ -81,11 +81,34 @@ TxSize CalculateMaximumSignedTxSize(const CTransaction &tx, const CWallet *walle\n     return CalculateMaximumSignedTxSize(tx, wallet, txouts, coin_control);\n }\n \n-void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const CCoinControl* coinControl, const CAmount& nMinimumAmount, const CAmount& nMaximumAmount, const CAmount& nMinimumSumAmount, const uint64_t nMaximumCount)\n+uint64_t AvailableCoins::size() {\n+    return Bech32m.size() + Bech32.size() + P2SH.size() + Legacy.size() + Other.size();\n+}\n+\n+std::vector<COutput> AvailableCoins::all() {\n+    std::vector<COutput> all;\n+    all.reserve(Bech32m.size() + Bech32.size() + P2SH.size() + Legacy.size());",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 11,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "4c634ea19220d6d1f4647e553909b5e0dfd1910e",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Why does this `reserve()` not include `Other.size()`?",
      "created_at": "2022-03-28T17:44:05Z",
      "updated_at": "2022-03-28T21:53:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836690832",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836690832"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 90,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836696846",
      "pull_request_review_id": 923394293,
      "id": 836696846,
      "node_id": "PRRC_kwDOABII584x3vsO",
      "diff_hunk": "@@ -189,7 +212,26 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n             bool spendable = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (((mine & ISMINE_WATCH_ONLY) != ISMINE_NO) && (coinControl && coinControl->fAllowWatchOnly && solvable));\n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n \n-            vCoins.emplace_back(COutPoint(wtx.GetHash(), i), wtx.tx->vout.at(i), nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me);\n+            std::vector<std::vector<uint8_t>> dummy;\n+            TxoutType type{Solver(wtx.tx->vout[i].scriptPubKey, dummy)};",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "4c634ea19220d6d1f4647e553909b5e0dfd1910e",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Maybe call this `return_value_unused`.\r\n\r\nIt's not obvious what this `dummy` is and why it's needed. I take it that it's a return value for the script solver to put the actual solution components in, and we don't care about it here because we only want to learn the type. Perhaps you could add a comment here to elucidate that for future reviewers.\r\n",
      "created_at": "2022-03-28T17:51:32Z",
      "updated_at": "2022-03-28T21:53:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836696846",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836696846"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 215,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 216,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836700177",
      "pull_request_review_id": 923394293,
      "id": 836700177,
      "node_id": "PRRC_kwDOABII584x3wgR",
      "diff_hunk": "@@ -816,9 +816,40 @@ static bool CreateTransactionInternal(\n     // Get available coins",
      "path": "src/wallet/spend.cpp",
      "position": 270,
      "original_position": 1,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "49d802f25cac9390fb715b0bd4051c5e592365e3",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Commit message in \"wallet: run coin selection by OutputType\" 49d802f25cac9390fb715b0bd4051c5e592365e3 is missing a word in the first sentence of the body.",
      "created_at": "2022-03-28T17:55:46Z",
      "updated_at": "2022-03-28T21:53:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836700177",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836700177"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 886,
      "original_line": 886,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836705322",
      "pull_request_review_id": 923394293,
      "id": 836705322,
      "node_id": "PRRC_kwDOABII584x3xwq",
      "diff_hunk": "@@ -816,9 +816,40 @@ static bool CreateTransactionInternal(\n     // Get available coins\n     AvailableCoins availableCoins;\n     GetAvailableCoins(wallet, availableCoins, &coin_control, 1, MAX_MONEY, MAX_MONEY, 0);\n- \n-    // Choose coins to use\n-    std::optional<SelectionResult> result = SelectCoins(wallet, availableCoins.all(), /* nTargetValue */ selection_target, coin_control, coin_selection_params);\n+\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result1{SelectCoins(wallet, availableCoins.Legacy, /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {\n+        result1->ComputeAndSetWaste(coin_selection_params.m_cost_of_change);\n+        results.push_back(*result1);\n+    };\n+    if (auto result2{SelectCoins(wallet, availableCoins.P2SH, /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {\n+        result2->ComputeAndSetWaste(coin_selection_params.m_cost_of_change);\n+        results.push_back(*result2);\n+    };\n+    if (auto result3{SelectCoins(wallet, availableCoins.Bech32, /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {\n+        result3->ComputeAndSetWaste(coin_selection_params.m_cost_of_change);\n+        results.push_back(*result3);\n+    };\n+    if (auto result4{SelectCoins(wallet, availableCoins.Bech32m, /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {\n+        result4->ComputeAndSetWaste(coin_selection_params.m_cost_of_change);\n+        results.push_back(*result4);\n+    };\n+\n+    // If we can't fund the transaction from any individual OutputType, run coin selection\n+    // over all available coins, else pick the best solution from the results\n+    std::optional<SelectionResult> result = [&] {\n+        if (results.size() == 0) {\n+            if (auto result5{SelectCoins(wallet, availableCoins.all(), /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {\n+                result5->ComputeAndSetWaste(coin_selection_params.m_cost_of_change);\n+                return result5;\n+            }\n+            return std::optional<SelectionResult>();\n+        };\n+        std::optional<SelectionResult> best_result = *std::min_element(results.begin(), results.end());\n+        best_result->ComputeAndSetWaste(coin_selection_params.m_cost_of_change);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 38,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "49d802f25cac9390fb715b0bd4051c5e592365e3",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Wouldn't the `best_result` necessarily already have a waste score since we do that above already?",
      "created_at": "2022-03-28T18:02:14Z",
      "updated_at": "2022-03-28T21:53:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836705322",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836705322"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 850,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836706638",
      "pull_request_review_id": 923394293,
      "id": 836706638,
      "node_id": "PRRC_kwDOABII584x3yFO",
      "diff_hunk": "@@ -816,9 +816,40 @@ static bool CreateTransactionInternal(\n     // Get available coins\n     AvailableCoins availableCoins;\n     GetAvailableCoins(wallet, availableCoins, &coin_control, 1, MAX_MONEY, MAX_MONEY, 0);\n- \n-    // Choose coins to use\n-    std::optional<SelectionResult> result = SelectCoins(wallet, availableCoins.all(), /* nTargetValue */ selection_target, coin_control, coin_selection_params);\n+\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result1{SelectCoins(wallet, availableCoins.Legacy, /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 10,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "49d802f25cac9390fb715b0bd4051c5e592365e3",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Why `result` instead of `result_legacy`, `result_p2sh`, ?",
      "created_at": "2022-03-28T18:03:55Z",
      "updated_at": "2022-03-28T21:53:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836706638",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836706638"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 822,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836709314",
      "pull_request_review_id": 923394293,
      "id": 836709314,
      "node_id": "PRRC_kwDOABII584x3yvC",
      "diff_hunk": "@@ -816,9 +816,40 @@ static bool CreateTransactionInternal(\n     // Get available coins\n     AvailableCoins availableCoins;\n     GetAvailableCoins(wallet, availableCoins, &coin_control, 1, MAX_MONEY, MAX_MONEY, 0);\n- \n-    // Choose coins to use\n-    std::optional<SelectionResult> result = SelectCoins(wallet, availableCoins.all(), /* nTargetValue */ selection_target, coin_control, coin_selection_params);\n+\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result1{SelectCoins(wallet, availableCoins.Legacy, /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {\n+        result1->ComputeAndSetWaste(coin_selection_params.m_cost_of_change);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 11,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "49d802f25cac9390fb715b0bd4051c5e592365e3",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm a bit surprised that we need to post-process all the `SelectionResults` when they get returned with `ComputeAndSetWaste()`. It would feel more natural, that each coin selection algorithm automatically calculates the waste and returns it in the `SelectionResults` if the feerate is known (which is obvious from `coin_control`, I think. \r\n\r\nAlso, if we do need it, you could just collect all the results and then run it once for each result at the end of this block.",
      "created_at": "2022-03-28T18:07:37Z",
      "updated_at": "2022-03-28T21:53:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836709314",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836709314"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 823,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836711238",
      "pull_request_review_id": 923394293,
      "id": 836711238,
      "node_id": "PRRC_kwDOABII584x3zNG",
      "diff_hunk": "@@ -816,9 +816,40 @@ static bool CreateTransactionInternal(\n     // Get available coins\n     AvailableCoins availableCoins;\n     GetAvailableCoins(wallet, availableCoins, &coin_control, 1, MAX_MONEY, MAX_MONEY, 0);\n- \n-    // Choose coins to use\n-    std::optional<SelectionResult> result = SelectCoins(wallet, availableCoins.all(), /* nTargetValue */ selection_target, coin_control, coin_selection_params);\n+\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result1{SelectCoins(wallet, availableCoins.Legacy, /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {\n+        result1->ComputeAndSetWaste(coin_selection_params.m_cost_of_change);\n+        results.push_back(*result1);\n+    };\n+    if (auto result2{SelectCoins(wallet, availableCoins.P2SH, /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {\n+        result2->ComputeAndSetWaste(coin_selection_params.m_cost_of_change);\n+        results.push_back(*result2);\n+    };\n+    if (auto result3{SelectCoins(wallet, availableCoins.Bech32, /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {\n+        result3->ComputeAndSetWaste(coin_selection_params.m_cost_of_change);\n+        results.push_back(*result3);\n+    };\n+    if (auto result4{SelectCoins(wallet, availableCoins.Bech32m, /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {\n+        result4->ComputeAndSetWaste(coin_selection_params.m_cost_of_change);\n+        results.push_back(*result4);\n+    };\n+\n+    // If we can't fund the transaction from any individual OutputType, run coin selection\n+    // over all available coins, else pick the best solution from the results\n+    std::optional<SelectionResult> result = [&] {\n+        if (results.size() == 0) {\n+            if (auto result5{SelectCoins(wallet, availableCoins.all(), /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {\n+                result5->ComputeAndSetWaste(coin_selection_params.m_cost_of_change);\n+                return result5;\n+            }\n+            return std::optional<SelectionResult>();",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "49d802f25cac9390fb715b0bd4051c5e592365e3",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Shouldn't this `return std::nullopt;` if there is no solution?",
      "created_at": "2022-03-28T18:10:10Z",
      "updated_at": "2022-03-28T21:53:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836711238",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836711238"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 847,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836712042",
      "pull_request_review_id": 923394293,
      "id": 836712042,
      "node_id": "PRRC_kwDOABII584x3zZq",
      "diff_hunk": "@@ -816,9 +816,40 @@ static bool CreateTransactionInternal(\n     // Get available coins\n     AvailableCoins availableCoins;\n     GetAvailableCoins(wallet, availableCoins, &coin_control, 1, MAX_MONEY, MAX_MONEY, 0);\n- \n-    // Choose coins to use\n-    std::optional<SelectionResult> result = SelectCoins(wallet, availableCoins.all(), /* nTargetValue */ selection_target, coin_control, coin_selection_params);\n+\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result1{SelectCoins(wallet, availableCoins.Legacy, /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 10,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "49d802f25cac9390fb715b0bd4051c5e592365e3",
      "in_reply_to_id": 836706638,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Why even number them at all, they could all just be `result` since it's a local variable?",
      "created_at": "2022-03-28T18:11:11Z",
      "updated_at": "2022-03-28T21:53:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836712042",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836712042"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 822,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836719593",
      "pull_request_review_id": 923394293,
      "id": 836719593,
      "node_id": "PRRC_kwDOABII584x31Pp",
      "diff_hunk": "@@ -0,0 +1,214 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. It does so by covering the following cases:\n+\n+    CASE 1: Alice mixed UTXOs (bech32, P2SH). She makes multiple payments\n+            to Bob, where bech32 UTXOs are preferred at higher fee rates\n+            and P2SH are preffered at lower fee rates.\n+    CASE 2: Alice has mixed UTXOs (P2SH, bech32, legacy) and makes multiple\n+            payments to Bob's bech32 address, where legacy is preferred at\n+            low fee rates, P2SH at medium fee rates, and bech32 at high rates.\n+    CASE 3: Alice has mixed UTXOs (legacy, P2SH, bech32) and makes multiple\n+            payments to Bob, where legacy and P2SH are mixed at lower fee rates\n+            and finally all UTXOs are mixed for the final payment.\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.util import assert_equal\n+\n+\n+def get_change_output(tx, addr):\n+    \"\"\"Get change address from transaction.\"\"\"\n+    return [\n+        vout['scriptPubKey']['address']\n+        for vout in tx['vout']\n+        if vout['scriptPubKey']['address'] != addr\n+    ][0]\n+\n+\n+def get_input_addresses(node, tx):\n+    \"\"\"Get all input addresses for a given transaction.\"\"\"\n+    vins = node.getrawtransaction(tx, True)['vin']\n+    addresses = []\n+    for vin in vins:\n+        prev_tx, n = vin['txid'], vin['vout']\n+        addresses.append(\n+            node.getrawtransaction(\n+                prev_tx,\n+                True,\n+            )['vout'][n]['scriptPubKey']['address']\n+        )\n+    return addresses\n+\n+\n+def bech32_address(node, addr):",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 57,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "072e755e553d3502572d7db1cbe04d73e31b6b2e",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Perhaps call these `is_`, i.e. `is_bech32_address()`, because you're testing the input object for a property and returning a boolean.",
      "created_at": "2022-03-28T18:19:01Z",
      "updated_at": "2022-03-28T21:53:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836719593",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836719593"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 57,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836726166",
      "pull_request_review_id": 923394293,
      "id": 836726166,
      "node_id": "PRRC_kwDOABII584x322W",
      "diff_hunk": "@@ -0,0 +1,214 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. It does so by covering the following cases:\n+\n+    CASE 1: Alice mixed UTXOs (bech32, P2SH). She makes multiple payments\n+            to Bob, where bech32 UTXOs are preferred at higher fee rates\n+            and P2SH are preffered at lower fee rates.\n+    CASE 2: Alice has mixed UTXOs (P2SH, bech32, legacy) and makes multiple\n+            payments to Bob's bech32 address, where legacy is preferred at\n+            low fee rates, P2SH at medium fee rates, and bech32 at high rates.\n+    CASE 3: Alice has mixed UTXOs (legacy, P2SH, bech32) and makes multiple\n+            payments to Bob, where legacy and P2SH are mixed at lower fee rates\n+            and finally all UTXOs are mixed for the final payment.\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.util import assert_equal\n+\n+\n+def get_change_output(tx, addr):\n+    \"\"\"Get change address from transaction.\"\"\"\n+    return [\n+        vout['scriptPubKey']['address']\n+        for vout in tx['vout']\n+        if vout['scriptPubKey']['address'] != addr\n+    ][0]\n+\n+\n+def get_input_addresses(node, tx):\n+    \"\"\"Get all input addresses for a given transaction.\"\"\"\n+    vins = node.getrawtransaction(tx, True)['vin']\n+    addresses = []\n+    for vin in vins:\n+        prev_tx, n = vin['txid'], vin['vout']\n+        addresses.append(\n+            node.getrawtransaction(\n+                prev_tx,\n+                True,\n+            )['vout'][n]['scriptPubKey']['address']\n+        )\n+    return addresses\n+\n+\n+def bech32_address(node, addr):\n+    \"\"\"Check if an address cointains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        not addr_info['isscript'] and\n+        addr_info['iswitness'] and addr_info['witness_version'] == 0\n+    )\n+\n+\n+def p2sh_address(node, addr):\n+    \"\"\"Check if an address cointains a P2SH output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        addr_info['isscript'] and\n+        not addr_info['iswitness'] and\n+        addr_info['script'] == 'witness_v0_keyhash'\n+    )\n+\n+\n+def legacy_address(node, addr):\n+    \"\"\"Check if an address cointains a legacy output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (not addr_info['isscript'] and not addr_info['iswitness'])\n+\n+\n+class AddressInputTypeGrouping(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 2\n+        self.extra_args = [\n+            [\n+                \"-addresstype=bech32\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+            [\n+                \"-addresstype=p2sh-segwit\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+        ]\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def test_case_one(self, A, B):\n+        self.log.debug(\n+            \"Pay Bob's P2SH address, creating a P2SH change UTXO for Alice\"\n+        )\n+        p2sh_addr = B.getnewaddress()\n+        tx1 = A.sendtoaddress(p2sh_addr, 5)\n+        change = get_change_output(A.getrawtransaction(tx1, True), p2sh_addr)\n+        assert p2sh_address(A, change)\n+\n+        self.generate(B, 1)\n+\n+        self.log.debug(\n+            \"Pay Bob's P2SH address, verify P2SH UTXO from previous Tx is used\"\n+        )\n+        tx2 = A.sendtoaddress(address=B.getnewaddress(), amount=5, fee_rate=1)\n+        input_addrs = get_input_addresses(A, tx2)\n+        assert_equal(len(input_addrs), 1)\n+        assert_equal(change, input_addrs[0])\n+\n+        self.generate(B, 1)\n+        self.log.debug(\n+            \"Make the same payment again, with a higher feerate. \"\n+            \"Check that Alice's wallet prefers bech32 UTXOs.\"\n+        )",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 125,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "072e755e553d3502572d7db1cbe04d73e31b6b2e",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm wondering whether there is a misunderstanding here. It's not that certain types are strictly preferred at the corresponding feerate categories, but that larger input scripts will simply affect the waste score more due to their size in either direction due to their larger transaction weight. This in turn leads to a higher waste score for _the same count of_ legacy inputs at high feerates vs more efficient types, and a more negative waste score at low feerates. Obviously, this would cause one specific type to always win if you always have the same count of inputs among the options, but wouldn't necessarily hold true if the input sets could have varying input counts.",
      "created_at": "2022-03-28T18:27:37Z",
      "updated_at": "2022-03-28T21:53:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836726166",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836726166"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 122,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 125,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836733063",
      "pull_request_review_id": 923394293,
      "id": 836733063,
      "node_id": "PRRC_kwDOABII584x34iH",
      "diff_hunk": "@@ -0,0 +1,214 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. It does so by covering the following cases:\n+\n+    CASE 1: Alice mixed UTXOs (bech32, P2SH). She makes multiple payments\n+            to Bob, where bech32 UTXOs are preferred at higher fee rates\n+            and P2SH are preffered at lower fee rates.\n+    CASE 2: Alice has mixed UTXOs (P2SH, bech32, legacy) and makes multiple\n+            payments to Bob's bech32 address, where legacy is preferred at\n+            low fee rates, P2SH at medium fee rates, and bech32 at high rates.\n+    CASE 3: Alice has mixed UTXOs (legacy, P2SH, bech32) and makes multiple\n+            payments to Bob, where legacy and P2SH are mixed at lower fee rates\n+            and finally all UTXOs are mixed for the final payment.\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.util import assert_equal\n+\n+\n+def get_change_output(tx, addr):\n+    \"\"\"Get change address from transaction.\"\"\"\n+    return [\n+        vout['scriptPubKey']['address']\n+        for vout in tx['vout']\n+        if vout['scriptPubKey']['address'] != addr\n+    ][0]\n+\n+\n+def get_input_addresses(node, tx):\n+    \"\"\"Get all input addresses for a given transaction.\"\"\"\n+    vins = node.getrawtransaction(tx, True)['vin']\n+    addresses = []\n+    for vin in vins:\n+        prev_tx, n = vin['txid'], vin['vout']\n+        addresses.append(\n+            node.getrawtransaction(\n+                prev_tx,\n+                True,\n+            )['vout'][n]['scriptPubKey']['address']\n+        )\n+    return addresses\n+\n+\n+def bech32_address(node, addr):\n+    \"\"\"Check if an address cointains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        not addr_info['isscript'] and\n+        addr_info['iswitness'] and addr_info['witness_version'] == 0\n+    )\n+\n+\n+def p2sh_address(node, addr):\n+    \"\"\"Check if an address cointains a P2SH output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        addr_info['isscript'] and\n+        not addr_info['iswitness'] and\n+        addr_info['script'] == 'witness_v0_keyhash'\n+    )\n+\n+\n+def legacy_address(node, addr):\n+    \"\"\"Check if an address cointains a legacy output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (not addr_info['isscript'] and not addr_info['iswitness'])\n+\n+\n+class AddressInputTypeGrouping(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 2\n+        self.extra_args = [\n+            [\n+                \"-addresstype=bech32\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+            [\n+                \"-addresstype=p2sh-segwit\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+        ]\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def test_case_one(self, A, B):",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 102,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "072e755e553d3502572d7db1cbe04d73e31b6b2e",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "What is the starting situation of the nodes. Are they both empty? Is Alice or Bob the default node that has the previous block rewards? Do they both have funds? Are the funds all of one type, or mixed?",
      "created_at": "2022-03-28T18:36:46Z",
      "updated_at": "2022-03-28T21:53:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836733063",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836733063"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 102,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836736105",
      "pull_request_review_id": 923394293,
      "id": 836736105,
      "node_id": "PRRC_kwDOABII584x35Rp",
      "diff_hunk": "@@ -0,0 +1,214 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. It does so by covering the following cases:\n+\n+    CASE 1: Alice mixed UTXOs (bech32, P2SH). She makes multiple payments\n+            to Bob, where bech32 UTXOs are preferred at higher fee rates\n+            and P2SH are preffered at lower fee rates.\n+    CASE 2: Alice has mixed UTXOs (P2SH, bech32, legacy) and makes multiple\n+            payments to Bob's bech32 address, where legacy is preferred at\n+            low fee rates, P2SH at medium fee rates, and bech32 at high rates.\n+    CASE 3: Alice has mixed UTXOs (legacy, P2SH, bech32) and makes multiple\n+            payments to Bob, where legacy and P2SH are mixed at lower fee rates\n+            and finally all UTXOs are mixed for the final payment.",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 25,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "072e755e553d3502572d7db1cbe04d73e31b6b2e",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It feels that these tests are more focused on the cost efficiency of the input sets than validating that input sets of only one type are produced.\r\n\r\n Could you perhaps provide a bit more information on the initial setup of the wallets' UTXO pools?\r\n From what I gather, most of these tests end up using a single input to fund their transactions. A single input transaction will always have the same type for all inputs. :grin: Given that I understood that right, it would be more convincing if the wallets had to select from a number of UTXOs of various values and types, and needed to pick multiple UTXOs to create the input set, while you then showed that we consistently pick input sets with multiple inputs of the same type. I also feel that the inputs being of the same type would be the more important aspect of this PR rather than which type of inputs gets chosen exactly, although showing that the solution with the lower waste was picked would certainly be an appreciated secondary test scenario.\r\n The way these tests are implemented right now, they may be a bit too tightly coupled to the exact behavior of the coin selection algorithms we currently use, but I am hoping to change the composition of coin selection algorithms in the near term. This would be another reason why I'd prefer if the test were implemented more generically \"all input have the same type\" vs \"exactly this type of inputs gets chosen\". :)",
      "created_at": "2022-03-28T18:39:21Z",
      "updated_at": "2022-03-28T21:53:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836736105",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/836736105"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 17,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/837326312",
      "pull_request_review_id": 924406228,
      "id": 837326312,
      "node_id": "PRRC_kwDOABII584x6JXo",
      "diff_hunk": "@@ -36,9 +36,9 @@ def run_test(self):\n \n         self.generate(self.nodes[1], COINBASE_MATURITY)\n         balance = alice.getbalance()\n-        txA = alice.sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n-        txB = alice.sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n-        txC = alice.sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n+        txA = self.nodes[1].sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n+        txB = self.nodes[1].sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n+        txC = self.nodes[1].sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n         self.sync_mempools()\n         self.generate(self.nodes[1], 1)",
      "path": "test/functional/wallet_abandonconflict.py",
      "position": null,
      "original_position": 11,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e556ee628e97b10bc4f4d82036c9758d4e14d298",
      "in_reply_to_id": 836601796,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "interesting, is it by design that the waste metric does not consider unconfirmed change? a few ideas to address this:\r\n\r\n1) have the waste metric also consider unconfirmed change\r\n2) consider things like unconfirmed inputs when comparing solutions\r\n\r\nfor example, if solution A is to spend all confirmed inputs with a waste metric of X and solution B spends unconfirmed change with a waste metric of Y, prefer solution A even if X > Y.",
      "created_at": "2022-03-29T10:41:07Z",
      "updated_at": "2022-03-29T10:41:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r837326312",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/837326312"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 43,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838507157",
      "pull_request_review_id": 926067154,
      "id": 838507157,
      "node_id": "PRRC_kwDOABII584x-pqV",
      "diff_hunk": "@@ -293,7 +293,7 @@ def test_getbalances_used(self):\n \n         # send multiple transactions, reusing one address\n         for _ in range(101):\n-            self.nodes[0].sendtoaddress(new_addr, 1)",
      "path": "test/functional/wallet_avoidreuse.py",
      "position": null,
      "original_position": 4,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "eaaece5598c713e4698c379dfbceefac4be44992",
      "in_reply_to_id": 836686905,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "this is related to your earlier comment (https://github.com/bitcoin/bitcoin/pull/24584#discussion_r836601796) regarding unconfirmed UTXOs being spent more often. In this test, after the first tx is sent, the next 100 txs build a chain where the unconfirmed change is being spent, eventually hitting the mempool chain limit of 25 and causing an error. By explicitly setting `fee_rate=1`, `nodes[0]` starts spending its confirmed coinbase UTXOs instead.\r\n\r\nThis also demonstrates your earlier point that this change is causing unconfirmed outputs to be spent more often",
      "created_at": "2022-03-30T12:53:18Z",
      "updated_at": "2022-03-30T12:53:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r838507157",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838507157"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 307,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838507751",
      "pull_request_review_id": 926067979,
      "id": 838507751,
      "node_id": "PRRC_kwDOABII584x-pzn",
      "diff_hunk": "@@ -81,11 +81,34 @@ TxSize CalculateMaximumSignedTxSize(const CTransaction &tx, const CWallet *walle\n     return CalculateMaximumSignedTxSize(tx, wallet, txouts, coin_control);\n }\n \n-void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const CCoinControl* coinControl, const CAmount& nMinimumAmount, const CAmount& nMaximumAmount, const CAmount& nMinimumSumAmount, const uint64_t nMaximumCount)\n+uint64_t AvailableCoins::size() {\n+    return Bech32m.size() + Bech32.size() + P2SH.size() + Legacy.size() + Other.size();\n+}\n+\n+std::vector<COutput> AvailableCoins::all() {\n+    std::vector<COutput> all;\n+    all.reserve(Bech32m.size() + Bech32.size() + P2SH.size() + Legacy.size());",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 11,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "4c634ea19220d6d1f4647e553909b5e0dfd1910e",
      "in_reply_to_id": 836690832,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "good catch, it should include `Other.size()`",
      "created_at": "2022-03-30T12:53:53Z",
      "updated_at": "2022-03-30T12:53:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r838507751",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838507751"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 90,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838509498",
      "pull_request_review_id": 926070412,
      "id": 838509498,
      "node_id": "PRRC_kwDOABII584x-qO6",
      "diff_hunk": "@@ -816,9 +816,40 @@ static bool CreateTransactionInternal(\n     // Get available coins\n     AvailableCoins availableCoins;\n     GetAvailableCoins(wallet, availableCoins, &coin_control, 1, MAX_MONEY, MAX_MONEY, 0);\n- \n-    // Choose coins to use\n-    std::optional<SelectionResult> result = SelectCoins(wallet, availableCoins.all(), /* nTargetValue */ selection_target, coin_control, coin_selection_params);\n+\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result1{SelectCoins(wallet, availableCoins.Legacy, /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 10,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "49d802f25cac9390fb715b0bd4051c5e592365e3",
      "in_reply_to_id": 836706638,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "you're right, they can all be named `result` and I think that's better than having individual names for each run (`result_legacy`, `result_p2sh`, etc)",
      "created_at": "2022-03-30T12:55:30Z",
      "updated_at": "2022-03-30T12:55:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r838509498",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838509498"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 822,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838512077",
      "pull_request_review_id": 926073903,
      "id": 838512077,
      "node_id": "PRRC_kwDOABII584x-q3N",
      "diff_hunk": "@@ -0,0 +1,214 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. It does so by covering the following cases:\n+\n+    CASE 1: Alice mixed UTXOs (bech32, P2SH). She makes multiple payments\n+            to Bob, where bech32 UTXOs are preferred at higher fee rates\n+            and P2SH are preffered at lower fee rates.\n+    CASE 2: Alice has mixed UTXOs (P2SH, bech32, legacy) and makes multiple\n+            payments to Bob's bech32 address, where legacy is preferred at\n+            low fee rates, P2SH at medium fee rates, and bech32 at high rates.\n+    CASE 3: Alice has mixed UTXOs (legacy, P2SH, bech32) and makes multiple\n+            payments to Bob, where legacy and P2SH are mixed at lower fee rates\n+            and finally all UTXOs are mixed for the final payment.\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.util import assert_equal\n+\n+\n+def get_change_output(tx, addr):\n+    \"\"\"Get change address from transaction.\"\"\"\n+    return [\n+        vout['scriptPubKey']['address']\n+        for vout in tx['vout']\n+        if vout['scriptPubKey']['address'] != addr\n+    ][0]\n+\n+\n+def get_input_addresses(node, tx):\n+    \"\"\"Get all input addresses for a given transaction.\"\"\"\n+    vins = node.getrawtransaction(tx, True)['vin']\n+    addresses = []\n+    for vin in vins:\n+        prev_tx, n = vin['txid'], vin['vout']\n+        addresses.append(\n+            node.getrawtransaction(\n+                prev_tx,\n+                True,\n+            )['vout'][n]['scriptPubKey']['address']\n+        )\n+    return addresses\n+\n+\n+def bech32_address(node, addr):\n+    \"\"\"Check if an address cointains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        not addr_info['isscript'] and\n+        addr_info['iswitness'] and addr_info['witness_version'] == 0\n+    )\n+\n+\n+def p2sh_address(node, addr):\n+    \"\"\"Check if an address cointains a P2SH output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        addr_info['isscript'] and\n+        not addr_info['iswitness'] and\n+        addr_info['script'] == 'witness_v0_keyhash'\n+    )\n+\n+\n+def legacy_address(node, addr):\n+    \"\"\"Check if an address cointains a legacy output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (not addr_info['isscript'] and not addr_info['iswitness'])\n+\n+\n+class AddressInputTypeGrouping(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 2\n+        self.extra_args = [\n+            [\n+                \"-addresstype=bech32\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+            [\n+                \"-addresstype=p2sh-segwit\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+        ]\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def test_case_one(self, A, B):\n+        self.log.debug(\n+            \"Pay Bob's P2SH address, creating a P2SH change UTXO for Alice\"\n+        )\n+        p2sh_addr = B.getnewaddress()\n+        tx1 = A.sendtoaddress(p2sh_addr, 5)\n+        change = get_change_output(A.getrawtransaction(tx1, True), p2sh_addr)\n+        assert p2sh_address(A, change)\n+\n+        self.generate(B, 1)\n+\n+        self.log.debug(\n+            \"Pay Bob's P2SH address, verify P2SH UTXO from previous Tx is used\"\n+        )\n+        tx2 = A.sendtoaddress(address=B.getnewaddress(), amount=5, fee_rate=1)\n+        input_addrs = get_input_addresses(A, tx2)\n+        assert_equal(len(input_addrs), 1)\n+        assert_equal(change, input_addrs[0])\n+\n+        self.generate(B, 1)\n+        self.log.debug(\n+            \"Make the same payment again, with a higher feerate. \"\n+            \"Check that Alice's wallet prefers bech32 UTXOs.\"\n+        )",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 125,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "072e755e553d3502572d7db1cbe04d73e31b6b2e",
      "in_reply_to_id": 836726166,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think we are on the same page, it's just my wording in the comments isn't correct. Initially, I wrote the comments for when I was strictly preferring older types to newer types. I'll update these comments to be more accurate.",
      "created_at": "2022-03-30T12:57:40Z",
      "updated_at": "2022-03-30T12:57:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r838512077",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838512077"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 122,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 125,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838514332",
      "pull_request_review_id": 926077187,
      "id": 838514332,
      "node_id": "PRRC_kwDOABII584x-rac",
      "diff_hunk": "@@ -0,0 +1,214 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. It does so by covering the following cases:\n+\n+    CASE 1: Alice mixed UTXOs (bech32, P2SH). She makes multiple payments\n+            to Bob, where bech32 UTXOs are preferred at higher fee rates\n+            and P2SH are preffered at lower fee rates.\n+    CASE 2: Alice has mixed UTXOs (P2SH, bech32, legacy) and makes multiple\n+            payments to Bob's bech32 address, where legacy is preferred at\n+            low fee rates, P2SH at medium fee rates, and bech32 at high rates.\n+    CASE 3: Alice has mixed UTXOs (legacy, P2SH, bech32) and makes multiple\n+            payments to Bob, where legacy and P2SH are mixed at lower fee rates\n+            and finally all UTXOs are mixed for the final payment.\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.util import assert_equal\n+\n+\n+def get_change_output(tx, addr):\n+    \"\"\"Get change address from transaction.\"\"\"\n+    return [\n+        vout['scriptPubKey']['address']\n+        for vout in tx['vout']\n+        if vout['scriptPubKey']['address'] != addr\n+    ][0]\n+\n+\n+def get_input_addresses(node, tx):\n+    \"\"\"Get all input addresses for a given transaction.\"\"\"\n+    vins = node.getrawtransaction(tx, True)['vin']\n+    addresses = []\n+    for vin in vins:\n+        prev_tx, n = vin['txid'], vin['vout']\n+        addresses.append(\n+            node.getrawtransaction(\n+                prev_tx,\n+                True,\n+            )['vout'][n]['scriptPubKey']['address']\n+        )\n+    return addresses\n+\n+\n+def bech32_address(node, addr):\n+    \"\"\"Check if an address cointains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        not addr_info['isscript'] and\n+        addr_info['iswitness'] and addr_info['witness_version'] == 0\n+    )\n+\n+\n+def p2sh_address(node, addr):\n+    \"\"\"Check if an address cointains a P2SH output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        addr_info['isscript'] and\n+        not addr_info['iswitness'] and\n+        addr_info['script'] == 'witness_v0_keyhash'\n+    )\n+\n+\n+def legacy_address(node, addr):\n+    \"\"\"Check if an address cointains a legacy output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (not addr_info['isscript'] and not addr_info['iswitness'])\n+\n+\n+class AddressInputTypeGrouping(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 2\n+        self.extra_args = [\n+            [\n+                \"-addresstype=bech32\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+            [\n+                \"-addresstype=p2sh-segwit\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+        ]\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def test_case_one(self, A, B):",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 102,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "072e755e553d3502572d7db1cbe04d73e31b6b2e",
      "in_reply_to_id": 836733063,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "good point, both nodes are starting with a clean chain (`setup_clean_chain = True`), and then node A mines 100 blocks in `run_test`.\r\n\r\nMuch better would be to explain this at the beginning of the test so it's clear what the respective UTXO sets for each node are.",
      "created_at": "2022-03-30T12:59:53Z",
      "updated_at": "2022-03-30T12:59:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r838514332",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838514332"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 102,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838518664",
      "pull_request_review_id": 926083579,
      "id": 838518664,
      "node_id": "PRRC_kwDOABII584x-seI",
      "diff_hunk": "@@ -0,0 +1,214 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. It does so by covering the following cases:\n+\n+    CASE 1: Alice mixed UTXOs (bech32, P2SH). She makes multiple payments\n+            to Bob, where bech32 UTXOs are preferred at higher fee rates\n+            and P2SH are preffered at lower fee rates.\n+    CASE 2: Alice has mixed UTXOs (P2SH, bech32, legacy) and makes multiple\n+            payments to Bob's bech32 address, where legacy is preferred at\n+            low fee rates, P2SH at medium fee rates, and bech32 at high rates.\n+    CASE 3: Alice has mixed UTXOs (legacy, P2SH, bech32) and makes multiple\n+            payments to Bob, where legacy and P2SH are mixed at lower fee rates\n+            and finally all UTXOs are mixed for the final payment.",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 25,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "072e755e553d3502572d7db1cbe04d73e31b6b2e",
      "in_reply_to_id": 836736105,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Great points. I'll refactor the test to:\r\n\r\n* Document the initial setup for each node\r\n* Start with a larger, mixed UTXO set\r\n* Be less brittle w.r.t to coin selection\r\n\r\nLooking at the test again, I think I am trying to test for some things that would be better to test for in a unit test. Ideally, this test should create large UTXO sets for each node, spend back and forth at different fee rates and to different address types. The assertions should check that all inputs are of the same OutputType and finally test a scenario where the wallet can fund from any single OutputType and is forced to mix OutputTypes to fund the transaction",
      "created_at": "2022-03-30T13:04:12Z",
      "updated_at": "2022-03-30T13:04:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r838518664",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838518664"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 17,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838666794",
      "pull_request_review_id": 926297888,
      "id": 838666794,
      "node_id": "PRRC_kwDOABII584x_Qoq",
      "diff_hunk": "@@ -36,9 +36,9 @@ def run_test(self):\n \n         self.generate(self.nodes[1], COINBASE_MATURITY)\n         balance = alice.getbalance()\n-        txA = alice.sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n-        txB = alice.sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n-        txC = alice.sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n+        txA = self.nodes[1].sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n+        txB = self.nodes[1].sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n+        txC = self.nodes[1].sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n         self.sync_mempools()\n         self.generate(self.nodes[1], 1)",
      "path": "test/functional/wallet_abandonconflict.py",
      "position": null,
      "original_position": 11,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e556ee628e97b10bc4f4d82036c9758d4e14d298",
      "in_reply_to_id": 836601796,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "No, Bitcoin Core ignoring the feerate of parent transactions when using unconfirmed inputs is a bug, but one that turned out more difficult to fix than anticipated. I have started a branch (https://github.com/Xekyo/bitcoin/tree/ancestor-aware-funding) which I intend to push forward in collaboration with @glozow. We were stuck by not being able to get information on unconfirmed parent transactions in the wallet yet, and this should now be resolved by a node:wallet interface that provides mining scores which @glozow came up with.\r\n\r\nThen, the intended goal is that we'd automatically add sufficient fees to elevate the mining score for both the new and the ancestor transactions to the target feerate and account for these additional fees in the waste metric.",
      "created_at": "2022-03-30T15:14:23Z",
      "updated_at": "2022-03-30T15:16:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r838666794",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838666794"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 43,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844973583",
      "pull_request_review_id": 934837483,
      "id": 844973583,
      "node_id": "PRRC_kwDOABII584yXUYP",
      "diff_hunk": "@@ -773,11 +814,42 @@ static bool CreateTransactionInternal(\n     CAmount selection_target = recipients_sum + not_input_fees;\n \n     // Get available coins\n-    std::vector<COutput> vAvailableCoins;\n-    AvailableCoins(wallet, vAvailableCoins, &coin_control, 1, MAX_MONEY, MAX_MONEY, 0);\n+    AvailableCoins availableCoins;\n+    GetAvailableCoins(wallet, availableCoins, &coin_control, 1, MAX_MONEY, MAX_MONEY, 0);\n \n-    // Choose coins to use\n-    std::optional<SelectionResult> result = SelectCoins(wallet, vAvailableCoins, /* nTargetValue */ selection_target, coin_control, coin_selection_params);\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result1{SelectCoins(wallet, availableCoins.Legacy, /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {\n+        result1->ComputeAndSetWaste(coin_selection_params.m_cost_of_change);\n+        results.push_back(*result1);\n+    };\n+    if (auto result2{SelectCoins(wallet, availableCoins.P2SH, /* nTargetValue */ selection_target, coin_control, coin_selection_params)}) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 123,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "072e755e553d3502572d7db1cbe04d73e31b6b2e",
      "in_reply_to_id": null,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    if (auto result2{SelectCoins(wallet, availableCoins.P2SH, /*nTargetValue=*/selection_target, coin_control, coin_selection_params)}) {\r\n```\r\n\r\nAnywhere you are adding /touching named args, please use the [style from the developer docs](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#coding-style-c-named-arguments).",
      "created_at": "2022-04-07T10:25:58Z",
      "updated_at": "2022-04-07T10:25:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r844973583",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844973583"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 826,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856956306",
      "pull_request_review_id": 951035173,
      "id": 856956306,
      "node_id": "PRRC_kwDOABII584zFB2S",
      "diff_hunk": "@@ -0,0 +1,214 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. It does so by covering the following cases:\n+\n+    CASE 1: Alice mixed UTXOs (bech32, P2SH). She makes multiple payments\n+            to Bob, where bech32 UTXOs are preferred at higher fee rates\n+            and P2SH are preffered at lower fee rates.\n+    CASE 2: Alice has mixed UTXOs (P2SH, bech32, legacy) and makes multiple\n+            payments to Bob's bech32 address, where legacy is preferred at\n+            low fee rates, P2SH at medium fee rates, and bech32 at high rates.\n+    CASE 3: Alice has mixed UTXOs (legacy, P2SH, bech32) and makes multiple\n+            payments to Bob, where legacy and P2SH are mixed at lower fee rates\n+            and finally all UTXOs are mixed for the final payment.",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 25,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "072e755e553d3502572d7db1cbe04d73e31b6b2e",
      "in_reply_to_id": 836736105,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "this should be addressed now. I re-worked the test to make it less dependent on specific UTXOs and transactions and added a more detailed explanation.",
      "created_at": "2022-04-23T18:16:05Z",
      "updated_at": "2022-04-23T18:16:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r856956306",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856956306"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 17,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856956453",
      "pull_request_review_id": 951035388,
      "id": 856956453,
      "node_id": "PRRC_kwDOABII584zFB4l",
      "diff_hunk": "@@ -0,0 +1,214 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. It does so by covering the following cases:\n+\n+    CASE 1: Alice mixed UTXOs (bech32, P2SH). She makes multiple payments\n+            to Bob, where bech32 UTXOs are preferred at higher fee rates\n+            and P2SH are preffered at lower fee rates.\n+    CASE 2: Alice has mixed UTXOs (P2SH, bech32, legacy) and makes multiple\n+            payments to Bob's bech32 address, where legacy is preferred at\n+            low fee rates, P2SH at medium fee rates, and bech32 at high rates.\n+    CASE 3: Alice has mixed UTXOs (legacy, P2SH, bech32) and makes multiple\n+            payments to Bob, where legacy and P2SH are mixed at lower fee rates\n+            and finally all UTXOs are mixed for the final payment.\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.util import assert_equal\n+\n+\n+def get_change_output(tx, addr):\n+    \"\"\"Get change address from transaction.\"\"\"\n+    return [\n+        vout['scriptPubKey']['address']\n+        for vout in tx['vout']\n+        if vout['scriptPubKey']['address'] != addr\n+    ][0]\n+\n+\n+def get_input_addresses(node, tx):\n+    \"\"\"Get all input addresses for a given transaction.\"\"\"\n+    vins = node.getrawtransaction(tx, True)['vin']\n+    addresses = []\n+    for vin in vins:\n+        prev_tx, n = vin['txid'], vin['vout']\n+        addresses.append(\n+            node.getrawtransaction(\n+                prev_tx,\n+                True,\n+            )['vout'][n]['scriptPubKey']['address']\n+        )\n+    return addresses\n+\n+\n+def bech32_address(node, addr):\n+    \"\"\"Check if an address cointains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        not addr_info['isscript'] and\n+        addr_info['iswitness'] and addr_info['witness_version'] == 0\n+    )\n+\n+\n+def p2sh_address(node, addr):\n+    \"\"\"Check if an address cointains a P2SH output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        addr_info['isscript'] and\n+        not addr_info['iswitness'] and\n+        addr_info['script'] == 'witness_v0_keyhash'\n+    )\n+\n+\n+def legacy_address(node, addr):\n+    \"\"\"Check if an address cointains a legacy output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (not addr_info['isscript'] and not addr_info['iswitness'])\n+\n+\n+class AddressInputTypeGrouping(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 2\n+        self.extra_args = [\n+            [\n+                \"-addresstype=bech32\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+            [\n+                \"-addresstype=p2sh-segwit\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+        ]\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def test_case_one(self, A, B):",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 102,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "072e755e553d3502572d7db1cbe04d73e31b6b2e",
      "in_reply_to_id": 836733063,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "fixed",
      "created_at": "2022-04-23T18:16:18Z",
      "updated_at": "2022-04-23T18:16:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r856956453",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856956453"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 102,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856958735",
      "pull_request_review_id": 951037971,
      "id": 856958735,
      "node_id": "PRRC_kwDOABII584zFCcP",
      "diff_hunk": "@@ -189,7 +212,26 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n             bool spendable = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (((mine & ISMINE_WATCH_ONLY) != ISMINE_NO) && (coinControl && coinControl->fAllowWatchOnly && solvable));\n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n \n-            vCoins.emplace_back(COutPoint(wtx.GetHash(), i), wtx.tx->vout.at(i), nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me);\n+            std::vector<std::vector<uint8_t>> dummy;\n+            TxoutType type{Solver(wtx.tx->vout[i].scriptPubKey, dummy)};",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "4c634ea19220d6d1f4647e553909b5e0dfd1910e",
      "in_reply_to_id": 836696846,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "fixed",
      "created_at": "2022-04-23T18:18:09Z",
      "updated_at": "2022-04-23T18:18:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r856958735",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856958735"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 215,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 216,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856961631",
      "pull_request_review_id": 951041865,
      "id": 856961631,
      "node_id": "PRRC_kwDOABII584zFDJf",
      "diff_hunk": "@@ -293,7 +293,7 @@ def test_getbalances_used(self):\n \n         # send multiple transactions, reusing one address\n         for _ in range(101):\n-            self.nodes[0].sendtoaddress(new_addr, 1)",
      "path": "test/functional/wallet_avoidreuse.py",
      "position": null,
      "original_position": 4,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "eaaece5598c713e4698c379dfbceefac4be44992",
      "in_reply_to_id": 836686905,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I re-worked this to run coin selection by `OutputType` at each back-off, which fixed the preference for spending unconfirmed UTXOs. as such, I was able to leave the tests as is and removed the test changes from the PR. ",
      "created_at": "2022-04-23T18:19:52Z",
      "updated_at": "2022-04-23T18:19:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r856961631",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856961631"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 307,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856963565",
      "pull_request_review_id": 951044193,
      "id": 856963565,
      "node_id": "PRRC_kwDOABII584zFDnt",
      "diff_hunk": "@@ -36,9 +36,9 @@ def run_test(self):\n \n         self.generate(self.nodes[1], COINBASE_MATURITY)\n         balance = alice.getbalance()\n-        txA = alice.sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n-        txB = alice.sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n-        txC = alice.sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n+        txA = self.nodes[1].sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n+        txB = self.nodes[1].sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n+        txC = self.nodes[1].sendtoaddress(alice.getnewaddress(), Decimal(\"10\"))\n         self.sync_mempools()\n         self.generate(self.nodes[1], 1)",
      "path": "test/functional/wallet_abandonconflict.py",
      "position": null,
      "original_position": 11,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e556ee628e97b10bc4f4d82036c9758d4e14d298",
      "in_reply_to_id": 836601796,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is better handled now by running by OutputType at each stage of back-off",
      "created_at": "2022-04-23T18:20:34Z",
      "updated_at": "2022-04-23T18:20:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r856963565",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856963565"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 43,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856967235",
      "pull_request_review_id": 951048550,
      "id": 856967235,
      "node_id": "PRRC_kwDOABII584zFEhD",
      "diff_hunk": "@@ -186,6 +186,23 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n                 continue;\n             }\n \n+            OutputType output_type{wallet.m_default_address_type};\n+            std::vector<std::vector<uint8_t>> dummy;\n+            TxoutType type{Solver(wtx.tx->vout[i].scriptPubKey, dummy)};\n+            if (type == TxoutType::WITNESS_V1_TAPROOT) {\n+                output_type = OutputType::BECH32M;\n+            } else if (type == TxoutType::WITNESS_V0_KEYHASH) {\n+                output_type = OutputType::BECH32;\n+            } else if (type == TxoutType::SCRIPTHASH) {\n+                output_type = OutputType::P2SH_SEGWIT;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e27943dd91afbad679212d61b7b891f9f53818a0",
      "in_reply_to_id": 828302619,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Now also considering the reedem script when a UTXO is `P2SH`",
      "created_at": "2022-04-23T18:21:36Z",
      "updated_at": "2022-04-23T18:21:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r856967235",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856967235"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 197,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866091586",
      "pull_request_review_id": 963640800,
      "id": 866091586,
      "node_id": "PRRC_kwDOABII584zn4JC",
      "diff_hunk": "@@ -84,11 +84,37 @@ TxSize CalculateMaximumSignedTxSize(const CTransaction &tx, const CWallet *walle\n     return CalculateMaximumSignedTxSize(tx, wallet, txouts, coin_control);\n }\n \n-void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const CCoinControl* coinControl, const CAmount& nMinimumAmount, const CAmount& nMaximumAmount, const CAmount& nMinimumSumAmount, const uint64_t nMaximumCount)\n+uint64_t AvailableCoins::size() const\n+{\n+    return Bech32m.size() + Bech32.size() + P2SH.size() + Legacy.size() + Other.size();\n+}\n+\n+std::vector<COutput> AvailableCoins::all() const\n+{\n+    std::vector<COutput> all;\n+    all.reserve(Bech32m.size() + Bech32.size() + P2SH.size() + Legacy.size() + Other.size());",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e81372b22eede0fab6ab95596cf4aa2ed9e0ffc9",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    all.reserve(this->size());\r\n```\r\nYou don't need the `this->` but I think it's more readable.",
      "created_at": "2022-05-05T16:19:54Z",
      "updated_at": "2022-05-05T18:05:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r866091586",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866091586"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 95,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866106858",
      "pull_request_review_id": 963640800,
      "id": 866106858,
      "node_id": "PRRC_kwDOABII584zn73q",
      "diff_hunk": "@@ -192,7 +218,37 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n             bool spendable = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (((mine & ISMINE_WATCH_ONLY) != ISMINE_NO) && (coinControl && coinControl->fAllowWatchOnly && solvable));\n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n \n-            vCoins.emplace_back(COutPoint(wtx.GetHash(), i), wtx.tx->vout.at(i), nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me);\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+            COutput coin(COutPoint(wtx.GetHash(), i), wtx.tx->vout.at(i), nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me);\n+\n+            if (wtx.tx->vout[i].scriptPubKey.IsPayToScriptHash()) {\n+                CTxDestination destination;\n+                ExtractDestination(wtx.tx->vout[i].scriptPubKey, destination);\n+                CScript redeemScript = GetScriptForDestination(destination);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 54,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e81372b22eede0fab6ab95596cf4aa2ed9e0ffc9",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n                const CScript redeemScript{GetScriptForDestination(destination)};\r\n```",
      "created_at": "2022-05-05T16:32:28Z",
      "updated_at": "2022-05-05T18:05:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r866106858",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866106858"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 230,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866109458",
      "pull_request_review_id": 963640800,
      "id": 866109458,
      "node_id": "PRRC_kwDOABII584zn8gS",
      "diff_hunk": "@@ -192,7 +218,37 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n             bool spendable = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (((mine & ISMINE_WATCH_ONLY) != ISMINE_NO) && (coinControl && coinControl->fAllowWatchOnly && solvable));\n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n \n-            vCoins.emplace_back(COutPoint(wtx.GetHash(), i), wtx.tx->vout.at(i), nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me);\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+            COutput coin(COutPoint(wtx.GetHash(), i), wtx.tx->vout.at(i), nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "e81372b22eede0fab6ab95596cf4aa2ed9e0ffc9",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit, perhaps move this down to just before the `switch` below (just so it's declared close to where it's used).",
      "created_at": "2022-05-05T16:35:45Z",
      "updated_at": "2022-05-05T18:05:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r866109458",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866109458"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 225,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866133201",
      "pull_request_review_id": 963640800,
      "id": 866133201,
      "node_id": "PRRC_kwDOABII584zoCTR",
      "diff_hunk": "@@ -525,34 +618,36 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, const std::vec\n \n         // If possible, fund the transaction with confirmed UTXOs only. Prefer at least six\n         // confirmations on outputs received from other wallets and only spend confirmed change.\n-        if (auto r1{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 6, 0), vCoins, coin_selection_params)}) return r1;\n-        if (auto r2{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), vCoins, coin_selection_params)}) return r2;\n+        if (auto r1{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 6, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/false)}) return r1;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 231,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "12bb64f9fcd11207e5996e41204ab2ea822379c1",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The scope of these return temporaries is limited to the if statement, so you could simplify slightly by eliminating the numbers, for example:\r\n```suggestion\r\n        if (auto r{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 6, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/false)}) return r;\r\n```",
      "created_at": "2022-05-05T17:04:44Z",
      "updated_at": "2022-05-05T18:05:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r866133201",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866133201"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 634,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866138905",
      "pull_request_review_id": 963640800,
      "id": 866138905,
      "node_id": "PRRC_kwDOABII584zoDsZ",
      "diff_hunk": "@@ -0,0 +1,171 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds and Alice mines",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 15,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "12bb64f9fcd11207e5996e41204ab2ea822379c1",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\nabsolutely necessary. Both wallets start with zero funds. Alice mines\r\n```",
      "created_at": "2022-05-05T17:12:13Z",
      "updated_at": "2022-05-05T18:05:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r866138905",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866138905"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 15,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866140162",
      "pull_request_review_id": 963640800,
      "id": 866140162,
      "node_id": "PRRC_kwDOABII584zoEAC",
      "diff_hunk": "@@ -0,0 +1,171 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds and Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends a series of 10",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 16,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "12bb64f9fcd11207e5996e41204ab2ea822379c1",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\nenough blocks to have spendable coinbase outputs. Alice sends 10\r\n```",
      "created_at": "2022-05-05T17:13:53Z",
      "updated_at": "2022-05-05T18:05:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r866140162",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866140162"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 16,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866140784",
      "pull_request_review_id": 963640800,
      "id": 866140784,
      "node_id": "PRRC_kwDOABII584zoEJw",
      "diff_hunk": "@@ -0,0 +1,171 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds and Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends a series of 10\n+random value payments to Bob, creating 5 bech32 UTXOs and 5 P2SH UTXOs,\n+for a total of 30BTC in Bob's wallet.\n+\n+Bob then sends random valued payments back to Alice, some of which need\n+unconfirmed change, and we verify that none of these payments contain mixed\n+inputs. Finally, Bob sends the remainder of his funds, which requires mixing.\n+\n+They payment values are random, but chosen such that they sum up to a specified",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 24,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "12bb64f9fcd11207e5996e41204ab2ea822379c1",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\nThe payment values are random, but chosen such that they sum up to a specified\r\n```",
      "created_at": "2022-05-05T17:14:43Z",
      "updated_at": "2022-05-05T18:05:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r866140784",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866140784"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866147871",
      "pull_request_review_id": 963640800,
      "id": 866147871,
      "node_id": "PRRC_kwDOABII584zoF4f",
      "diff_hunk": "@@ -0,0 +1,171 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds and Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends a series of 10\n+random value payments to Bob, creating 5 bech32 UTXOs and 5 P2SH UTXOs,\n+for a total of 30BTC in Bob's wallet.\n+\n+Bob then sends random valued payments back to Alice, some of which need\n+unconfirmed change, and we verify that none of these payments contain mixed\n+inputs. Finally, Bob sends the remainder of his funds, which requires mixing.\n+\n+They payment values are random, but chosen such that they sum up to a specified\n+total. This ensures we are not relying on specific values for the UTXOs,\n+but still know when to expect mixing due to the wallet being close to empty.\n+\n+\"\"\"\n+\n+import random\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+\n+\n+def is_bech32_address(node, addr):\n+    \"\"\"Check if an address cointains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            not addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 0\n+        )\n+    return False\n+\n+\n+def is_p2sh_address(node, addr):\n+    \"\"\"Check if an address cointains a P2SH output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        addr_info['isscript'] and\n+        not addr_info['iswitness']\n+    )\n+\n+\n+def is_legacy_address(node, addr):\n+    \"\"\"Check if an address cointains a legacy output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (not addr_info['isscript'] and not addr_info['iswitness'])\n+\n+\n+def is_same_type(node, tx):\n+    \"\"\"Check that all inputs are of the same OutputType\"\"\"\n+    vins = node.getrawtransaction(tx, True)['vin']\n+    inputs = []\n+    for vin in vins:\n+        prev_tx, n = vin['txid'], vin['vout']\n+        inputs.append(\n+            node.getrawtransaction(\n+                prev_tx,\n+                True,\n+            )['vout'][n]['scriptPubKey']['address']\n+        )\n+    has_legacy = False\n+    has_p2sh = False\n+    has_bech32 = False\n+\n+    for addr in inputs:\n+        if is_legacy_address(node, addr):\n+            has_legacy = True\n+        if is_p2sh_address(node, addr):\n+            has_p2sh = True\n+        if is_bech32_address(node, addr):\n+            has_bech32 = True\n+\n+    return (sum([has_legacy, has_p2sh, has_bech32]) == 1)\n+\n+\n+def generate_payment_values(n, m):\n+    \"\"\"Return a randomly chosen list of n positive integers summing to total.",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 89,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "12bb64f9fcd11207e5996e41204ab2ea822379c1",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    \"\"\"Return a randomly chosen list of n positive integers summing to m.\r\n```",
      "created_at": "2022-05-05T17:23:53Z",
      "updated_at": "2022-05-05T18:05:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r866147871",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866147871"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 89,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866166171",
      "pull_request_review_id": 963741120,
      "id": 866166171,
      "node_id": "PRRC_kwDOABII584zoKWb",
      "diff_hunk": "@@ -32,10 +32,35 @@ struct TxSize {\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const std::vector<CTxOut>& txouts, const CCoinControl* coin_control = nullptr);\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const CCoinControl* coin_control = nullptr) EXCLUSIVE_LOCKS_REQUIRED(wallet->cs_wallet);\n \n+/** COutputs available for spending, stored by OutputType.\n+ * This struct is really just a wrapper around OutputType vectors with a convenient\n+ * method for concatenating and returning all COutputs as one vector.\n+ *\n+ * clear(), size() methods are implemented so that one can interact with\n+ * the AvailableCoins struct as if it were a vector */",
      "path": "src/wallet/spend.h",
      "position": null,
      "original_position": 9,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "12bb64f9fcd11207e5996e41204ab2ea822379c1",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: I think our style guide suggests this formatting.\r\n```suggestion\r\n/**\r\n * COutputs available for spending, stored by OutputType.\r\n * This struct is really just a wrapper around OutputType vectors with a convenient\r\n * method for concatenating and returning all COutputs as one vector.\r\n *\r\n * clear(), size() methods are implemented so that one can interact with\r\n * the AvailableCoins struct as if it were a vector\r\n */\r\n```",
      "created_at": "2022-05-05T17:47:08Z",
      "updated_at": "2022-05-05T20:14:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r866166171",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866166171"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 35,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 40,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866181338",
      "pull_request_review_id": 963741120,
      "id": 866181338,
      "node_id": "PRRC_kwDOABII584zoODa",
      "diff_hunk": "@@ -85,12 +85,28 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n  * param@[in]  wallet                 The wallet which provides solving data for the coins\n  * param@[in]  nTargetValue           The target value\n  * param@[in]  eligilibity_filter     A filter containing rules for which coins are allowed to be included in this selection\n- * param@[in]  coins                  The vector of coins available for selection prior to filtering\n+ * param@[in]  availableCoins         The struct of coins, organized by OutputType, available for selection prior to filtering\n  * param@[in]  coin_selection_params  Parameters for the coin selection\n  * returns                            If successful, a SelectionResult containing the input set\n  *                                    If failed, a nullopt\n  */\n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const AvailableCoins& availableCoins,\n+                        const CoinSelectionParams& coin_selection_params);\n+\n+/**\n+ * Attempt to find a valid input set that meets the provided eligibility filter and target.\n+ * Multiple coin selection algorithms will be run and the input set that produces the least waste\n+ * (according to the waste metric) will be chosen.\n+ *\n+ * param@[in]  wallet                    The wallet which provides solving data for the coins\n+ * param@[in]  nTargetValue              The target value\n+ * param@[in]  eligilibity_filter        A filter containing rules for which coins are allowed to be included in this selection\n+ * param@[in]  coins                     The vector of coins available for selection prior to filtering\n+ * param@[in]  coin_selection_params     Parameters for the coin selection\n+ * returns                               If successful, a SelectionResult containing the input set\n+ *                                       If failed, a nullopt\n+ */\n+std::optional<SelectionResult> ChooseSelectionAlgorithm(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const std::vector<COutput>& coins,",
      "path": "src/wallet/spend.h",
      "position": null,
      "original_position": 27,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "66db9bff47dca2303f431f1d8907917afea6329a",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Naming nit: this function does not \"choose a selection algorithm\", but rather it picks one out of several coin selection algorithms' results. How about `ChooseSelectionResult` or similar?",
      "created_at": "2022-05-05T18:06:37Z",
      "updated_at": "2022-05-05T20:14:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r866181338",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866181338"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 109,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866267311",
      "pull_request_review_id": 963741120,
      "id": 866267311,
      "node_id": "PRRC_kwDOABII584zojCv",
      "diff_hunk": "@@ -626,11 +657,13 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, AvailableCoins\n             if (!fRejectLongChains) {\n                 if (auto r8{AttemptSelection(wallet, value_to_select,\n                                       CoinEligibilityFilter(0, 1, std::numeric_limits<uint64_t>::max(), std::numeric_limits<uint64_t>::max(), true /* include_partial_groups */),\n-                                      coins, coin_selection_params)}) {\n+                                      coins, coin_selection_params, /*allow_mixed_output_types=*/true)}) {\n                     return r8;\n                 }\n             }\n         }\n+        // If our wallet does not allow us to spend unconfirmed change, attempt to fund the transaction with mixed OutputTypes\n+        if (auto r9{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/true)}) return r9;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 96,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "4b0a67bfa71b8074c8eabe5b21a44eb23ce30dab",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The allow mixed outputs should be on an earlier backoff. Given the issues the Bitcoin Core wallet still has around not accounting for lower feerates in parent transactions of unconfirmed UTXOs, I would prefer to allow mixed inputs before allowing unconfirmed UTXOs. If I'm alone in that, I would most certainly prefer mixed inputs over having more than twelve unconfirmed ancestor transactions.",
      "created_at": "2022-05-05T19:56:23Z",
      "updated_at": "2022-05-05T20:14:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r866267311",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866267311"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 665,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 668,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866269613",
      "pull_request_review_id": 963741120,
      "id": 866269613,
      "node_id": "PRRC_kwDOABII584zojmt",
      "diff_hunk": "@@ -0,0 +1,171 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds and Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends a series of 10\n+random value payments to Bob, creating 5 bech32 UTXOs and 5 P2SH UTXOs,\n+for a total of 30BTC in Bob's wallet.\n+\n+Bob then sends random valued payments back to Alice, some of which need\n+unconfirmed change, and we verify that none of these payments contain mixed\n+inputs. Finally, Bob sends the remainder of his funds, which requires mixing.\n+\n+They payment values are random, but chosen such that they sum up to a specified\n+total. This ensures we are not relying on specific values for the UTXOs,\n+but still know when to expect mixing due to the wallet being close to empty.\n+\n+\"\"\"\n+\n+import random\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+\n+\n+def is_bech32_address(node, addr):\n+    \"\"\"Check if an address cointains a bech32 output.\"\"\"",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 36,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "12bb64f9fcd11207e5996e41204ab2ea822379c1",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    \"\"\"Check if an address contains a bech32 output.\"\"\"\r\n```\r\nAlso below",
      "created_at": "2022-05-05T19:59:38Z",
      "updated_at": "2022-05-05T20:14:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r866269613",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866269613"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 36,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866277087",
      "pull_request_review_id": 963741120,
      "id": 866277087,
      "node_id": "PRRC_kwDOABII584zolbf",
      "diff_hunk": "@@ -0,0 +1,171 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds and Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends a series of 10\n+random value payments to Bob, creating 5 bech32 UTXOs and 5 P2SH UTXOs,\n+for a total of 30BTC in Bob's wallet.\n+\n+Bob then sends random valued payments back to Alice, some of which need\n+unconfirmed change, and we verify that none of these payments contain mixed\n+inputs. Finally, Bob sends the remainder of his funds, which requires mixing.\n+\n+They payment values are random, but chosen such that they sum up to a specified\n+total. This ensures we are not relying on specific values for the UTXOs,\n+but still know when to expect mixing due to the wallet being close to empty.\n+\n+\"\"\"\n+\n+import random\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+\n+\n+def is_bech32_address(node, addr):\n+    \"\"\"Check if an address cointains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            not addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 0\n+        )\n+    return False\n+\n+\n+def is_p2sh_address(node, addr):\n+    \"\"\"Check if an address cointains a P2SH output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        addr_info['isscript'] and\n+        not addr_info['iswitness']\n+    )\n+\n+\n+def is_legacy_address(node, addr):\n+    \"\"\"Check if an address cointains a legacy output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (not addr_info['isscript'] and not addr_info['iswitness'])\n+\n+\n+def is_same_type(node, tx):\n+    \"\"\"Check that all inputs are of the same OutputType\"\"\"\n+    vins = node.getrawtransaction(tx, True)['vin']\n+    inputs = []\n+    for vin in vins:\n+        prev_tx, n = vin['txid'], vin['vout']\n+        inputs.append(\n+            node.getrawtransaction(\n+                prev_tx,\n+                True,\n+            )['vout'][n]['scriptPubKey']['address']\n+        )\n+    has_legacy = False\n+    has_p2sh = False\n+    has_bech32 = False\n+\n+    for addr in inputs:\n+        if is_legacy_address(node, addr):\n+            has_legacy = True\n+        if is_p2sh_address(node, addr):\n+            has_p2sh = True\n+        if is_bech32_address(node, addr):\n+            has_bech32 = True",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 83,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "12bb64f9fcd11207e5996e41204ab2ea822379c1",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I would have expected to count all five types (incl. bech32m and others), even if you don't explicitly create them here. This test would currently not fail if I Alice additionally sent Bob a P2TR output.",
      "created_at": "2022-05-05T20:10:32Z",
      "updated_at": "2022-05-05T20:14:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r866277087",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/866277087"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 77,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 93,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/867330774",
      "pull_request_review_id": 965314060,
      "id": 867330774,
      "node_id": "PRRC_kwDOABII584zsmrW",
      "diff_hunk": "@@ -525,34 +618,36 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, const std::vec\n \n         // If possible, fund the transaction with confirmed UTXOs only. Prefer at least six\n         // confirmations on outputs received from other wallets and only spend confirmed change.\n-        if (auto r1{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 6, 0), vCoins, coin_selection_params)}) return r1;\n-        if (auto r2{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), vCoins, coin_selection_params)}) return r2;\n+        if (auto r1{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 6, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/false)}) return r1;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 231,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "12bb64f9fcd11207e5996e41204ab2ea822379c1",
      "in_reply_to_id": 866133201,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I agree but decided to leave them alone since it's not really in scope for this PR and would have involved touching extra lines just to remove the number",
      "created_at": "2022-05-07T09:34:14Z",
      "updated_at": "2022-05-07T09:34:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r867330774",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/867330774"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 634,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/867333282",
      "pull_request_review_id": 965316219,
      "id": 867333282,
      "node_id": "PRRC_kwDOABII584zsnSi",
      "diff_hunk": "@@ -626,11 +657,13 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, AvailableCoins\n             if (!fRejectLongChains) {\n                 if (auto r8{AttemptSelection(wallet, value_to_select,\n                                       CoinEligibilityFilter(0, 1, std::numeric_limits<uint64_t>::max(), std::numeric_limits<uint64_t>::max(), true /* include_partial_groups */),\n-                                      coins, coin_selection_params)}) {\n+                                      coins, coin_selection_params, /*allow_mixed_output_types=*/true)}) {\n                     return r8;\n                 }\n             }\n         }\n+        // If our wallet does not allow us to spend unconfirmed change, attempt to fund the transaction with mixed OutputTypes\n+        if (auto r9{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/true)}) return r9;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 96,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "4b0a67bfa71b8074c8eabe5b21a44eb23ce30dab",
      "in_reply_to_id": 866267311,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "my reasoning for starting it at the `r6` back-off is because that is also the first back-off where we allow partial spending of `OutputGroups`. so the status quo in the wallet is \"spend unconfirmed change before relaxing privacy-preserving constraints.\"\r\n\r\nyou could argue that mixed outputs are not as bad as partially spending an output group w.r.t privacy, but i would still advocate for it being considered along with unconfirmed change, meaning if spending unconfirmed change is more efficient in terms of the waste metric, do that instead of mixing.",
      "created_at": "2022-05-07T09:59:38Z",
      "updated_at": "2022-05-07T09:59:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r867333282",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/867333282"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 665,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 668,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/867333367",
      "pull_request_review_id": 965316288,
      "id": 867333367,
      "node_id": "PRRC_kwDOABII584zsnT3",
      "diff_hunk": "@@ -0,0 +1,171 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds and Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends a series of 10\n+random value payments to Bob, creating 5 bech32 UTXOs and 5 P2SH UTXOs,\n+for a total of 30BTC in Bob's wallet.\n+\n+Bob then sends random valued payments back to Alice, some of which need\n+unconfirmed change, and we verify that none of these payments contain mixed\n+inputs. Finally, Bob sends the remainder of his funds, which requires mixing.\n+\n+They payment values are random, but chosen such that they sum up to a specified\n+total. This ensures we are not relying on specific values for the UTXOs,\n+but still know when to expect mixing due to the wallet being close to empty.\n+\n+\"\"\"\n+\n+import random\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+\n+\n+def is_bech32_address(node, addr):\n+    \"\"\"Check if an address cointains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            not addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 0\n+        )\n+    return False\n+\n+\n+def is_p2sh_address(node, addr):\n+    \"\"\"Check if an address cointains a P2SH output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        addr_info['isscript'] and\n+        not addr_info['iswitness']\n+    )\n+\n+\n+def is_legacy_address(node, addr):\n+    \"\"\"Check if an address cointains a legacy output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (not addr_info['isscript'] and not addr_info['iswitness'])\n+\n+\n+def is_same_type(node, tx):\n+    \"\"\"Check that all inputs are of the same OutputType\"\"\"\n+    vins = node.getrawtransaction(tx, True)['vin']\n+    inputs = []\n+    for vin in vins:\n+        prev_tx, n = vin['txid'], vin['vout']\n+        inputs.append(\n+            node.getrawtransaction(\n+                prev_tx,\n+                True,\n+            )['vout'][n]['scriptPubKey']['address']\n+        )\n+    has_legacy = False\n+    has_p2sh = False\n+    has_bech32 = False\n+\n+    for addr in inputs:\n+        if is_legacy_address(node, addr):\n+            has_legacy = True\n+        if is_p2sh_address(node, addr):\n+            has_p2sh = True\n+        if is_bech32_address(node, addr):\n+            has_bech32 = True",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 83,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "12bb64f9fcd11207e5996e41204ab2ea822379c1",
      "in_reply_to_id": 866277087,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "good point, ill update this",
      "created_at": "2022-05-07T10:00:31Z",
      "updated_at": "2022-05-07T10:00:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r867333367",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/867333367"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 77,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 93,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/867369998",
      "pull_request_review_id": 965345832,
      "id": 867369998,
      "node_id": "PRRC_kwDOABII584zswQO",
      "diff_hunk": "@@ -626,11 +657,13 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, AvailableCoins\n             if (!fRejectLongChains) {\n                 if (auto r8{AttemptSelection(wallet, value_to_select,\n                                       CoinEligibilityFilter(0, 1, std::numeric_limits<uint64_t>::max(), std::numeric_limits<uint64_t>::max(), true /* include_partial_groups */),\n-                                      coins, coin_selection_params)}) {\n+                                      coins, coin_selection_params, /*allow_mixed_output_types=*/true)}) {\n                     return r8;\n                 }\n             }\n         }\n+        // If our wallet does not allow us to spend unconfirmed change, attempt to fund the transaction with mixed OutputTypes\n+        if (auto r9{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/true)}) return r9;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 96,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "4b0a67bfa71b8074c8eabe5b21a44eb23ce30dab",
      "in_reply_to_id": 866267311,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm not sure that's an apt comparison. Address reuse is generally discouraged and hopefully happens seldom for most wallets, especially those that care about privacy. In addition, we already run opportunistic avoid-partial-spend in parallel for every single coin selection attempt and prefer its result as long as it is not more expensive even when not explicitly required.\r\n\r\nThis PR however follows a change in the wallet behavior that will generally match the output type of the recipient on every spend. We must expect wallets to frequently have outputs of different types as a result. This PR does not introduce avoidance of mixing as parallel coin selection results but rather requires it for almost all selection attempts. Splitting the UTXO pool into two or more sets doesn't half the size of the possible input set candidates, but reduces the combination space to tiny fractions.\r\n\r\nI expect this already to cause a reduction in changeless transactions, but worse, I expect the change as proposed to considerably increase the use of unconfirmed inputs and thusly reduce the resulting transactions' reliability. Given the existing feerate estimation issue with unconfirmed inputs, this would more frequently cause the wallet to undershoot the target feerate, especially if we allow up to 12 unconfirmed inputs before considering mixing.\r\n\r\nI'd prefer that mixing be allowed with r2, I'd be okay with r3. I might be convinced to introduce mixing on r4 via simulation results showing that coin selection results and reliability do not get significantly worse. My stance on this would generally be improved by us having finished ancestor aware fee estimation and the waste metric having been updated to account for automatic bumping of low feerate parent transactions.\r\n\r\nI'd also be curious what others think about this.",
      "created_at": "2022-05-07T16:27:53Z",
      "updated_at": "2022-05-07T16:28:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r867369998",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/867369998"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 665,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 668,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/867371195",
      "pull_request_review_id": 965346754,
      "id": 867371195,
      "node_id": "PRRC_kwDOABII584zswi7",
      "diff_hunk": "@@ -626,11 +657,13 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, AvailableCoins\n             if (!fRejectLongChains) {\n                 if (auto r8{AttemptSelection(wallet, value_to_select,\n                                       CoinEligibilityFilter(0, 1, std::numeric_limits<uint64_t>::max(), std::numeric_limits<uint64_t>::max(), true /* include_partial_groups */),\n-                                      coins, coin_selection_params)}) {\n+                                      coins, coin_selection_params, /*allow_mixed_output_types=*/true)}) {\n                     return r8;\n                 }\n             }\n         }\n+        // If our wallet does not allow us to spend unconfirmed change, attempt to fund the transaction with mixed OutputTypes\n+        if (auto r9{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/true)}) return r9;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 96,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "4b0a67bfa71b8074c8eabe5b21a44eb23ce30dab",
      "in_reply_to_id": 866267311,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Let me add an example to illustrate my point.\r\n\r\nFive UTXOs produce 31 non-empty combinations:\r\n![image](https://user-images.githubusercontent.com/4060799/167263471-ebac8d8b-7699-411d-9128-422b626fabdb.png)\r\n\r\nTwo sets of three and two UTXOs only yield 7+3 combinations:\r\n![image](https://user-images.githubusercontent.com/4060799/167263547-4929efa7-c83c-49ed-8ccb-53842f7e9d5c.png)\r\n![image](https://user-images.githubusercontent.com/4060799/167263566-2255c81e-84a5-45a6-9242-b3ccfd708cf7.png)\r\n",
      "created_at": "2022-05-07T16:40:30Z",
      "updated_at": "2022-05-07T16:40:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r867371195",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/867371195"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 665,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 668,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872591348",
      "pull_request_review_id": 972528622,
      "id": 872591348,
      "node_id": "PRRC_kwDOABII5840Aq_0",
      "diff_hunk": "@@ -626,11 +657,13 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, AvailableCoins\n             if (!fRejectLongChains) {\n                 if (auto r8{AttemptSelection(wallet, value_to_select,\n                                       CoinEligibilityFilter(0, 1, std::numeric_limits<uint64_t>::max(), std::numeric_limits<uint64_t>::max(), true /* include_partial_groups */),\n-                                      coins, coin_selection_params)}) {\n+                                      coins, coin_selection_params, /*allow_mixed_output_types=*/true)}) {\n                     return r8;\n                 }\n             }\n         }\n+        // If our wallet does not allow us to spend unconfirmed change, attempt to fund the transaction with mixed OutputTypes\n+        if (auto r9{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/true)}) return r9;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 96,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "4b0a67bfa71b8074c8eabe5b21a44eb23ce30dab",
      "in_reply_to_id": 866267311,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "thanks for the detailed explanation and example. very good points about splitting the UTXO set. \r\n\r\nI've changed the logic and added a new back-off that allows mixing _before_ considering unconfirmed change. as such, you will still get the privacy improvement when spending from confirmed UTXOs. \r\n\r\nwhat's nice about how this is implemented is that we can easily move the logic up or down by changing the boolean so if we are able to fix the fee estimation issue and convince ourselves via simulations that there are not undesirable effects, we can easily move the restriction down at a later date by changing a boolean.",
      "created_at": "2022-05-13T16:41:30Z",
      "updated_at": "2022-05-13T16:41:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r872591348",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872591348"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 665,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 668,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874145334",
      "pull_request_review_id": 974551199,
      "id": 874145334,
      "node_id": "PRRC_kwDOABII5840GmY2",
      "diff_hunk": "@@ -192,7 +218,37 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n             bool spendable = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (((mine & ISMINE_WATCH_ONLY) != ISMINE_NO) && (coinControl && coinControl->fAllowWatchOnly && solvable));\n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n \n-            vCoins.emplace_back(COutPoint(wtx.GetHash(), i), wtx.tx->vout.at(i), nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me);\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+\n+            if (wtx.tx->vout[i].scriptPubKey.IsPayToScriptHash()) {\n+                CTxDestination destination;\n+                ExtractDestination(wtx.tx->vout[i].scriptPubKey, destination);\n+                const CScript redeemScript{GetScriptForDestination(destination)};\n+                type = Solver(redeemScript, return_values_unused);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 54,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "7f0ef4163e5dcde1487a7c4b09efa4b1d6b9f870",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 7f0ef4163e5dcde1487a7c4b09efa4b1d6b9f870 \"refactor: add AvailableCoins struct\"\r\n\r\nThis looks wrong. `ExtractDestination` will give the P2SH address for this scriptPubKey, and then we get that same script again and run the `Solver` on it. It's just going to return `TxoutType::SCRIPTHASH` which we already knew.\r\n\r\nWhat this should be doing is looking up the redeemScript in the wallet (by ScriptID) and then running `Solver` with that redeemScript. We also need to remember that this was inside of a P2SH so that when checking `TxoutType::WITNESS_V0_*` later, we can know whether it is bech32 or p2sh-segwit.",
      "created_at": "2022-05-16T20:49:54Z",
      "updated_at": "2022-05-16T21:13:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r874145334",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874145334"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 227,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 240,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874146823",
      "pull_request_review_id": 974551199,
      "id": 874146823,
      "node_id": "PRRC_kwDOABII5840GmwH",
      "diff_hunk": "@@ -192,7 +218,37 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n             bool spendable = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (((mine & ISMINE_WATCH_ONLY) != ISMINE_NO) && (coinControl && coinControl->fAllowWatchOnly && solvable));\n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n \n-            vCoins.emplace_back(COutPoint(wtx.GetHash(), i), wtx.tx->vout.at(i), nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me);\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+\n+            if (wtx.tx->vout[i].scriptPubKey.IsPayToScriptHash()) {\n+                CTxDestination destination;\n+                ExtractDestination(wtx.tx->vout[i].scriptPubKey, destination);\n+                const CScript redeemScript{GetScriptForDestination(destination)};\n+                type = Solver(redeemScript, return_values_unused);\n+            } else {\n+                type = Solver(wtx.tx->vout[i].scriptPubKey, return_values_unused);\n+            };\n+\n+            COutput coin(COutPoint(wtx.GetHash(), i), wtx.tx->vout.at(i), nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me);\n+            switch (type) {\n+            case TxoutType::WITNESS_V1_TAPROOT:\n+                availableCoins.Bech32m.push_back(coin);\n+                break;\n+            case TxoutType::WITNESS_V0_KEYHASH:",
      "path": "src/wallet/spend.cpp",
      "position": 69,
      "original_position": 64,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "7f0ef4163e5dcde1487a7c4b09efa4b1d6b9f870",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 7f0ef4163e5dcde1487a7c4b09efa4b1d6b9f870 \"refactor: add AvailableCoins struct\"\r\n\r\nThis should also include `TxoutType::WITNESS_V0_SCRIPTHASH`.",
      "created_at": "2022-05-16T20:51:45Z",
      "updated_at": "2022-05-16T21:13:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r874146823",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874146823"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 253,
      "original_line": 253,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874149536",
      "pull_request_review_id": 974551199,
      "id": 874149536,
      "node_id": "PRRC_kwDOABII5840Gnag",
      "diff_hunk": "@@ -192,7 +218,37 @@ void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const C\n             bool spendable = ((mine & ISMINE_SPENDABLE) != ISMINE_NO) || (((mine & ISMINE_WATCH_ONLY) != ISMINE_NO) && (coinControl && coinControl->fAllowWatchOnly && solvable));\n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n \n-            vCoins.emplace_back(COutPoint(wtx.GetHash(), i), wtx.tx->vout.at(i), nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me);\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+\n+            if (wtx.tx->vout[i].scriptPubKey.IsPayToScriptHash()) {\n+                CTxDestination destination;\n+                ExtractDestination(wtx.tx->vout[i].scriptPubKey, destination);\n+                const CScript redeemScript{GetScriptForDestination(destination)};\n+                type = Solver(redeemScript, return_values_unused);\n+            } else {\n+                type = Solver(wtx.tx->vout[i].scriptPubKey, return_values_unused);\n+            };\n+\n+            COutput coin(COutPoint(wtx.GetHash(), i), wtx.tx->vout.at(i), nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me);\n+            switch (type) {\n+            case TxoutType::WITNESS_V1_TAPROOT:\n+                availableCoins.Bech32m.push_back(coin);\n+                break;\n+            case TxoutType::WITNESS_V0_KEYHASH:\n+                availableCoins.Bech32.push_back(coin);\n+                break;\n+            case TxoutType::SCRIPTHASH:",
      "path": "src/wallet/spend.cpp",
      "position": 77,
      "original_position": 67,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "7f0ef4163e5dcde1487a7c4b09efa4b1d6b9f870",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 7f0ef4163e5dcde1487a7c4b09efa4b1d6b9f870 \"refactor: add AvailableCoins struct\"\r\n\r\nIf something is just `SCRIPTHASH`, it should be `Legacy`.",
      "created_at": "2022-05-16T20:55:30Z",
      "updated_at": "2022-05-16T21:13:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r874149536",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874149536"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 261,
      "original_line": 261,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874150063",
      "pull_request_review_id": 974551199,
      "id": 874150063,
      "node_id": "PRRC_kwDOABII5840Gniv",
      "diff_hunk": "@@ -33,9 +33,36 @@ TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* walle\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const CCoinControl* coin_control = nullptr) EXCLUSIVE_LOCKS_REQUIRED(wallet->cs_wallet);\n \n /**\n- * populate vCoins with vector of available COutputs.\n+ * COutputs available for spending, stored by OutputType.\n+ * This struct is really just a wrapper around OutputType vectors with a convenient\n+ * method for concatenating and returning all COutputs as one vector.\n+ *\n+ * clear(), size() methods are implemented so that one can interact with\n+ * the AvailableCoins struct as if it were a vector\n+ */\n+struct AvailableCoins {\n+    /* Vectors for each OutputType */\n+    std::vector<COutput> Legacy;\n+    std::vector<COutput> P2SH;",
      "path": "src/wallet/spend.h",
      "position": null,
      "original_position": 15,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "7f0ef4163e5dcde1487a7c4b09efa4b1d6b9f870",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 7f0ef4163e5dcde1487a7c4b09efa4b1d6b9f870 \"refactor: add AvailableCoins struct\"\r\n\r\n```suggestion\r\n    std::vector<COutput> P2SH_Segwit;\r\n```",
      "created_at": "2022-05-16T20:56:09Z",
      "updated_at": "2022-05-16T21:13:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r874150063",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874150063"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/897247048",
      "pull_request_review_id": 1006463492,
      "id": 897247048,
      "node_id": "PRRC_kwDOABII5841eudI",
      "diff_hunk": "@@ -35,15 +35,42 @@ TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* walle\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const CCoinControl* coin_control = nullptr) EXCLUSIVE_LOCKS_REQUIRED(wallet->cs_wallet);\n \n /**\n- * populate vCoins with vector of available COutputs.\n+ * COutputs available for spending, stored by OutputType.\n+ * This struct is really just a wrapper around OutputType vectors with a convenient\n+ * method for concatenating and returning all COutputs as one vector.\n+ *\n+ * clear(), size() methods are implemented so that one can interact with\n+ * the AvailableCoins struct as if it were a vector\n+ */\n+struct AvailableCoins {\n+    /* Vectors for each OutputType */\n+    std::vector<COutput> Legacy;\n+    std::vector<COutput> P2SH_Segwit;\n+    std::vector<COutput> Bech32;\n+    std::vector<COutput> Bech32m;\n+\n+    /** Other is a catch all for anything that doesn't match the known OutputTypes */\n+    std::vector<COutput> Other;",
      "path": "src/wallet/spend.h",
      "position": null,
      "original_position": 20,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "36ccbbc48a80116eb8e979667abd5f44cf36b030",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: Especially for new code and newly introduced symbols, please use snake_case for variable names and  PascalCase for function names. See symbol naming conventions in https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#coding-style-c",
      "created_at": "2022-06-14T19:32:07Z",
      "updated_at": "2022-06-14T20:52:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r897247048",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/897247048"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 47,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 53,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/897260535",
      "pull_request_review_id": 1006463492,
      "id": 897260535,
      "node_id": "PRRC_kwDOABII5841exv3",
      "diff_hunk": "@@ -35,15 +35,42 @@ TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* walle\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const CCoinControl* coin_control = nullptr) EXCLUSIVE_LOCKS_REQUIRED(wallet->cs_wallet);\n \n /**\n- * populate vCoins with vector of available COutputs.\n+ * COutputs available for spending, stored by OutputType.\n+ * This struct is really just a wrapper around OutputType vectors with a convenient\n+ * method for concatenating and returning all COutputs as one vector.\n+ *\n+ * clear(), size() methods are implemented so that one can interact with\n+ * the AvailableCoins struct as if it were a vector\n+ */\n+struct AvailableCoins {\n+    /* Vectors for each OutputType */\n+    std::vector<COutput> Legacy;\n+    std::vector<COutput> P2SH_Segwit;\n+    std::vector<COutput> Bech32;\n+    std::vector<COutput> Bech32m;\n+\n+    /** Other is a catch all for anything that doesn't match the known OutputTypes */\n+    std::vector<COutput> Other;\n+\n+    /** Concatenate and return all COutputs as one vector */\n+    std::vector<COutput> all() const;\n+\n+    /** The following methods are provided so that AvailableCoins can mimic a vector,\n+     * i.e methods can work with invidivudal OutputType vectors or on the entire object */\n+    uint64_t size() const;\n+    void clear();\n+};\n+\n+/**\n+ * populate the AvailableCoins struct with vectors of available COutputs, organized by OutputType.\n  */\n-void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const CCoinControl* coinControl = nullptr, std::optional<CFeeRate> feerate = std::nullopt, const CAmount& nMinimumAmount = 1, const CAmount& nMaximumAmount = MAX_MONEY, const CAmount& nMinimumSumAmount = MAX_MONEY, const uint64_t nMaximumCount = 0) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);\n+void GetAvailableCoins(const CWallet& wallet, AvailableCoins& availableCoins, const CCoinControl* coinControl = nullptr, std::optional<CFeeRate> feerate = std::nullopt, const CAmount& nMinimumAmount = 1, const CAmount& nMaximumAmount = MAX_MONEY, const CAmount& nMinimumSumAmount = MAX_MONEY, const uint64_t nMaximumCount = 0) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);\n \n /**\n  * Wrapper function for AvailableCoins which skips the `feerate` parameter. Use this function\n  * to list all available coins (e.g. listunspent RPC) while not intending to fund a transaction.\n  */\n-void AvailableCoinsListUnspent(const CWallet& wallet, std::vector<COutput>& vCoins, const CCoinControl* coinControl = nullptr, const CAmount& nMinimumAmount = 1, const CAmount& nMaximumAmount = MAX_MONEY, const CAmount& nMinimumSumAmount = MAX_MONEY, const uint64_t nMaximumCount = 0) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);\n+void AvailableCoinsListUnspent(const CWallet& wallet, AvailableCoins& coins, const CCoinControl* coinControl = nullptr, const CAmount& nMinimumAmount = 1, const CAmount& nMaximumAmount = MAX_MONEY, const CAmount& nMinimumSumAmount = MAX_MONEY, const uint64_t nMaximumCount = 0) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);",
      "path": "src/wallet/spend.h",
      "position": null,
      "original_position": 42,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "36ccbbc48a80116eb8e979667abd5f44cf36b030",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 36ccbbc48a80116eb8e979667abd5f44cf36b030 \"refactor: add AvailableCoins struct\"\r\n\r\nConsistency nit: I noticed that `vCoins` was renamed to `availableCoins` throughout this commit, except here it's renamed to `coins`, then in the test it is `available`. In the next commit, the instances of `AvailableCoins` seem to all be named `coins`. Perhaps it should be either `coins` or `available_coins` throughout.",
      "created_at": "2022-06-14T19:50:05Z",
      "updated_at": "2022-06-14T20:52:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r897260535",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/897260535"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 73,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/897286928",
      "pull_request_review_id": 1006463492,
      "id": 897286928,
      "node_id": "PRRC_kwDOABII5841e4MQ",
      "diff_hunk": "@@ -444,8 +444,14 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n     return groups_out;\n }\n \n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const AvailableCoins& availableCoins,\n                                const CoinSelectionParams& coin_selection_params)\n+{\n+    std::optional<SelectionResult> result = ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, availableCoins.all(), coin_selection_params);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "f42db05a0ea8a4acfaf8e0117824cfd0f1d0547b",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In f42db05a0ea8a4acfaf8e0117824cfd0f1d0547b \"refactor: use AvailableCoins struct in SelectCoins\"\r\n\r\nThe commit message mentions a newly introuduced method `ChooseSelectionAlgorithm`, but the code introduces `ChooseSelectionResult`.",
      "created_at": "2022-06-14T20:23:11Z",
      "updated_at": "2022-06-14T20:52:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r897286928",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/897286928"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 450,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/897297242",
      "pull_request_review_id": 1006463492,
      "id": 897297242,
      "node_id": "PRRC_kwDOABII5841e6ta",
      "diff_hunk": "@@ -601,34 +630,38 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, AvailableCoins\n \n         // If possible, fund the transaction with confirmed UTXOs only. Prefer at least six\n         // confirmations on outputs received from other wallets and only spend confirmed change.\n-        if (auto r1{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 6, 0), coins, coin_selection_params)}) return r1;\n-        if (auto r2{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), coins, coin_selection_params)}) return r2;\n+        // Also avoid mixing different UTXO OutputTypes to preserve privacy\n+        if (auto r1{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 6, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/false)}) return r1;\n+        if (auto r2{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/false)}) return r2;\n+\n+        // If we can't fund the tx from confirmed UTXOs of a single OutputType, allow mixed output types\n+        if (auto r3{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/true)}) return r3;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 52,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "df6aa1d597b4de1f4707719b3ad5518a94645ee1",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In df6aa1d597b4de1f4707719b3ad5518a94645ee1 \"wallet: run coin selection by `OutputType`\"\r\n\r\nAFAICT, this duplicates the selection attempts with segregated types for `CoinEligibilityFilter(1, 1, 0)`.\r\n\r\nEither way, the selection with segregated types is attempted first and mixing only happens as a last resort. So, directly setting `allow_mixed_output_types=true` should result in equivalent back-off steps without repeating the segregated output attempts before allowing mixing. \r\n\r\nNot adding this line also obsoletes the following commit to fix the duplicate appearance of `r3`,  321a13e177dc79581ec896568ab8e7633d95b17f \"refactor: update variable names\".\r\n \r\n ```suggestion\r\n        // If we can't fund the tx from confirmed UTXOs of a single OutputType, allow mixed output types\r\n        if (auto r2{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/true)}) return r2;\r\n ```",
      "created_at": "2022-06-14T20:36:56Z",
      "updated_at": "2022-06-14T21:01:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r897297242",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/897297242"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 635,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 638,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/897302747",
      "pull_request_review_id": 1006463492,
      "id": 897302747,
      "node_id": "PRRC_kwDOABII5841e8Db",
      "diff_hunk": "@@ -0,0 +1,195 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds. Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends 10\n+random value payments to Bob, creating 5 bech32 UTXOs and 5 P2SH UTXOs,\n+for a total of 30BTC in Bob's wallet.\n+\n+Bob then sends random valued payments back to Alice, some of which need\n+unconfirmed change, and we verify that none of these payments contain mixed\n+inputs. Finally, Bob sends the remainder of his funds, which requires mixing.\n+\n+The payment values are random, but chosen such that they sum up to a specified\n+total. This ensures we are not relying on specific values for the UTXOs,\n+but still know when to expect mixing due to the wallet being close to empty.\n+\n+\"\"\"\n+\n+import random\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+\n+ADDRESS_TYPES = [\n+    \"bech32m\",\n+    \"bech32\",\n+    \"p2sh-segwit\",\n+    \"legacy\",\n+]\n+\n+\n+def is_bech32_address(node, addr):\n+    \"\"\"Check if an address contains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            not addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 0\n+        )\n+    return False\n+\n+\n+def is_bech32m_address(node, addr):\n+    \"\"\"Check if an address contains a bech32m output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 1\n+        )\n+    return False\n+\n+\n+def is_p2sh_address(node, addr):\n+    \"\"\"Check if an address contains a P2SH output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        addr_info['isscript'] and\n+        not addr_info['iswitness']\n+    )\n+\n+\n+def is_legacy_address(node, addr):\n+    \"\"\"Check if an address contains a legacy output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (not addr_info['isscript'] and not addr_info['iswitness'])",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 76,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "784b03888e70a4744e7b387576f874ac18339dbb",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 784b03888e70a4744e7b387576f874ac18339dbb \"test: functional test for new coin selection logic \"\r\n\r\nNot sure if this is relevant, but I think this may be inconsistent with the categorization pointed out by @achow101 previously, which IIUC prescribes that non-segwit P2SH addresses should be labeled as \"legacy\".",
      "created_at": "2022-06-14T20:43:57Z",
      "updated_at": "2022-06-14T20:52:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r897302747",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/897302747"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 64,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 80,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901090114",
      "pull_request_review_id": 1011509602,
      "id": 901090114,
      "node_id": "PRRC_kwDOABII5841tYtC",
      "diff_hunk": "@@ -35,15 +35,42 @@ TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* walle\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const CCoinControl* coin_control = nullptr) EXCLUSIVE_LOCKS_REQUIRED(wallet->cs_wallet);\n \n /**\n- * populate vCoins with vector of available COutputs.\n+ * COutputs available for spending, stored by OutputType.\n+ * This struct is really just a wrapper around OutputType vectors with a convenient\n+ * method for concatenating and returning all COutputs as one vector.\n+ *\n+ * clear(), size() methods are implemented so that one can interact with\n+ * the AvailableCoins struct as if it were a vector\n+ */\n+struct AvailableCoins {\n+    /* Vectors for each OutputType */\n+    std::vector<COutput> Legacy;\n+    std::vector<COutput> P2SH_Segwit;\n+    std::vector<COutput> Bech32;\n+    std::vector<COutput> Bech32m;\n+\n+    /** Other is a catch all for anything that doesn't match the known OutputTypes */\n+    std::vector<COutput> Other;\n+\n+    /** Concatenate and return all COutputs as one vector */\n+    std::vector<COutput> all() const;\n+\n+    /** The following methods are provided so that AvailableCoins can mimic a vector,\n+     * i.e methods can work with invidivudal OutputType vectors or on the entire object */\n+    uint64_t size() const;\n+    void clear();\n+};\n+\n+/**\n+ * populate the AvailableCoins struct with vectors of available COutputs, organized by OutputType.\n  */\n-void AvailableCoins(const CWallet& wallet, std::vector<COutput>& vCoins, const CCoinControl* coinControl = nullptr, std::optional<CFeeRate> feerate = std::nullopt, const CAmount& nMinimumAmount = 1, const CAmount& nMaximumAmount = MAX_MONEY, const CAmount& nMinimumSumAmount = MAX_MONEY, const uint64_t nMaximumCount = 0) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);\n+void GetAvailableCoins(const CWallet& wallet, AvailableCoins& availableCoins, const CCoinControl* coinControl = nullptr, std::optional<CFeeRate> feerate = std::nullopt, const CAmount& nMinimumAmount = 1, const CAmount& nMaximumAmount = MAX_MONEY, const CAmount& nMinimumSumAmount = MAX_MONEY, const uint64_t nMaximumCount = 0) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);\n \n /**\n  * Wrapper function for AvailableCoins which skips the `feerate` parameter. Use this function\n  * to list all available coins (e.g. listunspent RPC) while not intending to fund a transaction.\n  */\n-void AvailableCoinsListUnspent(const CWallet& wallet, std::vector<COutput>& vCoins, const CCoinControl* coinControl = nullptr, const CAmount& nMinimumAmount = 1, const CAmount& nMaximumAmount = MAX_MONEY, const CAmount& nMinimumSumAmount = MAX_MONEY, const uint64_t nMaximumCount = 0) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);\n+void AvailableCoinsListUnspent(const CWallet& wallet, AvailableCoins& coins, const CCoinControl* coinControl = nullptr, const CAmount& nMinimumAmount = 1, const CAmount& nMaximumAmount = MAX_MONEY, const CAmount& nMinimumSumAmount = MAX_MONEY, const uint64_t nMaximumCount = 0) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);",
      "path": "src/wallet/spend.h",
      "position": null,
      "original_position": 42,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "36ccbbc48a80116eb8e979667abd5f44cf36b030",
      "in_reply_to_id": 897260535,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "originally, i tried to match whatever name was being used to minimize the diff, but looking at this again i think having a consistent naming of `available_coins` throughout is much better (despite a slightly larger diff)",
      "created_at": "2022-06-19T11:26:02Z",
      "updated_at": "2022-06-19T11:26:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r901090114",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901090114"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 73,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901093917",
      "pull_request_review_id": 1011513049,
      "id": 901093917,
      "node_id": "PRRC_kwDOABII5841tZod",
      "diff_hunk": "@@ -601,34 +630,38 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, AvailableCoins\n \n         // If possible, fund the transaction with confirmed UTXOs only. Prefer at least six\n         // confirmations on outputs received from other wallets and only spend confirmed change.\n-        if (auto r1{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 6, 0), coins, coin_selection_params)}) return r1;\n-        if (auto r2{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), coins, coin_selection_params)}) return r2;\n+        // Also avoid mixing different UTXO OutputTypes to preserve privacy\n+        if (auto r1{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 6, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/false)}) return r1;\n+        if (auto r2{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/false)}) return r2;\n+\n+        // If we can't fund the tx from confirmed UTXOs of a single OutputType, allow mixed output types\n+        if (auto r3{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), coins, coin_selection_params, /*allow_mixed_output_types=*/true)}) return r3;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 52,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "df6aa1d597b4de1f4707719b3ad5518a94645ee1",
      "in_reply_to_id": 897297242,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ah, good catch! `AttemptSelection` will only try with mixed inputs if it is unable to find at least one solution from segregated inputs and if mixing is allowed. So yes, running `r2` with `allow_mixed_inputs=true` achieves want we want without needing the duplicated r3",
      "created_at": "2022-06-19T11:55:21Z",
      "updated_at": "2022-06-19T11:55:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r901093917",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901093917"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 635,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 638,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901101886",
      "pull_request_review_id": 1011520935,
      "id": 901101886,
      "node_id": "PRRC_kwDOABII5841tbk-",
      "diff_hunk": "@@ -0,0 +1,195 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds. Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends 10\n+random value payments to Bob, creating 5 bech32 UTXOs and 5 P2SH UTXOs,\n+for a total of 30BTC in Bob's wallet.\n+\n+Bob then sends random valued payments back to Alice, some of which need\n+unconfirmed change, and we verify that none of these payments contain mixed\n+inputs. Finally, Bob sends the remainder of his funds, which requires mixing.\n+\n+The payment values are random, but chosen such that they sum up to a specified\n+total. This ensures we are not relying on specific values for the UTXOs,\n+but still know when to expect mixing due to the wallet being close to empty.\n+\n+\"\"\"\n+\n+import random\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+\n+ADDRESS_TYPES = [\n+    \"bech32m\",\n+    \"bech32\",\n+    \"p2sh-segwit\",\n+    \"legacy\",\n+]\n+\n+\n+def is_bech32_address(node, addr):\n+    \"\"\"Check if an address contains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            not addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 0\n+        )\n+    return False\n+\n+\n+def is_bech32m_address(node, addr):\n+    \"\"\"Check if an address contains a bech32m output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 1\n+        )\n+    return False\n+\n+\n+def is_p2sh_address(node, addr):\n+    \"\"\"Check if an address contains a P2SH output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        addr_info['isscript'] and\n+        not addr_info['iswitness']\n+    )\n+\n+\n+def is_legacy_address(node, addr):\n+    \"\"\"Check if an address contains a legacy output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (not addr_info['isscript'] and not addr_info['iswitness'])",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 76,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "784b03888e70a4744e7b387576f874ac18339dbb",
      "in_reply_to_id": 897302747,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "it is inconsistent in the general sense, but for the test it is correct in that we are only generating `p2sh-segwit` outputs. i'll update the comment in the function, tho, to avoid any confusion",
      "created_at": "2022-06-19T12:50:07Z",
      "updated_at": "2022-06-19T12:50:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r901101886",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901101886"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 64,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 80,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901679242",
      "pull_request_review_id": 1012298271,
      "id": 901679242,
      "node_id": "PRRC_kwDOABII5841voiK",
      "diff_hunk": "@@ -204,9 +230,47 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n             if (!spendable && only_spendable) continue;\n \n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n-            result.coins.emplace_back(outpoint, output, nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me, feerate);\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+            bool is_from_p2sh{false};\n+\n+            if (wtx.tx->vout[i].scriptPubKey.IsPayToScriptHash()) {\n+                CScript redeemScript;\n+                CTxDestination destination;\n+                ExtractDestination(wtx.tx->vout[i].scriptPubKey, destination);\n+                const CScriptID& hash = CScriptID(std::get<ScriptHash>(destination));\n+                provider->GetCScript(hash, redeemScript);\n+                type = Solver(redeemScript, return_values_unused);\n+                is_from_p2sh = true;\n+            } else {\n+                type = Solver(wtx.tx->vout[i].scriptPubKey, return_values_unused);\n+            };\n+\n+            COutput coin(COutPoint(wtx.GetHash(), i), wtx.tx->vout.at(i), nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me, feerate);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 56,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "d8cd07ec678bcf9c6df1fbca89110538ce35a8b8",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Regression here due the rebase; use `outpoint` and `output` variables.\r\n\r\n```suggestion\r\n            COutput coin(outpoint, output, nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me, feerate);\r\n```",
      "created_at": "2022-06-20T13:45:24Z",
      "updated_at": "2022-06-20T17:23:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r901679242",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901679242"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 251,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901812673",
      "pull_request_review_id": 1012298271,
      "id": 901812673,
      "node_id": "PRRC_kwDOABII5841wJHB",
      "diff_hunk": "@@ -204,9 +230,47 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n             if (!spendable && only_spendable) continue;\n \n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n-            result.coins.emplace_back(outpoint, output, nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me, feerate);\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+            bool is_from_p2sh{false};\n+\n+            if (wtx.tx->vout[i].scriptPubKey.IsPayToScriptHash()) {\n+                CScript redeemScript;\n+                CTxDestination destination;\n+                ExtractDestination(wtx.tx->vout[i].scriptPubKey, destination);\n+                const CScriptID& hash = CScriptID(std::get<ScriptHash>(destination));\n+                provider->GetCScript(hash, redeemScript);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "d8cd07ec678bcf9c6df1fbca89110538ce35a8b8",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`provider` could be null and `GetCScript` could return false.",
      "created_at": "2022-06-20T15:50:00Z",
      "updated_at": "2022-06-20T17:19:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r901812673",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901812673"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 244,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901812861",
      "pull_request_review_id": 1012298271,
      "id": 901812861,
      "node_id": "PRRC_kwDOABII5841wJJ9",
      "diff_hunk": "@@ -204,9 +230,47 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n             if (!spendable && only_spendable) continue;\n \n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n-            result.coins.emplace_back(outpoint, output, nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me, feerate);\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+            bool is_from_p2sh{false};\n+\n+            if (wtx.tx->vout[i].scriptPubKey.IsPayToScriptHash()) {\n+                CScript redeemScript;\n+                CTxDestination destination;\n+                ExtractDestination(wtx.tx->vout[i].scriptPubKey, destination);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 47,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "d8cd07ec678bcf9c6df1fbca89110538ce35a8b8",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`ExtractDestination` could fail.\r\nPlus, same as above, no need to lookup the output. Can use the `output` variable directly.",
      "created_at": "2022-06-20T15:50:15Z",
      "updated_at": "2022-06-20T17:19:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r901812861",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901812861"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 242,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901814185",
      "pull_request_review_id": 1012298271,
      "id": 901814185,
      "node_id": "PRRC_kwDOABII5841wJep",
      "diff_hunk": "@@ -204,9 +230,47 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n             if (!spendable && only_spendable) continue;\n \n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n-            result.coins.emplace_back(outpoint, output, nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me, feerate);\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+            bool is_from_p2sh{false};\n+\n+            if (wtx.tx->vout[i].scriptPubKey.IsPayToScriptHash()) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "d8cd07ec678bcf9c6df1fbca89110538ce35a8b8",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "No need to lookup the output:\r\n\r\n```suggestion\r\n            if (output.scriptPubKey.IsPayToScriptHash()) {\r\n```",
      "created_at": "2022-06-20T15:51:56Z",
      "updated_at": "2022-06-20T17:19:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r901814185",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901814185"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 239,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901858677",
      "pull_request_review_id": 1012298271,
      "id": 901858677,
      "node_id": "PRRC_kwDOABII5841wUV1",
      "diff_hunk": "@@ -204,9 +230,47 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n             if (!spendable && only_spendable) continue;\n \n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n-            result.coins.emplace_back(outpoint, output, nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me, feerate);\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+            bool is_from_p2sh{false};\n+\n+            if (wtx.tx->vout[i].scriptPubKey.IsPayToScriptHash()) {\n+                CScript redeemScript;\n+                CTxDestination destination;\n+                ExtractDestination(wtx.tx->vout[i].scriptPubKey, destination);\n+                const CScriptID& hash = CScriptID(std::get<ScriptHash>(destination));\n+                provider->GetCScript(hash, redeemScript);\n+                type = Solver(redeemScript, return_values_unused);\n+                is_from_p2sh = true;\n+            } else {\n+                type = Solver(wtx.tx->vout[i].scriptPubKey, return_values_unused);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 53,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "d8cd07ec678bcf9c6df1fbca89110538ce35a8b8",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "No need to lookup the output:\r\n```suggestion\r\n                type = Solver(output.scriptPubKey, return_values_unused);\r\n```",
      "created_at": "2022-06-20T16:54:56Z",
      "updated_at": "2022-06-20T17:19:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r901858677",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901858677"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 248,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901858837",
      "pull_request_review_id": 1012298271,
      "id": 901858837,
      "node_id": "PRRC_kwDOABII5841wUYV",
      "diff_hunk": "@@ -204,9 +230,47 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n             if (!spendable && only_spendable) continue;\n \n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n-            result.coins.emplace_back(outpoint, output, nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me, feerate);\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+            bool is_from_p2sh{false};\n+\n+            if (wtx.tx->vout[i].scriptPubKey.IsPayToScriptHash()) {\n+                CScript redeemScript;\n+                CTxDestination destination;\n+                ExtractDestination(wtx.tx->vout[i].scriptPubKey, destination);\n+                const CScriptID& hash = CScriptID(std::get<ScriptHash>(destination));\n+                provider->GetCScript(hash, redeemScript);\n+                type = Solver(redeemScript, return_values_unused);\n+                is_from_p2sh = true;\n+            } else {\n+                type = Solver(wtx.tx->vout[i].scriptPubKey, return_values_unused);\n+            };",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 54,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "d8cd07ec678bcf9c6df1fbca89110538ce35a8b8",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "extra \";\"",
      "created_at": "2022-06-20T16:55:11Z",
      "updated_at": "2022-06-20T17:19:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r901858837",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/901858837"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 249,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/902932129",
      "pull_request_review_id": 1014051602,
      "id": 902932129,
      "node_id": "PRRC_kwDOABII58410aah",
      "diff_hunk": "@@ -204,9 +230,47 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n             if (!spendable && only_spendable) continue;\n \n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n-            result.coins.emplace_back(outpoint, output, nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me, feerate);\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+            bool is_from_p2sh{false};\n+\n+            if (wtx.tx->vout[i].scriptPubKey.IsPayToScriptHash()) {\n+                CScript redeemScript;\n+                CTxDestination destination;\n+                ExtractDestination(wtx.tx->vout[i].scriptPubKey, destination);\n+                const CScriptID& hash = CScriptID(std::get<ScriptHash>(destination));\n+                provider->GetCScript(hash, redeemScript);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "d8cd07ec678bcf9c6df1fbca89110538ce35a8b8",
      "in_reply_to_id": 901812673,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "we check that the provider exists a few lines up with `bool solvable = provider ? IsSolvable(*provider, output.scriptPubKey) : false;` so no need to check it again here.\r\n\r\ngood point with `GetCScript`; i'm thinking we should print something to the logs and continue if we can't get the script? also open to other suggestions\r\n\r\n",
      "created_at": "2022-06-21T18:18:46Z",
      "updated_at": "2022-06-21T18:18:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r902932129",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/902932129"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 244,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/902932881",
      "pull_request_review_id": 1014052578,
      "id": 902932881,
      "node_id": "PRRC_kwDOABII58410amR",
      "diff_hunk": "@@ -204,9 +230,47 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n             if (!spendable && only_spendable) continue;\n \n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n-            result.coins.emplace_back(outpoint, output, nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me, feerate);\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+            bool is_from_p2sh{false};\n+\n+            if (wtx.tx->vout[i].scriptPubKey.IsPayToScriptHash()) {\n+                CScript redeemScript;\n+                CTxDestination destination;\n+                ExtractDestination(wtx.tx->vout[i].scriptPubKey, destination);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 47,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "d8cd07ec678bcf9c6df1fbca89110538ce35a8b8",
      "in_reply_to_id": 901812861,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "im thinking just print a log and continue if we can't extract a destination?",
      "created_at": "2022-06-21T18:19:36Z",
      "updated_at": "2022-06-21T18:19:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r902932881",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/902932881"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 242,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903541047",
      "pull_request_review_id": 1014887511,
      "id": 903541047,
      "node_id": "PRRC_kwDOABII58412vE3",
      "diff_hunk": "@@ -204,9 +230,47 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n             if (!spendable && only_spendable) continue;\n \n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n-            result.coins.emplace_back(outpoint, output, nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me, feerate);\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+            bool is_from_p2sh{false};\n+\n+            if (wtx.tx->vout[i].scriptPubKey.IsPayToScriptHash()) {\n+                CScript redeemScript;\n+                CTxDestination destination;\n+                ExtractDestination(wtx.tx->vout[i].scriptPubKey, destination);\n+                const CScriptID& hash = CScriptID(std::get<ScriptHash>(destination));\n+                provider->GetCScript(hash, redeemScript);",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "d8cd07ec678bcf9c6df1fbca89110538ce35a8b8",
      "in_reply_to_id": 901812673,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "added a check on `spendable` before looking up the CScript (since it doesn't make sense to try and find the script if it's not spendable by us) and handled the case where ExtractDest fails or GetScript fails with a `continue`. ",
      "created_at": "2022-06-22T10:02:09Z",
      "updated_at": "2022-06-22T10:02:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r903541047",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/903541047"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 244,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906692097",
      "pull_request_review_id": 1019324006,
      "id": 906692097,
      "node_id": "PRRC_kwDOABII5842CwYB",
      "diff_hunk": "@@ -383,20 +453,55 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n     return groups_out;\n }\n \n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n-                               const CoinSelectionParams& coin_selection_params)\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                               const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types)\n+{\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.legacy, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.P2SH_segwit, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32m, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+\n+    // If we can't fund the transaction from any individual OutputType, run coin selection\n+    // over all available coins, else pick the best solution from the results\n+    std::optional<SelectionResult> result = [&] {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 133,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is there a reason this is a lambda? I removed the lambda (just left its content to run directly), and the tests pass",
      "created_at": "2022-06-25T14:50:29Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906692097",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906692097"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 476,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906692135",
      "pull_request_review_id": 1019324006,
      "id": 906692135,
      "node_id": "PRRC_kwDOABII5842CwYn",
      "diff_hunk": "@@ -383,20 +453,55 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n     return groups_out;\n }\n \n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n-                               const CoinSelectionParams& coin_selection_params)\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                               const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types)\n+{\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.legacy, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.P2SH_segwit, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32m, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+\n+    // If we can't fund the transaction from any individual OutputType, run coin selection\n+    // over all available coins, else pick the best solution from the results\n+    std::optional<SelectionResult> result = [&] {\n+        if (results.size() == 0) {\n+            if (allow_mixed_output_types) {\n+                if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.all(), coin_selection_params)}) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 136,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`result` is shadowing?",
      "created_at": "2022-06-25T14:51:03Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906692135",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906692135"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 479,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906693004",
      "pull_request_review_id": 1019324006,
      "id": 906693004,
      "node_id": "PRRC_kwDOABII5842CwmM",
      "diff_hunk": "@@ -383,20 +453,55 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n     return groups_out;\n }\n \n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n-                               const CoinSelectionParams& coin_selection_params)\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                               const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types)\n+{\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.legacy, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.P2SH_segwit, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32m, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+\n+    // If we can't fund the transaction from any individual OutputType, run coin selection\n+    // over all available coins, else pick the best solution from the results\n+    std::optional<SelectionResult> result = [&] {\n+        if (results.size() == 0) {\n+            if (allow_mixed_output_types) {\n+                if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.all(), coin_selection_params)}) {\n+                    return result;\n+                }\n+            }\n+            return std::optional<SelectionResult>();\n+        };\n+        std::optional<SelectionResult> result = *std::min_element(results.begin(), results.end());",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 142,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`result` is shadowing? Also,\r\n```suggestion\r\n        std::optional<SelectionResult> result{*std::min_element(results.begin(), results.end())};\r\n```",
      "created_at": "2022-06-25T15:01:11Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906693004",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906693004"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 485,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906725861",
      "pull_request_review_id": 1019324006,
      "id": 906725861,
      "node_id": "PRRC_kwDOABII5842C4nl",
      "diff_hunk": "@@ -488,13 +592,13 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, const std::vec\n         return result;\n     }\n \n-    // remove preset inputs from vCoins so that Coin Selection doesn't pick them.\n-    for (std::vector<COutput>::iterator it = vCoins.begin(); it != vCoins.end() && coin_control.HasSelected();)\n-    {\n-        if (preset_coins.count(it->outpoint))\n-            it = vCoins.erase(it);\n-        else\n-            ++it;\n+    // remove preset inputs from coins so that Coin Selection doesn't pick them.\n+    if (coin_control.HasSelected()) {\n+        available_coins.legacy.erase(remove_if(available_coins.legacy.begin(), available_coins.legacy.end(), [&](const COutput& c) { return preset_coins.count(c.outpoint); }), available_coins.legacy.end());\n+        available_coins.P2SH_segwit.erase(remove_if(available_coins.P2SH_segwit.begin(), available_coins.P2SH_segwit.end(), [&](const COutput& c) { return preset_coins.count(c.outpoint); }), available_coins.P2SH_segwit.end());\n+        available_coins.bech32.erase(remove_if(available_coins.bech32.begin(), available_coins.bech32.end(), [&](const COutput& c) { return preset_coins.count(c.outpoint); }), available_coins.bech32.end());\n+        available_coins.bech32m.erase(remove_if(available_coins.bech32m.begin(), available_coins.bech32m.end(), [&](const COutput& c) { return preset_coins.count(c.outpoint); }), available_coins.bech32m.end());\n+        available_coins.other.erase(remove_if(available_coins.other.begin(), available_coins.other.end(), [&](const COutput& c) { return preset_coins.count(c.outpoint); }), available_coins.other.end());\n     }",
      "path": "src/wallet/spend.cpp",
      "position": 194,
      "original_position": 196,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit, readability; I had a little trouble reading which arguments were to which functions. (I'm unsure if `remove_preset` should be snake_case or camelCase; it's both a function and a variable):\r\n```suggestion\r\n    if (coin_control.HasSelected()) {\r\n        auto remove_preset = [&preset_coins](std::vector<COutput>& ov) {\r\n            ov.erase(\r\n                remove_if(\r\n                    ov.begin(), ov.end(),\r\n                    [&preset_coins](const COutput& c) { return preset_coins.count(c.outpoint) > 0; }),\r\n                ov.end());\r\n        };\r\n        remove_preset(available_coins.legacy);\r\n        remove_preset(available_coins.P2SH_segwit);\r\n        remove_preset(available_coins.bech32);\r\n        remove_preset(available_coins.bech32m);\r\n        remove_preset(available_coins.other);\r\n    }\r\n```",
      "created_at": "2022-06-25T21:27:25Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906725861",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906725861"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": 592,
      "original_start_line": 596,
      "start_side": "RIGHT",
      "line": 598,
      "original_line": 598,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906726356",
      "pull_request_review_id": 1019324006,
      "id": 906726356,
      "node_id": "PRRC_kwDOABII5842C4vU",
      "diff_hunk": "@@ -34,14 +34,38 @@ struct TxSize {\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const std::vector<CTxOut>& txouts, const CCoinControl* coin_control = nullptr);\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const CCoinControl* coin_control = nullptr) EXCLUSIVE_LOCKS_REQUIRED(wallet->cs_wallet);\n \n+/**\n+ * COutputs available for spending, stored by OutputType.\n+ * This struct is really just a wrapper around OutputType vectors with a convenient\n+ * method for concatenating and returning all COutputs as one vector.\n+ *\n+ * clear(), size() methods are implemented so that one can interact with\n+ * the CoinsResult struct as if it were a vector\n+ */\n struct CoinsResult {\n-    std::vector<COutput> coins;\n-    // Sum of all the coins amounts\n+    /* Vectors for each OutputType */",
      "path": "src/wallet/spend.h",
      "position": null,
      "original_position": 15,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    /** Vectors for each OutputType */\r\n```",
      "created_at": "2022-06-25T21:35:25Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906726356",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906726356"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906726458",
      "pull_request_review_id": 1019324006,
      "id": 906726458,
      "node_id": "PRRC_kwDOABII5842C4w6",
      "diff_hunk": "@@ -34,14 +34,38 @@ struct TxSize {\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const std::vector<CTxOut>& txouts, const CCoinControl* coin_control = nullptr);\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const CCoinControl* coin_control = nullptr) EXCLUSIVE_LOCKS_REQUIRED(wallet->cs_wallet);\n \n+/**\n+ * COutputs available for spending, stored by OutputType.\n+ * This struct is really just a wrapper around OutputType vectors with a convenient\n+ * method for concatenating and returning all COutputs as one vector.\n+ *\n+ * clear(), size() methods are implemented so that one can interact with\n+ * the CoinsResult struct as if it were a vector\n+ */\n struct CoinsResult {\n-    std::vector<COutput> coins;\n-    // Sum of all the coins amounts\n+    /* Vectors for each OutputType */\n+    std::vector<COutput> legacy;\n+    std::vector<COutput> P2SH_segwit;\n+    std::vector<COutput> bech32;\n+    std::vector<COutput> bech32m;\n+\n+    /** Other is a catch all for anything that doesn't match the known OutputTypes */\n+    std::vector<COutput> other;\n+\n+    /** Concatenate and return all COutputs as one vector */\n+    std::vector<COutput> all() const;\n+\n+    /** The following methods are provided so that CoinsResult can mimic a vector,\n+     * i.e methods can work with invidivudal OutputType vectors or on the entire object */\n+    uint64_t size() const;\n+    void clear();\n+\n+    /** Sum of all available coins **/",
      "path": "src/wallet/spend.h",
      "position": null,
      "original_position": 32,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    /** Sum of all available coins */\r\n```",
      "created_at": "2022-06-25T21:36:26Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906726458",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906726458"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 63,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906726544",
      "pull_request_review_id": 1019324006,
      "id": 906726544,
      "node_id": "PRRC_kwDOABII5842C4yQ",
      "diff_hunk": "@@ -34,14 +34,38 @@ struct TxSize {\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const std::vector<CTxOut>& txouts, const CCoinControl* coin_control = nullptr);\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const CCoinControl* coin_control = nullptr) EXCLUSIVE_LOCKS_REQUIRED(wallet->cs_wallet);\n \n+/**\n+ * COutputs available for spending, stored by OutputType.\n+ * This struct is really just a wrapper around OutputType vectors with a convenient\n+ * method for concatenating and returning all COutputs as one vector.\n+ *\n+ * clear(), size() methods are implemented so that one can interact with\n+ * the CoinsResult struct as if it were a vector\n+ */\n struct CoinsResult {\n-    std::vector<COutput> coins;\n-    // Sum of all the coins amounts\n+    /* Vectors for each OutputType */\n+    std::vector<COutput> legacy;\n+    std::vector<COutput> P2SH_segwit;\n+    std::vector<COutput> bech32;\n+    std::vector<COutput> bech32m;\n+\n+    /** Other is a catch all for anything that doesn't match the known OutputTypes */",
      "path": "src/wallet/spend.h",
      "position": null,
      "original_position": 21,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    /** Other is a catch-all for anything that doesn't match the known OutputTypes */\r\n```",
      "created_at": "2022-06-25T21:37:35Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906726544",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906726544"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906726681",
      "pull_request_review_id": 1019324006,
      "id": 906726681,
      "node_id": "PRRC_kwDOABII5842C40Z",
      "diff_hunk": "@@ -34,14 +34,38 @@ struct TxSize {\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const std::vector<CTxOut>& txouts, const CCoinControl* coin_control = nullptr);\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const CCoinControl* coin_control = nullptr) EXCLUSIVE_LOCKS_REQUIRED(wallet->cs_wallet);\n \n+/**\n+ * COutputs available for spending, stored by OutputType.\n+ * This struct is really just a wrapper around OutputType vectors with a convenient\n+ * method for concatenating and returning all COutputs as one vector.\n+ *\n+ * clear(), size() methods are implemented so that one can interact with\n+ * the CoinsResult struct as if it were a vector\n+ */\n struct CoinsResult {\n-    std::vector<COutput> coins;\n-    // Sum of all the coins amounts\n+    /* Vectors for each OutputType */\n+    std::vector<COutput> legacy;\n+    std::vector<COutput> P2SH_segwit;\n+    std::vector<COutput> bech32;\n+    std::vector<COutput> bech32m;\n+\n+    /** Other is a catch all for anything that doesn't match the known OutputTypes */\n+    std::vector<COutput> other;\n+\n+    /** Concatenate and return all COutputs as one vector */\n+    std::vector<COutput> all() const;\n+\n+    /** The following methods are provided so that CoinsResult can mimic a vector,\n+     * i.e methods can work with invidivudal OutputType vectors or on the entire object */",
      "path": "src/wallet/spend.h",
      "position": null,
      "original_position": 28,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n     * i.e., methods can work with individual OutputType vectors or on the entire object */\r\n```",
      "created_at": "2022-06-25T21:39:28Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906726681",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906726681"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 59,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906727275",
      "pull_request_review_id": 1019324006,
      "id": 906727275,
      "node_id": "PRRC_kwDOABII5842C49r",
      "diff_hunk": "@@ -383,20 +453,55 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n     return groups_out;\n }\n \n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n-                               const CoinSelectionParams& coin_selection_params)\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                               const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types)\n+{\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.legacy, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 120,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    }\r\n```\r\n(and similarly below)",
      "created_at": "2022-06-25T21:48:21Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906727275",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906727275"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 463,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906728058",
      "pull_request_review_id": 1019324006,
      "id": 906728058,
      "node_id": "PRRC_kwDOABII5842C5J6",
      "diff_hunk": "@@ -34,14 +34,38 @@ struct TxSize {\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const std::vector<CTxOut>& txouts, const CCoinControl* coin_control = nullptr);\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const CCoinControl* coin_control = nullptr) EXCLUSIVE_LOCKS_REQUIRED(wallet->cs_wallet);\n \n+/**\n+ * COutputs available for spending, stored by OutputType.\n+ * This struct is really just a wrapper around OutputType vectors with a convenient\n+ * method for concatenating and returning all COutputs as one vector.\n+ *\n+ * clear(), size() methods are implemented so that one can interact with\n+ * the CoinsResult struct as if it were a vector",
      "path": "src/wallet/spend.h",
      "position": null,
      "original_position": 10,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n * the CoinsResult struct as if it was a vector\r\n```",
      "created_at": "2022-06-25T21:57:58Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906728058",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906728058"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 43,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906728756",
      "pull_request_review_id": 1019324006,
      "id": 906728756,
      "node_id": "PRRC_kwDOABII5842C5U0",
      "diff_hunk": "@@ -72,35 +96,52 @@ const CTxOut& FindNonChangeParentOutput(const CWallet& wallet, const COutPoint&\n std::map<CTxDestination, std::vector<COutput>> ListCoins(const CWallet& wallet) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);\n \n std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<COutput>& outputs, const CoinSelectionParams& coin_sel_params, const CoinEligibilityFilter& filter, bool positive_only);\n+/**\n+ * Attempt to find a valid input set that preserves privacy by not mixing OutputTypes.\n+ * `ChooseSelectionResult()` will be called on each OutputType individually and the best\n+ * the solution (according to the waste metric) will be chosen. If a valid input cannot be found from any\n+ * single OutputType, fallback to running `ChooseSelectionResult()` over all available coins.\n+ *\n+ * param@[in]  wallet                    The wallet which provides solving data for the coins\n+ * param@[in]  nTargetValue              The target value\n+ * param@[in]  eligilibity_filter        A filter containing rules for which coins are allowed to be included in this selection\n+ * param@[in]  available_coins           The struct of coins, organized by OutputType, available for selection prior to filtering\n+ * param@[in]  coin_selection_params     Parameters for the coin selection\n+ * param@[in]  allow_mixed_output_types  Relax restriction that SelectionResults must be of the same OutputType\n+ * returns                               If successful, a SelectionResult containing the input set\n+ *                                       If failed, a nullopt\n+ */\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                        const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types);",
      "path": "src/wallet/spend.h",
      "position": 63,
      "original_position": 63,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "clang-format\r\n```suggestion\r\nstd::optional<SelectionResult> AttemptSelection(\r\n    const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\r\n    const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types);\r\n```",
      "created_at": "2022-06-25T22:08:15Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906728756",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906728756"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": 109,
      "original_start_line": 114,
      "start_side": "RIGHT",
      "line": 110,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906728948",
      "pull_request_review_id": 1019324006,
      "id": 906728948,
      "node_id": "PRRC_kwDOABII5842C5X0",
      "diff_hunk": "@@ -72,35 +96,52 @@ const CTxOut& FindNonChangeParentOutput(const CWallet& wallet, const COutPoint&\n std::map<CTxDestination, std::vector<COutput>> ListCoins(const CWallet& wallet) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);\n \n std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<COutput>& outputs, const CoinSelectionParams& coin_sel_params, const CoinEligibilityFilter& filter, bool positive_only);\n+/**\n+ * Attempt to find a valid input set that preserves privacy by not mixing OutputTypes.\n+ * `ChooseSelectionResult()` will be called on each OutputType individually and the best\n+ * the solution (according to the waste metric) will be chosen. If a valid input cannot be found from any\n+ * single OutputType, fallback to running `ChooseSelectionResult()` over all available coins.\n+ *\n+ * param@[in]  wallet                    The wallet which provides solving data for the coins\n+ * param@[in]  nTargetValue              The target value\n+ * param@[in]  eligilibity_filter        A filter containing rules for which coins are allowed to be included in this selection\n+ * param@[in]  available_coins           The struct of coins, organized by OutputType, available for selection prior to filtering\n+ * param@[in]  coin_selection_params     Parameters for the coin selection\n+ * param@[in]  allow_mixed_output_types  Relax restriction that SelectionResults must be of the same OutputType\n+ * returns                               If successful, a SelectionResult containing the input set\n+ *                                       If failed, a nullopt\n+ */\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                        const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types);\n \n /**\n  * Attempt to find a valid input set that meets the provided eligibility filter and target.\n  * Multiple coin selection algorithms will be run and the input set that produces the least waste\n  * (according to the waste metric) will be chosen.\n  *\n- * param@[in]  wallet                 The wallet which provides solving data for the coins\n- * param@[in]  nTargetValue           The target value\n- * param@[in]  eligilibity_filter     A filter containing rules for which coins are allowed to be included in this selection\n- * param@[in]  coins                  The vector of coins available for selection prior to filtering\n- * param@[in]  coin_selection_params  Parameters for the coin selection\n- * returns                            If successful, a SelectionResult containing the input set\n- *                                    If failed, a nullopt\n+ * param@[in]  wallet                    The wallet which provides solving data for the coins\n+ * param@[in]  nTargetValue              The target value\n+ * param@[in]  eligilibity_filter        A filter containing rules for which coins are allowed to be included in this selection\n+ * param@[in]  available_coins           The vector of coins available for selection prior to filtering\n+ * param@[in]  coin_selection_params     Parameters for the coin selection\n+ * returns                               If successful, a SelectionResult containing the input set\n+ *                                       If failed, a nullopt\n  */\n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n+std::optional<SelectionResult> ChooseSelectionResult(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const std::vector<COutput>& available_coins,\n                         const CoinSelectionParams& coin_selection_params);",
      "path": "src/wallet/spend.h",
      "position": 87,
      "original_position": 87,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "clang-format\r\n```suggestion\r\nstd::optional<SelectionResult> ChooseSelectionResult(\r\n    const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const std::vector<COutput>& available_coins,\r\n    const CoinSelectionParams& coin_selection_params);\r\n```",
      "created_at": "2022-06-25T22:10:34Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906728948",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906728948"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": 125,
      "original_start_line": 130,
      "start_side": "RIGHT",
      "line": 126,
      "original_line": 126,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906729278",
      "pull_request_review_id": 1019324006,
      "id": 906729278,
      "node_id": "PRRC_kwDOABII5842C5c-",
      "diff_hunk": "@@ -72,35 +96,52 @@ const CTxOut& FindNonChangeParentOutput(const CWallet& wallet, const COutPoint&\n std::map<CTxDestination, std::vector<COutput>> ListCoins(const CWallet& wallet) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);\n \n std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<COutput>& outputs, const CoinSelectionParams& coin_sel_params, const CoinEligibilityFilter& filter, bool positive_only);\n+/**\n+ * Attempt to find a valid input set that preserves privacy by not mixing OutputTypes.\n+ * `ChooseSelectionResult()` will be called on each OutputType individually and the best\n+ * the solution (according to the waste metric) will be chosen. If a valid input cannot be found from any\n+ * single OutputType, fallback to running `ChooseSelectionResult()` over all available coins.\n+ *\n+ * param@[in]  wallet                    The wallet which provides solving data for the coins\n+ * param@[in]  nTargetValue              The target value\n+ * param@[in]  eligilibity_filter        A filter containing rules for which coins are allowed to be included in this selection\n+ * param@[in]  available_coins           The struct of coins, organized by OutputType, available for selection prior to filtering\n+ * param@[in]  coin_selection_params     Parameters for the coin selection\n+ * param@[in]  allow_mixed_output_types  Relax restriction that SelectionResults must be of the same OutputType\n+ * returns                               If successful, a SelectionResult containing the input set\n+ *                                       If failed, a nullopt\n+ */\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                        const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types);\n \n /**\n  * Attempt to find a valid input set that meets the provided eligibility filter and target.\n  * Multiple coin selection algorithms will be run and the input set that produces the least waste\n  * (according to the waste metric) will be chosen.\n  *\n- * param@[in]  wallet                 The wallet which provides solving data for the coins\n- * param@[in]  nTargetValue           The target value\n- * param@[in]  eligilibity_filter     A filter containing rules for which coins are allowed to be included in this selection\n- * param@[in]  coins                  The vector of coins available for selection prior to filtering\n- * param@[in]  coin_selection_params  Parameters for the coin selection\n- * returns                            If successful, a SelectionResult containing the input set\n- *                                    If failed, a nullopt\n+ * param@[in]  wallet                    The wallet which provides solving data for the coins\n+ * param@[in]  nTargetValue              The target value\n+ * param@[in]  eligilibity_filter        A filter containing rules for which coins are allowed to be included in this selection\n+ * param@[in]  available_coins           The vector of coins available for selection prior to filtering\n+ * param@[in]  coin_selection_params     Parameters for the coin selection\n+ * returns                               If successful, a SelectionResult containing the input set\n+ *                                       If failed, a nullopt\n  */\n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n+std::optional<SelectionResult> ChooseSelectionResult(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const std::vector<COutput>& available_coins,\n                         const CoinSelectionParams& coin_selection_params);\n \n /**\n  * Select a set of coins such that nTargetValue is met and at least\n  * all coins from coin_control are selected; never select unconfirmed coins if they are not ours\n  * param@[in]   wallet                 The wallet which provides data necessary to spend the selected coins\n- * param@[in]   vAvailableCoins        The vector of coins available to be spent\n+ * param@[in]   available_coins        The struct of coins, organized by OutputType, available for selection prior to filtering\n  * param@[in]   nTargetValue           The target value\n  * param@[in]   coin_selection_params  Parameters for this coin selection such as feerates, whether to avoid partial spends,\n  *                                     and whether to subtract the fee from the outputs.\n  * returns                             If successful, a SelectionResult containing the selected coins\n  *                                     If failed, a nullopt.\n  */\n-std::optional<SelectionResult> SelectCoins(const CWallet& wallet, const std::vector<COutput>& vAvailableCoins, const CAmount& nTargetValue, const CCoinControl& coin_control,\n+std::optional<SelectionResult> SelectCoins(const CWallet& wallet, CoinsResult& available_coins, const CAmount& nTargetValue, const CCoinControl& coin_control,\n                  const CoinSelectionParams& coin_selection_params) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);",
      "path": "src/wallet/spend.h",
      "position": 103,
      "original_position": 103,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "clang-format\r\n```suggestion\r\nstd::optional<SelectionResult> SelectCoins(\r\n    const CWallet& wallet, CoinsResult& available_coins, const CAmount& nTargetValue, const CCoinControl& coin_control,\r\n    const CoinSelectionParams& coin_selection_params) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);\r\n```",
      "created_at": "2022-06-25T22:14:03Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906729278",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906729278"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": 139,
      "original_start_line": 144,
      "start_side": "RIGHT",
      "line": 140,
      "original_line": 140,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906729500",
      "pull_request_review_id": 1019324006,
      "id": 906729500,
      "node_id": "PRRC_kwDOABII5842C5gc",
      "diff_hunk": "@@ -0,0 +1,105 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.",
      "path": "src/wallet/test/availablecoins_tests.cpp",
      "position": null,
      "original_position": 3,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n// file COPYING or https://www.opensource.org/licenses/mit-license.php.\r\n```",
      "created_at": "2022-06-25T22:16:57Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906729500",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906729500"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906729778",
      "pull_request_review_id": 1019324006,
      "id": 906729778,
      "node_id": "PRRC_kwDOABII5842C5ky",
      "diff_hunk": "@@ -0,0 +1,189 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 4,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n# file COPYING or https://www.opensource.org/licenses/mit-license.php.\r\n```",
      "created_at": "2022-06-25T22:20:30Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906729778",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906729778"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906729814",
      "pull_request_review_id": 1019324006,
      "id": 906729814,
      "node_id": "PRRC_kwDOABII5842C5lW",
      "diff_hunk": "@@ -0,0 +1,189 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 7,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\nA wallet may have different types of UTXOs to choose from during coin selection,\r\n```",
      "created_at": "2022-06-25T22:21:31Z",
      "updated_at": "2022-06-25T22:38:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r906729814",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/906729814"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 7,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907733451",
      "pull_request_review_id": 1020689658,
      "id": 907733451,
      "node_id": "PRRC_kwDOABII5842GunL",
      "diff_hunk": "@@ -199,9 +225,53 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n             if (!spendable && only_spendable) continue;\n \n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n-            result.coins.emplace_back(outpoint, output, nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me, feerate);\n-            result.total_amount += output.nValue;\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+            bool is_from_p2sh{false};\n+\n+            // If the Output is P2SH and spendable, we want to know if it is\n+            // a P2SH (legacy) or one of P2SH-P2WPKH, P2SH-P2WSH (P2SH-Segwit). We can determine\n+            // this from the redeemScript. If the Output is not spendable, it will be classified\n+            // as a P2SH (legacy), since we have no way of knowing otherwise without the redeemScript\n+            if (output.scriptPubKey.IsPayToScriptHash() && spendable) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "2f3d3622a8b0d5dccdd574d5e37d8239a2f8ed4d",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 2f3d3622a8b0d5dccdd574d5e37d8239a2f8ed4d \"refactor: store by OutputType in CoinsResult\"\r\n\r\n`solvable` is good enough for this check. We just need to be able to look up the script which `solvable` indicates.\r\n\r\n```suggestion\r\n            if (output.scriptPubKey.IsPayToScriptHash() && solvable) {\r\n```",
      "created_at": "2022-06-27T19:37:22Z",
      "updated_at": "2022-06-27T20:18:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r907733451",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907733451"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 238,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907737119",
      "pull_request_review_id": 1020689658,
      "id": 907737119,
      "node_id": "PRRC_kwDOABII5842Gvgf",
      "diff_hunk": "@@ -199,9 +225,53 @@ CoinsResult AvailableCoins(const CWallet& wallet,\n             if (!spendable && only_spendable) continue;\n \n             int input_bytes = GetTxSpendSize(wallet, wtx, i, (coinControl && coinControl->fAllowWatchOnly));\n-            result.coins.emplace_back(outpoint, output, nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me, feerate);\n-            result.total_amount += output.nValue;\n+            // When parsing a scriptPubKey, Solver returns the parsed pubkeys or hashes (depending on the script)\n+            // We don't need those here, so we are leaving them in return_values_unused\n+            std::vector<std::vector<uint8_t>> return_values_unused;\n+            TxoutType type;\n+            bool is_from_p2sh{false};\n+\n+            // If the Output is P2SH and spendable, we want to know if it is\n+            // a P2SH (legacy) or one of P2SH-P2WPKH, P2SH-P2WSH (P2SH-Segwit). We can determine\n+            // this from the redeemScript. If the Output is not spendable, it will be classified\n+            // as a P2SH (legacy), since we have no way of knowing otherwise without the redeemScript\n+            if (output.scriptPubKey.IsPayToScriptHash() && spendable) {\n+                CScript redeemScript;\n+                CTxDestination destination;\n+                if (!ExtractDestination(output.scriptPubKey, destination))\n+                    continue;\n+                const CScriptID& hash = CScriptID(std::get<ScriptHash>(destination));\n+                if (!provider->GetCScript(hash, redeemScript))\n+                    continue;\n+                type = Solver(redeemScript, return_values_unused);\n+                is_from_p2sh = true;\n+            } else {\n+                type = Solver(output.scriptPubKey, return_values_unused);\n+            }\n \n+            COutput coin(outpoint, output, nDepth, input_bytes, spendable, solvable, safeTx, wtx.GetTxTime(), tx_from_me, feerate);\n+            switch (type) {\n+            case TxoutType::WITNESS_V1_TAPROOT:",
      "path": "src/wallet/spend.cpp",
      "position": 66,
      "original_position": 65,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "2f3d3622a8b0d5dccdd574d5e37d8239a2f8ed4d",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 2f3d3622a8b0d5dccdd574d5e37d8239a2f8ed4d \"refactor: store by OutputType in CoinsResult\"\r\n\r\nI think `WITNESS_UNKNOWN` should also be classified as bech32m.\r\n\r\n```suggestion\r\n            case TxoutType::WITNESS_UNKNOWN:\r\n            case TxoutType::WITNESS_V1_TAPROOT:\r\n```",
      "created_at": "2022-06-27T19:42:21Z",
      "updated_at": "2022-06-27T20:18:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r907737119",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907737119"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 250,
      "original_line": 250,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907757656",
      "pull_request_review_id": 1020689658,
      "id": 907757656,
      "node_id": "PRRC_kwDOABII5842G0hY",
      "diff_hunk": "@@ -0,0 +1,189 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds. Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends 10\n+random value payments to Bob, creating 5 bech32 UTXOs and 5 P2SH UTXOs,\n+for a total of 30BTC in Bob's wallet.\n+\n+Bob then sends random valued payments back to Alice, some of which need\n+unconfirmed change, and we verify that none of these payments contain mixed\n+inputs. Finally, Bob sends the remainder of his funds, which requires mixing.\n+\n+The payment values are random, but chosen such that they sum up to a specified\n+total. This ensures we are not relying on specific values for the UTXOs,\n+but still know when to expect mixing due to the wallet being close to empty.\n+\n+\"\"\"\n+\n+import random\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+\n+ADDRESS_TYPES = [\n+    \"bech32m\",\n+    \"bech32\",\n+    \"p2sh-segwit\",\n+    \"legacy\",\n+]\n+\n+\n+def is_bech32_address(node, addr):\n+    \"\"\"Check if an address contains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            not addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 0\n+        )\n+    return False\n+\n+\n+def is_bech32m_address(node, addr):\n+    \"\"\"Check if an address contains a bech32m output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 1\n+        )\n+    return False\n+\n+\n+def is_p2sh_segwit_address(node, addr):\n+    \"\"\"Check if an address contains a P2SH-Segwit outputself.\n+       Note: this function does not actually determine the type\n+       of P2SH output, but is sufficient for this test in that\n+       we are only generating P2SH-Segwit outputs.\n+    \"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        addr_info['isscript'] and\n+        not addr_info['iswitness']\n+    )\n+\n+\n+def is_legacy_address(node, addr):\n+    \"\"\"Check if an address contains a legacy output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (not addr_info['isscript'] and not addr_info['iswitness'])\n+\n+\n+def is_same_type(node, tx):\n+    \"\"\"Check that all inputs are of the same OutputType\"\"\"\n+    vins = node.getrawtransaction(tx, True)['vin']\n+    inputs = []\n+    for vin in vins:\n+        prev_tx, n = vin['txid'], vin['vout']\n+        inputs.append(\n+            node.getrawtransaction(\n+                prev_tx,\n+                True,\n+            )['vout'][n]['scriptPubKey']['address']\n+        )\n+    has_legacy = False\n+    has_p2sh = False\n+    has_bech32 = False\n+    has_bech32m = False\n+\n+    for addr in inputs:\n+        if is_legacy_address(node, addr):\n+            has_legacy = True\n+        if is_p2sh_segwit_address(node, addr):\n+            has_p2sh = True\n+        if is_bech32_address(node, addr):\n+            has_bech32 = True\n+        if is_bech32m_address(node, addr):\n+            has_bech32m = True\n+\n+    return (sum([has_legacy, has_p2sh, has_bech32, has_bech32m]) == 1)\n+\n+\n+def generate_payment_values(n, m):\n+    \"\"\"Return a randomly chosen list of n positive integers summing to m.\n+    Each such list is equally likely to occur.\"\"\"\n+\n+    dividers = sorted(random.sample(range(1, m), n - 1))\n+    return [a - b for a, b in zip(dividers + [m], [0] + dividers)]\n+\n+\n+class AddressInputTypeGrouping(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 2\n+        self.extra_args = [\n+            [\n+                \"-addresstype=bech32\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+            [\n+                \"-addresstype=p2sh-segwit\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+        ]\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def make_payment(self, A, B, v, addr_type):\n+        fee_rate = random.randint(1, 20)\n+        self.log.debug(f\"Making payment of {v} BTC at fee_rate {fee_rate}\")\n+        tx = B.sendtoaddress(\n+            address=A.getnewaddress(address_type=addr_type),\n+            amount=v,\n+            fee_rate=fee_rate,\n+        )\n+        return tx\n+\n+    def run_test(self):\n+\n+        # alias self.nodes[i] to A, B for readability\n+        A, B = self.nodes[0], self.nodes[1]\n+        self.generate(A, COINBASE_MATURITY + 5)\n+\n+        self.log.info(\"Creating mixed UTXOs in B's wallet\")\n+        for v in generate_payment_values(3, 10):\n+            self.log.debug(f\"Making payment of {v} BTC to legacy\")\n+            A.sendtoaddress(B.getnewaddress(address_type=\"legacy\"), v)\n+\n+        for v in generate_payment_values(3, 10):\n+            self.log.debug(f\"Making payment of {v} BTC to p2sh\")\n+            A.sendtoaddress(B.getnewaddress(address_type=\"p2sh-segwit\"), v)\n+\n+        for v in generate_payment_values(3, 10):\n+            self.log.debug(f\"Making payment of {v} BTC to bech32\")\n+            A.sendtoaddress(B.getnewaddress(address_type=\"bech32\"), v)\n+\n+        for v in generate_payment_values(3, 10):\n+            self.log.debug(f\"Making payment of {v} BTC to bech32m\")\n+            A.sendtoaddress(B.getnewaddress(address_type=\"bech32m\"), v)\n+\n+        self.generate(A, 1)\n+\n+        self.log.info(\"Sending payments from B to A\")\n+        for v in generate_payment_values(10, 20):",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 177,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "ffcc600156e45968b47586e6758f107a56d6b80e",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In ffcc600156e45968b47586e6758f107a56d6b80e \"test: functional test for new coin selection logic\"\r\n\r\nHow can we be sure that `v` is never greater than 10 (and thus result in mixing input types)?",
      "created_at": "2022-06-27T20:10:48Z",
      "updated_at": "2022-06-27T20:18:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r907757656",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907757656"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 177,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907762558",
      "pull_request_review_id": 1020689658,
      "id": 907762558,
      "node_id": "PRRC_kwDOABII5842G1t-",
      "diff_hunk": "@@ -0,0 +1,189 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds. Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends 10\n+random value payments to Bob, creating 5 bech32 UTXOs and 5 P2SH UTXOs,\n+for a total of 30BTC in Bob's wallet.\n+\n+Bob then sends random valued payments back to Alice, some of which need\n+unconfirmed change, and we verify that none of these payments contain mixed\n+inputs. Finally, Bob sends the remainder of his funds, which requires mixing.\n+\n+The payment values are random, but chosen such that they sum up to a specified\n+total. This ensures we are not relying on specific values for the UTXOs,\n+but still know when to expect mixing due to the wallet being close to empty.\n+\n+\"\"\"\n+\n+import random\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+\n+ADDRESS_TYPES = [\n+    \"bech32m\",\n+    \"bech32\",\n+    \"p2sh-segwit\",\n+    \"legacy\",\n+]\n+\n+\n+def is_bech32_address(node, addr):\n+    \"\"\"Check if an address contains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            not addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 0\n+        )\n+    return False\n+\n+\n+def is_bech32m_address(node, addr):\n+    \"\"\"Check if an address contains a bech32m output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 1\n+        )\n+    return False\n+\n+\n+def is_p2sh_segwit_address(node, addr):\n+    \"\"\"Check if an address contains a P2SH-Segwit outputself.\n+       Note: this function does not actually determine the type\n+       of P2SH output, but is sufficient for this test in that\n+       we are only generating P2SH-Segwit outputs.\n+    \"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        addr_info['isscript'] and\n+        not addr_info['iswitness']\n+    )",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 74,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "ffcc600156e45968b47586e6758f107a56d6b80e",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In ffcc600156e45968b47586e6758f107a56d6b80e \"test: functional test for new coin selection logic\"\r\n\r\nThe easiest way to check for address type is to check what the descriptor starts with. `sh(wpkh(` or `sh(wsh(` is p2sh-segwit, `wpkh(` or `wsh(` is bech32, `tr(` is bech32m, and `pkh(` is legacy.",
      "created_at": "2022-06-27T20:17:19Z",
      "updated_at": "2022-06-27T20:18:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r907762558",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/907762558"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 64,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 74,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908271866",
      "pull_request_review_id": 1021438373,
      "id": 908271866,
      "node_id": "PRRC_kwDOABII5842IyD6",
      "diff_hunk": "@@ -0,0 +1,189 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds. Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends 10\n+random value payments to Bob, creating 5 bech32 UTXOs and 5 P2SH UTXOs,\n+for a total of 30BTC in Bob's wallet.\n+\n+Bob then sends random valued payments back to Alice, some of which need\n+unconfirmed change, and we verify that none of these payments contain mixed\n+inputs. Finally, Bob sends the remainder of his funds, which requires mixing.\n+\n+The payment values are random, but chosen such that they sum up to a specified\n+total. This ensures we are not relying on specific values for the UTXOs,\n+but still know when to expect mixing due to the wallet being close to empty.\n+\n+\"\"\"\n+\n+import random\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+\n+ADDRESS_TYPES = [\n+    \"bech32m\",\n+    \"bech32\",\n+    \"p2sh-segwit\",\n+    \"legacy\",\n+]\n+\n+\n+def is_bech32_address(node, addr):\n+    \"\"\"Check if an address contains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            not addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 0\n+        )\n+    return False\n+\n+\n+def is_bech32m_address(node, addr):\n+    \"\"\"Check if an address contains a bech32m output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 1\n+        )\n+    return False\n+\n+\n+def is_p2sh_segwit_address(node, addr):\n+    \"\"\"Check if an address contains a P2SH-Segwit outputself.\n+       Note: this function does not actually determine the type\n+       of P2SH output, but is sufficient for this test in that\n+       we are only generating P2SH-Segwit outputs.\n+    \"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        addr_info['isscript'] and\n+        not addr_info['iswitness']\n+    )",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 74,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "ffcc600156e45968b47586e6758f107a56d6b80e",
      "in_reply_to_id": 907762558,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nice! this test only runs with `--descriptors` so ill update the `is_<addrtype>` functions",
      "created_at": "2022-06-28T09:41:59Z",
      "updated_at": "2022-06-28T09:41:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r908271866",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908271866"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 64,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 74,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908822322",
      "pull_request_review_id": 1022229917,
      "id": 908822322,
      "node_id": "PRRC_kwDOABII5842K4cy",
      "diff_hunk": "@@ -34,14 +34,38 @@ struct TxSize {\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const std::vector<CTxOut>& txouts, const CCoinControl* coin_control = nullptr);\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const CCoinControl* coin_control = nullptr) EXCLUSIVE_LOCKS_REQUIRED(wallet->cs_wallet);\n \n+/**\n+ * COutputs available for spending, stored by OutputType.\n+ * This struct is really just a wrapper around OutputType vectors with a convenient\n+ * method for concatenating and returning all COutputs as one vector.\n+ *\n+ * clear(), size() methods are implemented so that one can interact with\n+ * the AvailableCoins struct as if it were a vector\n+ */\n struct CoinsResult {",
      "path": "src/wallet/spend.h",
      "position": 12,
      "original_position": 12,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "2f3d3622a8b0d5dccdd574d5e37d8239a2f8ed4d",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In 2f3d3622a8b0d5dccdd574d5e37d8239a2f8ed4d refactor: store by OutputType in CoinsResult:\r\n\r\nNaming-nit:\r\nFrom what I can tell, the struct that previously was `AvailableCoins` was renamed to `CoinsResult`. I'd submit that `AvailableCoins` was more descriptive.Isn't any function's output a \"result\"? It feels like adding \"Result\" dosen't add any information. The most notable things about this struct are that it a) lists the available UTXOs, b) separated by output types. These aspects are not captured well by `CoinsResult`.  \r\n\r\nSince `AvailableCoins` seems to be out of favor: We usually call the set of UTXOs available to a wallet its \"UTXO pool\". Since this codebase uses \"Coin\" for UTXO  frequently, maybe call this struct `CoinPool`, or `CoinPools` to stress that there are multiple sets?\r\n\r\n```suggestion\r\nstruct CoinPools {\r\n```",
      "created_at": "2022-06-28T18:40:21Z",
      "updated_at": "2022-06-28T19:48:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r908822322",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908822322"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 40,
      "original_line": 40,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908830050",
      "pull_request_review_id": 1022229917,
      "id": 908830050,
      "node_id": "PRRC_kwDOABII5842K6Vi",
      "diff_hunk": "@@ -56,9 +56,9 @@ static void CoinSelection(benchmark::Bench& bench)\n     addCoin(3 * COIN, wallet, wtxs);\n ",
      "path": "src/bench/coin_selection.cpp",
      "position": 2,
      "original_position": 2,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "3520cf9d76d24e43b3ba08fe03687ee1b2e2368e",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit message for 3520cf9d76d24e43b3ba08fe03687ee1b2e2368e (refactor: use AvailableCoins struct in SelectCoins)\r\n\r\nThe struct has been renamed to `CoinsResult` but is referred to as `AvailableCoins` in the commit message.",
      "created_at": "2022-06-28T18:50:18Z",
      "updated_at": "2022-06-28T19:48:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r908830050",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908830050"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 57,
      "original_line": 57,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908864044",
      "pull_request_review_id": 1022229917,
      "id": 908864044,
      "node_id": "PRRC_kwDOABII5842LCos",
      "diff_hunk": "@@ -105,26 +105,42 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n  * param@[in]  wallet                 The wallet which provides solving data for the coins\n  * param@[in]  nTargetValue           The target value\n  * param@[in]  eligilibity_filter     A filter containing rules for which coins are allowed to be included in this selection\n- * param@[in]  coins                  The vector of coins available for selection prior to filtering\n+ * param@[in]  available_coins        The struct of coins, organized by OutputType, available for selection prior to filtering\n  * param@[in]  coin_selection_params  Parameters for the coin selection\n  * returns                            If successful, a SelectionResult containing the input set\n  *                                    If failed, a nullopt\n  */\n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                        const CoinSelectionParams& coin_selection_params);\n+\n+/**\n+ * Attempt to find a valid input set that meets the provided eligibility filter and target.\n+ * Multiple coin selection algorithms will be run and the input set that produces the least waste\n+ * (according to the waste metric) will be chosen.\n+ *\n+ * param@[in]  wallet                    The wallet which provides solving data for the coins\n+ * param@[in]  nTargetValue              The target value\n+ * param@[in]  eligilibity_filter        A filter containing rules for which coins are allowed to be included in this selection\n+ * param@[in]  available_coins           The vector of coins available for selection prior to filtering",
      "path": "src/wallet/spend.h",
      "position": null,
      "original_position": 40,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "3520cf9d76d24e43b3ba08fe03687ee1b2e2368e",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Consistency nit: In 3520cf9d76d24e43b3ba08fe03687ee1b2e2368e (refactor: use AvailableCoins struct in SelectCoins) \r\n\r\nAs below, should perhaps be referred to as the struct?\r\n\r\n```suggestion\r\n * param@[in]  available_coins           The struct of coins, organized by OutputType, available for selection prior to filtering\r\n```",
      "created_at": "2022-06-28T19:25:08Z",
      "updated_at": "2022-06-28T19:48:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r908864044",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/908864044"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913936346",
      "pull_request_review_id": 1028837585,
      "id": 913936346,
      "node_id": "PRRC_kwDOABII5842eY_a",
      "diff_hunk": "@@ -383,20 +453,55 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n     return groups_out;\n }\n \n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n-                               const CoinSelectionParams& coin_selection_params)\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                               const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types)\n+{\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.legacy, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.P2SH_segwit, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32m, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+\n+    // If we can't fund the transaction from any individual OutputType, run coin selection\n+    // over all available coins, else pick the best solution from the results\n+    std::optional<SelectionResult> result = [&] {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 133,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": 906692097,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "it was originally a lambda, but i do think it's more legible without it. also, removing the lambda also takes care of the shadowing ",
      "created_at": "2022-07-05T15:34:49Z",
      "updated_at": "2022-07-05T15:34:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r913936346",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913936346"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 476,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913938049",
      "pull_request_review_id": 1028840075,
      "id": 913938049,
      "node_id": "PRRC_kwDOABII5842eZaB",
      "diff_hunk": "@@ -383,20 +453,55 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n     return groups_out;\n }\n \n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n-                               const CoinSelectionParams& coin_selection_params)\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                               const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types)\n+{\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.legacy, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.P2SH_segwit, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32m, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+\n+    // If we can't fund the transaction from any individual OutputType, run coin selection\n+    // over all available coins, else pick the best solution from the results\n+    std::optional<SelectionResult> result = [&] {\n+        if (results.size() == 0) {\n+            if (allow_mixed_output_types) {\n+                if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.all(), coin_selection_params)}) {\n+                    return result;\n+                }\n+            }\n+            return std::optional<SelectionResult>();\n+        };\n+        std::optional<SelectionResult> result = *std::min_element(results.begin(), results.end());",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 142,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": 906693004,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "fixed by removing the lambda, fixed the initialization to use braces",
      "created_at": "2022-07-05T15:36:41Z",
      "updated_at": "2022-07-05T15:36:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r913938049",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913938049"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 485,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913939806",
      "pull_request_review_id": 1028842596,
      "id": 913939806,
      "node_id": "PRRC_kwDOABII5842eZ1e",
      "diff_hunk": "@@ -383,20 +453,55 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n     return groups_out;\n }\n \n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n-                               const CoinSelectionParams& coin_selection_params)\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                               const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types)\n+{\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.legacy, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.P2SH_segwit, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32m, coin_selection_params)}) {\n+        results.push_back(*result);\n+    };\n+\n+    // If we can't fund the transaction from any individual OutputType, run coin selection\n+    // over all available coins, else pick the best solution from the results\n+    std::optional<SelectionResult> result = [&] {\n+        if (results.size() == 0) {\n+            if (allow_mixed_output_types) {\n+                if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.all(), coin_selection_params)}) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 136,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": 906692135,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "fixed by removing the lambda",
      "created_at": "2022-07-05T15:38:30Z",
      "updated_at": "2022-07-05T15:38:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r913939806",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913939806"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 479,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913941842",
      "pull_request_review_id": 1028845465,
      "id": 913941842,
      "node_id": "PRRC_kwDOABII5842eaVS",
      "diff_hunk": "@@ -488,13 +592,13 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, const std::vec\n         return result;\n     }\n \n-    // remove preset inputs from vCoins so that Coin Selection doesn't pick them.\n-    for (std::vector<COutput>::iterator it = vCoins.begin(); it != vCoins.end() && coin_control.HasSelected();)\n-    {\n-        if (preset_coins.count(it->outpoint))\n-            it = vCoins.erase(it);\n-        else\n-            ++it;\n+    // remove preset inputs from coins so that Coin Selection doesn't pick them.\n+    if (coin_control.HasSelected()) {\n+        available_coins.legacy.erase(remove_if(available_coins.legacy.begin(), available_coins.legacy.end(), [&](const COutput& c) { return preset_coins.count(c.outpoint); }), available_coins.legacy.end());\n+        available_coins.P2SH_segwit.erase(remove_if(available_coins.P2SH_segwit.begin(), available_coins.P2SH_segwit.end(), [&](const COutput& c) { return preset_coins.count(c.outpoint); }), available_coins.P2SH_segwit.end());\n+        available_coins.bech32.erase(remove_if(available_coins.bech32.begin(), available_coins.bech32.end(), [&](const COutput& c) { return preset_coins.count(c.outpoint); }), available_coins.bech32.end());\n+        available_coins.bech32m.erase(remove_if(available_coins.bech32m.begin(), available_coins.bech32m.end(), [&](const COutput& c) { return preset_coins.count(c.outpoint); }), available_coins.bech32m.end());\n+        available_coins.other.erase(remove_if(available_coins.other.begin(), available_coins.other.end(), [&](const COutput& c) { return preset_coins.count(c.outpoint); }), available_coins.other.end());\n     }",
      "path": "src/wallet/spend.cpp",
      "position": 194,
      "original_position": 196,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": 906725861,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "agree that this is not the most readable :sweat_smile: , however i really like @furszy 's suggestion for refactoring this: move the shuffle and erase functions into the `CoinsResult` struct. i didn't take his suggestion in this PR because it requires a bigger refactor than the scope of this PR, but i plan to address it in a follow-up.\r\n\r\nfor reference, it would look like this: https://github.com/furszy/bitcoin-core/commit/a5d4461eb30ad2da63a30a103ec16853689e3d38",
      "created_at": "2022-07-05T15:40:34Z",
      "updated_at": "2022-07-05T15:40:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r913941842",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913941842"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": 592,
      "original_start_line": 596,
      "start_side": "RIGHT",
      "line": 598,
      "original_line": 598,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913945063",
      "pull_request_review_id": 1028850048,
      "id": 913945063,
      "node_id": "PRRC_kwDOABII5842ebHn",
      "diff_hunk": "@@ -0,0 +1,105 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.",
      "path": "src/wallet/test/availablecoins_tests.cpp",
      "position": null,
      "original_position": 3,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": 906729500,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "huh, interesting. seems like we have a mix of http and https throughout the codebase in the license header (mental note to fix this in a follow up)",
      "created_at": "2022-07-05T15:43:51Z",
      "updated_at": "2022-07-05T15:43:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r913945063",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913945063"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/914004521",
      "pull_request_review_id": 1028933751,
      "id": 914004521,
      "node_id": "PRRC_kwDOABII5842epop",
      "diff_hunk": "@@ -34,14 +34,38 @@ struct TxSize {\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const std::vector<CTxOut>& txouts, const CCoinControl* coin_control = nullptr);\n TxSize CalculateMaximumSignedTxSize(const CTransaction& tx, const CWallet* wallet, const CCoinControl* coin_control = nullptr) EXCLUSIVE_LOCKS_REQUIRED(wallet->cs_wallet);\n \n+/**\n+ * COutputs available for spending, stored by OutputType.\n+ * This struct is really just a wrapper around OutputType vectors with a convenient\n+ * method for concatenating and returning all COutputs as one vector.\n+ *\n+ * clear(), size() methods are implemented so that one can interact with\n+ * the AvailableCoins struct as if it were a vector\n+ */\n struct CoinsResult {",
      "path": "src/wallet/spend.h",
      "position": 12,
      "original_position": 12,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "2f3d3622a8b0d5dccdd574d5e37d8239a2f8ed4d",
      "in_reply_to_id": 908822322,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`CoinsResult` was introduced in https://github.com/bitcoin/bitcoin/pull/25005 , which changed `AvailableCoins` to return a struct instead of populating a vector and was introduced here after a rebase.\r\n\r\nPersonally, I prefer `AvailableCoins` as the name of the struct (and renaming the `AvailableCoins` function to `GetAvailableCoins`), but changing the name again in this PR felt a little silly and would have expanded the diff on this PR. I have a follow-up PR in mind which incorporates some feedback from @furszy regarding the `CoinsResult` struct, and I think that would be a better place to address the naming",
      "created_at": "2022-07-05T16:51:24Z",
      "updated_at": "2022-07-05T16:51:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r914004521",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/914004521"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 40,
      "original_line": 40,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/914005090",
      "pull_request_review_id": 1028934580,
      "id": 914005090,
      "node_id": "PRRC_kwDOABII5842epxi",
      "diff_hunk": "@@ -0,0 +1,189 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different type UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds. Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends 10\n+random value payments to Bob, creating 5 bech32 UTXOs and 5 P2SH UTXOs,\n+for a total of 30BTC in Bob's wallet.\n+\n+Bob then sends random valued payments back to Alice, some of which need\n+unconfirmed change, and we verify that none of these payments contain mixed\n+inputs. Finally, Bob sends the remainder of his funds, which requires mixing.\n+\n+The payment values are random, but chosen such that they sum up to a specified\n+total. This ensures we are not relying on specific values for the UTXOs,\n+but still know when to expect mixing due to the wallet being close to empty.\n+\n+\"\"\"\n+\n+import random\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+\n+ADDRESS_TYPES = [\n+    \"bech32m\",\n+    \"bech32\",\n+    \"p2sh-segwit\",\n+    \"legacy\",\n+]\n+\n+\n+def is_bech32_address(node, addr):\n+    \"\"\"Check if an address contains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            not addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 0\n+        )\n+    return False\n+\n+\n+def is_bech32m_address(node, addr):\n+    \"\"\"Check if an address contains a bech32m output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    if addr_info['iswitness']:\n+        return (\n+            addr_info['isscript'] and\n+            addr_info['iswitness'] and addr_info['witness_version'] == 1\n+        )\n+    return False\n+\n+\n+def is_p2sh_segwit_address(node, addr):\n+    \"\"\"Check if an address contains a P2SH-Segwit outputself.\n+       Note: this function does not actually determine the type\n+       of P2SH output, but is sufficient for this test in that\n+       we are only generating P2SH-Segwit outputs.\n+    \"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (\n+        addr_info['isscript'] and\n+        not addr_info['iswitness']\n+    )\n+\n+\n+def is_legacy_address(node, addr):\n+    \"\"\"Check if an address contains a legacy output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return (not addr_info['isscript'] and not addr_info['iswitness'])\n+\n+\n+def is_same_type(node, tx):\n+    \"\"\"Check that all inputs are of the same OutputType\"\"\"\n+    vins = node.getrawtransaction(tx, True)['vin']\n+    inputs = []\n+    for vin in vins:\n+        prev_tx, n = vin['txid'], vin['vout']\n+        inputs.append(\n+            node.getrawtransaction(\n+                prev_tx,\n+                True,\n+            )['vout'][n]['scriptPubKey']['address']\n+        )\n+    has_legacy = False\n+    has_p2sh = False\n+    has_bech32 = False\n+    has_bech32m = False\n+\n+    for addr in inputs:\n+        if is_legacy_address(node, addr):\n+            has_legacy = True\n+        if is_p2sh_segwit_address(node, addr):\n+            has_p2sh = True\n+        if is_bech32_address(node, addr):\n+            has_bech32 = True\n+        if is_bech32m_address(node, addr):\n+            has_bech32m = True\n+\n+    return (sum([has_legacy, has_p2sh, has_bech32, has_bech32m]) == 1)\n+\n+\n+def generate_payment_values(n, m):\n+    \"\"\"Return a randomly chosen list of n positive integers summing to m.\n+    Each such list is equally likely to occur.\"\"\"\n+\n+    dividers = sorted(random.sample(range(1, m), n - 1))\n+    return [a - b for a, b in zip(dividers + [m], [0] + dividers)]\n+\n+\n+class AddressInputTypeGrouping(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 2\n+        self.extra_args = [\n+            [\n+                \"-addresstype=bech32\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+            [\n+                \"-addresstype=p2sh-segwit\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+        ]\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def make_payment(self, A, B, v, addr_type):\n+        fee_rate = random.randint(1, 20)\n+        self.log.debug(f\"Making payment of {v} BTC at fee_rate {fee_rate}\")\n+        tx = B.sendtoaddress(\n+            address=A.getnewaddress(address_type=addr_type),\n+            amount=v,\n+            fee_rate=fee_rate,\n+        )\n+        return tx\n+\n+    def run_test(self):\n+\n+        # alias self.nodes[i] to A, B for readability\n+        A, B = self.nodes[0], self.nodes[1]\n+        self.generate(A, COINBASE_MATURITY + 5)\n+\n+        self.log.info(\"Creating mixed UTXOs in B's wallet\")\n+        for v in generate_payment_values(3, 10):\n+            self.log.debug(f\"Making payment of {v} BTC to legacy\")\n+            A.sendtoaddress(B.getnewaddress(address_type=\"legacy\"), v)\n+\n+        for v in generate_payment_values(3, 10):\n+            self.log.debug(f\"Making payment of {v} BTC to p2sh\")\n+            A.sendtoaddress(B.getnewaddress(address_type=\"p2sh-segwit\"), v)\n+\n+        for v in generate_payment_values(3, 10):\n+            self.log.debug(f\"Making payment of {v} BTC to bech32\")\n+            A.sendtoaddress(B.getnewaddress(address_type=\"bech32\"), v)\n+\n+        for v in generate_payment_values(3, 10):\n+            self.log.debug(f\"Making payment of {v} BTC to bech32m\")\n+            A.sendtoaddress(B.getnewaddress(address_type=\"bech32m\"), v)\n+\n+        self.generate(A, 1)\n+\n+        self.log.info(\"Sending payments from B to A\")\n+        for v in generate_payment_values(10, 20):",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 177,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "ffcc600156e45968b47586e6758f107a56d6b80e",
      "in_reply_to_id": 907757656,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ah, good point. there is nothing to prevent that, altho it is incredibly unlikely. ill change the values to 5 payments which add up to 9 to guarantee there is never a value of >= 10",
      "created_at": "2022-07-05T16:52:08Z",
      "updated_at": "2022-07-05T16:52:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r914005090",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/914005090"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 177,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/914029380",
      "pull_request_review_id": 1028968124,
      "id": 914029380,
      "node_id": "PRRC_kwDOABII5842evtE",
      "diff_hunk": "@@ -72,35 +96,52 @@ const CTxOut& FindNonChangeParentOutput(const CWallet& wallet, const COutPoint&\n std::map<CTxDestination, std::vector<COutput>> ListCoins(const CWallet& wallet) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);\n \n std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<COutput>& outputs, const CoinSelectionParams& coin_sel_params, const CoinEligibilityFilter& filter, bool positive_only);\n+/**\n+ * Attempt to find a valid input set that preserves privacy by not mixing OutputTypes.\n+ * `ChooseSelectionResult()` will be called on each OutputType individually and the best\n+ * the solution (according to the waste metric) will be chosen. If a valid input cannot be found from any\n+ * single OutputType, fallback to running `ChooseSelectionResult()` over all available coins.\n+ *\n+ * param@[in]  wallet                    The wallet which provides solving data for the coins\n+ * param@[in]  nTargetValue              The target value\n+ * param@[in]  eligilibity_filter        A filter containing rules for which coins are allowed to be included in this selection\n+ * param@[in]  available_coins           The struct of coins, organized by OutputType, available for selection prior to filtering\n+ * param@[in]  coin_selection_params     Parameters for the coin selection\n+ * param@[in]  allow_mixed_output_types  Relax restriction that SelectionResults must be of the same OutputType\n+ * returns                               If successful, a SelectionResult containing the input set\n+ *                                       If failed, a nullopt\n+ */\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                        const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types);",
      "path": "src/wallet/spend.h",
      "position": 63,
      "original_position": 63,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "838685a4d018961dcd8315a59028aaa262b61916",
      "in_reply_to_id": 906728756,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "i tried to avoid changing the formatting as much as possible to minimize the diff on this PR, so im inclined to leave it as is, but happy to change if others have an opinion about it.\r\n\r\nnot sure what the recommended best practice here is :man_shrugging: ",
      "created_at": "2022-07-05T17:23:22Z",
      "updated_at": "2022-07-05T17:23:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r914029380",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/914029380"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": 109,
      "original_start_line": 114,
      "start_side": "RIGHT",
      "line": 110,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920299948",
      "pull_request_review_id": 1037679184,
      "id": 920299948,
      "node_id": "PRRC_kwDOABII58422qms",
      "diff_hunk": "@@ -67,7 +67,7 @@ static void add_coin(const CAmount& nValue, int nInput, CoinSet& set, CAmount fe\n     set.insert(coin);\n }",
      "path": "src/wallet/test/coinselector_tests.cpp",
      "position": 2,
      "original_position": 2,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "4be724d8e723c7cc18aec568983c24ee4e753262",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Not a request for this PR, but in the future perhaps consider using a scripted-diffs for large renaming operations.",
      "created_at": "2022-07-13T16:47:34Z",
      "updated_at": "2022-07-13T18:06:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r920299948",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920299948"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 68,
      "original_line": 68,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920340596",
      "pull_request_review_id": 1037679184,
      "id": 920340596,
      "node_id": "PRRC_kwDOABII584220h0",
      "diff_hunk": "@@ -601,34 +626,35 @@ std::optional<SelectionResult> SelectCoins(const CWallet& wallet, CoinsResult& a\n \n         // If possible, fund the transaction with confirmed UTXOs only. Prefer at least six\n         // confirmations on outputs received from other wallets and only spend confirmed change.\n-        if (auto r1{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 6, 0), available_coins, coin_selection_params)}) return r1;\n-        if (auto r2{AttemptSelection(wallet, value_to_select, CoinEligibilityFilter(1, 1, 0), available_coins, coin_selection_params)}) return r2;\n+        // Also, allow mixing if and only if a solution from any single output cannot be found",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "074e58f46b6ca2fe51fb6cb52ac296b971153e9c",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: In \"wallet: run coin selection by OutputType\" (074e58f46b6ca2fe51fb6cb52ac296b971153e9c)\r\n\r\nThe \"output\" here threw me off, I think you meant \"output type\"\r\n```suggestion\r\n        // Also, allow mixing if and only if a solution from any single output type cannot be found\r\n```\r\n\r\nPerhaps go with:\r\n```suggestion\r\n        // Allow mixing only if no solution from any single output type can be found\r\n```\r\n\r\nAlso, this comment seems to be one line too early, shouldn't this be between `r1` and `r2`?",
      "created_at": "2022-07-13T17:35:04Z",
      "updated_at": "2022-07-13T18:06:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r920340596",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920340596"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 629,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920345794",
      "pull_request_review_id": 1037679184,
      "id": 920345794,
      "node_id": "PRRC_kwDOABII584221zC",
      "diff_hunk": "@@ -0,0 +1,176 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different types of UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds. Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends 10\n+random value payments to Bob, creating 5 bech32 UTXOs and 5 P2SH UTXOs,\n+for a total of 30BTC in Bob's wallet.\n+\n+Bob then sends random valued payments back to Alice, some of which need\n+unconfirmed change, and we verify that none of these payments contain mixed\n+inputs. Finally, Bob sends the remainder of his funds, which requires mixing.\n+\n+The payment values are random, but chosen such that they sum up to a specified\n+total. This ensures we are not relying on specific values for the UTXOs,\n+but still know when to expect mixing due to the wallet being close to empty.\n+\n+\"\"\"\n+\n+import random\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+\n+ADDRESS_TYPES = [\n+    \"bech32m\",\n+    \"bech32\",\n+    \"p2sh-segwit\",\n+    \"legacy\",\n+]\n+\n+\n+def is_bech32_address(node, addr):\n+    \"\"\"Check if an address contains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return addr_info['desc'].startswith('wpkh(')\n+\n+\n+def is_bech32m_address(node, addr):\n+    \"\"\"Check if an address contains a bech32m output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return addr_info['desc'].startswith('tr(')\n+\n+\n+def is_p2sh_segwit_address(node, addr):\n+    \"\"\"Check if an address contains a P2SH-Segwit outputself.",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 55,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "d0d64c7858a0d0e2a402a635041126770c7123a5",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    \"\"\"Check if an address contains a P2SH-Segwit output.\r\n```",
      "created_at": "2022-07-13T17:41:11Z",
      "updated_at": "2022-07-13T18:06:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r920345794",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920345794"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 55,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920355560",
      "pull_request_review_id": 1037679184,
      "id": 920355560,
      "node_id": "PRRC_kwDOABII584224Lo",
      "diff_hunk": "@@ -0,0 +1,176 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different types of UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds. Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends 10\n+random value payments to Bob, creating 5 bech32 UTXOs and 5 P2SH UTXOs,\n+for a total of 30BTC in Bob's wallet.",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": null,
      "original_position": 18,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "d0d64c7858a0d0e2a402a635041126770c7123a5",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In \"test: functional test for new coin selection logic\" (d0d64c7858a0d0e2a402a635041126770c7123a5): \r\nThis description seems to be outdated. I think it's now all four types and three UTXOs each for a total of 40.",
      "created_at": "2022-07-13T17:53:16Z",
      "updated_at": "2022-07-13T18:06:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r920355560",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920355560"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 16,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 18,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920364637",
      "pull_request_review_id": 1037679184,
      "id": 920364637,
      "node_id": "PRRC_kwDOABII584226Zd",
      "diff_hunk": "@@ -0,0 +1,105 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\n+#include <validation.h>\n+#include <wallet/coincontrol.h>\n+#include <wallet/spend.h>\n+#include <wallet/test/util.h>\n+#include <wallet/test/wallet_test_fixture.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+namespace wallet {\n+BOOST_FIXTURE_TEST_SUITE(availablecoins_tests, WalletTestingSetup)\n+class AvailableCoinsTestingSetup : public TestChain100Setup\n+{\n+public:\n+    AvailableCoinsTestingSetup()\n+    {\n+        CreateAndProcessBlock({}, {});\n+        wallet = CreateSyncedWallet(*m_node.chain, m_node.chainman->ActiveChain(), m_args, coinbaseKey);\n+    }\n+\n+    ~AvailableCoinsTestingSetup()\n+    {\n+        wallet.reset();\n+    }\n+    CWalletTx& AddTx(CRecipient recipient)\n+    {\n+        CTransactionRef tx;\n+        bilingual_str error;\n+        CCoinControl dummy;\n+        FeeCalculation fee_calc_out;\n+        {\n+            constexpr int RANDOM_CHANGE_POSITION = -1;\n+            std::optional<CreatedTransactionResult> txr = CreateTransaction(*wallet, {recipient}, RANDOM_CHANGE_POSITION, error, dummy, fee_calc_out);",
      "path": "src/wallet/test/availablecoins_tests.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "6530d1950e6f6d5e1e64a2d59f244bb8c6b3996a",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "No change needed: Don't quite understand why the `RANDOM_CHANGE_POSITION` is defined specifically like this. Wouldn't this just work?\r\n\r\n```suggestion\r\n            std::optional<CreatedTransactionResult> txr = CreateTransaction(*wallet, {recipient}, /*change_pos=*/-1, error, dummy, fee_calc_out);\r\n```",
      "created_at": "2022-07-13T18:04:12Z",
      "updated_at": "2022-07-13T18:06:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r920364637",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/920364637"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 35,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 36,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923958534",
      "pull_request_review_id": 1042685819,
      "id": 923958534,
      "node_id": "PRRC_kwDOABII5843En0G",
      "diff_hunk": "@@ -0,0 +1,105 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\n+#include <validation.h>\n+#include <wallet/coincontrol.h>\n+#include <wallet/spend.h>\n+#include <wallet/test/util.h>\n+#include <wallet/test/wallet_test_fixture.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+namespace wallet {\n+BOOST_FIXTURE_TEST_SUITE(availablecoins_tests, WalletTestingSetup)\n+class AvailableCoinsTestingSetup : public TestChain100Setup\n+{\n+public:\n+    AvailableCoinsTestingSetup()\n+    {\n+        CreateAndProcessBlock({}, {});\n+        wallet = CreateSyncedWallet(*m_node.chain, m_node.chainman->ActiveChain(), m_args, coinbaseKey);\n+    }\n+\n+    ~AvailableCoinsTestingSetup()\n+    {\n+        wallet.reset();\n+    }\n+    CWalletTx& AddTx(CRecipient recipient)\n+    {\n+        CTransactionRef tx;\n+        bilingual_str error;\n+        CCoinControl dummy;\n+        FeeCalculation fee_calc_out;\n+        {\n+            constexpr int RANDOM_CHANGE_POSITION = -1;\n+            std::optional<CreatedTransactionResult> txr = CreateTransaction(*wallet, {recipient}, RANDOM_CHANGE_POSITION, error, dummy, fee_calc_out);\n+            BOOST_CHECK(txr.has_value());\n+            tx = txr->tx;\n+        }\n+        wallet->CommitTransaction(tx, {}, {});\n+        CMutableTransaction blocktx;\n+        {\n+            LOCK(wallet->cs_wallet);\n+            blocktx = CMutableTransaction(*wallet->mapWallet.at(tx->GetHash()).tx);\n+        }\n+        CreateAndProcessBlock({CMutableTransaction(blocktx)}, GetScriptForRawPubKey(coinbaseKey.GetPubKey()));\n+\n+        LOCK(wallet->cs_wallet);\n+        wallet->SetLastBlockProcessed(wallet->GetLastBlockHeight() + 1, m_node.chainman->ActiveChain().Tip()->GetBlockHash());\n+        auto it = wallet->mapWallet.find(tx->GetHash());\n+        BOOST_CHECK(it != wallet->mapWallet.end());\n+        it->second.m_state = TxStateConfirmed{m_node.chainman->ActiveChain().Tip()->GetBlockHash(), m_node.chainman->ActiveChain().Height(), /*index=*/1};\n+        return it->second;\n+    }\n+\n+    std::unique_ptr<CWallet> wallet;\n+};\n+\n+BOOST_FIXTURE_TEST_CASE(BasicOutputTypesTest, AvailableCoinsTestingSetup)\n+{\n+    CTxDestination dest;\n+    bilingual_str error;\n+    CoinsResult available_coins;\n+    LOCK(wallet->cs_wallet);\n+\n+    // Verify our wallet has one usable coinbase UTXO before starting\n+    // This UTXO is a P2PK, so it should show up in the Other bucket\n+    available_coins = AvailableCoins(*wallet);\n+    BOOST_CHECK_EQUAL(available_coins.size(), 1U);\n+    BOOST_CHECK_EQUAL(available_coins.other.size(), 1U);\n+\n+    // We will create a self transfer for each of the OutputTypes and\n+    // verify it is put in the correct bucket after running GetAvailablecoins\n+    //\n+    // For each OutputType, We expect 2 UTXOs in our wallet following the self transfer:\n+    //   1. One UTXO as the recipient\n+    //   2. One UTXO from the change, due to payment address matching logic\n+\n+    // Bech32m\n+    wallet->GetNewDestination(OutputType::BECH32M, \"\", dest, error);",
      "path": "src/wallet/test/availablecoins_tests.cpp",
      "position": null,
      "original_position": 80,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "6530d1950e6f6d5e1e64a2d59f244bb8c6b3996a",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Need to adapt this (and the ones below) to the new result class.\r\n\r\n```\r\nconst auto& op_dest = wallet->GetNewDestination(OutputType::BECH32M, \"\");\r\nBOOST_ASSERT(op_dest.HasRes());\r\nconst CTxDestination& dest = op_dest.GetObj();\r\n```",
      "created_at": "2022-07-19T00:23:54Z",
      "updated_at": "2022-07-19T00:23:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r923958534",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/923958534"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 80,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/924625941",
      "pull_request_review_id": 1043616587,
      "id": 924625941,
      "node_id": "PRRC_kwDOABII5843HKwV",
      "diff_hunk": "@@ -0,0 +1,105 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\n+#include <validation.h>\n+#include <wallet/coincontrol.h>\n+#include <wallet/spend.h>\n+#include <wallet/test/util.h>\n+#include <wallet/test/wallet_test_fixture.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+namespace wallet {\n+BOOST_FIXTURE_TEST_SUITE(availablecoins_tests, WalletTestingSetup)\n+class AvailableCoinsTestingSetup : public TestChain100Setup\n+{\n+public:\n+    AvailableCoinsTestingSetup()\n+    {\n+        CreateAndProcessBlock({}, {});\n+        wallet = CreateSyncedWallet(*m_node.chain, m_node.chainman->ActiveChain(), m_args, coinbaseKey);\n+    }\n+\n+    ~AvailableCoinsTestingSetup()\n+    {\n+        wallet.reset();\n+    }\n+    CWalletTx& AddTx(CRecipient recipient)\n+    {\n+        CTransactionRef tx;\n+        bilingual_str error;\n+        CCoinControl dummy;\n+        FeeCalculation fee_calc_out;\n+        {\n+            constexpr int RANDOM_CHANGE_POSITION = -1;\n+            std::optional<CreatedTransactionResult> txr = CreateTransaction(*wallet, {recipient}, RANDOM_CHANGE_POSITION, error, dummy, fee_calc_out);",
      "path": "src/wallet/test/availablecoins_tests.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "6530d1950e6f6d5e1e64a2d59f244bb8c6b3996a",
      "in_reply_to_id": 920364637,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "iirc, i copied this from other tests which use `CreateTransaction`. personally, i prefer it to just `-1` because it's more clear to me having a `NAME_CONSTANT`, but i don't have a super strong feelings about it ",
      "created_at": "2022-07-19T15:09:39Z",
      "updated_at": "2022-07-19T15:09:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r924625941",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/924625941"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": 35,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 36,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925471315",
      "pull_request_review_id": 1044787748,
      "id": 925471315,
      "node_id": "PRRC_kwDOABII5843KZJT",
      "diff_hunk": "@@ -379,20 +450,51 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n     return groups_out;\n }\n \n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n-                               const CoinSelectionParams& coin_selection_params)\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                               const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types)\n+{\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.legacy, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.P2SH_segwit, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32m, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+\n+    // If we can't fund the transaction from any individual OutputType, run coin selection\n+    // over all available coins, else pick the best solution from the results\n+    if (results.size() == 0) {\n+        if (allow_mixed_output_types) {\n+            if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.all(), coin_selection_params)}) {\n+                return result;\n+            }\n+        }\n+        return std::optional<SelectionResult>();",
      "path": "src/wallet/spend.cpp",
      "position": 141,
      "original_position": 141,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "in_reply_to_id": null,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit\r\n```suggestion\r\n        return std::nullopt;\r\n```",
      "created_at": "2022-07-20T11:02:34Z",
      "updated_at": "2022-07-20T11:20:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r925471315",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925471315"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 479,
      "original_line": 479,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925471360",
      "pull_request_review_id": 1044787748,
      "id": 925471360,
      "node_id": "PRRC_kwDOABII5843KZKA",
      "diff_hunk": "@@ -379,20 +450,51 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n     return groups_out;\n }\n \n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n-                               const CoinSelectionParams& coin_selection_params)\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                               const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types)\n+{\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.legacy, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.P2SH_segwit, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32m, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+\n+    // If we can't fund the transaction from any individual OutputType, run coin selection\n+    // over all available coins, else pick the best solution from the results\n+    if (results.size() == 0) {\n+        if (allow_mixed_output_types) {\n+            if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.all(), coin_selection_params)}) {\n+                return result;\n+            }\n+        }\n+        return std::optional<SelectionResult>();\n+    };\n+    std::optional<SelectionResult> result{*std::min_element(results.begin(), results.end())};\n+    return result;",
      "path": "src/wallet/spend.cpp",
      "position": 144,
      "original_position": 144,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "in_reply_to_id": null,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I understand this returns the SelectionResult with the least waste as std::min_element compares the elements with the `operator<`, but maybe add a comment to explicit this behavior?\r\n+nit\r\n```suggestion\r\n    // Find the best solution (lowest waste)\r\n    return std::make_optional(*std::min_element(results.begin(), results.end()));\r\n```",
      "created_at": "2022-07-20T11:02:37Z",
      "updated_at": "2022-07-20T11:20:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r925471360",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925471360"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": 481,
      "original_start_line": 481,
      "start_side": "RIGHT",
      "line": 482,
      "original_line": 482,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925484605",
      "pull_request_review_id": 1044787748,
      "id": 925484605,
      "node_id": "PRRC_kwDOABII5843KcY9",
      "diff_hunk": "@@ -0,0 +1,176 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different types of UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds. Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends three\n+random value payments which sum to 10BTC for each output type to Bob,\n+for a total of 40BTC in Bob's wallet.\n+\n+Bob then sends random valued payments back to Alice, some of which need\n+unconfirmed change, and we verify that none of these payments contain mixed\n+inputs. Finally, Bob sends the remainder of his funds, which requires mixing.\n+\n+The payment values are random, but chosen such that they sum up to a specified\n+total. This ensures we are not relying on specific values for the UTXOs,\n+but still know when to expect mixing due to the wallet being close to empty.\n+\n+\"\"\"\n+\n+import random\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+\n+ADDRESS_TYPES = [\n+    \"bech32m\",\n+    \"bech32\",\n+    \"p2sh-segwit\",\n+    \"legacy\",\n+]\n+\n+\n+def is_bech32_address(node, addr):\n+    \"\"\"Check if an address contains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return addr_info['desc'].startswith('wpkh(')\n+\n+\n+def is_bech32m_address(node, addr):\n+    \"\"\"Check if an address contains a bech32m output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return addr_info['desc'].startswith('tr(')\n+\n+\n+def is_p2sh_segwit_address(node, addr):\n+    \"\"\"Check if an address contains a P2SH-Segwit output.\n+       Note: this function does not actually determine the type\n+       of P2SH output, but is sufficient for this test in that\n+       we are only generating P2SH-Segwit outputs.\n+    \"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return addr_info['desc'].startswith('sh(wpkh(')\n+\n+\n+def is_legacy_address(node, addr):\n+    \"\"\"Check if an address contains a legacy output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return addr_info['desc'].startswith('pkh(')\n+\n+\n+def is_same_type(node, tx):\n+    \"\"\"Check that all inputs are of the same OutputType\"\"\"\n+    vins = node.getrawtransaction(tx, True)['vin']\n+    inputs = []\n+    for vin in vins:\n+        prev_tx, n = vin['txid'], vin['vout']\n+        inputs.append(\n+            node.getrawtransaction(\n+                prev_tx,\n+                True,\n+            )['vout'][n]['scriptPubKey']['address']\n+        )\n+    has_legacy = False\n+    has_p2sh = False\n+    has_bech32 = False\n+    has_bech32m = False\n+\n+    for addr in inputs:\n+        if is_legacy_address(node, addr):\n+            has_legacy = True\n+        if is_p2sh_segwit_address(node, addr):\n+            has_p2sh = True\n+        if is_bech32_address(node, addr):\n+            has_bech32 = True\n+        if is_bech32m_address(node, addr):\n+            has_bech32m = True\n+\n+    return (sum([has_legacy, has_p2sh, has_bech32, has_bech32m]) == 1)\n+\n+\n+def generate_payment_values(n, m):\n+    \"\"\"Return a randomly chosen list of n positive integers summing to m.\n+    Each such list is equally likely to occur.\"\"\"\n+\n+    dividers = sorted(random.sample(range(1, m), n - 1))\n+    return [a - b for a, b in zip(dividers + [m], [0] + dividers)]\n+\n+\n+class AddressInputTypeGrouping(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 2\n+        self.extra_args = [\n+            [\n+                \"-addresstype=bech32\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+            [\n+                \"-addresstype=p2sh-segwit\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+        ]\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": 126,
      "original_position": 126,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "in_reply_to_id": null,
      "user": {
        "login": "aureleoules",
        "id": 22493292,
        "node_id": "MDQ6VXNlcjIyNDkzMjky",
        "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aureleoules",
        "html_url": "https://github.com/aureleoules",
        "followers_url": "https://api.github.com/users/aureleoules/followers",
        "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
        "organizations_url": "https://api.github.com/users/aureleoules/orgs",
        "repos_url": "https://api.github.com/users/aureleoules/repos",
        "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/aureleoules/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "maybe skip the test if not running with descriptors as well?",
      "created_at": "2022-07-20T11:19:11Z",
      "updated_at": "2022-07-20T11:20:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r925484605",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/925484605"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": 125,
      "original_start_line": 125,
      "start_side": "RIGHT",
      "line": 126,
      "original_line": 126,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/926571471",
      "pull_request_review_id": 1046381815,
      "id": 926571471,
      "node_id": "PRRC_kwDOABII5843OlvP",
      "diff_hunk": "@@ -379,20 +450,51 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n     return groups_out;\n }\n \n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n-                               const CoinSelectionParams& coin_selection_params)\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                               const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types)\n+{\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.legacy, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.P2SH_segwit, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32m, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+\n+    // If we can't fund the transaction from any individual OutputType, run coin selection\n+    // over all available coins, else pick the best solution from the results\n+    if (results.size() == 0) {\n+        if (allow_mixed_output_types) {\n+            if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.all(), coin_selection_params)}) {\n+                return result;\n+            }\n+        }\n+        return std::optional<SelectionResult>();",
      "path": "src/wallet/spend.cpp",
      "position": 141,
      "original_position": 141,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "in_reply_to_id": 925471315,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think I originally tried this and ran into strange behavior. Also, in other places an empty `SelectionResult` is returned as opposed to a nullopt. Going to leave this for now, but might be worth taking a second look at and perhaps using the newly created `BResult` class",
      "created_at": "2022-07-21T11:37:57Z",
      "updated_at": "2022-07-21T11:37:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r926571471",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/926571471"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 479,
      "original_line": 479,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/926571785",
      "pull_request_review_id": 1046382275,
      "id": 926571785,
      "node_id": "PRRC_kwDOABII5843Ol0J",
      "diff_hunk": "@@ -379,20 +450,51 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n     return groups_out;\n }\n \n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n-                               const CoinSelectionParams& coin_selection_params)\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                               const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types)\n+{\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.legacy, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.P2SH_segwit, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32m, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+\n+    // If we can't fund the transaction from any individual OutputType, run coin selection\n+    // over all available coins, else pick the best solution from the results\n+    if (results.size() == 0) {\n+        if (allow_mixed_output_types) {\n+            if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.all(), coin_selection_params)}) {\n+                return result;\n+            }\n+        }\n+        return std::optional<SelectionResult>();\n+    };\n+    std::optional<SelectionResult> result{*std::min_element(results.begin(), results.end())};\n+    return result;",
      "path": "src/wallet/spend.cpp",
      "position": 144,
      "original_position": 144,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "in_reply_to_id": 925471360,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "will add if I need to touch this file again",
      "created_at": "2022-07-21T11:38:23Z",
      "updated_at": "2022-07-21T11:38:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r926571785",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/926571785"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": 481,
      "original_start_line": 481,
      "start_side": "RIGHT",
      "line": 482,
      "original_line": 482,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/926574773",
      "pull_request_review_id": 1046386455,
      "id": 926574773,
      "node_id": "PRRC_kwDOABII5843Omi1",
      "diff_hunk": "@@ -0,0 +1,176 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test output type mixing during coin selection\n+\n+A wallet may have different types of UTXOs to choose from during coin selection,\n+where output type is one of the following:\n+    - BECH32M\n+    - BECH32\n+    - P2SH-SEGWIT\n+    - LEGACY\n+\n+This test verifies that mixing different output types is avoided unless\n+absolutely necessary. Both wallets start with zero funds. Alice mines\n+enough blocks to have spendable coinbase outputs. Alice sends three\n+random value payments which sum to 10BTC for each output type to Bob,\n+for a total of 40BTC in Bob's wallet.\n+\n+Bob then sends random valued payments back to Alice, some of which need\n+unconfirmed change, and we verify that none of these payments contain mixed\n+inputs. Finally, Bob sends the remainder of his funds, which requires mixing.\n+\n+The payment values are random, but chosen such that they sum up to a specified\n+total. This ensures we are not relying on specific values for the UTXOs,\n+but still know when to expect mixing due to the wallet being close to empty.\n+\n+\"\"\"\n+\n+import random\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.blocktools import COINBASE_MATURITY\n+\n+ADDRESS_TYPES = [\n+    \"bech32m\",\n+    \"bech32\",\n+    \"p2sh-segwit\",\n+    \"legacy\",\n+]\n+\n+\n+def is_bech32_address(node, addr):\n+    \"\"\"Check if an address contains a bech32 output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return addr_info['desc'].startswith('wpkh(')\n+\n+\n+def is_bech32m_address(node, addr):\n+    \"\"\"Check if an address contains a bech32m output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return addr_info['desc'].startswith('tr(')\n+\n+\n+def is_p2sh_segwit_address(node, addr):\n+    \"\"\"Check if an address contains a P2SH-Segwit output.\n+       Note: this function does not actually determine the type\n+       of P2SH output, but is sufficient for this test in that\n+       we are only generating P2SH-Segwit outputs.\n+    \"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return addr_info['desc'].startswith('sh(wpkh(')\n+\n+\n+def is_legacy_address(node, addr):\n+    \"\"\"Check if an address contains a legacy output.\"\"\"\n+    addr_info = node.getaddressinfo(addr)\n+    return addr_info['desc'].startswith('pkh(')\n+\n+\n+def is_same_type(node, tx):\n+    \"\"\"Check that all inputs are of the same OutputType\"\"\"\n+    vins = node.getrawtransaction(tx, True)['vin']\n+    inputs = []\n+    for vin in vins:\n+        prev_tx, n = vin['txid'], vin['vout']\n+        inputs.append(\n+            node.getrawtransaction(\n+                prev_tx,\n+                True,\n+            )['vout'][n]['scriptPubKey']['address']\n+        )\n+    has_legacy = False\n+    has_p2sh = False\n+    has_bech32 = False\n+    has_bech32m = False\n+\n+    for addr in inputs:\n+        if is_legacy_address(node, addr):\n+            has_legacy = True\n+        if is_p2sh_segwit_address(node, addr):\n+            has_p2sh = True\n+        if is_bech32_address(node, addr):\n+            has_bech32 = True\n+        if is_bech32m_address(node, addr):\n+            has_bech32m = True\n+\n+    return (sum([has_legacy, has_p2sh, has_bech32, has_bech32m]) == 1)\n+\n+\n+def generate_payment_values(n, m):\n+    \"\"\"Return a randomly chosen list of n positive integers summing to m.\n+    Each such list is equally likely to occur.\"\"\"\n+\n+    dividers = sorted(random.sample(range(1, m), n - 1))\n+    return [a - b for a, b in zip(dividers + [m], [0] + dividers)]\n+\n+\n+class AddressInputTypeGrouping(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 2\n+        self.extra_args = [\n+            [\n+                \"-addresstype=bech32\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+            [\n+                \"-addresstype=p2sh-segwit\",\n+                \"-whitelist=noban@127.0.0.1\",\n+                \"-txindex\",\n+            ],\n+        ]\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()",
      "path": "test/functional/wallet_avoid_mixing_output_types.py",
      "position": 126,
      "original_position": 126,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "in_reply_to_id": 925484605,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I _think_ `skip_if_no_sqlite()` is sufficient for this? will add if i need to touch the functional test file again",
      "created_at": "2022-07-21T11:42:06Z",
      "updated_at": "2022-07-21T11:42:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r926574773",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/926574773"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": 125,
      "original_start_line": 125,
      "start_side": "RIGHT",
      "line": 126,
      "original_line": 126,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/927043776",
      "pull_request_review_id": 1047056003,
      "id": 927043776,
      "node_id": "PRRC_kwDOABII5843QZDA",
      "diff_hunk": "@@ -379,20 +450,51 @@ std::vector<OutputGroup> GroupOutputs(const CWallet& wallet, const std::vector<C\n     return groups_out;\n }\n \n-std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, std::vector<COutput> coins,\n-                               const CoinSelectionParams& coin_selection_params)\n+std::optional<SelectionResult> AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const CoinEligibilityFilter& eligibility_filter, const CoinsResult& available_coins,\n+                               const CoinSelectionParams& coin_selection_params, bool allow_mixed_output_types)\n+{\n+    // Run coin selection on each OutputType and compute the Waste Metric\n+    std::vector<SelectionResult> results;\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.legacy, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.P2SH_segwit, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+    if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.bech32m, coin_selection_params)}) {\n+        results.push_back(*result);\n+    }\n+\n+    // If we can't fund the transaction from any individual OutputType, run coin selection\n+    // over all available coins, else pick the best solution from the results\n+    if (results.size() == 0) {\n+        if (allow_mixed_output_types) {\n+            if (auto result{ChooseSelectionResult(wallet, nTargetValue, eligibility_filter, available_coins.all(), coin_selection_params)}) {\n+                return result;\n+            }\n+        }\n+        return std::optional<SelectionResult>();",
      "path": "src/wallet/spend.cpp",
      "position": 141,
      "original_position": 141,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "in_reply_to_id": 925471315,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It shouldn't be a problem to return `std::nullopt`, but the current code is equivalent anyways. The default constructor for a `std::optional` is to make a nullopt object.",
      "created_at": "2022-07-21T19:43:15Z",
      "updated_at": "2022-07-21T19:43:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r927043776",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/927043776"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 479,
      "original_line": 479,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930344850",
      "pull_request_review_id": 1051520158,
      "id": 930344850,
      "node_id": "PRRC_kwDOABII5843c--S",
      "diff_hunk": "@@ -0,0 +1,105 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://www.opensource.org/licenses/mit-license.php.\n+\n+#include <validation.h>\n+#include <wallet/coincontrol.h>\n+#include <wallet/spend.h>\n+#include <wallet/test/util.h>\n+#include <wallet/test/wallet_test_fixture.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+namespace wallet {\n+BOOST_FIXTURE_TEST_SUITE(availablecoins_tests, WalletTestingSetup)\n+class AvailableCoinsTestingSetup : public TestChain100Setup\n+{\n+public:\n+    AvailableCoinsTestingSetup()\n+    {\n+        CreateAndProcessBlock({}, {});\n+        wallet = CreateSyncedWallet(*m_node.chain, m_node.chainman->ActiveChain(), m_args, coinbaseKey);\n+    }\n+\n+    ~AvailableCoinsTestingSetup()\n+    {\n+        wallet.reset();\n+    }\n+    CWalletTx& AddTx(CRecipient recipient)\n+    {\n+        CTransactionRef tx;\n+        CCoinControl dummy;\n+        {\n+            constexpr int RANDOM_CHANGE_POSITION = -1;\n+            auto res = CreateTransaction(*wallet, {recipient}, RANDOM_CHANGE_POSITION, dummy);\n+            BOOST_CHECK(res);\n+            tx = res.GetObj().tx;\n+        }\n+        wallet->CommitTransaction(tx, {}, {});\n+        CMutableTransaction blocktx;\n+        {\n+            LOCK(wallet->cs_wallet);\n+            blocktx = CMutableTransaction(*wallet->mapWallet.at(tx->GetHash()).tx);\n+        }\n+        CreateAndProcessBlock({CMutableTransaction(blocktx)}, GetScriptForRawPubKey(coinbaseKey.GetPubKey()));\n+\n+        LOCK(wallet->cs_wallet);\n+        wallet->SetLastBlockProcessed(wallet->GetLastBlockHeight() + 1, m_node.chainman->ActiveChain().Tip()->GetBlockHash());\n+        auto it = wallet->mapWallet.find(tx->GetHash());\n+        BOOST_CHECK(it != wallet->mapWallet.end());\n+        it->second.m_state = TxStateConfirmed{m_node.chainman->ActiveChain().Tip()->GetBlockHash(), m_node.chainman->ActiveChain().Height(), /*index=*/1};\n+        return it->second;\n+    }\n+\n+    std::unique_ptr<CWallet> wallet;\n+};\n+\n+BOOST_FIXTURE_TEST_CASE(BasicOutputTypesTest, AvailableCoinsTestingSetup)\n+{\n+    CoinsResult available_coins;\n+    BResult<CTxDestination> dest;\n+    LOCK(wallet->cs_wallet);\n+\n+    // Verify our wallet has one usable coinbase UTXO before starting\n+    // This UTXO is a P2PK, so it should show up in the Other bucket\n+    available_coins = AvailableCoins(*wallet);\n+    BOOST_CHECK_EQUAL(available_coins.size(), 1U);\n+    BOOST_CHECK_EQUAL(available_coins.other.size(), 1U);\n+\n+    // We will create a self transfer for each of the OutputTypes and\n+    // verify it is put in the correct bucket after running GetAvailablecoins\n+    //\n+    // For each OutputType, We expect 2 UTXOs in our wallet following the self transfer:\n+    //   1. One UTXO as the recipient\n+    //   2. One UTXO from the change, due to payment address matching logic\n+\n+    // Bech32m\n+    dest = wallet->GetNewDestination(OutputType::BECH32M, \"\");\n+    BOOST_ASSERT(dest.HasRes());\n+    AddTx(CRecipient{{GetScriptForDestination(dest.GetObj())}, 1 * COIN, /*fSubtractFeeFromAmount=*/true});\n+    available_coins = AvailableCoins(*wallet);\n+    BOOST_CHECK_EQUAL(available_coins.bech32m.size(), 2U);\n+\n+    // Bech32\n+    dest = wallet->GetNewDestination(OutputType::BECH32, \"\");\n+    BOOST_ASSERT(dest.HasRes());\n+    AddTx(CRecipient{{GetScriptForDestination(dest.GetObj())}, 2 * COIN, /*fSubtractFeeFromAmount=*/true});\n+    available_coins = AvailableCoins(*wallet);\n+    BOOST_CHECK_EQUAL(available_coins.bech32.size(), 2U);\n+\n+    // P2SH-SEGWIT\n+    dest = wallet->GetNewDestination(OutputType::P2SH_SEGWIT, \"\");",
      "path": "src/wallet/test/availablecoins_tests.cpp",
      "position": 91,
      "original_position": 91,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit:\r\n```suggestion\r\n    dest = wallet->GetNewDestination(OutputType::P2SH_SEGWIT, \"\");\r\n    BOOST_ASSERT(dest.HasRes());\r\n```",
      "created_at": "2022-07-26T19:37:26Z",
      "updated_at": "2022-07-26T19:42:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r930344850",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/930344850"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 91,
      "original_line": 91,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932666302",
      "pull_request_review_id": 1054745390,
      "id": 932666302,
      "node_id": "PRRC_kwDOABII5843l1u-",
      "diff_hunk": "@@ -79,6 +79,32 @@ TxSize CalculateMaximumSignedTxSize(const CTransaction &tx, const CWallet *walle\n     return CalculateMaximumSignedTxSize(tx, wallet, txouts, coin_control);\n }\n \n+uint64_t CoinsResult::size() const",
      "path": "src/wallet/spend.cpp",
      "position": 4,
      "original_position": 4,
      "commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "original_commit_id": "71d1d13627ccd27319f347e2d8167c8fe8a433f4",
      "in_reply_to_id": null,
      "user": {
        "login": "LarryRuane",
        "id": 8321330,
        "node_id": "MDQ6VXNlcjgzMjEzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8321330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LarryRuane",
        "html_url": "https://github.com/LarryRuane",
        "followers_url": "https://api.github.com/users/LarryRuane/followers",
        "following_url": "https://api.github.com/users/LarryRuane/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/LarryRuane/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/LarryRuane/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/LarryRuane/subscriptions",
        "organizations_url": "https://api.github.com/users/LarryRuane/orgs",
        "repos_url": "https://api.github.com/users/LarryRuane/repos",
        "events_url": "https://api.github.com/users/LarryRuane/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/LarryRuane/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "commit 2e67291ca3ab2d8f498fa910738ca655fde11c5e refactor: store by OutputType in CoinsResult\r\nnit\r\n```suggestion\r\nsize_t CoinsResult::size() const\r\n```",
      "created_at": "2022-07-28T21:00:46Z",
      "updated_at": "2022-07-28T21:44:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24584#discussion_r932666302",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/932666302"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24584"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 82,
      "original_line": 82,
      "side": "RIGHT"
    }
  ]
}