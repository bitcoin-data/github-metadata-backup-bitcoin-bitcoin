{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34628",
    "id": 3305951143,
    "node_id": "PR_kwDOABII587FDM-n",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/34628",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/34628.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/34628.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34628",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34628/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34628/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34628/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/a3d3fe3eb56f83a664d36b9ec3511237f5cfdd10",
    "number": 34628,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "p2p: Replace per-peer transaction rate-limiting with global rate limits",
    "user": {
      "login": "ajtowns",
      "id": 127186,
      "node_id": "MDQ6VXNlcjEyNzE4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajtowns",
      "html_url": "https://github.com/ajtowns",
      "followers_url": "https://api.github.com/users/ajtowns/followers",
      "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
      "organizations_url": "https://api.github.com/users/ajtowns/orgs",
      "repos_url": "https://api.github.com/users/ajtowns/repos",
      "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/ajtowns/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "Per-peer `m_tx_inventory_to_send` queues have CPU and memory costs that scale with both queue size and peer count. Under high transaction volume, this has previously caused severe issues ([May 2023 disclosure][1]) and still can cause measurable delays ([Feb 2026 Runestone surge][2], with the msghand thread observed hitting 100% CPU and queue memory reaching ~95MB).\r\n\r\nThis PR replaces the per-peer rate limiting with a global queue using dual token buckets (limiting transaction by both count and serialized size). Transactions that arrive within the bucket capacity still relay nearly immediately, but excess transactions queue in a global backlog and drain as the token buckets refill.\r\n\r\nKey parameters:\r\n  - Count bucket: 14 tx/s, 420 capacity (30s buffer)\r\n  - Size bucket: 20 kB/s (~12 MB/600s), 50 MB capacity\r\n  - Outbound peers refill faster by a factor of 2.5\r\n  \r\nPer-peer queues are retained solely for privacy batching and are always fully emptied, removing the old `INVENTORY_BROADCAST_MAX` cap.\r\n\r\nThis reduces the memory and CPU burden during transaction spikes when the queuing logic is engaged from O(queue * peers) to O(queue), as the queued transactions no longer need to be retained per-peer or re-sorted per-peer.\r\n\r\nDesign discussion: https://gist.github.com/ajtowns/d61bea974a07190fa6c6c8eaef3638b9\r\n\r\n[1]: https://bitcoincore.org/en/2024/10/08/disclose-large-inv-to-send/\r\n[2]: https://bnoc.xyz/t/increased-b-msghand-thread-utilization-due-to-runestone-transactions-on-2026-02-17/81\r\n",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "created_at": "2026-02-20T03:09:59Z",
    "updated_at": "2026-02-20T03:11:37Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "e695f943245c20bf9f3a1f0f6c7267469fca6323",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "ajtowns:202602-mempool-invtosend",
      "ref": "202602-mempool-invtosend",
      "sha": "a3d3fe3eb56f83a664d36b9ec3511237f5cfdd10",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 53941525,
        "node_id": "MDEwOlJlcG9zaXRvcnk1Mzk0MTUyNQ==",
        "name": "bitcoin",
        "full_name": "ajtowns/bitcoin",
        "owner": {
          "login": "ajtowns",
          "id": 127186,
          "node_id": "MDQ6VXNlcjEyNzE4Ng==",
          "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/ajtowns",
          "html_url": "https://github.com/ajtowns",
          "followers_url": "https://api.github.com/users/ajtowns/followers",
          "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
          "organizations_url": "https://api.github.com/users/ajtowns/orgs",
          "repos_url": "https://api.github.com/users/ajtowns/repos",
          "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/ajtowns/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/ajtowns/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/ajtowns/bitcoin",
        "archive_url": "https://api.github.com/repos/ajtowns/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/ajtowns/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/ajtowns/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/ajtowns/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/ajtowns/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/ajtowns/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/ajtowns/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/ajtowns/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/ajtowns/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/ajtowns/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/ajtowns/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/ajtowns/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/ajtowns/bitcoin/events",
        "forks_url": "https://api.github.com/repos/ajtowns/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/ajtowns/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/ajtowns/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/ajtowns/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/ajtowns/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/ajtowns/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/ajtowns/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/ajtowns/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/ajtowns/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/ajtowns/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/ajtowns/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/ajtowns/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/ajtowns/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/ajtowns/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/ajtowns/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/ajtowns/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:ajtowns/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/ajtowns/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/ajtowns/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/ajtowns/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/ajtowns/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/ajtowns/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/ajtowns/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/ajtowns/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/ajtowns/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/ajtowns/bitcoin/hooks",
        "svn_url": "https://github.com/ajtowns/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 3,
        "stargazers_count": 9,
        "watchers_count": 9,
        "size": 336286,
        "default_branch": "master",
        "open_issues_count": 2,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-02-20T02:59:01Z",
        "created_at": "2016-03-15T12:11:24Z",
        "updated_at": "2026-01-07T21:24:49Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "96bec216ec34bbfa3c07e8dad7768d877ba6919b",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38919,
        "stargazers_count": 88190,
        "watchers_count": 88190,
        "size": 305323,
        "default_branch": "master",
        "open_issues_count": 719,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-02-20T03:10:51Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2026-02-20T03:26:44Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34628"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 655,
    "deletions": 104,
    "changed_files": 13,
    "commits": 10,
    "review_comments": 0,
    "comments": 1
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDdhZmE3OTNmNWE1YmIxYTc0Yjk0ZDg0MjczYzNkMTg4NDg2ZDA4MGQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7afa793f5a5bb1a74b94d84273c3d188486d080d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7afa793f5a5bb1a74b94d84273c3d188486d080d",
      "tree": {
        "sha": "ed50eaf53f0ac75baad0c09203e821b5719ee32a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ed50eaf53f0ac75baad0c09203e821b5719ee32a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/96bec216ec34bbfa3c07e8dad7768d877ba6919b",
          "sha": "96bec216ec34bbfa3c07e8dad7768d877ba6919b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/96bec216ec34bbfa3c07e8dad7768d877ba6919b"
        }
      ],
      "message": "net_processing: Pass full tx to InitiateTxBroadcastToAll()\n\nAll callers already have the full transaction available, so just pass that\nthrough. This matches the signature for InitiateTxBroadcastPrivate()\nand prepares for a later commit that needs the full transaction to\ncompute its serialized size for rate limiting.",
      "committer": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-20T02:09:53Z"
      },
      "author": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-19T09:42:40Z"
      },
      "sha": "7afa793f5a5bb1a74b94d84273c3d188486d080d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc3YjBlNGMyOTlhMWU5NmFjZDYzMmMzNWMzYWUxNjE5MjJmNGRlMGM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/77b0e4c299a1e96acd632c35c3ae161922f4de0c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/77b0e4c299a1e96acd632c35c3ae161922f4de0c",
      "tree": {
        "sha": "5046ada63d2f34dc0723ba9c7424bd244fc1a34d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5046ada63d2f34dc0723ba9c7424bd244fc1a34d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7afa793f5a5bb1a74b94d84273c3d188486d080d",
          "sha": "7afa793f5a5bb1a74b94d84273c3d188486d080d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7afa793f5a5bb1a74b94d84273c3d188486d080d"
        }
      ],
      "message": "net_processing: Remove per-peer rate-limiting\n\nPer-peer rate limiting introduces storage and compute costs proportional\nto the number of peers. This has caused severe bugs in the past, and\ncontinues to be a risk in the event of periods of extremely high rates\nof transaction submission. Avoid these problems by always completely\nemptying the m_tx_inventory_to_send queue when processing it.\n\nNote that this increases the potential size of INV messages we send\nfor normal tx relay from ~1000 (limited by INVENTORY_BROADCAST_MAX)\nto potentially 50000 (limited by MAX_INV_SZ).",
      "committer": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-20T02:42:54Z"
      },
      "author": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-19T10:44:42Z"
      },
      "sha": "77b0e4c299a1e96acd632c35c3ae161922f4de0c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGFjMDMzOWNmM2Y1NDc1NmQ3YWE0OTVkNThhMDRiOGRlMmE4OGQ2NWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ac0339cf3f54756d7aa495d58a04b8de2a88d65d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ac0339cf3f54756d7aa495d58a04b8de2a88d65d",
      "tree": {
        "sha": "067bac8989ff70d530aa9a4e14e083f7842f8635",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/067bac8989ff70d530aa9a4e14e083f7842f8635"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/77b0e4c299a1e96acd632c35c3ae161922f4de0c",
          "sha": "77b0e4c299a1e96acd632c35c3ae161922f4de0c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/77b0e4c299a1e96acd632c35c3ae161922f4de0c"
        }
      ],
      "message": "txmempool: Add SortMiningScoreWithTopology\n\nAdd a method for sorting a batch of transactions (specified as a vector\nof wtxids) per mempool order, designed for transaction relay.",
      "committer": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-20T02:43:57Z"
      },
      "author": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-19T09:36:25Z"
      },
      "sha": "ac0339cf3f54756d7aa495d58a04b8de2a88d65d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGI3NTQ1YzY3NDg5MWRmMmMxMWNhMGZmZDc5Y2QzOWM5NWUzZjI1NWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b7545c674891df2c11ca0ffd79cd39c95e3f255a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b7545c674891df2c11ca0ffd79cd39c95e3f255a",
      "tree": {
        "sha": "bce34ad78e25708b1f6753664fa6db4331775b45",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bce34ad78e25708b1f6753664fa6db4331775b45"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ac0339cf3f54756d7aa495d58a04b8de2a88d65d",
          "sha": "ac0339cf3f54756d7aa495d58a04b8de2a88d65d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ac0339cf3f54756d7aa495d58a04b8de2a88d65d"
        }
      ],
      "message": "net_processing: Change m_tx_inventory_to_send from set to vector\n\nChange the per-peer tx relay queue from std::set to std::vector. This\nreduces the memory usage and improves locality, at the cost of not\nautomatically deduping entries.",
      "committer": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-20T02:43:57Z"
      },
      "author": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-19T11:04:13Z"
      },
      "sha": "b7545c674891df2c11ca0ffd79cd39c95e3f255a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDM5NzcxMGVhOWNmOTFmYTJjMGRmYjljZmU4MTZlOGQzMzZjNGY5MmM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/397710ea9cf91fa2c0dfb9cfe816e8d336c4f92c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/397710ea9cf91fa2c0dfb9cfe816e8d336c4f92c",
      "tree": {
        "sha": "858fb3d7bd634899f4e91d199bc7d3472704a9b0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/858fb3d7bd634899f4e91d199bc7d3472704a9b0"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b7545c674891df2c11ca0ffd79cd39c95e3f255a",
          "sha": "b7545c674891df2c11ca0ffd79cd39c95e3f255a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b7545c674891df2c11ca0ffd79cd39c95e3f255a"
        }
      ],
      "message": "txmempool: Drop CompareMiningScoreWithTopology\n\nNow unused; replaced by SortMiningScoreWithTopology.",
      "committer": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-20T02:43:57Z"
      },
      "author": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-19T11:07:10Z"
      },
      "sha": "397710ea9cf91fa2c0dfb9cfe816e8d336c4f92c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGVmYTYyNDcyNjdhNTJjMjQ2ZjU5NjhhNmZlMGIxMTBlMmU1MjdhNWU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/efa6247267a52c246f5968a6fe0b110e2e527a5e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/efa6247267a52c246f5968a6fe0b110e2e527a5e",
      "tree": {
        "sha": "fd34a14ac524840f4cd2e3ab005cba7d4b32acbe",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fd34a14ac524840f4cd2e3ab005cba7d4b32acbe"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/397710ea9cf91fa2c0dfb9cfe816e8d336c4f92c",
          "sha": "397710ea9cf91fa2c0dfb9cfe816e8d336c4f92c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/397710ea9cf91fa2c0dfb9cfe816e8d336c4f92c"
        }
      ],
      "message": "util/tokenbucket.h: Provide a generic TokenBucket class\n\nThis is a simple token bucket parameterized on clock type, used in the\nfollowing commit.",
      "committer": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-20T02:43:57Z"
      },
      "author": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-19T09:35:50Z"
      },
      "sha": "efa6247267a52c246f5968a6fe0b110e2e527a5e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDViNWIxMWI5ODAzNjI4MjdmNTkxNTRhZjBkNDE2NDU3NmIwMDVjMjA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5b5b11b980362827f59154af0d4164576b005c20",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5b5b11b980362827f59154af0d4164576b005c20",
      "tree": {
        "sha": "a71e84ca40dd031e2d3e9a84f19975ef99d24fba",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a71e84ca40dd031e2d3e9a84f19975ef99d24fba"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/efa6247267a52c246f5968a6fe0b110e2e527a5e",
          "sha": "efa6247267a52c246f5968a6fe0b110e2e527a5e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/efa6247267a52c246f5968a6fe0b110e2e527a5e"
        }
      ],
      "message": "net_processing: add a global delay queue for sending txs\n\nWithout the per-peer rate limiting, nodes can act as an amplifier for\ntransaction spam -- receiving many transactions from one node, but\nrelaying each of them to over 100 other nodes. Limit the impact of this\nby providing a global rate limit.\n\nThis is implemented using dual token buckets, one that consumes a\ntoken for every transaction, and one that consumes a token for every\nserialized byte. This rate limits both per-tx resource usage (eg INV\nmessages) and overall relay bandwidth.\n\nMain bucket parameters:\n * Count: 14tx/s rate, 420tx (30s) capacity\n * Size: 12MB/600s rate (4-6 blocks per target block interval), 50MB capacity\n\nThe size bucket is expected to be large enough to almost never have an\nimpact in normal usage, even during transaction storms, and is primarily\nintended to mitigate attack-like scenarios.\n\nOutbound connections get a separate pair of buckets, with rates boosted\nby a 2.5x multiplier.\n\nThis avoids the excessive memory and CPU usage due to the 100x multiplier\nfrom the queues being per-peer.\n\nNote that this also reduces the size of INV messages we send for general\ntx relay back to a more reasonable level of under 600 txs in 99.999%\nof cases.",
      "committer": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-20T02:43:57Z"
      },
      "author": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-19T11:13:59Z"
      },
      "sha": "5b5b11b980362827f59154af0d4164576b005c20"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDlmMDgxMjY2N2IyODhkNjkxNDA0NjVkOGUyYTY1YWYyM2E2ODdmNmI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9f0812667b288d69140465d8e2a65af23a687f6b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9f0812667b288d69140465d8e2a65af23a687f6b",
      "tree": {
        "sha": "2287a8b46e319de309d81cea2cde5f56d72717f1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2287a8b46e319de309d81cea2cde5f56d72717f1"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5b5b11b980362827f59154af0d4164576b005c20",
          "sha": "5b5b11b980362827f59154af0d4164576b005c20",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5b5b11b980362827f59154af0d4164576b005c20"
        }
      ],
      "message": "init: add -txsendrate configuration parameter\n\nAdds a debug-only configuration option to set the target\ntransaction/second rate for relay to inbound connections. This is mostly\nintended to be set to artificially low values to aid in testing behaviour\nwhen a backlog occurs, but is also available in case the default 14tx/s\ntarget is somehow too low in practice.",
      "committer": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-20T02:51:14Z"
      },
      "author": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-19T09:50:28Z"
      },
      "sha": "9f0812667b288d69140465d8e2a65af23a687f6b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGMwZTFjMDEyOWJmMzQ2ZjliYzViYzM0Mjk5Njk1YzA3MGEyZTIyMzY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c0e1c0129bf346f9bc5bc34299695c070a2e2236",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c0e1c0129bf346f9bc5bc34299695c070a2e2236",
      "tree": {
        "sha": "c82c42121bf26282c5dfb35ff2c48fcd632765ee",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c82c42121bf26282c5dfb35ff2c48fcd632765ee"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9f0812667b288d69140465d8e2a65af23a687f6b",
          "sha": "9f0812667b288d69140465d8e2a65af23a687f6b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9f0812667b288d69140465d8e2a65af23a687f6b"
        }
      ],
      "message": "rpc: report -txsendrate and bucket info via getnetworkinfo\n\nAdd `tx_send_rate` and `inv_buckets` fields to getnetworkinfo. The latter\nhas `inbound` and `outbound` entries, reporting reports backlog count,\ncount tokens, and size tokens. Useful for monitoring relay behavior.",
      "committer": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-20T02:51:14Z"
      },
      "author": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-19T10:13:52Z"
      },
      "sha": "c0e1c0129bf346f9bc5bc34299695c070a2e2236"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGEzZDNmZTNlYjU2ZjgzYTY2NGQzNmI5ZWMzNTExMjM3ZjVjZmRkMTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a3d3fe3eb56f83a664d36b9ec3511237f5cfdd10",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a3d3fe3eb56f83a664d36b9ec3511237f5cfdd10",
      "tree": {
        "sha": "3f0ff22497764afd27107c8aa4db647f003ce196",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3f0ff22497764afd27107c8aa4db647f003ce196"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c0e1c0129bf346f9bc5bc34299695c070a2e2236",
          "sha": "c0e1c0129bf346f9bc5bc34299695c070a2e2236",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c0e1c0129bf346f9bc5bc34299695c070a2e2236"
        }
      ],
      "message": "tests: basic functional test for tx rate limiting",
      "committer": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-20T02:51:14Z"
      },
      "author": {
        "name": "Anthony Towns",
        "email": "aj@erisian.com.au",
        "date": "2026-02-19T19:31:22Z"
      },
      "sha": "a3d3fe3eb56f83a664d36b9ec3511237f5cfdd10"
    },
    {
      "event": "labeled",
      "id": 22935967175,
      "node_id": "LE_lADOABII587saRv0zwAAAAVXFxXH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22935967175",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-20T03:10:02Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "commented",
      "id": 3931352714,
      "node_id": "IC_kwDOABII587qU66K",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3931352714",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-20T03:10:47Z",
      "updated_at": "2026-02-20T03:10:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (âœ¨ experimental)\n\n\n\nPossible places where named args for integral literals may be used (e.g. `func(x, /*named_arg=*/0)` in C++, and `func(x, named_arg=0)` in Python):\n\n- [std::clamp<int64_t>(*value, 1, 1000)] in src/node/peerman_args.cpp\n\n\n\n<sup>2026-02-20 03:10:47</sup>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34628#issuecomment-3931352714",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34628"
    }
  ],
  "comments": []
}