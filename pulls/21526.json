{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526",
    "id": 600020266,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NjAwMDIwMjY2",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21526",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/21526.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/21526.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
    "number": 21526,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "validation: UpdateTip/CheckBlockIndex assumeutxo support",
    "user": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is part of the [assumeutxo project](https://github.com/bitcoin/bitcoin/projects/11) (parent PR: #15606) \r\n\r\n---\r\n\r\nModify UpdateTip and CheckBlockIndex for use with multiple chainstates. Includes a new unittest verifying `g_best_block` behavior (previously untested at the unit level) and various changes necessary for running and testing `ProcessNewBlock()`-like behavior on the background validation chainstate.\r\n\r\nThis changeset introduces a new block index `nStatus` flag called `BLOCK_ASSUMED_VALID`, and it is applied to block index entries that are beneath the UTXO snapshot base block upon snapshot load. Once each block is validated (during async background validation), the flag is removed. This allows us to avoid (ab)using `BLOCK_VALID_*` flags for snapshot chain block entries, and preserves the original meaning of those flags.\r\n\r\nNote: this PR previously incorporated changes to `LoadBlockIndex()` and `RewindBlockIndex()` as noted in Russ' comments below, but once I generated the changes necessary to test the UpdateTip change, I decided to split this changes out into another PR due to the size of this one.",
    "labels": [
      {
        "id": 118379652,
        "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
        "name": "Validation",
        "color": "6060aa",
        "default": false
      }
    ],
    "created_at": "2021-03-24T19:39:48Z",
    "updated_at": "2022-10-30T19:10:10Z",
    "closed_at": "2021-09-23T20:22:36Z",
    "mergeable_state": "unknown",
    "merged_at": "2021-09-23T20:22:36Z",
    "merge_commit_sha": "b7e360081506cc646dd86f131df2d01f3c544f0e",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "jamesob:2021-03-multi-chainstates",
      "ref": "2021-03-multi-chainstates",
      "sha": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 42077031,
        "node_id": "MDEwOlJlcG9zaXRvcnk0MjA3NzAzMQ==",
        "name": "bitcoin",
        "full_name": "jamesob/bitcoin",
        "owner": {
          "login": "jamesob",
          "id": 73197,
          "node_id": "MDQ6VXNlcjczMTk3",
          "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/jamesob",
          "html_url": "https://github.com/jamesob",
          "followers_url": "https://api.github.com/users/jamesob/followers",
          "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
          "organizations_url": "https://api.github.com/users/jamesob/orgs",
          "repos_url": "https://api.github.com/users/jamesob/repos",
          "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/jamesob/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/jamesob/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/jamesob/bitcoin",
        "archive_url": "https://api.github.com/repos/jamesob/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/jamesob/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/jamesob/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/jamesob/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/jamesob/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/jamesob/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/jamesob/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/jamesob/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/jamesob/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/jamesob/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/jamesob/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/jamesob/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/jamesob/bitcoin/events",
        "forks_url": "https://api.github.com/repos/jamesob/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/jamesob/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/jamesob/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/jamesob/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/jamesob/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/jamesob/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/jamesob/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/jamesob/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/jamesob/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/jamesob/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/jamesob/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/jamesob/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/jamesob/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/jamesob/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/jamesob/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/jamesob/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:jamesob/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/jamesob/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/jamesob/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/jamesob/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/jamesob/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/jamesob/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/jamesob/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/jamesob/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/jamesob/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/jamesob/bitcoin/hooks",
        "svn_url": "https://github.com/jamesob/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 2,
        "stargazers_count": 4,
        "watchers_count": 4,
        "size": 252891,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-05-31T19:20:56Z",
        "created_at": "2015-09-07T22:18:03Z",
        "updated_at": "2023-05-05T06:31:51Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "2161a058552ac938f2079b311a2d12f5d1772d01",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34348,
        "stargazers_count": 69854,
        "watchers_count": 69854,
        "size": 234261,
        "default_branch": "master",
        "open_issues_count": 631,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-09T09:57:38Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-09T09:00:41Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 314,
    "deletions": 119,
    "changed_files": 10,
    "commits": 12,
    "review_comments": 110,
    "comments": 38
  },
  "events": [
    {
      "event": "labeled",
      "id": 4503996309,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ1MDM5OTYzMDk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4503996309",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-24T19:49:30Z",
      "label": {
        "name": "Validation",
        "color": "6060aa"
      }
    },
    {
      "event": "added_to_project",
      "id": 4504441039,
      "node_id": "MDE5OkFkZGVkVG9Qcm9qZWN0RXZlbnQ0NTA0NDQxMDM5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4504441039",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-24T21:04:26Z",
      "project_card": {
        "id": 57639324,
        "url": "https://api.github.com/projects/columns/cards/57639324",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Chasing Concept ACK"
      }
    },
    {
      "event": "moved_columns_in_project",
      "id": 4504442316,
      "node_id": "MDI2Ok1vdmVkQ29sdW1uc0luUHJvamVjdEV2ZW50NDUwNDQ0MjMxNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4504442316",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-24T21:04:38Z",
      "project_card": {
        "id": 57639324,
        "url": "https://api.github.com/projects/columns/cards/57639324",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Blockers",
        "previous_column_name": "Chasing Concept ACK"
      }
    },
    {
      "event": "commented",
      "id": 806201724,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgwNjIwMTcyNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/806201724",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-24T21:36:03Z",
      "updated_at": "2021-09-20T16:06:11Z",
      "author_association": "MEMBER",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#22937](https://github.com/bitcoin/bitcoin/pull/22937) (refactor: Forbid calling unsafe fs::path(std::string) constructor and fs::path::string() method by ryanofsky)\n* [#22932](https://github.com/bitcoin/bitcoin/pull/22932) (consensus: require CBlockIndex::GetBlockPos() to hold mutex cs_main by jonatack)\n* [#22564](https://github.com/bitcoin/bitcoin/pull/22564) ([WIP] refactor: Move mutable globals cleared in `::UnloadBlockIndex` to `BlockManager` by dongcarl)\n* [#21603](https://github.com/bitcoin/bitcoin/pull/21603) (log: Mitigate disk filling attacks by rate limiting LogPrintf by dergoegge)\n* [#19790](https://github.com/bitcoin/bitcoin/pull/19790) (Flag when blocks have had their scripts checked instead of skipped by luke-jr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-806201724",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "commented",
      "id": 809009595,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTAwOTU5NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/809009595",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-29T01:41:55Z",
      "updated_at": "2021-03-29T01:43:15Z",
      "author_association": "MEMBER",
      "body": "re: https://github.com/bitcoin/bitcoin/pull/21526#issue-600020266\r\n\r\n> * Don't run `UpdateTip` for background validation chainstates.\r\n\r\nDoes this prevent bugs in the future when there can be a background validation chainstate? It would help to say what would happen without this change. It could also be helpful to say more about the motivation for this set of changes, and maybe summarize the current state of things for forgetful people like me who somewhat lost the thread on assumeutxo :tropical_fish: \r\n\r\n> * Modify `LoadBlockIndex()` to populate the \"faked\" nChainTx value when using a yet-unvalidated snapshot chainstate. This allows assumeutxo sync-to-tip to offer normal progress estimates on the basis of having nChainTx without the associated block data.\r\n\r\nIIUC, the faking isn't new, and the value was faked before this change, but startup code is now fixed  so things work if the node is restarted before the assumeutxo snapshot is validated? Again could help to say what bad things would happen without this.\r\n\r\n> * In `LoadBlockIndex()`, ensure that assumed-valid CBlockIndex entries aren't added to the background validation chainstate's setBlockIndexCandidates (since we want that chainstate to actually validate those entries at some point).\r\n\r\nWondering also what bad things happen without this change, and why it's in the same commit as the last change. Is it just that both changes affect the `LoadBlockIndex()` function?\r\n\r\n> * Prevent `RewindBlockIndex()` from rewinding past the assumeutxo base on the snapshot chainstate.\r\n\r\nI'm a little confused by this code (also the existing pruning code here). It says the purpose of the break is to prevent the DisconnectTip call immediately below from failing. But don't we want to fail in these cases? It seems like now if rewind isn't possible, this just flushes some things and returns true. I'm also wondering if there's a reason this change is in the same commit as the other changes, which seem tangentially related.\r\n\r\nAlso, there's no test coverage here. Maybe is the best we can do when adding dead code to older functions that weren't really designed to be unit-tested. But are there at least future tests in #15606 that would fail without these different fixes?\r\n\r\nThanks for any clarifications, and great to see assumeutxo work moving along again!",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-809009595",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "commented",
      "id": 810351331,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxMDM1MTMzMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/810351331",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-30T15:22:47Z",
      "updated_at": "2021-03-30T15:23:06Z",
      "author_association": "MEMBER",
      "body": "@ryanofsky thanks for the thorough look! I agree that I should take a look at writing unittests for these changes and do so if practical. Also appreciate your questions on the logic - I'll get together some responses for those and either adjust the code (especially since `RewindBlockIndex()` is probably going away in #21009) or add some motivating documentation. ",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-810351331",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "mentioned",
      "id": 4528503297,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDUyODUwMzI5Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4528503297",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-30T15:22:47Z"
    },
    {
      "event": "subscribed",
      "id": 4528503300,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ1Mjg1MDMzMDA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4528503300",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-03-30T15:22:47Z"
    },
    {
      "event": "removed_from_project",
      "id": 4559860264,
      "node_id": "MDIzOlJlbW92ZWRGcm9tUHJvamVjdEV2ZW50NDU1OTg2MDI2NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4559860264",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-07T02:27:10Z",
      "project_card": {
        "id": 57639324,
        "url": "https://api.github.com/projects/columns/cards/57639324",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Blockers"
      }
    },
    {
      "event": "added_to_project",
      "id": 4559862321,
      "node_id": "MDE5OkFkZGVkVG9Qcm9qZWN0RXZlbnQ0NTU5ODYyMzIx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4559862321",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-07T02:28:03Z",
      "project_card": {
        "id": 57634819,
        "url": "https://api.github.com/projects/columns/cards/57634819",
        "project_id": 2564674,
        "project_url": "https://api.github.com/projects/2564674",
        "column_name": "In progress"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4569106843,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDU2OTEwNjg0Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4569106843",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-08T14:37:33Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4569110616,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDU2OTExMDYxNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4569110616",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-08T14:38:11Z"
    },
    {
      "event": "renamed",
      "id": 4569120772,
      "node_id": "MDE3OlJlbmFtZWRUaXRsZUV2ZW50NDU2OTEyMDc3Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4569120772",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-08T14:39:51Z",
      "rename": {
        "from": "validation: misc. multi-chainstate preparation",
        "to": "validation: UpdateTip/CheckBlockIndex assumeutxo support"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4569191976,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDU2OTE5MTk3Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4569191976",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-08T14:52:02Z"
    },
    {
      "event": "commented",
      "id": 815893602,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTg5MzYwMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/815893602",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-08T14:58:07Z",
      "updated_at": "2021-04-08T14:58:07Z",
      "author_association": "MEMBER",
      "body": "Okay, after taking @ryanofsky's advice, I sat down to write some unittests for the chainstate-dependent UpdateTip() behavior. It turns out that in the process, trying to get those tests to work uncovered a number of changes that needed to be made to other test-related stuff, including slightly modifying `CheckBlockIndex()` to account for the specific nature of the background validation chainstate. Additionally I've added some unittesting utils that help with testing multiple chainstates.\r\n\r\nBecause that's dragged in so much new code, I've narrowed the scope of this PR to the above and I'll deal with the other BlockIndex-related changes in a follow-up PR.\r\n\r\nSo all the logic changes in this are now tested (and this actually adds unit-level coverage of the `UpdateTip()` behvaior that we didn't have previously). So hopefully that entices people to review, because testing future assumeutxo-related changes will probably depend on some of the unittest utils added here.\r\n\r\nAlso worth mentioning is that I had to remove some of the active chainstate assertions that @dongcarl added for the sake of his work in #20158. This should all be okay because those assertions are actually made obsolete by assumeutxo functionality. ",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-815893602",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "mentioned",
      "id": 4569228068,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDU2OTIyODA2OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4569228068",
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-08T14:58:07Z"
    },
    {
      "event": "subscribed",
      "id": 4569228077,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ1NjkyMjgwNzc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4569228077",
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-08T14:58:07Z"
    },
    {
      "event": "mentioned",
      "id": 4569228083,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDU2OTIyODA4Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4569228083",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-08T14:58:08Z"
    },
    {
      "event": "subscribed",
      "id": 4569228091,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ1NjkyMjgwOTE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4569228091",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-08T14:58:08Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4583220466,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDU4MzIyMDQ2Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4583220466",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-12T16:20:48Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4584311636,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDU4NDMxMTYzNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4584311636",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-12T19:58:15Z"
    },
    {
      "event": "reviewed",
      "id": 636111729,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjM2MTExNzI5",
      "url": null,
      "actor": null,
      "commit_id": "3f1346a0178afef20db3599cc545dbc54200d635",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Started review (will update list below with progress). Thanks for splitting this up!\r\n- [X] b9f805b703c12a51192069144b1d7fe924988896 validation: change UpdateTip for multiple chainstates (1/6)\r\n- [x] d3cec2a5b3febd091b8002e39f8b7431b7e99c4a validation: fix CheckBlockIndex for multiple chainstates (2/6)\r\n- [x] 0fd884d46f49a63eeee61d56d7ef7634c02c1617 move-only: unittest: add test/util/chainstate.h (3/6)\r\n- [x] 6e5871c0c7b7d7b27b56df4f2c0705921025a6d5 test: refactor: separate CreateBlock in TestChain100Setup (4/6)\r\n- [x] d7fc5c342010028855634d7c87b473b5af4484a3 refactor: remove assertions preventing multiple chainstates (5/6)\r\n- [x] 3f1346a0178afef20db3599cc545dbc54200d635 test: validation: add unittest for UpdateTip behavior (6/6)\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-636111729",
      "submitted_at": "2021-04-14T21:54:29Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 637995324,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjM3OTk1MzI0",
      "url": null,
      "actor": null,
      "commit_id": "d3cec2a5b3febd091b8002e39f8b7431b7e99c4a",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK 3f1346a0178afef20db3599cc545dbc54200d635. This is great! Changes are small and easy to understand and new test is surprisingly straightforward, not requiring too much setup.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-637995324",
      "submitted_at": "2021-04-16T19:27:12Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "labeled",
      "id": 4608115877,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ2MDgxMTU4Nzc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4608115877",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-17T16:26:21Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4638193357,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDYzODE5MzM1Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4638193357",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-23T17:58:31Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4638338003,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDYzODMzODAwMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4638338003",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-23T18:36:27Z"
    },
    {
      "event": "commented",
      "id": 825847464,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgyNTg0NzQ2NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/825847464",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-23T18:38:14Z",
      "updated_at": "2021-04-23T18:38:14Z",
      "author_association": "MEMBER",
      "body": "Thanks for the great feedback, @ryanofsky!",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-825847464",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "mentioned",
      "id": 4638344462,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDYzODM0NDQ2Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4638344462",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-23T18:38:14Z"
    },
    {
      "event": "subscribed",
      "id": 4638344470,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ2MzgzNDQ0NzA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4638344470",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-23T18:38:14Z"
    },
    {
      "event": "unlabeled",
      "id": 4638638983,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50NDYzODYzODk4Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4638638983",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-04-23T19:59:50Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 831142104,
      "node_id": "MDEyOklzc3VlQ29tbWVudDgzMTE0MjEwNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/831142104",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-05-03T09:32:53Z",
      "updated_at": "2021-05-03T09:32:53Z",
      "author_association": "MEMBER",
      "body": "<!--4a62be1de6b64f3ed646cdc7932c8cf5-->\n @sipa has been requested to review this pull request as specified in the REVIEWERS file.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-831142104",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "mentioned",
      "id": 4677165436,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDY3NzE2NTQzNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4677165436",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-05-03T09:32:53Z"
    },
    {
      "event": "subscribed",
      "id": 4677165439,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ2NzcxNjU0Mzk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4677165439",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-05-03T09:32:53Z"
    },
    {
      "event": "reviewed",
      "id": 650813361,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjUwODEzMzYx",
      "url": null,
      "actor": null,
      "commit_id": "6d5d09634ac354c16c298c83d7b699b2147a98b3",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK eb9623d690e6f390a5f6a8b30763374b72aee282. Since last review just rebase and various suggestions applied, biggest one updating CheckBlockIndex in a different way where I think it does some more checks than the previous change and some fewer, but is now a simpler change. Overall this looks good and please ignore my new suggestion unless something needs to be updated for another reason.\r\n\r\nRecommend this PR for any reviewer looking for a simple review of some critical code. The first commit's the only code commit that's even a little complicated and the other commits are either test updates or trivial code changes.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-650813361",
      "submitted_at": "2021-05-04T00:30:58Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 652577266,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjUyNTc3MjY2",
      "url": null,
      "actor": null,
      "commit_id": "23c2d26d424e5a8b523f7210653958eff10db0f2",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Mostly happy with eb9623d690e6f390a5f6a8b30763374b72aee282, but I'm a bit confused about some code paths that I thought shouldn't be possible on the background chainstate.\r\n\r\nI'd like to do some testing with the parent PR, if you don't mind rebasing that.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-652577266",
      "submitted_at": "2021-05-05T18:18:19Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "commented",
      "id": 847354627,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg0NzM1NDYyNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/847354627",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-05-24T21:41:24Z",
      "updated_at": "2021-05-24T21:41:24Z",
      "author_association": "MEMBER",
      "body": "Would be good to see this PR move ahead. Has 2 ACKs. There are a few simple code changes, and most of the PR is adding tests. People interested in assumeutxo should take a look.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-847354627",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "commented",
      "id": 849428519,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg0OTQyODUxOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/849428519",
      "actor": {
        "login": "benthecarman",
        "id": 15256660,
        "node_id": "MDQ6VXNlcjE1MjU2NjYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benthecarman",
        "html_url": "https://github.com/benthecarman",
        "followers_url": "https://api.github.com/users/benthecarman/followers",
        "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
        "organizations_url": "https://api.github.com/users/benthecarman/orgs",
        "repos_url": "https://api.github.com/users/benthecarman/repos",
        "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benthecarman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-05-27T08:05:59Z",
      "updated_at": "2021-05-27T08:06:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "tACK eb9623d690e6f390a5f6a8b30763374b72aee282",
      "user": {
        "login": "benthecarman",
        "id": 15256660,
        "node_id": "MDQ6VXNlcjE1MjU2NjYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benthecarman",
        "html_url": "https://github.com/benthecarman",
        "followers_url": "https://api.github.com/users/benthecarman/followers",
        "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
        "organizations_url": "https://api.github.com/users/benthecarman/orgs",
        "repos_url": "https://api.github.com/users/benthecarman/repos",
        "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benthecarman/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-849428519",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "added_to_project",
      "id": 4807741587,
      "node_id": "MDE5OkFkZGVkVG9Qcm9qZWN0RXZlbnQ0ODA3NzQxNTg3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4807741587",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-05-27T19:07:40Z",
      "project_card": {
        "id": 61992625,
        "url": "https://api.github.com/projects/columns/cards/61992625",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Blockers"
      }
    },
    {
      "event": "labeled",
      "id": 4824978379,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ4MjQ5NzgzNzk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4824978379",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-01T12:10:21Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4871316662,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDg3MTMxNjY2Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4871316662",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-10T13:11:50Z"
    },
    {
      "event": "commented",
      "id": 858611266,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg1ODYxMTI2Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/858611266",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-10T13:13:15Z",
      "updated_at": "2021-06-10T13:13:15Z",
      "author_association": "MEMBER",
      "body": "Rebased to fix small conflict. \r\n[`au.multi-chainstates.pt1.8`](https://github.com/jamesob/bitcoin/tree/au.multi-chainstates.pt1.8) -> [`au.multi-chainstates.pt1.9`](https://github.com/jamesob/bitcoin/tree/au.multi-chainstates.pt1.9)\r\n\r\n<details><summary>Show range-diff</summary>\r\n\r\n```sh\r\n$ git range-diff master au.multi-chainstates.pt1.8 au.multi-chainstates.pt1.9\r\n\r\n1:  23c2d26d4 ! 1:  28f800ba6 validation: change UpdateTip for multiple chainstates\r\n    @@ -91,5 +91,5 @@\r\n      extern std::condition_variable g_best_block_cv;\r\n     +/** Used to notify getblocktemplate RPC of new tips. */\r\n      extern uint256 g_best_block;\r\n    - extern std::atomic_bool fImporting;\r\n    - extern std::atomic_bool fReindex;\r\n    + /** Whether there are dedicated script-checking threads running.\r\n    +  * False indicates all script checking is done on the main threadMessageHandler thread.\r\n2:  4600865b4 = 2:  ea5fe5a50 validation: fix CheckBlockIndex for multiple chainstates\r\n3:  5fa0b0437 = 3:  f049daf72 move-only: unittest: add test/util/chainstate.h\r\n4:  6d5d09634 ! 4:  87e872c5b test: refactor: separate CreateBlock in TestChain100Setup\r\n    @@ -26,11 +26,7 @@\r\n\r\n          Assert(block.vtx.size() == 1);\r\n          for (const CMutableTransaction& tx : txns) {\r\n    -         block.vtx.push_back(MakeTransactionRef(tx));\r\n    -     }\r\n    --    CBlockIndex* prev_block = WITH_LOCK(::cs_main, return g_chainman.m_blockman.LookupBlockIndex(block.hashPrevBlock));\r\n    -+    CBlockIndex* prev_block = WITH_LOCK(::cs_main, return chainstate->m_blockman.LookupBlockIndex(block.hashPrevBlock));\r\n    -     RegenerateCommitments(block, prev_block);\r\n    +@@\r\n\r\n          while (!CheckProofOfWork(block.GetHash(), block.nBits, chainparams.GetConsensus())) ++block.nNonce;\r\n\r\n5:  23b5ebd02 = 5:  fc73625bd refactor: remove assertions preventing multiple chainstates\r\n6:  eb9623d69 = 6:  adb0e5a67 test: validation: add unittest for UpdateTip behavior\r\n```\r\n\r\n</details>",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-858611266",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "unlabeled",
      "id": 4872102175,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50NDg3MjEwMjE3NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4872102175",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-10T15:13:45Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 4880823932,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQ4ODA4MjM5MzI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4880823932",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-12T04:41:55Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4891643929,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDg5MTY0MzkyOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4891643929",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-15T13:23:23Z"
    },
    {
      "event": "commented",
      "id": 861498058,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2MTQ5ODA1OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861498058",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-15T13:28:26Z",
      "updated_at": "2021-06-15T13:28:26Z",
      "author_association": "MEMBER",
      "body": "[`au.multi-chainstates.pt1.9`](https://github.com/jamesob/bitcoin/tree/au.multi-chainstates.pt1.9) -> [`au.multi-chainstates.pt1.10`](https://github.com/jamesob/bitcoin/tree/au.multi-chainstates.pt1.10)\r\n\r\nI've rebased on top of master (made necessary after the merge of #21866 :tada:). This branch now includes an additional commit (https://github.com/bitcoin/bitcoin/pull/21526/commits/acb5215743de11df5aef519260521e2b17c5b40d) necessitated by the fact that the chainstate manager is no longer a global; the commit attaches a chainman reference to each owned chainstate instance. The alternative would be to change a whole bunch of function signatures and thread a ChainstateManager argument deep through call stacks. I think this approach makes more sense.\r\n\r\n<details><summary>Show range-diff</summary>\r\n\r\n```sh\r\n$ git range-diff master au.multi-chainstates.pt1.9 au.multi-chainstates.pt1.10\r\n\r\n-:  ---------- > 1:  acb5215743 validation: add chainman ref to CChainState\r\n1:  28f800ba60 ! 2:  0589bf841f validation: change UpdateTip for multiple chainstates\r\n    @@ -44,7 +44,7 @@\r\n     +\r\n     +    // The contents of this function are either not relevant if we're not\r\n     +    // given the active chainstate, so return otherwise.\r\n    -+    if (&chainstate != &::g_chainman.ActiveChainstate()) {\r\n    ++    if (&chainstate != &chainstate.m_chainman.ActiveChainstate()) {\r\n     +        // Only log every so often so that we don't bury log messages at the tip.\r\n     +        constexpr int BACKGROUND_LOG_INTERVAL = 2000;\r\n     +        if (pindexNew->nHeight % BACKGROUND_LOG_INTERVAL == 0) {\r\n    @@ -60,7 +60,6 @@\r\n          }\r\n\r\n          bilingual_str warning_messages;\r\n    --    assert(std::addressof(::ChainstateActive()) == std::addressof(active_chainstate));\r\n     -    if (!active_chainstate.IsInitialBlockDownload()) {\r\n     +    if (!chainstate.IsInitialBlockDownload()) {\r\n              const CBlockIndex* pindex = pindexNew;\r\n    @@ -70,7 +69,6 @@\r\n                  }\r\n              }\r\n          }\r\n    --    assert(std::addressof(::ChainstateActive()) == std::addressof(active_chainstate));\r\n     -    LogPrintf(\"%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\", __func__,\r\n     -      pindexNew->GetBlockHash().ToString(), pindexNew->nHeight, pindexNew->nVersion,\r\n     -      log(pindexNew->nChainWork.getdouble())/log(2.0), (unsigned long)pindexNew->nChainTx,\r\n2:  ea5fe5a504 ! 3:  929de6413c validation: fix CheckBlockIndex for multiple chainstates\r\n    @@ -15,7 +15,7 @@\r\n\r\n          LOCK(cs_main);\r\n\r\n    -+    bool is_active_chain = this == &::g_chainman.ActiveChainstate();\r\n    ++    bool is_active_chain = this == &m_chainman.ActiveChainstate();\r\n     +\r\n          // During a reindex, we read the genesis block and call CheckBlockIndex before ActivateBestChain,\r\n          // so we have the genesis block in m_blockman.m_block_index but no active chain. (A few of the\r\n3:  f049daf72a = 4:  3a6899f468 move-only: unittest: add test/util/chainstate.h\r\n4:  87e872c5b2 ! 5:  b6ddc34706 test: refactor: separate CreateBlock in TestChain100Setup\r\n    @@ -21,7 +21,7 @@\r\n      {\r\n          const CChainParams& chainparams = Params();\r\n          CTxMemPool empty_pool;\r\n    --    CBlock block = BlockAssembler(::ChainstateActive(), empty_pool, chainparams).CreateNewBlock(scriptPubKey)->block;\r\n    +-    CBlock block = BlockAssembler(m_node.chainman->ActiveChainstate(), empty_pool, chainparams).CreateNewBlock(scriptPubKey)->block;\r\n     +    CBlock block = BlockAssembler(*chainstate, empty_pool, chainparams).CreateNewBlock(scriptPubKey)->block;\r\n\r\n          Assert(block.vtx.size() == 1);\r\n5:  fc73625bd3 < -:  ---------- refactor: remove assertions preventing multiple chainstates\r\n6:  adb0e5a67e = 6:  f14c68ac6d test: validation: add unittest for UpdateTip behavior\r\n```\r\n\r\n</details>",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-861498058",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "unlabeled",
      "id": 4891775002,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50NDg5MTc3NTAwMg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4891775002",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-15T13:43:56Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4892572521,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDg5MjU3MjUyMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4892572521",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-15T15:47:37Z"
    },
    {
      "event": "reviewed",
      "id": 685590488,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Njg1NTkwNDg4",
      "url": null,
      "actor": null,
      "commit_id": "ede45e2036891fda851fe8c4e8363e5602c7ef08",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK ede45e2036891fda851fe8c4e8363e5602c7ef08. No changes since last review other than rebase and new commit e5e1d49ccf390bca49f66a0650c84c7c51f3af04 giving `CChainState` objects a reference back to `ChainstateManager`. This seems reasonable and preferable to the alternative of adding `ChainstateManager&` parameters to `UpdateTip()` and `CChainState::CheckBlockIndex()` and functions and all the functions calling these functions.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-685590488",
      "submitted_at": "2021-06-16T19:52:20Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4906675952,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDkwNjY3NTk1Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4906675952",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-17T21:28:18Z"
    },
    {
      "event": "commented",
      "id": 863579751,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2MzU3OTc1MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/863579751",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-17T21:34:51Z",
      "updated_at": "2021-06-17T21:34:51Z",
      "author_association": "MEMBER",
      "body": "\r\n[`au.multi-chainstates.pt1.11`](https://github.com/jamesob/bitcoin/tree/au.multi-chainstates.pt1.11) -> [`au.multi-chainstates.pt1.12`](https://github.com/jamesob/bitcoin/tree/au.multi-chainstates.pt1.12)\r\n\r\nThe functional test I recently added in the parent branch (https://github.com/bitcoin/bitcoin/pull/15606/commits/aa65b21d79d9cc0d79925879bc62e1c240a1cf59) has uncovered some cases I hadn't previously considered in `CheckBlockIndex()`, so I've pushed fixes for those, as well as some corequisite ChainstateManager methods for easily getting the snapshot height.\r\n\r\n<details><summary>Show range-diff</summary>\r\n\r\n```sh\r\n$ git range-diff master au.multi-chainstates.pt1.11 au.multi-chainstates.pt1.12\r\n\r\n1:  e5e1d49cc = 1:  e5e1d49cc validation: add chainman ref to CChainState\r\n2:  4a836f708 = 2:  4cf9de9d7 validation: change UpdateTip for multiple chainstates\r\n3:  7377caacd ! 3:  7ff4c234e validation: fix CheckBlockIndex for multiple chainstates\r\n    @@ -16,6 +16,7 @@\r\n          LOCK(cs_main);\r\n\r\n     +    bool is_active_chain = this == &m_chainman.ActiveChainstate();\r\n    ++    int snapshot_height = m_chainman.GetSnapshotHeight().value_or(-1);\r\n     +\r\n          // During a reindex, we read the genesis block and call CheckBlockIndex before ActivateBestChain,\r\n          // so we have the genesis block in m_blockman.m_block_index but no active chain. (A few of the\r\n    @@ -28,6 +29,29 @@\r\n          for (const std::pair<const uint256, CBlockIndex*>& entry : m_blockman.m_block_index) {\r\n              forward.insert(std::make_pair(entry.second->pprev, entry.second));\r\n          }\r\n    +@@\r\n    +     while (pindex != nullptr) {\r\n    +         nNodes++;\r\n    +         if (pindexFirstInvalid == nullptr && pindex->nStatus & BLOCK_FAILED_VALID) pindexFirstInvalid = pindex;\r\n    +-        if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\r\n    +-        if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\r\n    ++        // Don't start being rigorous about missing block data if we're within a utxo snapshot\r\n    ++        if (pindex->nHeight > snapshot_height) {\r\n    ++            if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\r\n    ++            if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\r\n    ++        }\r\n    +         if (pindex->pprev != nullptr && pindexFirstNotTreeValid == nullptr && (pindex->nStatus & BLOCK_VALID_MASK) < BLOCK_VALID_TREE) pindexFirstNotTreeValid = pindex;\r\n    +         if (pindex->pprev != nullptr && pindexFirstNotTransactionsValid == nullptr && (pindex->nStatus & BLOCK_VALID_MASK) < BLOCK_VALID_TRANSACTIONS) pindexFirstNotTransactionsValid = pindex;\r\n    +         if (pindex->pprev != nullptr && pindexFirstNotChainValid == nullptr && (pindex->nStatus & BLOCK_VALID_MASK) < BLOCK_VALID_CHAIN) pindexFirstNotChainValid = pindex;\r\n    +@@\r\n    +         if (!pindex->HaveTxsDownloaded()) assert(pindex->nSequenceId <= 0); // nSequenceId can't be set positive for blocks that aren't linked (negative is used for preciousblock)\r\n    +         // VALID_TRANSACTIONS is equivalent to nTx > 0 for all nodes (whether or not pruning has occurred).\r\n    +         // HAVE_DATA is only equivalent to nTx > 0 (or VALID_TRANSACTIONS) if no pruning has occurred.\r\n    +-        if (!fHavePruned) {\r\n    ++        if (!fHavePruned && (pindex->nHeight > snapshot_height)) {\r\n    +             // If we've never pruned, then HAVE_DATA should be equivalent to nTx > 0\r\n    +             assert(!(pindex->nStatus & BLOCK_HAVE_DATA) == (pindex->nTx == 0));\r\n    +             assert(pindexFirstMissing == pindexFirstNeverProcessed);\r\n     @@\r\n                      // is valid and we have all data for its parents, it must be in\r\n                      // setBlockIndexCandidates.  m_chain.Tip() must also be there\r\n    @@ -53,3 +77,52 @@\r\n              }\r\n              // Check whether this block is in m_blocks_unlinked.\r\n              std::pair<std::multimap<CBlockIndex*,CBlockIndex*>::iterator,std::multimap<CBlockIndex*,CBlockIndex*>::iterator> rangeUnlinked = m_blockman.m_blocks_unlinked.equal_range(pindex->pprev);\r\n    +@@\r\n    +         // Fake nChainTx so that GuessVerificationProgress reports accurately\r\n    +         index->nChainTx = index->pprev ? index->pprev->nChainTx + index->nTx : 1;\r\n    +\r\n    ++        // Since this block is assumed-valid, set nStatus accordingly.\r\n    ++        index->nStatus |= BLOCK_VALID_MASK;\r\n    ++\r\n    +         // Fake BLOCK_OPT_WITNESS so that CChainState::NeedsRedownload()\r\n    +         // won't ask to rewind the entire assumed-valid chain on startup.\r\n    +         if (index->pprev && ::IsWitnessEnabled(index->pprev, ::Params().GetConsensus())) {\r\n    +@@\r\n    +         }\r\n    +     }\r\n    + }\r\n    ++\r\n    ++std::optional<CBlockIndex*> ChainstateManager::GetSnapshotBaseBlock()\r\n    ++{\r\n    ++    auto blockhash_op = SnapshotBlockhash();\r\n    ++    if (!blockhash_op) {\r\n    ++        return std::nullopt;\r\n    ++    }\r\n    ++    return m_blockman.LookupBlockIndex(*blockhash_op);\r\n    ++}\r\n    ++\r\n    ++std::optional<int> ChainstateManager::GetSnapshotHeight()\r\n    ++{\r\n    ++    std::optional<CBlockIndex*> base = this->GetSnapshotBaseBlock();\r\n    ++    if (!base) {\r\n    ++        return std::nullopt;\r\n    ++    }\r\n    ++    return (*base)->nHeight;\r\n    ++}\r\n    +\r\n    + diff --git a/src/validation.h b/src/validation.h\r\n    + --- a/src/validation.h\r\n    + +++ b/src/validation.h\r\n    +@@\r\n    +     //! ResizeCoinsCaches() as needed.\r\n    +     void MaybeRebalanceCaches() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\r\n    +\r\n    ++    //! @returns height at which the active UTXO snapshot was taken, if applicable.\r\n    ++    std::optional<CBlockIndex*> GetSnapshotBaseBlock() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\r\n    ++\r\n    ++    //! @returns height at which the active UTXO snapshot was taken, if a snapshot is being used.\r\n    ++    std::optional<int> GetSnapshotHeight() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\r\n    ++\r\n    +     ~ChainstateManager() {\r\n    +         LOCK(::cs_main);\r\n    +         UnloadBlockIndex(/* mempool */ nullptr, *this);\r\n4:  d3e949fb8 ! 4:  c9d332d03 move-only: unittest: add test/util/chainstate.h\r\n    @@ -33,6 +33,7 @@\r\n     +#include <fs.h>\r\n     +#include <node/context.h>\r\n     +#include <node/utxo_snapshot.h>\r\n    ++#include <rpc/blockchain.h>\r\n     +#include <validation.h>\r\n     +\r\n     +#include <univalue.h>\r\n5:  b75e71c7c = 5:  d20161e9c test: refactor: separate CreateBlock in TestChain100Setup\r\n6:  ede45e203 = 6:  881150900 test: validation: add unittest for UpdateTip behavior\r\n```\r\n\r\n</details>\r\n\r\n",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-863579751",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4911213328,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDkxMTIxMzMyOA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4911213328",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-18T19:02:27Z"
    },
    {
      "event": "commented",
      "id": 864224100,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NDIyNDEwMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/864224100",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-18T19:05:03Z",
      "updated_at": "2021-06-18T19:05:03Z",
      "author_association": "MEMBER",
      "body": "[`au.multi-chainstates.pt1.12`](https://github.com/jamesob/bitcoin/tree/au.multi-chainstates.pt1.12) -> [`au.multi-chainstates.pt1.13`](https://github.com/jamesob/bitcoin/tree/au.multi-chainstates.pt1.13)\r\n\r\nArgh sorry for the churn; botched rebase pushed some old code that caused segfault in unittests. Fixed.\r\n\r\n<details><summary>Show range-diff</summary>\r\n\r\n```sh\r\n$ git range-diff master au.multi-chainstates.pt1.12 au.multi-chainstates.pt1.13\r\n\r\n1:  e5e1d49cc = 1:  e5e1d49cc validation: add chainman ref to CChainState\r\n2:  4cf9de9d7 = 2:  4cf9de9d7 validation: change UpdateTip for multiple chainstates\r\n3:  7ff4c234e ! 3:  cf7afe34c validation: fix CheckBlockIndex for multiple chainstates\r\n    @@ -96,9 +96,13 @@\r\n     +{\r\n     +    auto blockhash_op = SnapshotBlockhash();\r\n     +    if (!blockhash_op) {\r\n    -+        return std::nullopt;\r\n    ++  return std::nullopt;\r\n    ++    }\r\n    ++    CBlockIndex* pindex = m_blockman.LookupBlockIndex(*blockhash_op);\r\n    ++    if (pindex == nullptr) {\r\n    ++  return std::nullopt;\r\n     +    }\r\n    -+    return m_blockman.LookupBlockIndex(*blockhash_op);\r\n    ++    return pindex;\r\n     +}\r\n     +\r\n     +std::optional<int> ChainstateManager::GetSnapshotHeight()\r\n4:  c9d332d03 = 4:  c1c1f95a0 move-only: unittest: add test/util/chainstate.h\r\n5:  d20161e9c = 5:  1c4d35b06 test: refactor: separate CreateBlock in TestChain100Setup\r\n6:  881150900 = 6:  5a3ed1ae0 test: validation: add unittest for UpdateTip behavior\r\n```\r\n\r\n</details>\r\n",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-864224100",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "reviewed",
      "id": 687757844,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Njg3NzU3ODQ0",
      "url": null,
      "actor": null,
      "commit_id": "5a3ed1ae09cefe030662bf2793bbacec056f0523",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "utACK 5a3ed1ae09cefe030662bf2793bbacec056f0523\r\n\r\nrebase looks good",
      "user": {
        "login": "benthecarman",
        "id": 15256660,
        "node_id": "MDQ6VXNlcjE1MjU2NjYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benthecarman",
        "html_url": "https://github.com/benthecarman",
        "followers_url": "https://api.github.com/users/benthecarman/followers",
        "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
        "organizations_url": "https://api.github.com/users/benthecarman/orgs",
        "repos_url": "https://api.github.com/users/benthecarman/repos",
        "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benthecarman/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-687757844",
      "submitted_at": "2021-06-18T22:41:25Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "commented",
      "id": 864883356,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NDg4MzM1Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/864883356",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T09:28:59Z",
      "updated_at": "2021-06-21T09:28:59Z",
      "author_association": "MEMBER",
      "body": "```\r\nThis diff appears to have added new lines with tab characters instead of spaces.\r\nThe following changes were suspected:\r\n\r\ndiff --git a/src/validation.cpp b/src/validation.cpp\r\n@@ -5083,0 +5136,22 @@ void ChainstateManager::MaybeRebalanceCaches()\r\n+\treturn std::nullopt;\r\n+\treturn std::nullopt;\r\n^---- failure generated from test/lint/lint-whitespace.sh",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-864883356",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 4916912348,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NDkxNjkxMjM0OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4916912348",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T13:41:42Z"
    },
    {
      "event": "commented",
      "id": 865043913,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg2NTA0MzkxMw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/865043913",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-06-21T13:43:02Z",
      "updated_at": "2021-06-21T13:43:02Z",
      "author_association": "MEMBER",
      "body": "[`au.multi-chainstates.pt1.13`](https://github.com/jamesob/bitcoin/tree/au.multi-chainstates.pt1.13) -> [`au.multi-chainstates.pt1.14`](https://github.com/jamesob/bitcoin/tree/au.multi-chainstates.pt1.14)\r\n\r\nPushed whitespace fix; sorry for the holdup.\r\n\r\n<details><summary>Show range-diff</summary>\r\n\r\n```sh\r\n$ git range-diff master au.multi-chainstates.pt1.13 au.multi-chainstates.pt1.14\r\n\r\n1:  e5e1d49cc = 1:  e5e1d49cc validation: add chainman ref to CChainState\r\n2:  4cf9de9d7 = 2:  4cf9de9d7 validation: change UpdateTip for multiple chainstates\r\n3:  cf7afe34c ! 3:  0dd5757fd validation: fix CheckBlockIndex for multiple chainstates\r\n    @@ -96,11 +96,11 @@\r\n     +{\r\n     +    auto blockhash_op = SnapshotBlockhash();\r\n     +    if (!blockhash_op) {\r\n    -+  return std::nullopt;\r\n    ++        return std::nullopt;\r\n     +    }\r\n     +    CBlockIndex* pindex = m_blockman.LookupBlockIndex(*blockhash_op);\r\n     +    if (pindex == nullptr) {\r\n    -+  return std::nullopt;\r\n    ++        return std::nullopt;\r\n     +    }\r\n     +    return pindex;\r\n     +}\r\n4:  c1c1f95a0 = 4:  c7b47bf9c move-only: unittest: add test/util/chainstate.h\r\n5:  1c4d35b06 = 5:  e06183769 test: refactor: separate CreateBlock in TestChain100Setup\r\n6:  5a3ed1ae0 = 6:  b6dffada1 test: validation: add unittest for UpdateTip behavior\r\n```\r\n\r\n</details>\r\n\r\n",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-865043913",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "reviewed",
      "id": 688453572,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Njg4NDUzNTcy",
      "url": null,
      "actor": null,
      "commit_id": "0dd5757fd7c5b1d151abe45843711780a4b3885b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK b6dffada18bf874c619d17baf9df45346e52b871. Change since last review was updating `CheckBlockIndex` to deal with missing blocks before the snapshot.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-688453572",
      "submitted_at": "2021-06-21T15:47:53Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 689166399,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Njg5MTY2Mzk5",
      "url": null,
      "actor": null,
      "commit_id": "b6dffada18bf874c619d17baf9df45346e52b871",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "reACK b6dffada18bf874c619d17baf9df45346e52b871",
      "user": {
        "login": "benthecarman",
        "id": 15256660,
        "node_id": "MDQ6VXNlcjE1MjU2NjYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benthecarman",
        "html_url": "https://github.com/benthecarman",
        "followers_url": "https://api.github.com/users/benthecarman/followers",
        "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
        "organizations_url": "https://api.github.com/users/benthecarman/orgs",
        "repos_url": "https://api.github.com/users/benthecarman/repos",
        "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benthecarman/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-689166399",
      "submitted_at": "2021-06-22T07:44:08Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 692059584,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjkyMDU5NTg0",
      "url": null,
      "actor": null,
      "commit_id": "b6dffada18bf874c619d17baf9df45346e52b871",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Just see the comment about unknown new consensus rules state change not being warned off in case of background validation, and it might matter a bit.",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-692059584",
      "submitted_at": "2021-06-24T18:17:16Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "commented",
      "id": 872597591,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg3MjU5NzU5MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/872597591",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-01T22:56:40Z",
      "updated_at": "2021-07-01T22:56:40Z",
      "author_association": "MEMBER",
      "body": "Code Review ACK b6dffad\r\n\r\nStill feel free to take my minor comments if you retouch the branch :)",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-872597591",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "labeled",
      "id": 5024940294,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDUwMjQ5NDAyOTQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5024940294",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-15T11:51:21Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5ZjZiYjUzOTM1OWI5OGQ1YjM5NDgyYWI4YTI4YTY4NjA4ZjBjNjQ1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9f6bb539359b98d5b39482ab8a28a68608f0c645",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9f6bb539359b98d5b39482ab8a28a68608f0c645",
      "tree": {
        "sha": "4397f65cb333ecc102ed1d36057d4a5ba8983af4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4397f65cb333ecc102ed1d36057d4a5ba8983af4"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 4397f65cb333ecc102ed1d36057d4a5ba8983af4\nparent d86e6625e8571ecff7a13bf2826436859c7ae698\nauthor James O'Beirne <james.obeirne@pm.me> 1623509560 -0400\ncommitter James O'Beirne <james.obeirne@pm.me> 1626453920 -0400\n\nvalidation: add chainman ref to CChainState\n\nAdd an upwards reference to chainstate instances to the owning\nChainstateManager. This is necessary because there are a number\nof `this_chainstate == chainman.ActiveChainstate()` checks that\nwill happen (as a result of assumeutxo) in functions that otherwise\ndon't have an easily-accessible reference to the chainstate's\nChainManager.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmDxt6AACgkQepNdrbLE\nTwVWKQ/9HOOquH2ufs2qEldvgPwZ5CGGnnHf5QCEmzyRwTpRUb9zR/2/ekKHYE/r\n90wbY5Cm6bThGRY7lcJLfE+KIgPucoT+brL9DA5r4BaB82OUMJOmZLdQCD5EQjZi\njPENt4r9PcPh8aBo557lj1nqQf8Ata3XkWDyxRV8OnstnFeXNlIEpdBI4d4e4pln\nKbCNkg8KlgPI3QmW14JWyH7vk95B/np1luUiziuNFF1RaUm3jr6CvUfFVosdb7hN\nq/jbRrZVbP8Qn7jqN4x0hs0bJmzV24xkARU277udcZRmIJQ/IO3gO6QgkFVPnYdb\njkogRpZFlvfSxjqcYEXWtDUQLhWhXENHTLiVVDlNHbLS1OWBls5gJkt8FrmGY82F\nEeu7QEfx1LJeFnZTVoIG0oZP4k8h33zxZ3U9zLdIb1VKqCvArtKYUq6Cjmvpnlab\nGd/T6HTSrHeuUNuPLJwEZjsZJbXowtsjYjnZx6SNO/ZZFl4kQQLFAWJ2QjkX/pMv\nDQIRz+cy/QAfm1ZsrN3JwVZYhke0ZygksihSuZ8yZOd4DxV/XPnCqdATOXHqOugH\nWeZtDYpi1Z8NJvVzkSFRGvDs4+Pp8ZhzzlUs+o+l6yftMIU46F1QcRPrR8ANJ9yf\nfHubCnVP8aIEZqPefb3Yo/rE1YIM7VQRu6mZgrmH7wmR0Jd22DU=\n=CAp/\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d86e6625e8571ecff7a13bf2826436859c7ae698",
          "sha": "d86e6625e8571ecff7a13bf2826436859c7ae698",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d86e6625e8571ecff7a13bf2826436859c7ae698"
        }
      ],
      "message": "validation: add chainman ref to CChainState\n\nAdd an upwards reference to chainstate instances to the owning\nChainstateManager. This is necessary because there are a number\nof `this_chainstate == chainman.ActiveChainstate()` checks that\nwill happen (as a result of assumeutxo) in functions that otherwise\ndon't have an easily-accessible reference to the chainstate's\nChainManager.",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-07-16T16:45:20Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-06-12T14:52:40Z"
      },
      "sha": "9f6bb539359b98d5b39482ab8a28a68608f0c645"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzphYzQwNTFkODkxZTJkNWM4YWMxMzBkYTE2Yjg1YjlkODgwYjQ0NzIw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ac4051d891e2d5c8ac130da16b85b9d880b44720",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ac4051d891e2d5c8ac130da16b85b9d880b44720",
      "tree": {
        "sha": "20649daf56f45ea2388adae94691b322a8beb4b1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/20649daf56f45ea2388adae94691b322a8beb4b1"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 20649daf56f45ea2388adae94691b322a8beb4b1\nparent 9f6bb539359b98d5b39482ab8a28a68608f0c645\nauthor James O'Beirne <james.obeirne@pm.me> 1626360028 -0400\ncommitter James O'Beirne <james.obeirne@pm.me> 1626453923 -0400\n\nrefactor: remove unused assumeutxo methods\n\nAfter feedback from Russ, I realized that there are some extraneous assumeutxo methods\nthat are not necessary and probably just overly confusing. These include\n\n- `Validated*()`\n- `IsBackgroundIBD()`\n\nand they can be removed.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmDxt6MACgkQepNdrbLE\nTwXd2BAAj/xD6FAE982LtxWeQ6sIlwHbwZjS7KuBpqtZqQfzRN2/skilXCmL3X1r\nqX0crAUVQ7n3DKPlFZD3f0ls2rSy+3yNvaAcQ7S0QHEUAQT8lMWpZIpBH7YxSbDy\nFbN73C3n6Z6iBVj8niMM8C31+FhspBdnOYSPt+Pt5uR2+ELMHvc3HGF024odUiTL\nkAUO7NyGl0LHgcawaETSPmqLK36LbM2YvHWa4x7yv/O2IbbauNYVcv0uVAZc1TGO\nLfyv/H8KDJdo+/qBAJ675fW0YVDj09Tz/TrEbgdzbuyzFPsomC8IW+xvghToNEoR\nx+ZzqNYCyCSgEMhm+VE9X38OFNEuuhqQpM4C1cHau8hw02l6w7XztNR7NxOb40a2\nsUG8Qun7COlHkZqZDFGcY25DwCQzVesPmGv8Rl9JBpfsQhIBpFSPnW8DWi8QVTeA\nDqUqXkTK2wJJTP1aUpROXoe4Z7tg2NyQaVbuX8cergEA1t10Uji8lzFCgc11vRe4\n0SviD7EEUJI0hVfuQslCc4HSfhwX9YxC/tl+zqukOlsnLNQPE0DOw1A+iSbO+MXN\nvZ3qi8tSgBN3vlZ1ZgQFgRgXa4pHE3v65WlKAsziEZWYGWFK9PMdGOomeFXDz0D4\nwrbldlVaqAR6E2JxErOKTjuaFPM7MrbaKNokdphMgVrU2Dk2QXU=\n=xivf\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9f6bb539359b98d5b39482ab8a28a68608f0c645",
          "sha": "9f6bb539359b98d5b39482ab8a28a68608f0c645",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9f6bb539359b98d5b39482ab8a28a68608f0c645"
        }
      ],
      "message": "refactor: remove unused assumeutxo methods\n\nAfter feedback from Russ, I realized that there are some extraneous assumeutxo methods\nthat are not necessary and probably just overly confusing. These include\n\n- `Validated*()`\n- `IsBackgroundIBD()`\n\nand they can be removed.",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-07-16T16:45:23Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-07-15T14:40:28Z"
      },
      "sha": "ac4051d891e2d5c8ac130da16b85b9d880b44720"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5032513235,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NTAzMjUxMzIzNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5032513235",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-16T19:23:16Z"
    },
    {
      "event": "reviewed",
      "id": 708717465,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzA4NzE3NDY1",
      "url": null,
      "actor": null,
      "commit_id": "1ffc89e1192089aca8cdb0de80305d24f943ebfe",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Debug-built and did an initial commit-by-commit familiarization + unittest runs at 1ffc89e1192089aca8cdb0de80305d24f943ebfe and looks good.  Will try to do a second pass soon to be able to ACK. Feel free to ignore the comments below.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-708717465",
      "submitted_at": "2021-07-16T20:36:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "unlabeled",
      "id": 5032889509,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50NTAzMjg4OTUwOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5032889509",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-16T21:18:55Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5034146664,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NTAzNDE0NjY2NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5034146664",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-17T14:31:09Z"
    },
    {
      "event": "commented",
      "id": 881908599,
      "node_id": "IC_kwDOABII5840kNt3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/881908599",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-17T14:37:21Z",
      "updated_at": "2021-07-17T14:37:21Z",
      "author_association": "MEMBER",
      "body": "[`au.multi-chainstates.pt1.14`](https://github.com/jamesob/bitcoin/tree/au.multi-chainstates.pt1.14) -> [`au.multi-chainstates.pt1.16`](https://github.com/jamesob/bitcoin/tree/au.multi-chainstates.pt1.16)\r\n\r\nAfter looking into @ryanofsky's feedback on #15606, I found that there were some parts of the ChainstateManager interface that were ultimately unused (and probably confusing), so I've removed them here in https://github.com/bitcoin/bitcoin/pull/21526/commits/ac4051d891e2d5c8ac130da16b85b9d880b44720. All other changes are either rebasing onto #22415 or responding to feedback.\r\n\r\nTo check the range-diff, run:\r\n```sh\r\ngit remote add jamesob https://github.com/jamesob/bitcoin.git\r\ngit fetch jamesob\r\ngit range-diff master au.multi-chainstates.pt1.14 au.multi-chainstates.pt1.16\r\n```",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-881908599",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "mentioned",
      "id": 5034151817,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NTAzNDE1MTgxNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5034151817",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-17T14:37:22Z"
    },
    {
      "event": "subscribed",
      "id": 5034151820,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDUwMzQxNTE4MjA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5034151820",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-17T14:37:22Z"
    },
    {
      "event": "reviewed",
      "id": 708964765,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzA4OTY0NzY1",
      "url": null,
      "actor": null,
      "commit_id": "1901a9819d507425f9a2ea440d78892acbbb0e7f",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-708964765",
      "submitted_at": "2021-07-17T19:29:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "commented",
      "id": 881950913,
      "node_id": "IC_kwDOABII5840kYDB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/881950913",
      "actor": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-17T19:47:48Z",
      "updated_at": "2021-07-17T19:47:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "did some lite code review; generally looks OK but I'm not super familiar with this part of the code so an ACK from me wouldn't count for much.",
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-881950913",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "reviewed",
      "id": 709939303,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzA5OTM5MzAz",
      "url": null,
      "actor": null,
      "commit_id": "daa6902795b082832734b084a6c118eb8c682c3d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK 1901a9819d507425f9a2ea440d78892acbbb0e7f. Since last review there was a rebase on #22415, a little more streamlining of assumeutxo snapshot/background/validated chainstate code in chainstate manager, and a few other cleanups.\r\n\r\nI added some review suggestions below but these aren't important and I think this looks good to be merged as-is (maybe with some previous reviewers reacking)",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-709939303",
      "submitted_at": "2021-07-19T22:27:27Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 711025359,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzExMDI1MzU5",
      "url": null,
      "actor": null,
      "commit_id": "1901a9819d507425f9a2ea440d78892acbbb0e7f",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-711025359",
      "submitted_at": "2021-07-20T20:14:53Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5062119372,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NTA2MjExOTM3Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5062119372",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-23T17:09:14Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5062135397,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NTA2MjEzNTM5Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5062135397",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-23T17:13:23Z"
    },
    {
      "event": "commented",
      "id": 886054862,
      "node_id": "IC_kwDOABII58400B_O",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/886054862",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-24T13:37:15Z",
      "updated_at": "2021-07-24T13:37:15Z",
      "author_association": "MEMBER",
      "body": "[`au.multi-chainstates.pt1.16`](https://github.com/jamesob/bitcoin/tree/au.multi-chainstates.pt1.16) -> [`au.multi-chainstates.pt1.18`](https://github.com/jamesob/bitcoin/tree/au.multi-chainstates.pt1.18)\r\n\r\nAfter spending some time slightly reworking #15606 to incorporate good design feedback from @ryanofsky, I've pushed some fairly substantive changes here. Sorry, of course, for these changes so late in the game on this PR - but better to make them now than post-merge. \r\n\r\nIn a nutshell, I've reworked assumeutxo so that the notion of a \"UTXO snapshot\" is basically an implementation detail of ChainstateManager and doesn't leak out from behind it. Other parts of validation and the system at large deal with more general concepts like assumed-valid block index entries, and aren't concerned with things like what height the base block of the snapshot is at.\r\n\r\nThis is described in [an assumeutxo design document (docs/assumeutxo.md)](https://github.com/bitcoin/bitcoin/blob/d575d2b45fa33c0e88b3060309795d4a386bf1ce/doc/assumeutxo.md#design-notes) I've added in the parent PR. The immediate changes here are \r\n- introduction of a new block index `nStatus` flag: `BLOCK_ASSUMED_VALID`, which marks block entries that are for the moment assumed to be valid and are pending asynchronous validation,\r\n- use of this new flag to modify `CheckBlockIndex()` logic as needed - which is more resilient than the previous approach because as assumd-valid index entries are marked as valid, the CheckBlockIndex() checks gradually return to \"normal\" operation (instead of having to wait on complete snapshot validation, and hoping that we set ChainstateManager state correctly).\r\n\r\nI think these changes not only represent a better design for the assumeutxo implementation, but they address all pending feedback here in this PR.\r\n\r\nThanks again for bearing with the changes and continuing to help with review. Once we get this merged, there are a number of other (smaller) assumeutxo PRs I can open.",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-886054862",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "mentioned",
      "id": 5064062294,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NTA2NDA2MjI5NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5064062294",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-24T13:37:16Z"
    },
    {
      "event": "subscribed",
      "id": 5064062295,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDUwNjQwNjIyOTU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5064062295",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-24T13:37:16Z"
    },
    {
      "event": "commented",
      "id": 893724818,
      "node_id": "IC_kwDOABII5841RSiS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/893724818",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-05T19:25:01Z",
      "updated_at": "2021-08-05T19:25:01Z",
      "author_association": "MEMBER",
      "body": "Anyone have any advice on what's needed to move this forward? I think it's in pretty good shape.",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-893724818",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "commented",
      "id": 893819553,
      "node_id": "IC_kwDOABII5841Rpqh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/893819553",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-05T21:25:14Z",
      "updated_at": "2021-08-05T21:25:14Z",
      "author_association": "MEMBER",
      "body": "> Anyone have any advice on what's needed to move this forward? I think it's in pretty good shape.\r\n\r\nMy bad! I reviewed most of the new changes here while I was going through the larger PR #15606, but I forgot to come back and re-ack. \r\n\r\nAside from me, some previous reviewers might be interested to continue review or re-ack:\r\n\r\n- @sjors https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-652577266\r\n- @benthecarman https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-689166399\r\n- @ariard https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-872597591\r\n- @jonatack https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-708717465\r\n- JeremyRubin https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-881950913",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-893819553",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "mentioned",
      "id": 5119834699,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NTExOTgzNDY5OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5119834699",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-05T21:25:14Z"
    },
    {
      "event": "subscribed",
      "id": 5119834702,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDUxMTk4MzQ3MDI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5119834702",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-05T21:25:14Z"
    },
    {
      "event": "mentioned",
      "id": 5119834709,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NTExOTgzNDcwOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5119834709",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-05T21:25:15Z"
    },
    {
      "event": "subscribed",
      "id": 5119834713,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDUxMTk4MzQ3MTM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5119834713",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-05T21:25:15Z"
    },
    {
      "event": "mentioned",
      "id": 5119834716,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NTExOTgzNDcxNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5119834716",
      "actor": {
        "login": "benthecarman",
        "id": 15256660,
        "node_id": "MDQ6VXNlcjE1MjU2NjYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benthecarman",
        "html_url": "https://github.com/benthecarman",
        "followers_url": "https://api.github.com/users/benthecarman/followers",
        "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
        "organizations_url": "https://api.github.com/users/benthecarman/orgs",
        "repos_url": "https://api.github.com/users/benthecarman/repos",
        "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benthecarman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-05T21:25:15Z"
    },
    {
      "event": "subscribed",
      "id": 5119834717,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDUxMTk4MzQ3MTc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5119834717",
      "actor": {
        "login": "benthecarman",
        "id": 15256660,
        "node_id": "MDQ6VXNlcjE1MjU2NjYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benthecarman",
        "html_url": "https://github.com/benthecarman",
        "followers_url": "https://api.github.com/users/benthecarman/followers",
        "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
        "organizations_url": "https://api.github.com/users/benthecarman/orgs",
        "repos_url": "https://api.github.com/users/benthecarman/repos",
        "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benthecarman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-05T21:25:15Z"
    },
    {
      "event": "mentioned",
      "id": 5119834721,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NTExOTgzNDcyMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5119834721",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-05T21:25:15Z"
    },
    {
      "event": "subscribed",
      "id": 5119834722,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDUxMTk4MzQ3MjI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5119834722",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-05T21:25:15Z"
    },
    {
      "event": "reviewed",
      "id": 723820187,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzIzODIwMTg3",
      "url": null,
      "actor": null,
      "commit_id": "d502108c82e64b6acec4d2788fb224c118fccaff",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK 3a9ce0e2d41cac3b072225aa1ed34caca4191392. Looks good! All comments just FYI and maybe for future followup.\r\n\r\nChanges since last review: adding assertlockheld to UpdateTip lambda, adding BLOCK_ASSUMED_VALID logic, and doing a pointer->reference cleanup in tests.\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-723820187",
      "submitted_at": "2021-08-05T22:56:31Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 724682056,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzI0NjgyMDU2",
      "url": null,
      "actor": null,
      "commit_id": "3a9ce0e2d41cac3b072225aa1ed34caca4191392",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "utACK 3a9ce0e2d41cac3b072225aa1ed34caca4191392",
      "user": {
        "login": "benthecarman",
        "id": 15256660,
        "node_id": "MDQ6VXNlcjE1MjU2NjYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benthecarman",
        "html_url": "https://github.com/benthecarman",
        "followers_url": "https://api.github.com/users/benthecarman/followers",
        "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
        "organizations_url": "https://api.github.com/users/benthecarman/orgs",
        "repos_url": "https://api.github.com/users/benthecarman/repos",
        "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benthecarman/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-724682056",
      "submitted_at": "2021-08-06T20:14:47Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 729070205,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzI5MDcwMjA1",
      "url": null,
      "actor": null,
      "commit_id": "3a9ce0e2d41cac3b072225aa1ed34caca4191392",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-729070205",
      "submitted_at": "2021-08-12T21:00:16Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5157355488,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NTE1NzM1NTQ4OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5157355488",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-13T19:22:49Z"
    },
    {
      "event": "reviewed",
      "id": 729926636,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzI5OTI2NjM2",
      "url": null,
      "actor": null,
      "commit_id": "011b52beb95abe8fd245218f63d6e1b3538408f9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-729926636",
      "submitted_at": "2021-08-13T19:51:01Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5157660707,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50NTE1NzY2MDcwNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5157660707",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-13T20:58:01Z"
    },
    {
      "event": "reviewed",
      "id": 730090250,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzMwMDkwMjUw",
      "url": null,
      "actor": null,
      "commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK a30a5d46b3574a49f9e3611caeb730bf12d748fd. Only changes since last review are changing lambda function to regular function and updating some comments",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-730090250",
      "submitted_at": "2021-08-14T12:10:42Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "commented",
      "id": 898948602,
      "node_id": "IC_kwDOABII5841lN36",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898948602",
      "actor": {
        "login": "benthecarman",
        "id": 15256660,
        "node_id": "MDQ6VXNlcjE1MjU2NjYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benthecarman",
        "html_url": "https://github.com/benthecarman",
        "followers_url": "https://api.github.com/users/benthecarman/followers",
        "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
        "organizations_url": "https://api.github.com/users/benthecarman/orgs",
        "repos_url": "https://api.github.com/users/benthecarman/repos",
        "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benthecarman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-08-14T19:24:10Z",
      "updated_at": "2021-08-14T19:24:10Z",
      "author_association": "CONTRIBUTOR",
      "body": "reACK a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "user": {
        "login": "benthecarman",
        "id": 15256660,
        "node_id": "MDQ6VXNlcjE1MjU2NjYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benthecarman",
        "html_url": "https://github.com/benthecarman",
        "followers_url": "https://api.github.com/users/benthecarman/followers",
        "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
        "organizations_url": "https://api.github.com/users/benthecarman/orgs",
        "repos_url": "https://api.github.com/users/benthecarman/repos",
        "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benthecarman/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-898948602",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "reviewed",
      "id": 730723186,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzMwNzIzMTg2",
      "url": null,
      "actor": null,
      "commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK a30a5d46b3574a49f9e3611caeb730bf12d748fd caught up on context, rebased to master, and for each commit code review/debug build/unit test run\r\n\r\nVarious non-blocking minor comments follow, feel free to pick/choose/ignore, happy to re-ACK if you update.\r\n\r\nEdit: am running a mainnet node on this branch with `-checkblockindex=1`",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-730723186",
      "submitted_at": "2021-08-16T16:50:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 730967337,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzMwOTY3MzM3",
      "url": null,
      "actor": null,
      "commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-730967337",
      "submitted_at": "2021-08-16T17:32:33Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 738750998,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzM4NzUwOTk4",
      "url": null,
      "actor": null,
      "commit_id": "212b80dad5c19a043c007d79109963e301cd1400",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK a30a5d46b3574a49f9e3611caeb730bf12d748fd\r\n\r\nSorry for being late to the party, none of my comments are blocking but if you decide to address them (or have to retouch for another reason), I will be quick to re-review.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-738750998",
      "submitted_at": "2021-08-25T23:48:27Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 738913608,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzM4OTEzNjA4",
      "url": null,
      "actor": null,
      "commit_id": "e747b5379f5f57c8732d42b07515118e305ddb18",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Few questions to solve, thought overall I think it's pretty mature for merging.",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-738913608",
      "submitted_at": "2021-08-26T00:18:10Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "commented",
      "id": 912501201,
      "node_id": "IC_kwDOABII5842Y6nR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/912501201",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-03T12:29:34Z",
      "updated_at": "2021-09-03T12:29:34Z",
      "author_association": "MEMBER",
      "body": "Light code review ACK, I will do good review once pending suggestions are resolved.",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-912501201",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "commented",
      "id": 914308923,
      "node_id": "IC_kwDOABII5842fz87",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/914308923",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-07T13:30:59Z",
      "updated_at": "2021-09-07T13:30:59Z",
      "author_association": "MEMBER",
      "body": "Hi, sorry for the slowness here and thanks to everyone for the review. I got pretty sick in the last two weeks and was unable to work. As I recover in the coming days I'll address the new feedback.",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-914308923",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5274745611,
      "node_id": "HRFPE_lADOABII584yEv9LzwAAAAE6ZjsL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5274745611",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-08T21:03:31Z"
    },
    {
      "event": "commented",
      "id": 915946051,
      "node_id": "IC_kwDOABII5842mDpD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/915946051",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-09T10:04:45Z",
      "updated_at": "2021-09-09T10:04:45Z",
      "author_association": "MEMBER",
      "body": "utACK a07e850482ab22f31d070af6d080a0db66564c18\r\n\r\nAmong the remaining comments, I'd ask you to reconsider [this one](https://github.com/bitcoin/bitcoin/pull/21526#discussion_r683829467) if you decide to retouch. Not a blocker at all.",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-915946051",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "commented",
      "id": 916288041,
      "node_id": "IC_kwDOABII5842nXIp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/916288041",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-09T17:18:24Z",
      "updated_at": "2021-09-09T17:18:24Z",
      "author_association": "MEMBER",
      "body": "Thanks for the looks, everyone. I've pushed a number of small changes addressing the feedback given.",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-916288041",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "reviewed",
      "id": 751917600,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzUxOTE3NjAw",
      "url": null,
      "actor": null,
      "commit_id": "a07e850482ab22f31d070af6d080a0db66564c18",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "re-ACK a07e850482ab22f31d070af6d080a0db66564c18 per `git diff a30a5d4 a07e850`, reviewed diff, verified rebase to current master, debug build clean, unit tests green, briefly ran bitcoind with `-checkblockindex`\r\n\r\nThe main change is a move-only one in `chain.h` to address https://github.com/bitcoin/bitcoin/pull/21526#discussion_r696169810:\r\n\r\n```diff\r\n@@ -319,13 +319,13 @@ public:\r\n         assert(!(nUpTo & ~BLOCK_VALID_MASK)); // Only validity flags allowed.\r\n         if (nStatus & BLOCK_FAILED_MASK) return false;\r\n \r\n-        // If this block had been marked assumed-valid and we're raising\r\n-        // its validity to a certain point, there is no longer an assumption.\r\n-        if (nStatus & BLOCK_ASSUMED_VALID && nUpTo >= BLOCK_VALID_SCRIPTS) {\r\n-            nStatus &= ~BLOCK_ASSUMED_VALID;\r\n-        }\r\n-\r\n         if ((nStatus & BLOCK_VALID_MASK) < nUpTo) {\r\n+            // If this block had been marked assumed-valid and we're raising\r\n+            // its validity to a certain point, there is no longer an assumption.\r\n+            if (nStatus & BLOCK_ASSUMED_VALID && nUpTo >= BLOCK_VALID_SCRIPTS) {\r\n+                nStatus &= ~BLOCK_ASSUMED_VALID;\r\n+            }\r\n+\r\n             nStatus = (nStatus & ~BLOCK_VALID_MASK) | nUpTo;\r\n             return true;\r\n```\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-751917600",
      "submitted_at": "2021-09-11T13:06:16Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 751995830,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzUxOTk1ODMw",
      "url": null,
      "actor": null,
      "commit_id": "a07e850482ab22f31d070af6d080a0db66564c18",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "reACK a07e850482ab22f31d070af6d080a0db66564c18",
      "user": {
        "login": "benthecarman",
        "id": 15256660,
        "node_id": "MDQ6VXNlcjE1MjU2NjYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benthecarman",
        "html_url": "https://github.com/benthecarman",
        "followers_url": "https://api.github.com/users/benthecarman/followers",
        "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
        "organizations_url": "https://api.github.com/users/benthecarman/orgs",
        "repos_url": "https://api.github.com/users/benthecarman/repos",
        "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benthecarman/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-751995830",
      "submitted_at": "2021-09-11T21:20:40Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "commented",
      "id": 918540412,
      "node_id": "IC_kwDOABII5842v9B8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/918540412",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-13T20:14:39Z",
      "updated_at": "2021-09-13T20:30:08Z",
      "author_association": "MEMBER",
      "body": "~~ACK a07e850482ab22f31d070af6d080a0db66564c18~~\r\n\r\nTried to build and I got this error:\r\n\r\n    /usr/bin/ld: test/test_bitcoin-validation_chainstatemanager_tests.o:././test/util/chainstate.h:19: multiple definition of `NoMalleation'; test/test_bitcoin-validation_chainstate_tests.o:././test/util/chainstate.h:19: first defined here",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-918540412",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "commented",
      "id": 918586144,
      "node_id": "IC_kwDOABII5842wIMg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/918586144",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-13T21:19:34Z",
      "updated_at": "2021-09-13T21:19:34Z",
      "author_association": "MEMBER",
      "body": "@achow101 thanks for reviewing and testing. What's your platform information? I just tried to reproduce your error locally and was unable, and CI is able to build. Maybe try `make distclean; ./configure ...`, then remake?",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-918586144",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "mentioned",
      "id": 5295576973,
      "node_id": "MEE_lADOABII584yEv9LzwAAAAE7pBeN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5295576973",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-13T21:19:34Z"
    },
    {
      "event": "subscribed",
      "id": 5295576978,
      "node_id": "SE_lADOABII584yEv9LzwAAAAE7pBeS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5295576978",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-13T21:19:34Z"
    },
    {
      "event": "reviewed",
      "id": 753280962,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NzUzMjgwOTYy",
      "url": null,
      "actor": null,
      "commit_id": "a07e850482ab22f31d070af6d080a0db66564c18",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK a07e850482ab22f31d070af6d080a0db66564c18. Since last review just simple cleanups, and corner case RaiseValidity behavior change (which IIUC is just to intended to give a more consistent return value, not to change anything in practice)",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-753280962",
      "submitted_at": "2021-09-13T21:38:14Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "commented",
      "id": 918630052,
      "node_id": "IC_kwDOABII5842wS6k",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/918630052",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-13T22:28:16Z",
      "updated_at": "2021-09-13T22:28:16Z",
      "author_association": "MEMBER",
      "body": "@jamesob\r\n\r\n> What's your platform information? I just tried to reproduce your error locally and was unable, and CI is able to build. Maybe try `make distclean; ./configure ...`, then remake?\r\n\r\nI've tried all sorts of clean and make to no avail. My system is Arch and I'm using GCC 11.1. Here's the [config.log](https://github.com/bitcoin/bitcoin/files/7157670/config.log) if that's useful.\r\n",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-918630052",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "mentioned",
      "id": 5295839323,
      "node_id": "MEE_lADOABII584yEv9LzwAAAAE7qBhb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5295839323",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-13T22:28:16Z"
    },
    {
      "event": "subscribed",
      "id": 5295839327,
      "node_id": "SE_lADOABII584yEv9LzwAAAAE7qBhf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5295839327",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-13T22:28:16Z"
    },
    {
      "event": "commented",
      "id": 919931718,
      "node_id": "IC_kwDOABII58421QtG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919931718",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-15T11:21:33Z",
      "updated_at": "2021-09-15T11:21:33Z",
      "author_association": "MEMBER",
      "body": "@achow101 did you try clearing ccache? I've found lately that sometimes it's overzealous in caching and can cause problems. If you haven't, give `ccache -C` a try before building.",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-919931718",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "mentioned",
      "id": 5305267373,
      "node_id": "MEE_lADOABII584yEv9LzwAAAAE8N_St",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5305267373",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-15T11:21:33Z"
    },
    {
      "event": "subscribed",
      "id": 5305267378,
      "node_id": "SE_lADOABII584yEv9LzwAAAAE8N_Sy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5305267378",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-15T11:21:33Z"
    },
    {
      "event": "commented",
      "id": 919945778,
      "node_id": "IC_kwDOABII58421UIy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919945778",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-15T11:44:42Z",
      "updated_at": "2021-09-15T11:44:42Z",
      "author_association": "MEMBER",
      "body": "Can't link either on a fresh Ubuntu Impish:\r\n\r\n```\r\nmake V=1\r\nMaking all in src\r\nmake[1]: Entering directory '/bitcoin-core/src'\r\nmake[2]: Entering directory '/bitcoin-core/src'\r\nmake[3]: Entering directory '/bitcoin-core'\r\nmake[3]: Leaving directory '/bitcoin-core'\r\n/bin/bash ../libtool  --tag=CXX --preserve-dup-deps  --mode=link /usr/bin/ccache g++ -std=c++17 -fdebug-prefix-map=/bitcoin-core/src=. -fstack-reuse=none -Wstack-protector -fstack-protector-all -fcf-protection=full -fstack-clash-protection -Wall -Wextra -Wformat -Wformat-security -Wvla -Wswitch -Wredundant-decls -Wunused-variable -Wdate-time -Wsign-compare -Wduplicated-branches -Wduplicated-cond -Wlogical-op -Woverloaded-virtual -Wsuggest-override -Wno-unused-parameter -Wno-implicit-fallthrough -Wno-deprecated-copy    -fPIE -g -O2 -fno-extended-identifiers   -Wl,-z,relro -Wl,-z,now -Wl,-z,separate-code -pie     -pthread -lpthread -static  -o test/test_bitcoin test/test_bitcoin-main.o  wallet/test/test_test_bitcoin-wallet_test_fixture.o wallet/test/test_test_bitcoin-init_test_fixture.o test/test_bitcoin-arith_uint256_tests.o test/test_bitcoin-addrman_tests.o test/test_bitcoin-amount_tests.o test/test_bitcoin-allocator_tests.o test/test_bitcoin-base32_tests.o test/test_bitcoin-base58_tests.o test/test_bitcoin-base64_tests.o test/test_bitcoin-bech32_tests.o test/test_bitcoin-bip32_tests.o test/test_bitcoin-blockchain_tests.o test/test_bitcoin-blockencodings_tests.o test/test_bitcoin-blockfilter_tests.o test/test_bitcoin-blockfilter_index_tests.o test/test_bitcoin-bloom_tests.o test/test_bitcoin-bswap_tests.o test/test_bitcoin-checkqueue_tests.o test/test_bitcoin-coins_tests.o test/test_bitcoin-coinstatsindex_tests.o test/test_bitcoin-compilerbug_tests.o test/test_bitcoin-compress_tests.o test/test_bitcoin-crypto_tests.o test/test_bitcoin-cuckoocache_tests.o test/test_bitcoin-denialofservice_tests.o test/test_bitcoin-descriptor_tests.o test/test_bitcoin-flatfile_tests.o test/test_bitcoin-fs_tests.o test/test_bitcoin-getarg_tests.o test/test_bitcoin-hash_tests.o test/test_bitcoin-i2p_tests.o test/test_bitcoin-interfaces_tests.o test/test_bitcoin-key_io_tests.o test/test_bitcoin-key_tests.o test/test_bitcoin-logging_tests.o test/test_bitcoin-dbwrapper_tests.o test/test_bitcoin-validation_tests.o test/test_bitcoin-mempool_tests.o test/test_bitcoin-merkle_tests.o test/test_bitcoin-merkleblock_tests.o test/test_bitcoin-miner_tests.o test/test_bitcoin-multisig_tests.o test/test_bitcoin-net_peer_eviction_tests.o test/test_bitcoin-net_tests.o test/test_bitcoin-netbase_tests.o test/test_bitcoin-pmt_tests.o test/test_bitcoin-policy_fee_tests.o test/test_bitcoin-policyestimator_tests.o test/test_bitcoin-pow_tests.o test/test_bitcoin-prevector_tests.o test/test_bitcoin-raii_event_tests.o test/test_bitcoin-random_tests.o test/test_bitcoin-reverselock_tests.o test/test_bitcoin-rpc_tests.o test/test_bitcoin-sanity_tests.o test/test_bitcoin-scheduler_tests.o test/test_bitcoin-script_p2sh_tests.o test/test_bitcoin-script_tests.o test/test_bitcoin-script_standard_tests.o test/test_bitcoin-scriptnum_tests.o test/test_bitcoin-serfloat_tests.o test/test_bitcoin-serialize_tests.o test/test_bitcoin-settings_tests.o test/test_bitcoin-sighash_tests.o test/test_bitcoin-sigopcount_tests.o test/test_bitcoin-skiplist_tests.o test/test_bitcoin-sock_tests.o test/test_bitcoin-streams_tests.o test/test_bitcoin-sync_tests.o test/test_bitcoin-system_tests.o test/test_bitcoin-util_threadnames_tests.o test/test_bitcoin-timedata_tests.o test/test_bitcoin-torcontrol_tests.o test/test_bitcoin-transaction_tests.o test/test_bitcoin-txindex_tests.o test/test_bitcoin-txrequest_tests.o test/test_bitcoin-txvalidation_tests.o test/test_bitcoin-txvalidationcache_tests.o test/test_bitcoin-uint256_tests.o test/test_bitcoin-util_tests.o test/test_bitcoin-validation_block_tests.o test/test_bitcoin-validation_chainstate_tests.o test/test_bitcoin-validation_chainstatemanager_tests.o test/test_bitcoin-validation_flush_tests.o test/test_bitcoin-validationinterface_tests.o test/test_bitcoin-versionbits_tests.o wallet/test/test_test_bitcoin-psbt_wallet_tests.o wallet/test/test_test_bitcoin-wallet_tests.o wallet/test/test_test_bitcoin-walletdb_tests.o wallet/test/test_test_bitcoin-wallet_crypto_tests.o wallet/test/test_test_bitcoin-coinselector_tests.o wallet/test/test_test_bitcoin-init_tests.o wallet/test/test_test_bitcoin-ismine_tests.o wallet/test/test_test_bitcoin-scriptpubkeyman_tests.o wallet/test/test_test_bitcoin-db_tests.o     libtest_util.a libbitcoin_server.a libbitcoin_common.a libbitcoin_util.a crypto/libbitcoin_crypto_base.a libbitcoin_wallet.a libbitcoin_server.a libbitcoin_cli.a libbitcoin_common.a libbitcoin_util.a libbitcoin_consensus.a crypto/libbitcoin_crypto_base.a crypto/libbitcoin_crypto_sse41.a crypto/libbitcoin_crypto_avx2.a crypto/libbitcoin_crypto_shani.a univalue/libunivalue.la leveldb/libleveldb.a crc32c/libcrc32c.a crc32c/libcrc32c_sse42.a   leveldb/libmemenv.a -L/usr/lib/x86_64-linux-gnu -lboost_system -lboost_filesystem -lboost_unit_test_framework secp256k1/libsecp256k1.la -levent -levent_pthreads -levent -ldb_cxx   -lsqlite3  \r\nlibtool: link: /usr/bin/ccache g++ -std=c++17 -fdebug-prefix-map=/bitcoin-core/src=. -fstack-reuse=none -Wstack-protector -fstack-protector-all -fcf-protection=full -fstack-clash-protection -Wall -Wextra -Wformat -Wformat-security -Wvla -Wswitch -Wredundant-decls -Wunused-variable -Wdate-time -Wsign-compare -Wduplicated-branches -Wduplicated-cond -Wlogical-op -Woverloaded-virtual -Wsuggest-override -Wno-unused-parameter -Wno-implicit-fallthrough -Wno-deprecated-copy -fPIE -g -O2 -fno-extended-identifiers -Wl,-z -Wl,relro -Wl,-z -Wl,now -Wl,-z -Wl,separate-code -pie -pthread -o test/test_bitcoin test/test_bitcoin-main.o wallet/test/test_test_bitcoin-wallet_test_fixture.o wallet/test/test_test_bitcoin-init_test_fixture.o test/test_bitcoin-arith_uint256_tests.o test/test_bitcoin-addrman_tests.o test/test_bitcoin-amount_tests.o test/test_bitcoin-allocator_tests.o test/test_bitcoin-base32_tests.o test/test_bitcoin-base58_tests.o test/test_bitcoin-base64_tests.o test/test_bitcoin-bech32_tests.o test/test_bitcoin-bip32_tests.o test/test_bitcoin-blockchain_tests.o test/test_bitcoin-blockencodings_tests.o test/test_bitcoin-blockfilter_tests.o test/test_bitcoin-blockfilter_index_tests.o test/test_bitcoin-bloom_tests.o test/test_bitcoin-bswap_tests.o test/test_bitcoin-checkqueue_tests.o test/test_bitcoin-coins_tests.o test/test_bitcoin-coinstatsindex_tests.o test/test_bitcoin-compilerbug_tests.o test/test_bitcoin-compress_tests.o test/test_bitcoin-crypto_tests.o test/test_bitcoin-cuckoocache_tests.o test/test_bitcoin-denialofservice_tests.o test/test_bitcoin-descriptor_tests.o test/test_bitcoin-flatfile_tests.o test/test_bitcoin-fs_tests.o test/test_bitcoin-getarg_tests.o test/test_bitcoin-hash_tests.o test/test_bitcoin-i2p_tests.o test/test_bitcoin-interfaces_tests.o test/test_bitcoin-key_io_tests.o test/test_bitcoin-key_tests.o test/test_bitcoin-logging_tests.o test/test_bitcoin-dbwrapper_tests.o test/test_bitcoin-validation_tests.o test/test_bitcoin-mempool_tests.o test/test_bitcoin-merkle_tests.o test/test_bitcoin-merkleblock_tests.o test/test_bitcoin-miner_tests.o test/test_bitcoin-multisig_tests.o test/test_bitcoin-net_peer_eviction_tests.o test/test_bitcoin-net_tests.o test/test_bitcoin-netbase_tests.o test/test_bitcoin-pmt_tests.o test/test_bitcoin-policy_fee_tests.o test/test_bitcoin-policyestimator_tests.o test/test_bitcoin-pow_tests.o test/test_bitcoin-prevector_tests.o test/test_bitcoin-raii_event_tests.o test/test_bitcoin-random_tests.o test/test_bitcoin-reverselock_tests.o test/test_bitcoin-rpc_tests.o test/test_bitcoin-sanity_tests.o test/test_bitcoin-scheduler_tests.o test/test_bitcoin-script_p2sh_tests.o test/test_bitcoin-script_tests.o test/test_bitcoin-script_standard_tests.o test/test_bitcoin-scriptnum_tests.o test/test_bitcoin-serfloat_tests.o test/test_bitcoin-serialize_tests.o test/test_bitcoin-settings_tests.o test/test_bitcoin-sighash_tests.o test/test_bitcoin-sigopcount_tests.o test/test_bitcoin-skiplist_tests.o test/test_bitcoin-sock_tests.o test/test_bitcoin-streams_tests.o test/test_bitcoin-sync_tests.o test/test_bitcoin-system_tests.o test/test_bitcoin-util_threadnames_tests.o test/test_bitcoin-timedata_tests.o test/test_bitcoin-torcontrol_tests.o test/test_bitcoin-transaction_tests.o test/test_bitcoin-txindex_tests.o test/test_bitcoin-txrequest_tests.o test/test_bitcoin-txvalidation_tests.o test/test_bitcoin-txvalidationcache_tests.o test/test_bitcoin-uint256_tests.o test/test_bitcoin-util_tests.o test/test_bitcoin-validation_block_tests.o test/test_bitcoin-validation_chainstate_tests.o test/test_bitcoin-validation_chainstatemanager_tests.o test/test_bitcoin-validation_flush_tests.o test/test_bitcoin-validationinterface_tests.o test/test_bitcoin-versionbits_tests.o wallet/test/test_test_bitcoin-psbt_wallet_tests.o wallet/test/test_test_bitcoin-wallet_tests.o wallet/test/test_test_bitcoin-walletdb_tests.o wallet/test/test_test_bitcoin-wallet_crypto_tests.o wallet/test/test_test_bitcoin-coinselector_tests.o wallet/test/test_test_bitcoin-init_tests.o wallet/test/test_test_bitcoin-ismine_tests.o wallet/test/test_test_bitcoin-scriptpubkeyman_tests.o wallet/test/test_test_bitcoin-db_tests.o  -lpthread libtest_util.a libbitcoin_server.a libbitcoin_common.a libbitcoin_util.a crypto/libbitcoin_crypto_base.a libbitcoin_wallet.a libbitcoin_server.a libbitcoin_cli.a libbitcoin_common.a libbitcoin_util.a libbitcoin_consensus.a crypto/libbitcoin_crypto_base.a crypto/libbitcoin_crypto_sse41.a crypto/libbitcoin_crypto_avx2.a crypto/libbitcoin_crypto_shani.a univalue/.libs/libunivalue.a leveldb/libleveldb.a crc32c/libcrc32c.a crc32c/libcrc32c_sse42.a leveldb/libmemenv.a -L/usr/lib/x86_64-linux-gnu -lboost_system -lboost_filesystem -lboost_unit_test_framework secp256k1/.libs/libsecp256k1.a -levent -levent_pthreads -levent -ldb_cxx -lsqlite3 -pthread\r\n/usr/bin/ld: test/test_bitcoin-validation_chainstatemanager_tests.o:././test/util/chainstate.h:19: multiple definition of `NoMalleation'; test/test_bitcoin-validation_chainstate_tests.o:././test/util/chainstate.h:19: first defined here\r\ncollect2: error: ld returned 1 exit status\r\nmake[2]: *** [Makefile:6405: test/test_bitcoin] Error 1\r\nmake[2]: Leaving directory '/bitcoin-core/src'\r\nmake[1]: *** [Makefile:16184: all-recursive] Error 1\r\nmake[1]: Leaving directory '/bitcoin-core/src'\r\nmake: *** [Makefile:824: all-recursive] Error 1\r\n",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-919945778",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "reviewed",
      "id": 755382331,
      "node_id": "PRR_kwDOABII584tBjg7",
      "url": null,
      "actor": null,
      "commit_id": "b3825c27bba2953bf96cfe0f685997e1524ee50c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-755382331",
      "submitted_at": "2021-09-15T17:01:42Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 755386086,
      "node_id": "PRR_kwDOABII584tBkbm",
      "url": null,
      "actor": null,
      "commit_id": "b3825c27bba2953bf96cfe0f685997e1524ee50c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-755386086",
      "submitted_at": "2021-09-15T17:03:26Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 755416072,
      "node_id": "PRR_kwDOABII584tBrwI",
      "url": null,
      "actor": null,
      "commit_id": "ae115458a14b2ec33be25172c3af3ff3a3a777fa",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-755416072",
      "submitted_at": "2021-09-15T17:16:38Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 755422609,
      "node_id": "PRR_kwDOABII584tBtWR",
      "url": null,
      "actor": null,
      "commit_id": "4907b8673a91e762d702e6c3413f29190f0d813b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-755422609",
      "submitted_at": "2021-09-15T17:20:13Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "reviewed",
      "id": 755431993,
      "node_id": "PRR_kwDOABII584tBvo5",
      "url": null,
      "actor": null,
      "commit_id": "529f5055675f6c7f734796a8339761b6c1ba13b9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-755431993",
      "submitted_at": "2021-09-15T17:29:56Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "commented",
      "id": 920266877,
      "node_id": "IC_kwDOABII58422ih9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/920266877",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-15T18:19:22Z",
      "updated_at": "2021-09-15T18:19:22Z",
      "author_association": "MEMBER",
      "body": "> @achow101 did you try clearing ccache? I've found lately that sometimes it's overzealous in caching and can cause problems. If you haven't, give `ccache -C` a try before building.\r\n\r\nStill fails with the same error.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-920266877",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "mentioned",
      "id": 5307749446,
      "node_id": "MEE_lADOABII584yEv9LzwAAAAE8XdRG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5307749446",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-15T18:19:23Z"
    },
    {
      "event": "subscribed",
      "id": 5307749450,
      "node_id": "SE_lADOABII584yEv9LzwAAAAE8XdRK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5307749450",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-15T18:19:23Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2NjUwNzJhMzZkZjJlNGM4ODcwNWZlZGQ0YWM3Yzk1NWQ3ZjZhNDg4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/665072a36df2e4c88705fedd4ac7c955d7f6a488",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/665072a36df2e4c88705fedd4ac7c955d7f6a488",
      "tree": {
        "sha": "6135d1763e4ef79a70fba056e1175fa48a9c6349",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6135d1763e4ef79a70fba056e1175fa48a9c6349"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 6135d1763e4ef79a70fba056e1175fa48a9c6349\nparent ac4051d891e2d5c8ac130da16b85b9d880b44720\nauthor James O'Beirne <james.obeirne@pm.me> 1631735189 -0400\ncommitter James O'Beirne <james.obeirne@pm.me> 1631735189 -0400\n\ndoc: add comment for g_best_block\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmFCTaAACgkQepNdrbLE\nTwXU7g/+MZbCTgFDeQ2zUburP9uIy41tVXzgY/cxHx1EKi1jqJBjVb3QSA+loAPC\nOoolwR6+i8Z1rioSCR91Jx+OLEuDJbLZll/27GBcDMgWUPdjp1eedzE6OiygQdIc\nceSHj1/cIlbuHg+8PQ39RHSNvBf1qFt03NBMKm/S8b0OhYzkRr7bA4RiCT0CGquo\nNAZQF7kiUWi6DydemtgdgAfd8LyZQhLgd7whSrYRtkqgw8ZHR7LSzv/hOLpwE+wC\nyguNs5g987QxJd6Tq0EgG2REfYKm2cQopnyNW9+5xJ6OdahKVuSmckgYXlOAjDpb\n1jWofh+xuVT9jtpXDtdqt9IBjtBPIR+K9wRlWz8njQ0bEwD8YP+FLNuhMsW/J7QD\noHLrlxkPhvsFK/qN8sKoFlokCSZxZhA/p9Oqgu8Y8VIEbXPQfNrU3BZJNO2a83i3\nIr9lAsF5QdJuKbPPwWsp2yDD2mM4LWnMfLQbh1XqSfFEVdJ5o7sEVUE3Ahmqh8rR\nDjU99x8C74soujTmTpLtua6R93aESXbsS8ztWs4w+s2wyuZCs3pmSFxhDtylEw10\nP3UxlI4F/sKT6Pnxe7Uu1flIn6rbOgkMRiVrGHSg7wxdtG9XeaVGXoYkwRHY6NG8\nUehRizhH1m0pSKRAh3ixziyhMvO7dSPSmSKuDPbviW5QfP/wEQI=\n=azlK\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ac4051d891e2d5c8ac130da16b85b9d880b44720",
          "sha": "ac4051d891e2d5c8ac130da16b85b9d880b44720",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ac4051d891e2d5c8ac130da16b85b9d880b44720"
        }
      ],
      "message": "doc: add comment for g_best_block",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-09-15T19:46:29Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-09-15T19:46:29Z"
      },
      "sha": "665072a36df2e4c88705fedd4ac7c955d7f6a488"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiMjE3MDIwZGY3OGJjOTgxZDIyMWZlMDQ0OTdjODMxMTIwZWY5Njlm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b217020df78bc981d221fe04497c831120ef969f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b217020df78bc981d221fe04497c831120ef969f",
      "tree": {
        "sha": "bb258201f8187279c7093cc63d1ef22ecc2f6067",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bb258201f8187279c7093cc63d1ef22ecc2f6067"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree bb258201f8187279c7093cc63d1ef22ecc2f6067\nparent 665072a36df2e4c88705fedd4ac7c955d7f6a488\nauthor James O'Beirne <james.obeirne@gmail.com> 1568665938 -0400\ncommitter James O'Beirne <james.obeirne@pm.me> 1631735203 -0400\n\nvalidation: change UpdateTip for multiple chainstates\n\nOnly perform certain behavior (namely that related to servicing\nthe getblocktemplate RPC call) for the active chainstate when\ncalling UpdateTip.\n\nCo-authored-by: Jon Atack <jon@atack.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmFCTaMACgkQepNdrbLE\nTwWFxBAAofl1y1FJgRAoZmKUmTdvCOd59kcE36c4kercKFXA9feDvYR5PWqn3QGO\n+o35uoLC7aru1CtMJ3HZ3cinsiAolXsEnLuDBxtwBWWZHW5Z3q6+ZQB9D6FXHSt2\nqsLhrb8K+YzLdgeAX0ftcbRGu/L34JKv8q0M0fH+1OyQC5xDJIIFNUmE6fllFUyb\nl8FXSDjJlhsf6I6ekO/S9E0ZiGwo7OuMtRlKfVJUrl6UUSZy376C76d9AWFIrtDE\nSHJ3FFCn2ojuRlSnxsoiRUmbbcbH0FxhVkswJriJUvWfIDd3NqwiOJvedSHzlZri\noBZwJ28dbvndnXfafWq9D/nhmLr2DE+r5hZTfM68dbJ7XKvXMBgJCRFASEtphPM8\n01INIWeqHwSo60bKhgnaqKIG9uZCXzPtVBM/5FT44aijdR6ft8dog1F0nE3x9gO7\nyVlfQegk5w4CT5/Zpc0Oqvl9wq6oqPN8T19FdtcgXRQxAHl9xvHj4ZXa8dCNNU9P\n6dgCmgNc9z0UkZ8TAVwgJZN+NxSKpcx+JX/IR6ssr0o8/sEKnxlgxOiGZpE4oUkI\nmJcm21HtSXBkdfyZIMFNXnpN6c1ae2B3DmNAd422L77CoTAhwM3N+cjN4bNzT9Sc\n+f8crRCrBPYsx4UMFLl1PYb1CHVEww48GhbIe+iizxiyH2+ZATE=\n=jRTy\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/665072a36df2e4c88705fedd4ac7c955d7f6a488",
          "sha": "665072a36df2e4c88705fedd4ac7c955d7f6a488",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/665072a36df2e4c88705fedd4ac7c955d7f6a488"
        }
      ],
      "message": "validation: change UpdateTip for multiple chainstates\n\nOnly perform certain behavior (namely that related to servicing\nthe getblocktemplate RPC call) for the active chainstate when\ncalling UpdateTip.\n\nCo-authored-by: Jon Atack <jon@atack.com>",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-09-15T19:46:43Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@gmail.com",
        "date": "2019-09-16T20:32:18Z"
      },
      "sha": "b217020df78bc981d221fe04497c831120ef969f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0MmIyNTIwZGI5M2ZkOWZlYjNkZjQxMDE2NTQzOTFmYTdkM2UyMTQw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/42b2520db93fd9feb3df4101654391fa7d3e2140",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/42b2520db93fd9feb3df4101654391fa7d3e2140",
      "tree": {
        "sha": "4d5be14ead20a661b656b098b91393edd609522a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4d5be14ead20a661b656b098b91393edd609522a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 4d5be14ead20a661b656b098b91393edd609522a\nparent b217020df78bc981d221fe04497c831120ef969f\nauthor James O'Beirne <james.obeirne@pm.me> 1626888674 -0400\ncommitter James O'Beirne <james.obeirne@pm.me> 1631735204 -0400\n\nchain: add BLOCK_ASSUMED_VALID for use with assumeutxo\n\nInstead of (ab)using the existing BLOCK_VALID_* flags to mark CBlockIndex entries which\nwe haven't yet fully validated (but assume validity for use with UTXO snapshot\nloading), introduce a status flag that specifically marks an assumed-valid state.\n\nThis state is then removed in RaiseValidity() when the block has actually been\nvalidated.\n\nThis distinction will allow us to make the necessary changes to various parts of the\nsystem to facilitate assumeutxo/background chainstate validation but without leaking\ndetails like snapshot height, as we had done previously.\n\nChanges that actually make use of this flag follow in future commits.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmFCTaQACgkQepNdrbLE\nTwWyPg//QGOXbPuStTblcHPyep1rRaa1SfXL885l64+zE/LYVLupyPim0lJUPs1/\nyxmiP7K55hnHudWuEYLTWIoeEboMSTfOT6mN9A1WbP4t5tDmDQWoFCFXpsROZDfD\ncfMFD43GkXHr2MvxMDdWI+nQXeeHYp35JS8rW+OxEfiZdpbbRGvAP5rLZcWtl1ws\nLN8fWT13j5OZsq/ZyJ0wlH17EkSX4zVsVs/P1WH+r4MpKdBv7LSM5U+hdQS/3Kia\nejctH0rVPkJ7yko4gS3WiKnWJNPcf9rKoMd5wq7TbJroMFH9ptG5AY3LgF/9Hv9D\nJ50NrL9GTzYuT7kLX/wUT9YRs97WzdTRTIuCoIXGsonwZbepyplo9xbllV1Gq5bx\n/1NIvFkQCG9ClrkBh3zZ/iOsAn+he2fJs3g+oZU0mCIFtP1Q8wjESFP5rim+kPIv\nycYcXIQwKhiSx8eYGinP5IiUTnleuH2RAjhRfsqqdYBueqiT0MWu4F9inv6SB+5E\ngJ2sJIEUPI83U8XlJ2PxejOIjQeTfo0rxxjAw6iQdR83aSe/SnyZxddzoj77UY+4\n6ok5Wj4tfvvIgS47HoDQRr/UkVefmSZIrTqCbSlzpmjlEavGQP7wrO/Fr4X/5FSL\n9B5uDEZf18zrfOdJwInwxOdtCe5CCdZ0vY11HKgG9iqxSMH89A0=\n=9amo\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b217020df78bc981d221fe04497c831120ef969f",
          "sha": "b217020df78bc981d221fe04497c831120ef969f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b217020df78bc981d221fe04497c831120ef969f"
        }
      ],
      "message": "chain: add BLOCK_ASSUMED_VALID for use with assumeutxo\n\nInstead of (ab)using the existing BLOCK_VALID_* flags to mark CBlockIndex entries which\nwe haven't yet fully validated (but assume validity for use with UTXO snapshot\nloading), introduce a status flag that specifically marks an assumed-valid state.\n\nThis state is then removed in RaiseValidity() when the block has actually been\nvalidated.\n\nThis distinction will allow us to make the necessary changes to various parts of the\nsystem to facilitate assumeutxo/background chainstate validation but without leaking\ndetails like snapshot height, as we had done previously.\n\nChanges that actually make use of this flag follow in future commits.",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-09-15T19:46:44Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-07-21T17:31:14Z"
      },
      "sha": "42b2520db93fd9feb3df4101654391fa7d3e2140"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzowMWE5YjhmZTcxOWVmYWIyYzI2OGRjNzM4YmM5M2NmYmRmOTJlZGI3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/01a9b8fe719efab2c268dc738bc93cfbdf92edb7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/01a9b8fe719efab2c268dc738bc93cfbdf92edb7",
      "tree": {
        "sha": "6e742087c1e217472c3c78142829434a1b03a719",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6e742087c1e217472c3c78142829434a1b03a719"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 6e742087c1e217472c3c78142829434a1b03a719\nparent 42b2520db93fd9feb3df4101654391fa7d3e2140\nauthor James O'Beirne <james.obeirne@pm.me> 1626890894 -0400\ncommitter James O'Beirne <james.obeirne@pm.me> 1631735205 -0400\n\nvalidation: set BLOCK_ASSUMED_VALID during snapshot load\n\nMark the block index entries that are beneath the snapshot base block as\nassumed-valid.  Subsequent commits will make use of this flag in other\nparts of the system.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmFCTaUACgkQepNdrbLE\nTwUP2A/9GY04qNfjCMcurd4sPECpGFaMkpAKc2I0AAt+ht7syTQ+2iYj+aJFdsch\naAKpeSyWFhIO42CQlHXUCBLpyyEfjNKs2y+EwDHsJJoP/OHcP7pOeuqWeE19OV49\ny6LYEM1vrLBD1yliRZD2lghMtFYw5Eo3vYYrdEqumwp2IfJ1jOGFycD37BL2sVr/\n07/aNG2GB13+6ylO7cwIpzVwICmOOuuU7S8moocjC4T930/QL5/hBpI4Omn0agPG\niT+xoH1nJAlnDhcBjHUbaw+uHWCHSsa0e8pRHWoX4jYMUXcOGPblSW2lAw/M8DrE\nF8GxjuTrxS6DCrZehJqxq7K8S5aSy29ociiRfWmAouvxmISrXAYMXiQCRlL2o5T1\nqWUPNHhqNGhfzi1ElTJZ5dfEpscepDQ3hmDfYlzbwwYaMAwDzqHd/jUbnTLq+8IU\nsBorhbUdeNUYbMiwJamWm2xorQYYwH+9/FutepzuPc0dWQEOpehtnT5crDJhU8XM\nO5d8Q7SvdZMsnnLqd6YTVEEEALKd36CZ4wW6mt7ZgbOOWt5s2UW6DDjoC+dWi5Uo\nWxlljgL5dNon1yjlmW0NZP1WuW/hSkFXcvk5jR/m3y80+IY+lMOL3shYTK5YGZ5c\ngujOIJyLhcS13RqWiXbMcV/Ji66J6x8e88ztZM1fZsAAtZ3CP0E=\n=vYyO\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/42b2520db93fd9feb3df4101654391fa7d3e2140",
          "sha": "42b2520db93fd9feb3df4101654391fa7d3e2140",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/42b2520db93fd9feb3df4101654391fa7d3e2140"
        }
      ],
      "message": "validation: set BLOCK_ASSUMED_VALID during snapshot load\n\nMark the block index entries that are beneath the snapshot base block as\nassumed-valid.  Subsequent commits will make use of this flag in other\nparts of the system.",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-09-15T19:46:45Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-07-21T18:08:14Z"
      },
      "sha": "01a9b8fe719efab2c268dc738bc93cfbdf92edb7"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1YTgwNzczNmRhY2ZjM2U2ZmE1NzIzMTIxOTMzNmFjZjA4YmUzOGZi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5a807736dacfc3e6fa57231219336acf08be38fb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5a807736dacfc3e6fa57231219336acf08be38fb",
      "tree": {
        "sha": "75033e48de3138a4b97a0214d5491cd7104541fb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/75033e48de3138a4b97a0214d5491cd7104541fb"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 75033e48de3138a4b97a0214d5491cd7104541fb\nparent 01a9b8fe719efab2c268dc738bc93cfbdf92edb7\nauthor James O'Beirne <james.obeirne@pm.me> 1626891213 -0400\ncommitter James O'Beirne <james.obeirne@pm.me> 1631735206 -0400\n\nvalidation: insert assumed-valid block index entries into candidates\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmFCTaYACgkQepNdrbLE\nTwVHJQ//WoSREUKKaqy8izNszP2amh8dA/ZTinr7jEn/YeGSxsloQ1tgBvNk2XUL\ne3IUOKchSjK8F0M6CxiA9VWg1DmXiBYetFmORR81KKpjSWREFaP8EKrJ/l/747r3\n4Bop4kQxflJvVAIbke12pXAvIH4rtwmXjmqKOWf1zLqzpcjf0shutaK7kUAH1O8p\nCa7ffU44UO1GhcemK7hmmPBsrbmp+Ej1XL+qRWiFIFIpQXu7D30dP+owPSe/EIcb\nvutDrlDYh7r7osqUH1Fex7b1hHe3TxA5F/YEt2cBmqyL0fbWHqUF9nEgZ8fWDxCE\n4vmBjHkRWWurGVb2/1NGJ6HP2xFIOp5MA9I5KrZwfTzvm4mnS3goiQlfV+S9wcX+\np9pSz2+GauuMJ3YCH3Ofj05v8yFLk6GezW1QOJxo5FfiVNubwIB8t9DMs4FVmNAf\nCTV4jXn9SyPEfrjkPDktZ4ISDQJ73TYOfPxq3Au/Qwv/+yRCiKwSR17k3PDE/fVu\nSsscK5OaeB0dmP45wQAMB2O1wymSRxxLAgml40zzfPUgI9xfwSIbWNIMdxRDIFXc\nT1x6RNwhvNJ9efFGACiy9H7OGLlCkIS3eMFZV3CUDn1DS4rBGF4KU4QrecqCU3Os\nkNlzoziap9dhS7uBJF5Dpl14QgEaGSH10JF0Bp7h9SLHWaCNnhk=\n=UPOw\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/01a9b8fe719efab2c268dc738bc93cfbdf92edb7",
          "sha": "01a9b8fe719efab2c268dc738bc93cfbdf92edb7",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/01a9b8fe719efab2c268dc738bc93cfbdf92edb7"
        }
      ],
      "message": "validation: insert assumed-valid block index entries into candidates",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-09-15T19:46:46Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-07-21T18:13:33Z"
      },
      "sha": "5a807736dacfc3e6fa57231219336acf08be38fb"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4ZjU3MTBmZDBhYzUxNzNiNTc3ZTVkMDA3MDg0ODUxNzBiMzIxYmNj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8f5710fd0ac5173b577e5d00708485170b321bcc",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8f5710fd0ac5173b577e5d00708485170b321bcc",
      "tree": {
        "sha": "866a7f19473d499354bfc375c08d0b9c150f0461",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/866a7f19473d499354bfc375c08d0b9c150f0461"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 866a7f19473d499354bfc375c08d0b9c150f0461\nparent 5a807736dacfc3e6fa57231219336acf08be38fb\nauthor James O'Beirne <james.obeirne@pm.me> 1617890648 -0400\ncommitter James O'Beirne <james.obeirne@pm.me> 1631735207 -0400\n\nvalidation: fix CheckBlockIndex for multiple chainstates\n\nAdjust CheckBlockIndex to account for\n- assumed-valid block indexes lacking transaction data, and\n- setBlockIndexCandidates for the background chainstate not containing certain entries\n  which rely on assumed-valid ancestors.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmFCTacACgkQepNdrbLE\nTwWOGhAAjBLUDAKe36M3P2xQz4HIpFMci25Q425+Izy5eHGvxlKi9unlFvZipdtk\nzAW/o0iTWsVN/gjm7IZUsp76iEnIbCCGcuVi1nWo49GntaPyAgmgmp+oKdRm2Q7M\ntuvWdjgdY3ZH0YmCqqRphOnFwQ/UZuvXJFk0J8V7fFYuKQx5W+160NUO6ERuq8aD\nSL9R52cLWxicV5Awvls/kP33h8sFoET3Ffyl6Rd+9Tio5NH5tpQEmOWxtd0O/ShB\nA4xRgShx2iuQLrmHWwsv6MpJ6xN+ckMQ6USnSv6hoc20TjpGLMQkX79bcVUksLU9\n3oNJf/uiSIymp/Y2uLl8V2z5IQSOUQnnsCMUTXhM9d4PzdcRGOTzf6ScJOfGpb7v\nOut/gHIgQBcj20ulk+iOARhmMMiyXwe3oCv2wFxlVGPx0BOquc8r6Y2G+KVLUG/e\nT/dZeA4tHQ07CJO58jxl9rIQAoTp0r5Mwl9A6ZocV4dk1C+qu1TQM/QfJt1+rJ/6\ntrSMIc40rqKvMLYcDQbKI2woJ8GBoSCjxS0rSki98N4G38bXyWnfSwdULahldNXj\njFQYtFw30FF07Oukuqo6PJUMWDf6oZg7iW0Gb3kbI02f3cbKRm/Vhz99zpMQ2NjA\n5vBBj/io1h1twwoyXQg0K/DXkjAFPG5R/a4AKv2lcpk/760ze9Q=\n=PcIV\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5a807736dacfc3e6fa57231219336acf08be38fb",
          "sha": "5a807736dacfc3e6fa57231219336acf08be38fb",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5a807736dacfc3e6fa57231219336acf08be38fb"
        }
      ],
      "message": "validation: fix CheckBlockIndex for multiple chainstates\n\nAdjust CheckBlockIndex to account for\n- assumed-valid block indexes lacking transaction data, and\n- setBlockIndexCandidates for the background chainstate not containing certain entries\n  which rely on assumed-valid ancestors.",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-09-15T19:46:47Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-04-08T14:04:08Z"
      },
      "sha": "8f5710fd0ac5173b577e5d00708485170b321bcc"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzowNzEyMDA5OTNmM2E5NDEyODIxY2U1Mzg3ODUxZDY1OWJhZjg1MzI3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/071200993f3a9412821ce5387851d659baf85327",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/071200993f3a9412821ce5387851d659baf85327",
      "tree": {
        "sha": "64b05b8cbcc6f366a1d258516e7b3e89732baba8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/64b05b8cbcc6f366a1d258516e7b3e89732baba8"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 64b05b8cbcc6f366a1d258516e7b3e89732baba8\nparent 8f5710fd0ac5173b577e5d00708485170b321bcc\nauthor James O'Beirne <james.obeirne@pm.me> 1617810482 -0400\ncommitter James O'Beirne <james.obeirne@pm.me> 1631735208 -0400\n\nmove-only: unittest: add test/util/chainstate.h\n\nand move `CreateAndActivateUTXOSnapshot()` into it for reuse\nin future test modules.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmFCTagACgkQepNdrbLE\nTwXsKQ/7BbSdtCDmFwWG9jHBgINvNENPfIIbD7w16prEc7rpwLilNd98th4MMgmt\nOSqYoC6nzOVflsBGbiASRneWGl3132L40Sry3R1/beUfpkdseTEeu+2Q7TH7gXZS\nY+HK6jRsyc8TaFYHg+rnBcLavGNgQ7REzhWNmoxJg+GzRvintGhD2l8hFPriSdYk\nML8lo5nJME6tEMtcGUZnevbBMTLa93W1BscuGM0gXIDxri04ATsBktXvgsThDdU7\n+AskvJP0UfTUStqPbPqF9MSOuVH1m6l2lz3xGWi00iNT2tg+TpWkixzA00haDuCJ\nMBN9yf6KD9xcppJBkpvB8l16uesYhYgZBnG5839chb8A/kqtsJYuBJhAbWIovKqr\nxtkpxPwsLKIbVJ7fidpysmNOxdkxZupbPAYHO65s0D5/6k9qqLe6hc+wAKirUHoO\n8pYhGz7EQkog0l3B175ZT/5bkEVnC3ITzkHp25SmFENlSioAQU6o6gq1YF7M0Qg3\n+k2zcci9Hii0rZfGxRrphV4kl4TGHgWQs1of73Kap4jMEVmvMVFWFU633gdXkQxs\nWgK59MPp+KKpKQbXAKBVMU12Ml8YCWDD/dd4aeQOb/zePCD9Mgj6wfCSdXro5Xpq\nYkrOkTjxNvm9nmorHpS3ZwM5GtpzYsaGf+Y/SZd3qAwBwab6wNA=\n=KiEK\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8f5710fd0ac5173b577e5d00708485170b321bcc",
          "sha": "8f5710fd0ac5173b577e5d00708485170b321bcc",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8f5710fd0ac5173b577e5d00708485170b321bcc"
        }
      ],
      "message": "move-only: unittest: add test/util/chainstate.h\n\nand move `CreateAndActivateUTXOSnapshot()` into it for reuse\nin future test modules.",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-09-15T19:46:48Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-04-07T15:48:02Z"
      },
      "sha": "071200993f3a9412821ce5387851d659baf85327"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyOThiZjVkNTYzY2M3NDBjNmFlNzE3NTBkODY5NDJlMDI3OGIyMmQ2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/298bf5d563cc740c6ae71750d86942e0278b22d6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/298bf5d563cc740c6ae71750d86942e0278b22d6",
      "tree": {
        "sha": "062b64fd44f90e9980412c1a9d3dca88703d2e6e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/062b64fd44f90e9980412c1a9d3dca88703d2e6e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 062b64fd44f90e9980412c1a9d3dca88703d2e6e\nparent 071200993f3a9412821ce5387851d659baf85327\nauthor James O'Beirne <james.obeirne@pm.me> 1631734780 -0400\ncommitter James O'Beirne <james.obeirne@pm.me> 1631735209 -0400\n\ntest: refactor: declare NoMalleation const auto\n\nTo avoid linker error on some platforms:\n    https://github.com/bitcoin/bitcoin/pull/21526#discussion_r709404714\n\nCo-authored-by: Russ Yanofsky <russ@yanofsky.org>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmFCTakACgkQepNdrbLE\nTwVaQhAAmicVcXMUydjYNRsj7WHkCKI+gsal3oQVcUoIFkpO5XwugkAV6uOC+YEE\nk5BGG2/WEGZWHu1GvYFQyPvg1YWbrMCj3BJNOxCSLhrBoi7qj8uuaha7Hik6egUc\n2Tq+vNp1zzH1kg/ZCmAb0IrtR5pBZJPRDQkt6kiZoxVbMvjTO59cf/B9wf3oBjRx\nCjoA9MTrTdAifPklkkVHh4wdJGOZh1PIQlCMpSFtKU7gdcQ2DI0O2ncNapUREn+i\n0o+dzW3d7aOTbpgsVQwwsWojVaNoYd2RucEmeGUXHoB8/p02vegen8nCvD3nzLH1\nlGwjTtx0H0YnzG85s3sRv3kNTMcqQRoaaDaAMIxE+fkyZ6QMkpADMkpCiMqtPg8b\noW+V/c5KObjY+OB0usGgN/SQpivfA86FlvKQi90rcTf6DzPGsPRiErKZFSdhMdW8\nJ+C1Psmjh9P1ihYXOT6UVYvg2KLwgB6gUSVxfkCe+ZDmvNR2lsSU35V6U7bKFZT4\nBUYgPSU79U+iGJxFTkZcmmgGGkoAfqnnKhe60px7HeiQ/De9QvAKaWz+S81YPJfT\nRtQOGTb6BEDxFxPb74/jl+X3MyAoIbPts2e14+sveLxxppdvwcAq+kLbY7DPtRmy\nVMx0+NgSbeSHz9Bh9Gdwmx1Gc5r8xG1S9KqRXGqv9CYZ816lwUw=\n=kMP7\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/071200993f3a9412821ce5387851d659baf85327",
          "sha": "071200993f3a9412821ce5387851d659baf85327",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/071200993f3a9412821ce5387851d659baf85327"
        }
      ],
      "message": "test: refactor: declare NoMalleation const auto\n\nTo avoid linker error on some platforms:\n    https://github.com/bitcoin/bitcoin/pull/21526#discussion_r709404714\n\nCo-authored-by: Russ Yanofsky <russ@yanofsky.org>",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-09-15T19:46:49Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-09-15T19:39:40Z"
      },
      "sha": "298bf5d563cc740c6ae71750d86942e0278b22d6"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyNzA1NTcwMTA5YTJhOTBlY2ZkM2Y0MTgwOTQ0NDk4NjI2ZmMyNzA3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2705570109a2a90ecfd3f4180944498626fc2707",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/2705570109a2a90ecfd3f4180944498626fc2707",
      "tree": {
        "sha": "71c89732897c6ba16873d5401d4c6afac6518bcb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/71c89732897c6ba16873d5401d4c6afac6518bcb"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 71c89732897c6ba16873d5401d4c6afac6518bcb\nparent 298bf5d563cc740c6ae71750d86942e0278b22d6\nauthor James O'Beirne <james.obeirne@pm.me> 1617890770 -0400\ncommitter James O'Beirne <james.obeirne@pm.me> 1631735210 -0400\n\ntest: refactor: separate CreateBlock in TestChain100Setup\n\nThis is so we can create blocks within unittests and have them\nbe processed by specific chainstates (instead of the just the\nactive one).\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmFCTaoACgkQepNdrbLE\nTwVUNA/+Nt5hQiio2hpdaMcOc67Y9csPjvEiPLDh1ZfCsLXrlN21VRNFyk3CQY+b\nFfCrHqrJvBlXu6oJuD5YVnWqlkFNTv0izxI7FCcVyqXOB/MQZfq8C1g6eSfG2Bkn\nZttoZwqjcIhDrJEBQfutGASIMW7NdNncvIaqKtPtRKk/LbxjBcZgfGLLgTHkV/iI\nZUYFwRlnyRc0TRP+BnceVKAG73Ot7OT1NqqiFjhq8HVigKw4vpJz3HXlc0r6RJKW\ng/e+naU7RBMsPbQCNAyjMuzXsqTvpdP4ghBkFk55tzPoU1NoJnVZUalVyzBpmsxs\nm6NNNw2ESqep+L9OULodQSXMzZrMq5mYVp/HsPI8MLo3Fdljye6uaX5MvWfdI86o\n+Xo58+fbaXWm17Iu8GdlYqjojLhETLYr4TtqnckfkAms/n2OSaN1MAqvzR9K2zuJ\n2bdIWAl8lqqo93w69YAx/qA+lh/GSnEXB5XN/+iyCeX/bIf+W4m4k/e59GB9uMb9\nI1ezScqcMbDflFyhqA6RMe/ucGPhBT7EJoz99q/3MRX5Yr87SwJBl+IM2iJGeSDv\n+rCFuQxPvaShxiGPWddtg+KSbYjZs7/Ei/JXLmyOobWJqTHwjON3O6dY+dv+HPMb\n1uORmzjdqXKCZq0jRNqseFO3/AK1bElWe9HM1qVY90efZ3yz4V4=\n=G2ez\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/298bf5d563cc740c6ae71750d86942e0278b22d6",
          "sha": "298bf5d563cc740c6ae71750d86942e0278b22d6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/298bf5d563cc740c6ae71750d86942e0278b22d6"
        }
      ],
      "message": "test: refactor: separate CreateBlock in TestChain100Setup\n\nThis is so we can create blocks within unittests and have them\nbe processed by specific chainstates (instead of the just the\nactive one).",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-09-15T19:46:50Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-04-08T14:06:10Z"
      },
      "sha": "2705570109a2a90ecfd3f4180944498626fc2707"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2NzNhNWJkMzM3NzkyOWEwYTZhNjJlZGE4YjU2MGU0N2JjMmNjYTBj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "tree": {
        "sha": "fc6d0769f3a370c62c83c4faca3a7659d4d4ec1b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fc6d0769f3a370c62c83c4faca3a7659d4d4ec1b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree fc6d0769f3a370c62c83c4faca3a7659d4d4ec1b\nparent 2705570109a2a90ecfd3f4180944498626fc2707\nauthor James O'Beirne <james.obeirne@pm.me> 1617890878 -0400\ncommitter James O'Beirne <james.obeirne@pm.me> 1631735211 -0400\n\ntest: validation: add unittest for UpdateTip behavior\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmFCTasACgkQepNdrbLE\nTwWeDg/9F4+4k6pJgyI+XDViSqyZ6N/BRZTL3gOhrSMMUXHJ42aLXf35o3lpDqxn\n4nLKakuFdO/MzvKkCQL8QAdeVogb87LrK2rwnAZsY0MYSMChh25jaHNioV1xGnBH\nGh8R1Q7HL0EzqmVc4irlW6cqCKT5qGTu91zAHd+xhZGWjAovqysgyWbhyTOsmCee\nzjN0+Z1hx1edQHv60GqnIC76ad9vjFAwiWkSv4ooXDzL0u/r3/K2bqvBeXPkflgQ\nxfNnGFnLe5F7WysszBUvbbpwDG2jUGFKDXf9jW5CayKmacHxyv+gWhHxIFKVehc+\nLcwHkdPNk/mN0EaSu+mEcOp1V6W6lsc+7F+4iwGRvGdfl4pPq7hQieVnIM30Cy6i\nFJKjltOIQBOo6fLMgPrpDA/A9t3aDANlu/lN77Tv/dxU0YbCDq7ZLvG1dAipXD8p\n1PQJh+WPBjKRn2btLHFAE8KLKPLXO/ZuDW+91rSF9VZ3UqVNruj3HZ+3MduleQIb\nQFb0vSDD4+jGijgm6BRni5ST2uWEBjcmTMGUph3jTjX3TuxTsSzGjRDg9Ff/VcCB\n6u2hR9sY36KlJK5IRKuI70HzZeGBIjFQYrgiAAoMo+igis6Uh1my4hD7ryQjXttR\nmopcJgECt7qCelHKf1pBvqjX7ueOWvPjk2IT+rMCxQnP5wa0a7o=\n=3jCq\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2705570109a2a90ecfd3f4180944498626fc2707",
          "sha": "2705570109a2a90ecfd3f4180944498626fc2707",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2705570109a2a90ecfd3f4180944498626fc2707"
        }
      ],
      "message": "test: validation: add unittest for UpdateTip behavior",
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-09-15T19:46:51Z"
      },
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-04-08T14:07:58Z"
      },
      "sha": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5308200584,
      "node_id": "HRFPE_lADOABII584yEv9LzwAAAAE8ZLaI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5308200584",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-15T19:47:38Z"
    },
    {
      "event": "commented",
      "id": 920439219,
      "node_id": "IC_kwDOABII58423Mmz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/920439219",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-15T22:44:03Z",
      "updated_at": "2021-09-15T22:44:03Z",
      "author_association": "MEMBER",
      "body": "ACK 673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-920439219",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "commented",
      "id": 921064563,
      "node_id": "IC_kwDOABII58425lRz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/921064563",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-16T16:46:57Z",
      "updated_at": "2021-09-16T16:46:57Z",
      "author_association": "MEMBER",
      "body": "Okay, thanks everyone for bearing with the build issues. I think I've addressed all feedback here; in the latest change I've\r\n- made the `auto` -> `const auto` change (thanks again @ryanofsky), and\r\n- moved the `g_best_block` documentation change into its own commit (thanks @JeremyRubin).\r\n\r\nI think this is in good shape pending some reACKs.\r\n",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-921064563",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "mentioned",
      "id": 5313873715,
      "node_id": "MEE_lADOABII584yEv9LzwAAAAE8u0cz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5313873715",
      "actor": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-16T16:46:58Z"
    },
    {
      "event": "subscribed",
      "id": 5313873718,
      "node_id": "SE_lADOABII584yEv9LzwAAAAE8u0c2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5313873718",
      "actor": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-16T16:46:58Z"
    },
    {
      "event": "mentioned",
      "id": 5313873731,
      "node_id": "MEE_lADOABII584yEv9LzwAAAAE8u0dD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5313873731",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-16T16:46:58Z"
    },
    {
      "event": "subscribed",
      "id": 5313873735,
      "node_id": "SE_lADOABII584yEv9LzwAAAAE8u0dH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5313873735",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-16T16:46:58Z"
    },
    {
      "event": "commented",
      "id": 921075442,
      "node_id": "IC_kwDOABII58425n7y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/921075442",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-16T17:02:46Z",
      "updated_at": "2021-09-16T19:08:05Z",
      "author_association": "MEMBER",
      "body": "@jamesob in case it's accidental, just noticed one commit (b217020df78b) has a different email for you than the others.\r\n\r\nCode-review re-ACK 673a5bd3377929a0a6a62eda8b560e47bc2cca0c reviewed diff, rebased to master/debug build/ran unit+functional tests",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-921075442",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "mentioned",
      "id": 5313953019,
      "node_id": "MEE_lADOABII584yEv9LzwAAAAE8vHz7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5313953019",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-16T17:02:46Z"
    },
    {
      "event": "subscribed",
      "id": 5313953024,
      "node_id": "SE_lADOABII584yEv9LzwAAAAE8vH0A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5313953024",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-16T17:02:46Z"
    },
    {
      "event": "reviewed",
      "id": 756622037,
      "node_id": "PRR_kwDOABII584tGSLV",
      "url": null,
      "actor": null,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK 673a5bd3377929a0a6a62eda8b560e47bc2cca0c. Just linker fix and split commit changes mentioned https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-921064563 since last review",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-756622037",
      "submitted_at": "2021-09-16T18:08:48Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "commented",
      "id": 921622921,
      "node_id": "IC_kwDOABII58427tmJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/921622921",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-17T08:48:36Z",
      "updated_at": "2021-09-17T08:48:36Z",
      "author_association": "MEMBER",
      "body": "ACK 673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-921622921",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "reviewed",
      "id": 758097978,
      "node_id": "PRR_kwDOABII584tL6g6",
      "url": null,
      "actor": null,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "user": {
        "login": "benthecarman",
        "id": 15256660,
        "node_id": "MDQ6VXNlcjE1MjU2NjYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benthecarman",
        "html_url": "https://github.com/benthecarman",
        "followers_url": "https://api.github.com/users/benthecarman/followers",
        "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
        "organizations_url": "https://api.github.com/users/benthecarman/orgs",
        "repos_url": "https://api.github.com/users/benthecarman/repos",
        "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benthecarman/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-758097978",
      "submitted_at": "2021-09-18T23:23:05Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "commented",
      "id": 922529364,
      "node_id": "IC_kwDOABII5842_K5U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/922529364",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-19T20:10:00Z",
      "updated_at": "2021-09-19T20:10:00Z",
      "author_association": "MEMBER",
      "body": "Code review ACK 673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-922529364",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "commented",
      "id": 922558754,
      "node_id": "IC_kwDOABII5842_SEi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/922558754",
      "actor": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-19T23:56:52Z",
      "updated_at": "2021-09-19T23:56:52Z",
      "author_association": "MEMBER",
      "body": "utACK 673a5bd3",
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-922558754",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "commented",
      "id": 924970076,
      "node_id": "IC_kwDOABII5843Iexc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/924970076",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-22T14:11:11Z",
      "updated_at": "2021-09-22T14:11:11Z",
      "author_association": "MEMBER",
      "body": "Anything holding this up for merge at this point?",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-924970076",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21526"
    },
    {
      "event": "merged",
      "id": 5352245384,
      "node_id": "ME_lADOABII584yEv9LzwAAAAE_BMiI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5352245384",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "b7e360081506cc646dd86f131df2d01f3c544f0e",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b7e360081506cc646dd86f131df2d01f3c544f0e",
      "created_at": "2021-09-23T20:22:36Z"
    },
    {
      "event": "closed",
      "id": 5352245406,
      "node_id": "CE_lADOABII584yEv9LzwAAAAE_BMie",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5352245406",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-23T20:22:36Z"
    },
    {
      "event": "referenced",
      "id": 5353306146,
      "node_id": "REFE_lADOABII584yEv9LzwAAAAE_FPgi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5353306146",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "41eedca916cdc1b7abd8c48464e8e7486a95949f",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/41eedca916cdc1b7abd8c48464e8e7486a95949f",
      "created_at": "2021-09-24T01:48:53Z"
    },
    {
      "event": "referenced",
      "id": 5353820309,
      "node_id": "REFE_lADOABII584yEv9LzwAAAAE_HNCV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5353820309",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "f3f027fc88db2076be6b510859c083a9914d1bb0",
      "commit_url": "https://api.github.com/repos/fanquake/bitcoin/commits/f3f027fc88db2076be6b510859c083a9914d1bb0",
      "created_at": "2021-09-24T05:14:42Z"
    },
    {
      "event": "reviewed",
      "id": 763006038,
      "node_id": "PRR_kwDOABII584teoxW",
      "url": null,
      "actor": null,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#pullrequestreview-763006038",
      "submitted_at": "2021-09-24T12:50:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
    },
    {
      "event": "removed_from_project",
      "id": 5365735204,
      "node_id": "RFPE_lADOABII584yEv9LzwAAAAE_0p8k",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5365735204",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-27T13:45:01Z",
      "project_card": {
        "id": 61992625,
        "url": "https://api.github.com/projects/columns/cards/61992625",
        "project_id": 481835,
        "project_url": "https://api.github.com/projects/481835",
        "column_name": "Blockers"
      }
    },
    {
      "event": "moved_columns_in_project",
      "id": 5440328046,
      "node_id": "MCIPE_lADOABII584yEv9LzwAAAAFERNFu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5440328046",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-11T02:15:53Z",
      "project_card": {
        "id": 57634819,
        "url": "https://api.github.com/projects/columns/cards/57634819",
        "project_id": 2564674,
        "project_url": "https://api.github.com/projects/2564674",
        "column_name": "Done",
        "previous_column_name": "In progress"
      }
    },
    {
      "event": "referenced",
      "id": 5459468721,
      "node_id": "REFE_lADOABII584yEv9LzwAAAAFFaOGx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5459468721",
      "actor": {
        "login": "rebroad",
        "id": 1530283,
        "node_id": "MDQ6VXNlcjE1MzAyODM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1530283?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rebroad",
        "html_url": "https://github.com/rebroad",
        "followers_url": "https://api.github.com/users/rebroad/followers",
        "following_url": "https://api.github.com/users/rebroad/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rebroad/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rebroad/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
        "organizations_url": "https://api.github.com/users/rebroad/orgs",
        "repos_url": "https://api.github.com/users/rebroad/repos",
        "events_url": "https://api.github.com/users/rebroad/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rebroad/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "2f9c0f2acfd828dc24fc2a5089bc08573cc8a841",
      "commit_url": "https://api.github.com/repos/rebroad/bitcoin/commits/2f9c0f2acfd828dc24fc2a5089bc08573cc8a841",
      "created_at": "2021-10-13T19:42:27Z"
    },
    {
      "event": "referenced",
      "id": 5561408344,
      "node_id": "REFE_lADOABII584yEv9LzwAAAAFLfFtY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5561408344",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "23ae7931be50376fa6bda692c641a3d2538556ee",
      "commit_url": "https://api.github.com/repos/bitcoin-core/gui/commits/23ae7931be50376fa6bda692c641a3d2538556ee",
      "created_at": "2021-11-03T12:03:14Z"
    },
    {
      "event": "referenced",
      "id": 5602536932,
      "node_id": "REFE_lADOABII584yEv9LzwAAAAFN7-3k",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5602536932",
      "actor": {
        "login": "janus",
        "id": 6726,
        "node_id": "MDQ6VXNlcjY3MjY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6726?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janus",
        "html_url": "https://github.com/janus",
        "followers_url": "https://api.github.com/users/janus/followers",
        "following_url": "https://api.github.com/users/janus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janus/subscriptions",
        "organizations_url": "https://api.github.com/users/janus/orgs",
        "repos_url": "https://api.github.com/users/janus/repos",
        "events_url": "https://api.github.com/users/janus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "4c0f1d6b836cbf61fe077774e6054ee8553c3fb7",
      "commit_url": "https://api.github.com/repos/BitgesellOfficial/bitgesell/commits/4c0f1d6b836cbf61fe077774e6054ee8553c3fb7",
      "created_at": "2021-11-11T09:29:50Z"
    },
    {
      "event": "referenced",
      "id": 7603080336,
      "node_id": "REFE_lADOABII584yEv9LzwAAAAHFLcyQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7603080336",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "bd99c7d928bc0dfc4fc38c6d6024c035ab03613a",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/bd99c7d928bc0dfc4fc38c6d6024c035ab03613a",
      "created_at": "2022-10-17T14:53:54Z"
    },
    {
      "event": "referenced",
      "id": 7603080353,
      "node_id": "REFE_lADOABII584yEv9LzwAAAAHFLcyh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7603080353",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "08dd1b2dffd16b248d00820e74fdaebe2abb457d",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/08dd1b2dffd16b248d00820e74fdaebe2abb457d",
      "created_at": "2022-10-17T14:53:54Z"
    },
    {
      "event": "referenced",
      "id": 7603080369,
      "node_id": "REFE_lADOABII584yEv9LzwAAAAHFLcyx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7603080369",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "954fc7392543cd9354a66c631d501e17dca93ca6",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/954fc7392543cd9354a66c631d501e17dca93ca6",
      "created_at": "2022-10-17T14:53:54Z"
    },
    {
      "event": "referenced",
      "id": 7620671812,
      "node_id": "REFE_lADOABII584yEv9LzwAAAAHGOjlE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7620671812",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "7db9e191cda0e5b9353e471a1b004b73ae248798",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/7db9e191cda0e5b9353e471a1b004b73ae248798",
      "created_at": "2022-10-19T11:39:35Z"
    },
    {
      "event": "referenced",
      "id": 7620671818,
      "node_id": "REFE_lADOABII584yEv9LzwAAAAHGOjlK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7620671818",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "a1093fa5f579ea9bb1963638475ebe9e204aad00",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/a1093fa5f579ea9bb1963638475ebe9e204aad00",
      "created_at": "2022-10-19T11:39:35Z"
    },
    {
      "event": "locked",
      "id": 7699632418,
      "node_id": "LOE_lADOABII584yEv9LzwAAAAHK7xEi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7699632418",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-30T19:10:10Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615054872",
      "pull_request_review_id": 637995324,
      "id": 615054872,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTA1NDg3Mg==",
      "diff_hunk": "@@ -4821,11 +4823,27 @@ void CChainState::CheckBlockIndex(const Consensus::Params& consensusParams)\n \n     // Build forward-pointing map of the entire block tree.\n     std::multimap<CBlockIndex*,CBlockIndex*> forward;\n-    for (const std::pair<const uint256, CBlockIndex*>& entry : m_blockman.m_block_index) {\n-        forward.insert(std::make_pair(entry.second->pprev, entry.second));\n-    }\n \n-    assert(forward.size() == m_blockman.m_block_index.size());\n+    if (is_active_chain) {\n+        for (const std::pair<const uint256, CBlockIndex*>& entry : m_blockman.m_block_index) {\n+            forward.insert(std::make_pair(entry.second->pprev, entry.second));\n+        }\n+\n+        assert(forward.size() == m_blockman.m_block_index.size());\n+    } else {\n+        // For the background validation chainstate, don't consider the full block tree -\n+        // only consider headers on the IBD chain. Otherwise, we will fail assertions\n+        // related to `setBlockIndexCandidates` below, which corresponds to this subset of\n+        // the block tree for this chainstate.",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 28,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "d3cec2a5b3febd091b8002e39f8b7431b7e99c4a",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"validation: fix CheckBlockIndex for multiple chainstates\" (d3cec2a5b3febd091b8002e39f8b7431b7e99c4a)\r\n\r\nThis is ok, but it seems to avoid other checks below besides the `setBlockIndexCandidates` checks. And if more checks are added below in the future they could be bypassed unnecessarily. I wonder if it might be more straightforward and futureproof just to add `&& is_active_chain` or `|| !is_active_chain` to the specific assertions below which are failing instead of pruning branches off this tree.",
      "created_at": "2021-04-16T18:43:24Z",
      "updated_at": "2021-04-23T18:36:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r615054872",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615054872"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": 4834,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 4686,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615063212",
      "pull_request_review_id": 637995324,
      "id": 615063212,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTA2MzIxMg==",
      "diff_hunk": "@@ -117,9 +117,20 @@ struct TestChain100Setup : public RegTestingSetup {\n     /**\n      * Create a new block with just given transactions, coinbase paying to\n      * scriptPubKey, and try to add it to the current chain.\n+     * If no chainstate is specified, default to the active.\n      */\n     CBlock CreateAndProcessBlock(const std::vector<CMutableTransaction>& txns,\n-                                 const CScript& scriptPubKey);\n+                                 const CScript& scriptPubKey,\n+                                 CChainState* chainstate = nullptr);\n+\n+    /**\n+     * Create a new block with just given transactions, coinbase paying to\n+     * scriptPubKey. If no chainstate is specified, default to the active.\n+     */\n+    CBlock CreateBlock(\n+        const std::vector<CMutableTransaction>& txns,\n+        const CScript& scriptPubKey,\n+        CChainState* chainstate = nullptr);",
      "path": "src/test/util/setup_common.h",
      "position": null,
      "original_position": 18,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "6e5871c0c7b7d7b27b56df4f2c0705921025a6d5",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"test: refactor: separate CreateBlock in TestChain100Setup\" (6e5871c0c7b7d7b27b56df4f2c0705921025a6d5)\r\n\r\nIMO, it is reasonable for `CreateAndProcessBlock` to have a default-active chainstate pointer for backwards compatibility, but it might be better for this new `CreateBlock` method to take an explicit `CChainState&` reference for more clarity in test code and to prevent mistakes forgetting to specify it.",
      "created_at": "2021-04-16T18:59:01Z",
      "updated_at": "2021-04-23T18:36:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r615063212",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615063212"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 135,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615074725",
      "pull_request_review_id": 637995324,
      "id": 615074725,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTA3NDcyNQ==",
      "diff_hunk": "@@ -72,4 +75,66 @@ BOOST_AUTO_TEST_CASE(validation_chainstate_resize_caches)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test UpdateTip behavior for both active and background chainstates.\n+//!\n+//! When run on the background chainstate, UpdateTip should do a subset\n+//! of what it does for the active chainstate.\n+BOOST_FIXTURE_TEST_CASE(chainstate_update_tip, TestChain100Setup)\n+{\n+    ChainstateManager& chainman = *Assert(m_node.chainman);\n+    uint256 curr_tip = ::g_best_block;\n+\n+    // Mine 10 more blocks, putting at us height 110 where a valid assumeutxo value can\n+    // be found.\n+    mineBlocks(10);\n+\n+    // After adding some blocks to the tip, best block should have changed.\n+    BOOST_CHECK(::g_best_block != curr_tip);\n+\n+    BOOST_REQUIRE(CreateAndActivateUTXOSnapshot(m_node, m_path_root));\n+\n+    // Ensure our active chain is the snapshot chainstate.\n+    BOOST_CHECK(chainman.IsSnapshotActive());\n+\n+    curr_tip = ::g_best_block;\n+\n+    // Mine a new block on top of the activated snapshot chainstate.\n+    mineBlocks(1);  // Defined in TestChain100Setup.\n+\n+    // After adding some blocks to the snapshot tip, best block should have changed.\n+    BOOST_CHECK(::g_best_block != curr_tip);\n+\n+    curr_tip = ::g_best_block;\n+\n+    CChainState& background_cs = m_node.chainman->ValidatedChainstate();\n+    BOOST_CHECK(m_node.chainman->IsBackgroundIBD(&background_cs));\n+\n+    // Create a block to append to the validation chain.\n+    std::vector<CMutableTransaction> noTxns;\n+    CScript scriptPubKey = CScript() << ToByteVector(coinbaseKey.GetPubKey()) << OP_CHECKSIG;\n+    CBlock validation_block = this->CreateBlock(noTxns, scriptPubKey, &background_cs);\n+    auto pblock = std::make_shared<const CBlock>(validation_block);\n+    BlockValidationState state;\n+    CBlockIndex* pindex = nullptr;\n+    const CChainParams& chainparams = Params();\n+    bool newblock = false;\n+\n+    // TODO: much of this is inlined from ProcessNewBlock(); just reuse PNB()\n+    // once it is changed to support multiple chainstates.\n+    {\n+        LOCK(::cs_main);\n+        bool checked = CheckBlock(*pblock, state, chainparams.GetConsensus());\n+        BOOST_CHECK(checked);\n+        bool accepted = background_cs.AcceptBlock(\n+            pblock, state, chainparams, &pindex, true, nullptr, &newblock);\n+        BOOST_CHECK(accepted);\n+    }\n+    bool block_added = background_cs.ActivateBestChain(state, chainparams, pblock);",
      "path": "src/test/validation_chainstate_tests.cpp",
      "position": null,
      "original_position": 73,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "3f1346a0178afef20db3599cc545dbc54200d635",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"test: validation: add unittest for UpdateTip behavior\" (3f1346a0178afef20db3599cc545dbc54200d635)\r\n\r\nSince this test is designed to check `UpdateTip` background behavior, but the test doesn't call `UpdateTip` directly, it may be good to add a comment saying this line is what calls `UpdateTip`.\r\n\r\nAlso could maybe a simple check could be added here to verify the new background tip hash?\r\n\r\nAlso curious if there's an existing test (or a planned one) to cover the background chain catching up to the activated snapshot.",
      "created_at": "2021-04-16T19:21:47Z",
      "updated_at": "2021-04-23T18:36:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r615074725",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615074725"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 133,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/619424621",
      "pull_request_review_id": 643569615,
      "id": 619424621,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxOTQyNDYyMQ==",
      "diff_hunk": "@@ -4821,11 +4823,27 @@ void CChainState::CheckBlockIndex(const Consensus::Params& consensusParams)\n \n     // Build forward-pointing map of the entire block tree.\n     std::multimap<CBlockIndex*,CBlockIndex*> forward;\n-    for (const std::pair<const uint256, CBlockIndex*>& entry : m_blockman.m_block_index) {\n-        forward.insert(std::make_pair(entry.second->pprev, entry.second));\n-    }\n \n-    assert(forward.size() == m_blockman.m_block_index.size());\n+    if (is_active_chain) {\n+        for (const std::pair<const uint256, CBlockIndex*>& entry : m_blockman.m_block_index) {\n+            forward.insert(std::make_pair(entry.second->pprev, entry.second));\n+        }\n+\n+        assert(forward.size() == m_blockman.m_block_index.size());\n+    } else {\n+        // For the background validation chainstate, don't consider the full block tree -\n+        // only consider headers on the IBD chain. Otherwise, we will fail assertions\n+        // related to `setBlockIndexCandidates` below, which corresponds to this subset of\n+        // the block tree for this chainstate.",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 28,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "d3cec2a5b3febd091b8002e39f8b7431b7e99c4a",
      "in_reply_to_id": 615054872,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good call, fixed.",
      "created_at": "2021-04-23T18:36:51Z",
      "updated_at": "2021-04-23T18:36:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r619424621",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/619424621"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": 4834,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 4686,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/619424718",
      "pull_request_review_id": 643569705,
      "id": 619424718,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxOTQyNDcxOA==",
      "diff_hunk": "@@ -117,9 +117,20 @@ struct TestChain100Setup : public RegTestingSetup {\n     /**\n      * Create a new block with just given transactions, coinbase paying to\n      * scriptPubKey, and try to add it to the current chain.\n+     * If no chainstate is specified, default to the active.\n      */\n     CBlock CreateAndProcessBlock(const std::vector<CMutableTransaction>& txns,\n-                                 const CScript& scriptPubKey);\n+                                 const CScript& scriptPubKey,\n+                                 CChainState* chainstate = nullptr);\n+\n+    /**\n+     * Create a new block with just given transactions, coinbase paying to\n+     * scriptPubKey. If no chainstate is specified, default to the active.\n+     */\n+    CBlock CreateBlock(\n+        const std::vector<CMutableTransaction>& txns,\n+        const CScript& scriptPubKey,\n+        CChainState* chainstate = nullptr);",
      "path": "src/test/util/setup_common.h",
      "position": null,
      "original_position": 18,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "6e5871c0c7b7d7b27b56df4f2c0705921025a6d5",
      "in_reply_to_id": 615063212,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed.",
      "created_at": "2021-04-23T18:36:58Z",
      "updated_at": "2021-04-23T18:36:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r619424718",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/619424718"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 135,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/619425233",
      "pull_request_review_id": 643570275,
      "id": 619425233,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxOTQyNTIzMw==",
      "diff_hunk": "@@ -72,4 +75,66 @@ BOOST_AUTO_TEST_CASE(validation_chainstate_resize_caches)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test UpdateTip behavior for both active and background chainstates.\n+//!\n+//! When run on the background chainstate, UpdateTip should do a subset\n+//! of what it does for the active chainstate.\n+BOOST_FIXTURE_TEST_CASE(chainstate_update_tip, TestChain100Setup)\n+{\n+    ChainstateManager& chainman = *Assert(m_node.chainman);\n+    uint256 curr_tip = ::g_best_block;\n+\n+    // Mine 10 more blocks, putting at us height 110 where a valid assumeutxo value can\n+    // be found.\n+    mineBlocks(10);\n+\n+    // After adding some blocks to the tip, best block should have changed.\n+    BOOST_CHECK(::g_best_block != curr_tip);\n+\n+    BOOST_REQUIRE(CreateAndActivateUTXOSnapshot(m_node, m_path_root));\n+\n+    // Ensure our active chain is the snapshot chainstate.\n+    BOOST_CHECK(chainman.IsSnapshotActive());\n+\n+    curr_tip = ::g_best_block;\n+\n+    // Mine a new block on top of the activated snapshot chainstate.\n+    mineBlocks(1);  // Defined in TestChain100Setup.\n+\n+    // After adding some blocks to the snapshot tip, best block should have changed.\n+    BOOST_CHECK(::g_best_block != curr_tip);\n+\n+    curr_tip = ::g_best_block;\n+\n+    CChainState& background_cs = m_node.chainman->ValidatedChainstate();\n+    BOOST_CHECK(m_node.chainman->IsBackgroundIBD(&background_cs));\n+\n+    // Create a block to append to the validation chain.\n+    std::vector<CMutableTransaction> noTxns;\n+    CScript scriptPubKey = CScript() << ToByteVector(coinbaseKey.GetPubKey()) << OP_CHECKSIG;\n+    CBlock validation_block = this->CreateBlock(noTxns, scriptPubKey, &background_cs);\n+    auto pblock = std::make_shared<const CBlock>(validation_block);\n+    BlockValidationState state;\n+    CBlockIndex* pindex = nullptr;\n+    const CChainParams& chainparams = Params();\n+    bool newblock = false;\n+\n+    // TODO: much of this is inlined from ProcessNewBlock(); just reuse PNB()\n+    // once it is changed to support multiple chainstates.\n+    {\n+        LOCK(::cs_main);\n+        bool checked = CheckBlock(*pblock, state, chainparams.GetConsensus());\n+        BOOST_CHECK(checked);\n+        bool accepted = background_cs.AcceptBlock(\n+            pblock, state, chainparams, &pindex, true, nullptr, &newblock);\n+        BOOST_CHECK(accepted);\n+    }\n+    bool block_added = background_cs.ActivateBestChain(state, chainparams, pblock);",
      "path": "src/test/validation_chainstate_tests.cpp",
      "position": null,
      "original_position": 73,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "3f1346a0178afef20db3599cc545dbc54200d635",
      "in_reply_to_id": 615074725,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done. \r\n\r\n> Also curious if there's an existing test (or a planned one) to cover the background chain catching up to the activated snapshot.\r\n\r\nYes; I'll look at writing a test for this sometime today in addition to some chainstate-concurrency torture tests.",
      "created_at": "2021-04-23T18:37:48Z",
      "updated_at": "2021-04-23T18:37:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r619425233",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/619425233"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 133,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/625442975",
      "pull_request_review_id": 650813361,
      "id": 625442975,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNTQ0Mjk3NQ==",
      "diff_hunk": "@@ -234,21 +234,38 @@ void TestChain100Setup::mineBlocks(int num_blocks)\n     }\n }\n \n-CBlock TestChain100Setup::CreateAndProcessBlock(const std::vector<CMutableTransaction>& txns, const CScript& scriptPubKey)\n+CBlock TestChain100Setup::CreateBlock(\n+    const std::vector<CMutableTransaction>& txns,\n+    const CScript& scriptPubKey,\n+    CChainState* chainstate)",
      "path": "src/test/util/setup_common.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "6d5d09634ac354c16c298c83d7b699b2147a98b3",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"test: refactor: separate CreateBlock in TestChain100Setup\" (6d5d09634ac354c16c298c83d7b699b2147a98b3)\r\n\r\nWould be nice to make the last argument a `CChainState&` reference instead of a pointer since it isn't allowed to be null (and it's a new method so there's no backward compatility concern)",
      "created_at": "2021-05-04T00:16:15Z",
      "updated_at": "2021-05-04T00:30:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r625442975",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/625442975"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 243,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/626767940",
      "pull_request_review_id": 652577266,
      "id": 626767940,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNjc2Nzk0MA==",
      "diff_hunk": "@@ -2321,8 +2355,7 @@ static void UpdateTip(CTxMemPool& mempool, const CBlockIndex* pindexNew, const C\n     }\n \n     bilingual_str warning_messages;\n-    assert(std::addressof(::ChainstateActive()) == std::addressof(active_chainstate));",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 51,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "23c2d26d424e5a8b523f7210653958eff10db0f2",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "23c2d26d424e5a8b523f7210653958eff10db0f2: given the above `return`, you don't have to drop this assert",
      "created_at": "2021-05-05T17:36:33Z",
      "updated_at": "2021-05-05T18:18:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r626767940",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/626767940"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2288,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/626774638",
      "pull_request_review_id": 652577266,
      "id": 626774638,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNjc3NDYzOA==",
      "diff_hunk": "@@ -2307,10 +2307,44 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n     res += warn;\n }\n \n-/** Check warning conditions and do some notifications on new chain tip set. */\n-static void UpdateTip(CTxMemPool& mempool, const CBlockIndex* pindexNew, const CChainParams& chainParams, CChainState& active_chainstate)\n+/** Check warning conditions and do some notifications on new chain tip set.\n+ *\n+ * Only perform certain functions when the active chainstate is passed, e.g.\n+ * notifying getblocktemplate RPC of a new block (`g_best_block` and\n+ * `mempool.AddTransactionsUpdated`). Doing this for the background\n+ * chainstate would cause incorrect behavior.\n+ */\n+static void UpdateTip(CTxMemPool& mempool, const CBlockIndex* pindexNew, const CChainParams& chainParams, CChainState& chainstate)\n     EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\n {\n+    auto& func_name = __func__;\n+    auto& coins_view = chainstate.CoinsTip();\n+    auto log_progress = [pindexNew, &func_name, &coins_view, &chainParams](",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "23c2d26d424e5a8b523f7210653958eff10db0f2",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```\r\nvalidation.cpp:2321:38: warning: lambda capture 'func_name' is not required to be captured for this use [-Wunused-lambda-capture]\r\n    auto log_progress = [pindexNew, &func_name, &coins_view, &chainParams](\r\n                                  ~~~^~~~~~~~~\r\n1 warning generated.\r\n```",
      "created_at": "2021-05-05T17:46:46Z",
      "updated_at": "2021-05-05T18:18:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r626774638",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/626774638"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2251,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/626791045",
      "pull_request_review_id": 652577266,
      "id": 626791045,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNjc5MTA0NQ==",
      "diff_hunk": "@@ -116,7 +116,6 @@ std::unique_ptr<CBlockTemplate> BlockAssembler::CreateNewBlock(const CScript& sc\n     pblocktemplate->vTxSigOpsCost.push_back(-1); // updated at end\n \n     LOCK2(cs_main, m_mempool.cs);\n-    assert(std::addressof(*::ChainActive().Tip()) == std::addressof(*m_chainstate.m_chain.Tip()));",
      "path": "src/miner.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "23b5ebd02e584c7bb982ccbc28bbabd927b9c57e",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "23b5ebd02e584c7bb982ccbc28bbabd927b9c57e  why would `CreateNewBlock` ever be called on the background chainstate?",
      "created_at": "2021-05-05T18:11:11Z",
      "updated_at": "2021-05-05T18:18:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r626791045",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/626791045"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 127,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/626792949",
      "pull_request_review_id": 652577266,
      "id": 626792949,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNjc5Mjk0OQ==",
      "diff_hunk": "@@ -635,7 +635,6 @@ void CTxMemPool::check(CChainState& active_chainstate) const\n     uint64_t innerUsage = 0;\n \n     CCoinsViewCache& active_coins_tip = active_chainstate.CoinsTip();\n-    assert(std::addressof(::ChainstateActive().CoinsTip()) == std::addressof(active_coins_tip)); // TODO: REVIEW-ONLY, REMOVE IN FUTURE COMMIT",
      "path": "src/txmempool.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "23b5ebd02e584c7bb982ccbc28bbabd927b9c57e",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "23b5ebd02e584c7bb982ccbc28bbabd927b9c57e: I thought the background chain didn't have a mempool? Or it had a dummy mempool. I guess it's fine to remove this assert though.",
      "created_at": "2021-05-05T18:14:08Z",
      "updated_at": "2021-05-05T18:18:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r626792949",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/626792949"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 641,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/627181867",
      "pull_request_review_id": 653088362,
      "id": 627181867,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNzE4MTg2Nw==",
      "diff_hunk": "@@ -2307,10 +2307,44 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n     res += warn;\n }\n \n-/** Check warning conditions and do some notifications on new chain tip set. */\n-static void UpdateTip(CTxMemPool& mempool, const CBlockIndex* pindexNew, const CChainParams& chainParams, CChainState& active_chainstate)\n+/** Check warning conditions and do some notifications on new chain tip set.\n+ *\n+ * Only perform certain functions when the active chainstate is passed, e.g.\n+ * notifying getblocktemplate RPC of a new block (`g_best_block` and\n+ * `mempool.AddTransactionsUpdated`). Doing this for the background\n+ * chainstate would cause incorrect behavior.\n+ */\n+static void UpdateTip(CTxMemPool& mempool, const CBlockIndex* pindexNew, const CChainParams& chainParams, CChainState& chainstate)\n     EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\n {\n+    auto& func_name = __func__;\n+    auto& coins_view = chainstate.CoinsTip();\n+    auto log_progress = [pindexNew, &func_name, &coins_view, &chainParams](",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "23c2d26d424e5a8b523f7210653958eff10db0f2",
      "in_reply_to_id": 626774638,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fails CI when addressing this warning.",
      "created_at": "2021-05-06T08:14:00Z",
      "updated_at": "2021-05-06T08:14:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r627181867",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/627181867"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2251,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/627182208",
      "pull_request_review_id": 653088826,
      "id": 627182208,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNzE4MjIwOA==",
      "diff_hunk": "@@ -116,7 +116,6 @@ std::unique_ptr<CBlockTemplate> BlockAssembler::CreateNewBlock(const CScript& sc\n     pblocktemplate->vTxSigOpsCost.push_back(-1); // updated at end\n \n     LOCK2(cs_main, m_mempool.cs);\n-    assert(std::addressof(*::ChainActive().Tip()) == std::addressof(*m_chainstate.m_chain.Tip()));",
      "path": "src/miner.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "23b5ebd02e584c7bb982ccbc28bbabd927b9c57e",
      "in_reply_to_id": 626791045,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Gets called during unittests.",
      "created_at": "2021-05-06T08:14:26Z",
      "updated_at": "2021-05-06T08:14:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r627182208",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/627182208"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 127,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/627182479",
      "pull_request_review_id": 653089206,
      "id": 627182479,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNzE4MjQ3OQ==",
      "diff_hunk": "@@ -635,7 +635,6 @@ void CTxMemPool::check(CChainState& active_chainstate) const\n     uint64_t innerUsage = 0;\n \n     CCoinsViewCache& active_coins_tip = active_chainstate.CoinsTip();\n-    assert(std::addressof(::ChainstateActive().CoinsTip()) == std::addressof(active_coins_tip)); // TODO: REVIEW-ONLY, REMOVE IN FUTURE COMMIT",
      "path": "src/txmempool.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "23b5ebd02e584c7bb982ccbc28bbabd927b9c57e",
      "in_reply_to_id": 626792949,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Same as above; called during unittests.",
      "created_at": "2021-05-06T08:14:47Z",
      "updated_at": "2021-05-06T08:14:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r627182479",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/627182479"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 641,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/627241697",
      "pull_request_review_id": 653189189,
      "id": 627241697,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNzI0MTY5Nw==",
      "diff_hunk": "@@ -116,7 +116,6 @@ std::unique_ptr<CBlockTemplate> BlockAssembler::CreateNewBlock(const CScript& sc\n     pblocktemplate->vTxSigOpsCost.push_back(-1); // updated at end\n \n     LOCK2(cs_main, m_mempool.cs);\n-    assert(std::addressof(*::ChainActive().Tip()) == std::addressof(*m_chainstate.m_chain.Tip()));",
      "path": "src/miner.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "23b5ebd02e584c7bb982ccbc28bbabd927b9c57e",
      "in_reply_to_id": 626791045,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "But why?",
      "created_at": "2021-05-06T09:18:27Z",
      "updated_at": "2021-05-06T09:18:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r627241697",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/627241697"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 127,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/631230573",
      "pull_request_review_id": 658151566,
      "id": 631230573,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMTIzMDU3Mw==",
      "diff_hunk": "@@ -116,7 +116,6 @@ std::unique_ptr<CBlockTemplate> BlockAssembler::CreateNewBlock(const CScript& sc\n     pblocktemplate->vTxSigOpsCost.push_back(-1); // updated at end\n \n     LOCK2(cs_main, m_mempool.cs);\n-    assert(std::addressof(*::ChainActive().Tip()) == std::addressof(*m_chainstate.m_chain.Tip()));",
      "path": "src/miner.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "23b5ebd02e584c7bb982ccbc28bbabd927b9c57e",
      "in_reply_to_id": 626791045,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Because (unlike in actual snapshot usage) we don't have pre-prepared snapshots to use from within unittests, we have to use the same chainstate objects that we ultimately test on to generate snapshots for use during the test. As a result, the background validation chainstate is already at the snapshot base block, so in order to test appending to the bg chainstate, we have to call `CreateNewBlock` with it.\r\n\r\nWhile I agree this usage isn't realistic, we don't have great alternatives within tests. I guess another option would involve using a temporary chainstate to generate the snapshot and then loading it into a new chainstatemanager object, but that sounds even hairier than what we're doing here, and much more code.",
      "created_at": "2021-05-12T17:01:08Z",
      "updated_at": "2021-05-12T17:01:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r631230573",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/631230573"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 127,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655399169",
      "pull_request_review_id": 688453572,
      "id": 655399169,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTM5OTE2OQ==",
      "diff_hunk": "@@ -4375,8 +4379,11 @@ void CChainState::CheckBlockIndex(const Consensus::Params& consensusParams)\n     while (pindex != nullptr) {\n         nNodes++;\n         if (pindexFirstInvalid == nullptr && pindex->nStatus & BLOCK_FAILED_VALID) pindexFirstInvalid = pindex;\n-        if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n-        if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n+        // Don't start being rigorous about missing block data if we're within a utxo snapshot",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "0dd5757fd7c5b1d151abe45843711780a4b3885b",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"validation: fix CheckBlockIndex for multiple chainstates\" (0dd5757fd7c5b1d151abe45843711780a4b3885b)\r\n\r\nCommit message could be updated. It's still only referring to setBlockIndexCandidates checks, but commit was later extended to skip more checks https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-863579751",
      "created_at": "2021-06-21T13:55:55Z",
      "updated_at": "2021-06-21T15:47:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r655399169",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655399169"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4352,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655484970",
      "pull_request_review_id": 688453572,
      "id": 655484970,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTQ4NDk3MA==",
      "diff_hunk": "@@ -1024,6 +1024,12 @@ class ChainstateManager\n     //! ResizeCoinsCaches() as needed.\n     void MaybeRebalanceCaches() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\n \n+    //! @returns height at which the active UTXO snapshot was taken, if applicable.\n+    std::optional<CBlockIndex*> GetSnapshotBaseBlock() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);",
      "path": "src/validation.h",
      "position": null,
      "original_position": 5,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "0dd5757fd7c5b1d151abe45843711780a4b3885b",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"validation: fix CheckBlockIndex for multiple chainstates\" (0dd5757fd7c5b1d151abe45843711780a4b3885b)\r\n\r\nNot very important since this function is only called one place, but it seems like it would be nicer to just return `CBlockIndex*` instead of `std::optional<CBlockIndex*>`. This way callers don't need to double-dereference, and can just check whether this is null or not null, instead having to check for three states (`nullopt`, `nullptr`, or block), or having to ignore the `nullptr` case (which I assume is not currently possible)",
      "created_at": "2021-06-21T15:28:13Z",
      "updated_at": "2021-06-21T15:47:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r655484970",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655484970"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1032,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655490762",
      "pull_request_review_id": 688453572,
      "id": 655490762,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTQ5MDc2Mg==",
      "diff_hunk": "@@ -234,21 +234,38 @@ void TestChain100Setup::mineBlocks(int num_blocks)\n     }\n }\n \n-CBlock TestChain100Setup::CreateAndProcessBlock(const std::vector<CMutableTransaction>& txns, const CScript& scriptPubKey)\n+CBlock TestChain100Setup::CreateBlock(\n+    const std::vector<CMutableTransaction>& txns,\n+    const CScript& scriptPubKey,\n+    CChainState* chainstate)",
      "path": "src/test/util/setup_common.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "6d5d09634ac354c16c298c83d7b699b2147a98b3",
      "in_reply_to_id": 625442975,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"test: refactor: separate CreateBlock in TestChain100Setup\" (e061837697ed8ebf8d5443478829b48f3fe0e8db)\r\n\r\n> Would be nice to make the last argument a `CChainState&` reference instead of a pointer since it isn't allowed to be null (and it's a new method so there's no backward compatility concern)\r\n\r\n(This is still applicable, in case the PR gets another update)",
      "created_at": "2021-06-21T15:35:01Z",
      "updated_at": "2021-06-21T15:47:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r655490762",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655490762"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 243,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/658163708",
      "pull_request_review_id": 692059584,
      "id": 658163708,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1ODE2MzcwOA==",
      "diff_hunk": "@@ -2245,7 +2284,7 @@ static void UpdateTip(CTxMemPool& mempool, const CBlockIndex* pindexNew, const C\n     }\n \n     bilingual_str warning_messages;\n-    if (!active_chainstate.IsInitialBlockDownload()) {\n+    if (!chainstate.IsInitialBlockDownload()) {",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b6dffada18bf874c619d17baf9df45346e52b871",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "IIUC this log warns node operator about new consensus rules activated through the BIP9 logic. In case of the assumed-utxo-set being dated after either the locked-in or activation, your foreground validation is going to be blinded and your background validation is going to skim over this warning ? Thus you might have a client not fully-validating the chain, or at least with a set of consensus rules you might be interested with.\r\n\r\nI don't think this is impossible in case of contentious softfork locked-in, for e.g a minor release with activation logic feature-gated by a node operator setting followed by a major release with a newer hardcoded assumed-utxo ?",
      "created_at": "2021-06-24T17:53:25Z",
      "updated_at": "2021-06-24T18:17:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r658163708",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/658163708"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2287,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/658173137",
      "pull_request_review_id": 692059584,
      "id": 658173137,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1ODE3MzEzNw==",
      "diff_hunk": "@@ -4341,8 +4379,11 @@ void CChainState::CheckBlockIndex(const Consensus::Params& consensusParams)\n     while (pindex != nullptr) {\n         nNodes++;\n         if (pindexFirstInvalid == nullptr && pindex->nStatus & BLOCK_FAILED_VALID) pindexFirstInvalid = pindex;\n-        if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n-        if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n+        // Don't start being rigorous about missing block data if we're within a utxo snapshot\n+        if (pindex->nHeight > snapshot_height) {\n+            if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n+            if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n+        }",
      "path": "src/validation.cpp",
      "position": 94,
      "original_position": 114,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b6dffada18bf874c619d17baf9df45346e52b871",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Once the background validation has catched up with the snapshot_height, is `GetSnapshotHeight` going to return `std::nullopt` and those checks play out ?",
      "created_at": "2021-06-24T18:06:45Z",
      "updated_at": "2021-06-24T18:17:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r658173137",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/658173137"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4361,
      "original_line": 4361,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/658175063",
      "pull_request_review_id": 692059584,
      "id": 658175063,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1ODE3NTA2Mw==",
      "diff_hunk": "@@ -4357,7 +4398,7 @@ void CChainState::CheckBlockIndex(const Consensus::Params& consensusParams)\n         if (!pindex->HaveTxsDownloaded()) assert(pindex->nSequenceId <= 0); // nSequenceId can't be set positive for blocks that aren't linked (negative is used for preciousblock)\n         // VALID_TRANSACTIONS is equivalent to nTx > 0 for all nodes (whether or not pruning has occurred).\n         // HAVE_DATA is only equivalent to nTx > 0 (or VALID_TRANSACTIONS) if no pruning has occurred.\n-        if (!fHavePruned) {\n+        if (!fHavePruned && (pindex->nHeight > snapshot_height)) {",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 123,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b6dffada18bf874c619d17baf9df45346e52b871",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: \"// Don't start being rigorous about missing block data if we've never pruned and we're within a utxo snapshot\" ?",
      "created_at": "2021-06-24T18:09:41Z",
      "updated_at": "2021-06-24T18:17:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r658175063",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/658175063"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4371,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/658175967",
      "pull_request_review_id": 692059584,
      "id": 658175967,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1ODE3NTk2Nw==",
      "diff_hunk": "@@ -1014,6 +1024,12 @@ class ChainstateManager\n     //! ResizeCoinsCaches() as needed.\n     void MaybeRebalanceCaches() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\n \n+    //! @returns height at which the active UTXO snapshot was taken, if applicable.",
      "path": "src/validation.h",
      "position": null,
      "original_position": 30,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b6dffada18bf874c619d17baf9df45346e52b871",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: s/height/block metadata/g ?",
      "created_at": "2021-06-24T18:11:03Z",
      "updated_at": "2021-06-24T18:17:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r658175967",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/658175967"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1027,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/658198383",
      "pull_request_review_id": 692109753,
      "id": 658198383,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1ODE5ODM4Mw==",
      "diff_hunk": "@@ -2245,7 +2284,7 @@ static void UpdateTip(CTxMemPool& mempool, const CBlockIndex* pindexNew, const C\n     }\n \n     bilingual_str warning_messages;\n-    if (!active_chainstate.IsInitialBlockDownload()) {\n+    if (!chainstate.IsInitialBlockDownload()) {",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b6dffada18bf874c619d17baf9df45346e52b871",
      "in_reply_to_id": 658163708,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/21526#discussion_r658163708\r\n\r\n> IIUC this log warns node operator about new consensus rules activated through the BIP9 logic. In case of the assumed-utxo-set being dated after either the locked-in or activation, your foreground validation is going to be blinded and your background validation is going to skim over this warning ?\r\n\r\nI don't think this is a change because the warning is skipped anyway in IBD. So loading a snapshot doesn't skip this warning because it would be skipped anyway. Loading a snapshot just makes the node more usable while blocks are still being downloaded.",
      "created_at": "2021-06-24T18:45:41Z",
      "updated_at": "2021-06-24T18:45:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r658198383",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/658198383"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2287,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/662628271",
      "pull_request_review_id": 697700181,
      "id": 662628271,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjYyODI3MQ==",
      "diff_hunk": "@@ -2245,7 +2284,7 @@ static void UpdateTip(CTxMemPool& mempool, const CBlockIndex* pindexNew, const C\n     }\n \n     bilingual_str warning_messages;\n-    if (!active_chainstate.IsInitialBlockDownload()) {\n+    if (!chainstate.IsInitialBlockDownload()) {",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b6dffada18bf874c619d17baf9df45346e52b871",
      "in_reply_to_id": 658163708,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I agree it's not a change, my point is more about how assume-utxo is breaking the notion of a sequential IBD and introducing out-of-order validation which might invite us to reconsider the design purpose of such warning.\r\n\r\n`IsInitialBlockDownload`'s last check relies on our chain tip being older than DEFAULT_MAX_TIP_AGE (24h) and i think that's a reasonable assumption than hardcoded assumed-utxo will be always older than 24h. So background chainstate is always going to be considered as IBD, and such warning skipped, without giving a _chance_ to flag out during foreground chainstate processing if it did start after the locked-in period, and let user react in consequence. For e.g, stop a Bitcoin merchant stopping trade, or increasing number of required confs during softforks activation, if it's a contentious one.\r\n\r\nThough I concede, it's tangential to this PR and belong more to a wider discussion on how assume-utxo is interacting with softfork deployments.",
      "created_at": "2021-07-01T22:31:59Z",
      "updated_at": "2021-07-01T22:57:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r662628271",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/662628271"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2287,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671481714",
      "pull_request_review_id": 708692580,
      "id": 671481714,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTQ4MTcxNA==",
      "diff_hunk": "@@ -1014,6 +1024,12 @@ class ChainstateManager\n     //! ResizeCoinsCaches() as needed.\n     void MaybeRebalanceCaches() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\n \n+    //! @returns height at which the active UTXO snapshot was taken, if applicable.",
      "path": "src/validation.h",
      "position": null,
      "original_position": 30,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b6dffada18bf874c619d17baf9df45346e52b871",
      "in_reply_to_id": 658175967,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed, thanks!",
      "created_at": "2021-07-16T19:30:54Z",
      "updated_at": "2021-07-16T19:30:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r671481714",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671481714"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1027,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671490286",
      "pull_request_review_id": 708703732,
      "id": 671490286,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTQ5MDI4Ng==",
      "diff_hunk": "@@ -4341,8 +4379,11 @@ void CChainState::CheckBlockIndex(const Consensus::Params& consensusParams)\n     while (pindex != nullptr) {\n         nNodes++;\n         if (pindexFirstInvalid == nullptr && pindex->nStatus & BLOCK_FAILED_VALID) pindexFirstInvalid = pindex;\n-        if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n-        if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n+        // Don't start being rigorous about missing block data if we're within a utxo snapshot\n+        if (pindex->nHeight > snapshot_height) {\n+            if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n+            if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n+        }",
      "path": "src/validation.cpp",
      "position": 94,
      "original_position": 114,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b6dffada18bf874c619d17baf9df45346e52b871",
      "in_reply_to_id": 658173137,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'll make a note to ensure that `CompleteSnapshotValidation()` (in #15606) nulls out `m_snapshot_blockhash` so that what you're saying here is actually what happens. Otherwise we would just run the full suite of checks after restart when (what was previously) the snapshot chainstate gets loaded in as a \"regular\" IBD'd chainstate.",
      "created_at": "2021-07-16T19:49:25Z",
      "updated_at": "2021-07-16T19:49:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r671490286",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671490286"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4361,
      "original_line": 4361,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671500822",
      "pull_request_review_id": 708717465,
      "id": 671500822,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTUwMDgyMg==",
      "diff_hunk": "@@ -2205,6 +2210,33 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n \n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    auto log_progress = [this, pindexNew](\n+            const std::string& prefix,\n+            const std::string& warning_messages) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\n+    {\n+        LogPrintf(\"%s%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\",\n+            prefix, func_name,\n+            pindexNew->GetBlockHash().ToString(), pindexNew->nHeight, pindexNew->nVersion,\n+            log(pindexNew->nChainWork.getdouble())/log(2.0), (unsigned long)pindexNew->nChainTx,\n+            FormatISO8601DateTime(pindexNew->GetBlockTime()),\n+            GuessVerificationProgress(m_params.TxData(), pindexNew),\n+            this->CoinsTip().DynamicMemoryUsage() * (1.0 / (1<<20)),\n+            this->CoinsTip().GetCacheSize(),\n+            !warning_messages.empty() ? strprintf(\" warning='%s'\", warning_messages) : \"\");\n+    };\n+\n+    // The contents of this function are either not relevant if we're not",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "1ffc89e1192089aca8cdb0de80305d24f943ebfe",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "94e67d6 This comment seems unclear to me; remove \"either\" and s/otherwise/in that case/? (not sure)\r\n```suggestion\r\n    // The contents of this function are not relevant if we're not\r\n```",
      "created_at": "2021-07-16T20:12:03Z",
      "updated_at": "2021-07-16T20:36:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r671500822",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671500822"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2229,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671503219",
      "pull_request_review_id": 708717465,
      "id": 671503219,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTUwMzIxOQ==",
      "diff_hunk": "@@ -4282,6 +4309,9 @@ void CChainState::CheckBlockIndex()\n \n     LOCK(cs_main);\n \n+    bool is_active_chain = this == &m_chainman.ActiveChainstate();\n+    int snapshot_height = m_chainman.GetSnapshotHeight().value_or(-1);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 70,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "1ffc89e1192089aca8cdb0de80305d24f943ebfe",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "86e996aaef89 can be const, which seems good/useful in a function as long as `CChainState::CheckBlockIndex()`\r\n```diff\r\n-    bool is_active_chain = this == &m_chainman.ActiveChainstate();\r\n-    int snapshot_height = m_chainman.GetSnapshotHeight().value_or(-1);\r\n+    const bool is_active_chain{this == &m_chainman.ActiveChainstate()};\r\n+    const int snapshot_height{m_chainman.GetSnapshotHeight().value_or(-1)};\r\n```\r\n",
      "created_at": "2021-07-16T20:17:12Z",
      "updated_at": "2021-07-16T20:36:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r671503219",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671503219"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4313,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671509172",
      "pull_request_review_id": 708717465,
      "id": 671509172,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTUwOTE3Mg==",
      "diff_hunk": "@@ -251,6 +254,20 @@ CBlock TestChain100Setup::CreateAndProcessBlock(const std::vector<CMutableTransa\n \n     while (!CheckProofOfWork(block.GetHash(), block.nBits, chainparams.GetConsensus())) ++block.nNonce;\n \n+    return block;\n+}\n+\n+CBlock TestChain100Setup::CreateAndProcessBlock(\n+    const std::vector<CMutableTransaction>& txns,\n+    const CScript& scriptPubKey,\n+    CChainState* chainstate)\n+{\n+    if (!chainstate) {\n+        chainstate = &Assert(m_node.chainman)->ActiveChainstate();\n+    }\n+\n+    const CChainParams& chainparams = Params();\n+    CBlock block = this->CreateBlock(txns, scriptPubKey, chainstate);",
      "path": "src/test/util/setup_common.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "1ffc89e1192089aca8cdb0de80305d24f943ebfe",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ef47823cbec0a9600\r\n```suggestion\r\n    const CBlock block = this->CreateBlock(txns, scriptPubKey, chainstate);\r\n```",
      "created_at": "2021-07-16T20:30:07Z",
      "updated_at": "2021-07-16T20:36:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r671509172",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671509172"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 270,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671704184",
      "pull_request_review_id": 708946226,
      "id": 671704184,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTcwNDE4NA==",
      "diff_hunk": "@@ -2205,6 +2210,33 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n \n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    auto log_progress = [this, pindexNew](\n+            const std::string& prefix,\n+            const std::string& warning_messages) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\n+    {\n+        LogPrintf(\"%s%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\",\n+            prefix, func_name,\n+            pindexNew->GetBlockHash().ToString(), pindexNew->nHeight, pindexNew->nVersion,\n+            log(pindexNew->nChainWork.getdouble())/log(2.0), (unsigned long)pindexNew->nChainTx,\n+            FormatISO8601DateTime(pindexNew->GetBlockTime()),\n+            GuessVerificationProgress(m_params.TxData(), pindexNew),\n+            this->CoinsTip().DynamicMemoryUsage() * (1.0 / (1<<20)),\n+            this->CoinsTip().GetCacheSize(),\n+            !warning_messages.empty() ? strprintf(\" warning='%s'\", warning_messages) : \"\");\n+    };\n+\n+    // The contents of this function are either not relevant if we're not",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "1ffc89e1192089aca8cdb0de80305d24f943ebfe",
      "in_reply_to_id": 671500822,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done, thanks.",
      "created_at": "2021-07-17T14:31:24Z",
      "updated_at": "2021-07-17T14:31:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r671704184",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671704184"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2229,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671704203",
      "pull_request_review_id": 708946242,
      "id": 671704203,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTcwNDIwMw==",
      "diff_hunk": "@@ -4282,6 +4309,9 @@ void CChainState::CheckBlockIndex()\n \n     LOCK(cs_main);\n \n+    bool is_active_chain = this == &m_chainman.ActiveChainstate();\n+    int snapshot_height = m_chainman.GetSnapshotHeight().value_or(-1);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 70,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "1ffc89e1192089aca8cdb0de80305d24f943ebfe",
      "in_reply_to_id": 671503219,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done, thanks.",
      "created_at": "2021-07-17T14:31:36Z",
      "updated_at": "2021-07-17T14:31:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r671704203",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671704203"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4313,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671704229",
      "pull_request_review_id": 708946254,
      "id": 671704229,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTcwNDIyOQ==",
      "diff_hunk": "@@ -251,6 +254,20 @@ CBlock TestChain100Setup::CreateAndProcessBlock(const std::vector<CMutableTransa\n \n     while (!CheckProofOfWork(block.GetHash(), block.nBits, chainparams.GetConsensus())) ++block.nNonce;\n \n+    return block;\n+}\n+\n+CBlock TestChain100Setup::CreateAndProcessBlock(\n+    const std::vector<CMutableTransaction>& txns,\n+    const CScript& scriptPubKey,\n+    CChainState* chainstate)\n+{\n+    if (!chainstate) {\n+        chainstate = &Assert(m_node.chainman)->ActiveChainstate();\n+    }\n+\n+    const CChainParams& chainparams = Params();\n+    CBlock block = this->CreateBlock(txns, scriptPubKey, chainstate);",
      "path": "src/test/util/setup_common.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "1ffc89e1192089aca8cdb0de80305d24f943ebfe",
      "in_reply_to_id": 671509172,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2021-07-17T14:31:46Z",
      "updated_at": "2021-07-17T14:31:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r671704229",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671704229"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 270,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671734817",
      "pull_request_review_id": 708964765,
      "id": 671734817,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTczNDgxNw==",
      "diff_hunk": "@@ -0,0 +1,54 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+#ifndef BITCOIN_TEST_UTIL_CHAINSTATE_H\n+#define BITCOIN_TEST_UTIL_CHAINSTATE_H\n+\n+#include <clientversion.h>\n+#include <fs.h>\n+#include <node/context.h>\n+#include <node/utxo_snapshot.h>\n+#include <rpc/blockchain.h>\n+#include <validation.h>\n+\n+#include <univalue.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+auto NoMalleation = [](CAutoFile& file, SnapshotMetadata& meta){};",
      "path": "src/test/util/chainstate.h",
      "position": null,
      "original_position": 19,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "1901a9819d507425f9a2ea440d78892acbbb0e7f",
      "in_reply_to_id": null,
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "is this necessary? Can we declare NoMalleation the old fashioned way?",
      "created_at": "2021-07-17T19:29:47Z",
      "updated_at": "2021-07-17T19:29:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r671734817",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671734817"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671736102",
      "pull_request_review_id": 708965449,
      "id": 671736102,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTczNjEwMg==",
      "diff_hunk": "@@ -1024,6 +1024,12 @@ class ChainstateManager\n     //! ResizeCoinsCaches() as needed.\n     void MaybeRebalanceCaches() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\n \n+    //! @returns height at which the active UTXO snapshot was taken, if applicable.\n+    std::optional<CBlockIndex*> GetSnapshotBaseBlock() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);",
      "path": "src/validation.h",
      "position": null,
      "original_position": 5,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "0dd5757fd7c5b1d151abe45843711780a4b3885b",
      "in_reply_to_id": 655484970,
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I was going to suggest changing to std::optional<CBlockIndex&> since the inner type is not nullable. If you want rebindable, reference_wrapper.",
      "created_at": "2021-07-17T19:44:14Z",
      "updated_at": "2021-07-17T19:44:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r671736102",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671736102"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1032,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671736221",
      "pull_request_review_id": 708965531,
      "id": 671736221,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MTczNjIyMQ==",
      "diff_hunk": "@@ -0,0 +1,54 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+#ifndef BITCOIN_TEST_UTIL_CHAINSTATE_H\n+#define BITCOIN_TEST_UTIL_CHAINSTATE_H\n+\n+#include <clientversion.h>\n+#include <fs.h>\n+#include <node/context.h>\n+#include <node/utxo_snapshot.h>\n+#include <rpc/blockchain.h>\n+#include <validation.h>\n+\n+#include <univalue.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+auto NoMalleation = [](CAutoFile& file, SnapshotMetadata& meta){};",
      "path": "src/test/util/chainstate.h",
      "position": null,
      "original_position": 19,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "1901a9819d507425f9a2ea440d78892acbbb0e7f",
      "in_reply_to_id": 671734817,
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "(it's just a test, and it's moveonly, so NBD)",
      "created_at": "2021-07-17T19:45:44Z",
      "updated_at": "2021-07-17T19:45:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r671736221",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/671736221"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/672599645",
      "pull_request_review_id": 709939303,
      "id": 672599645,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MjU5OTY0NQ==",
      "diff_hunk": "@@ -2237,12 +2264,7 @@ void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n             }\n         }\n     }\n-    LogPrintf(\"%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\", __func__,\n-      pindexNew->GetBlockHash().ToString(), pindexNew->nHeight, pindexNew->nVersion,\n-      log(pindexNew->nChainWork.getdouble())/log(2.0), (unsigned long)pindexNew->nChainTx,\n-      FormatISO8601DateTime(pindexNew->GetBlockTime()),\n-      GuessVerificationProgress(m_params.TxData(), pindexNew), this->CoinsTip().DynamicMemoryUsage() * (1.0 / (1<<20)), this->CoinsTip().GetCacheSize(),\n-      !warning_messages.empty() ? strprintf(\" warning='%s'\", warning_messages.original) : \"\");\n+    log_progress(\"\", warning_messages.original);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "daa6902795b082832734b084a6c118eb8c682c3d",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"validation: change UpdateTip for multiple chainstates\" (daa6902795b082832734b084a6c118eb8c682c3d)\r\n\r\nIt seems like a more natural place for this log print would be line 2239 right next to the background validation log print so logging code here is more consolidated and straightforward. It would be a minor change in logging behavior though, logging at beginning instead of end of this function.",
      "created_at": "2021-07-19T20:14:42Z",
      "updated_at": "2021-07-19T22:27:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r672599645",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/672599645"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2268,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/672607413",
      "pull_request_review_id": 709939303,
      "id": 672607413,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MjYwNzQxMw==",
      "diff_hunk": "@@ -2237,12 +2264,7 @@ void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n             }\n         }\n     }\n-    LogPrintf(\"%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\", __func__,\n-      pindexNew->GetBlockHash().ToString(), pindexNew->nHeight, pindexNew->nVersion,\n-      log(pindexNew->nChainWork.getdouble())/log(2.0), (unsigned long)pindexNew->nChainTx,\n-      FormatISO8601DateTime(pindexNew->GetBlockTime()),\n-      GuessVerificationProgress(m_params.TxData(), pindexNew), this->CoinsTip().DynamicMemoryUsage() * (1.0 / (1<<20)), this->CoinsTip().GetCacheSize(),\n-      !warning_messages.empty() ? strprintf(\" warning='%s'\", warning_messages.original) : \"\");\n+    log_progress(\"\", warning_messages.original);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "daa6902795b082832734b084a6c118eb8c682c3d",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"validation: change UpdateTip for multiple chainstates\" (daa6902795b082832734b084a6c118eb8c682c3d)\r\n\r\nQuestions about previous code I guess, but why is `BACKGROUND_LOG_INTERVAL` rate limiting code is needed for this function in the `this != active` background case, but it is not needed in the `this->IsInitialBlockDownload` background case? I'd expect you'd want the same rate limiting both cases.\r\n\r\nAlso, it's kind of weird that in the `this != active` case, this function does nothing other than optionally print a log statement and return. It could make sense to move `m_chain.SetTip` calls into this function to dedup call sites and make this do more real work.",
      "created_at": "2021-07-19T20:27:11Z",
      "updated_at": "2021-07-19T22:27:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r672607413",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/672607413"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2268,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/672649191",
      "pull_request_review_id": 709939303,
      "id": 672649191,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MjY0OTE5MQ==",
      "diff_hunk": "@@ -2210,6 +2210,33 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n \n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    auto log_progress = [this, pindexNew, &func_name](\n+            const std::string& prefix,\n+            const std::string& warning_messages) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 7,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "daa6902795b082832734b084a6c118eb8c682c3d",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"validation: change UpdateTip for multiple chainstates\" (daa6902795b082832734b084a6c118eb8c682c3d)\r\n\r\nIf going to use EXCLUSIVE_LOCKS_REQUIRED on a lambda right now, should actually use AssertLockHeld inside the lambda as well, because just adding the REQUIRED to a lambda does not actually require anything. (It just makes the analysis assume that the lock is held with no enforcement. Offtopic: I think this is bad and previously argued against using REQUIRED annotations to make unenforced assumptions in favor of adding a better assert with enforced assumptions, but I couldn't convince reviewers about it in #19918.)",
      "created_at": "2021-07-19T21:37:12Z",
      "updated_at": "2021-07-19T22:27:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r672649191",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/672649191"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2216,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/672653163",
      "pull_request_review_id": 709939303,
      "id": 672653163,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MjY1MzE2Mw==",
      "diff_hunk": "@@ -1024,6 +1024,12 @@ class ChainstateManager\n     //! ResizeCoinsCaches() as needed.\n     void MaybeRebalanceCaches() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\n \n+    //! @returns height at which the active UTXO snapshot was taken, if applicable.\n+    std::optional<CBlockIndex*> GetSnapshotBaseBlock() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);",
      "path": "src/validation.h",
      "position": null,
      "original_position": 5,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "0dd5757fd7c5b1d151abe45843711780a4b3885b",
      "in_reply_to_id": 655484970,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"validation: fix CheckBlockIndex for multiple chainstates\" (d7804383748e85bda1be40cf0782a3ca2e457066)\r\n\r\nre: https://github.com/bitcoin/bitcoin/pull/21526#discussion_r671736102\r\n\r\n> I was going to suggest changing to std::optional<CBlockIndex&> since the inner type is not nullable. If you want rebindable, reference_wrapper.\r\n\r\nI'm probably missing a subtlety but I don't know what reason you'd prefer `optional<T&>` to `T*`. It seems like just reinventing a pointer without using a pointer.",
      "created_at": "2021-07-19T21:44:41Z",
      "updated_at": "2021-07-19T22:27:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r672653163",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/672653163"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1032,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/672666902",
      "pull_request_review_id": 709939303,
      "id": 672666902,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MjY2NjkwMg==",
      "diff_hunk": "@@ -4341,8 +4379,11 @@ void CChainState::CheckBlockIndex(const Consensus::Params& consensusParams)\n     while (pindex != nullptr) {\n         nNodes++;\n         if (pindexFirstInvalid == nullptr && pindex->nStatus & BLOCK_FAILED_VALID) pindexFirstInvalid = pindex;\n-        if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n-        if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n+        // Don't start being rigorous about missing block data if we're within a utxo snapshot\n+        if (pindex->nHeight > snapshot_height) {\n+            if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n+            if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n+        }",
      "path": "src/validation.cpp",
      "position": 94,
      "original_position": 114,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b6dffada18bf874c619d17baf9df45346e52b871",
      "in_reply_to_id": 658173137,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"validation: fix CheckBlockIndex for multiple chainstates\" (d7804383748e85bda1be40cf0782a3ca2e457066)\r\n\r\nre: https://github.com/bitcoin/bitcoin/pull/21526#discussion_r671490286\r\n\r\n> I'll make a note to ensure that `CompleteSnapshotValidation()` (in #15606) nulls out `m_snapshot_blockhash` so that what you're saying here is actually what happens. Otherwise we would just run the full suite of checks after restart when (what was previously) the snapshot chainstate gets loaded in as a \"regular\" IBD'd chainstate.\r\n\r\nThis would be good to do but it does seem fragile that you have to clear a `CChainState` atttribute to make more checking happen. I think (again) more ideally in the future assumeutxo snapshot logic would be limited to `ChainStateManager`. Chain state objects could have a `CChainState::m_validation_starting_height` member that could be used here instead of `snapshot_height` and `ChainStateManager` could set, so this code doesn't have to know about `ChainStateManager` and ask it about snapshots.",
      "created_at": "2021-07-19T22:12:04Z",
      "updated_at": "2021-07-19T22:27:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r672666902",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/672666902"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4361,
      "original_line": 4361,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/673457466",
      "pull_request_review_id": 711025359,
      "id": 673457466,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3MzQ1NzQ2Ng==",
      "diff_hunk": "@@ -1040,6 +1028,12 @@ class ChainstateManager\n     //! ResizeCoinsCaches() as needed.\n     void MaybeRebalanceCaches() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\n \n+    //! @returns block metadata for the base block of the active UTXO snapshot, if applicable.\n+    std::optional<CBlockIndex*> GetSnapshotBaseBlock() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);",
      "path": "src/validation.h",
      "position": null,
      "original_position": 62,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "1901a9819d507425f9a2ea440d78892acbbb0e7f",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Still not fixed?",
      "created_at": "2021-07-20T20:14:53Z",
      "updated_at": "2021-07-20T20:14:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r673457466",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/673457466"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1032,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/674024789",
      "pull_request_review_id": 711724756,
      "id": 674024789,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NDAyNDc4OQ==",
      "diff_hunk": "@@ -4341,8 +4379,11 @@ void CChainState::CheckBlockIndex(const Consensus::Params& consensusParams)\n     while (pindex != nullptr) {\n         nNodes++;\n         if (pindexFirstInvalid == nullptr && pindex->nStatus & BLOCK_FAILED_VALID) pindexFirstInvalid = pindex;\n-        if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n-        if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n+        // Don't start being rigorous about missing block data if we're within a utxo snapshot\n+        if (pindex->nHeight > snapshot_height) {\n+            if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n+            if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n+        }",
      "path": "src/validation.cpp",
      "position": 94,
      "original_position": 114,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b6dffada18bf874c619d17baf9df45346e52b871",
      "in_reply_to_id": 658173137,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Totally agree @ryanofsky, and I've got some changes coming that will attempt to limit the degree to which the notion of snapshots leak out of ChainstateManager, but I want to point out two things:\r\n- having an `m_validation_starting_height` member on CChainState would still have to be toggled after snapshot validation completes, so the fragility you rightfully point out would still be there, and\r\n- whether we call it \"snapshot_height\" or \"m_validation_starting_height\" or \"assumed_valid_before\", we're going to have some notion of an assumed-valid region of the chain that parts of the system have to kind of know about to a certain extent. I think it's a legitimate argument that \"assmed-valid\" is maybe a more appropriate, general label than talking about snapshots, but fundamentally they're isomorphic at the moment AFAICT.\r\n\r\nI think the only real way to avoid the fragility of the checks here is to, instead of relying on CChainState member variables, introduce a new block index status flag, `BLOCK_ASSUMED_VALID`, and have CheckBlockIndex et al gate on that. I'm going to look at potentially doing this in a future changeset because this involves to some extent revamping the assumeutxo changes more generally.",
      "created_at": "2021-07-21T14:27:38Z",
      "updated_at": "2021-07-21T14:27:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r674024789",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/674024789"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4361,
      "original_line": 4361,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/674198521",
      "pull_request_review_id": 711976343,
      "id": 674198521,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NDE5ODUyMQ==",
      "diff_hunk": "@@ -4341,8 +4379,11 @@ void CChainState::CheckBlockIndex(const Consensus::Params& consensusParams)\n     while (pindex != nullptr) {\n         nNodes++;\n         if (pindexFirstInvalid == nullptr && pindex->nStatus & BLOCK_FAILED_VALID) pindexFirstInvalid = pindex;\n-        if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n-        if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n+        // Don't start being rigorous about missing block data if we're within a utxo snapshot\n+        if (pindex->nHeight > snapshot_height) {\n+            if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n+            if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n+        }",
      "path": "src/validation.cpp",
      "position": 94,
      "original_position": 114,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b6dffada18bf874c619d17baf9df45346e52b871",
      "in_reply_to_id": 658173137,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> having an `m_validation_starting_height` member on CChainState would still have to be toggled after snapshot validation completes, so the fragility you rightfully point out would still be there\r\n\r\nRight, but the point for me is to just locate the complexity in chainstatemanager instead of having it exposed to other parts of the code. I think in this case complexity is like a conserved quantity, you can't get rid of it but you can move it from one place to another. If complexity is encapsulated one place and not exposed other places that's the best outcome.\r\n\r\nAlso I guess I personally have a bias to wanting to name things after _how they are used_ or _what they mean_, not _where they came from_. Data can come from lots of places, and snapshots are a new source of data. But it adds mental overhead for pruning, indexing, and other validation code to know about the snapshot lifecycle or care where blocks came from when they don't need to, so something like \"validated_starting_height\" or \"locally_validated_starting_height\" seems easier to understand and reason about than \"snapshot_height\" in code that doesn't otherwise have to deal with snapshots.\r\n\r\n`BLOCK_ASSUMED_VALID` could be good too. (I do have some skepticism that it conveys similar information, but not the same information, so might leave code making unclear assumptions like every block before the last assume valid block has the flag, and every block after doesn't have it. Also it would seem more natural to have a flag indicating what kind of validation was done, instead of what kind of validation was skipped, so maybe BLOCK_VALIDATED_FROM_GENESIS, BLOCK_VALIDATED_FROM_SNAPSHOT could be more descriptive.)\r\n\r\nBut everything after the first paragraph here is just differences of opinion about naming, and you should chose the names you like and ignore the feedback you don't like. I'm not trying to play architect here, just say what things I'm thinking and maybe generate some useful ideas.",
      "created_at": "2021-07-21T17:40:52Z",
      "updated_at": "2021-07-21T17:40:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r674198521",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/674198521"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4361,
      "original_line": 4361,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/675715549",
      "pull_request_review_id": 713927792,
      "id": 675715549,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NTcxNTU0OQ==",
      "diff_hunk": "@@ -2210,6 +2210,33 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n \n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    auto log_progress = [this, pindexNew, &func_name](\n+            const std::string& prefix,\n+            const std::string& warning_messages) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 7,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "daa6902795b082832734b084a6c118eb8c682c3d",
      "in_reply_to_id": 672649191,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed, thanks.",
      "created_at": "2021-07-23T17:13:27Z",
      "updated_at": "2021-07-23T17:13:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r675715549",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/675715549"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2216,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/675716972",
      "pull_request_review_id": 713929749,
      "id": 675716972,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NTcxNjk3Mg==",
      "diff_hunk": "@@ -4341,8 +4379,11 @@ void CChainState::CheckBlockIndex(const Consensus::Params& consensusParams)\n     while (pindex != nullptr) {\n         nNodes++;\n         if (pindexFirstInvalid == nullptr && pindex->nStatus & BLOCK_FAILED_VALID) pindexFirstInvalid = pindex;\n-        if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n-        if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n+        // Don't start being rigorous about missing block data if we're within a utxo snapshot\n+        if (pindex->nHeight > snapshot_height) {\n+            if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n+            if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n+        }",
      "path": "src/validation.cpp",
      "position": 94,
      "original_position": 114,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b6dffada18bf874c619d17baf9df45346e52b871",
      "in_reply_to_id": 658173137,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "\"Snapshot height\" has now been completely removed as something this code is concerned about; I'll post a longer comment summarizing the changes, but we now rely on a block index flag called `BLOCK_ASSUMED_VALID` to change CheckBlockIndex() behavior as necessary. We now no longer have to worry about ChainstateManager variables to bring this behavior \"back to normal,\" since `BLOCK_ASSUMED_VALID` is removed from the corresponding pindex as blocks are validated.",
      "created_at": "2021-07-23T17:16:15Z",
      "updated_at": "2021-07-23T17:16:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r675716972",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/675716972"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4361,
      "original_line": 4361,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/683805405",
      "pull_request_review_id": 723820187,
      "id": 683805405,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MzgwNTQwNQ==",
      "diff_hunk": "@@ -126,7 +126,15 @@ enum BlockStatus: uint32_t {\n     BLOCK_FAILED_CHILD       =   64, //!< descends from failed block\n     BLOCK_FAILED_MASK        =   BLOCK_FAILED_VALID | BLOCK_FAILED_CHILD,\n \n-    BLOCK_OPT_WITNESS       =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+    BLOCK_OPT_WITNESS        =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+\n+    /**\n+     * If set, this indicates that the block index entry is assumed-valid.\n+     * Certain diagnostics will be skipped in e.g. CheckBlockIndex().\n+     * It almost certainly means that the block's full validation is pending",
      "path": "src/chain.h",
      "position": 10,
      "original_position": 10,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "d502108c82e64b6acec4d2788fb224c118fccaff",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"chain: add BLOCK_ASSUMED_VALID for use with assumeutxo\" (d502108c82e64b6acec4d2788fb224c118fccaff)\r\n\r\nVery little difference, but in case you update, you might backport commit d502108c82e64b6acec4d2788fb224c118fccaff from #15606 to this pr (dropping almost certainly\", https://github.com/bitcoin/bitcoin/pull/15606#discussion_r676189715)",
      "created_at": "2021-08-05T21:40:32Z",
      "updated_at": "2021-08-05T22:56:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r683805405",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/683805405"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 134,
      "original_line": 134,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/683813701",
      "pull_request_review_id": 723820187,
      "id": 683813701,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MzgxMzcwMQ==",
      "diff_hunk": "@@ -300,13 +308,23 @@ class CBlockIndex\n         return ((nStatus & BLOCK_VALID_MASK) >= nUpTo);\n     }\n \n+    //! @returns true if the block is assumed-valid; probably means it is queued to be\n+    //!   validated by a background chainstate.\n+    bool IsAssumedValid() const { return nStatus & BLOCK_ASSUMED_VALID; }\n+\n     //! Raise the validity level of this block index entry.\n     //! Returns true if the validity was changed.\n     bool RaiseValidity(enum BlockStatus nUpTo)\n     {\n         assert(!(nUpTo & ~BLOCK_VALID_MASK)); // Only validity flags allowed.\n-        if (nStatus & BLOCK_FAILED_MASK)\n-            return false;\n+        if (nStatus & BLOCK_FAILED_MASK) return false;\n+\n+        // If this block had been marked assumed-valid and we're raising\n+        // its validity to a certain point, there is no longer an assumption.",
      "path": "src/chain.h",
      "position": null,
      "original_position": 35,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "d502108c82e64b6acec4d2788fb224c118fccaff",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"chain: add BLOCK_ASSUMED_VALID for use with assumeutxo\" (d502108c82e64b6acec4d2788fb224c118fccaff)\r\n\r\nIt would be good if this comment said what the reason for unsetting the flag is. I.e. is unsetting the flag just bookkeeping or is there actually code that would be broken if block was assumed valid and later validated, and multiple flags were present?\r\n\r\nIt's not a big deal, but my instinct would be to say that any code making extra assumptions about validity based on `ASSUMED_VALID` is already fragile and buggy, and it would be better to fix that code than to make it depend on this new RaiseValidity flag toggling behavior (and it would seem be nice not to have to add this behavior at all).\r\n\r\n---\r\n\r\nUPDATE: Looking ahead at the later commits, I can see some new code added in `CheckBlockIndex` and calling `IsAssumedValid()` is assuming the block has not been locally validated yet if true. I think this code would probably be clearer and more robust if it checked `BLOCK_VALID` first and then checked `BLOCK_ASSUMED_VALID` secondarily instead of putting the assumed valid case at the forefront. But :shrug: it's not really a big deal and probably not worth more iterations updating and discussing.\r\n",
      "created_at": "2021-08-05T21:58:31Z",
      "updated_at": "2021-08-05T22:56:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r683813701",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/683813701"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 323,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/683815605",
      "pull_request_review_id": 723820187,
      "id": 683815605,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MzgxNTYwNQ==",
      "diff_hunk": "@@ -5001,11 +5001,24 @@ bool ChainstateManager::PopulateAndValidateSnapshot(\n         // Fake nChainTx so that GuessVerificationProgress reports accurately\n         index->nChainTx = index->pprev ? index->pprev->nChainTx + index->nTx : 1;\n \n+        if (!index->IsValid(BLOCK_VALID_SCRIPTS)) {\n+            // This flag will be removed once the block is fully validated by a\n+            // background chainstate.\n+            index->nStatus |= BLOCK_ASSUMED_VALID;\n+        }\n+",
      "path": "src/validation.cpp",
      "position": 202,
      "original_position": 9,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "9a8ad497238c8c8aba1ba8679bc7cdbe409c635e",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"validation: set BLOCK_ASSUMED_VALID during snapshot load\" (9a8ad497238c8c8aba1ba8679bc7cdbe409c635e)\r\n\r\nSimilar to comment in last commit it would seem nice to just be able to drop this interaction/toggling of flags and just do unconditional `index->nStatus |= BLOCK_ASSUMED_VALID`",
      "created_at": "2021-08-05T22:02:47Z",
      "updated_at": "2021-08-05T22:56:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r683815605",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/683815605"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": 5051,
      "original_start_line": 5004,
      "start_side": "RIGHT",
      "line": 5056,
      "original_line": 5056,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/683829467",
      "pull_request_review_id": 723820187,
      "id": 683829467,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MzgyOTQ2Nw==",
      "diff_hunk": "@@ -4348,12 +4349,29 @@ void CChainState::CheckBlockIndex()\n     while (pindex != nullptr) {\n         nNodes++;\n         if (pindexFirstInvalid == nullptr && pindex->nStatus & BLOCK_FAILED_VALID) pindexFirstInvalid = pindex;\n-        if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n+        if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA) && !pindex->IsAssumedValid()) {",
      "path": "src/validation.cpp",
      "position": 92,
      "original_position": 13,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "4941a532ebefbe52e4c6c4ba72b02823bd938a77",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"validation: set BLOCK_ASSUMED_VALID during snapshot load\" (9a8ad497238c8c8aba1ba8679bc7cdbe409c635e)\r\n\r\nWould be nice to have comment explaining the IsAssumedValid condition, since logic is a little convoluted. Maybe \"Treat assumed valid blocks that are missing data as if they have data for the purpose of the [whatever] check below\"",
      "created_at": "2021-08-05T22:37:09Z",
      "updated_at": "2021-08-05T22:56:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r683829467",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/683829467"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 4359,
      "original_line": 4359,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/683835244",
      "pull_request_review_id": 723820187,
      "id": 683835244,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4MzgzNTI0NA==",
      "diff_hunk": "@@ -4348,12 +4349,29 @@ void CChainState::CheckBlockIndex()\n     while (pindex != nullptr) {\n         nNodes++;\n         if (pindexFirstInvalid == nullptr && pindex->nStatus & BLOCK_FAILED_VALID) pindexFirstInvalid = pindex;\n-        if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n+        if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA) && !pindex->IsAssumedValid()) {\n+            pindexFirstMissing = pindex;\n+        }\n         if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n         if (pindex->pprev != nullptr && pindexFirstNotTreeValid == nullptr && (pindex->nStatus & BLOCK_VALID_MASK) < BLOCK_VALID_TREE) pindexFirstNotTreeValid = pindex;\n-        if (pindex->pprev != nullptr && pindexFirstNotTransactionsValid == nullptr && (pindex->nStatus & BLOCK_VALID_MASK) < BLOCK_VALID_TRANSACTIONS) pindexFirstNotTransactionsValid = pindex;\n-        if (pindex->pprev != nullptr && pindexFirstNotChainValid == nullptr && (pindex->nStatus & BLOCK_VALID_MASK) < BLOCK_VALID_CHAIN) pindexFirstNotChainValid = pindex;\n-        if (pindex->pprev != nullptr && pindexFirstNotScriptsValid == nullptr && (pindex->nStatus & BLOCK_VALID_MASK) < BLOCK_VALID_SCRIPTS) pindexFirstNotScriptsValid = pindex;\n+\n+        if (pindex->pprev != nullptr && !pindex->IsAssumedValid()) {\n+            // Skip validity flag checks for BLOCK_ASSUMED_VALID index entries.",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 23,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "4941a532ebefbe52e4c6c4ba72b02823bd938a77",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"validation: set BLOCK_ASSUMED_VALID during snapshot load\" (9a8ad497238c8c8aba1ba8679bc7cdbe409c635e)\r\n\r\nWould be nice if comment could be less vague. Maybe \"Treat assumed valid blocks as if they are valid for the purpose of the [whatever] checks below\"",
      "created_at": "2021-08-05T22:52:07Z",
      "updated_at": "2021-08-05T22:56:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r683835244",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/683835244"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4366,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688081245",
      "pull_request_review_id": 729070205,
      "id": 688081245,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODA4MTI0NQ==",
      "diff_hunk": "@@ -2205,6 +2210,34 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n \n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    auto log_progress = [this, pindexNew, &func_name](",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "3a9ce0e2d41cac3b072225aa1ed34caca4191392",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "1142b4f Seeing this warning like @Sjors reported (rebased on master, Clang 13 debug build). What CI failure were you seeing when it was addressed?\r\n```\r\nvalidation.cpp:2203:44: warning: lambda capture 'func_name' is not required to be captured for this use [-Wunused-lambda-capture]\r\n    auto log_progress = [this, pindexNew, &func_name](\r\n                                        ~~~^~~~~~~~~\r\n1 warning generated.\r\n```\r\n",
      "created_at": "2021-08-12T21:00:15Z",
      "updated_at": "2021-08-12T21:01:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r688081245",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688081245"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688337328",
      "pull_request_review_id": 729381493,
      "id": 688337328,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODMzNzMyOA==",
      "diff_hunk": "@@ -2205,6 +2210,34 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n \n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    auto log_progress = [this, pindexNew, &func_name](",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "3a9ce0e2d41cac3b072225aa1ed34caca4191392",
      "in_reply_to_id": 688081245,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "How did you address it when the CI didn't pass? e.g. with `[this, pindexNew]`, or `[&]`, or using a struct instead of a lambda?",
      "created_at": "2021-08-13T08:25:30Z",
      "updated_at": "2021-08-13T08:25:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r688337328",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688337328"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688573073",
      "pull_request_review_id": 729698214,
      "id": 688573073,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODU3MzA3Mw==",
      "diff_hunk": "@@ -2205,6 +2210,34 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n \n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    auto log_progress = [this, pindexNew, &func_name](",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "3a9ce0e2d41cac3b072225aa1ed34caca4191392",
      "in_reply_to_id": 688081245,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Can't dig up the exact stacktrace, but on one of the more exotic CI platforms (mac, win, or mingw32), the variable isn't captured unless explicitly named, and compilation fails. I think I tried your first two suggestions, but am not sure what you mean by \"struct instead of a lambda.\"",
      "created_at": "2021-08-13T14:49:42Z",
      "updated_at": "2021-08-13T14:49:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r688573073",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688573073"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688585404",
      "pull_request_review_id": 729714967,
      "id": 688585404,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODU4NTQwNA==",
      "diff_hunk": "@@ -2205,6 +2210,34 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n \n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    auto log_progress = [this, pindexNew, &func_name](",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "3a9ce0e2d41cac3b072225aa1ed34caca4191392",
      "in_reply_to_id": 688081245,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Can't dig up the exact stacktrace, but on one of the more exotic CI platforms (mac, win, or mingw32), the variable isn't captured unless explicitly named, and compilation fails. I think I tried your first two suggestions, but am not sure what you mean by \"struct instead of a lambda.\"\r\n\r\nRelated: I did have an earlier suggestion for eliminating the lambda here: https://github.com/bitcoin/bitcoin/pull/21526#discussion_r672599645. Instead of using the lambda to repeat the logging at the beginning and end of the function, just log without a lambda at the beginning of the function\r\n\r\nI don't think is too important, though",
      "created_at": "2021-08-13T15:06:34Z",
      "updated_at": "2021-08-13T15:06:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r688585404",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688585404"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688622291",
      "pull_request_review_id": 729764648,
      "id": 688622291,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODYyMjI5MQ==",
      "diff_hunk": "@@ -2205,6 +2210,34 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n \n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    auto log_progress = [this, pindexNew, &func_name](",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "3a9ce0e2d41cac3b072225aa1ed34caca4191392",
      "in_reply_to_id": 688081245,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "@ryanofsky good point - I'll give that a shake, and take a look at addressing your other feedback while I'm at it.",
      "created_at": "2021-08-13T16:01:49Z",
      "updated_at": "2021-08-13T16:01:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r688622291",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688622291"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688664938",
      "pull_request_review_id": 729821316,
      "id": 688664938,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODY2NDkzOA==",
      "diff_hunk": "@@ -2205,6 +2210,34 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n \n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    auto log_progress = [this, pindexNew, &func_name](",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "3a9ce0e2d41cac3b072225aa1ed34caca4191392",
      "in_reply_to_id": 688081245,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is new to me, but if I understand correctly, the issue is compiler/system-dependent lambda capture of `__func__`. Maybe convert the `log_progress` lambda to a function: https://github.com/jonatack/bitcoin/commit/e95e25e8aa6581d8658b05581f0b1a04e8712387.",
      "created_at": "2021-08-13T17:14:46Z",
      "updated_at": "2021-08-13T17:14:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r688664938",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688664938"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688673184",
      "pull_request_review_id": 729832391,
      "id": 688673184,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODY3MzE4NA==",
      "diff_hunk": "@@ -2205,6 +2210,34 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n \n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    auto log_progress = [this, pindexNew, &func_name](",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "3a9ce0e2d41cac3b072225aa1ed34caca4191392",
      "in_reply_to_id": 688081245,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "(by \"struct instead of a lambda\", I was thinking of a struct like [`38a81a8` (#21261)](https://github.com/bitcoin/bitcoin/pull/21261/commits/38a81a8e20b0e5ad9fef0eae8abd914619f05b25) that I originally wrote as a lambda, before turning it into a struct to be more similar to the other peer eviction comparators)",
      "created_at": "2021-08-13T17:29:59Z",
      "updated_at": "2021-08-13T17:29:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r688673184",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688673184"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688733158",
      "pull_request_review_id": 729909441,
      "id": 688733158,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODczMzE1OA==",
      "diff_hunk": "@@ -2237,12 +2264,7 @@ void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n             }\n         }\n     }\n-    LogPrintf(\"%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\", __func__,\n-      pindexNew->GetBlockHash().ToString(), pindexNew->nHeight, pindexNew->nVersion,\n-      log(pindexNew->nChainWork.getdouble())/log(2.0), (unsigned long)pindexNew->nChainTx,\n-      FormatISO8601DateTime(pindexNew->GetBlockTime()),\n-      GuessVerificationProgress(m_params.TxData(), pindexNew), this->CoinsTip().DynamicMemoryUsage() * (1.0 / (1<<20)), this->CoinsTip().GetCacheSize(),\n-      !warning_messages.empty() ? strprintf(\" warning='%s'\", warning_messages.original) : \"\");\n+    log_progress(\"\", warning_messages.original);",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "daa6902795b082832734b084a6c118eb8c682c3d",
      "in_reply_to_id": 672599645,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I've looked at doing this, but I don't think it's worth the complication: consider that we aggregate `warning_messages` at the end of this function, which is another reason to split the log up.",
      "created_at": "2021-08-13T19:23:14Z",
      "updated_at": "2021-08-13T19:23:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r688733158",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688733158"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2268,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688735292",
      "pull_request_review_id": 729912269,
      "id": 688735292,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODczNTI5Mg==",
      "diff_hunk": "@@ -2205,6 +2210,34 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n \n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    auto log_progress = [this, pindexNew, &func_name](",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "3a9ce0e2d41cac3b072225aa1ed34caca4191392",
      "in_reply_to_id": 688081245,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Took @jonatack's suggestion and moved the lambda to a static function.",
      "created_at": "2021-08-13T19:27:54Z",
      "updated_at": "2021-08-13T19:27:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r688735292",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688735292"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2214,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688743795",
      "pull_request_review_id": 729923532,
      "id": 688743795,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODc0Mzc5NQ==",
      "diff_hunk": "@@ -5001,11 +5001,24 @@ bool ChainstateManager::PopulateAndValidateSnapshot(\n         // Fake nChainTx so that GuessVerificationProgress reports accurately\n         index->nChainTx = index->pprev ? index->pprev->nChainTx + index->nTx : 1;\n \n+        if (!index->IsValid(BLOCK_VALID_SCRIPTS)) {\n+            // This flag will be removed once the block is fully validated by a\n+            // background chainstate.\n+            index->nStatus |= BLOCK_ASSUMED_VALID;\n+        }\n+",
      "path": "src/validation.cpp",
      "position": 202,
      "original_position": 9,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "9a8ad497238c8c8aba1ba8679bc7cdbe409c635e",
      "in_reply_to_id": 683815605,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't think it makes sense to apply the ASSUMED_VALID classification for blocks we've already validated, especially since (i) it's easy to avoid, and (ii) there will almost certainly be blocks at the base of the chain that have been validated prior to loading a UTXO snapshot.",
      "created_at": "2021-08-13T19:45:48Z",
      "updated_at": "2021-08-13T19:45:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r688743795",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688743795"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": 5051,
      "original_start_line": 5004,
      "start_side": "RIGHT",
      "line": 5056,
      "original_line": 5056,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688746234",
      "pull_request_review_id": 729926636,
      "id": 688746234,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODc0NjIzNA==",
      "diff_hunk": "@@ -2208,8 +2208,43 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n     res += warn;\n }\n \n+static void UpdateTipLog(\n+    const CCoinsViewCache& coins_tip,\n+    const CBlockIndex* tip,\n+    const CChainParams& params,\n+    const std::string& func_name,\n+    const std::string& prefix,\n+    const std::string& warning_messages) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\n+{\n+\n+    AssertLockHeld(::cs_main);\n+    LogPrintf(\"%s%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\",\n+        prefix, func_name,\n+        tip->GetBlockHash().ToString(), tip->nHeight, tip->nVersion,\n+        log(tip->nChainWork.getdouble())/log(2.0), (unsigned long)tip->nChainTx,\n+        FormatISO8601DateTime(tip->GetBlockTime()),\n+        GuessVerificationProgress(params.TxData(), tip),\n+        coins_tip.DynamicMemoryUsage() * (1.0 / (1<<20)),\n+        coins_tip.GetCacheSize(),\n+        !warning_messages.empty() ? strprintf(\" warning='%s'\", warning_messages) : \"\");\n+}\n+\n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    const auto& coins_tip = this->CoinsTip();\n+\n+    // The remainder of the function isn't relevant if we are not acting on\n+    // the active chainstate, so return if need be.\n+    if (this != &m_chainman.ActiveChainstate()) {\n+        // Only log every so often so that we don't bury log messages at the tip.\n+        constexpr int BACKGROUND_LOG_INTERVAL = 2000;\n+        if (pindexNew->nHeight % BACKGROUND_LOG_INTERVAL == 0) {\n+            UpdateTipLog(coins_tip, pindexNew, m_params, __func__, \"[background validation] \", \"\");",
      "path": "src/validation.cpp",
      "position": 52,
      "original_position": 36,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "011b52beb95abe8fd245218f63d6e1b3538408f9",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "here and below `s/__func__/func_name/` (or remove line 2234, I don't know if the conversion from `char[10]` to `std:string` is needed for any of the compilers, can try dropping it to see...but if the conversion *is* needed, maybe `const std::string func_name{__func__}`)\r\n\r\n```\r\nvalidation.cpp: In member function void CChainState::UpdateTip(const CBlockIndex*):\r\nvalidation.cpp:2223:11: error: unused variable func_name [-Werror=unused-variable]\r\n     auto& func_name = __func__;\r\n           ^~~~~~~~~\r\n```\r\n",
      "created_at": "2021-08-13T19:51:01Z",
      "updated_at": "2021-08-13T19:55:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r688746234",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688746234"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2242,
      "original_line": 2242,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688777697",
      "pull_request_review_id": 729966489,
      "id": 688777697,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODc3NzY5Nw==",
      "diff_hunk": "@@ -4348,12 +4349,29 @@ void CChainState::CheckBlockIndex()\n     while (pindex != nullptr) {\n         nNodes++;\n         if (pindexFirstInvalid == nullptr && pindex->nStatus & BLOCK_FAILED_VALID) pindexFirstInvalid = pindex;\n-        if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA)) pindexFirstMissing = pindex;\n+        if (pindexFirstMissing == nullptr && !(pindex->nStatus & BLOCK_HAVE_DATA) && !pindex->IsAssumedValid()) {\n+            pindexFirstMissing = pindex;\n+        }\n         if (pindexFirstNeverProcessed == nullptr && pindex->nTx == 0) pindexFirstNeverProcessed = pindex;\n         if (pindex->pprev != nullptr && pindexFirstNotTreeValid == nullptr && (pindex->nStatus & BLOCK_VALID_MASK) < BLOCK_VALID_TREE) pindexFirstNotTreeValid = pindex;\n-        if (pindex->pprev != nullptr && pindexFirstNotTransactionsValid == nullptr && (pindex->nStatus & BLOCK_VALID_MASK) < BLOCK_VALID_TRANSACTIONS) pindexFirstNotTransactionsValid = pindex;\n-        if (pindex->pprev != nullptr && pindexFirstNotChainValid == nullptr && (pindex->nStatus & BLOCK_VALID_MASK) < BLOCK_VALID_CHAIN) pindexFirstNotChainValid = pindex;\n-        if (pindex->pprev != nullptr && pindexFirstNotScriptsValid == nullptr && (pindex->nStatus & BLOCK_VALID_MASK) < BLOCK_VALID_SCRIPTS) pindexFirstNotScriptsValid = pindex;\n+\n+        if (pindex->pprev != nullptr && !pindex->IsAssumedValid()) {\n+            // Skip validity flag checks for BLOCK_ASSUMED_VALID index entries.",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 23,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "4941a532ebefbe52e4c6c4ba72b02823bd938a77",
      "in_reply_to_id": 683835244,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed, thanks!",
      "created_at": "2021-08-13T20:58:39Z",
      "updated_at": "2021-08-13T20:58:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r688777697",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688777697"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4366,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688777882",
      "pull_request_review_id": 729966710,
      "id": 688777882,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODc3Nzg4Mg==",
      "diff_hunk": "@@ -2208,8 +2208,43 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n     res += warn;\n }\n \n+static void UpdateTipLog(\n+    const CCoinsViewCache& coins_tip,\n+    const CBlockIndex* tip,\n+    const CChainParams& params,\n+    const std::string& func_name,\n+    const std::string& prefix,\n+    const std::string& warning_messages) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\n+{\n+\n+    AssertLockHeld(::cs_main);\n+    LogPrintf(\"%s%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\",\n+        prefix, func_name,\n+        tip->GetBlockHash().ToString(), tip->nHeight, tip->nVersion,\n+        log(tip->nChainWork.getdouble())/log(2.0), (unsigned long)tip->nChainTx,\n+        FormatISO8601DateTime(tip->GetBlockTime()),\n+        GuessVerificationProgress(params.TxData(), tip),\n+        coins_tip.DynamicMemoryUsage() * (1.0 / (1<<20)),\n+        coins_tip.GetCacheSize(),\n+        !warning_messages.empty() ? strprintf(\" warning='%s'\", warning_messages) : \"\");\n+}\n+\n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    const auto& coins_tip = this->CoinsTip();\n+\n+    // The remainder of the function isn't relevant if we are not acting on\n+    // the active chainstate, so return if need be.\n+    if (this != &m_chainman.ActiveChainstate()) {\n+        // Only log every so often so that we don't bury log messages at the tip.\n+        constexpr int BACKGROUND_LOG_INTERVAL = 2000;\n+        if (pindexNew->nHeight % BACKGROUND_LOG_INTERVAL == 0) {\n+            UpdateTipLog(coins_tip, pindexNew, m_params, __func__, \"[background validation] \", \"\");",
      "path": "src/validation.cpp",
      "position": 52,
      "original_position": 36,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "011b52beb95abe8fd245218f63d6e1b3538408f9",
      "in_reply_to_id": 688746234,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Whoops, fixed. Thanks!",
      "created_at": "2021-08-13T20:59:03Z",
      "updated_at": "2021-08-13T20:59:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r688777882",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688777882"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2242,
      "original_line": 2242,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688940721",
      "pull_request_review_id": 730100904,
      "id": 688940721,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODk0MDcyMQ==",
      "diff_hunk": "@@ -2208,8 +2208,43 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n     res += warn;\n }\n \n+static void UpdateTipLog(\n+    const CCoinsViewCache& coins_tip,\n+    const CBlockIndex* tip,\n+    const CChainParams& params,\n+    const std::string& func_name,\n+    const std::string& prefix,\n+    const std::string& warning_messages) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\n+{\n+\n+    AssertLockHeld(::cs_main);\n+    LogPrintf(\"%s%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\",\n+        prefix, func_name,\n+        tip->GetBlockHash().ToString(), tip->nHeight, tip->nVersion,\n+        log(tip->nChainWork.getdouble())/log(2.0), (unsigned long)tip->nChainTx,\n+        FormatISO8601DateTime(tip->GetBlockTime()),\n+        GuessVerificationProgress(params.TxData(), tip),\n+        coins_tip.DynamicMemoryUsage() * (1.0 / (1<<20)),\n+        coins_tip.GetCacheSize(),\n+        !warning_messages.empty() ? strprintf(\" warning='%s'\", warning_messages) : \"\");\n+}\n+\n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    auto& func_name = __func__;\n+    const auto& coins_tip = this->CoinsTip();\n+\n+    // The remainder of the function isn't relevant if we are not acting on\n+    // the active chainstate, so return if need be.\n+    if (this != &m_chainman.ActiveChainstate()) {\n+        // Only log every so often so that we don't bury log messages at the tip.\n+        constexpr int BACKGROUND_LOG_INTERVAL = 2000;\n+        if (pindexNew->nHeight % BACKGROUND_LOG_INTERVAL == 0) {\n+            UpdateTipLog(coins_tip, pindexNew, m_params, __func__, \"[background validation] \", \"\");",
      "path": "src/validation.cpp",
      "position": 52,
      "original_position": 36,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "011b52beb95abe8fd245218f63d6e1b3538408f9",
      "in_reply_to_id": 688746234,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nice, it worked without line 2234. Cool.",
      "created_at": "2021-08-14T15:07:32Z",
      "updated_at": "2021-08-14T15:07:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r688940721",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688940721"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2242,
      "original_line": 2242,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689543866",
      "pull_request_review_id": 730723186,
      "id": 689543866,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTU0Mzg2Ng==",
      "diff_hunk": "@@ -126,7 +126,15 @@ enum BlockStatus: uint32_t {\n     BLOCK_FAILED_CHILD       =   64, //!< descends from failed block\n     BLOCK_FAILED_MASK        =   BLOCK_FAILED_VALID | BLOCK_FAILED_CHILD,\n \n-    BLOCK_OPT_WITNESS       =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+    BLOCK_OPT_WITNESS        =   128, //!< block data in blk*.data was received with a witness-enforcing client",
      "path": "src/chain.h",
      "position": null,
      "original_position": 5,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "212b80da these two alignments are off by one, as the enumerator values/commas/comments are right-justified\r\n```diff\r\n@@ -126,7 +126,7 @@ enum BlockStatus: uint32_t {\r\n     BLOCK_FAILED_CHILD       =   64, //!< descends from failed block\r\n     BLOCK_FAILED_MASK        =   BLOCK_FAILED_VALID | BLOCK_FAILED_CHILD,\r\n \r\n-    BLOCK_OPT_WITNESS        =   128, //!< block data in blk*.data was received with a witness-enforcing client\r\n+    BLOCK_OPT_WITNESS        =  128, //!< block data in blk*.data was received with a witness-enforcing client\r\n \r\n     /**\r\n      * If set, this indicates that the block index entry is assumed-valid.\r\n@@ -134,7 +134,7 @@ enum BlockStatus: uint32_t {\r\n      * It almost certainly means that the block's full validation is pending\r\n      * on a background chainstate. See `docs/assumeutxo.md`.\r\n      */\r\n-    BLOCK_ASSUMED_VALID      =   256,\r\n+    BLOCK_ASSUMED_VALID      =  256,\r\n };\r\n```",
      "created_at": "2021-08-16T13:36:15Z",
      "updated_at": "2021-08-16T16:50:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r689543866",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689543866"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 129,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689545543",
      "pull_request_review_id": 730723186,
      "id": 689545543,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTU0NTU0Mw==",
      "diff_hunk": "@@ -2203,8 +2208,42 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n     res += warn;\n }\n \n+static void UpdateTipLog(\n+    const CCoinsViewCache& coins_tip,\n+    const CBlockIndex* tip,\n+    const CChainParams& params,\n+    const std::string& func_name,\n+    const std::string& prefix,\n+    const std::string& warning_messages) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\n+{\n+\n+    AssertLockHeld(::cs_main);\n+    LogPrintf(\"%s%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\",\n+        prefix, func_name,\n+        tip->GetBlockHash().ToString(), tip->nHeight, tip->nVersion,\n+        log(tip->nChainWork.getdouble())/log(2.0), (unsigned long)tip->nChainTx,",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "e747b53 nit, clang-formatting\r\n```suggestion\r\n        log(tip->nChainWork.getdouble()) / log(2.0), (unsigned long)tip->nChainTx,\r\n```",
      "created_at": "2021-08-16T13:38:23Z",
      "updated_at": "2021-08-16T16:50:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r689545543",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689545543"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2224,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689545997",
      "pull_request_review_id": 730723186,
      "id": 689545997,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTU0NTk5Nw==",
      "diff_hunk": "@@ -2203,8 +2208,42 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n     res += warn;\n }\n \n+static void UpdateTipLog(\n+    const CCoinsViewCache& coins_tip,\n+    const CBlockIndex* tip,\n+    const CChainParams& params,\n+    const std::string& func_name,\n+    const std::string& prefix,\n+    const std::string& warning_messages) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\n+{\n+\n+    AssertLockHeld(::cs_main);\n+    LogPrintf(\"%s%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\",\n+        prefix, func_name,\n+        tip->GetBlockHash().ToString(), tip->nHeight, tip->nVersion,\n+        log(tip->nChainWork.getdouble())/log(2.0), (unsigned long)tip->nChainTx,\n+        FormatISO8601DateTime(tip->GetBlockTime()),\n+        GuessVerificationProgress(params.TxData(), tip),\n+        coins_tip.DynamicMemoryUsage() * (1.0 / (1<<20)),",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "e747b53 nit, clang-formatting\r\n```suggestion\r\n        coins_tip.DynamicMemoryUsage() * (1.0 / (1 << 20)),\r\n```",
      "created_at": "2021-08-16T13:39:04Z",
      "updated_at": "2021-08-16T16:50:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r689545997",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689545997"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2227,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689558285",
      "pull_request_review_id": 730723186,
      "id": 689558285,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTU1ODI4NQ==",
      "diff_hunk": "@@ -126,7 +126,15 @@ enum BlockStatus: uint32_t {\n     BLOCK_FAILED_CHILD       =   64, //!< descends from failed block\n     BLOCK_FAILED_MASK        =   BLOCK_FAILED_VALID | BLOCK_FAILED_CHILD,\n \n-    BLOCK_OPT_WITNESS       =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+    BLOCK_OPT_WITNESS        =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+\n+    /**\n+     * If set, this indicates that the block index entry is assumed-valid.\n+     * Certain diagnostics will be skipped in e.g. CheckBlockIndex().\n+     * It almost certainly means that the block's full validation is pending\n+     * on a background chainstate. See `docs/assumeutxo.md`.",
      "path": "src/chain.h",
      "position": null,
      "original_position": 11,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "212b80dad5c19a043c007d79109963e301cd1400 bad url?\r\n```suggestion\r\n     * on a background chainstate. See `doc/assumeutxo.md`.\r\n```",
      "created_at": "2021-08-16T13:53:55Z",
      "updated_at": "2021-08-16T16:50:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r689558285",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689558285"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 135,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689586083",
      "pull_request_review_id": 730723186,
      "id": 689586083,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTU4NjA4Mw==",
      "diff_hunk": "@@ -4972,11 +5046,24 @@ bool ChainstateManager::PopulateAndValidateSnapshot(\n         // Fake nChainTx so that GuessVerificationProgress reports accurately\n         index->nChainTx = index->pprev ? index->pprev->nChainTx + index->nTx : 1;\n \n+        if (!index->IsValid(BLOCK_VALID_SCRIPTS)) {",
      "path": "src/validation.cpp",
      "position": 197,
      "original_position": 198,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "0a0a525 a comment here may be nice (this one is from the commit message)  \r\n```diff\r\n+       // Mark the block index entries beneath the snapshot base block as assumed-valid.\r\n        if (!index->IsValid(BLOCK_VALID_SCRIPTS)) {\r\n```",
      "created_at": "2021-08-16T14:26:45Z",
      "updated_at": "2021-08-16T16:50:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r689586083",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689586083"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5051,
      "original_line": 5051,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689614499",
      "pull_request_review_id": 730723186,
      "id": 689614499,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTYxNDQ5OQ==",
      "diff_hunk": "@@ -640,9 +647,10 @@ class CChainState\n     const std::optional<uint256> m_from_snapshot_blockhash;\n \n     /**\n-     * The set of all CBlockIndex entries with BLOCK_VALID_TRANSACTIONS (for itself and all ancestors) and\n-     * as good as our current tip or better. Entries may be failed, though, and pruning nodes may be\n-     * missing the data for the block.\n+     * The set of all CBlockIndex entries with either BLOCK_VALID_TRANSACTIONS (for\n+     * itself and all ancestors) *or* BLOCK_ASSUMED_VALID (if using background\n+     * chainstates) and as good as our current tip or better. Entries may be failed,\n+     * though, and pruning nodes may be missing the data for the block.\n      */",
      "path": "src/validation.h",
      "position": 35,
      "original_position": 35,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "00b44cda suggestion to be unambiguous that `as good as our current tip or better` applies to both cases, `BLOCK_VALID_TRANSACTIONS` and `BLOCK_ASSUMED_VALID`\r\n```diff\r\n     /**\r\n-     * The set of all CBlockIndex entries with either BLOCK_VALID_TRANSACTIONS (for\r\n-     * itself and all ancestors) *or* BLOCK_ASSUMED_VALID (if using background\r\n-     * chainstates) and as good as our current tip or better. Entries may be failed,\r\n-     * though, and pruning nodes may be missing the data for the block.\r\n+     * The set of all CBlockIndex entries as good as our current tip or better\r\n+     * with either BLOCK_VALID_TRANSACTIONS (for itself and all ancestors) *or*\r\n+     * BLOCK_ASSUMED_VALID (if using background chainstates). Entries may be\r\n+     * failed, though, and pruning nodes may be missing the data for the block.\r\n      */\r\n```\r\n",
      "created_at": "2021-08-16T14:59:46Z",
      "updated_at": "2021-08-16T16:50:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r689614499",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689614499"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 654,
      "original_line": 654,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689657609",
      "pull_request_review_id": 730723186,
      "id": 689657609,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTY1NzYwOQ==",
      "diff_hunk": "@@ -2,11 +2,14 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n //\n+#include <chainparams.h>\n #include <random.h>\n #include <uint256.h>\n #include <consensus/validation.h>\n #include <sync.h>\n+#include <rpc/blockchain.h>\n #include <test/util/setup_common.h>\n+#include <test/util/chainstate.h>",
      "path": "src/test/validation_chainstate_tests.cpp",
      "position": 10,
      "original_position": 11,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "a30a5d46 nit, sort\r\n```diff\r\n #include <chainparams.h>\r\n-#include <random.h>\r\n-#include <uint256.h>\r\n #include <consensus/validation.h>\r\n-#include <sync.h>\r\n+#include <random.h>\r\n #include <rpc/blockchain.h>\r\n-#include <test/util/setup_common.h>\r\n+#include <sync.h>\r\n #include <test/util/chainstate.h>\r\n+#include <test/util/setup_common.h>\r\n+#include <uint256.h>\r\n #include <validation.h>\r\n```\r\n",
      "created_at": "2021-08-16T15:52:17Z",
      "updated_at": "2021-08-16T16:50:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r689657609",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689657609"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 11,
      "original_line": 11,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689659807",
      "pull_request_review_id": 730723186,
      "id": 689659807,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTY1OTgwNw==",
      "diff_hunk": "@@ -9,12 +9,12 @@\n #include <rpc/blockchain.h>\n #include <sync.h>\n #include <test/util/setup_common.h>\n+#include <test/util/chainstate.h>",
      "path": "src/test/validation_chainstatemanager_tests.cpp",
      "position": 4,
      "original_position": 4,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "6b502ae nit, sort\r\n```diff\r\n-#include <test/util/setup_common.h>\r\n #include <test/util/chainstate.h>\r\n+#include <test/util/setup_common.h>\r\n```\r\n",
      "created_at": "2021-08-16T15:55:08Z",
      "updated_at": "2021-08-16T16:50:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r689659807",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689659807"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 11,
      "original_line": 11,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689696315",
      "pull_request_review_id": 730723186,
      "id": 689696315,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTY5NjMxNQ==",
      "diff_hunk": "@@ -72,4 +75,77 @@ BOOST_AUTO_TEST_CASE(validation_chainstate_resize_caches)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test UpdateTip behavior for both active and background chainstates.\n+//!\n+//! When run on the background chainstate, UpdateTip should do a subset\n+//! of what it does for the active chainstate.\n+BOOST_FIXTURE_TEST_CASE(chainstate_update_tip, TestChain100Setup)\n+{\n+    ChainstateManager& chainman = *Assert(m_node.chainman);\n+    uint256 curr_tip = ::g_best_block;\n+\n+    // Mine 10 more blocks, putting at us height 110 where a valid assumeutxo value can\n+    // be found.\n+    mineBlocks(10);\n+\n+    // After adding some blocks to the tip, best block should have changed.\n+    BOOST_CHECK(::g_best_block != curr_tip);\n+\n+    BOOST_REQUIRE(CreateAndActivateUTXOSnapshot(m_node, m_path_root));\n+\n+    // Ensure our active chain is the snapshot chainstate.\n+    BOOST_CHECK(chainman.IsSnapshotActive());\n+\n+    curr_tip = ::g_best_block;\n+\n+    // Mine a new block on top of the activated snapshot chainstate.\n+    mineBlocks(1);  // Defined in TestChain100Setup.\n+\n+    // After adding some blocks to the snapshot tip, best block should have changed.",
      "path": "src/test/validation_chainstate_tests.cpp",
      "position": 44,
      "original_position": 45,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "a30a5d46\r\n```suggestion\r\n    // After adding a block to the snapshot tip, best block should have changed.\r\n```",
      "created_at": "2021-08-16T16:44:51Z",
      "updated_at": "2021-08-16T16:50:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r689696315",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689696315"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 104,
      "original_line": 104,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689728139",
      "pull_request_review_id": 730967337,
      "id": 689728139,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTcyODEzOQ==",
      "diff_hunk": "@@ -300,13 +308,23 @@ class CBlockIndex\n         return ((nStatus & BLOCK_VALID_MASK) >= nUpTo);\n     }\n \n+    //! @returns true if the block is assumed-valid; probably means it is queued to be\n+    //!   validated by a background chainstate.\n+    bool IsAssumedValid() const { return nStatus & BLOCK_ASSUMED_VALID; }\n+\n     //! Raise the validity level of this block index entry.\n     //! Returns true if the validity was changed.\n     bool RaiseValidity(enum BlockStatus nUpTo)\n     {\n         assert(!(nUpTo & ~BLOCK_VALID_MASK)); // Only validity flags allowed.\n-        if (nStatus & BLOCK_FAILED_MASK)\n-            return false;\n+        if (nStatus & BLOCK_FAILED_MASK) return false;\n+\n+        // If this block had been marked assumed-valid and we're raising\n+        // its validity to a certain point, there is no longer an assumption.\n+        if (nStatus & BLOCK_ASSUMED_VALID && nUpTo >= BLOCK_VALID_SCRIPTS) {",
      "path": "src/chain.h",
      "position": null,
      "original_position": 36,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "212b80dad perhaps use the bool helper added in this commit?\r\n```suggestion\r\n        if (IsAssumedValid() && nUpTo >= BLOCK_VALID_SCRIPTS) {\r\n```",
      "created_at": "2021-08-16T17:32:32Z",
      "updated_at": "2021-08-16T17:32:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r689728139",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689728139"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 324,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696052308",
      "pull_request_review_id": 738750998,
      "id": 696052308,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NjA1MjMwOA==",
      "diff_hunk": "@@ -300,13 +308,23 @@ class CBlockIndex\n         return ((nStatus & BLOCK_VALID_MASK) >= nUpTo);\n     }\n \n+    //! @returns true if the block is assumed-valid; probably means it is queued to be",
      "path": "src/chain.h",
      "position": null,
      "original_position": 21,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "212b80dad5c19a043c007d79109963e301cd1400",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 212b80dad5c19a043c007d79109963e301cd1400\r\n\r\nWhy only probably? Is it possible or planned that this will not be the case?",
      "created_at": "2021-08-25T19:30:11Z",
      "updated_at": "2021-08-25T23:48:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r696052308",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696052308"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 311,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696064167",
      "pull_request_review_id": 738750998,
      "id": 696064167,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NjA2NDE2Nw==",
      "diff_hunk": "@@ -4317,6 +4317,7 @@ void CChainState::CheckBlockIndex()\n     }\n \n     LOCK(cs_main);\n+    bool is_active = this == &m_chainman.ActiveChainstate();",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "ed0d83a3d2c5752ef2424dee7c849933fdc39452",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in ed0d83a3d2c5752ef2424dee7c849933fdc39452\r\n\r\nnit: could be `const` but also `is_active` is only used once below in a line that might not even run due to other conditionals so maybe it doesn't need to be placed up here? Unless this is used more in follow-ups?",
      "created_at": "2021-08-25T19:49:02Z",
      "updated_at": "2021-08-25T23:48:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r696064167",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696064167"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4320,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696103308",
      "pull_request_review_id": 738750998,
      "id": 696103308,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NjEwMzMwOA==",
      "diff_hunk": "@@ -4370,7 +4392,9 @@ void CChainState::CheckBlockIndex()\n         if (!pindex->HaveTxsDownloaded()) assert(pindex->nSequenceId <= 0); // nSequenceId can't be set positive for blocks that aren't linked (negative is used for preciousblock)\n         // VALID_TRANSACTIONS is equivalent to nTx > 0 for all nodes (whether or not pruning has occurred).\n         // HAVE_DATA is only equivalent to nTx > 0 (or VALID_TRANSACTIONS) if no pruning has occurred.\n-        if (!fHavePruned) {\n+        // Unless these indexes are assumed valid and pending block download on a\n+        // background chainstate..",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 52,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "ed0d83a3d2c5752ef2424dee7c849933fdc39452",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in ed0d83a3d2c5752ef2424dee7c849933fdc39452\r\n\r\nnit: s/.././",
      "created_at": "2021-08-25T20:50:21Z",
      "updated_at": "2021-08-25T23:48:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r696103308",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696103308"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4396,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696150649",
      "pull_request_review_id": 738750998,
      "id": 696150649,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NjE1MDY0OQ==",
      "diff_hunk": "@@ -126,7 +126,15 @@ enum BlockStatus: uint32_t {\n     BLOCK_FAILED_CHILD       =   64, //!< descends from failed block\n     BLOCK_FAILED_MASK        =   BLOCK_FAILED_VALID | BLOCK_FAILED_CHILD,\n \n-    BLOCK_OPT_WITNESS       =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+    BLOCK_OPT_WITNESS        =   128, //!< block data in blk*.data was received with a witness-enforcing client",
      "path": "src/chain.h",
      "position": null,
      "original_position": 5,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "in_reply_to_id": 689543866,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 212b80dad5c19a043c007d79109963e301cd1400\r\n\r\nThe block files actually also have a `.dat` extension, not `.data`, if you retouch...",
      "created_at": "2021-08-25T22:15:41Z",
      "updated_at": "2021-08-25T23:48:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r696150649",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696150649"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 129,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696169810",
      "pull_request_review_id": 738750998,
      "id": 696169810,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NjE2OTgxMA==",
      "diff_hunk": "@@ -300,13 +308,23 @@ class CBlockIndex\n         return ((nStatus & BLOCK_VALID_MASK) >= nUpTo);\n     }\n \n+    //! @returns true if the block is assumed-valid; probably means it is queued to be\n+    //!   validated by a background chainstate.\n+    bool IsAssumedValid() const { return nStatus & BLOCK_ASSUMED_VALID; }\n+\n     //! Raise the validity level of this block index entry.\n     //! Returns true if the validity was changed.\n     bool RaiseValidity(enum BlockStatus nUpTo)\n     {\n         assert(!(nUpTo & ~BLOCK_VALID_MASK)); // Only validity flags allowed.\n-        if (nStatus & BLOCK_FAILED_MASK)\n-            return false;\n+        if (nStatus & BLOCK_FAILED_MASK) return false;\n+\n+        // If this block had been marked assumed-valid and we're raising\n+        // its validity to a certain point, there is no longer an assumption.\n+        if (nStatus & BLOCK_ASSUMED_VALID && nUpTo >= BLOCK_VALID_SCRIPTS) {",
      "path": "src/chain.h",
      "position": null,
      "original_position": 36,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "212b80dad5c19a043c007d79109963e301cd1400",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 212b80dad5c19a043c007d79109963e301cd1400\r\n\r\nIf a block had `nStatus = BLOCK_VALID_SCRIPTS | BLOCK_ASSUMED_VALID` and `RaiseValidity(BLOCK_VALID_SCRIPTS)` was called on it then `nStatus` would change but the function would still return false if I see that correctly. But it seems like an extreme edge case that may be impossible to hit but I am not 100% sure. In general it would be nicer if the function could never return false if a change in status happens.",
      "created_at": "2021-08-25T23:01:56Z",
      "updated_at": "2021-08-25T23:48:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r696169810",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696169810"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 324,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696180570",
      "pull_request_review_id": 738750998,
      "id": 696180570,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NjE4MDU3MA==",
      "diff_hunk": "@@ -72,4 +75,77 @@ BOOST_AUTO_TEST_CASE(validation_chainstate_resize_caches)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test UpdateTip behavior for both active and background chainstates.",
      "path": "src/test/validation_chainstate_tests.cpp",
      "position": 18,
      "original_position": 19,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "in_reply_to_id": null,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in a30a5d46b3574a49f9e3611caeb730bf12d748fd\r\n\r\nnit: I find it a bit strange to refer to a specific function being tested in a unit test when it's not actually called in the test itself since such comments may rot without notice. I would have preferred something a bit more generic like \"Test that active and background chainstates can update their tip independently of each other\".",
      "created_at": "2021-08-25T23:30:31Z",
      "updated_at": "2021-08-25T23:48:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r696180570",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696180570"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 78,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696182813",
      "pull_request_review_id": 738913608,
      "id": 696182813,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NjE4MjgxMw==",
      "diff_hunk": "@@ -2208,8 +2208,42 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n     res += warn;\n }\n \n+static void UpdateTipLog(\n+    const CCoinsViewCache& coins_tip,\n+    const CBlockIndex* tip,\n+    const CChainParams& params,\n+    const std::string& func_name,\n+    const std::string& prefix,\n+    const std::string& warning_messages) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\n+{\n+\n+    AssertLockHeld(::cs_main);\n+    LogPrintf(\"%s%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\",",
      "path": "src/validation.cpp",
      "position": 31,
      "original_position": 14,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "e747b5379f5f57c8732d42b07515118e305ddb18",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Note, if you want to provide one supplemental information to the node operator and find an usage for the `IsBackgroundIBD` deleted in the previous commit, I think you can add a `chainstate=%s` by passing an arg `const bool is_snapshot` and value=`!m_chainman.IsBackgroundIBD()` ?",
      "created_at": "2021-08-25T23:36:49Z",
      "updated_at": "2021-08-26T00:18:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r696182813",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696182813"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2221,
      "original_line": 2221,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696185527",
      "pull_request_review_id": 738913608,
      "id": 696185527,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NjE4NTUyNw==",
      "diff_hunk": "@@ -126,7 +126,15 @@ enum BlockStatus: uint32_t {\n     BLOCK_FAILED_CHILD       =   64, //!< descends from failed block\n     BLOCK_FAILED_MASK        =   BLOCK_FAILED_VALID | BLOCK_FAILED_CHILD,\n \n-    BLOCK_OPT_WITNESS       =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+    BLOCK_OPT_WITNESS        =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+\n+    /**\n+     * If set, this indicates that the block index entry is assumed-valid.\n+     * Certain diagnostics will be skipped in e.g. CheckBlockIndex().\n+     * It almost certainly means that the block's full validation is pending\n+     * on a background chainstate. See `docs/assumeutxo.md`.",
      "path": "src/chain.h",
      "position": null,
      "original_position": 11,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "212b80dad5c19a043c007d79109963e301cd1400",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I had an overlook on `assumeutxo.md`, I think it's a mature enough documentation to be landed in-tree in a follow-up PR. At least, it was helpful for me as a reminder on design trade-offs.",
      "created_at": "2021-08-25T23:44:07Z",
      "updated_at": "2021-08-26T00:18:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r696185527",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696185527"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 135,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696190873",
      "pull_request_review_id": 738913608,
      "id": 696190873,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NjE5MDg3Mw==",
      "diff_hunk": "@@ -126,7 +126,15 @@ enum BlockStatus: uint32_t {\n     BLOCK_FAILED_CHILD       =   64, //!< descends from failed block\n     BLOCK_FAILED_MASK        =   BLOCK_FAILED_VALID | BLOCK_FAILED_CHILD,\n \n-    BLOCK_OPT_WITNESS       =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+    BLOCK_OPT_WITNESS        =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+\n+    /**\n+     * If set, this indicates that the block index entry is assumed-valid.\n+     * Certain diagnostics will be skipped in e.g. CheckBlockIndex().\n+     * It almost certainly means that the block's full validation is pending\n+     * on a background chainstate. See `docs/assumeutxo.md`.\n+     */\n+    BLOCK_ASSUMED_VALID      =   256,",
      "path": "src/chain.h",
      "position": 13,
      "original_position": 13,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "212b80dad5c19a043c007d79109963e301cd1400",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Note, I'm dubious on the flag name choice as we already have a distinct lightweight IBD feature `assumevalid`. Even if their security model are pretty similar, I don't think they are fully-overlapping. What consensus failure case which would be caught by an `assumevalid=X` client but not by an `assume-utxo=X` client (before background IBD is over) would be an inflation bug similar to CVE-2018-17144. For an `assumevalid` client, `CheckTransaction` then `CheckBlock` then `ConnectBlock` which is not skipped by `!hashAssumeValid.IsNull()`.\r\n\r\nI believe another flag name like `BLOCK_UTXO_ASSUMED` would be more adequate to avoid features confusion towards developers and node operators.\r\n\r\nWhat do you think ?",
      "created_at": "2021-08-25T23:59:17Z",
      "updated_at": "2021-08-26T00:18:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r696190873",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696190873"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 137,
      "original_line": 137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696197191",
      "pull_request_review_id": 738913608,
      "id": 696197191,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NjE5NzE5MQ==",
      "diff_hunk": "@@ -3773,7 +3773,9 @@ bool BlockManager::LoadBlockIndex(\n             pindex->nStatus |= BLOCK_FAILED_CHILD;\n             setDirtyBlockIndex.insert(pindex);\n         }\n-        if (pindex->IsValid(BLOCK_VALID_TRANSACTIONS) && (pindex->HaveTxsDownloaded() || pindex->pprev == nullptr)) {\n+        if (pindex->IsAssumedValid() ||",
      "path": "src/validation.cpp",
      "position": 79,
      "original_position": 5,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "00b44cdaec4d07c9338e59a42d6525e9e87d3912",
      "in_reply_to_id": null,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't get the rational of this change, `IsAssumeValid` blocks are ones lower than the best current _snapshot_ tip and as such won't be on a better-work chain and shouldn't be candidate for tip inclusion in `FindMostWorkChain` ? Or do you have a commit in #15606 pointing how it is used ?",
      "created_at": "2021-08-26T00:17:30Z",
      "updated_at": "2021-08-26T00:18:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r696197191",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696197191"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3776,
      "original_line": 3776,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701840983",
      "pull_request_review_id": 746037444,
      "id": 701840983,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMTg0MDk4Mw==",
      "diff_hunk": "@@ -126,7 +126,15 @@ enum BlockStatus: uint32_t {\n     BLOCK_FAILED_CHILD       =   64, //!< descends from failed block\n     BLOCK_FAILED_MASK        =   BLOCK_FAILED_VALID | BLOCK_FAILED_CHILD,\n \n-    BLOCK_OPT_WITNESS       =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+    BLOCK_OPT_WITNESS        =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+\n+    /**\n+     * If set, this indicates that the block index entry is assumed-valid.\n+     * Certain diagnostics will be skipped in e.g. CheckBlockIndex().\n+     * It almost certainly means that the block's full validation is pending\n+     * on a background chainstate. See `docs/assumeutxo.md`.\n+     */\n+    BLOCK_ASSUMED_VALID      =   256,",
      "path": "src/chain.h",
      "position": 13,
      "original_position": 13,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "212b80dad5c19a043c007d79109963e301cd1400",
      "in_reply_to_id": 696190873,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I low-key agree.",
      "created_at": "2021-09-03T12:11:56Z",
      "updated_at": "2021-09-03T12:11:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r701840983",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701840983"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 137,
      "original_line": 137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/704625003",
      "pull_request_review_id": 749420892,
      "id": 704625003,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNDYyNTAwMw==",
      "diff_hunk": "@@ -3773,7 +3773,9 @@ bool BlockManager::LoadBlockIndex(\n             pindex->nStatus |= BLOCK_FAILED_CHILD;\n             setDirtyBlockIndex.insert(pindex);\n         }\n-        if (pindex->IsValid(BLOCK_VALID_TRANSACTIONS) && (pindex->HaveTxsDownloaded() || pindex->pprev == nullptr)) {\n+        if (pindex->IsAssumedValid() ||",
      "path": "src/validation.cpp",
      "position": 79,
      "original_position": 5,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "00b44cdaec4d07c9338e59a42d6525e9e87d3912",
      "in_reply_to_id": 696197191,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't totally understand your comment here. This is a necessary change so that when loading a snapshot-based chainstate, the (assumed-valid) tip is able to be added as a tip candidate, since otherwise it would be excluded on the basis of `!HaveTxsDownloaded()`.",
      "created_at": "2021-09-08T17:22:26Z",
      "updated_at": "2021-09-08T17:22:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r704625003",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/704625003"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3776,
      "original_line": 3776,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/704667203",
      "pull_request_review_id": 749475714,
      "id": 704667203,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNDY2NzIwMw==",
      "diff_hunk": "@@ -126,7 +126,15 @@ enum BlockStatus: uint32_t {\n     BLOCK_FAILED_CHILD       =   64, //!< descends from failed block\n     BLOCK_FAILED_MASK        =   BLOCK_FAILED_VALID | BLOCK_FAILED_CHILD,\n \n-    BLOCK_OPT_WITNESS       =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+    BLOCK_OPT_WITNESS        =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+\n+    /**\n+     * If set, this indicates that the block index entry is assumed-valid.\n+     * Certain diagnostics will be skipped in e.g. CheckBlockIndex().\n+     * It almost certainly means that the block's full validation is pending\n+     * on a background chainstate. See `docs/assumeutxo.md`.\n+     */\n+    BLOCK_ASSUMED_VALID      =   256,",
      "path": "src/chain.h",
      "position": 13,
      "original_position": 13,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "212b80dad5c19a043c007d79109963e301cd1400",
      "in_reply_to_id": 696190873,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/21526#discussion_r696190873\r\n\r\nJames asked me about the flag again, and I don't have much new to add so I'll just restate what I wrote https://github.com/bitcoin/bitcoin/pull/21526#discussion_r674198521 and https://github.com/bitcoin/bitcoin/pull/21526#discussion_r683813701, which is that I don't like complexity of flags being added and then removed instead of just being cumulative. I don't like flags trying to tell me what I should be assuming about a block, instead of just telling me what kind of validation was actually done on the block. So I'd drop the \"assume\" flag and use something like BLOCK_VALIDATED_FROM_GENESIS, BLOCK_VALIDATED_FROM_SNAPSHOT flags instead. Or not have any new flag and just have validated begin/end pointers or height ranges.\r\n\r\nBut assuming flag implementation isn't going to change at this point, ariard's suggestion to add something about utxos or snapshots to the flag name does not seem like a bad idea. I don't really see how confusion with the assumevalid feature would be possible, but also don't see drawbacks to making the flag name more descriptive.\r\n\r\nAnd all of this is definitely bikeshedding! Current flag seems perfectly reasonable and not confusing in any way I could realistically see.",
      "created_at": "2021-09-08T18:21:39Z",
      "updated_at": "2021-09-08T18:21:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r704667203",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/704667203"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 137,
      "original_line": 137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/704759266",
      "pull_request_review_id": 749597324,
      "id": 704759266,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNDc1OTI2Ng==",
      "diff_hunk": "@@ -300,13 +308,23 @@ class CBlockIndex\n         return ((nStatus & BLOCK_VALID_MASK) >= nUpTo);\n     }\n \n+    //! @returns true if the block is assumed-valid; probably means it is queued to be\n+    //!   validated by a background chainstate.\n+    bool IsAssumedValid() const { return nStatus & BLOCK_ASSUMED_VALID; }\n+\n     //! Raise the validity level of this block index entry.\n     //! Returns true if the validity was changed.\n     bool RaiseValidity(enum BlockStatus nUpTo)\n     {\n         assert(!(nUpTo & ~BLOCK_VALID_MASK)); // Only validity flags allowed.\n-        if (nStatus & BLOCK_FAILED_MASK)\n-            return false;\n+        if (nStatus & BLOCK_FAILED_MASK) return false;\n+\n+        // If this block had been marked assumed-valid and we're raising\n+        // its validity to a certain point, there is no longer an assumption.\n+        if (nStatus & BLOCK_ASSUMED_VALID && nUpTo >= BLOCK_VALID_SCRIPTS) {",
      "path": "src/chain.h",
      "position": null,
      "original_position": 36,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "in_reply_to_id": 689728139,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Given I'm unsetting the same flag just below I think this could be somewhat confusing.",
      "created_at": "2021-09-08T20:43:54Z",
      "updated_at": "2021-09-08T20:43:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r704759266",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/704759266"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 324,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/704760532",
      "pull_request_review_id": 749599033,
      "id": 704760532,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNDc2MDUzMg==",
      "diff_hunk": "@@ -2208,8 +2208,42 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n     res += warn;\n }\n \n+static void UpdateTipLog(\n+    const CCoinsViewCache& coins_tip,\n+    const CBlockIndex* tip,\n+    const CChainParams& params,\n+    const std::string& func_name,\n+    const std::string& prefix,\n+    const std::string& warning_messages) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\n+{\n+\n+    AssertLockHeld(::cs_main);\n+    LogPrintf(\"%s%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\",",
      "path": "src/validation.cpp",
      "position": 31,
      "original_position": 14,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "e747b5379f5f57c8732d42b07515118e305ddb18",
      "in_reply_to_id": 696182813,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't understand... this already distinguishes for background chainstates with the `prefix` string.",
      "created_at": "2021-09-08T20:45:59Z",
      "updated_at": "2021-09-08T20:45:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r704760532",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/704760532"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2221,
      "original_line": 2221,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/704769552",
      "pull_request_review_id": 749610578,
      "id": 704769552,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNDc2OTU1Mg==",
      "diff_hunk": "@@ -126,7 +126,15 @@ enum BlockStatus: uint32_t {\n     BLOCK_FAILED_CHILD       =   64, //!< descends from failed block\n     BLOCK_FAILED_MASK        =   BLOCK_FAILED_VALID | BLOCK_FAILED_CHILD,\n \n-    BLOCK_OPT_WITNESS       =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+    BLOCK_OPT_WITNESS        =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+\n+    /**\n+     * If set, this indicates that the block index entry is assumed-valid.\n+     * Certain diagnostics will be skipped in e.g. CheckBlockIndex().\n+     * It almost certainly means that the block's full validation is pending\n+     * on a background chainstate. See `docs/assumeutxo.md`.\n+     */\n+    BLOCK_ASSUMED_VALID      =   256,",
      "path": "src/chain.h",
      "position": 13,
      "original_position": 13,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "212b80dad5c19a043c007d79109963e301cd1400",
      "in_reply_to_id": 696190873,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks again @ryanofsky for weighing in.\r\n\r\n> I don't like complexity of flags being added and then removed instead of just being cumulative\r\n\r\nI agree that ideally it would be better to set flags once and never touch them subsequently, but there is a need to remove the ASSUMED flag on block index entries as they're validated so that CheckBlockIndex eventually returns to its normal behavior. I'm sure there's some way we could do that with some combination of flags that are set once and never unset, but I think that would probably require a much bigger change and is more trouble than I think is worth.\r\n\r\n---\r\n\r\n@ariard @naumenkogs unless there is significant dissent, I'm keeping this name as-is. Part of what motivated this change in the first place was to avoid leaking \"assumeutxo\" specifics out into the rest of the system; if we change the name of this flag, we then have to change `pindex->IsAssumedValid()` to something like `IsAssumedUtxo()` which then leaks that detail again; and I don't find that name change to be sufficiently descriptive to make that worthwhile.\r\n\r\nBLOCK_ASSUMED_VALID is the correct name here because the block is assumed to be valid; it has not yet actually been encountered by the system. I don't think that confusion with the `-assumevalid=` CLI flag (which should really be something like `-skipsigsbeneath=`) is really going to trip someone up here looking at block index flags. The other thing is that BLOCK_UTXO_ASSUMED doesn't strike me as sufficiently descriptive - the block index shouldn't care _why_ we're assuming the thing valid, and if we end up doing parallel validation with something like utreexo, the over-specified name will only be more confusing and out of date.",
      "created_at": "2021-09-08T21:00:05Z",
      "updated_at": "2021-09-08T21:00:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r704769552",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/704769552"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 137,
      "original_line": 137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/705146871",
      "pull_request_review_id": 750091389,
      "id": 705146871,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNTE0Njg3MQ==",
      "diff_hunk": "@@ -126,7 +126,15 @@ enum BlockStatus: uint32_t {\n     BLOCK_FAILED_CHILD       =   64, //!< descends from failed block\n     BLOCK_FAILED_MASK        =   BLOCK_FAILED_VALID | BLOCK_FAILED_CHILD,\n \n-    BLOCK_OPT_WITNESS       =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+    BLOCK_OPT_WITNESS        =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+\n+    /**\n+     * If set, this indicates that the block index entry is assumed-valid.\n+     * Certain diagnostics will be skipped in e.g. CheckBlockIndex().\n+     * It almost certainly means that the block's full validation is pending\n+     * on a background chainstate. See `docs/assumeutxo.md`.\n+     */\n+    BLOCK_ASSUMED_VALID      =   256,",
      "path": "src/chain.h",
      "position": 13,
      "original_position": 13,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "212b80dad5c19a043c007d79109963e301cd1400",
      "in_reply_to_id": 696190873,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Not gonna insist.\r\nPerhaps, the confusion with `-assumevalid=` matters only for me, someone who looks at this part of the code for the second time.",
      "created_at": "2021-09-09T09:18:35Z",
      "updated_at": "2021-09-09T09:18:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r705146871",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/705146871"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 137,
      "original_line": 137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/705328793",
      "pull_request_review_id": 750335274,
      "id": 705328793,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNTMyODc5Mw==",
      "diff_hunk": "@@ -300,13 +308,23 @@ class CBlockIndex\n         return ((nStatus & BLOCK_VALID_MASK) >= nUpTo);\n     }\n \n+    //! @returns true if the block is assumed-valid; probably means it is queued to be\n+    //!   validated by a background chainstate.\n+    bool IsAssumedValid() const { return nStatus & BLOCK_ASSUMED_VALID; }\n+\n     //! Raise the validity level of this block index entry.\n     //! Returns true if the validity was changed.\n     bool RaiseValidity(enum BlockStatus nUpTo)\n     {\n         assert(!(nUpTo & ~BLOCK_VALID_MASK)); // Only validity flags allowed.\n-        if (nStatus & BLOCK_FAILED_MASK)\n-            return false;\n+        if (nStatus & BLOCK_FAILED_MASK) return false;\n+\n+        // If this block had been marked assumed-valid and we're raising\n+        // its validity to a certain point, there is no longer an assumption.\n+        if (nStatus & BLOCK_ASSUMED_VALID && nUpTo >= BLOCK_VALID_SCRIPTS) {",
      "path": "src/chain.h",
      "position": null,
      "original_position": 36,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "212b80dad5c19a043c007d79109963e301cd1400",
      "in_reply_to_id": 696169810,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I've changed the code to ensure this can't happen, thanks.",
      "created_at": "2021-09-09T13:24:51Z",
      "updated_at": "2021-09-09T13:24:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r705328793",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/705328793"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 324,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709379079",
      "pull_request_review_id": 755382331,
      "id": 709379079,
      "node_id": "PRRC_kwDOABII584qSEQH",
      "diff_hunk": "@@ -2208,8 +2208,42 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n     res += warn;\n }\n \n+static void UpdateTipLog(\n+    const CCoinsViewCache& coins_tip,\n+    const CBlockIndex* tip,\n+    const CChainParams& params,\n+    const std::string& func_name,\n+    const std::string& prefix,\n+    const std::string& warning_messages) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\n+{\n+\n+    AssertLockHeld(::cs_main);\n+    LogPrintf(\"%s%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\",\n+        prefix, func_name,\n+        tip->GetBlockHash().ToString(), tip->nHeight, tip->nVersion,\n+        log(tip->nChainWork.getdouble()) / log(2.0), (unsigned long)tip->nChainTx,\n+        FormatISO8601DateTime(tip->GetBlockTime()),\n+        GuessVerificationProgress(params.TxData(), tip),\n+        coins_tip.DynamicMemoryUsage() * (1.0 / (1 << 20)),\n+        coins_tip.GetCacheSize(),\n+        !warning_messages.empty() ? strprintf(\" warning='%s'\", warning_messages) : \"\");\n+}\n+\n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    const auto& coins_tip = this->CoinsTip();\n+\n+    // The remainder of the function isn't relevant if we are not acting on\n+    // the active chainstate, so return if need be.\n+    if (this != &m_chainman.ActiveChainstate()) {\n+        // Only log every so often so that we don't bury log messages at the tip.\n+        constexpr int BACKGROUND_LOG_INTERVAL = 2000;",
      "path": "src/validation.cpp",
      "position": 50,
      "original_position": 33,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b3825c27bba2953bf96cfe0f685997e1524ee50c",
      "in_reply_to_id": null,
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "should this be configurable (e.g., in case needed for debugging?)",
      "created_at": "2021-09-15T17:01:42Z",
      "updated_at": "2021-09-15T17:01:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r709379079",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709379079"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2240,
      "original_line": 2240,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709380311",
      "pull_request_review_id": 755386086,
      "id": 709380311,
      "node_id": "PRRC_kwDOABII584qSEjX",
      "diff_hunk": "@@ -109,6 +109,7 @@ extern RecursiveMutex cs_main;\n typedef std::unordered_map<uint256, CBlockIndex*, BlockHasher> BlockMap;\n extern Mutex g_best_block_mutex;\n extern std::condition_variable g_best_block_cv;\n+/** Used to notify getblocktemplate RPC of new tips. */",
      "path": "src/validation.h",
      "position": 4,
      "original_position": 4,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b3825c27bba2953bf96cfe0f685997e1524ee50c",
      "in_reply_to_id": null,
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: why this comment here?",
      "created_at": "2021-09-15T17:03:26Z",
      "updated_at": "2021-09-15T17:03:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r709380311",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709380311"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 112,
      "original_line": 112,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709382769",
      "pull_request_review_id": 755393952,
      "id": 709382769,
      "node_id": "PRRC_kwDOABII584qSFJx",
      "diff_hunk": "@@ -126,7 +126,15 @@ enum BlockStatus: uint32_t {\n     BLOCK_FAILED_CHILD       =   64, //!< descends from failed block\n     BLOCK_FAILED_MASK        =   BLOCK_FAILED_VALID | BLOCK_FAILED_CHILD,\n \n-    BLOCK_OPT_WITNESS       =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+    BLOCK_OPT_WITNESS        =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+\n+    /**\n+     * If set, this indicates that the block index entry is assumed-valid.\n+     * Certain diagnostics will be skipped in e.g. CheckBlockIndex().\n+     * It almost certainly means that the block's full validation is pending\n+     * on a background chainstate. See `docs/assumeutxo.md`.\n+     */\n+    BLOCK_ASSUMED_VALID      =   256,",
      "path": "src/chain.h",
      "position": 13,
      "original_position": 13,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "212b80dad5c19a043c007d79109963e301cd1400",
      "in_reply_to_id": 696190873,
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "One of the benefits of the 'cumulative' flags is that you can prove the block validity state transitions are finite through consumption of the flag.\r\n\r\nHowever, it's easy to prove this by inspection as well, so I think the current design is OK. ",
      "created_at": "2021-09-15T17:07:00Z",
      "updated_at": "2021-09-15T17:07:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r709382769",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709382769"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 137,
      "original_line": 137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709389720",
      "pull_request_review_id": 755416072,
      "id": 709389720,
      "node_id": "PRRC_kwDOABII584qSG2Y",
      "diff_hunk": "@@ -300,14 +308,24 @@ class CBlockIndex\n         return ((nStatus & BLOCK_VALID_MASK) >= nUpTo);\n     }\n \n+    //! @returns true if the block is assumed-valid; this means it is queued to be\n+    //!   validated by a background chainstate.\n+    bool IsAssumedValid() const { return nStatus & BLOCK_ASSUMED_VALID; }\n+\n     //! Raise the validity level of this block index entry.\n     //! Returns true if the validity was changed.\n     bool RaiseValidity(enum BlockStatus nUpTo)\n     {\n         assert(!(nUpTo & ~BLOCK_VALID_MASK)); // Only validity flags allowed.\n-        if (nStatus & BLOCK_FAILED_MASK)\n-            return false;\n+        if (nStatus & BLOCK_FAILED_MASK) return false;\n+\n         if ((nStatus & BLOCK_VALID_MASK) < nUpTo) {\n+            // If this block had been marked assumed-valid and we're raising\n+            // its validity to a certain point, there is no longer an assumption.\n+            if (nStatus & BLOCK_ASSUMED_VALID && nUpTo >= BLOCK_VALID_SCRIPTS) {",
      "path": "src/chain.h",
      "position": 37,
      "original_position": 37,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "ae115458a14b2ec33be25172c3af3ff3a3a777fa",
      "in_reply_to_id": null,
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: an invalid nUpTo such as 6 or 7 could corrupt the result here. Consider 4|3 which is (BLOCK_VALID_CHAIN|BLOCK_VALID_TRANSACTIONS). I don't think this can actually happen though.\r\n\r\nIt might be better to explicitly check nUpTo is either exactly BLOCK_VALID_SCRIPTS?",
      "created_at": "2021-09-15T17:16:38Z",
      "updated_at": "2021-09-15T17:16:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r709389720",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709389720"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 325,
      "original_line": 325,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709392990",
      "pull_request_review_id": 755422609,
      "id": 709392990,
      "node_id": "PRRC_kwDOABII584qSHpe",
      "diff_hunk": "@@ -5007,11 +5007,25 @@ bool ChainstateManager::PopulateAndValidateSnapshot(\n         // Fake nChainTx so that GuessVerificationProgress reports accurately\n         index->nChainTx = index->pprev ? index->pprev->nChainTx + index->nTx : 1;\n \n+        // Mark unvalidated block index entries beneath the snapshot base block as assumed-valid.\n+        if (!index->IsValid(BLOCK_VALID_SCRIPTS)) {\n+            // This flag will be removed once the block is fully validated by a\n+            // background chainstate.\n+            index->nStatus |= BLOCK_ASSUMED_VALID;\n+        }\n+\n         // Fake BLOCK_OPT_WITNESS so that CChainState::NeedsRedownload()\n         // won't ask to rewind the entire assumed-valid chain on startup.\n         if (index->pprev && DeploymentActiveAt(*index, ::Params().GetConsensus(), Consensus::DEPLOYMENT_SEGWIT)) {\n             index->nStatus |= BLOCK_OPT_WITNESS;\n         }\n+\n+        setDirtyBlockIndex.insert(index);",
      "path": "src/validation.cpp",
      "position": 209,
      "original_position": 17,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "4907b8673a91e762d702e6c3413f29190f0d813b",
      "in_reply_to_id": null,
      "user": {
        "login": "JeremyRubin",
        "id": 886523,
        "node_id": "MDQ6VXNlcjg4NjUyMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JeremyRubin",
        "html_url": "https://github.com/JeremyRubin",
        "followers_url": "https://api.github.com/users/JeremyRubin/followers",
        "following_url": "https://api.github.com/users/JeremyRubin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/JeremyRubin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/JeremyRubin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
        "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
        "repos_url": "https://api.github.com/users/JeremyRubin/repos",
        "events_url": "https://api.github.com/users/JeremyRubin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "shouldn't we be tracking if we actually made any changes before marking dirty?",
      "created_at": "2021-09-15T17:20:13Z",
      "updated_at": "2021-09-15T17:20:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r709392990",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709392990"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5063,
      "original_line": 5063,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709404714",
      "pull_request_review_id": 755431993,
      "id": 709404714,
      "node_id": "PRRC_kwDOABII584qSKgq",
      "diff_hunk": "@@ -0,0 +1,54 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+#ifndef BITCOIN_TEST_UTIL_CHAINSTATE_H\n+#define BITCOIN_TEST_UTIL_CHAINSTATE_H\n+\n+#include <clientversion.h>\n+#include <fs.h>\n+#include <node/context.h>\n+#include <node/utxo_snapshot.h>\n+#include <rpc/blockchain.h>\n+#include <validation.h>\n+\n+#include <univalue.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+auto NoMalleation = [](CAutoFile& file, SnapshotMetadata& meta){};",
      "path": "src/test/util/chainstate.h",
      "position": null,
      "original_position": 19,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "529f5055675f6c7f734796a8339761b6c1ba13b9",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"move-only: unittest: add test/util/chainstate.h\" (529f5055675f6c7f734796a8339761b6c1ba13b9)\r\n\r\nCan declare this `const auto` instead of `auto` to avoid link errors marco and achow are reporting\r\n\r\n- https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-918540412\r\n- https://github.com/bitcoin/bitcoin/pull/21526#issuecomment-919945778\r\n- https://stackoverflow.com/questions/18113164/lambda-in-header-file-error",
      "created_at": "2021-09-15T17:29:56Z",
      "updated_at": "2021-09-15T17:29:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r709404714",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709404714"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709520614",
      "pull_request_review_id": 755552816,
      "id": 709520614,
      "node_id": "PRRC_kwDOABII584qSmzm",
      "diff_hunk": "@@ -109,6 +109,7 @@ extern RecursiveMutex cs_main;\n typedef std::unordered_map<uint256, CBlockIndex*, BlockHasher> BlockMap;\n extern Mutex g_best_block_mutex;\n extern std::condition_variable g_best_block_cv;\n+/** Used to notify getblocktemplate RPC of new tips. */",
      "path": "src/validation.h",
      "position": 4,
      "original_position": 4,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b3825c27bba2953bf96cfe0f685997e1524ee50c",
      "in_reply_to_id": 709380311,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I noticed it was undocumented and this is set by `UpdateTip` so it's tangentially related... but agree it looks confusing in this commit. I'll break it out into a separate commit.",
      "created_at": "2021-09-15T19:43:44Z",
      "updated_at": "2021-09-15T19:43:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r709520614",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709520614"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 112,
      "original_line": 112,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709603994",
      "pull_request_review_id": 755658601,
      "id": 709603994,
      "node_id": "PRRC_kwDOABII584qS7Ka",
      "diff_hunk": "@@ -2208,8 +2208,42 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n     res += warn;\n }\n \n+static void UpdateTipLog(\n+    const CCoinsViewCache& coins_tip,\n+    const CBlockIndex* tip,\n+    const CChainParams& params,\n+    const std::string& func_name,\n+    const std::string& prefix,\n+    const std::string& warning_messages) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\n+{\n+\n+    AssertLockHeld(::cs_main);\n+    LogPrintf(\"%s%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\",\n+        prefix, func_name,\n+        tip->GetBlockHash().ToString(), tip->nHeight, tip->nVersion,\n+        log(tip->nChainWork.getdouble()) / log(2.0), (unsigned long)tip->nChainTx,\n+        FormatISO8601DateTime(tip->GetBlockTime()),\n+        GuessVerificationProgress(params.TxData(), tip),\n+        coins_tip.DynamicMemoryUsage() * (1.0 / (1 << 20)),\n+        coins_tip.GetCacheSize(),\n+        !warning_messages.empty() ? strprintf(\" warning='%s'\", warning_messages) : \"\");\n+}\n+\n void CChainState::UpdateTip(const CBlockIndex* pindexNew)\n {\n+    const auto& coins_tip = this->CoinsTip();\n+\n+    // The remainder of the function isn't relevant if we are not acting on\n+    // the active chainstate, so return if need be.\n+    if (this != &m_chainman.ActiveChainstate()) {\n+        // Only log every so often so that we don't bury log messages at the tip.\n+        constexpr int BACKGROUND_LOG_INTERVAL = 2000;",
      "path": "src/validation.cpp",
      "position": 50,
      "original_position": 33,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "b3825c27bba2953bf96cfe0f685997e1524ee50c",
      "in_reply_to_id": 709379079,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yeah that might be nice, though it'd feel hamfisted to have a CLI option just for that I think. Probably something to think about for a followup.",
      "created_at": "2021-09-15T21:57:54Z",
      "updated_at": "2021-09-15T21:57:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r709603994",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709603994"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2240,
      "original_line": 2240,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709615226",
      "pull_request_review_id": 755672054,
      "id": 709615226,
      "node_id": "PRRC_kwDOABII584qS956",
      "diff_hunk": "@@ -300,14 +308,24 @@ class CBlockIndex\n         return ((nStatus & BLOCK_VALID_MASK) >= nUpTo);\n     }\n \n+    //! @returns true if the block is assumed-valid; this means it is queued to be\n+    //!   validated by a background chainstate.\n+    bool IsAssumedValid() const { return nStatus & BLOCK_ASSUMED_VALID; }\n+\n     //! Raise the validity level of this block index entry.\n     //! Returns true if the validity was changed.\n     bool RaiseValidity(enum BlockStatus nUpTo)\n     {\n         assert(!(nUpTo & ~BLOCK_VALID_MASK)); // Only validity flags allowed.\n-        if (nStatus & BLOCK_FAILED_MASK)\n-            return false;\n+        if (nStatus & BLOCK_FAILED_MASK) return false;\n+\n         if ((nStatus & BLOCK_VALID_MASK) < nUpTo) {\n+            // If this block had been marked assumed-valid and we're raising\n+            // its validity to a certain point, there is no longer an assumption.\n+            if (nStatus & BLOCK_ASSUMED_VALID && nUpTo >= BLOCK_VALID_SCRIPTS) {",
      "path": "src/chain.h",
      "position": 37,
      "original_position": 37,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "ae115458a14b2ec33be25172c3af3ff3a3a777fa",
      "in_reply_to_id": 709389720,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is a really good point, but I think we've got bigger problems if there's an invalid `nUpTo` being passed (that's still within the `BLOCK_VALID_MASK` range as you note; for subsequent reviewers: see the assert at the beginning of the function).\r\n\r\nI think if we were to address this, it'd be a more general fix of clamping down this function and others like `IsValid()` with a ceiling check (at the moment `BLOCK_VALID_SCRIPTS = 5`); then of course that ceiling would need to be updated in sync with any addtional `BLOCK_VALID_*` additions. So anyway I think that's best treated as a follow-up.",
      "created_at": "2021-09-15T22:21:41Z",
      "updated_at": "2021-09-15T22:21:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r709615226",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709615226"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 325,
      "original_line": 325,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709615629",
      "pull_request_review_id": 755672464,
      "id": 709615629,
      "node_id": "PRRC_kwDOABII584qS-AN",
      "diff_hunk": "@@ -0,0 +1,54 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+#ifndef BITCOIN_TEST_UTIL_CHAINSTATE_H\n+#define BITCOIN_TEST_UTIL_CHAINSTATE_H\n+\n+#include <clientversion.h>\n+#include <fs.h>\n+#include <node/context.h>\n+#include <node/utxo_snapshot.h>\n+#include <rpc/blockchain.h>\n+#include <validation.h>\n+\n+#include <univalue.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+auto NoMalleation = [](CAutoFile& file, SnapshotMetadata& meta){};",
      "path": "src/test/util/chainstate.h",
      "position": null,
      "original_position": 19,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "529f5055675f6c7f734796a8339761b6c1ba13b9",
      "in_reply_to_id": 709404714,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done! And yet again @ryanofsky bails me out of C++ jail.",
      "created_at": "2021-09-15T22:22:29Z",
      "updated_at": "2021-09-15T22:22:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r709615629",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709615629"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709616549",
      "pull_request_review_id": 755673609,
      "id": 709616549,
      "node_id": "PRRC_kwDOABII584qS-Ol",
      "diff_hunk": "@@ -5007,11 +5007,25 @@ bool ChainstateManager::PopulateAndValidateSnapshot(\n         // Fake nChainTx so that GuessVerificationProgress reports accurately\n         index->nChainTx = index->pprev ? index->pprev->nChainTx + index->nTx : 1;\n \n+        // Mark unvalidated block index entries beneath the snapshot base block as assumed-valid.\n+        if (!index->IsValid(BLOCK_VALID_SCRIPTS)) {\n+            // This flag will be removed once the block is fully validated by a\n+            // background chainstate.\n+            index->nStatus |= BLOCK_ASSUMED_VALID;\n+        }\n+\n         // Fake BLOCK_OPT_WITNESS so that CChainState::NeedsRedownload()\n         // won't ask to rewind the entire assumed-valid chain on startup.\n         if (index->pprev && DeploymentActiveAt(*index, ::Params().GetConsensus(), Consensus::DEPLOYMENT_SEGWIT)) {\n             index->nStatus |= BLOCK_OPT_WITNESS;\n         }\n+\n+        setDirtyBlockIndex.insert(index);",
      "path": "src/validation.cpp",
      "position": 209,
      "original_position": 17,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "4907b8673a91e762d702e6c3413f29190f0d813b",
      "in_reply_to_id": 709392990,
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Syncing the entire block index is negligible in comparison to syncing the coins, and we have to do both at the end of snapshot load, so I figured better to err on the side of over-syncing.",
      "created_at": "2021-09-15T22:24:49Z",
      "updated_at": "2021-09-15T22:24:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r709616549",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709616549"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5063,
      "original_line": 5063,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709622940",
      "pull_request_review_id": 755680846,
      "id": 709622940,
      "node_id": "PRRC_kwDOABII584qS_yc",
      "diff_hunk": "@@ -0,0 +1,54 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+#ifndef BITCOIN_TEST_UTIL_CHAINSTATE_H\n+#define BITCOIN_TEST_UTIL_CHAINSTATE_H\n+\n+#include <clientversion.h>\n+#include <fs.h>\n+#include <node/context.h>\n+#include <node/utxo_snapshot.h>\n+#include <rpc/blockchain.h>\n+#include <validation.h>\n+\n+#include <univalue.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+auto NoMalleation = [](CAutoFile& file, SnapshotMetadata& meta){};",
      "path": "src/test/util/chainstate.h",
      "position": null,
      "original_position": 19,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "529f5055675f6c7f734796a8339761b6c1ba13b9",
      "in_reply_to_id": 709404714,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Indeed this fixed the linker error.",
      "created_at": "2021-09-15T22:39:17Z",
      "updated_at": "2021-09-15T22:39:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r709622940",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/709622940"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711820619",
      "pull_request_review_id": 758197231,
      "id": 711820619,
      "node_id": "PRRC_kwDOABII584qbYVL",
      "diff_hunk": "@@ -2208,8 +2208,42 @@ static void AppendWarning(bilingual_str& res, const bilingual_str& warn)\n     res += warn;\n }\n \n+static void UpdateTipLog(\n+    const CCoinsViewCache& coins_tip,\n+    const CBlockIndex* tip,\n+    const CChainParams& params,\n+    const std::string& func_name,\n+    const std::string& prefix,\n+    const std::string& warning_messages) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\n+{\n+\n+    AssertLockHeld(::cs_main);\n+    LogPrintf(\"%s%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\",",
      "path": "src/validation.cpp",
      "position": 31,
      "original_position": 14,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "e747b5379f5f57c8732d42b07515118e305ddb18",
      "in_reply_to_id": 696182813,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "That's right.",
      "created_at": "2021-09-19T23:29:32Z",
      "updated_at": "2021-09-19T23:29:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r711820619",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711820619"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2221,
      "original_line": 2221,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711822386",
      "pull_request_review_id": 758198533,
      "id": 711822386,
      "node_id": "PRRC_kwDOABII584qbYwy",
      "diff_hunk": "@@ -3773,7 +3773,9 @@ bool BlockManager::LoadBlockIndex(\n             pindex->nStatus |= BLOCK_FAILED_CHILD;\n             setDirtyBlockIndex.insert(pindex);\n         }\n-        if (pindex->IsValid(BLOCK_VALID_TRANSACTIONS) && (pindex->HaveTxsDownloaded() || pindex->pprev == nullptr)) {\n+        if (pindex->IsAssumedValid() ||",
      "path": "src/validation.cpp",
      "position": 79,
      "original_position": 5,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "00b44cdaec4d07c9338e59a42d6525e9e87d3912",
      "in_reply_to_id": 696197191,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I had the wrong mental model reviewing. I thought that only blocks before the _snapshot_ height were marked as `IsAssumeValid`, thanks for the clarification!",
      "created_at": "2021-09-19T23:42:42Z",
      "updated_at": "2021-09-19T23:42:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r711822386",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711822386"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3776,
      "original_line": 3776,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711823337",
      "pull_request_review_id": 758199286,
      "id": 711823337,
      "node_id": "PRRC_kwDOABII584qbY_p",
      "diff_hunk": "@@ -126,7 +126,15 @@ enum BlockStatus: uint32_t {\n     BLOCK_FAILED_CHILD       =   64, //!< descends from failed block\n     BLOCK_FAILED_MASK        =   BLOCK_FAILED_VALID | BLOCK_FAILED_CHILD,\n \n-    BLOCK_OPT_WITNESS       =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+    BLOCK_OPT_WITNESS        =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+\n+    /**\n+     * If set, this indicates that the block index entry is assumed-valid.\n+     * Certain diagnostics will be skipped in e.g. CheckBlockIndex().\n+     * It almost certainly means that the block's full validation is pending\n+     * on a background chainstate. See `docs/assumeutxo.md`.\n+     */\n+    BLOCK_ASSUMED_VALID      =   256,",
      "path": "src/chain.h",
      "position": 13,
      "original_position": 13,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "212b80dad5c19a043c007d79109963e301cd1400",
      "in_reply_to_id": 696190873,
      "user": {
        "login": "ariard",
        "id": 23310655,
        "node_id": "MDQ6VXNlcjIzMzEwNjU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ariard",
        "html_url": "https://github.com/ariard",
        "followers_url": "https://api.github.com/users/ariard/followers",
        "following_url": "https://api.github.com/users/ariard/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ariard/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ariard/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
        "organizations_url": "https://api.github.com/users/ariard/orgs",
        "repos_url": "https://api.github.com/users/ariard/repos",
        "events_url": "https://api.github.com/users/ariard/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ariard/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": ">  So I'd drop the \"assume\" flag and use something like BLOCK_VALIDATED_FROM_GENESIS, BLOCK_VALIDATED_FROM_SNAPSHOT flags instead. \r\n\r\nYes, I think flags informing on the level of validation which has been performed so far would be better than tagging blocks with the validation process they belong to.\r\n\r\nI agree, let's not stuck on that, we can improve with 'cumulative' flags and better description of the different validation models (e.g `skipsigbeneath`) in the future.  ",
      "created_at": "2021-09-19T23:49:48Z",
      "updated_at": "2021-09-19T23:49:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r711823337",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711823337"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 137,
      "original_line": 137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715558994",
      "pull_request_review_id": 763006038,
      "id": 715558994,
      "node_id": "PRRC_kwDOABII584qppBS",
      "diff_hunk": "@@ -126,7 +126,15 @@ enum BlockStatus: uint32_t {\n     BLOCK_FAILED_CHILD       =   64, //!< descends from failed block\n     BLOCK_FAILED_MASK        =   BLOCK_FAILED_VALID | BLOCK_FAILED_CHILD,\n \n-    BLOCK_OPT_WITNESS       =   128, //!< block data in blk*.data was received with a witness-enforcing client\n+    BLOCK_OPT_WITNESS        =   128, //!< block data in blk*.dat was received with a witness-enforcing client\n+\n+    /**\n+     * If set, this indicates that the block index entry is assumed-valid.\n+     * Certain diagnostics will be skipped in e.g. CheckBlockIndex().\n+     * It almost certainly means that the block's full validation is pending\n+     * on a background chainstate. See `doc/assumeutxo.md`.",
      "path": "src/chain.h",
      "position": 11,
      "original_position": 11,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "There is no such document. Also, it would be good to explain how the unlikely case where this is *not* pending on background validation might happen. Even more so when this comment contradicts the very next comment (`IsAssumedValid`).",
      "created_at": "2021-09-24T12:11:45Z",
      "updated_at": "2021-09-24T12:50:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r715558994",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715558994"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 135,
      "original_line": 135,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715587133",
      "pull_request_review_id": 763043396,
      "id": 715587133,
      "node_id": "PRRC_kwDOABII584qpv49",
      "diff_hunk": "@@ -640,9 +647,10 @@ class CChainState\n     const std::optional<uint256> m_from_snapshot_blockhash;\n \n     /**\n-     * The set of all CBlockIndex entries with BLOCK_VALID_TRANSACTIONS (for itself and all ancestors) and\n-     * as good as our current tip or better. Entries may be failed, though, and pruning nodes may be\n-     * missing the data for the block.\n+     * The set of all CBlockIndex entries with either BLOCK_VALID_TRANSACTIONS (for\n+     * itself and all ancestors) *or* BLOCK_ASSUMED_VALID (if using background\n+     * chainstates) and as good as our current tip or better. Entries may be failed,\n+     * though, and pruning nodes may be missing the data for the block.\n      */",
      "path": "src/validation.h",
      "position": 35,
      "original_position": 35,
      "commit_id": "673a5bd3377929a0a6a62eda8b560e47bc2cca0c",
      "original_commit_id": "a30a5d46b3574a49f9e3611caeb730bf12d748fd",
      "in_reply_to_id": 689614499,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Does it apply to both? Would be good to clarify. (It is not possible to tell from the code in this pull)",
      "created_at": "2021-09-24T12:53:38Z",
      "updated_at": "2021-09-24T12:54:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/21526#discussion_r715587133",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715587133"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21526"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 654,
      "original_line": 654,
      "side": "RIGHT"
    }
  ]
}