{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326",
    "id": 2473809437,
    "node_id": "PR_kwDOABII586Tc1Yd",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/32326",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/32326.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/32326.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
    "number": 32326,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "net: improve the interface around FindNode() and avoid a recursive mutex lock",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "`CConnman::FindNode()` would lock `m_nodes_mutex`, find the node in `m_nodes`, release the mutex and return the node. The current code is safe but it is a dangerous interface where a caller may end up using the node returned from `FindNode()` without owning `m_nodes_mutex` and without having that node's reference count incremented.\r\n\r\nChange `FindNode()` to return a boolean since all but one of its callers used its return value to check whether a node exists and did not do anything else with the return value.\r\n\r\nRemove a recursive lock on `m_nodes_mutex`.\r\n\r\nRename `FindNode()` to better describe what it does.\r\n\r\n",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "created_at": "2025-04-22T14:36:28Z",
    "updated_at": "2025-05-01T10:54:06Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "a3b1423463803191579c75bb61c549ad4bffb73c",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "vasild:findnode",
      "ref": "findnode",
      "sha": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 120608826,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMjA2MDg4MjY=",
        "name": "bitcoin",
        "full_name": "vasild/bitcoin",
        "owner": {
          "login": "vasild",
          "id": 266751,
          "node_id": "MDQ6VXNlcjI2Njc1MQ==",
          "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/vasild",
          "html_url": "https://github.com/vasild",
          "followers_url": "https://api.github.com/users/vasild/followers",
          "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
          "organizations_url": "https://api.github.com/users/vasild/orgs",
          "repos_url": "https://api.github.com/users/vasild/repos",
          "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/vasild/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/vasild/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/vasild/bitcoin",
        "archive_url": "https://api.github.com/repos/vasild/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/vasild/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/vasild/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/vasild/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/vasild/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/vasild/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/vasild/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/vasild/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/vasild/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/vasild/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/vasild/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/vasild/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/vasild/bitcoin/events",
        "forks_url": "https://api.github.com/repos/vasild/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/vasild/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/vasild/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/vasild/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/vasild/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/vasild/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/vasild/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/vasild/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/vasild/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/vasild/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/vasild/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/vasild/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/vasild/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/vasild/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/vasild/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/vasild/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:vasild/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/vasild/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/vasild/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/vasild/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/vasild/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/vasild/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/vasild/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/vasild/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/vasild/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/vasild/bitcoin/hooks",
        "svn_url": "https://github.com/vasild/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 6,
        "watchers_count": 6,
        "size": 256216,
        "default_branch": "master",
        "open_issues_count": 2,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-05-01T10:00:08Z",
        "created_at": "2018-02-07T11:52:47Z",
        "updated_at": "2025-05-01T07:20:27Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "68ac9f116c0228a277f18f60ba2278b56356e6ac",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 37143,
        "stargazers_count": 83225,
        "watchers_count": 83225,
        "size": 280726,
        "default_branch": "master",
        "open_issues_count": 712,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-05-01T09:21:34Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-05-01T10:37:43Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 40,
    "deletions": 55,
    "changed_files": 4,
    "commits": 3,
    "review_comments": 28,
    "comments": 13
  },
  "events": [
    {
      "event": "commented",
      "id": 2821549480,
      "node_id": "IC_kwDOABII586oLW2o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2821549480",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-22T14:36:32Z",
      "updated_at": "2025-05-01T10:23:43Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32326.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [shahsb](https://github.com/bitcoin/bitcoin/pull/32326#pullrequestreview-2790763507), [theuni](https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2831361039) |\n| Stale ACK | [jonatack](https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2822019017), [hodlinator](https://github.com/bitcoin/bitcoin/pull/32326#pullrequestreview-2790161149) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32015](https://github.com/bitcoin/bitcoin/pull/32015) (net: replace manual reference counting of CNode with shared_ptr by vasild)\n* [#30988](https://github.com/bitcoin/bitcoin/pull/30988) (Split CConnman by vasild)\n* [#29641](https://github.com/bitcoin/bitcoin/pull/29641) (scripted-diff: Use LogInfo over LogPrintf [WIP, NOMERGE, DRAFT] by maflcko)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2821549480",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326"
    },
    {
      "event": "labeled",
      "id": 17355212893,
      "node_id": "LE_lADOABII586zfK20zwAAAAQKc4hd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17355212893",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-22T14:36:43Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "labeled",
      "id": 17355559777,
      "node_id": "LE_lADOABII586zfK20zwAAAAQKeNNh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17355559777",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-22T14:57:02Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2821611865,
      "node_id": "IC_kwDOABII586oLmFZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2821611865",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-22T14:57:03Z",
      "updated_at": "2025-04-22T14:57:03Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/40947126551</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2821611865",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326"
    },
    {
      "event": "reviewed",
      "id": 2784433178,
      "node_id": "PRR_kwDOABII586l9xQa",
      "url": null,
      "actor": null,
      "commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#pullrequestreview-2784433178",
      "submitted_at": "2025-04-22T14:59:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
    },
    {
      "event": "reviewed",
      "id": 2784459702,
      "node_id": "PRR_kwDOABII586l93u2",
      "url": null,
      "actor": null,
      "commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#pullrequestreview-2784459702",
      "submitted_at": "2025-04-22T15:07:54Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
    },
    {
      "event": "commented",
      "id": 2821655105,
      "node_id": "IC_kwDOABII586oLwpB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2821655105",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-22T15:11:36Z",
      "updated_at": "2025-04-22T15:11:36Z",
      "author_association": "MEMBER",
      "body": "Review ACK 1e415d2cb703fcd1b622e5343fa264425601c8d modulo CI fixup\r\n\r\nHappy to see these methods see an update.\r\n\r\nI tried adding `EXCLUSIVE_LOCKS_REQUIRED(!m_nodes_mutex)` to the declarations, but it looks like that lock is already held by some of their callers.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2821655105",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17356131421,
      "node_id": "HRFPE_lADOABII586zfK20zwAAAAQKgYxd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17356131421",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/cc8f239663a0874c307efa30815b40d9ef40badb",
      "created_at": "2025-04-22T15:32:39Z"
    },
    {
      "event": "commented",
      "id": 2821716161,
      "node_id": "IC_kwDOABII586oL_jB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2821716161",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-22T15:33:19Z",
      "updated_at": "2025-04-22T15:33:19Z",
      "author_association": "CONTRIBUTOR",
      "body": "`1e415d2cb7...cc8f239663`: fix CI tidy",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2821716161",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326"
    },
    {
      "event": "unlabeled",
      "id": 17357512957,
      "node_id": "UNLE_lADOABII586zfK20zwAAAAQKlqD9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17357512957",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-22T17:13:37Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2822019017,
      "node_id": "IC_kwDOABII586oNJfJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2822019017",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-22T17:32:58Z",
      "updated_at": "2025-04-22T17:32:58Z",
      "author_association": "MEMBER",
      "body": "ACK cc8f239663a0874c307efa30815b40d9ef40badb",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2822019017",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326"
    },
    {
      "event": "reviewed",
      "id": 2785043300,
      "node_id": "PRR_kwDOABII586mAGNk",
      "url": null,
      "actor": null,
      "commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#pullrequestreview-2785043300",
      "submitted_at": "2025-04-22T18:48:18Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
    },
    {
      "event": "reviewed",
      "id": 2790161149,
      "node_id": "PRR_kwDOABII586mTnr9",
      "url": null,
      "actor": null,
      "commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK cc8f239663a0874c307efa30815b40d9ef40badb\r\n\r\nFixes thread-unsafe pattern (originally?) raised by me here: https://github.com/bitcoin/bitcoin/pull/32015#discussion_r1988127685\r\n(Even though current master is not susceptible to the found `CNode` being deleted randomly on another thread).",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#pullrequestreview-2790161149",
      "submitted_at": "2025-04-24T09:56:16Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
    },
    {
      "event": "reviewed",
      "id": 2790763507,
      "node_id": "PRR_kwDOABII586mV6vz",
      "url": null,
      "actor": null,
      "commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "body": "Concept ACK",
      "user": {
        "login": "shahsb",
        "id": 20738488,
        "node_id": "MDQ6VXNlcjIwNzM4NDg4",
        "avatar_url": "https://avatars.githubusercontent.com/u/20738488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/shahsb",
        "html_url": "https://github.com/shahsb",
        "followers_url": "https://api.github.com/users/shahsb/followers",
        "following_url": "https://api.github.com/users/shahsb/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/shahsb/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/shahsb/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/shahsb/subscriptions",
        "organizations_url": "https://api.github.com/users/shahsb/orgs",
        "repos_url": "https://api.github.com/users/shahsb/repos",
        "events_url": "https://api.github.com/users/shahsb/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/shahsb/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#pullrequestreview-2790763507",
      "submitted_at": "2025-04-24T11:34:54Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
    },
    {
      "event": "commented",
      "id": 2831361039,
      "node_id": "IC_kwDOABII586owyQP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2831361039",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-25T20:21:30Z",
      "updated_at": "2025-04-25T20:21:30Z",
      "author_association": "MEMBER",
      "body": "Is making `m_nodes_mutex` non-recursive a goal? That sounds nice to me and I'm not opposed, but I'd rather not make changes just to get halfway there.\r\n\r\nConcept ACK on turning the `FindNode`s into bools, though. That's a nice improvement.",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2831361039",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326"
    },
    {
      "event": "commented",
      "id": 2832116385,
      "node_id": "IC_kwDOABII586ozqqh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2832116385",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-26T12:35:06Z",
      "updated_at": "2025-04-26T12:35:06Z",
      "author_association": "MEMBER",
      "body": "> Is making `m_nodes_mutex` non-recursive a goal? That sounds nice to me and I'm not opposed, but I'd rather not make changes just to get halfway there.\r\n\r\nI'm curious how far we are from a non-recursive `m_nodes_mutex`?",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2832116385",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326"
    },
    {
      "event": "commented",
      "id": 2835048806,
      "node_id": "IC_kwDOABII586o-2lm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2835048806",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-28T12:14:58Z",
      "updated_at": "2025-04-28T12:14:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Is making `m_nodes_mutex` non-recursive a goal?\r\n\r\nNo, I did not think about that before you mentioned it. The goal here is to make the interface around `FindNode()` safer and simpler (don't return a possibly dangling pointer and don't return a pointer at all since callers can do with a boolean).\r\n\r\nI did mention dropping the recursive lock because I think less recursive locking is good, even if the mutex remains recursive.\r\n\r\n> I'm curious how far we are from a non-recursive `m_nodes_mutex`?\r\n\r\nThis far away:\r\n\r\n<details>\r\n<summary>[patch] make m_nodes_mutex non-recursive</summary>\r\n\r\n```diff\r\n--- i/src/net_processing.cpp\r\n+++ w/src/net_processing.cpp\r\n@@ -1284,29 +1284,29 @@ void PeerManagerImpl::MaybeSetPeerAsAnnouncingHeaderAndIDs(NodeId nodeid)\r\n                 std::swap(lNodesAnnouncingHeaderAndIDs.front(), *std::next(lNodesAnnouncingHeaderAndIDs.begin()));\r\n             }\r\n         }\r\n     }\r\n     m_connman.ForNode(nodeid, [this](CNode* pfrom) EXCLUSIVE_LOCKS_REQUIRED(::cs_main) {\r\n         AssertLockHeld(::cs_main);\r\n-        if (lNodesAnnouncingHeaderAndIDs.size() >= 3) {\r\n-            // As per BIP152, we only get 3 of our peers to announce\r\n-            // blocks using compact encodings.\r\n-            m_connman.ForNode(lNodesAnnouncingHeaderAndIDs.front(), [this](CNode* pnodeStop){\r\n-                MakeAndPushMessage(*pnodeStop, NetMsgType::SENDCMPCT, /*high_bandwidth=*/false, /*version=*/CMPCTBLOCKS_VERSION);\r\n-                // save BIP152 bandwidth state: we select peer to be low-bandwidth\r\n-                pnodeStop->m_bip152_highbandwidth_to = false;\r\n-                return true;\r\n-            });\r\n-            lNodesAnnouncingHeaderAndIDs.pop_front();\r\n-        }\r\n         MakeAndPushMessage(*pfrom, NetMsgType::SENDCMPCT, /*high_bandwidth=*/true, /*version=*/CMPCTBLOCKS_VERSION);\r\n         // save BIP152 bandwidth state: we select peer to be high-bandwidth\r\n         pfrom->m_bip152_highbandwidth_to = true;\r\n         lNodesAnnouncingHeaderAndIDs.push_back(pfrom->GetId());\r\n         return true;\r\n     });\r\n+    if (lNodesAnnouncingHeaderAndIDs.size() > 3) {\r\n+        // As per BIP152, we only get 3 of our peers to announce\r\n+        // blocks using compact encodings.\r\n+        m_connman.ForNode(lNodesAnnouncingHeaderAndIDs.front(), [this](CNode* pnodeStop){\r\n+            MakeAndPushMessage(*pnodeStop, NetMsgType::SENDCMPCT, /*high_bandwidth=*/false, /*version=*/CMPCTBLOCKS_VERSION);\r\n+            // save BIP152 bandwidth state: we select peer to be low-bandwidth\r\n+            pnodeStop->m_bip152_highbandwidth_to = false;\r\n+            return true;\r\n+        });\r\n+        lNodesAnnouncingHeaderAndIDs.pop_front();\r\n+    }\r\n }\r\n \r\n bool PeerManagerImpl::TipMayBeStale()\r\n {\r\n     AssertLockHeld(cs_main);\r\n     const Consensus::Params& consensusParams = m_chainparams.GetConsensus();\r\n```\r\n</details>\r\n\r\nOn top of this PR, plus a pile of `EXCLUSIVE_LOCKS_REQUIRED(!m_nodes_mutex)` additions in `net.h`. Should I PR that (separately from the current PR)?",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2835048806",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326"
    },
    {
      "event": "commented",
      "id": 2835177926,
      "node_id": "IC_kwDOABII586o_WHG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2835177926",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-28T13:04:43Z",
      "updated_at": "2025-04-28T13:04:43Z",
      "author_association": "MEMBER",
      "body": "> On top of this PR, plus a pile of `EXCLUSIVE_LOCKS_REQUIRED(!m_nodes_mutex)` additions in `net.h`. Should I PR that (separately from the current PR)?\r\n\r\nI'd appreciate it. It would be good to cross `m_nodes_mutex` off the [list](https://github.com/bitcoin/bitcoin/issues/19303).",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2835177926",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326"
    },
    {
      "event": "commented",
      "id": 2835618558,
      "node_id": "IC_kwDOABII586pBBr-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2835618558",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-28T15:21:27Z",
      "updated_at": "2025-04-28T15:21:27Z",
      "author_association": "MEMBER",
      "body": "> I'd appreciate it. It would be good to cross `m_nodes_mutex` off the [list](https://github.com/bitcoin/bitcoin/issues/19303).\r\n\r\nYeah, agreed. That's a good justification for the change to non-recursive here.\r\n\r\nLooking at that diff, it's not clear to me if it's safe to move that hunk out of `cs_main`, but we can review/test/argue about it in a new PR.",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2835618558",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326"
    },
    {
      "event": "convert_to_draft",
      "id": 17449016692,
      "node_id": "CTDE_lADOABII586zfK20zwAAAAQQCt10",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17449016692",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-29T06:47:01Z"
    },
    {
      "event": "commented",
      "id": 2837679823,
      "node_id": "IC_kwDOABII586pI47P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2837679823",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-29T06:52:58Z",
      "updated_at": "2025-04-29T06:52:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "Converted to draft, waiting for:\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/32338 to make it\r\n* then change this PR to use naming as in https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2063650801\r\n\r\nFurther improvements away from this PR:\r\n* make `m_nodes_mutex` non-recursive, https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2835048806\r\n* assess all the checks that compare just the address or address+port and remove redundant ones and make the calls consistent regardless of whether `pzsDest` is set or not, https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2065614037",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2837679823",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326"
    },
    {
      "event": "labeled",
      "id": 17463738241,
      "node_id": "LE_lADOABII586zfK20zwAAAAQQ63-B",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17463738241",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-29T22:57:04Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGY4MjAxNzc0YjU5MGQ2Y2Y2ODQxODlhZmNmZGFhMjY2YzFhNWYzYmQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f8201774b590d6cf684189afcfdaa266c1a5f3bd",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f8201774b590d6cf684189afcfdaa266c1a5f3bd",
      "tree": {
        "sha": "e05c3e6c8d6dab6cd39e672b91df27eecd7d1885",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e05c3e6c8d6dab6cd39e672b91df27eecd7d1885"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree e05c3e6c8d6dab6cd39e672b91df27eecd7d1885\nparent 68ac9f116c0228a277f18f60ba2278b56356e6ac\nauthor Vasil Dimov <vd@FreeBSD.org> 1745316932 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1746089895 +0200\n\nnet: merge AlreadyConnectedToAddress() and FindNode(CNetAddr)\n\n`CConnman::AlreadyConnectedToAddress()` is the only caller of\n`CConnman::FindNode(CNetAddr)`, so merge the two in one function and\nrename it to `IsConnectedToAddr()` to show that it compares just the\naddress and not the port.\n\nThe unit test that checked whether `AlreadyConnectedToAddress()` ignores\nthe port is now unnecessary because now the function takes a `CNetAddr`\nargument. It has no access to the port.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmgTOAgACgkQVN8G9ktV\ny7+UOh/8Doif98qckkmwuA9nsppCE4yV9yk9bOwPRVplaDBiGFlWtnslQLUk8Lqq\nHv5wkFHOAvTSGOwtmypcgCqjSFOTfy5sjgoGtG+YKgIMGUfU/CG8zFf6LxhAqsm9\nr/pZTVrjOSmGospEtMRoSmAFczfbjohlYmCVP2/QTNL7erg0ixDFZNPJRdqOJ64Q\nozIQWMmNvPRF87qmez3G6a9s5NNe43NRsVIdsmFRLdb5Ve/rKOExtUchU6Q6lHY7\nfdLkU/s2iUeoACaBulh86XP+Ycu+kdRNw8TeExQFOJCHs8PuHTGNRHNYNNAtG81j\nIEyOQY+tKUGlTRw/9WK6j3lByY8jNAR0g8homG8u7RZXZh7jtm3Mv9bExlSQCMIw\n40+l4hNL9yf0viPa8jLy629nNJmr9uqRH/0OpdJP8fIwc880WArSXhu+zieUyC/C\nUpTzErvfiLnCFnZ3Z4k0tGsu3Y84X3vi7eDNaseLVQLJD9Ta1GcqXzY60SLWlcjl\nOJ/UBWLeTLPuRU21qcuhz/GF2+pvU8ZaUAi1VgnMda06ztVuuDI5L1KoxFo+I8hf\nOdNODjC5qNYDA9ezcu9aYKnL5q4HUyCX2m1CXyPua4sWnJtCH25bHFDraCKbEWrw\npe/dC5OOSz+zNc3nTuMQNjJ2JePKOSFsHG05O8uCuqvD0xrFLugyc7BbWeRLKEqj\nWL777jWQfvThRCLxwueVbcm5zpkUpiWVKwfDzoVmMcTH9HFj4UsWCg+3W0Ocft62\nTQFTh4/b6BVURf8MTA9QwjzLmomyI9r2MfvnDFCpPUEbMudPFYiYv00qIzB5WqHy\nRxrKIFnAg872TmOrqZ1mKD9WD6b/EjwZT9f6CTE7nzlZG3bE9OFyYrJDqYTHMBlo\nP1kMEgcj5ebzEYLqO6d5QMBFkUG2pcL6ZwaDnbMdVnzyENpGIWg22T9awq2i4VNG\nlMAFw9yKOkehcjSs4btXDlJTAUzki9KURcIS+8slRgTaj8xm0n/RQrVQG3+jT3Pg\nyFl8NMXFh203VbA5jJyxTkwNCHRDXp6rJRMRTzDWKp4nKx83mbYPKgPT9oHilHFh\nLxo4PPh6p2ZENyt+swE5+/HwROU6NjQMfye2PvFcbrVk5yq04rwv10R9FsONwECG\nkGGteZ581wOD0Quyj2f/us3VJBYhHVOpKzGZswgK4apSFFve/myQyUJGGe1xkLpa\naOY5bEe7SxFrhHsDXfaxxLhYEgcIrAVbgrySHXpifzPxOmc8PimyZ3Cjd6UhT+Ox\nOWI3zov62FBLH3+vW7AImLs7ImtVrwVNKnNYBoxLZx2k5ktns5sBhMzowlvf/Zk1\nDQPUdg2jtC2Fm1Hu2jLOXmGb+m07LA==\n=tsCp\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/68ac9f116c0228a277f18f60ba2278b56356e6ac",
          "sha": "68ac9f116c0228a277f18f60ba2278b56356e6ac",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/68ac9f116c0228a277f18f60ba2278b56356e6ac"
        }
      ],
      "message": "net: merge AlreadyConnectedToAddress() and FindNode(CNetAddr)\n\n`CConnman::AlreadyConnectedToAddress()` is the only caller of\n`CConnman::FindNode(CNetAddr)`, so merge the two in one function and\nrename it to `IsConnectedToAddr()` to show that it compares just the\naddress and not the port.\n\nThe unit test that checked whether `AlreadyConnectedToAddress()` ignores\nthe port is now unnecessary because now the function takes a `CNetAddr`\nargument. It has no access to the port.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-05-01T08:58:15Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-04-22T10:15:32Z"
      },
      "sha": "f8201774b590d6cf684189afcfdaa266c1a5f3bd"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc4ZTAzNDU4Njc4MGE3NTUxNjE3NjJmZDM3MWNlODBjM2FiNjNmZDY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/78e034586780a755161762fd371ce80c3ab63fd6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/78e034586780a755161762fd371ce80c3ab63fd6",
      "tree": {
        "sha": "6da6bc7f0949c19d75c3c7072ac3f56871edc89d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6da6bc7f0949c19d75c3c7072ac3f56871edc89d"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 6da6bc7f0949c19d75c3c7072ac3f56871edc89d\nparent f8201774b590d6cf684189afcfdaa266c1a5f3bd\nauthor Vasil Dimov <vd@FreeBSD.org> 1745317954 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1746090142 +0200\n\nnet: avoid recursive m_nodes_mutex lock in DisconnectNode()\n\nHave `CConnman::DisconnectNode()` iterate `m_nodes` itself instead of\nusing `FindNode()`. This avoids recursive mutex lock and drops the only\ncaller of `FindNode()` which used the return value for something else\nthan a boolean found/notfound.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmgTOJ8ACgkQVN8G9ktV\ny7+RHB//bn+p2AjEzH0n83B3ufdqWjYDFrX9lPwSikHQbTuZpVoEjLfrrOpCeMfa\nfHrlRjgDBVHrLgYPY9YEHXV0tpmw5w7lGjxUnngywrCXKjksTi0OiiB2m6X+w7hB\nL4WIy7y3X9haKspdobXLDBB0eImcbITQPM9+wQ815pMU4OWzxe7nfs7XhUpQRphC\nFzcWiO5/eE+9jhnEdhO1XuiIfMN5h6qqcJgOGYc1vP8ZmnC/aqgR2yxIoqCTBBSi\neJC/yLd+YrvG94MXXe3tf/34KdT+F+XZ3F+bJuvAXwwTvNdYHtRXqB5ain3IvIke\nmBpNdYVs20TmnzraestrqVEhC2gUFT1d4alIhPGrusqO9ix9orMELoVh35wYmhTC\nZ2IO5tRK35Sw5P5Z3T9/OJ0J7SIwmcKNrXGHTVpkPAi0KrxGzhbSagOp42GjL3VW\nJhnDNHHPXyFJmDbQBew6FgyoKpGAlKLPI569Z1Q8Oqa2TpN6g1xRYJCBaPVm5Q7b\nfl6syH4b5g5XJGc7NAhQVTBYGMABhIIwWcpnNRiPyeolz76cfYxcp5uyM2C5XV9/\nOh/d0q6Y2o4GOBp2YGeRUaAgxh5pnrsPPUNMwLjZ/1/A/OOWcrXF9a/pC2ySpPfq\nGaE1ar1mA00o6X39bDb1MDijMCuZwqY/DcTw8mKBtsENdKob8kaWhkmfw9FJUgNS\nQEdmUYCDFxdlE0RTlwH20302GfjepWhbA9v8oa3DJlIUiF9zPXJaB4/Cz7My+qBo\nLG3Poc0+7PT3Umd+Mwf2ynK+y4L32YnEziVaEOx3Dsz/hYzHxqjjKg339cHB12Af\nBui8MtCnNkkN7r8PPom88aDoztEN95iV3fmqB+6rjOxuum+yFYE4GAfnGqlGH9iD\n+LC2eE5V4meQPb40/TskztwIRrG8lguHJGM28VpGh0aK3z1KVTflZ3COpJxzwxGg\n0XnVKD7yBDhqwFy4mb1JKoNQibLmPoIrz72gcvv3PuF60dziTB/B8Whnd5U64nMf\nAajl7amtDGF3PmNJCLI+N7tl5aHa+OnS4357ALi1IuOmerBnILllwebBPhM5KFum\nxw1P+P1HblwmM8E8lM1KMJ7gdfEFKIOEpthpWhtbHh3Ezp7TtEGQ7/3FnJ6RGcMO\nAS8dY8vFt+9IaA276YR7eiGPC4c5wQUokG3qGrvkDeaHFtVrIXOrKQ3DtJfBDnBc\nIp9h0HZe5D7j8ztNOwHOqQfp6NBCoO6kb5K5v0XRRAnKbozdQ16YsyyvPgG4GzCx\nruXLp6xZFT3T6ZDhibtW0IE62P3fm6VF4lrC4+CUo1Pb3SIV7mzSGHD9LY9QVMsw\nNhH9QTXcg/6G909MPaunEzZSdkwBpg==\n=e5u2\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f8201774b590d6cf684189afcfdaa266c1a5f3bd",
          "sha": "f8201774b590d6cf684189afcfdaa266c1a5f3bd",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f8201774b590d6cf684189afcfdaa266c1a5f3bd"
        }
      ],
      "message": "net: avoid recursive m_nodes_mutex lock in DisconnectNode()\n\nHave `CConnman::DisconnectNode()` iterate `m_nodes` itself instead of\nusing `FindNode()`. This avoids recursive mutex lock and drops the only\ncaller of `FindNode()` which used the return value for something else\nthan a boolean found/notfound.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-05-01T09:02:22Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-04-22T10:32:34Z"
      },
      "sha": "78e034586780a755161762fd371ce80c3ab63fd6"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17485426920,
      "node_id": "HRFPE_lADOABII586zfK20zwAAAAQSNnDo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17485426920",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "8ef769cc2d4a8a2cea47a2ea3835df91f669a85f",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/8ef769cc2d4a8a2cea47a2ea3835df91f669a85f",
      "created_at": "2025-05-01T09:05:08Z"
    },
    {
      "event": "commented",
      "id": 2844423967,
      "node_id": "IC_kwDOABII586pincf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2844423967",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-01T09:07:26Z",
      "updated_at": "2025-05-01T09:07:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "`cc8f239663...8ef769cc2d`: rebase and use the naming:\r\n\r\n```cpp\r\nbool IsConnectedToAddrPort(const std::string& addr_port);\r\nbool IsConnectedToAddrPort(const CService& addr_port);\r\nbool IsConnectedToAddr(const CNetAddr& addr);\r\n```",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2844423967",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRmNjM1ZDEwMGRkMWFiNWU4M2JiMzkyZDhmYmVlNGEzZjQ0MDAzMTU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "tree": {
        "sha": "2cc9e34bc9002ff87c4cb3e0cd1561a29cc85ba5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2cc9e34bc9002ff87c4cb3e0cd1561a29cc85ba5"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 2cc9e34bc9002ff87c4cb3e0cd1561a29cc85ba5\nparent 78e034586780a755161762fd371ce80c3ab63fd6\nauthor Vasil Dimov <vd@FreeBSD.org> 1745327856 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1746090620 +0200\n\nnet: change FindNode() to not return a node and rename it\n\nAll callers of `CConnman::FindNode()` use its return value `CNode*` only\nas a boolean null/notnull. So change that method to return `bool`.\n\nThis removes the dangerous pattern of handling a `CNode` object (the\nreturn value of `FindNode()`) without holding `CConnman::m_nodes_mutex`\nand without having that object's reference count incremented for the\nduration of the usage.\n\nAlso rename the method to better describe what it does.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmgTOn0ACgkQVN8G9ktV\ny7+tdh/+NrbzojW4d1rQD7DLXjnMd3wwKanWP4FzWiE/RFduFzOzx2uY4xfuRV3U\nqaqRQOUIoSJWLXoNN0R/SQV/76UziVln+jLRjPw3GN8+wACdKutTKVrLqTYp5v1h\nHEovgPm2ApMkEh2WPQ75sZDWgYVSdmYPOFE+Oc6Fvx1r8nS+jn56+8/3dQILgns8\nTBo3rPLFXobNng7QzF0z3WpPSBi5Z4eFR0/cXWwkfJoQ/NCIh6+Tj2Fe+Y93td6M\nEmDe46V3VJ1IY3S4/LnlLtYZXA87YTWI7gVYzskq/rHG50enW2Og6efn8lshAs3Y\nZ1Z4m94dJMfEKxMvSLUakTxzSV0WzJElYJoVgDR3E2VksAnIiwI3k++NkQ7cn1gr\n685WAHgQgmjKSHqodjMm5n4yvQuQyYJwPrasrCpJk73E//R5Aua8M+srXXGUQahc\nMX7afSXH5XPJsLEnrFkjiCB7z6iedS1qZf9rqDjJs7jfUYyo6vWna7qPsZeHhEEP\npO9BBWKhDZvJ2vmbc+4965PpWnu+FJsbs8XPukrXvypAw9ijtFh/TtZZDIsHcO65\nj0AlPMCWoRNzeZG4cvWvI6CONWEoLBRAW+99dorfnbnL4vkYlfTMOqFiee2QF8nB\n1oEydHO7Jk7QCe4VX1dapXEp8N4hEnnnFPICPMAqbTm+VauC5+hXrhVGDGBBCrel\nQza8T5eryU2z2c+Pr1SRysRcAag7JFF2ldHvDDCaqzRpKCfCjKP3lHi2ZzrOPE3O\nRhgF8VF1ootcxJ0nNwjYoeEGUFUjYZn9EtVf3DsKwWOtjvoa0MOnF/oQWhA8RTTf\nLzBPPHPZX3cAdhXncOFiAHvhxItbUx1iKILduZGOvyRKr2WZvmiYck58hDL9uI1a\nSGMOXCrsrcbWGdNAZJ/x15dXwosFDrtyV38zJ/mAeoWPVADWI+ZU+LmO+1DnpD/o\nhmp7x6Rl8lR6Q1gd/bjy8JltH1R1J9/HIt6aw2T/cJKUjCQ5NLoq8hgjZvmb1MeW\nxmosUcjg2NzXK40SMunArPLC9UDzi/GTkRon1uqv2xWbKvXIxl1p9yuWnWoZq5SH\nlqVAqSv+C+fCQ1aztkea933XpFWywrPUqmCxNh0UsbEQtCSBtTGrDzU6WDJOQaZl\nFPzTY+ct6VimuasWaJxmX3CaLF+CuaFRbU6RaOfDdKfwIip3u9OlsKXtxXPEnKn1\nvff/7MTnbu3MW0bh9+M/E1S7wgj5qBJsNq5r6ylnizSjo4fcqdJ/Kz7NjfxKmsD2\nU25i31mMHn4Ay6qc49A4jXKpSjwK2Pofccj9EDHD32dtxZJazHSfi7LM6dyvgtfk\nLD8diTd0D0VXYSvIlvAzdLKfqi3c8A==\n=9UlD\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/78e034586780a755161762fd371ce80c3ab63fd6",
          "sha": "78e034586780a755161762fd371ce80c3ab63fd6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/78e034586780a755161762fd371ce80c3ab63fd6"
        }
      ],
      "message": "net: change FindNode() to not return a node and rename it\n\nAll callers of `CConnman::FindNode()` use its return value `CNode*` only\nas a boolean null/notnull. So change that method to return `bool`.\n\nThis removes the dangerous pattern of handling a `CNode` object (the\nreturn value of `FindNode()`) without holding `CConnman::m_nodes_mutex`\nand without having that object's reference count incremented for the\nduration of the usage.\n\nAlso rename the method to better describe what it does.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-05-01T09:10:20Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-04-22T13:17:36Z"
      },
      "sha": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17485496211,
      "node_id": "HRFPE_lADOABII586zfK20zwAAAAQSN3-T",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17485496211",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "created_at": "2025-05-01T09:13:22Z"
    },
    {
      "event": "commented",
      "id": 2844434880,
      "node_id": "IC_kwDOABII586piqHA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2844434880",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-01T09:13:54Z",
      "updated_at": "2025-05-01T09:13:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "`8ef769cc2d...4f635d100d`: make the methods `const`",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#issuecomment-2844434880",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32326"
    },
    {
      "event": "ready_for_review",
      "id": 17485501110,
      "node_id": "RFRE_lADOABII586zfK20zwAAAAQSN5K2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17485501110",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-01T09:13:56Z"
    },
    {
      "event": "unlabeled",
      "id": 17486298165,
      "node_id": "UNLE_lADOABII586zfK20zwAAAAQSQ7w1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17486298165",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-01T10:54:04Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054309204",
      "pull_request_review_id": 2784433178,
      "id": 2054309204,
      "node_id": "PRRC_kwDOABII5856ckVU",
      "diff_hunk": "@@ -404,10 +389,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             return nullptr;\n \n         // Look for an existing connection\n-        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-        if (pnode)\n-        {\n-            LogPrintf(\"Failed to open new connection, already connected\\n\");\n+        if (OutboundConnectedToService(addrConnect)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This rename makes obvious that maybe something is wrong in the current code in `master`. Is the intention really to ignore inbound connections when, according to the comment we intent to \"Look for an existing connection\"?\r\n\r\nFor example, if `1.1.1.1` connects to `2.2.2.2:8333`, then the TCP connection will look like:\r\n`1.1.1.1:53481 <-> 2.2.2.2:8333` where `53481` is a random port picked by the initiator's OS. Now, if `2.2.2.2` intends to connect to `1.1.1.1:8333` then this check will return false because `1.1.1.1:53481` is not `1.1.1.1:8333` and the code will proceed with connecting.\r\n\r\nIs this really the intention? Shouldn't this check ignore the port?",
      "created_at": "2025-04-22T14:59:28Z",
      "updated_at": "2025-04-22T14:59:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2054309204",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054309204"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054324859",
      "pull_request_review_id": 2784459702,
      "id": 2054324859,
      "node_id": "PRRC_kwDOABII5856coJ7",
      "diff_hunk": "@@ -332,42 +332,27 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+bool CConnman::OutboundConnectedToStr(const std::string& str_addr)\n {\n     LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-      if (static_cast<CNetAddr>(pnode->addr) == ip) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n-}\n-\n-CNode* CConnman::FindNode(const std::string& addrName)\n-{\n-    LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-        if (pnode->m_addr_name == addrName) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n+    return std::ranges::any_of(m_nodes, [&str_addr](CNode* node) { return node->m_addr_name == str_addr; });\n }\n \n-CNode* CConnman::FindNode(const CService& addr)\n+bool CConnman::OutboundConnectedToService(const CService& addr)\n {\n     LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-        if (static_cast<CService>(pnode->addr) == addr) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n+    return std::ranges::any_of(m_nodes, [&addr](CNode* node) { return node->addr == addr; });\n }\n \n bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    const CNetAddr net_addr{addr};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In 9e657358271e7a045c, to make the CI happy \r\n```suggestion\r\n    const CNetAddr& net_addr{addr};\r\n```",
      "created_at": "2025-04-22T15:07:54Z",
      "updated_at": "2025-04-22T15:07:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2054324859",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054324859"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 349,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054336652",
      "pull_request_review_id": 2784479267,
      "id": 2054336652,
      "node_id": "PRRC_kwDOABII5856crCM",
      "diff_hunk": "@@ -404,10 +389,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             return nullptr;\n \n         // Look for an existing connection\n-        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-        if (pnode)\n-        {\n-            LogPrintf(\"Failed to open new connection, already connected\\n\");\n+        if (OutboundConnectedToService(addrConnect)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "in_reply_to_id": 2054309204,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I ought to resuscitate some of https://github.com/bitcoin/bitcoin/pull/28248 that was looking at this (or will review if you do).",
      "created_at": "2025-04-22T15:14:35Z",
      "updated_at": "2025-04-22T15:14:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2054336652",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054336652"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054341299",
      "pull_request_review_id": 2784486721,
      "id": 2054341299,
      "node_id": "PRRC_kwDOABII5856csKz",
      "diff_hunk": "@@ -404,10 +389,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             return nullptr;\n \n         // Look for an existing connection\n-        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-        if (pnode)\n-        {\n-            LogPrintf(\"Failed to open new connection, already connected\\n\");\n+        if (OutboundConnectedToService(addrConnect)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "in_reply_to_id": 2054309204,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I don't know if this is intentional, or a bug or something in betweeen.\r\n\r\nIf I remember correctly , #28248 suggested to change that, or something very similar. \r\nBut changing it is a bit scary to review, because sometimes IP addresses are shared - especially local IPs such as 127.0.0.1. So just changing it to ignore the port would have the potential to make local setups that probably exist out there not work any longer.\r\n",
      "created_at": "2025-04-22T15:17:04Z",
      "updated_at": "2025-04-22T15:17:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2054341299",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054341299"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054365166",
      "pull_request_review_id": 2784525433,
      "id": 2054365166,
      "node_id": "PRRC_kwDOABII5856cx_u",
      "diff_hunk": "@@ -404,10 +389,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             return nullptr;\n \n         // Look for an existing connection\n-        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-        if (pnode)\n-        {\n-            LogPrintf(\"Failed to open new connection, already connected\\n\");\n+        if (OutboundConnectedToService(addrConnect)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "in_reply_to_id": 2054309204,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Yes, I see review feedback on that in https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1789702441 and https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370747413.",
      "created_at": "2025-04-22T15:30:24Z",
      "updated_at": "2025-04-22T15:30:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2054365166",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054365166"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054370924",
      "pull_request_review_id": 2784534877,
      "id": 2054370924,
      "node_id": "PRRC_kwDOABII5856czZs",
      "diff_hunk": "@@ -332,42 +332,27 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+bool CConnman::OutboundConnectedToStr(const std::string& str_addr)\n {\n     LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-      if (static_cast<CNetAddr>(pnode->addr) == ip) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n-}\n-\n-CNode* CConnman::FindNode(const std::string& addrName)\n-{\n-    LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-        if (pnode->m_addr_name == addrName) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n+    return std::ranges::any_of(m_nodes, [&str_addr](CNode* node) { return node->m_addr_name == str_addr; });\n }\n \n-CNode* CConnman::FindNode(const CService& addr)\n+bool CConnman::OutboundConnectedToService(const CService& addr)\n {\n     LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-        if (static_cast<CService>(pnode->addr) == addr) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n+    return std::ranges::any_of(m_nodes, [&addr](CNode* node) { return node->addr == addr; });\n }\n \n bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    const CNetAddr net_addr{addr};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "in_reply_to_id": 2054324859,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Fixed, thanks!",
      "created_at": "2025-04-22T15:33:42Z",
      "updated_at": "2025-04-22T15:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2054370924",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054370924"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 349,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054383490",
      "pull_request_review_id": 2784554940,
      "id": 2054383490,
      "node_id": "PRRC_kwDOABII5856c2eC",
      "diff_hunk": "@@ -404,10 +389,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             return nullptr;\n \n         // Look for an existing connection\n-        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-        if (pnode)\n-        {\n-            LogPrintf(\"Failed to open new connection, already connected\\n\");\n+        if (OutboundConnectedToService(addrConnect)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "in_reply_to_id": 2054309204,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Love how you deciphered this at an instant! :heart:\r\n\r\nI will look into adding a comment to the call sites about this.",
      "created_at": "2025-04-22T15:40:54Z",
      "updated_at": "2025-04-22T15:40:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2054383490",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054383490"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054408043",
      "pull_request_review_id": 2784594674,
      "id": 2054408043,
      "node_id": "PRRC_kwDOABII5856c8dr",
      "diff_hunk": "@@ -404,10 +389,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             return nullptr;\n \n         // Look for an existing connection\n-        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-        if (pnode)\n-        {\n-            LogPrintf(\"Failed to open new connection, already connected\\n\");\n+        if (OutboundConnectedToService(addrConnect)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "in_reply_to_id": 2054309204,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Hmm, in `CConnman::OpenNetworkConnection()` the code does:\r\n\r\n* if `pszDest` is not set then use `AlreadyConnectedToAddress(addrConnect)` which ignores the port\r\n* if `pszDest` is set then `OutboundConnectedToStr(pszDest)` which compares the port as well.\r\n\r\nChanging that logic is, I guess, out of the scope of this non-functional refactor PR. If to be done it would better be assessed in isolation in its own PR.",
      "created_at": "2025-04-22T15:55:21Z",
      "updated_at": "2025-04-22T15:55:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2054408043",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054408043"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054434566",
      "pull_request_review_id": 2784638131,
      "id": 2054434566,
      "node_id": "PRRC_kwDOABII5856dC8G",
      "diff_hunk": "@@ -404,10 +389,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             return nullptr;\n \n         // Look for an existing connection\n-        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-        if (pnode)\n-        {\n-            LogPrintf(\"Failed to open new connection, already connected\\n\");\n+        if (OutboundConnectedToService(addrConnect)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "in_reply_to_id": 2054309204,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> I will look into adding a comment to the call sites about this.\r\n\r\nCan't come up with a good comment. Leaving it as it is, unless somebody has suggestions.",
      "created_at": "2025-04-22T16:12:22Z",
      "updated_at": "2025-04-22T16:12:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2054434566",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054434566"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054679774",
      "pull_request_review_id": 2785043300,
      "id": 2054679774,
      "node_id": "PRRC_kwDOABII5856d-ze",
      "diff_hunk": "@@ -332,42 +332,27 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+bool CConnman::OutboundConnectedToStr(const std::string& str_addr)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "in_reply_to_id": null,
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "```suggestion\r\nbool CConnman::OutboundConnectedToAddress(const std::string& str_addr)\r\n```\r\n\r\n\r\nThe caller already knows that the parameter is a string type, but clarifying what the string represents (a network address) seems better to me.",
      "created_at": "2025-04-22T18:48:11Z",
      "updated_at": "2025-04-22T18:48:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2054679774",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2054679774"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 335,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055412943",
      "pull_request_review_id": 2786207269,
      "id": 2055412943,
      "node_id": "PRRC_kwDOABII5856gxzP",
      "diff_hunk": "@@ -332,42 +332,27 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+bool CConnman::OutboundConnectedToStr(const std::string& str_addr)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "in_reply_to_id": 2054679774,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Alright, I agree `OutboundConnectedToStr()` is a bit odd. If it is renamed to `OutboundConnectedToAddress()`, then what about `OutboundConnectedToService()`? Leave it like this? Then it would be confusing because we have the `CAddress` type and the `...Address()` suffix would imply such an argument. I wanted to avoid overload (two different methods with the same name) because that is not grep-friendly. Should I drop that and have an overload?\r\n\r\nMaybe:\r\n* `ConnectedToAddrPort(string)` and `ConnectedToAddrPort(CService)` (overload), or\r\n* `ConnectedToAddrPortStr()` and `ConnectedToAddrPortService()`?\r\n\r\nThere is this old rule that \"if you cannot find a good name for a method, something is wrong with that method\", but this method already exists as it is. Leave its name to `FindNode()`?",
      "created_at": "2025-04-23T07:21:30Z",
      "updated_at": "2025-04-23T07:21:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2055412943",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2055412943"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 335,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2056499667",
      "pull_request_review_id": 2788091653,
      "id": 2056499667,
      "node_id": "PRRC_kwDOABII5856k7HT",
      "diff_hunk": "@@ -332,42 +332,27 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+bool CConnman::OutboundConnectedToStr(const std::string& str_addr)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "in_reply_to_id": 2054679774,
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "`FindNode()` is not bad, but I personally like `ConnectedToAddrPort()`. This name makes the purpose of the function very clear.\r\nThe parameter type (`CService` and `str`) makes the difference clear. It is not necessary for the function name to describe the parameter (except in Rust).",
      "created_at": "2025-04-23T16:50:10Z",
      "updated_at": "2025-04-23T16:57:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2056499667",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2056499667"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 335,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2057808141",
      "pull_request_review_id": 2790161149,
      "id": 2057808141,
      "node_id": "PRRC_kwDOABII5856p6kN",
      "diff_hunk": "@@ -332,42 +332,27 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+bool CConnman::OutboundConnectedToStr(const std::string& str_addr)\n {\n     LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-      if (static_cast<CNetAddr>(pnode->addr) == ip) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n-}\n-\n-CNode* CConnman::FindNode(const std::string& addrName)\n-{\n-    LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-        if (pnode->m_addr_name == addrName) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n+    return std::ranges::any_of(m_nodes, [&str_addr](CNode* node) { return node->m_addr_name == str_addr; });\n }\n \n-CNode* CConnman::FindNode(const CService& addr)\n+bool CConnman::OutboundConnectedToService(const CService& addr)\n {\n     LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-        if (static_cast<CService>(pnode->addr) == addr) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n+    return std::ranges::any_of(m_nodes, [&addr](CNode* node) { return node->addr == addr; });\n }\n \n bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    const CNetAddr& net_addr{addr};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: It is somewhat opaque what is going on here. Would be good to add comment:\r\n```suggestion\r\n    // Downcast to CNetAddr as we don't care to match on port or other parts of CAddress.\r\n    const CNetAddr& net_addr{addr};\r\n```\r\nAn even clearer alternative would be to take `CNetAddr` as the function argument and instead clarify this behavior in the comment of the header.",
      "created_at": "2025-04-24T08:11:17Z",
      "updated_at": "2025-04-24T09:56:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2057808141",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2057808141"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 349,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2057829305",
      "pull_request_review_id": 2790161149,
      "id": 2057829305,
      "node_id": "PRRC_kwDOABII5856p_u5",
      "diff_hunk": "@@ -404,10 +389,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             return nullptr;\n \n         // Look for an existing connection\n-        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-        if (pnode)\n-        {\n-            LogPrintf(\"Failed to open new connection, already connected\\n\");\n+        if (OutboundConnectedToService(addrConnect)) {\n+            LogPrintf(\"Failed to open new connection to %s, already connected\", addrConnect.ToStringAddrPort());",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 63,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: Should avoid deprecated macro:\r\n```suggestion\r\n            LogInfo(\"Failed to open new connection to %s, already connected\", addrConnect.ToStringAddrPort());\r\n```",
      "created_at": "2025-04-24T08:19:53Z",
      "updated_at": "2025-04-24T09:56:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2057829305",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2057829305"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 393,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2057856277",
      "pull_request_review_id": 2790161149,
      "id": 2057856277,
      "node_id": "PRRC_kwDOABII5856qGUV",
      "diff_hunk": "@@ -404,10 +389,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             return nullptr;\n \n         // Look for an existing connection\n-        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-        if (pnode)\n-        {\n-            LogPrintf(\"Failed to open new connection, already connected\\n\");\n+        if (OutboundConnectedToService(addrConnect)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "in_reply_to_id": 2054309204,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Interesting aspect. Agree current name makes sense - inbound nodes, if they are already connected to us would *not* be using their listening port (even if behind NAT/router). So we could be attempting to establish an outbound connection to a *different* node behind the same IP.\r\n\r\nBut even if `ConnectNode` here distinguishes between ports, the only caller may override and filter out connections without regard for port, as pointed out above (https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2054408043). That part of that other function seems like a bug, that needn't be fixed in this PR.\r\n\r\n---\r\n\r\nI assume addr-gossip only contains address+port from *outbound* peers (unless gossip is spoofed), otherwise we would be gossiping non-listening ports, which are pretty useless. Maybe inbound nodes already share their listening port with us upon connection, for us to be able to gossip about it? (Pointers to RTFM/code with links are welcome!).",
      "created_at": "2025-04-24T08:35:26Z",
      "updated_at": "2025-04-24T09:56:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2057856277",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2057856277"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2058207242",
      "pull_request_review_id": 2790816343,
      "id": 2058207242,
      "node_id": "PRRC_kwDOABII5856rcAK",
      "diff_hunk": "@@ -404,10 +389,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             return nullptr;\n \n         // Look for an existing connection\n-        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-        if (pnode)\n-        {\n-            LogPrintf(\"Failed to open new connection, already connected\\n\");\n+        if (OutboundConnectedToService(addrConnect)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "in_reply_to_id": 2054309204,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> I assume addr-gossip only contains address+port from _outbound_ peers ...\r\n\r\nThe origin of the gossip is the self-announcement done by each node:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/458720e5e98c6e9103aea1fdfcd39bafc26c27bb/src/net_processing.cpp#L5286-L5300\r\n\r\nthen as this address is received by a node, it is further relayed to other nodes. Eventually everybody stores it in their addrman. Then [`GETADDR` requests](https://developer.bitcoin.org/reference/p2p_networking.html#getaddr) are served from addrman. Outbound connections are made to addresses that are already in addrman.",
      "created_at": "2025-04-24T11:54:44Z",
      "updated_at": "2025-04-24T11:54:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2058207242",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2058207242"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2058288419",
      "pull_request_review_id": 2790944774,
      "id": 2058288419,
      "node_id": "PRRC_kwDOABII5856rv0j",
      "diff_hunk": "@@ -332,42 +332,27 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+bool CConnman::OutboundConnectedToStr(const std::string& str_addr)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "in_reply_to_id": 2054679774,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "So this:\r\n\r\n<details>\r\n<summary>[patch] rename</summary>\r\n\r\n```diff\r\n--- i/src/net.h\r\n+++ w/src/net.h\r\n@@ -1355,24 +1355,24 @@ private:\r\n     /**\r\n      * Determine whether we're already connected to a given \"address:port\".\r\n      * Note that for inbound connections, the peer is likely using a random outbound\r\n      * port on their side, so this will likely not match any inbound connections.\r\n      * @param[in] str_addr String of the form \"address:port\", e.g. \"1.2.3.4:8333\".\r\n      * @return true if connected to addrName.\r\n      */\r\n-    bool OutboundConnectedToStr(const std::string& str_addr);\r\n+    bool ConnectedToAddrPort(const std::string& str_addr);\r\n \r\n     /**\r\n      * Determine whether we're already connected to a given address:port.\r\n      * Note that for inbound connections, the peer is likely using a random outbound\r\n      * port on their side, so this will likely not match any inbound connections.\r\n      * @param[in] addr Address and port to check.\r\n      * @return true if connected to addr.\r\n      */\r\n-    bool OutboundConnectedToService(const CService& addr);\r\n+    bool ConnectedToAddrPort(const CService& addr);\r\n \r\n     /**\r\n      * Determine whether we're already connected to a given address, in order to\r\n      * avoid initiating duplicate connections.\r\n      */\r\n     bool AlreadyConnectedToAddress(const CAddress& addr);\r\n \r\n```\r\n</details>\r\n\r\n?\r\n\r\nNote the similar function that has an \"Already\" prefix. Make all 3 consistent, either all with or all without an \"Already\" prefix?\r\n\r\n@jonatack, @hodlinator, you already ACKed the current naming, what do you think?",
      "created_at": "2025-04-24T12:30:59Z",
      "updated_at": "2025-04-24T12:30:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2058288419",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2058288419"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 335,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2058384454",
      "pull_request_review_id": 2791097305,
      "id": 2058384454,
      "node_id": "PRRC_kwDOABII5856sHRG",
      "diff_hunk": "@@ -332,42 +332,27 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+bool CConnman::OutboundConnectedToStr(const std::string& str_addr)\n {\n     LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-      if (static_cast<CNetAddr>(pnode->addr) == ip) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n-}\n-\n-CNode* CConnman::FindNode(const std::string& addrName)\n-{\n-    LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-        if (pnode->m_addr_name == addrName) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n+    return std::ranges::any_of(m_nodes, [&str_addr](CNode* node) { return node->m_addr_name == str_addr; });\n }\n \n-CNode* CConnman::FindNode(const CService& addr)\n+bool CConnman::OutboundConnectedToService(const CService& addr)\n {\n     LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-        if (static_cast<CService>(pnode->addr) == addr) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n+    return std::ranges::any_of(m_nodes, [&addr](CNode* node) { return node->addr == addr; });\n }\n \n bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    const CNetAddr& net_addr{addr};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "in_reply_to_id": 2057808141,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "but, but, but... :) this function does care to compare the port as it compares `node->m_addr_name` to `addr.ToStringAddrPort()`. If the argument is changed from `CAddress` to `CNetAddr`, then it would need another argument - the string \"addr:port\". This oddness is the same in `master`. Now I wonder if this condition:\r\n\r\n```cpp\r\nnode->addr == net_addr || node->m_addr_name == str_addr\r\n\r\n// or in master, which is the same:\r\n// FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort())\r\n```\r\n\r\nis not the same as:\r\n\r\n```cpp\r\nnode->addr == net_addr\r\n```\r\n\r\nI think it is...",
      "created_at": "2025-04-24T13:03:08Z",
      "updated_at": "2025-04-24T13:03:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2058384454",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2058384454"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 349,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2058445224",
      "pull_request_review_id": 2791193429,
      "id": 2058445224,
      "node_id": "PRRC_kwDOABII5856sWGo",
      "diff_hunk": "@@ -332,42 +332,27 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+bool CConnman::OutboundConnectedToStr(const std::string& str_addr)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "in_reply_to_id": 2054679774,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "These are the best I could come up with:\r\n* `IsConnectedToStrAddr`\r\n* {`IsConnectedToService` |  `IsConnectedToAddrPort`}\r\n* `IsConnectedToAddress`\r\n\r\n`Is`-prefix == short way to signify boolean query function.",
      "created_at": "2025-04-24T13:24:24Z",
      "updated_at": "2025-04-24T13:25:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2058445224",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2058445224"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 335,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2058477569",
      "pull_request_review_id": 2791251428,
      "id": 2058477569,
      "node_id": "PRRC_kwDOABII5856seAB",
      "diff_hunk": "@@ -332,42 +332,27 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+bool CConnman::OutboundConnectedToStr(const std::string& str_addr)\n {\n     LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-      if (static_cast<CNetAddr>(pnode->addr) == ip) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n-}\n-\n-CNode* CConnman::FindNode(const std::string& addrName)\n-{\n-    LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-        if (pnode->m_addr_name == addrName) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n+    return std::ranges::any_of(m_nodes, [&str_addr](CNode* node) { return node->m_addr_name == str_addr; });\n }\n \n-CNode* CConnman::FindNode(const CService& addr)\n+bool CConnman::OutboundConnectedToService(const CService& addr)\n {\n     LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-        if (static_cast<CService>(pnode->addr) == addr) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n+    return std::ranges::any_of(m_nodes, [&addr](CNode* node) { return node->addr == addr; });\n }\n \n bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    const CNetAddr& net_addr{addr};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "in_reply_to_id": 2057808141,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Inconsistency seems to have been introduced when we started checking for string-version in 9bab521df895c149579b9e64931405c56b008afb in April of 2012. Not on purpose I would wager.",
      "created_at": "2025-04-24T13:39:29Z",
      "updated_at": "2025-04-24T13:39:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2058477569",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2058477569"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 349,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2058523521",
      "pull_request_review_id": 2791328047,
      "id": 2058523521,
      "node_id": "PRRC_kwDOABII5856spOB",
      "diff_hunk": "@@ -404,10 +389,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             return nullptr;\n \n         // Look for an existing connection\n-        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-        if (pnode)\n-        {\n-            LogPrintf(\"Failed to open new connection, already connected\\n\");\n+        if (OutboundConnectedToService(addrConnect)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "in_reply_to_id": 2054309204,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good that we advertise our listening port for outbound peers! Seems kind of unnecessary to tell inbound peers about the address they report as seeing us as (`CService{node.GetAddrLocal()}`):\r\nhttps://github.com/bitcoin/bitcoin/blob/458720e5e98c6e9103aea1fdfcd39bafc26c27bb/src/net.cpp#L246-L266\r\nBut I guess it simplifies the addrman-logic a little bit, not having to populate/refresh it from the local outbound connections.",
      "created_at": "2025-04-24T13:59:52Z",
      "updated_at": "2025-04-24T13:59:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2058523521",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2058523521"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2058610798",
      "pull_request_review_id": 2791472640,
      "id": 2058610798,
      "node_id": "PRRC_kwDOABII5856s-hu",
      "diff_hunk": "@@ -332,42 +332,27 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+bool CConnman::OutboundConnectedToStr(const std::string& str_addr)\n {\n     LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-      if (static_cast<CNetAddr>(pnode->addr) == ip) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n-}\n-\n-CNode* CConnman::FindNode(const std::string& addrName)\n-{\n-    LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-        if (pnode->m_addr_name == addrName) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n+    return std::ranges::any_of(m_nodes, [&str_addr](CNode* node) { return node->m_addr_name == str_addr; });\n }\n \n-CNode* CConnman::FindNode(const CService& addr)\n+bool CConnman::OutboundConnectedToService(const CService& addr)\n {\n     LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-        if (static_cast<CService>(pnode->addr) == addr) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n+    return std::ranges::any_of(m_nodes, [&addr](CNode* node) { return node->addr == addr; });\n }\n \n bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    const CNetAddr& net_addr{addr};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "in_reply_to_id": 2057808141,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Opened https://github.com/bitcoin/bitcoin/pull/32338 with this single change, dropping the `|| FindNode(addr.ToStringAddrPort())` condition.",
      "created_at": "2025-04-24T14:39:11Z",
      "updated_at": "2025-04-24T14:39:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2058610798",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2058610798"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 349,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2063650801",
      "pull_request_review_id": 2799289459,
      "id": 2063650801,
      "node_id": "PRRC_kwDOABII5857AM_x",
      "diff_hunk": "@@ -332,42 +332,27 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+bool CConnman::OutboundConnectedToStr(const std::string& str_addr)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "in_reply_to_id": 2054679774,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think this:\r\n\r\nAfter https://github.com/bitcoin/bitcoin/pull/32338 makes it, then here in this PR:\r\n\r\n* rename `AlreadyConnectedToAddress()` to `IsConnectedToAddr()`, compare just the address\r\n* rename the two remaining `FindNode()` to `IsConnectedToAddrPort()`, overload, one taking a string and the other taking a `CService`, both comparing the address and the port.",
      "created_at": "2025-04-28T13:22:46Z",
      "updated_at": "2025-04-28T13:22:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2063650801",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2063650801"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 335,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2064139694",
      "pull_request_review_id": 2800093042,
      "id": 2064139694,
      "node_id": "PRRC_kwDOABII5857CEWu",
      "diff_hunk": "@@ -404,10 +389,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             return nullptr;\n \n         // Look for an existing connection\n-        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-        if (pnode)\n-        {\n-            LogPrintf(\"Failed to open new connection, already connected\\n\");\n+        if (OutboundConnectedToService(addrConnect)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "in_reply_to_id": 2054309204,
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> Hmm, in `CConnman::OpenNetworkConnection()` the code does:\r\n> \r\n>     * if `pszDest` is not set then use `AlreadyConnectedToAddress(addrConnect)` which ignores the port\r\n> \r\n>     * if `pszDest` is set then `OutboundConnectedToStr(pszDest)` which compares the port as well.\r\n> \r\n> \r\n> Changing that logic is, I guess, out of the scope of this non-functional refactor PR. If to be done it would better be assessed in isolation in its own PR.\r\n\r\nAlso, later on in `ConnectNode()`:\r\n\r\n```c++\r\n    if (pszDest == nullptr) {\r\n        if (IsLocal(addrConnect))\r\n            return nullptr;\r\n\r\n        // Look for an existing connection\r\n        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\r\n        if (pnode)\r\n        {\r\n            LogPrintf(\"Failed to open new connection, already connected\\n\");\r\n            return nullptr;\r\n        }\r\n```\r\n\r\nWhich seems to be redundant, as it's a strictly narrower check because of the port?",
      "created_at": "2025-04-28T17:20:50Z",
      "updated_at": "2025-04-28T17:20:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2064139694",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2064139694"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2065614037",
      "pull_request_review_id": 2802226986,
      "id": 2065614037,
      "node_id": "PRRC_kwDOABII5857HsTV",
      "diff_hunk": "@@ -404,10 +389,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             return nullptr;\n \n         // Look for an existing connection\n-        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-        if (pnode)\n-        {\n-            LogPrintf(\"Failed to open new connection, already connected\\n\");\n+        if (OutboundConnectedToService(addrConnect)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 62,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "1e415d2cb703fcd1b622e5343fa264425601c8df",
      "in_reply_to_id": 2054309204,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "True, and `ConnectNode()` is only called from `OpenNetworkConnection()`. Looks like another room for improvement.\r\n\r\nWhile this may seem minor, the amount of developers' time spent on grasping it is not. In the past I have stared at these calls disproportionally long. Would be nice if this is spared to future developers. I will go after that separately from this PR.",
      "created_at": "2025-04-29T06:45:18Z",
      "updated_at": "2025-04-29T06:45:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2065614037",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2065614037"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2070021226",
      "pull_request_review_id": 2809409397,
      "id": 2070021226,
      "node_id": "PRRC_kwDOABII5857YgRq",
      "diff_hunk": "@@ -332,42 +332,27 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+bool CConnman::OutboundConnectedToStr(const std::string& str_addr)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "in_reply_to_id": 2054679774,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2025-05-01T09:08:04Z",
      "updated_at": "2025-05-01T09:08:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2070021226",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2070021226"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 335,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2070024083",
      "pull_request_review_id": 2809413683,
      "id": 2070024083,
      "node_id": "PRRC_kwDOABII5857Yg-T",
      "diff_hunk": "@@ -332,42 +332,27 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+bool CConnman::OutboundConnectedToStr(const std::string& str_addr)\n {\n     LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-      if (static_cast<CNetAddr>(pnode->addr) == ip) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n-}\n-\n-CNode* CConnman::FindNode(const std::string& addrName)\n-{\n-    LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-        if (pnode->m_addr_name == addrName) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n+    return std::ranges::any_of(m_nodes, [&str_addr](CNode* node) { return node->m_addr_name == str_addr; });\n }\n \n-CNode* CConnman::FindNode(const CService& addr)\n+bool CConnman::OutboundConnectedToService(const CService& addr)\n {\n     LOCK(m_nodes_mutex);\n-    for (CNode* pnode : m_nodes) {\n-        if (static_cast<CService>(pnode->addr) == addr) {\n-            return pnode;\n-        }\n-    }\n-    return nullptr;\n+    return std::ranges::any_of(m_nodes, [&addr](CNode* node) { return node->addr == addr; });\n }\n \n bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    const CNetAddr& net_addr{addr};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "in_reply_to_id": 2057808141,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "#32338 was merged and these variables are not necessary now.",
      "created_at": "2025-05-01T09:09:08Z",
      "updated_at": "2025-05-01T09:09:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2070024083",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2070024083"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 349,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2070059886",
      "pull_request_review_id": 2809470003,
      "id": 2070059886,
      "node_id": "PRRC_kwDOABII5857Yptu",
      "diff_hunk": "@@ -404,10 +389,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             return nullptr;\n \n         // Look for an existing connection\n-        CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-        if (pnode)\n-        {\n-            LogPrintf(\"Failed to open new connection, already connected\\n\");\n+        if (OutboundConnectedToService(addrConnect)) {\n+            LogPrintf(\"Failed to open new connection to %s, already connected\", addrConnect.ToStringAddrPort());",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 63,
      "commit_id": "4f635d100dd1ab5e83bb392d8fbee4a3f4400315",
      "original_commit_id": "cc8f239663a0874c307efa30815b40d9ef40badb",
      "in_reply_to_id": 2057829305,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done in latest push.",
      "created_at": "2025-05-01T09:20:46Z",
      "updated_at": "2025-05-01T09:20:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32326#discussion_r2070059886",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2070059886"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32326"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 393,
      "side": "RIGHT"
    }
  ]
}