{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158",
    "id": 3132300728,
    "node_id": "PR_kwDOABII5866sx24",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/34158",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/34158.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/34158.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/280898134f962c9e24d8025d4d58396b7293f6cb",
    "number": 34158,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "torcontrol: Remove libevent usage",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "This is part of the effort to remove the libevent dependency from our code base: https://github.com/bitcoin/bitcoin/issues/31194\r\n\r\nThere is a dependency on #32061 but it only really needs one commit which is cherry-picked here in first position (add `LineReader`). I hope that a first chunk of that PR can be sliced off and reviewed independently so this PR here is not blocked by it.\r\n\r\nThe current approach tries to reuse existing code and follows roughly similar design decisions. It replaces the libevent-based async I/O with blocking I/O utilizing the existing `Sock` and `CThreadInterrupt`. The controller runs in a dedicated thread.\r\n\r\nThere are some optional code modernizations thrown in made along the way (namings, constexpr etc.). These are not strictly necessary but make the end result with the new code more consistent.",
    "labels": [
      {
        "id": 955867938,
        "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
        "name": "Needs rebase",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2025-12-27T14:20:31Z",
    "updated_at": "2026-01-21T16:38:58Z",
    "mergeable": false,
    "mergeable_state": "dirty",
    "merged": false,
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "sedited",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sedited",
        "html_url": "https://github.com/sedited",
        "followers_url": "https://api.github.com/users/sedited/followers",
        "following_url": "https://api.github.com/users/sedited/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sedited/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sedited/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sedited/subscriptions",
        "organizations_url": "https://api.github.com/users/sedited/orgs",
        "repos_url": "https://api.github.com/users/sedited/repos",
        "events_url": "https://api.github.com/users/sedited/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sedited/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "fjahr:2025-12-torcontrol-take-3",
      "ref": "2025-12-torcontrol-take-3",
      "sha": "280898134f962c9e24d8025d4d58396b7293f6cb",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 196253948,
        "node_id": "MDEwOlJlcG9zaXRvcnkxOTYyNTM5NDg=",
        "name": "bitcoin",
        "full_name": "fjahr/bitcoin",
        "owner": {
          "login": "fjahr",
          "id": 1322187,
          "node_id": "MDQ6VXNlcjEzMjIxODc=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/fjahr",
          "html_url": "https://github.com/fjahr",
          "followers_url": "https://api.github.com/users/fjahr/followers",
          "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
          "organizations_url": "https://api.github.com/users/fjahr/orgs",
          "repos_url": "https://api.github.com/users/fjahr/repos",
          "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/fjahr/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/fjahr/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/fjahr/bitcoin",
        "archive_url": "https://api.github.com/repos/fjahr/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/fjahr/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/fjahr/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/fjahr/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/fjahr/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/fjahr/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/fjahr/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/fjahr/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/fjahr/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/fjahr/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/fjahr/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/fjahr/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/fjahr/bitcoin/events",
        "forks_url": "https://api.github.com/repos/fjahr/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/fjahr/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/fjahr/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/fjahr/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/fjahr/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/fjahr/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/fjahr/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/fjahr/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/fjahr/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/fjahr/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/fjahr/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/fjahr/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/fjahr/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/fjahr/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/fjahr/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/fjahr/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:fjahr/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/fjahr/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/fjahr/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/fjahr/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/fjahr/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/fjahr/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/fjahr/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/fjahr/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/fjahr/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/fjahr/bitcoin/hooks",
        "svn_url": "https://github.com/fjahr/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 4,
        "watchers_count": 4,
        "size": 286577,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-21T08:54:17Z",
        "created_at": "2019-07-10T18:11:06Z",
        "updated_at": "2024-07-23T22:14:45Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "22bde74d1d8f861323eabb8dc60401bbf1226544",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38755,
        "stargazers_count": 87733,
        "watchers_count": 87733,
        "size": 302165,
        "default_branch": "master",
        "open_issues_count": 749,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-21T16:42:24Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2026-01-21T16:50:40Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 638,
    "deletions": 292,
    "changed_files": 10,
    "commits": 8,
    "review_comments": 12,
    "comments": 13
  },
  "events": [
    {
      "event": "commented",
      "id": 3694007666,
      "node_id": "IC_kwDOABII587cLhVy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3694007666",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-27T14:20:37Z",
      "updated_at": "2026-01-21T11:16:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/34158.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [sedited](https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3694015450), [pablomartin4btc](https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3694074809), [janb84](https://github.com/bitcoin/bitcoin/pull/34158#pullrequestreview-3614742906), [waketraindev](https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3694830686) |\n| Stale ACK | [pinheadmz](https://github.com/bitcoin/bitcoin/pull/34158#pullrequestreview-3661580911) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#34353](https://github.com/bitcoin/bitcoin/pull/34353) (refactor: Use std::bind_front over std::bind by maflcko)\n* [#34342](https://github.com/bitcoin/bitcoin/pull/34342) (cli: Replace libevent usage with simple http client by fjahr)\n* [#34242](https://github.com/bitcoin/bitcoin/pull/34242) (Prepare string and net utils for future HTTP operations by pinheadmz)\n* [#32061](https://github.com/bitcoin/bitcoin/pull/32061) (Replace libevent with our own HTTP and socket-handling implementation by pinheadmz)\n* [#31260](https://github.com/bitcoin/bitcoin/pull/31260) (scripted-diff: Type-safe settings retrieval by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3694007666",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158"
    },
    {
      "event": "commented",
      "id": 3694015450,
      "node_id": "IC_kwDOABII587cLjPa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3694015450",
      "actor": {
        "login": "sedited",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sedited",
        "html_url": "https://github.com/sedited",
        "followers_url": "https://api.github.com/users/sedited/followers",
        "following_url": "https://api.github.com/users/sedited/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sedited/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sedited/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sedited/subscriptions",
        "organizations_url": "https://api.github.com/users/sedited/orgs",
        "repos_url": "https://api.github.com/users/sedited/repos",
        "events_url": "https://api.github.com/users/sedited/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sedited/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-27T14:35:33Z",
      "updated_at": "2025-12-27T14:35:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "sedited",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sedited",
        "html_url": "https://github.com/sedited",
        "followers_url": "https://api.github.com/users/sedited/followers",
        "following_url": "https://api.github.com/users/sedited/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sedited/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sedited/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sedited/subscriptions",
        "organizations_url": "https://api.github.com/users/sedited/orgs",
        "repos_url": "https://api.github.com/users/sedited/repos",
        "events_url": "https://api.github.com/users/sedited/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sedited/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3694015450",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158"
    },
    {
      "event": "commented",
      "id": 3694017377,
      "node_id": "IC_kwDOABII587cLjth",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3694017377",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-27T14:38:52Z",
      "updated_at": "2025-12-27T14:38:52Z",
      "author_association": "MEMBER",
      "body": "concept ACK\r\nQuick review on github - where are you using LineReader?",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3694017377",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21766045572,
      "node_id": "HRFPE_lADOABII587gZmTvzwAAAAURW3-E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21766045572",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "a830323f413e804372b4cb4d5ba9f08651fc60d1",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/a830323f413e804372b4cb4d5ba9f08651fc60d1",
      "created_at": "2025-12-27T15:31:49Z"
    },
    {
      "event": "labeled",
      "id": 21766047154,
      "node_id": "LE_lADOABII587gZmTvzwAAAAURW4Wy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21766047154",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-27T15:32:19Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3694045997,
      "node_id": "IC_kwDOABII587cLqst",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3694045997",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-27T15:32:27Z",
      "updated_at": "2025-12-27T15:32:27Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Task `macOS-cross to arm64`: https://github.com/bitcoin/bitcoin/actions/runs/20540187798/job/59003472023</sub>\n<sub>LLM reason (âœ¨ experimental): Compilation error in fuzz tests: undefined type ConnectionCB and invalid TorControlConnection initialization (nullptr) in torcontrol.cpp.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3694045997",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158"
    },
    {
      "event": "commented",
      "id": 3694047661,
      "node_id": "IC_kwDOABII587cLrGt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3694047661",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-27T15:35:22Z",
      "updated_at": "2025-12-28T14:08:34Z",
      "author_association": "CONTRIBUTOR",
      "body": "> where are you using LineReader?\r\n\r\nHeh, I did quite a bit of moving around after I got things working and seems like I picked from the branch where i didn't use it instead of the one where I did at the end. Pushed the right code for it now, using it in `ProcessBuffer`.\r\n\r\nWill work on fixing the fuzz test which I completely missed ðŸ™ƒ That's what's failing the CI.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3694047661",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158"
    },
    {
      "event": "commented",
      "id": 3694074809,
      "node_id": "IC_kwDOABII587cLxu5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3694074809",
      "actor": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-27T16:24:13Z",
      "updated_at": "2025-12-27T16:24:13Z",
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3694074809",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21770050854,
      "node_id": "HRFPE_lADOABII587gZmTvzwAAAAURmJ0m",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21770050854",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "872feec3eb26727385af2f17dd9d32bd03bf9225",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/872feec3eb26727385af2f17dd9d32bd03bf9225",
      "created_at": "2025-12-28T14:08:00Z"
    },
    {
      "event": "unlabeled",
      "id": 21770335146,
      "node_id": "UNLE_lADOABII587gZmTvzwAAAAURnPOq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21770335146",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T15:24:45Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3694830686,
      "node_id": "IC_kwDOABII587cOqRe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3694830686",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T15:33:23Z",
      "updated_at": "2025-12-31T18:33:16Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nThere's some uncovered new code in the coverage report, https://corecheck.dev/bitcoin/bitcoin/pulls/34158\r\nAnd some Sonarcloud warnings to check out.\r\n\r\n\r\n",
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3694830686",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158"
    },
    {
      "event": "reviewed",
      "id": 3614742906,
      "node_id": "PRR_kwDOABII587XdJl6",
      "url": null,
      "actor": null,
      "commit_id": "872feec3eb26727385af2f17dd9d32bd03bf9225",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-28T16:19:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK 8d6f1b02f5868d918bb72059eac3afb881ccafe3\r\n\r\nPR removes LibEvent usages from TorControl and cleans/modernizes the code a bit where touched.\r\n\r\ncode review, build and test. I do not have sufficient exp. to say something about the fuzz improvement commit. Small NIT found while doing the code review.",
      "user": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#pullrequestreview-3614742906",
      "submitted_at": "2025-12-28T16:19:55Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21771696849,
      "node_id": "HRFPE_lADOABII587gZmTvzwAAAAURsbrR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21771696849",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "67f9f1423678fae4ed2c4c0b806c5ef1da5f6dd7",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/67f9f1423678fae4ed2c4c0b806c5ef1da5f6dd7",
      "created_at": "2025-12-28T21:57:41Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21771710084,
      "node_id": "HRFPE_lADOABII587gZmTvzwAAAAURse6E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21771710084",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "496664894a5032240adb117376747cb1f4972527",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/496664894a5032240adb117376747cb1f4972527",
      "created_at": "2025-12-28T22:01:15Z"
    },
    {
      "event": "labeled",
      "id": 21771713530,
      "node_id": "LE_lADOABII587gZmTvzwAAAAURsfv6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21771713530",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T22:02:06Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3695083890,
      "node_id": "IC_kwDOABII587cPoFy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3695083890",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T22:02:16Z",
      "updated_at": "2025-12-28T22:02:16Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Task `lint`: https://github.com/bitcoin/bitcoin/actions/runs/20560088214/job/59049502835</sub>\n<sub>LLM reason (âœ¨ experimental): Python linting failed: an f-string had no placeholders (ruff warning F541) in test/functional/feature_torcontrol.py.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3695083890",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158"
    },
    {
      "event": "commented",
      "id": 3695092837,
      "node_id": "IC_kwDOABII587cPqRl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3695092837",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T22:16:13Z",
      "updated_at": "2025-12-28T22:16:13Z",
      "author_association": "CONTRIBUTOR",
      "body": "Addressed feedback.\r\n\r\n> There's some uncovered new code in the coverage report, https://corecheck.dev/bitcoin/bitcoin/pulls/34158\r\n\r\nThe old code was largely uncovered as well but I have looked into it and added a simple functional test that provides some basic end-to-end coverage. I thought about unit tests too but I am not sure they provide much value aside from the functional and fuzz tests. But happy to be convinced otherwise if there are ideas for what they should cover.\r\n\r\n> And some Sonarcloud warnings to check out.\r\n\r\nI don't know what that is and the screenshot doesn't allow me to see which lines are meant by the comment. Happy to look into them if you can transfer the comments matching to the correct lines here somehow.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3695092837",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158"
    },
    {
      "event": "commented",
      "id": 3695125830,
      "node_id": "IC_kwDOABII587cPyVG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3695125830",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T23:14:40Z",
      "updated_at": "2025-12-31T18:32:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I don't know what that is and the screenshot doesn't allow me to see which lines are meant by the comment. Happy to look into them if you can transfer the comments matching to the correct lines here somehow.\r\n\r\nYou can see the warnings on https://corecheck.dev/bitcoin/bitcoin/pulls/34158 scroll down the page, above benchmarks, below uncovered included code\r\n\r\n\r\n",
      "user": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3695125830",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158"
    },
    {
      "event": "unlabeled",
      "id": 21771959623,
      "node_id": "UNLE_lADOABII587gZmTvzwAAAAURtb1H",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21771959623",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-28T23:17:55Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDJlZjk2YTUxZmUwZTcxZTYwYWY0NGNmNjRkNzU5MTIzMTQxYTRjZWU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2ef96a51fe0e71e60af44cf64d759123141a4cee",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/2ef96a51fe0e71e60af44cf64d759123141a4cee",
      "tree": {
        "sha": "890c9c7bc32c9e6122dbd0a276678ce9c85f1d7b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/890c9c7bc32c9e6122dbd0a276678ce9c85f1d7b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 890c9c7bc32c9e6122dbd0a276678ce9c85f1d7b\nparent 94ddc2dced5736612e358a3b80f2bc718fbd8161\nauthor Matthew Zipkin <pinheadmz@gmail.com> 1727464937 -0400\ncommitter Fabian Jahr <fjahr@protonmail.com> 1767200723 +0100\n\nstring: add LineReader\n\nThis is a helper struct to parse HTTP messages from data in buffers\nfrom sockets. HTTP messages begin with headers which are\nCRLF-terminated lines (\\n or \\r\\n) followed by an arbitrary amount of\nbody data. Whitespace is trimmed from the field lines but not the body.\n\nhttps://httpwg.org/specs/rfc9110.html#rfc.section.5\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmlVV9MVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNQfEP/itg25u/3EyzaMsVxPcN8BRJA008\n9FyGKNLmgNky4+u9xUzw+u5uux5NLHEzFT5gpHkHUTRmS8RlvO9q6/im9jwKFjNM\nEy0TjL27xijvH6DStda8anABUZP4ElR9RzgYdV+bf24cLLpgn4up82GtTv5hjffY\nQm0yPbBm+a4Qdm6HQhRd1tGtUa+kuhekZhywbXUZ3EvTvKK/ycYtnlTtHKeFdyZS\nvUZQTqm7xGEowLzUdDRyqDFcH0gRAZTqnuw4M5qBiXuxDJs43C5ae3WMPxBEnMEG\nNBohFaBJIOwOVCXLoqWdHDCtM6FP+NIRejnVKj5GrD5UnkJFbUeP/y2ywXxPAxl7\n/IWsudODMe+ZRmEsnEORvinNI24vson2jDeNL4mCdQFMBUbAYPqYmKV96pshk+yt\n65YyEwjs5bXYlDkFBox+u3VsiltwCsKby281Fs5e/c6XJFzrlriSG8FH/PYEJIIr\nfAFTeEehS1/wT1gwmdSPARfa86MPj4nVNYA1A4h4P1w1O/QxM3oSmrL/iJp7wbqo\nURvltAh7gMsxv8jylLdHmudZeT9DW96MidSHzeslpiHk8c0fKbfYgrAI58xFJITm\nPyU9fLeG/9zWrzHzwrY37fmqo8oRtx/XXUddKQLUmU0PQQqpamU8z+hfQyTCjIcq\ngERLwKVNRWYlczvp\n=XX5E\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/94ddc2dced5736612e358a3b80f2bc718fbd8161",
          "sha": "94ddc2dced5736612e358a3b80f2bc718fbd8161",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/94ddc2dced5736612e358a3b80f2bc718fbd8161"
        }
      ],
      "message": "string: add LineReader\n\nThis is a helper struct to parse HTTP messages from data in buffers\nfrom sockets. HTTP messages begin with headers which are\nCRLF-terminated lines (\\n or \\r\\n) followed by an arbitrary amount of\nbody data. Whitespace is trimmed from the field lines but not the body.\n\nhttps://httpwg.org/specs/rfc9110.html#rfc.section.5",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-12-31T17:05:23Z"
      },
      "author": {
        "name": "Matthew Zipkin",
        "email": "pinheadmz@gmail.com",
        "date": "2024-09-27T19:22:17Z"
      },
      "sha": "2ef96a51fe0e71e60af44cf64d759123141a4cee"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE4OGU2MzA5MGQyZjMzNzljMmQ4YzMwOTdlZmY3ZGQzZDc2NjBhN2U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/188e63090d2f3379c2d8c3097eff7dd3d7660a7e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/188e63090d2f3379c2d8c3097eff7dd3d7660a7e",
      "tree": {
        "sha": "d207f792358a9f221e9d1be49c5267127ab8f5b0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d207f792358a9f221e9d1be49c5267127ab8f5b0"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree d207f792358a9f221e9d1be49c5267127ab8f5b0\nparent 2ef96a51fe0e71e60af44cf64d759123141a4cee\nauthor Fabian Jahr <fjahr@protonmail.com> 1766795562 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1767200723 +0100\n\nrefactor: Use constexpr in torcontrol where possible\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmlVV9MVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNofYP/2XS1E+tlJVhOLKgtdO+aQSWwMOv\nr+wE6QzGEsBbN55V2ci7tE+IncAMRN5CdHNQCaTCrdTOQ8bhk+hG2RXTPHximIns\ne4gNa3c7BO60stsyIS97Xrj/ZRuG66xzRJ2Bewutg/Ahosie43ndbm1xFO9rKHVC\nllFhDgShj/xu2ze7B2vwo4ai3kJHLDA/324zWpOotrj98DxaxOgGk3ik9iQnS+4v\nJmccuDLY5KsiZ2K57H9EgNbWSJgb+i9X9t0CvGrzxveBWmfJrsDMn3r489lSHxA+\nsAUC4IBz0pGmmMGthrOxaBTd1qiUvyfbpdMLE0re1nATQXXJ870/4EQ0mZy+l1tw\ngFHbQyuJx9nyKHXR8qtyN0Ib8Abv9Jjn5SgvvDOpkCqv3qlCcthZqX9ZgDBrcJq+\nB5Px08/wrgxQ6EnsD7i3jY20LRMH0u6TgCtEQ2ERlJnv31VgmR3pfJ6AumdlaBDp\n1ZKU0m/R94BjqtYZGIOTNEGiFoyuONLkhFOVrMp2/M1SY9t2x+DZArlWC/u+yQjl\nZuCEEscipjbw1kykc38cxbvdlXs/20nX8rSRAn7xZXzieTQH6CpHtmIvac8ma5R/\nlp5o0mN6Wq6bQJfnTVtO4UD/9ROjugpBFyf5YRHk3EUn+ktP0HpvwKQTAydsBBCW\nu9jRxHMTzChtwk7t\n=7u4G\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2ef96a51fe0e71e60af44cf64d759123141a4cee",
          "sha": "2ef96a51fe0e71e60af44cf64d759123141a4cee",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2ef96a51fe0e71e60af44cf64d759123141a4cee"
        }
      ],
      "message": "refactor: Use constexpr in torcontrol where possible",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-12-31T17:05:23Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-12-27T00:32:42Z"
      },
      "sha": "188e63090d2f3379c2d8c3097eff7dd3d7660a7e"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21811026054,
      "node_id": "HRFPE_lADOABII587gZmTvzwAAAAUUCdiG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21811026054",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "122ff0a23b1105db187418c5f909ba0ac89e0c21",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/122ff0a23b1105db187418c5f909ba0ac89e0c21",
      "created_at": "2025-12-31T17:05:56Z"
    },
    {
      "event": "commented",
      "id": 3702527710,
      "node_id": "IC_kwDOABII587csBbe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3702527710",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T17:06:21Z",
      "updated_at": "2025-12-31T17:06:21Z",
      "author_association": "CONTRIBUTOR",
      "body": "> You can see the warnings on https://corecheck.dev/bitcoin/bitcoin/pulls/34158 scroll down the page, above benchmarks, below uncovered included code\r\n\r\nTIL, thanks. I addressed the ones that made sense to me.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3702527710",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158"
    },
    {
      "event": "labeled",
      "id": 21811764158,
      "node_id": "LE_lADOABII587gZmTvzwAAAAUUFRu-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21811764158",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T18:18:35Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3702650819,
      "node_id": "IC_kwDOABII587csffD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3702650819",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T18:18:42Z",
      "updated_at": "2025-12-31T18:18:42Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Task `macOS-cross to arm64`: https://github.com/bitcoin/bitcoin/actions/runs/20623563561/job/59230100443</sub>\n<sub>LLM reason (âœ¨ experimental): Compilation failed due to use of std::jthread not available in the target standard library (missing C++20 jthread support).</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3702650819",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21813459493,
      "node_id": "HRFPE_lADOABII587gZmTvzwAAAAUULvol",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21813459493",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "3de90a1159e606585aad32c876b6769d29f46ac1",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/3de90a1159e606585aad32c876b6769d29f46ac1",
      "created_at": "2025-12-31T21:04:42Z"
    },
    {
      "event": "unlabeled",
      "id": 21814079947,
      "node_id": "UNLE_lADOABII587gZmTvzwAAAAUUOHHL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21814079947",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-31T22:20:38Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3661580911,
      "node_id": "PRR_kwDOABII587aP0pv",
      "url": null,
      "actor": null,
      "commit_id": "3de90a1159e606585aad32c876b6769d29f46ac1",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-16T15:08:23Z",
      "author_association": "MEMBER",
      "body": "ACK 3de90a1159e606585aad32c876b6769d29f46ac1\r\n\r\nReviewed each commit, built and ran tests on arm64/macos.\r\n\r\nRan on mainnet with `-onlynet=onion` and observed tor connections in and out. Monitored bitcoind logs with `-debug=tor` and tor daemon logs for errors.\r\n\r\nI also used wireshark to capture torcontrol packets on port 9051 to compare this branch against release 30.2 and observed identical behavior ðŸ‘ \r\n\r\nChecked the exponential retry backoff by killing the tor daemon process while bitcoind was running. Restarted tor after a few minutes and bitcoind continued as expected.\r\n\r\nThis is a very nice simplification of torcontrol and also demonstrates how we can replace libevent in `bitcoin-cli` as well ;-).\r\n\r\n\r\n<details><summary>Show Signature</summary>\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA256\r\n\r\nACK 3de90a1159e606585aad32c876b6769d29f46ac1\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQIzBAEBCAAdFiEE5hdzzW4BBA4vG9eM5+KYS2KJyToFAmlpS64ACgkQ5+KYS2KJ\r\nyTrIVhAAg03Hk1Hu/lEhqpcr1M1aTaxsyNUha2MOtj8L9JMkxYaylX2LlHDzDACq\r\ng23L43GAECJtaMfSWH500Id9JqtWiNhn2tUhXLi9UEVDsbFsVf0usxDyF3kx2fec\r\nCalOFldTrIV8gFOhmS650lyxt0HfyePQ8yTZBH9jeXLrWoyjOU77cjYGzPC3/wUW\r\ngsVqLFFY5FOVzB789abu0ufsv3J6LrwAqwwxhsJpJ7IKhfrR0orX5IOMD4r0JMD6\r\n7lkU+4es68yyHUHnlZxnlhzZMMjaqxgA9/dglNivdP3glUqiEQ+dGVFtjZ0bepff\r\ngHjtm90wbFn59b+kPsTsiFVrYcBe6VBASljjx9QVxgPF8YW3rY64BIXjtOTNIduV\r\nenaiZgLDqkj8hq6mNSSjcbsnk2uDh+dHUTYNLnOaTjzilRXqiwf1SxFqnSnxDQ6f\r\nBESyS36JvznTXCctkaqMQ5KTFcjAOigLx+sPgaWrM0P0iioSvWaAXK1HICfWCCIZ\r\nRG1LS4b4fIIgdIhDjBgL+Mnfz7SoR3U0vvF1XUr6sN5wJVIpDhkzSOB5I9cIMS13\r\nNdbZ9idWLT4JW5sjXg3KZgVV6qADN3fVRvA0xww5B6halGD04qmO+R35nAifkm9h\r\nCYBuURa2xrSWsVTApWwQAM8O901vZicDq09jJqOflkgHzx6soRQ=\r\n=0WeV\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\npinheadmz's public key is [on openpgp.org](https://keys.openpgp.org/vks/v1/by-fingerprint/E61773CD6E01040E2F1BD78CE7E2984B6289C93A)\r\n</details>\r\n\r\n\r\n```\r\nBitcoin Core client v30.99.0-3de90a1159e6 - server 70016/Satoshi:30.99.0/ - services wl2\r\n\r\n<->   type   net   serv  v  mping   ping send recv  txn  blk  hb addrp addrl  age id address                                                             version\r\n in        onion    wl2  2   1325   1325   46   46                   1          0  2 127.0.0.1:59473                                                     70016/Satoshi:30.0.0/\r\nout   full onion  nwcl2  2    931    931    4    0         0      1000          1  0 wffaznxih3nah5tbjpiifbn5v3fzmr5tqzcinacr3cjtnags45owvaqd.onion:8333 70016/Satoshi:30.0.0/\r\nout   full onion  nbwl2  2    934    934    4    0         0      1001          0  1 uathi7edrzgqsby7dikuqe7ehwpwjem2cy4mpsbahrsrtchjdymufxyd.onion:8333 70016/Satoshi:29.0.0/\r\nout   full onion    nwl  1   2810   2810   11    0                1000          0  3 t423yolpdj5udh2yyemopmjtenmmwtfx3rxcdtneda5g2rw6isnjo7id.onion:8333 70016/Satoshi:25.0.0/\r\n                               ms     ms  sec  sec  min  min                  min\r\n\r\n        onion   total   block\r\nin          1       1\r\nout         3       3       0\r\ntotal       4       4\r\n\r\nLocal addresses\r\nzai7kzajktbkqom3edw45zyxnn6e5z5t45d2m7dhmhilgpkz2l3frmad.onion     port   8333    score      4\r\n```\r\n",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#pullrequestreview-3661580911",
      "submitted_at": "2026-01-15T20:24:14Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
    },
    {
      "event": "review_requested",
      "id": 22078990383,
      "node_id": "RRE_lADOABII587gZmTvzwAAAAUkAqgv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22078990383",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T20:24:19Z",
      "requested_reviewer": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 22078990857,
      "node_id": "RRE_lADOABII587gZmTvzwAAAAUkAqoJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22078990857",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T20:24:20Z",
      "requested_reviewer": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 22078991359,
      "node_id": "RRE_lADOABII587gZmTvzwAAAAUkAqv_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22078991359",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T20:24:22Z",
      "requested_reviewer": {
        "login": "sedited",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sedited",
        "html_url": "https://github.com/sedited",
        "followers_url": "https://api.github.com/users/sedited/followers",
        "following_url": "https://api.github.com/users/sedited/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sedited/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sedited/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sedited/subscriptions",
        "organizations_url": "https://api.github.com/users/sedited/orgs",
        "repos_url": "https://api.github.com/users/sedited/repos",
        "events_url": "https://api.github.com/users/sedited/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sedited/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22114500481,
      "node_id": "HRFPE_lADOABII587gZmTvzwAAAAUmIH-B",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22114500481",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "d3ce6442238a38378c4ff242c68bccfe500aab1f",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/d3ce6442238a38378c4ff242c68bccfe500aab1f",
      "created_at": "2026-01-17T14:25:28Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDY4YzFlMWQzODViM2MyZDY0YTMzY2NmNDM5ZTIwMzIyMjY5ODU1YWM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/68c1e1d385b3c2d64a33ccf439e20322269855ac",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/68c1e1d385b3c2d64a33ccf439e20322269855ac",
      "tree": {
        "sha": "1a2663d25001146090e024d40628311979a4b0cb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1a2663d25001146090e024d40628311979a4b0cb"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 1a2663d25001146090e024d40628311979a4b0cb\nparent 188e63090d2f3379c2d8c3097eff7dd3d7660a7e\nauthor Fabian Jahr <fjahr@protonmail.com> 1766796365 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1768660427 +0100\n\nrefactor: Modernize member variable names in torcontrol\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmlrncwVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jN0V8QAKQdTgR4NM7DjHcRmonWFcJfG6aM\niicjf1ZDBwToNbCxeMjstJzieLgArOj3OrO/wx5L0TRpGct9yVgewOOSVIitrBgq\nSno4mRZ8CVF/a0cRkxN0kUCquG0kfOnt2SWBcHme6tI6sjkCWZ9Pv415DJfm/4TQ\ncR4Gjg7qrQB/UsvdNXisw/aCRFNIdgH5ekL0kbebWW7aIaF2LhGKxxIkXKzAAn6g\nQ+aBVwumo7QgBWPNzAWR1Wp9KzsEaTvpgYu2dTXEmZtqp4DmBKMT4dbCOOF+ExyT\nVZGMjqiQcbeo+ygIEVeq3A4Nom9DNg0NTH7GHyKVRURHPIMHToHIArHHQ84Qn5nh\nF7oO0D+Y2+IWTo2jFwYkQVh3yFdviKQIaueueygRVtEh4GirtpUw5ZUgS6h+qRfX\ndm/QdQRKj3ur8arWY1Qxh4dywjbd1bzWxlpZZ3cTZDHKDtzGlSAl8qI3RF3Xygdc\nl6Q0D4XJb05wcq7Ei/7BBluPg2TJA1qLKxUP5PVq6sM/avxSpDMbYXFWqPSeyobz\nHelm/9dxU3FGu285/cw16mV5pHDPArdpfFW6ses3YTQXke2c1haa/8CEAjm48beF\nDd0wNQS3If4MNCyjP2JiVj4YqFpjTAQJ1TRjURnOMlws7TjrIvkmV5jz+ZqFxg+s\nqt0a7KnS4bwz+jjm\n=XouX\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/188e63090d2f3379c2d8c3097eff7dd3d7660a7e",
          "sha": "188e63090d2f3379c2d8c3097eff7dd3d7660a7e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/188e63090d2f3379c2d8c3097eff7dd3d7660a7e"
        }
      ],
      "message": "refactor: Modernize member variable names in torcontrol",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-17T14:33:47Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-12-27T00:46:05Z"
      },
      "sha": "68c1e1d385b3c2d64a33ccf439e20322269855ac"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZjNmI4YjU1NmNkMDFmNTk2MDI1YjRmMzJhZTE0OTYxNmNhMWUxNTc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fc6b8b556cd01f596025b4f32ae149616ca1e157",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/fc6b8b556cd01f596025b4f32ae149616ca1e157",
      "tree": {
        "sha": "d27926987d55791f9421cc2e57fabf9dd9217b96",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d27926987d55791f9421cc2e57fabf9dd9217b96"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree d27926987d55791f9421cc2e57fabf9dd9217b96\nparent 68c1e1d385b3c2d64a33ccf439e20322269855ac\nauthor Fabian Jahr <fjahr@protonmail.com> 1766844804 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1768660473 +0100\n\nrefactor: Get rid of unnecessary newlines in logs\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmlrnfoVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jN684QAIWYDhEY4tC2B+7Ks3z2CWi8C+1n\nHJc2eYbIuJGYX6V2MGHdWOBhIkdFXqipDLiaCtTOyvo+BU7L3WbtELLX5hhH1EZ0\nZkxvrHISV2kQ5WJZ49SxaaA1gdVgM50fEEKj1ZnDUauhsS2Bj/nIwwk6vv2aWGiS\na2hJgYatixoSOz0f8Ob4+8RPq9kL64jSDkIFAT2CWPBC/ryqjn2MPGqOlklMFzf3\nTWrFxMZRvkfnNDfMLuuVXasShzjvLq7QZjsHhVpzTMpqoOYlm++3ip+MkvXEWV5e\nAhCCZnrW3nmJW3GEbufS6CWEBod8kGXtwjX+bLUhOvIdtShKrMYlBSyhLMkGPq7d\no2/kYtOLnzFX9V1dzxMSbgIoAJATp7en9myeDuo6fWU56mFEJF0VabgDPs/jIZwU\nUVnTzcw7UeqczCIFy/Qc00VMsTbNi8Ni/KFQl8Hl8UFn9c4RKiR27O54HKXsGcmZ\nANFRWnwBhJdErtXAJHOKSgkTQ7dVpt2zbPDcCpXan4Halj0nV+4yKMi0NLXoQ9Qx\nI99WZOzfPsD37blIg+Y8fI6W9KekN2UP8lT8SyMVxlO60xXHuQyEKuME56fJZEKg\nJZn7mtpRDW9cmUk6IJmclIq7qHMXqERcl7Yq9mBHc0LsOqi8hra8CZy5jDX8qQ5m\n+PopZ1qMTEN25Pda\n=ZMR8\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/68c1e1d385b3c2d64a33ccf439e20322269855ac",
          "sha": "68c1e1d385b3c2d64a33ccf439e20322269855ac",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/68c1e1d385b3c2d64a33ccf439e20322269855ac"
        }
      ],
      "message": "refactor: Get rid of unnecessary newlines in logs",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-17T14:34:33Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-12-27T14:13:24Z"
      },
      "sha": "fc6b8b556cd01f596025b4f32ae149616ca1e157"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDczMmNkYjExNWVkMmY3ZDMxYzQxNzk4NjEwZGFhMzFmZjhkYWEwZDE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/732cdb115ed2f7d31c41798610daa31ff8daa0d1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/732cdb115ed2f7d31c41798610daa31ff8daa0d1",
      "tree": {
        "sha": "8a7e47b7b0fd8d1624af86d797f511741de10ed5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8a7e47b7b0fd8d1624af86d797f511741de10ed5"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 8a7e47b7b0fd8d1624af86d797f511741de10ed5\nparent fc6b8b556cd01f596025b4f32ae149616ca1e157\nauthor Fabian Jahr <fjahr@protonmail.com> 1766795344 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1768660517 +0100\n\ntorcontrol: Remove libevent usage\n\nReplace libevent-based approach with using the Sock class and CThreadInterrupt.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmlrnigVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNRRoP/ioNx4+UYXH+36TYr+7VmpggmQ5o\nsybdCVrj4/rygeetszwbkWie/6CV8zFZO5CJ673B2y25MhNh5ayvXw+1Z3bGtNbc\n7SQivyrAVXFNvafXXkJSo1SzH9MNwW6M9pkHJtwRBx6/VHI92u57qWssnHULvQVu\nn/+xM41y0a7IvQlxeG4b+Z8TYSFtL9oM1yK351ltIsoJKI+q9z5QdwXjngS6+2ua\ni6pbgj2eQU0Yw4ZptkLBFKgBjq9bcCmOT/GgHNO258vSKNSfelMjiSCiAPtFRDFZ\n/ATl2E6W4kg3vYaSBw6d6T6dx+hxohqJHqXC2t0V9Epf3ukV0W8GMxNdflO2s8Ph\nhoI+IcOL3BJ4G7Qn2bPuMQ8fXzVq6kehh72H2bMYUtUB9yQ78j/bl3wFNKj6Cry9\nWHGDbBfGEbWedsmlH4dcPLBh+cumr5wo5I6DAH7MesvWEPbC+SPR6bK0XZ/4hZQD\nRsU6OBTV5iMUm2BZ+kzVG7bed+lZ6d/xSq78i6+8/bCqXprycCle07ZPfbSCBI0h\nkd0r1Q3yXisvU3c4hA2YAERQxr2fc1PpxLUUbig4rmKyICqQ7p73B5M3dI453Y1s\nfFyaoGHpeSspssoQk7uZ8DGpZMc+trzzT7L7nlZCVoGvmciJhwr2C923ungyJ/8T\nWO9+ffF0Cc/whCky\n=jyVP\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fc6b8b556cd01f596025b4f32ae149616ca1e157",
          "sha": "fc6b8b556cd01f596025b4f32ae149616ca1e157",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/fc6b8b556cd01f596025b4f32ae149616ca1e157"
        }
      ],
      "message": "torcontrol: Remove libevent usage\n\nReplace libevent-based approach with using the Sock class and CThreadInterrupt.",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-17T14:35:17Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-12-27T00:29:04Z"
      },
      "sha": "732cdb115ed2f7d31c41798610daa31ff8daa0d1"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDkyZWQxNzI0NDJlZDI3NmVhZjk3ZDM0NjBkYTdkYTk0MjNkOGFjODY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/92ed172442ed276eaf97d3460da7da9423d8ac86",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/92ed172442ed276eaf97d3460da7da9423d8ac86",
      "tree": {
        "sha": "bd35454b08a57eeb733abc11ce904ca41f70aba0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bd35454b08a57eeb733abc11ce904ca41f70aba0"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree bd35454b08a57eeb733abc11ce904ca41f70aba0\nparent 732cdb115ed2f7d31c41798610daa31ff8daa0d1\nauthor Fabian Jahr <fjahr@protonmail.com> 1766930871 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1768660520 +0100\n\nfuzz: Improve torcontrol fuzz test\n\nGets rid of the Dummy class and adds coverage of get_socks_cb.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmlrnigVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNM5MP/A5NxLyhs4FRQN0g09nw5PoMvmq2\n7dJnKIe3dpBmetycTcPfeQyZtnFhfLluCsZBSUm6v5L7t6iNUpzFvQgoFQTLFABN\nMajm0xkQ8Ev9Mi76ktlIIeVS8yo2ec7pd66TMjyaL1LE4i9R41ZQ3ntEPoEGYv4L\nmNRQzXUGY52l0tgLKIxehA1JRjrEj+8hRt1tJa5bkV9qu5LzyPVBvz/znveOxsIB\nWkRLilrJAFrqv5abTvAlnv3k/NHGHoM9oaGUQXEpIOJOAUOA6GUpcvuQbaDZ7SZI\nF5VbX6S3SThgIOeqIAQKq3dZ6gpu4t4PTp7YGppBx8AcSELvvqESm/H9UeeU9NQb\nbEegHaJOTxWblnkCICU6lQJlD/eftWHi4wOF+03LBm+lAfrc7ubjnPCeezN0yrfx\nTgHfGKV5xFtRUuKrcZwS5Ip/BUK9fcBEcs+qKJV51mKzcn+cM5frtC9jlwQTniko\nwsXD+dA8SAAHX0/cbAiifRxxdGJ7yGwFUMv4KtZT8BJB0f70ecKm+N8/oUENazsT\nb1c/tWmqa38nHj8LgQ3haWMnZgdsJZcrlafWDVJAgjAlqKSn/zMFnIK0mkuri0yx\nIqv8TVdKBREKba+Dh9+QoNQ3mViOOvEPnJPHaDRfLFPcTY0QOLMwzHFKlGyUkOxu\nOzkL6H3TVo+UoQyD\n=THWc\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/732cdb115ed2f7d31c41798610daa31ff8daa0d1",
          "sha": "732cdb115ed2f7d31c41798610daa31ff8daa0d1",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/732cdb115ed2f7d31c41798610daa31ff8daa0d1"
        }
      ],
      "message": "fuzz: Improve torcontrol fuzz test\n\nGets rid of the Dummy class and adds coverage of get_socks_cb.",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-17T14:35:20Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-12-28T14:07:51Z"
      },
      "sha": "92ed172442ed276eaf97d3460da7da9423d8ac86"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDk5OTFhYThiNDRkY2M3MDgwMDM0ZTljNGUyNTc1NTRlZTYzYzg2OGU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9991aa8b44dcc7080034e9c4e257554ee63c868e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9991aa8b44dcc7080034e9c4e257554ee63c868e",
      "tree": {
        "sha": "98d017882ffa9996b9c5d79b7f81f2f779bfa382",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/98d017882ffa9996b9c5d79b7f81f2f779bfa382"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 98d017882ffa9996b9c5d79b7f81f2f779bfa382\nparent 92ed172442ed276eaf97d3460da7da9423d8ac86\nauthor Fabian Jahr <fjahr@protonmail.com> 1766958986 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1768660520 +0100\n\ntest: Add simple functional test for torcontrol\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmlrnigVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNfL8P/34jPXl3M6F6iDv2KgdJEaqk5Aqp\ncDyoUndP7OUBi3lR0AoVSbwORkD3Df9L2+HgO4s93Q890C5+W0OtNxy7yQx7AZ1l\nDAsQOUWcwX/uiiaG3CGRiNMS06tJo4XI2Egn5fVL1YMYO5arllnVBUF/ObH59NeU\n/DnfWBccqrTOmOVUPKU3cD77ApN/aWbG5gv1IXamYvoTQrqyrrLVTeEGlm5L3EaZ\nQ91UepRMSNKh0b5m6oE/G8aAoNzQC/8a9GAWtiWO/q5rkr1oJ322sfk38gQw+afY\nuwI+XeUentDRLEXlbiYSjNiGQfYeLfyGKD50VhAJBX1LgXOfKFMZyjXBXxHRgFGe\nmL7WHSNZDE1GEm4huqyTFISE1YsWH12xoejpykBKsDBWMxAI5lxEqWMSI3z2zsyb\nA9tjZ26KGXW9Q6nvxXARseRy6hPKQM2BIJjqg4stEtH9T1eiZ2kh7BYsy/1HO4kH\noEc8nNwDzJecz2pEJ9s9IDr2QWrScaflETiB9otAzCEn6JLnI6KscxG3C0I7VNX3\nVkzn5iuKansVxPaF0BkBGQe5J+9T71W4uuAB6l60CdyNVE6PcBr5AChxYkaZxXcT\ndkTOAi/f286PI44ocCyrVYebkN38mgEZRlLFfIalumkSjKWoKISuBsDis2+lF160\n7Yiau5xvpZGAgG5O\n=KIrE\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/92ed172442ed276eaf97d3460da7da9423d8ac86",
          "sha": "92ed172442ed276eaf97d3460da7da9423d8ac86",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/92ed172442ed276eaf97d3460da7da9423d8ac86"
        }
      ],
      "message": "test: Add simple functional test for torcontrol",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-17T14:35:20Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-12-28T21:56:26Z"
      },
      "sha": "9991aa8b44dcc7080034e9c4e257554ee63c868e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDI4MDg5ODEzNGY5NjJjOWUyNGQ4MDI1ZDRkNTgzOTZiNzI5M2Y2Y2I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/280898134f962c9e24d8025d4d58396b7293f6cb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/280898134f962c9e24d8025d4d58396b7293f6cb",
      "tree": {
        "sha": "078b94efb85a35d0e12626848a9c795bfaa5663d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/078b94efb85a35d0e12626848a9c795bfaa5663d"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 078b94efb85a35d0e12626848a9c795bfaa5663d\nparent 9991aa8b44dcc7080034e9c4e257554ee63c868e\nauthor Fabian Jahr <fjahr@protonmail.com> 1768659739 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1768660520 +0100\n\ntest: Add test for partial message handling in torcontrol\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmlrnigVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jN+7wP/3CBP2lcHlkvTG2S5uAUNQxJC3sF\nyV+oKFmfVL+7uiIDdrJr7UlgzBsfbq4E0/pGOdt6DMpMrIPAvt5EArRFxCX5skUc\nWh7gw38KryEeOS5H5dnyG1n/pnvZvnjrU0Stqd6tVCZNqC6llgVTtw8qbJr3a+Z4\no/jxeQ6CklWtBwL+BaMos/zHyLcXdoxwnXu/74Beq7K1AAqz8OXIOvs9BEM3vKE6\nEGjhd8qrPg0vtsBOjmqliYUG1rNtHn6i65oR+6m7vEY9CmJZHvzuxySctTUOUPDN\nIAPsL9pBwGemm8j3lx5mcj4nOGg93JhAiuUkam4A92ETD++eBIO37qxzZk3huv3/\nBZTGMmyh0QIY4agjtgWaBiG8ijT+oL75M5//S124z7UnfjiJJJxoZD++T71InH4L\n9b11thfClBiUK8ntYt09pbQb2zQQWIwE0rMeoHmjsnaLBT0oPIGkQR707PC4ijAd\nUQMH6PHWjB/47zbIOLjG1KcJcljWIOy2P/gDGqZWph0qmlrikd7rPSoEdlFd5nC1\npzO8Ap0uLkG3uJxGbSK1ZFRke+4W7EF3HT1sxzRGz9CflWeRx7ZhuBvYzJlRn38i\nk26GMJJtAt/41P7FGRsWJrGQrbiz9xvu3KK34Hu6Kjs2KtDmbr7uFz2FOZ4tvSUw\nnmpy/Yj/lKBgWxWi\n=vtSJ\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9991aa8b44dcc7080034e9c4e257554ee63c868e",
          "sha": "9991aa8b44dcc7080034e9c4e257554ee63c868e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9991aa8b44dcc7080034e9c4e257554ee63c868e"
        }
      ],
      "message": "test: Add test for partial message handling in torcontrol",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-17T14:35:20Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-17T14:22:19Z"
      },
      "sha": "280898134f962c9e24d8025d4d58396b7293f6cb"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22114609479,
      "node_id": "HRFPE_lADOABII587gZmTvzwAAAAUmIilH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22114609479",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "280898134f962c9e24d8025d4d58396b7293f6cb",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/280898134f962c9e24d8025d4d58396b7293f6cb",
      "created_at": "2026-01-17T14:36:01Z"
    },
    {
      "event": "labeled",
      "id": 22114615631,
      "node_id": "LE_lADOABII587gZmTvzwAAAAUmIkFP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22114615631",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-17T14:36:42Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 3673130608,
      "node_id": "PRR_kwDOABII587a74Zw",
      "url": null,
      "actor": null,
      "commit_id": "d3ce6442238a38378c4ff242c68bccfe500aab1f",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-17T14:50:51Z",
      "author_association": "CONTRIBUTOR",
      "body": "Addressed feedback from @pinheadmz , thanks for the review!\r\n\r\nEDIT: And also, I had actually lost sight of bitcoin-cli, I will look at that next to see what, if any, could be reusable from here to apply there.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#pullrequestreview-3673130608",
      "submitted_at": "2026-01-17T14:40:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
    },
    {
      "event": "unsubscribed",
      "id": 22115010098,
      "node_id": "UE_lADOABII587gZmTvzwAAAAUmKEYy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22115010098",
      "actor": {
        "login": "waketraindev",
        "id": 175499942,
        "node_id": "U_kgDOCnXqpg",
        "avatar_url": "https://avatars.githubusercontent.com/u/175499942?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/waketraindev",
        "html_url": "https://github.com/waketraindev",
        "followers_url": "https://api.github.com/users/waketraindev/followers",
        "following_url": "https://api.github.com/users/waketraindev/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/waketraindev/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/waketraindev/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/waketraindev/subscriptions",
        "organizations_url": "https://api.github.com/users/waketraindev/orgs",
        "repos_url": "https://api.github.com/users/waketraindev/repos",
        "events_url": "https://api.github.com/users/waketraindev/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/waketraindev/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-17T15:14:22Z"
    },
    {
      "event": "unlabeled",
      "id": 22115358154,
      "node_id": "UNLE_lADOABII587gZmTvzwAAAAUmLZXK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22115358154",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-17T15:53:13Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 22193217113,
      "node_id": "LE_lADOABII587gZmTvzwAAAAUq0Z5Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22193217113",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-21T16:38:56Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3779513000,
      "node_id": "IC_kwDOABII587hRsqo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3779513000",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-21T16:38:58Z",
      "updated_at": "2026-01-21T16:38:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\nðŸ™ This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#issuecomment-3779513000",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/34158"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2649787904",
      "pull_request_review_id": 3614742906,
      "id": 2649787904,
      "node_id": "PRRC_kwDOABII586d8I4A",
      "diff_hunk": "@@ -166,41 +99,151 @@ bool TorControlConnection::Connect(const std::string& tor_control_center, const\n         return false;\n     }\n \n-    // Create a new socket, set up callbacks and enable notification bits\n-    b_conn = bufferevent_socket_new(base, -1, BEV_OPT_CLOSE_ON_FREE);\n-    if (!b_conn) {\n+    // Create a new socket\n+    SOCKET s = socket(control_service->GetSAFamily(), SOCK_STREAM, IPPROTO_TCP);\n+    if (s == INVALID_SOCKET) {\n+        LogWarning(\"tor: Failed to create socket: %s\", NetworkErrorString(WSAGetLastError()));\n+        return false;\n+    }\n+\n+    m_sock = std::make_unique<Sock>(s);\n+\n+    // Connect to Tor control port\n+    if (m_sock->Connect(reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) == SOCKET_ERROR) {\n+        LogWarning(\"tor: Error connecting to address %s: %s\", tor_control_center, NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n-    bufferevent_setcb(b_conn, TorControlConnection::readcb, nullptr, TorControlConnection::eventcb, this);\n-    bufferevent_enable(b_conn, EV_READ|EV_WRITE);\n-    this->connected = _connected;\n-    this->disconnected = _disconnected;\n-\n-    // Finally, connect to tor_control_center\n-    if (bufferevent_socket_connect(b_conn, reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) < 0) {\n-        LogWarning(\"tor: Error connecting to address %s\", tor_control_center);\n+\n+    // Set non-blocking mode on socket\n+    if (!m_sock->SetNonBlocking()) {\n+        LogWarning(\"tor: Failed to set non-blocking mode: %s\", NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n+\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n+\n+    LogDebug(BCLog::TOR, \"Successfully connected to Tor control port\");\n     return true;\n }\n \n void TorControlConnection::Disconnect()\n {\n-    if (b_conn)\n-        bufferevent_free(b_conn);\n-    b_conn = nullptr;\n+    if (m_sock) {\n+        m_sock.reset();\n+    }",
      "path": "src/torcontrol.cpp",
      "position": 1,
      "original_position": 188,
      "commit_id": "872feec3eb26727385af2f17dd9d32bd03bf9225",
      "original_commit_id": "872feec3eb26727385af2f17dd9d32bd03bf9225",
      "in_reply_to_id": null,
      "user": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "```suggestion\r\n        m_sock.reset();\r\n```\r\n\r\nNIT: I think you can remove the redundant check.  calling `reset()` on  a `std::unique_ptr` is safe even if the pointer is already null ",
      "created_at": "2025-12-28T16:08:49Z",
      "updated_at": "2025-12-28T16:19:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#discussion_r2649787904",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2649787904"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
        }
      },
      "start_line": null,
      "original_start_line": 135,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2649952768",
      "pull_request_review_id": 3614849785,
      "id": 2649952768,
      "node_id": "PRRC_kwDOABII586d8xIA",
      "diff_hunk": "@@ -166,41 +99,151 @@ bool TorControlConnection::Connect(const std::string& tor_control_center, const\n         return false;\n     }\n \n-    // Create a new socket, set up callbacks and enable notification bits\n-    b_conn = bufferevent_socket_new(base, -1, BEV_OPT_CLOSE_ON_FREE);\n-    if (!b_conn) {\n+    // Create a new socket\n+    SOCKET s = socket(control_service->GetSAFamily(), SOCK_STREAM, IPPROTO_TCP);\n+    if (s == INVALID_SOCKET) {\n+        LogWarning(\"tor: Failed to create socket: %s\", NetworkErrorString(WSAGetLastError()));\n+        return false;\n+    }\n+\n+    m_sock = std::make_unique<Sock>(s);\n+\n+    // Connect to Tor control port\n+    if (m_sock->Connect(reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) == SOCKET_ERROR) {\n+        LogWarning(\"tor: Error connecting to address %s: %s\", tor_control_center, NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n-    bufferevent_setcb(b_conn, TorControlConnection::readcb, nullptr, TorControlConnection::eventcb, this);\n-    bufferevent_enable(b_conn, EV_READ|EV_WRITE);\n-    this->connected = _connected;\n-    this->disconnected = _disconnected;\n-\n-    // Finally, connect to tor_control_center\n-    if (bufferevent_socket_connect(b_conn, reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) < 0) {\n-        LogWarning(\"tor: Error connecting to address %s\", tor_control_center);\n+\n+    // Set non-blocking mode on socket\n+    if (!m_sock->SetNonBlocking()) {\n+        LogWarning(\"tor: Failed to set non-blocking mode: %s\", NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n+\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n+\n+    LogDebug(BCLog::TOR, \"Successfully connected to Tor control port\");\n     return true;\n }\n \n void TorControlConnection::Disconnect()\n {\n-    if (b_conn)\n-        bufferevent_free(b_conn);\n-    b_conn = nullptr;\n+    if (m_sock) {\n+        m_sock.reset();\n+    }",
      "path": "src/torcontrol.cpp",
      "position": 1,
      "original_position": 188,
      "commit_id": "872feec3eb26727385af2f17dd9d32bd03bf9225",
      "original_commit_id": "872feec3eb26727385af2f17dd9d32bd03bf9225",
      "in_reply_to_id": 2649787904,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "done",
      "created_at": "2025-12-28T21:57:47Z",
      "updated_at": "2025-12-28T21:57:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#discussion_r2649952768",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2649952768"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
        }
      },
      "start_line": null,
      "original_start_line": 135,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2691120938",
      "pull_request_review_id": 3661580911,
      "id": 2691120938,
      "node_id": "PRRC_kwDOABII586gZz8q",
      "diff_hunk": "@@ -501,12 +501,12 @@ void TorController::auth_cb(TorControlConnection& _conn, const TorControlReply&\n  *                  CookieString | ClientNonce | ServerNonce)\n  *\n  */\n-static std::vector<uint8_t> ComputeResponse(const std::string &key, const std::vector<uint8_t> &cookie,  const std::vector<uint8_t> &clientNonce, const std::vector<uint8_t> &serverNonce)\n+static std::vector<uint8_t> ComputeResponse(const std::string &key, const std::vector<uint8_t> &cookie,  const std::vector<uint8_t> &client_nonce, const std::vector<uint8_t> &serverNonce)",
      "path": "src/torcontrol.cpp",
      "position": 1,
      "original_position": 123,
      "commit_id": "3de90a1159e606585aad32c876b6769d29f46ac1",
      "original_commit_id": "3a1f8c094798d09f41cd79c71c34afe2ea967394",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "3a1f8c094798d09f41cd79c71c34afe2ea967394\r\n\r\nwhy change `client_nonce` but not `serverNonce`? I'm guessing because there is a `m_client_nonce` at the call site,  but the member property isn't being explicitly handled here.",
      "created_at": "2026-01-14T16:16:26Z",
      "updated_at": "2026-01-15T20:24:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#discussion_r2691120938",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2691120938"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 504,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2695723941",
      "pull_request_review_id": 3661580911,
      "id": 2695723941,
      "node_id": "PRRC_kwDOABII586grXul",
      "diff_hunk": "@@ -166,41 +99,149 @@ bool TorControlConnection::Connect(const std::string& tor_control_center, const\n         return false;\n     }\n \n-    // Create a new socket, set up callbacks and enable notification bits\n-    b_conn = bufferevent_socket_new(base, -1, BEV_OPT_CLOSE_ON_FREE);\n-    if (!b_conn) {\n+    // Create a new socket\n+    SOCKET s = socket(control_service->GetSAFamily(), SOCK_STREAM, IPPROTO_TCP);\n+    if (s == INVALID_SOCKET) {\n+        LogWarning(\"tor: Failed to create socket: %s\", NetworkErrorString(WSAGetLastError()));\n+        return false;\n+    }\n+\n+    m_sock = std::make_unique<Sock>(s);\n+\n+    // Connect to Tor control port\n+    if (m_sock->Connect(reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) == SOCKET_ERROR) {\n+        LogWarning(\"tor: Error connecting to address %s: %s\", tor_control_center, NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n-    bufferevent_setcb(b_conn, TorControlConnection::readcb, nullptr, TorControlConnection::eventcb, this);\n-    bufferevent_enable(b_conn, EV_READ|EV_WRITE);\n-    this->connected = _connected;\n-    this->disconnected = _disconnected;\n-\n-    // Finally, connect to tor_control_center\n-    if (bufferevent_socket_connect(b_conn, reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) < 0) {\n-        LogWarning(\"tor: Error connecting to address %s\", tor_control_center);\n+\n+    // Set non-blocking mode on socket\n+    if (!m_sock->SetNonBlocking()) {\n+        LogWarning(\"tor: Failed to set non-blocking mode: %s\", NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n+\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n+\n+    LogDebug(BCLog::TOR, \"Successfully connected to Tor control port\");\n     return true;\n }\n \n void TorControlConnection::Disconnect()\n {\n-    if (b_conn)\n-        bufferevent_free(b_conn);\n-    b_conn = nullptr;\n+    m_sock.reset();\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n }\n \n-bool TorControlConnection::Command(const std::string &cmd, const ReplyHandlerCB& reply_handler)\n+bool TorControlConnection::IsConnected() const\n {\n-    if (!b_conn)\n+    if (!m_sock) return false;\n+    std::string errmsg;\n+    return m_sock->IsConnected(errmsg);\n+}\n+\n+bool TorControlConnection::WaitForData(std::chrono::milliseconds timeout) const\n+{\n+    if (!m_sock) return false;\n+\n+    Sock::Event event{0};\n+    if (!m_sock->Wait(timeout, Sock::RECV, &event)) {\n         return false;\n-    struct evbuffer *buf = bufferevent_get_output(b_conn);\n-    if (!buf)\n+    }\n+    if (event & Sock::ERR) {\n         return false;\n-    evbuffer_add(buf, cmd.data(), cmd.size());\n-    evbuffer_add(buf, \"\\r\\n\", 2);\n-    reply_handlers.push_back(reply_handler);\n+    }\n+\n+    return true;\n+}\n+\n+bool TorControlConnection::ReceiveAndProcess()\n+{\n+    if (!m_sock) return false;\n+\n+    std::byte buf[4096];\n+    ssize_t nread = m_sock->Recv(buf, sizeof(buf), MSG_DONTWAIT);\n+\n+    if (nread < 0) {\n+        int err = WSAGetLastError();\n+        if (err == WSAEWOULDBLOCK || err == WSAEINTR || err == WSAEINPROGRESS) {\n+            // No data available currently\n+            return true;\n+        }\n+        LogWarning(\"tor: Error reading from socket: %s\", NetworkErrorString(err));\n+        return false;\n+    }\n+\n+    if (nread == 0) {\n+        LogDebug(BCLog::TOR, \"End of stream\");\n+        return false;\n+    }\n+\n+    m_recv_buffer.insert(m_recv_buffer.end(), buf, buf + nread);\n+    return ProcessBuffer();\n+}\n+\n+bool TorControlConnection::ProcessBuffer()\n+{\n+    if (m_recv_buffer.size() > MAX_LINE_LENGTH) {\n+        LogWarning(\"tor: Disconnecting because MAX_LINE_LENGTH exceeded\");\n+        return false;\n+    }",
      "path": "src/torcontrol.cpp",
      "position": 1,
      "original_position": 223,
      "commit_id": "3de90a1159e606585aad32c876b6769d29f46ac1",
      "original_commit_id": "c675b6f059dea662d9faa90df261de7bfbca13a1",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "c675b6f059dea662d9faa90df261de7bfbca13a1\r\n\r\nWe won't ever get multiple lines in the receive buffer?",
      "created_at": "2026-01-15T19:45:20Z",
      "updated_at": "2026-01-15T20:24:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#discussion_r2695723941",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2695723941"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
        }
      },
      "start_line": null,
      "original_start_line": 191,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 194,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2695742143",
      "pull_request_review_id": 3661580911,
      "id": 2695742143,
      "node_id": "PRRC_kwDOABII586grcK_",
      "diff_hunk": "@@ -166,41 +99,149 @@ bool TorControlConnection::Connect(const std::string& tor_control_center, const\n         return false;\n     }\n \n-    // Create a new socket, set up callbacks and enable notification bits\n-    b_conn = bufferevent_socket_new(base, -1, BEV_OPT_CLOSE_ON_FREE);\n-    if (!b_conn) {\n+    // Create a new socket\n+    SOCKET s = socket(control_service->GetSAFamily(), SOCK_STREAM, IPPROTO_TCP);\n+    if (s == INVALID_SOCKET) {\n+        LogWarning(\"tor: Failed to create socket: %s\", NetworkErrorString(WSAGetLastError()));\n+        return false;\n+    }\n+\n+    m_sock = std::make_unique<Sock>(s);\n+\n+    // Connect to Tor control port\n+    if (m_sock->Connect(reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) == SOCKET_ERROR) {\n+        LogWarning(\"tor: Error connecting to address %s: %s\", tor_control_center, NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n-    bufferevent_setcb(b_conn, TorControlConnection::readcb, nullptr, TorControlConnection::eventcb, this);\n-    bufferevent_enable(b_conn, EV_READ|EV_WRITE);\n-    this->connected = _connected;\n-    this->disconnected = _disconnected;\n-\n-    // Finally, connect to tor_control_center\n-    if (bufferevent_socket_connect(b_conn, reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) < 0) {\n-        LogWarning(\"tor: Error connecting to address %s\", tor_control_center);\n+\n+    // Set non-blocking mode on socket\n+    if (!m_sock->SetNonBlocking()) {\n+        LogWarning(\"tor: Failed to set non-blocking mode: %s\", NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n+\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n+\n+    LogDebug(BCLog::TOR, \"Successfully connected to Tor control port\");\n     return true;\n }\n \n void TorControlConnection::Disconnect()\n {\n-    if (b_conn)\n-        bufferevent_free(b_conn);\n-    b_conn = nullptr;\n+    m_sock.reset();\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n }\n \n-bool TorControlConnection::Command(const std::string &cmd, const ReplyHandlerCB& reply_handler)\n+bool TorControlConnection::IsConnected() const\n {\n-    if (!b_conn)\n+    if (!m_sock) return false;\n+    std::string errmsg;\n+    return m_sock->IsConnected(errmsg);\n+}\n+\n+bool TorControlConnection::WaitForData(std::chrono::milliseconds timeout) const\n+{\n+    if (!m_sock) return false;\n+\n+    Sock::Event event{0};\n+    if (!m_sock->Wait(timeout, Sock::RECV, &event)) {\n         return false;\n-    struct evbuffer *buf = bufferevent_get_output(b_conn);\n-    if (!buf)\n+    }\n+    if (event & Sock::ERR) {\n         return false;\n-    evbuffer_add(buf, cmd.data(), cmd.size());\n-    evbuffer_add(buf, \"\\r\\n\", 2);\n-    reply_handlers.push_back(reply_handler);\n+    }\n+\n+    return true;\n+}\n+\n+bool TorControlConnection::ReceiveAndProcess()\n+{\n+    if (!m_sock) return false;\n+\n+    std::byte buf[4096];\n+    ssize_t nread = m_sock->Recv(buf, sizeof(buf), MSG_DONTWAIT);\n+\n+    if (nread < 0) {\n+        int err = WSAGetLastError();\n+        if (err == WSAEWOULDBLOCK || err == WSAEINTR || err == WSAEINPROGRESS) {\n+            // No data available currently\n+            return true;\n+        }\n+        LogWarning(\"tor: Error reading from socket: %s\", NetworkErrorString(err));\n+        return false;\n+    }\n+\n+    if (nread == 0) {\n+        LogDebug(BCLog::TOR, \"End of stream\");\n+        return false;\n+    }\n+\n+    m_recv_buffer.insert(m_recv_buffer.end(), buf, buf + nread);\n+    return ProcessBuffer();\n+}\n+\n+bool TorControlConnection::ProcessBuffer()\n+{\n+    if (m_recv_buffer.size() > MAX_LINE_LENGTH) {\n+        LogWarning(\"tor: Disconnecting because MAX_LINE_LENGTH exceeded\");\n+        return false;\n+    }\n+\n+    // TODO: Maybe could give this as an option to LineReader instead\n+    auto last_newline = std::find(m_recv_buffer.rbegin(), m_recv_buffer.rend(), std::byte{'\\n'});\n+    if (last_newline == m_recv_buffer.rend()) return true;\n+    size_t complete = last_newline.base() - m_recv_buffer.begin();\n+    util::LineReader reader({m_recv_buffer.data(), complete}, MAX_LINE_LENGTH);",
      "path": "src/torcontrol.cpp",
      "position": 251,
      "original_position": 229,
      "commit_id": "280898134f962c9e24d8025d4d58396b7293f6cb",
      "original_commit_id": "c675b6f059dea662d9faa90df261de7bfbca13a1",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "c675b6f059dea662d9faa90df261de7bfbca13a1\r\n\r\nI'm still learning how torcontrol protocol works all together, but without complete context it seems to me that all this could be simplified:\r\n\r\n```cpp\r\nutil::LineReader reader(m_recv_buffer, MAX_LINE_LENGTH);\r\n```\r\n\r\nYou shouldn't have to find `'\\n'`, that's LineReader's job ...?\r\n\r\ntorcontrol unit and functional tests still pass like this.",
      "created_at": "2026-01-15T19:51:43Z",
      "updated_at": "2026-01-15T20:24:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#discussion_r2695742143",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2695742143"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
        }
      },
      "start_line": 191,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": 195,
      "original_line": 195,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2700305547",
      "pull_request_review_id": 3673130608,
      "id": 2700305547,
      "node_id": "PRRC_kwDOABII586g82SL",
      "diff_hunk": "@@ -166,41 +99,149 @@ bool TorControlConnection::Connect(const std::string& tor_control_center, const\n         return false;\n     }\n \n-    // Create a new socket, set up callbacks and enable notification bits\n-    b_conn = bufferevent_socket_new(base, -1, BEV_OPT_CLOSE_ON_FREE);\n-    if (!b_conn) {\n+    // Create a new socket\n+    SOCKET s = socket(control_service->GetSAFamily(), SOCK_STREAM, IPPROTO_TCP);\n+    if (s == INVALID_SOCKET) {\n+        LogWarning(\"tor: Failed to create socket: %s\", NetworkErrorString(WSAGetLastError()));\n+        return false;\n+    }\n+\n+    m_sock = std::make_unique<Sock>(s);\n+\n+    // Connect to Tor control port\n+    if (m_sock->Connect(reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) == SOCKET_ERROR) {\n+        LogWarning(\"tor: Error connecting to address %s: %s\", tor_control_center, NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n-    bufferevent_setcb(b_conn, TorControlConnection::readcb, nullptr, TorControlConnection::eventcb, this);\n-    bufferevent_enable(b_conn, EV_READ|EV_WRITE);\n-    this->connected = _connected;\n-    this->disconnected = _disconnected;\n-\n-    // Finally, connect to tor_control_center\n-    if (bufferevent_socket_connect(b_conn, reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) < 0) {\n-        LogWarning(\"tor: Error connecting to address %s\", tor_control_center);\n+\n+    // Set non-blocking mode on socket\n+    if (!m_sock->SetNonBlocking()) {\n+        LogWarning(\"tor: Failed to set non-blocking mode: %s\", NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n+\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n+\n+    LogDebug(BCLog::TOR, \"Successfully connected to Tor control port\");\n     return true;\n }\n \n void TorControlConnection::Disconnect()\n {\n-    if (b_conn)\n-        bufferevent_free(b_conn);\n-    b_conn = nullptr;\n+    m_sock.reset();\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n }\n \n-bool TorControlConnection::Command(const std::string &cmd, const ReplyHandlerCB& reply_handler)\n+bool TorControlConnection::IsConnected() const\n {\n-    if (!b_conn)\n+    if (!m_sock) return false;\n+    std::string errmsg;\n+    return m_sock->IsConnected(errmsg);\n+}\n+\n+bool TorControlConnection::WaitForData(std::chrono::milliseconds timeout) const\n+{\n+    if (!m_sock) return false;\n+\n+    Sock::Event event{0};\n+    if (!m_sock->Wait(timeout, Sock::RECV, &event)) {\n         return false;\n-    struct evbuffer *buf = bufferevent_get_output(b_conn);\n-    if (!buf)\n+    }\n+    if (event & Sock::ERR) {\n         return false;\n-    evbuffer_add(buf, cmd.data(), cmd.size());\n-    evbuffer_add(buf, \"\\r\\n\", 2);\n-    reply_handlers.push_back(reply_handler);\n+    }\n+\n+    return true;\n+}\n+\n+bool TorControlConnection::ReceiveAndProcess()\n+{\n+    if (!m_sock) return false;\n+\n+    std::byte buf[4096];\n+    ssize_t nread = m_sock->Recv(buf, sizeof(buf), MSG_DONTWAIT);\n+\n+    if (nread < 0) {\n+        int err = WSAGetLastError();\n+        if (err == WSAEWOULDBLOCK || err == WSAEINTR || err == WSAEINPROGRESS) {\n+            // No data available currently\n+            return true;\n+        }\n+        LogWarning(\"tor: Error reading from socket: %s\", NetworkErrorString(err));\n+        return false;\n+    }\n+\n+    if (nread == 0) {\n+        LogDebug(BCLog::TOR, \"End of stream\");\n+        return false;\n+    }\n+\n+    m_recv_buffer.insert(m_recv_buffer.end(), buf, buf + nread);\n+    return ProcessBuffer();\n+}\n+\n+bool TorControlConnection::ProcessBuffer()\n+{\n+    if (m_recv_buffer.size() > MAX_LINE_LENGTH) {\n+        LogWarning(\"tor: Disconnecting because MAX_LINE_LENGTH exceeded\");\n+        return false;\n+    }\n+\n+    // TODO: Maybe could give this as an option to LineReader instead\n+    auto last_newline = std::find(m_recv_buffer.rbegin(), m_recv_buffer.rend(), std::byte{'\\n'});\n+    if (last_newline == m_recv_buffer.rend()) return true;\n+    size_t complete = last_newline.base() - m_recv_buffer.begin();\n+    util::LineReader reader({m_recv_buffer.data(), complete}, MAX_LINE_LENGTH);",
      "path": "src/torcontrol.cpp",
      "position": 251,
      "original_position": 229,
      "commit_id": "280898134f962c9e24d8025d4d58396b7293f6cb",
      "original_commit_id": "c675b6f059dea662d9faa90df261de7bfbca13a1",
      "in_reply_to_id": 2695742143,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The idea here is that we may receive an incomplete line in the stream just because of packets arriving that way and if we would ask the `LineReader` for it we would receive it but couldn't do anything with it. That's why I am looking for the last `\\n` and then only process the buffer up until that point. But this is something that could be done by `LineReader`, too. So maybe there could be a bool param and then `LineReader` would only return the lines that end with `\\n` but I didn't really spend time making up my mind if that is so much better. It looks cleaner here but this functionality would only have one user, so I don't know... Either way I will wait until LineReader is merged and then I might try to add the functionality there if you think it's better that way.\r\n\r\nThere should be a test for this though, currently the tests all send the data nice and complete.",
      "created_at": "2026-01-16T23:17:24Z",
      "updated_at": "2026-01-17T14:40:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#discussion_r2700305547",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2700305547"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
        }
      },
      "start_line": 191,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": 195,
      "original_line": 195,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2701191739",
      "pull_request_review_id": 3673130608,
      "id": 2701191739,
      "node_id": "PRRC_kwDOABII586hAOo7",
      "diff_hunk": "@@ -166,41 +99,149 @@ bool TorControlConnection::Connect(const std::string& tor_control_center, const\n         return false;\n     }\n \n-    // Create a new socket, set up callbacks and enable notification bits\n-    b_conn = bufferevent_socket_new(base, -1, BEV_OPT_CLOSE_ON_FREE);\n-    if (!b_conn) {\n+    // Create a new socket\n+    SOCKET s = socket(control_service->GetSAFamily(), SOCK_STREAM, IPPROTO_TCP);\n+    if (s == INVALID_SOCKET) {\n+        LogWarning(\"tor: Failed to create socket: %s\", NetworkErrorString(WSAGetLastError()));\n+        return false;\n+    }\n+\n+    m_sock = std::make_unique<Sock>(s);\n+\n+    // Connect to Tor control port\n+    if (m_sock->Connect(reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) == SOCKET_ERROR) {\n+        LogWarning(\"tor: Error connecting to address %s: %s\", tor_control_center, NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n-    bufferevent_setcb(b_conn, TorControlConnection::readcb, nullptr, TorControlConnection::eventcb, this);\n-    bufferevent_enable(b_conn, EV_READ|EV_WRITE);\n-    this->connected = _connected;\n-    this->disconnected = _disconnected;\n-\n-    // Finally, connect to tor_control_center\n-    if (bufferevent_socket_connect(b_conn, reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) < 0) {\n-        LogWarning(\"tor: Error connecting to address %s\", tor_control_center);\n+\n+    // Set non-blocking mode on socket\n+    if (!m_sock->SetNonBlocking()) {\n+        LogWarning(\"tor: Failed to set non-blocking mode: %s\", NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n+\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n+\n+    LogDebug(BCLog::TOR, \"Successfully connected to Tor control port\");\n     return true;\n }\n \n void TorControlConnection::Disconnect()\n {\n-    if (b_conn)\n-        bufferevent_free(b_conn);\n-    b_conn = nullptr;\n+    m_sock.reset();\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n }\n \n-bool TorControlConnection::Command(const std::string &cmd, const ReplyHandlerCB& reply_handler)\n+bool TorControlConnection::IsConnected() const\n {\n-    if (!b_conn)\n+    if (!m_sock) return false;\n+    std::string errmsg;\n+    return m_sock->IsConnected(errmsg);\n+}\n+\n+bool TorControlConnection::WaitForData(std::chrono::milliseconds timeout) const\n+{\n+    if (!m_sock) return false;\n+\n+    Sock::Event event{0};\n+    if (!m_sock->Wait(timeout, Sock::RECV, &event)) {\n         return false;\n-    struct evbuffer *buf = bufferevent_get_output(b_conn);\n-    if (!buf)\n+    }\n+    if (event & Sock::ERR) {\n         return false;\n-    evbuffer_add(buf, cmd.data(), cmd.size());\n-    evbuffer_add(buf, \"\\r\\n\", 2);\n-    reply_handlers.push_back(reply_handler);\n+    }\n+\n+    return true;\n+}\n+\n+bool TorControlConnection::ReceiveAndProcess()\n+{\n+    if (!m_sock) return false;\n+\n+    std::byte buf[4096];\n+    ssize_t nread = m_sock->Recv(buf, sizeof(buf), MSG_DONTWAIT);\n+\n+    if (nread < 0) {\n+        int err = WSAGetLastError();\n+        if (err == WSAEWOULDBLOCK || err == WSAEINTR || err == WSAEINPROGRESS) {\n+            // No data available currently\n+            return true;\n+        }\n+        LogWarning(\"tor: Error reading from socket: %s\", NetworkErrorString(err));\n+        return false;\n+    }\n+\n+    if (nread == 0) {\n+        LogDebug(BCLog::TOR, \"End of stream\");\n+        return false;\n+    }\n+\n+    m_recv_buffer.insert(m_recv_buffer.end(), buf, buf + nread);\n+    return ProcessBuffer();\n+}\n+\n+bool TorControlConnection::ProcessBuffer()\n+{\n+    if (m_recv_buffer.size() > MAX_LINE_LENGTH) {\n+        LogWarning(\"tor: Disconnecting because MAX_LINE_LENGTH exceeded\");\n+        return false;\n+    }",
      "path": "src/torcontrol.cpp",
      "position": 1,
      "original_position": 223,
      "commit_id": "3de90a1159e606585aad32c876b6769d29f46ac1",
      "original_commit_id": "c675b6f059dea662d9faa90df261de7bfbca13a1",
      "in_reply_to_id": 2695723941,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Right, that's a good catch. If the processing is too slow this could fail unnecessarily and LineReader should catch this already fine, so I am removing this.",
      "created_at": "2026-01-17T14:37:03Z",
      "updated_at": "2026-01-17T14:40:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#discussion_r2701191739",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2701191739"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
        }
      },
      "start_line": null,
      "original_start_line": 191,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 194,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2701193079",
      "pull_request_review_id": 3673130608,
      "id": 2701193079,
      "node_id": "PRRC_kwDOABII586hAO93",
      "diff_hunk": "@@ -501,12 +501,12 @@ void TorController::auth_cb(TorControlConnection& _conn, const TorControlReply&\n  *                  CookieString | ClientNonce | ServerNonce)\n  *\n  */\n-static std::vector<uint8_t> ComputeResponse(const std::string &key, const std::vector<uint8_t> &cookie,  const std::vector<uint8_t> &clientNonce, const std::vector<uint8_t> &serverNonce)\n+static std::vector<uint8_t> ComputeResponse(const std::string &key, const std::vector<uint8_t> &cookie,  const std::vector<uint8_t> &client_nonce, const std::vector<uint8_t> &serverNonce)",
      "path": "src/torcontrol.cpp",
      "position": 1,
      "original_position": 123,
      "commit_id": "3de90a1159e606585aad32c876b6769d29f46ac1",
      "original_commit_id": "3a1f8c094798d09f41cd79c71c34afe2ea967394",
      "in_reply_to_id": 2691120938,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yeah, I was initially focussing on the member variables in order to not let this get out of hand but the param here was touched too by accident. Doesn't seem too bad to change the `serverNonce` too as well as the other local variables in this function, so taking care of all of them now.",
      "created_at": "2026-01-17T14:39:32Z",
      "updated_at": "2026-01-17T14:40:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#discussion_r2701193079",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2701193079"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 504,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2702478518",
      "pull_request_review_id": 3675528880,
      "id": 2702478518,
      "node_id": "PRRC_kwDOABII586hFIy2",
      "diff_hunk": "@@ -166,41 +99,149 @@ bool TorControlConnection::Connect(const std::string& tor_control_center, const\n         return false;\n     }\n \n-    // Create a new socket, set up callbacks and enable notification bits\n-    b_conn = bufferevent_socket_new(base, -1, BEV_OPT_CLOSE_ON_FREE);\n-    if (!b_conn) {\n+    // Create a new socket\n+    SOCKET s = socket(control_service->GetSAFamily(), SOCK_STREAM, IPPROTO_TCP);\n+    if (s == INVALID_SOCKET) {\n+        LogWarning(\"tor: Failed to create socket: %s\", NetworkErrorString(WSAGetLastError()));\n+        return false;\n+    }\n+\n+    m_sock = std::make_unique<Sock>(s);\n+\n+    // Connect to Tor control port\n+    if (m_sock->Connect(reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) == SOCKET_ERROR) {\n+        LogWarning(\"tor: Error connecting to address %s: %s\", tor_control_center, NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n-    bufferevent_setcb(b_conn, TorControlConnection::readcb, nullptr, TorControlConnection::eventcb, this);\n-    bufferevent_enable(b_conn, EV_READ|EV_WRITE);\n-    this->connected = _connected;\n-    this->disconnected = _disconnected;\n-\n-    // Finally, connect to tor_control_center\n-    if (bufferevent_socket_connect(b_conn, reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) < 0) {\n-        LogWarning(\"tor: Error connecting to address %s\", tor_control_center);\n+\n+    // Set non-blocking mode on socket\n+    if (!m_sock->SetNonBlocking()) {\n+        LogWarning(\"tor: Failed to set non-blocking mode: %s\", NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n+\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n+\n+    LogDebug(BCLog::TOR, \"Successfully connected to Tor control port\");\n     return true;\n }\n \n void TorControlConnection::Disconnect()\n {\n-    if (b_conn)\n-        bufferevent_free(b_conn);\n-    b_conn = nullptr;\n+    m_sock.reset();\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n }\n \n-bool TorControlConnection::Command(const std::string &cmd, const ReplyHandlerCB& reply_handler)\n+bool TorControlConnection::IsConnected() const\n {\n-    if (!b_conn)\n+    if (!m_sock) return false;\n+    std::string errmsg;\n+    return m_sock->IsConnected(errmsg);\n+}\n+\n+bool TorControlConnection::WaitForData(std::chrono::milliseconds timeout) const\n+{\n+    if (!m_sock) return false;\n+\n+    Sock::Event event{0};\n+    if (!m_sock->Wait(timeout, Sock::RECV, &event)) {\n         return false;\n-    struct evbuffer *buf = bufferevent_get_output(b_conn);\n-    if (!buf)\n+    }\n+    if (event & Sock::ERR) {\n         return false;\n-    evbuffer_add(buf, cmd.data(), cmd.size());\n-    evbuffer_add(buf, \"\\r\\n\", 2);\n-    reply_handlers.push_back(reply_handler);\n+    }\n+\n+    return true;\n+}\n+\n+bool TorControlConnection::ReceiveAndProcess()\n+{\n+    if (!m_sock) return false;\n+\n+    std::byte buf[4096];\n+    ssize_t nread = m_sock->Recv(buf, sizeof(buf), MSG_DONTWAIT);\n+\n+    if (nread < 0) {\n+        int err = WSAGetLastError();\n+        if (err == WSAEWOULDBLOCK || err == WSAEINTR || err == WSAEINPROGRESS) {\n+            // No data available currently\n+            return true;\n+        }\n+        LogWarning(\"tor: Error reading from socket: %s\", NetworkErrorString(err));\n+        return false;\n+    }\n+\n+    if (nread == 0) {\n+        LogDebug(BCLog::TOR, \"End of stream\");\n+        return false;\n+    }\n+\n+    m_recv_buffer.insert(m_recv_buffer.end(), buf, buf + nread);\n+    return ProcessBuffer();\n+}\n+\n+bool TorControlConnection::ProcessBuffer()\n+{\n+    if (m_recv_buffer.size() > MAX_LINE_LENGTH) {\n+        LogWarning(\"tor: Disconnecting because MAX_LINE_LENGTH exceeded\");\n+        return false;\n+    }\n+\n+    // TODO: Maybe could give this as an option to LineReader instead\n+    auto last_newline = std::find(m_recv_buffer.rbegin(), m_recv_buffer.rend(), std::byte{'\\n'});\n+    if (last_newline == m_recv_buffer.rend()) return true;\n+    size_t complete = last_newline.base() - m_recv_buffer.begin();\n+    util::LineReader reader({m_recv_buffer.data(), complete}, MAX_LINE_LENGTH);",
      "path": "src/torcontrol.cpp",
      "position": 251,
      "original_position": 229,
      "commit_id": "280898134f962c9e24d8025d4d58396b7293f6cb",
      "original_commit_id": "c675b6f059dea662d9faa90df261de7bfbca13a1",
      "in_reply_to_id": 2695742143,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Oh right, of course, incomplete lines. I think this applies to HTTP as well, and should probably be a change in #34242 like, if LineReader reaches the end of the buffer before finding a `\\n` it should return null. Right now it treats end of buffer the same as end of line, but I think thats not actually what we want.",
      "created_at": "2026-01-18T14:50:14Z",
      "updated_at": "2026-01-18T14:50:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#discussion_r2702478518",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2702478518"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
        }
      },
      "start_line": 191,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": 195,
      "original_line": 195,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2704763440",
      "pull_request_review_id": 3678084220,
      "id": 2704763440,
      "node_id": "PRRC_kwDOABII586hN2ow",
      "diff_hunk": "@@ -166,41 +99,149 @@ bool TorControlConnection::Connect(const std::string& tor_control_center, const\n         return false;\n     }\n \n-    // Create a new socket, set up callbacks and enable notification bits\n-    b_conn = bufferevent_socket_new(base, -1, BEV_OPT_CLOSE_ON_FREE);\n-    if (!b_conn) {\n+    // Create a new socket\n+    SOCKET s = socket(control_service->GetSAFamily(), SOCK_STREAM, IPPROTO_TCP);\n+    if (s == INVALID_SOCKET) {\n+        LogWarning(\"tor: Failed to create socket: %s\", NetworkErrorString(WSAGetLastError()));\n+        return false;\n+    }\n+\n+    m_sock = std::make_unique<Sock>(s);\n+\n+    // Connect to Tor control port\n+    if (m_sock->Connect(reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) == SOCKET_ERROR) {\n+        LogWarning(\"tor: Error connecting to address %s: %s\", tor_control_center, NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n-    bufferevent_setcb(b_conn, TorControlConnection::readcb, nullptr, TorControlConnection::eventcb, this);\n-    bufferevent_enable(b_conn, EV_READ|EV_WRITE);\n-    this->connected = _connected;\n-    this->disconnected = _disconnected;\n-\n-    // Finally, connect to tor_control_center\n-    if (bufferevent_socket_connect(b_conn, reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) < 0) {\n-        LogWarning(\"tor: Error connecting to address %s\", tor_control_center);\n+\n+    // Set non-blocking mode on socket\n+    if (!m_sock->SetNonBlocking()) {\n+        LogWarning(\"tor: Failed to set non-blocking mode: %s\", NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n+\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n+\n+    LogDebug(BCLog::TOR, \"Successfully connected to Tor control port\");\n     return true;\n }\n \n void TorControlConnection::Disconnect()\n {\n-    if (b_conn)\n-        bufferevent_free(b_conn);\n-    b_conn = nullptr;\n+    m_sock.reset();\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n }\n \n-bool TorControlConnection::Command(const std::string &cmd, const ReplyHandlerCB& reply_handler)\n+bool TorControlConnection::IsConnected() const\n {\n-    if (!b_conn)\n+    if (!m_sock) return false;\n+    std::string errmsg;\n+    return m_sock->IsConnected(errmsg);\n+}\n+\n+bool TorControlConnection::WaitForData(std::chrono::milliseconds timeout) const\n+{\n+    if (!m_sock) return false;\n+\n+    Sock::Event event{0};\n+    if (!m_sock->Wait(timeout, Sock::RECV, &event)) {\n         return false;\n-    struct evbuffer *buf = bufferevent_get_output(b_conn);\n-    if (!buf)\n+    }\n+    if (event & Sock::ERR) {\n         return false;\n-    evbuffer_add(buf, cmd.data(), cmd.size());\n-    evbuffer_add(buf, \"\\r\\n\", 2);\n-    reply_handlers.push_back(reply_handler);\n+    }\n+\n+    return true;\n+}\n+\n+bool TorControlConnection::ReceiveAndProcess()\n+{\n+    if (!m_sock) return false;\n+\n+    std::byte buf[4096];\n+    ssize_t nread = m_sock->Recv(buf, sizeof(buf), MSG_DONTWAIT);\n+\n+    if (nread < 0) {\n+        int err = WSAGetLastError();\n+        if (err == WSAEWOULDBLOCK || err == WSAEINTR || err == WSAEINPROGRESS) {\n+            // No data available currently\n+            return true;\n+        }\n+        LogWarning(\"tor: Error reading from socket: %s\", NetworkErrorString(err));\n+        return false;\n+    }\n+\n+    if (nread == 0) {\n+        LogDebug(BCLog::TOR, \"End of stream\");\n+        return false;\n+    }\n+\n+    m_recv_buffer.insert(m_recv_buffer.end(), buf, buf + nread);\n+    return ProcessBuffer();\n+}\n+\n+bool TorControlConnection::ProcessBuffer()\n+{\n+    if (m_recv_buffer.size() > MAX_LINE_LENGTH) {\n+        LogWarning(\"tor: Disconnecting because MAX_LINE_LENGTH exceeded\");\n+        return false;\n+    }\n+\n+    // TODO: Maybe could give this as an option to LineReader instead\n+    auto last_newline = std::find(m_recv_buffer.rbegin(), m_recv_buffer.rend(), std::byte{'\\n'});\n+    if (last_newline == m_recv_buffer.rend()) return true;\n+    size_t complete = last_newline.base() - m_recv_buffer.begin();\n+    util::LineReader reader({m_recv_buffer.data(), complete}, MAX_LINE_LENGTH);",
      "path": "src/torcontrol.cpp",
      "position": 251,
      "original_position": 229,
      "commit_id": "280898134f962c9e24d8025d4d58396b7293f6cb",
      "original_commit_id": "c675b6f059dea662d9faa90df261de7bfbca13a1",
      "in_reply_to_id": 2695742143,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I only glossed over the usage of `LineReader` in the rest of the http PR so far but yeah, that makes sense to me. And that would make my code here simpler :)",
      "created_at": "2026-01-19T13:23:49Z",
      "updated_at": "2026-01-19T13:23:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#discussion_r2704763440",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2704763440"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
        }
      },
      "start_line": 191,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": 195,
      "original_line": 195,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2709500964",
      "pull_request_review_id": 3683586241,
      "id": 2709500964,
      "node_id": "PRRC_kwDOABII586hf7Qk",
      "diff_hunk": "@@ -166,41 +99,149 @@ bool TorControlConnection::Connect(const std::string& tor_control_center, const\n         return false;\n     }\n \n-    // Create a new socket, set up callbacks and enable notification bits\n-    b_conn = bufferevent_socket_new(base, -1, BEV_OPT_CLOSE_ON_FREE);\n-    if (!b_conn) {\n+    // Create a new socket\n+    SOCKET s = socket(control_service->GetSAFamily(), SOCK_STREAM, IPPROTO_TCP);\n+    if (s == INVALID_SOCKET) {\n+        LogWarning(\"tor: Failed to create socket: %s\", NetworkErrorString(WSAGetLastError()));\n+        return false;\n+    }\n+\n+    m_sock = std::make_unique<Sock>(s);\n+\n+    // Connect to Tor control port\n+    if (m_sock->Connect(reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) == SOCKET_ERROR) {\n+        LogWarning(\"tor: Error connecting to address %s: %s\", tor_control_center, NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n-    bufferevent_setcb(b_conn, TorControlConnection::readcb, nullptr, TorControlConnection::eventcb, this);\n-    bufferevent_enable(b_conn, EV_READ|EV_WRITE);\n-    this->connected = _connected;\n-    this->disconnected = _disconnected;\n-\n-    // Finally, connect to tor_control_center\n-    if (bufferevent_socket_connect(b_conn, reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) < 0) {\n-        LogWarning(\"tor: Error connecting to address %s\", tor_control_center);\n+\n+    // Set non-blocking mode on socket\n+    if (!m_sock->SetNonBlocking()) {\n+        LogWarning(\"tor: Failed to set non-blocking mode: %s\", NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n+\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n+\n+    LogDebug(BCLog::TOR, \"Successfully connected to Tor control port\");\n     return true;\n }\n \n void TorControlConnection::Disconnect()\n {\n-    if (b_conn)\n-        bufferevent_free(b_conn);\n-    b_conn = nullptr;\n+    m_sock.reset();\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n }\n \n-bool TorControlConnection::Command(const std::string &cmd, const ReplyHandlerCB& reply_handler)\n+bool TorControlConnection::IsConnected() const\n {\n-    if (!b_conn)\n+    if (!m_sock) return false;\n+    std::string errmsg;\n+    return m_sock->IsConnected(errmsg);\n+}\n+\n+bool TorControlConnection::WaitForData(std::chrono::milliseconds timeout) const\n+{\n+    if (!m_sock) return false;\n+\n+    Sock::Event event{0};\n+    if (!m_sock->Wait(timeout, Sock::RECV, &event)) {\n         return false;\n-    struct evbuffer *buf = bufferevent_get_output(b_conn);\n-    if (!buf)\n+    }\n+    if (event & Sock::ERR) {\n         return false;\n-    evbuffer_add(buf, cmd.data(), cmd.size());\n-    evbuffer_add(buf, \"\\r\\n\", 2);\n-    reply_handlers.push_back(reply_handler);\n+    }\n+\n+    return true;\n+}\n+\n+bool TorControlConnection::ReceiveAndProcess()\n+{\n+    if (!m_sock) return false;\n+\n+    std::byte buf[4096];\n+    ssize_t nread = m_sock->Recv(buf, sizeof(buf), MSG_DONTWAIT);\n+\n+    if (nread < 0) {\n+        int err = WSAGetLastError();\n+        if (err == WSAEWOULDBLOCK || err == WSAEINTR || err == WSAEINPROGRESS) {\n+            // No data available currently\n+            return true;\n+        }\n+        LogWarning(\"tor: Error reading from socket: %s\", NetworkErrorString(err));\n+        return false;\n+    }\n+\n+    if (nread == 0) {\n+        LogDebug(BCLog::TOR, \"End of stream\");\n+        return false;\n+    }\n+\n+    m_recv_buffer.insert(m_recv_buffer.end(), buf, buf + nread);\n+    return ProcessBuffer();\n+}\n+\n+bool TorControlConnection::ProcessBuffer()\n+{\n+    if (m_recv_buffer.size() > MAX_LINE_LENGTH) {\n+        LogWarning(\"tor: Disconnecting because MAX_LINE_LENGTH exceeded\");\n+        return false;\n+    }\n+\n+    // TODO: Maybe could give this as an option to LineReader instead\n+    auto last_newline = std::find(m_recv_buffer.rbegin(), m_recv_buffer.rend(), std::byte{'\\n'});\n+    if (last_newline == m_recv_buffer.rend()) return true;\n+    size_t complete = last_newline.base() - m_recv_buffer.begin();\n+    util::LineReader reader({m_recv_buffer.data(), complete}, MAX_LINE_LENGTH);",
      "path": "src/torcontrol.cpp",
      "position": 251,
      "original_position": 229,
      "commit_id": "280898134f962c9e24d8025d4d58396b7293f6cb",
      "original_commit_id": "c675b6f059dea662d9faa90df261de7bfbca13a1",
      "in_reply_to_id": 2695742143,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'm about to push an update to #34242 that solves this. The patch below fails the partial-send test in `feature_torcontrol.py` with your current `LineReader` but passes when I rebase on the updated version:\r\n\r\n```diff\r\ndiff --git a/src/torcontrol.cpp b/src/torcontrol.cpp\r\nindex 94f925b8f4..bae7ac44a5 100644\r\n--- a/src/torcontrol.cpp\r\n+++ b/src/torcontrol.cpp\r\n@@ -188,12 +188,8 @@ bool TorControlConnection::ReceiveAndProcess()\r\n \r\n bool TorControlConnection::ProcessBuffer()\r\n {\r\n-    // TODO: Maybe could give this as an option to LineReader instead\r\n-    auto last_newline = std::find(m_recv_buffer.rbegin(), m_recv_buffer.rend(), std::byte{'\\n'});\r\n-    if (last_newline == m_recv_buffer.rend()) return true;\r\n-    size_t complete = last_newline.base() - m_recv_buffer.begin();\r\n-    util::LineReader reader({m_recv_buffer.data(), complete}, MAX_LINE_LENGTH);\r\n-\r\n+    util::LineReader reader(m_recv_buffer, MAX_LINE_LENGTH);\r\n+    auto start = reader.it;\r\n     while (auto line = reader.ReadLine()) {\r\n         // Skip short lines\r\n         if (line->size() < 4) continue;\r\n@@ -220,7 +216,7 @@ bool TorControlConnection::ProcessBuffer()\r\n         }\r\n     }\r\n \r\n-    m_recv_buffer.erase(m_recv_buffer.begin(), m_recv_buffer.begin() + complete);\r\n+    m_recv_buffer.erase(m_recv_buffer.begin(), m_recv_buffer.begin() + std::distance(start, reader.it));\r\n     return true;\r\n }\r\n \r\n```",
      "created_at": "2026-01-20T18:03:44Z",
      "updated_at": "2026-01-20T18:03:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#discussion_r2709500964",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2709500964"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
        }
      },
      "start_line": 191,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": 195,
      "original_line": 195,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2712593803",
      "pull_request_review_id": 3687270889,
      "id": 2712593803,
      "node_id": "PRRC_kwDOABII586hruWL",
      "diff_hunk": "@@ -166,41 +99,149 @@ bool TorControlConnection::Connect(const std::string& tor_control_center, const\n         return false;\n     }\n \n-    // Create a new socket, set up callbacks and enable notification bits\n-    b_conn = bufferevent_socket_new(base, -1, BEV_OPT_CLOSE_ON_FREE);\n-    if (!b_conn) {\n+    // Create a new socket\n+    SOCKET s = socket(control_service->GetSAFamily(), SOCK_STREAM, IPPROTO_TCP);\n+    if (s == INVALID_SOCKET) {\n+        LogWarning(\"tor: Failed to create socket: %s\", NetworkErrorString(WSAGetLastError()));\n+        return false;\n+    }\n+\n+    m_sock = std::make_unique<Sock>(s);\n+\n+    // Connect to Tor control port\n+    if (m_sock->Connect(reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) == SOCKET_ERROR) {\n+        LogWarning(\"tor: Error connecting to address %s: %s\", tor_control_center, NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n-    bufferevent_setcb(b_conn, TorControlConnection::readcb, nullptr, TorControlConnection::eventcb, this);\n-    bufferevent_enable(b_conn, EV_READ|EV_WRITE);\n-    this->connected = _connected;\n-    this->disconnected = _disconnected;\n-\n-    // Finally, connect to tor_control_center\n-    if (bufferevent_socket_connect(b_conn, reinterpret_cast<struct sockaddr*>(&control_address), control_address_len) < 0) {\n-        LogWarning(\"tor: Error connecting to address %s\", tor_control_center);\n+\n+    // Set non-blocking mode on socket\n+    if (!m_sock->SetNonBlocking()) {\n+        LogWarning(\"tor: Failed to set non-blocking mode: %s\", NetworkErrorString(WSAGetLastError()));\n+        m_sock.reset();\n         return false;\n     }\n+\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n+\n+    LogDebug(BCLog::TOR, \"Successfully connected to Tor control port\");\n     return true;\n }\n \n void TorControlConnection::Disconnect()\n {\n-    if (b_conn)\n-        bufferevent_free(b_conn);\n-    b_conn = nullptr;\n+    m_sock.reset();\n+    m_recv_buffer.clear();\n+    m_message.Clear();\n+    m_reply_handlers.clear();\n }\n \n-bool TorControlConnection::Command(const std::string &cmd, const ReplyHandlerCB& reply_handler)\n+bool TorControlConnection::IsConnected() const\n {\n-    if (!b_conn)\n+    if (!m_sock) return false;\n+    std::string errmsg;\n+    return m_sock->IsConnected(errmsg);\n+}\n+\n+bool TorControlConnection::WaitForData(std::chrono::milliseconds timeout) const\n+{\n+    if (!m_sock) return false;\n+\n+    Sock::Event event{0};\n+    if (!m_sock->Wait(timeout, Sock::RECV, &event)) {\n         return false;\n-    struct evbuffer *buf = bufferevent_get_output(b_conn);\n-    if (!buf)\n+    }\n+    if (event & Sock::ERR) {\n         return false;\n-    evbuffer_add(buf, cmd.data(), cmd.size());\n-    evbuffer_add(buf, \"\\r\\n\", 2);\n-    reply_handlers.push_back(reply_handler);\n+    }\n+\n+    return true;\n+}\n+\n+bool TorControlConnection::ReceiveAndProcess()\n+{\n+    if (!m_sock) return false;\n+\n+    std::byte buf[4096];\n+    ssize_t nread = m_sock->Recv(buf, sizeof(buf), MSG_DONTWAIT);\n+\n+    if (nread < 0) {\n+        int err = WSAGetLastError();\n+        if (err == WSAEWOULDBLOCK || err == WSAEINTR || err == WSAEINPROGRESS) {\n+            // No data available currently\n+            return true;\n+        }\n+        LogWarning(\"tor: Error reading from socket: %s\", NetworkErrorString(err));\n+        return false;\n+    }\n+\n+    if (nread == 0) {\n+        LogDebug(BCLog::TOR, \"End of stream\");\n+        return false;\n+    }\n+\n+    m_recv_buffer.insert(m_recv_buffer.end(), buf, buf + nread);\n+    return ProcessBuffer();\n+}\n+\n+bool TorControlConnection::ProcessBuffer()\n+{\n+    if (m_recv_buffer.size() > MAX_LINE_LENGTH) {\n+        LogWarning(\"tor: Disconnecting because MAX_LINE_LENGTH exceeded\");\n+        return false;\n+    }\n+\n+    // TODO: Maybe could give this as an option to LineReader instead\n+    auto last_newline = std::find(m_recv_buffer.rbegin(), m_recv_buffer.rend(), std::byte{'\\n'});\n+    if (last_newline == m_recv_buffer.rend()) return true;\n+    size_t complete = last_newline.base() - m_recv_buffer.begin();\n+    util::LineReader reader({m_recv_buffer.data(), complete}, MAX_LINE_LENGTH);",
      "path": "src/torcontrol.cpp",
      "position": 251,
      "original_position": 229,
      "commit_id": "280898134f962c9e24d8025d4d58396b7293f6cb",
      "original_commit_id": "c675b6f059dea662d9faa90df261de7bfbca13a1",
      "in_reply_to_id": 2695742143,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Cool, thank you! I will wait until the latest conversations have been resolved before rebasing, hoping everything in #34242 is clear and it can be merged soon :)",
      "created_at": "2026-01-21T13:32:04Z",
      "updated_at": "2026-01-21T13:32:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/34158#discussion_r2712593803",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2712593803"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/34158"
        }
      },
      "start_line": 191,
      "original_start_line": 196,
      "start_side": "RIGHT",
      "line": 195,
      "original_line": 195,
      "side": "RIGHT"
    }
  ]
}