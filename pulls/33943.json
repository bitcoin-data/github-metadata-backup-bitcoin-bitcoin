{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33943",
    "id": 3044102097,
    "node_id": "PR_kwDOABII5861cU_R",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/33943",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/33943.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/33943.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33943",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33943/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33943/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33943/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/5ccd6a1d3879116ab43e354329c72742bab76c96",
    "number": 33943,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "kernel: don't use assert to handle invalid user input",
    "user": {
      "login": "stickies-v",
      "id": 69010457,
      "node_id": "MDQ6VXNlcjY5MDEwNDU3",
      "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stickies-v",
      "html_url": "https://github.com/stickies-v",
      "followers_url": "https://api.github.com/users/stickies-v/followers",
      "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
      "organizations_url": "https://api.github.com/users/stickies-v/orgs",
      "repos_url": "https://api.github.com/users/stickies-v/repos",
      "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/stickies-v/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "Crashing with `assert` for invalid user input is problematic for a library, e.g. this is impossible for FFI users to recover from, forcing them to re-implement the error handling logic client-side. See e.g. the [go](https://github.com/stringintech/go-bitcoinkernel/blob/88105c69b32c48919a45bb07fc05ca2c79d2728b/kernel/script_pubkey.go#L91-L102) and [.net](https://github.com/janb84/BitcoinKernel.NET/blob/4ba1ff802fe9a3b7c0af0012e6fdc33e5bc4f961/src/BitcoinKernel.Core/ScriptVerification/ScriptVerifier.cs#L38-L56) bindings, or the discussion in https://github.com/stringintech/kernel-bindings-tests/issues/5.\r\n\r\nThis PR changes behaviour by:\r\n- updating `btck_script_pubkey_verify` to return `-1` for invalid/malformed requests, `0` for invalid scripts, and `1` for valid scripts. Previously, the program would crash for the `-1` cases.\r\n- updating 5 getters to return `nullptr` when the request index is out of bounds. Previously, the program would crash in these cases.\r\n\r\nThe wrapper is updated to throw `std::runtime_error` or `std::out_of_bounds` errors, and the tests are also updated.\r\n\r\nBy not crashing, we can properly test for these edge cases in [`kernel-bindings-tests`](https://github.com/stringintech/kernel-bindings-tests) to ensure that wrappers are handling them properly, as opposed to e.g. not differentiating between `0` and `-1`, which a naive (incorrect) implementation could do.\r\n\r\nNote: I'm not sure why `btck_ScriptVerifyStatus_ERROR_INVALID_FLAGS_COMBINATION` and `btck_ScriptVerifyStatus_ERROR_SPENT_OUTPUTS_REQUIRED` are currently handled as `INVALID_SCRIPT`, in my view they should probably be `INVALID_REQUEST` (which means `btck_ScriptVerifyStatus` becomes meaningless in its current form), but I've not implemented that yet as I'm not 100% sure. Happy to update that here, or can also be done in a separate pull later.",
    "labels": [
      {
        "id": 118379652,
        "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
        "name": "Validation",
        "color": "6060aa",
        "default": false
      },
      {
        "id": 955867938,
        "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
        "name": "Needs rebase",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2025-11-25T15:24:13Z",
    "updated_at": "2025-12-27T17:42:54Z",
    "mergeable": false,
    "mergeable_state": "dirty",
    "merged": false,
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "stickies-v:2025-11/kernel-less-assert",
      "ref": "2025-11/kernel-less-assert",
      "sha": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 431644530,
        "node_id": "R_kgDOGbpfcg",
        "name": "bitcoin",
        "full_name": "stickies-v/bitcoin",
        "owner": {
          "login": "stickies-v",
          "id": 69010457,
          "node_id": "MDQ6VXNlcjY5MDEwNDU3",
          "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/stickies-v",
          "html_url": "https://github.com/stickies-v",
          "followers_url": "https://api.github.com/users/stickies-v/followers",
          "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
          "organizations_url": "https://api.github.com/users/stickies-v/orgs",
          "repos_url": "https://api.github.com/users/stickies-v/repos",
          "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/stickies-v/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/stickies-v/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/stickies-v/bitcoin",
        "archive_url": "https://api.github.com/repos/stickies-v/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/stickies-v/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/stickies-v/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/stickies-v/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/stickies-v/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/stickies-v/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/stickies-v/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/stickies-v/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/stickies-v/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/stickies-v/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/stickies-v/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/stickies-v/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/stickies-v/bitcoin/events",
        "forks_url": "https://api.github.com/repos/stickies-v/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/stickies-v/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/stickies-v/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/stickies-v/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/stickies-v/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/stickies-v/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/stickies-v/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/stickies-v/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/stickies-v/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/stickies-v/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/stickies-v/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/stickies-v/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/stickies-v/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/stickies-v/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/stickies-v/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/stickies-v/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:stickies-v/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/stickies-v/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/stickies-v/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/stickies-v/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/stickies-v/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/stickies-v/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/stickies-v/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/stickies-v/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/stickies-v/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/stickies-v/bitcoin/hooks",
        "svn_url": "https://github.com/stickies-v/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 3,
        "watchers_count": 3,
        "size": 289553,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-12-17T17:29:14Z",
        "created_at": "2021-11-24T22:26:41Z",
        "updated_at": "2025-10-10T05:07:04Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "5336bcd5784925cd722cff4b9c28e58c64c0b708",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38690,
        "stargazers_count": 87454,
        "watchers_count": 87454,
        "size": 301053,
        "default_branch": "master",
        "open_issues_count": 741,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-12-29T15:16:47Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-12-30T16:34:30Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33943"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": true,
    "additions": 122,
    "deletions": 27,
    "changed_files": 4,
    "commits": 2,
    "review_comments": 6,
    "comments": 5
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDdiZDNjZmI4NDBlNjdlMmI5NzY4ODA0MDIxOGQ3ZGNmMzM3NDFiZWY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7bd3cfb840e67e2b97688040218d7dcf33741bef",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7bd3cfb840e67e2b97688040218d7dcf33741bef",
      "tree": {
        "sha": "e705b067ccaff27a38b28c1b18b6fe48bcf1eb9c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e705b067ccaff27a38b28c1b18b6fe48bcf1eb9c"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree e705b067ccaff27a38b28c1b18b6fe48bcf1eb9c\nparent 5336bcd5784925cd722cff4b9c28e58c64c0b708\nauthor stickies-v <stickies-v@protonmail.com> 1764081176 +0000\ncommitter stickies-v <stickies-v@protonmail.com> 1764081513 +0000\n\nkernel: return -1 on invalid btck_script_pubkey_verify request\n\nCrashing on invalid user input is problematic for a library, e.g.\nthis is impossible for FFI users to recover from, forcing them\nto re-implement the error handling logic client-side.\n\nImprove this by returning a -1 error code instead of crashing.\n\nUpdates the C++ wrapper to throw a std::runtime_error for an\ninvalid request, and adds test coverage.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE5g/ggIZt5fccjfOgXLHObl5mp1cFAmklv2kACgkQXLHObl5m\np1cDMw/+K7/pUsveT+usqy5rYPzVkNVf3L9w4wEN79KhUhX3e75FYNXNR7PoIFFt\nzrgIlBziAT3aLCuuhlqShuhmjIy5/hUJBjXczGzEDijF+9CMvbG7exLe59tPm1wS\n7D6SrMoeyI/Oi4UgVKXBxi3X+3HFG/ojle0+6xh1r8OsncLNyMSQjlCeFc/OqE4t\nVGpIY7exvH8OPQ4OFHh5bOqnqSWZsCbBZCpYJ4JjaPf0PlSlrbyKzZmNv5pVaGlm\nK7KSIJb4C3JGX3BnbbTL6dF8GhWdKUML/Xmfq6WcnwVsmIuC8LwbQXSfXjHsl2Ex\nPEjwktQoW8CLRDuDXEdiTvd03Sv8G3th1pB1a7+jOh+HSamgyLNN2UYee9CDy8C2\nJoMBtLPGQ4GlPnSRky3Gmw3YgJsEucDs0gRL7OVtNQNFI9ARVOOqbdk/dwmeihL9\nOLEIeNH6mQmkpDdTCbgZKPhN4j51pX0Y0kBQfwyuePFouHNEFMi1MqVJG2z/xL00\nX4NiJLmve/fI+Ya8uMSxGrHfau9yXSTR/Fo7YpIDw7Gb2uQyHfTY1dDM5sZxrEPF\nC0v1N8Cc9MO+OR/HybRcX272kBAWLVla+Xdy+dd/pi2lvHDOPaSyycKr4E4TUEeg\nj7rIZecNLdObJQFI5XzJyxk55z/q1DfbRSvXO/rcSGLqREZZLKc=\n=95au\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5336bcd5784925cd722cff4b9c28e58c64c0b708",
          "sha": "5336bcd5784925cd722cff4b9c28e58c64c0b708",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5336bcd5784925cd722cff4b9c28e58c64c0b708"
        }
      ],
      "message": "kernel: return -1 on invalid btck_script_pubkey_verify request\n\nCrashing on invalid user input is problematic for a library, e.g.\nthis is impossible for FFI users to recover from, forcing them\nto re-implement the error handling logic client-side.\n\nImprove this by returning a -1 error code instead of crashing.\n\nUpdates the C++ wrapper to throw a std::runtime_error for an\ninvalid request, and adds test coverage.",
      "committer": {
        "name": "stickies-v",
        "email": "stickies-v@protonmail.com",
        "date": "2025-11-25T14:38:33Z"
      },
      "author": {
        "name": "stickies-v",
        "email": "stickies-v@protonmail.com",
        "date": "2025-11-25T14:32:56Z"
      },
      "sha": "7bd3cfb840e67e2b97688040218d7dcf33741bef"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDVjY2Q2YTFkMzg3OTExNmFiNDNlMzU0MzI5YzcyNzQyYmFiNzZjOTY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5ccd6a1d3879116ab43e354329c72742bab76c96",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5ccd6a1d3879116ab43e354329c72742bab76c96",
      "tree": {
        "sha": "0e96bb30f8fe142584eaadf07378b7c9dad5f6c8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0e96bb30f8fe142584eaadf07378b7c9dad5f6c8"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 0e96bb30f8fe142584eaadf07378b7c9dad5f6c8\nparent 7bd3cfb840e67e2b97688040218d7dcf33741bef\nauthor stickies-v <stickies-v@protonmail.com> 1764082580 +0000\ncommitter stickies-v <stickies-v@protonmail.com> 1764083238 +0000\n\nkernel: return nullptr for out-of-bounds getters\n\nCrashing on invalid user input is problematic for a library, e.g.\nthis is impossible for FFI users to recover from, forcing them\nto re-implement the error handling logic client-side.\n\nImprove this by returning a nullptr  instead of crashing.\n\nUpdates the C++ wrapper to throw a std::out_of_bounds error for an\ninvalid request, and adds test coverage.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE5g/ggIZt5fccjfOgXLHObl5mp1cFAmklxjQACgkQXLHObl5m\np1d2Cw/8DWz0h5TLQNPVT5PGy1YvgTKvnEEKVr8EBGip2TAKzypw6CJZG2Rh+2vo\n2GC0Qc6+/1L9mh0DJIOt0bUv5wKv4FQb4uKYNW9EavIunf5GS0NEq4dlyRCPao9B\neMPfn7WmpBMRAChIbBi37BhH6s6LqxCG8JhojoK8WKoTxSUbZLTIgOAQ4jJRbeMm\ngn49H7JBAkcUZvZqZV13vnelnmxzqjjhY6NcsT9EN9r+S61LQf5YH3gHUR0ZfQ8R\nb0CCvRrqBLLwVDi62fcZxIEdheizTHSu5VSYf9rnZ7j4dfk6ELJVC5h5y3LrMjUz\nbeyig7dV5ZgrV0oiRwEtcle5quAeMxOv9nAg+vn2f6F7LsywLXssQW4R9ay4/y8Y\nyN+gfWbR9YVbz0ntexabuybCkIQr5leaIvO8V/kvwRLpi+QexqU/Vy980cOms7Hp\nfJBz5FE2/SK7EwzJTfiRkAx7rFCa97gSRFOd0MnTdE5hOOshdWytlTXcDJrOAA0/\nQ001813KwbFrK53N1Td1vh6k9lPUuG8/BBrzWRMzFXb/uZFzMANPrvYJ/vf0rVev\neLkiOCTv3CXQfYTt1o8NOZAoBC7TZpA6Jm6C3Phd0qCuZiKDt36W2QqUfi35LdB6\n5QWequXy/4/2VbLEjYOsprPJyIlZwG0PkASqzzmhTEDJ227khLo=\n=Isjw\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7bd3cfb840e67e2b97688040218d7dcf33741bef",
          "sha": "7bd3cfb840e67e2b97688040218d7dcf33741bef",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7bd3cfb840e67e2b97688040218d7dcf33741bef"
        }
      ],
      "message": "kernel: return nullptr for out-of-bounds getters\n\nCrashing on invalid user input is problematic for a library, e.g.\nthis is impossible for FFI users to recover from, forcing them\nto re-implement the error handling logic client-side.\n\nImprove this by returning a nullptr  instead of crashing.\n\nUpdates the C++ wrapper to throw a std::out_of_bounds error for an\ninvalid request, and adds test coverage.",
      "committer": {
        "name": "stickies-v",
        "email": "stickies-v@protonmail.com",
        "date": "2025-11-25T15:07:18Z"
      },
      "author": {
        "name": "stickies-v",
        "email": "stickies-v@protonmail.com",
        "date": "2025-11-25T14:56:20Z"
      },
      "sha": "5ccd6a1d3879116ab43e354329c72742bab76c96"
    },
    {
      "event": "labeled",
      "id": 21167560373,
      "node_id": "LE_lADOABII587aXRXHzwAAAATtr1a1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21167560373",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-25T15:24:18Z",
      "label": {
        "name": "Validation",
        "color": "6060aa"
      }
    },
    {
      "event": "commented",
      "id": 3576226489,
      "node_id": "IC_kwDOABII587VKOK5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3576226489",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-25T15:24:22Z",
      "updated_at": "2025-11-27T03:51:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33943.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [stringintech](https://github.com/bitcoin/bitcoin/pull/33943#issuecomment-3580755258), [sedited](https://github.com/bitcoin/bitcoin/pull/33943#issuecomment-3581241991), [yuvicc](https://github.com/bitcoin/bitcoin/pull/33943#issuecomment-3584097189) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#33891](https://github.com/bitcoin/bitcoin/pull/33891) (kernel: Expose reusable `PrecomputedTransactionData` in script validation by joshdoman)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (âœ¨ experimental)\n\n\n\nPossible places where named args may be used (e.g. `func(x, /*named_arg=*/0)` in C++, and `func(x, named_arg=0)` in Python):\n\n- taproot_spent_script_pubkey.Verify(88480, taproot_tx, spent_outputs, 1, ScriptVerificationFlags::ALL, status) in src/test/kernel/test_kernel.cpp\n- taproot_spent_script_pubkey.Verify(88480, taproot_tx, wrong_size_spent_outputs, 0, ScriptVerificationFlags::ALL, status) in src/test/kernel/test_kernel.cpp\n\n\n\n<sup>2025-11-25</sup>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#issuecomment-3576226489",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33943"
    },
    {
      "event": "added_to_project_v2",
      "id": 21167584398,
      "node_id": "ATPVTE_lADOABII587aXRXHzwAAAATtr7SO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21167584398",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-25T15:25:08Z"
    },
    {
      "event": "project_v2_item_status_changed",
      "id": 21167584774,
      "node_id": "PVTISC_lADOABII587aXRXHzwAAAATtr7YG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21167584774",
      "actor": {
        "login": "github-project-automation[bot]",
        "id": 113052574,
        "node_id": "BOT_kgDOBr0Lng",
        "avatar_url": "https://avatars.githubusercontent.com/in/235829?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/github-project-automation%5Bbot%5D",
        "html_url": "https://github.com/apps/github-project-automation",
        "followers_url": "https://api.github.com/users/github-project-automation%5Bbot%5D/followers",
        "following_url": "https://api.github.com/users/github-project-automation%5Bbot%5D/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/github-project-automation%5Bbot%5D/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/github-project-automation%5Bbot%5D/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/github-project-automation%5Bbot%5D/subscriptions",
        "organizations_url": "https://api.github.com/users/github-project-automation%5Bbot%5D/orgs",
        "repos_url": "https://api.github.com/users/github-project-automation%5Bbot%5D/repos",
        "events_url": "https://api.github.com/users/github-project-automation%5Bbot%5D/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/github-project-automation%5Bbot%5D/received_events",
        "type": "Bot",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-25T15:25:09Z"
    },
    {
      "event": "reviewed",
      "id": 3506576732,
      "node_id": "PRR_kwDOABII587RAh1c",
      "url": null,
      "actor": null,
      "commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T19:48:13Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#pullrequestreview-3506576732",
      "submitted_at": "2025-11-25T19:48:13Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33943"
    },
    {
      "event": "commented",
      "id": 3580755258,
      "node_id": "IC_kwDOABII587Vbf06",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3580755258",
      "actor": {
        "login": "stringintech",
        "id": 157148846,
        "node_id": "U_kgDOCV3mrg",
        "avatar_url": "https://avatars.githubusercontent.com/u/157148846?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stringintech",
        "html_url": "https://github.com/stringintech",
        "followers_url": "https://api.github.com/users/stringintech/followers",
        "following_url": "https://api.github.com/users/stringintech/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stringintech/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stringintech/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stringintech/subscriptions",
        "organizations_url": "https://api.github.com/users/stringintech/orgs",
        "repos_url": "https://api.github.com/users/stringintech/repos",
        "events_url": "https://api.github.com/users/stringintech/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stringintech/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-26T10:52:30Z",
      "updated_at": "2025-11-26T11:09:51Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK on being more strict with using `assert`.\r\n\r\nI think it makes more sense for a public API to sanitize user input and communicate issues with the input, allowing for recovery and leave usages of `assert` for internal logical inconsistencies (library programmer errors that must never happen).\r\n\r\nRegarding the approach: I like what is suggested in https://github.com/bitcoin/bitcoin/pull/33943#discussion_r2561205810 (exposing the enum and having it as the return value). I'm still thinking about whether to differentiate invalid requests with different error codes or just have one code for all as you did.\r\n\r\nAlso, I remember at some point we had error codes instead of assertions for all cases of invalid user input in `btck_script_pubkey_verify()`: for example see https://github.com/TheCharlatan/bitcoin/blob/kernelApi_44/src/kernel/bitcoinkernel.cpp#L473. It would be good to go over/remember the rationale behind replacing some of them with assertions.",
      "user": {
        "login": "stringintech",
        "id": 157148846,
        "node_id": "U_kgDOCV3mrg",
        "avatar_url": "https://avatars.githubusercontent.com/u/157148846?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stringintech",
        "html_url": "https://github.com/stringintech",
        "followers_url": "https://api.github.com/users/stringintech/followers",
        "following_url": "https://api.github.com/users/stringintech/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stringintech/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stringintech/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stringintech/subscriptions",
        "organizations_url": "https://api.github.com/users/stringintech/orgs",
        "repos_url": "https://api.github.com/users/stringintech/repos",
        "events_url": "https://api.github.com/users/stringintech/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stringintech/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#issuecomment-3580755258",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33943"
    },
    {
      "event": "commented",
      "id": 3581241991,
      "node_id": "IC_kwDOABII587VdWqH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3581241991",
      "actor": {
        "login": "sedited",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sedited",
        "html_url": "https://github.com/sedited",
        "followers_url": "https://api.github.com/users/sedited/followers",
        "following_url": "https://api.github.com/users/sedited/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sedited/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sedited/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sedited/subscriptions",
        "organizations_url": "https://api.github.com/users/sedited/orgs",
        "repos_url": "https://api.github.com/users/sedited/repos",
        "events_url": "https://api.github.com/users/sedited/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sedited/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-26T13:05:30Z",
      "updated_at": "2025-11-26T13:09:10Z",
      "author_association": "CONTRIBUTOR",
      "body": "I'm Concept ACK on improving the behaviour around bad input, but not sure about adding more error handling surface to the API with the current approach. In my opinion the cases addressed are all programming errors, and should be treated as such. The argument that this duplicates the error handling code for the wrappers is not convincing to me and the PR itself as it currently stands provides the counter argument for it - an out of bounds case is still added and handled by the respective language wrapper. This seems sane to me, since every language will have its unique convention and way for handling these cases - from returning a variant to throwing an exception. Along these lines, I also don't understand why the change here should make cross-bindings tests easier. \r\n\r\nMight a better approach be adding a custom argument checker? The secp library has some that do both assertions and allow for a user-defined override. Personally, I think we'd be fine with just assertions, but a macro that can be defined to wrap a user-defined function through a function pointer seems useful for both debugging and providing a way to unify behaviour across tests. \r\n\r\nEDIT:\r\nThis is the secp behaviour I mean: https://github.com/bitcoin-core/secp256k1/blob/master/src/secp256k1.c#L47\r\n",
      "user": {
        "login": "sedited",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sedited",
        "html_url": "https://github.com/sedited",
        "followers_url": "https://api.github.com/users/sedited/followers",
        "following_url": "https://api.github.com/users/sedited/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sedited/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sedited/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sedited/subscriptions",
        "organizations_url": "https://api.github.com/users/sedited/orgs",
        "repos_url": "https://api.github.com/users/sedited/repos",
        "events_url": "https://api.github.com/users/sedited/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sedited/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#issuecomment-3581241991",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33943"
    },
    {
      "event": "commented",
      "id": 3584097189,
      "node_id": "IC_kwDOABII587VoPul",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3584097189",
      "actor": {
        "login": "yuvicc",
        "id": 92994932,
        "node_id": "U_kgDOBYr9dA",
        "avatar_url": "https://avatars.githubusercontent.com/u/92994932?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yuvicc",
        "html_url": "https://github.com/yuvicc",
        "followers_url": "https://api.github.com/users/yuvicc/followers",
        "following_url": "https://api.github.com/users/yuvicc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yuvicc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yuvicc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yuvicc/subscriptions",
        "organizations_url": "https://api.github.com/users/yuvicc/orgs",
        "repos_url": "https://api.github.com/users/yuvicc/repos",
        "events_url": "https://api.github.com/users/yuvicc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yuvicc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T03:50:58Z",
      "updated_at": "2025-11-27T03:50:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK on fixing input validation. Agree with @sedited here, not sure if we want to add more error handling to the API. I found the secp256k1 approach using `ARG_CHECK` macros through callback to be more straightforward and appropriate.",
      "user": {
        "login": "yuvicc",
        "id": 92994932,
        "node_id": "U_kgDOBYr9dA",
        "avatar_url": "https://avatars.githubusercontent.com/u/92994932?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yuvicc",
        "html_url": "https://github.com/yuvicc",
        "followers_url": "https://api.github.com/users/yuvicc/followers",
        "following_url": "https://api.github.com/users/yuvicc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yuvicc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yuvicc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yuvicc/subscriptions",
        "organizations_url": "https://api.github.com/users/yuvicc/orgs",
        "repos_url": "https://api.github.com/users/yuvicc/repos",
        "events_url": "https://api.github.com/users/yuvicc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yuvicc/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#issuecomment-3584097189",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33943"
    },
    {
      "event": "mentioned",
      "id": 21209607899,
      "node_id": "MEE_lADOABII587aXRXHzwAAAATwMO7b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21209607899",
      "actor": {
        "login": "sedited",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sedited",
        "html_url": "https://github.com/sedited",
        "followers_url": "https://api.github.com/users/sedited/followers",
        "following_url": "https://api.github.com/users/sedited/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sedited/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sedited/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sedited/subscriptions",
        "organizations_url": "https://api.github.com/users/sedited/orgs",
        "repos_url": "https://api.github.com/users/sedited/repos",
        "events_url": "https://api.github.com/users/sedited/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sedited/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T03:51:00Z"
    },
    {
      "event": "subscribed",
      "id": 21209607937,
      "node_id": "SE_lADOABII587aXRXHzwAAAATwMO8B",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21209607937",
      "actor": {
        "login": "sedited",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sedited",
        "html_url": "https://github.com/sedited",
        "followers_url": "https://api.github.com/users/sedited/followers",
        "following_url": "https://api.github.com/users/sedited/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sedited/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sedited/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sedited/subscriptions",
        "organizations_url": "https://api.github.com/users/sedited/orgs",
        "repos_url": "https://api.github.com/users/sedited/repos",
        "events_url": "https://api.github.com/users/sedited/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sedited/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-27T03:51:00Z"
    },
    {
      "event": "reviewed",
      "id": 3522167537,
      "node_id": "PRR_kwDOABII587R8ALx",
      "url": null,
      "actor": null,
      "commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-30T19:38:02Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "billymcbip",
        "id": 245003547,
        "node_id": "U_kgDODpp1Gw",
        "avatar_url": "https://avatars.githubusercontent.com/u/245003547?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/billymcbip",
        "html_url": "https://github.com/billymcbip",
        "followers_url": "https://api.github.com/users/billymcbip/followers",
        "following_url": "https://api.github.com/users/billymcbip/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/billymcbip/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/billymcbip/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/billymcbip/subscriptions",
        "organizations_url": "https://api.github.com/users/billymcbip/orgs",
        "repos_url": "https://api.github.com/users/billymcbip/repos",
        "events_url": "https://api.github.com/users/billymcbip/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/billymcbip/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#pullrequestreview-3522167537",
      "submitted_at": "2025-11-30T19:38:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33943"
    },
    {
      "event": "reviewed",
      "id": 3522187607,
      "node_id": "PRR_kwDOABII587R8FFX",
      "url": null,
      "actor": null,
      "commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-30T19:47:22Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "billymcbip",
        "id": 245003547,
        "node_id": "U_kgDODpp1Gw",
        "avatar_url": "https://avatars.githubusercontent.com/u/245003547?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/billymcbip",
        "html_url": "https://github.com/billymcbip",
        "followers_url": "https://api.github.com/users/billymcbip/followers",
        "following_url": "https://api.github.com/users/billymcbip/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/billymcbip/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/billymcbip/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/billymcbip/subscriptions",
        "organizations_url": "https://api.github.com/users/billymcbip/orgs",
        "repos_url": "https://api.github.com/users/billymcbip/repos",
        "events_url": "https://api.github.com/users/billymcbip/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/billymcbip/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#pullrequestreview-3522187607",
      "submitted_at": "2025-11-30T19:47:22Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33943"
    },
    {
      "event": "reviewed",
      "id": 3537340582,
      "node_id": "PRR_kwDOABII587S14im",
      "url": null,
      "actor": null,
      "commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-04T00:03:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "> but not sure about adding more error handling surface to the API with the current approach\r\n\r\nOne design goal of this PR was to minimize increasing the error handling surface while achieving the goal of making these functions more testable, but it seems like the current solution is not striking the right balance. I'm converting this PR to draft while I'm exploring other options, including implementing (global or local) error/illegal callbacks similar to secp256k1 (but that would be a pretty big overhaul). Thank you for the quick reviews and feedback everyone.\r\n\r\n---\r\n\r\n> the PR itself as it currently stands provides the counter argument for it - an out of bounds case is still added and handled by the respective language wrapper\r\n\r\nI see your point, but I think there is a difference between a language wrapper converting a documented return value into an exception and the language wrapper having to duplicate the implementation details.\r\n\r\n> I also don't understand why the change here should make cross-bindings tests easier.\r\n\r\nThe C API itself should also be testable by the cross-bindings test suite, and on `master` it would just crash with an assertion error. Additionally, the cross-bindings test suite defines expected return values or exceptions (e.g. based on `btck_` status codes), but `assert` is neither. Of course, the test suite could define its own exceptions/codes that are not part of the interface, but I think the tests should only cover the public interface. A language binding that covers the entire interface should be able to pass the tests without implementing additional logic. See also my comment [here](https://github.com/stringintech/kernel-bindings-tests/issues/5#issuecomment-3589415935).",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#pullrequestreview-3537340582",
      "submitted_at": "2025-12-04T00:03:41Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33943"
    },
    {
      "event": "convert_to_draft",
      "id": 21345555196,
      "node_id": "CTDE_lADOABII587aXRXHzwAAAAT4S1L8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21345555196",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-04T00:03:50Z"
    },
    {
      "event": "project_v2_item_status_changed",
      "id": 21548700759,
      "node_id": "PVTISC_lADOABII587aXRXHzwAAAAUEZxRX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21548700759",
      "actor": {
        "login": "sedited",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sedited",
        "html_url": "https://github.com/sedited",
        "followers_url": "https://api.github.com/users/sedited/followers",
        "following_url": "https://api.github.com/users/sedited/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sedited/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sedited/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sedited/subscriptions",
        "organizations_url": "https://api.github.com/users/sedited/orgs",
        "repos_url": "https://api.github.com/users/sedited/repos",
        "events_url": "https://api.github.com/users/sedited/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sedited/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-14T13:08:12Z"
    },
    {
      "event": "labeled",
      "id": 21766475745,
      "node_id": "LE_lADOABII587aXRXHzwAAAAURYg_h",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21766475745",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-27T17:42:53Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3694119424,
      "node_id": "IC_kwDOABII587cL8oA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3694119424",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-27T17:42:54Z",
      "updated_at": "2025-12-27T17:42:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\nðŸ™ This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#issuecomment-3694119424",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33943"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2561205810",
      "pull_request_review_id": 3506576732,
      "id": 2561205810,
      "node_id": "PRRC_kwDOABII586YqOYy",
      "diff_hunk": "@@ -615,33 +622,45 @@ int btck_script_pubkey_verify(const btck_ScriptPubkey* script_pubkey,\n                               const btck_ScriptVerificationFlags flags,\n                               btck_ScriptVerifyStatus* status)\n {\n-    // Assert that all specified flags are part of the interface before continuing\n-    assert((flags & ~btck_ScriptVerificationFlags_ALL) == 0);\n+    constexpr auto INVALID_REQUEST{-1};\n+    constexpr auto INVALID_SCRIPT{0};\n+    constexpr auto VALID_SCRIPT{1};\n+",
      "path": "src/kernel/bitcoinkernel.cpp",
      "position": 36,
      "original_position": 36,
      "commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "original_commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "in_reply_to_id": null,
      "user": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I find this a bit inconsistent with this enum :\r\n\r\n```C\r\ntypedef uint8_t btck_ValidationMode;\r\n#define btck_ValidationMode_VALID ((btck_ValidationMode)(0))\r\n#define btck_ValidationMode_INVALID ((btck_ValidationMode)(1))\r\n#define btck_ValidationMode_INTERNAL_ERROR ((btck_ValidationMode)(2))\r\n```\r\nWhere `validationmode` runs from 0 to 2 and 2 is the internal error.\r\n\r\nAlso isn't it better to expose this as an ENUM so that it can be re-used by the handlers ? (not sure because of the single use) \r\n\r\n~~Or remove the int and use ScriptValidationFlag as return to be more in line with #33856 https://github.com/bitcoin/bitcoin/pull/33856/files#diff-8e83b7ea1d1a8ee1f496f2fda01436ba62b7ad926d1c61386a049d6ef392f71eR1052~~\r\n\r\nEDIT: Kinda changed my view on this issue, \"removed\" option 3",
      "created_at": "2025-11-25T19:48:13Z",
      "updated_at": "2025-11-27T10:51:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#discussion_r2561205810",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2561205810"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33943"
        }
      },
      "start_line": 625,
      "original_start_line": 625,
      "start_side": "RIGHT",
      "line": 628,
      "original_line": 628,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2574646699",
      "pull_request_review_id": 3522167537,
      "id": 2574646699,
      "node_id": "PRRC_kwDOABII586Zdf2r",
      "diff_hunk": "@@ -615,33 +622,45 @@ int btck_script_pubkey_verify(const btck_ScriptPubkey* script_pubkey,\n                               const btck_ScriptVerificationFlags flags,\n                               btck_ScriptVerifyStatus* status)\n {\n-    // Assert that all specified flags are part of the interface before continuing\n-    assert((flags & ~btck_ScriptVerificationFlags_ALL) == 0);\n+    constexpr auto INVALID_REQUEST{-1};\n+    constexpr auto INVALID_SCRIPT{0};\n+    constexpr auto VALID_SCRIPT{1};\n+\n+    if ((flags & ~btck_ScriptVerificationFlags_ALL) != 0) {\n+        LogError(\"Specified flag(s) are not part of the interface.\");\n+        return INVALID_REQUEST;\n+    }\n \n     if (!is_valid_flag_combination(script_verify_flags::from_int(flags))) {\n         if (status) *status = btck_ScriptVerifyStatus_ERROR_INVALID_FLAGS_COMBINATION;\n-        return 0;\n+        return INVALID_SCRIPT;",
      "path": "src/kernel/bitcoinkernel.cpp",
      "position": 45,
      "original_position": 45,
      "commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "original_commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "in_reply_to_id": null,
      "user": {
        "login": "billymcbip",
        "id": 245003547,
        "node_id": "U_kgDODpp1Gw",
        "avatar_url": "https://avatars.githubusercontent.com/u/245003547?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/billymcbip",
        "html_url": "https://github.com/billymcbip",
        "followers_url": "https://api.github.com/users/billymcbip/followers",
        "following_url": "https://api.github.com/users/billymcbip/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/billymcbip/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/billymcbip/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/billymcbip/subscriptions",
        "organizations_url": "https://api.github.com/users/billymcbip/orgs",
        "repos_url": "https://api.github.com/users/billymcbip/repos",
        "events_url": "https://api.github.com/users/billymcbip/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/billymcbip/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "You're also validating flags here. Wouldn't `INVALID_REQUEST` be more appropriate?",
      "created_at": "2025-11-30T19:38:02Z",
      "updated_at": "2025-11-30T19:38:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#discussion_r2574646699",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2574646699"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33943"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 636,
      "original_line": 636,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2574667690",
      "pull_request_review_id": 3522187607,
      "id": 2574667690,
      "node_id": "PRRC_kwDOABII586Zdk-q",
      "diff_hunk": "@@ -516,7 +516,10 @@ size_t btck_transaction_count_outputs(const btck_Transaction* transaction)\n const btck_TransactionOutput* btck_transaction_get_output_at(const btck_Transaction* transaction, size_t output_index)\n {\n     const CTransaction& tx = *btck_Transaction::get(transaction);\n-    assert(output_index < tx.vout.size());\n+    if (output_index >= tx.vout.size()) {\n+        LogError(\"output_index is out of bounds.\");\n+        return nullptr;",
      "path": "src/kernel/bitcoinkernel.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "original_commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "in_reply_to_id": null,
      "user": {
        "login": "billymcbip",
        "id": 245003547,
        "node_id": "U_kgDODpp1Gw",
        "avatar_url": "https://avatars.githubusercontent.com/u/245003547?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/billymcbip",
        "html_url": "https://github.com/billymcbip",
        "followers_url": "https://api.github.com/users/billymcbip/followers",
        "following_url": "https://api.github.com/users/billymcbip/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/billymcbip/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/billymcbip/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/billymcbip/subscriptions",
        "organizations_url": "https://api.github.com/users/billymcbip/orgs",
        "repos_url": "https://api.github.com/users/billymcbip/repos",
        "events_url": "https://api.github.com/users/billymcbip/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/billymcbip/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Noob question: How come you're not throwing directly in this function (`throw std::out_of_range(\"output_index is out of bounds\"`)?",
      "created_at": "2025-11-30T19:47:22Z",
      "updated_at": "2025-11-30T19:47:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#discussion_r2574667690",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2574667690"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33943"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 521,
      "original_line": 521,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2586951045",
      "pull_request_review_id": 3537340582,
      "id": 2586951045,
      "node_id": "PRRC_kwDOABII586aMb2F",
      "diff_hunk": "@@ -516,7 +516,10 @@ size_t btck_transaction_count_outputs(const btck_Transaction* transaction)\n const btck_TransactionOutput* btck_transaction_get_output_at(const btck_Transaction* transaction, size_t output_index)\n {\n     const CTransaction& tx = *btck_Transaction::get(transaction);\n-    assert(output_index < tx.vout.size());\n+    if (output_index >= tx.vout.size()) {\n+        LogError(\"output_index is out of bounds.\");\n+        return nullptr;",
      "path": "src/kernel/bitcoinkernel.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "original_commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "in_reply_to_id": 2574667690,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The API is in C, and C doesn't have exceptions, so we have to make sure no exceptions cross the C++/C boundary.",
      "created_at": "2025-12-03T23:44:14Z",
      "updated_at": "2025-12-04T00:03:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#discussion_r2586951045",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2586951045"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33943"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 521,
      "original_line": 521,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2586954327",
      "pull_request_review_id": 3537340582,
      "id": 2586954327,
      "node_id": "PRRC_kwDOABII586aMcpX",
      "diff_hunk": "@@ -615,33 +622,45 @@ int btck_script_pubkey_verify(const btck_ScriptPubkey* script_pubkey,\n                               const btck_ScriptVerificationFlags flags,\n                               btck_ScriptVerifyStatus* status)\n {\n-    // Assert that all specified flags are part of the interface before continuing\n-    assert((flags & ~btck_ScriptVerificationFlags_ALL) == 0);\n+    constexpr auto INVALID_REQUEST{-1};\n+    constexpr auto INVALID_SCRIPT{0};\n+    constexpr auto VALID_SCRIPT{1};\n+",
      "path": "src/kernel/bitcoinkernel.cpp",
      "position": 36,
      "original_position": 36,
      "commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "original_commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "in_reply_to_id": 2561205810,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think you're right that there is no strict consistency wrt return codes in the API, and that's also why I defined the status codes inside the function rather than in the header. A function-specific enum like `btck_ScriptPubkeyVerifyResult` could be an alternative, though. I didn't do it to minimize overhead, but am open to doing that if preferred.",
      "created_at": "2025-12-03T23:46:35Z",
      "updated_at": "2025-12-04T00:03:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#discussion_r2586954327",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2586954327"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33943"
        }
      },
      "start_line": 625,
      "original_start_line": 625,
      "start_side": "RIGHT",
      "line": 628,
      "original_line": 628,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2586957013",
      "pull_request_review_id": 3537340582,
      "id": 2586957013,
      "node_id": "PRRC_kwDOABII586aMdTV",
      "diff_hunk": "@@ -615,33 +622,45 @@ int btck_script_pubkey_verify(const btck_ScriptPubkey* script_pubkey,\n                               const btck_ScriptVerificationFlags flags,\n                               btck_ScriptVerifyStatus* status)\n {\n-    // Assert that all specified flags are part of the interface before continuing\n-    assert((flags & ~btck_ScriptVerificationFlags_ALL) == 0);\n+    constexpr auto INVALID_REQUEST{-1};\n+    constexpr auto INVALID_SCRIPT{0};\n+    constexpr auto VALID_SCRIPT{1};\n+\n+    if ((flags & ~btck_ScriptVerificationFlags_ALL) != 0) {\n+        LogError(\"Specified flag(s) are not part of the interface.\");\n+        return INVALID_REQUEST;\n+    }\n \n     if (!is_valid_flag_combination(script_verify_flags::from_int(flags))) {\n         if (status) *status = btck_ScriptVerifyStatus_ERROR_INVALID_FLAGS_COMBINATION;\n-        return 0;\n+        return INVALID_SCRIPT;",
      "path": "src/kernel/bitcoinkernel.cpp",
      "position": 45,
      "original_position": 45,
      "commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "original_commit_id": "5ccd6a1d3879116ab43e354329c72742bab76c96",
      "in_reply_to_id": 2574646699,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I'm keeping the behaviour as-is as the default stance, but yes, I'm also not 100% sure on the boundary between `INVALID_REQUEST` and `INVALID_SCRIPT` here. I mention this at the end of the PR description, too. I'd like to understand that rationale better - perhaps @sedited can chime in?",
      "created_at": "2025-12-03T23:48:24Z",
      "updated_at": "2025-12-04T00:03:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33943#discussion_r2586957013",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2586957013"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33943"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 636,
      "original_line": 636,
      "side": "RIGHT"
    }
  ]
}