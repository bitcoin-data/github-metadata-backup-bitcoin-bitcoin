{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636",
    "id": 2918962844,
    "node_id": "PR_kwDOABII586t-9ac",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/33636",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/33636.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/33636.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33636",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33636/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/217dbbbb5e38ab582ee0b3ef37fe9e99d887d7c8",
    "number": 33636,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "wallet: Expand MuSig test coverage and follow-ups",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "This is a follow-up to #29675 and primarily adds test coverage for some of the most prominent failure cases in the last commit. \r\n\r\nThe following commits address a few left-over nit comments that didn't make it in before merge.",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      }
    ],
    "milestone": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/74",
      "html_url": "https://github.com/bitcoin/bitcoin/milestone/74",
      "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/74/labels",
      "id": 12610874,
      "node_id": "MI_kwDOABII584AwG06",
      "number": 74,
      "state": "open",
      "title": "31.0",
      "creator": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "open_issues": 13,
      "closed_issues": 21,
      "created_at": "2025-03-25T18:44:16Z",
      "updated_at": "2025-12-23T01:15:04Z"
    },
    "created_at": "2025-10-16T00:02:51Z",
    "updated_at": "2025-12-23T01:15:04Z",
    "closed_at": "2025-12-23T01:15:04Z",
    "mergeable_state": "unknown",
    "merged": true,
    "merged_at": "2025-12-23T01:15:04Z",
    "merged_by": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "merge_commit_sha": "d861c3820528fad2e17a45549bec70b6ba434dcc",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "head": {
      "label": "fjahr:202510-musig-test",
      "ref": "202510-musig-test",
      "sha": "217dbbbb5e38ab582ee0b3ef37fe9e99d887d7c8",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 196253948,
        "node_id": "MDEwOlJlcG9zaXRvcnkxOTYyNTM5NDg=",
        "name": "bitcoin",
        "full_name": "fjahr/bitcoin",
        "owner": {
          "login": "fjahr",
          "id": 1322187,
          "node_id": "MDQ6VXNlcjEzMjIxODc=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/fjahr",
          "html_url": "https://github.com/fjahr",
          "followers_url": "https://api.github.com/users/fjahr/followers",
          "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
          "organizations_url": "https://api.github.com/users/fjahr/orgs",
          "repos_url": "https://api.github.com/users/fjahr/repos",
          "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/fjahr/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/fjahr/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/fjahr/bitcoin",
        "archive_url": "https://api.github.com/repos/fjahr/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/fjahr/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/fjahr/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/fjahr/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/fjahr/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/fjahr/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/fjahr/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/fjahr/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/fjahr/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/fjahr/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/fjahr/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/fjahr/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/fjahr/bitcoin/events",
        "forks_url": "https://api.github.com/repos/fjahr/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/fjahr/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/fjahr/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/fjahr/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/fjahr/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/fjahr/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/fjahr/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/fjahr/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/fjahr/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/fjahr/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/fjahr/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/fjahr/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/fjahr/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/fjahr/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/fjahr/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/fjahr/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:fjahr/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/fjahr/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/fjahr/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/fjahr/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/fjahr/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/fjahr/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/fjahr/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/fjahr/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/fjahr/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/fjahr/bitcoin/hooks",
        "svn_url": "https://github.com/fjahr/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 4,
        "watchers_count": 4,
        "size": 284229,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-11-27T00:04:15Z",
        "created_at": "2019-07-10T18:11:06Z",
        "updated_at": "2024-07-23T22:14:45Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "d5ed4ba9d8627f1897322ce7eb5b34e08e4f73ac",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38385,
        "stargazers_count": 87331,
        "watchers_count": 87331,
        "size": 300955,
        "default_branch": "master",
        "open_issues_count": 726,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-12-23T01:15:02Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-12-23T01:15:11Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 147,
    "deletions": 54,
    "changed_files": 5,
    "commits": 4,
    "review_comments": 12,
    "comments": 6
  },
  "events": [
    {
      "event": "labeled",
      "id": 20307299378,
      "node_id": "LE_lADOABII587RzUV_zwAAAAS6aMwy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20307299378",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-16T00:02:55Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "commented",
      "id": 3408680288,
      "node_id": "IC_kwDOABII587LLFVg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3408680288",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-16T00:02:57Z",
      "updated_at": "2025-12-23T01:04:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33636.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [rkrux](https://github.com/bitcoin/bitcoin/pull/33636#pullrequestreview-3510456391), [achow101](https://github.com/bitcoin/bitcoin/pull/33636#issuecomment-3684688010) |\n\nIf your review is incorrectly listed, please copy-paste <code>&lt;!--meta-tag:bot-skip--&gt;</code> into the comment that the bot should ignore.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#issuecomment-3408680288",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33636"
    },
    {
      "event": "milestoned",
      "id": 20323176344,
      "node_id": "MIE_lADOABII587RzUV_zwAAAAS7Ww-Y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/20323176344",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-10-16T16:14:16Z",
      "milestone": {
        "title": "31.0"
      }
    },
    {
      "event": "reviewed",
      "id": 3350082420,
      "node_id": "PRR_kwDOABII587HrjN0",
      "url": null,
      "actor": null,
      "commit_id": "73a5d9315340942f030e6586c640b9240498f8ac",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-10-17T14:33:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK 73a5d9315340942f030e6586c640b9240498f8ac\r\n\r\nAdds more functional tests that are preferred.\r\nI also like the last commit 73a5d9315340942f030e6586c640b9240498f8ac quite a lot, thanks for adding it.",
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#pullrequestreview-3350082420",
      "submitted_at": "2025-10-17T14:33:44Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
    },
    {
      "event": "commented",
      "id": 3555082242,
      "node_id": "IC_kwDOABII587T5kAC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3555082242",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-19T23:36:24Z",
      "updated_at": "2025-11-19T23:36:24Z",
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#issuecomment-3555082242",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33636"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBmN2YwNjkyY2ExZTYwMjMxY2Q3YmE2NWFhMzYwNmM4ZGEzM2FmY2E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0f7f0692ca1e60231cd7ba65aa3606c8da33afca",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0f7f0692ca1e60231cd7ba65aa3606c8da33afca",
      "tree": {
        "sha": "5096fae5bd5684091ee6b57d2645567b3e3155fd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5096fae5bd5684091ee6b57d2645567b3e3155fd"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 5096fae5bd5684091ee6b57d2645567b3e3155fd\nparent a07bd8415df40db07b4f5aef5ac6c55c62d370e5\nauthor Fabian Jahr <fjahr@protonmail.com> 1760567842 +0200\ncommitter Fabian Jahr <fjahr@protonmail.com> 1764006523 +0100\n\nmusig: Move MUSIG_CHAINCODE to musig.cpp\n\nThis is the only place where it is used.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmkkmnsVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jN9csP/R09TCXQkxiMJfjeL0zqYEyuXL6d\nXlIXtOnXgqNJzFiSobaOPwlJb5OAmVEdNfbjWk9TR28pZjLPIlauRkq9/Ah8PH3K\nEE3X+6hAhd0x4nh310qhnj9IJBkvmkAWEosED+97vS99tjbBmgt678vJGCtuSrc3\nQ3aPZ0j9ggJEKkei4VW8ihHxr3HAEnqXzUpyY+sAG5WtEOlw+6ux8JniutCEzr0K\n7mCEk2e4NRFS18FraJXHH7IN+QqI7Uz+5h8C5EN12leT8EZptDyY/UnLU+HJDfpS\njmjr3U6/KNwqPthmSab7vY9O2DuYbeG16fLbyWB/S1iZxxcXmppXNXYq9lLaXwE1\n6x78qP1FJXVuv6KgutwMXEaDclbukdnSCHyxTlzNf84fFuQmbErZZjUoYqojbZln\n20lcXl3eyL5hL5tXyJbN/33yYeqAAHOJ4Sww/qhlLQ5Tx39QwZmLNhXEnQq8BmNe\nM/nuMv3EAi28VIxbJgqwmh7/wNNAbXjnUqfkapTPUHJTmIRLRkhfg9ZyBDLh2Omk\nfyeSaRTlMQd/zLpxxFn++zmo1fMwWaG9c1SlStHJLBgxggJjrm9D9AYi9yNNLFL4\nzTIHXH9B0rO8E12gP1dBN6H8oRQ1oLBRpBVmqOduPN56TSt942FHIOwOIebH93WQ\n1I2Dkwa2HFK78/6m\n=iZG6\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a07bd8415df40db07b4f5aef5ac6c55c62d370e5",
          "sha": "a07bd8415df40db07b4f5aef5ac6c55c62d370e5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a07bd8415df40db07b4f5aef5ac6c55c62d370e5"
        }
      ],
      "message": "musig: Move MUSIG_CHAINCODE to musig.cpp\n\nThis is the only place where it is used.",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-11-24T17:48:43Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-10-15T22:37:22Z"
      },
      "sha": "0f7f0692ca1e60231cd7ba65aa3606c8da33afca"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU3NTU2MTRiZTU4Njk5OTIwNmZlNzNiMjFhZGZhOGI1ZjhkZDAzNjA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e755614be586999206fe73b21adfa8b5f8dd0360",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e755614be586999206fe73b21adfa8b5f8dd0360",
      "tree": {
        "sha": "c492c7427238d953de87af86e19bf344175ca41b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c492c7427238d953de87af86e19bf344175ca41b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree c492c7427238d953de87af86e19bf344175ca41b\nparent 0f7f0692ca1e60231cd7ba65aa3606c8da33afca\nauthor Fabian Jahr <fjahr@protonmail.com> 1760568530 +0200\ncommitter Fabian Jahr <fjahr@protonmail.com> 1764006523 +0100\n\nsign: Remove duplicate sigversion check\n\nAlso improves documentation in the SignMuSig2 function.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmkkmnsVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNKfgP/2rVdeb1t4cyLsrLm8+1BJ/FnYZZ\nnAg1H4k9qvrfB3SLldLQ1OZJLhwFJiunmZlgvqN2igLYDEiX0b3EhsXzr/T9em6C\nLAxgoBi973N1p6RxLn1Zte59/saKsjBYEKBYvI9xJzAIjdGnrYsFPKL4dMas3pJ2\n6yQd+XlVK6STJS8mjmWq+FFaOYCqDlGJ1xKZ/mTJjxz6+XCqz1Xn8ktIwUnCqp9d\nlS8yVbPAYaHRIj3WG2KdQBD83BzBnhvGoWKVfxhhlD/u/F/3WGDjvALVoiYTJRDg\nhpKJYPFYhPA6EiHcjfFYYb+1Dt7XxGnR+I5RIOqoTE8hJlNfIuMlHwcTkniGTUXM\nqGdnYZY2tusiGpmG233dnWvacbOQpFAQF34IF3y1hIxaVpAKe+vH/VMdREA162NJ\nxs75by03u9HTPCwtZZlFXFbVKEsjTxU1LKCyAUYB5c1uz8ijUBwgZZ2kS2zk3kz8\njfIuBBodSXOoZch8wtpoeQCRqQycBWBBT82mKADcRwcD5Co4yLxPLmAGtZmieQ4A\nDTXPcRVXJfvbH+K+xGIqAMlVI+rKXpSpxIMusmrCepeR8PCFkk/ydvFHeyJOlBle\n6L1q3LyJ3TvoUl1xQyL4MFRY5dUhbgLG2B7dswnLYg0xc0Y/wi3hHy4kFYrBV4s3\nGAWlmIH+Tf8UfWJZ\n=lffu\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0f7f0692ca1e60231cd7ba65aa3606c8da33afca",
          "sha": "0f7f0692ca1e60231cd7ba65aa3606c8da33afca",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0f7f0692ca1e60231cd7ba65aa3606c8da33afca"
        }
      ],
      "message": "sign: Remove duplicate sigversion check\n\nAlso improves documentation in the SignMuSig2 function.",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-11-24T17:48:43Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-10-15T22:48:50Z"
      },
      "sha": "e755614be586999206fe73b21adfa8b5f8dd0360"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM5NTE5YzI2MGI3YTEzZDJhODEwNGZmOTg0MjIwNTY1NWFhNjVhY2U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c9519c260b7a13d2a8104ff9842205655aa65ace",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c9519c260b7a13d2a8104ff9842205655aa65ace",
      "tree": {
        "sha": "e9985c4b52d6701ac95559087538454aeae99f1a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e9985c4b52d6701ac95559087538454aeae99f1a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree e9985c4b52d6701ac95559087538454aeae99f1a\nparent e755614be586999206fe73b21adfa8b5f8dd0360\nauthor Fabian Jahr <fjahr@protonmail.com> 1760572431 +0200\ncommitter Fabian Jahr <fjahr@protonmail.com> 1764006523 +0100\n\nmusig: Check session id reuse\n\nPrevent saving another secnonce to the same session id since this might make nonce reuse possible.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmkkmnsVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNBaAP/Ayh13R/my0MUy+Ux1oXwGtmB5+K\nVBPU7NyTPwBO2IuFYBJSVQCqZ3ZtOotjyJwGtqib5OZQVz6NA2H2FAuCtCGW0Ucy\nzabxErfS2ssMVNHGmLVDmJPMeN9oe0RfQv5Qn4faOBZGedZ7/ExJLxPKgfs5slD9\nxZVR9scDRVR9QYnZxuwT+OIJtFC1wRZ+7m6YUqF8b7hbm7h45JhC8D+KGn8P/VOl\ngufiH7szAS5yCQ0JD826+TiLan/E1+PTeQnGonpIL1yT/zJIugVYHhW17P062bs4\nSbat5xUYX+4tHMfXAtiARt4I0yjaeexBFXOEIxAHUbMX5ct0Qx5DPook+AlriFz2\nhj8+KJMqQfsN/oVy631oU+gf1oKgRFYWx499qEckVEovTAOtXaeigRx+TgzvkVfI\nRf/Pabg2pJpmPoPwR1bJvP645YabJSMl3SKcZklSGgy5O5dhR2wnNe1AYFGr2bHb\nii9jJVC1f5Ctr94I1ilrsftWQ444n+kLm3fvX4gEzzRo52UqI1hb5iREHv/HkFpR\n9J5vEqGQIy0RXA//gAY+jmXA80jPE/EpfbpkGyW2S4XEadVqKiO3fbJpD0Z1Enzw\n4LLMZtf/YhglGUY5HOLut4BpM1M7ZeIqbewh1QRqv0Y3FXGW0nnm6IKqHnExMgs6\nwjUQ0ASVs9zhTs71\n=QyVn\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e755614be586999206fe73b21adfa8b5f8dd0360",
          "sha": "e755614be586999206fe73b21adfa8b5f8dd0360",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e755614be586999206fe73b21adfa8b5f8dd0360"
        }
      ],
      "message": "musig: Check session id reuse\n\nPrevent saving another secnonce to the same session id since this might make nonce reuse possible.",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-11-24T17:48:43Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-10-15T23:53:51Z"
      },
      "sha": "c9519c260b7a13d2a8104ff9842205655aa65ace"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21145324216,
      "node_id": "HRFPE_lADOABII587RzUV_zwAAAATsXAq4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21145324216",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b7215893e566dec8a085c08e722aa61ec5a2f5a0",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/b7215893e566dec8a085c08e722aa61ec5a2f5a0",
      "created_at": "2025-11-24T17:52:25Z"
    },
    {
      "event": "commented",
      "id": 3572052555,
      "node_id": "IC_kwDOABII587U6TJL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3572052555",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-24T17:59:00Z",
      "updated_at": "2025-11-24T17:59:00Z",
      "author_association": "CONTRIBUTOR",
      "body": "Addressed the feedback from @rkrux , thanks for the review!",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#issuecomment-3572052555",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33636"
    },
    {
      "event": "mentioned",
      "id": 21145454861,
      "node_id": "MEE_lADOABII587RzUV_zwAAAATsXgkN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21145454861",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-24T17:59:02Z"
    },
    {
      "event": "subscribed",
      "id": 21145454930,
      "node_id": "SE_lADOABII587RzUV_zwAAAATsXglS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21145454930",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-24T17:59:02Z"
    },
    {
      "event": "reviewed",
      "id": 3503877587,
      "node_id": "PRR_kwDOABII587Q2O3T",
      "url": null,
      "actor": null,
      "commit_id": "b7215893e566dec8a085c08e722aa61ec5a2f5a0",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-25T08:45:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for accepting the refactoring suggestions!",
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#pullrequestreview-3503877587",
      "submitted_at": "2025-11-25T08:45:50Z",
      "state": "CHANGES_REQUESTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDIxN2RiYmJiNWUzOGFiNTgyZWUwYjNlZjM3ZmU5ZTk5ZDg4N2Q3Yzg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/217dbbbb5e38ab582ee0b3ef37fe9e99d887d7c8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/217dbbbb5e38ab582ee0b3ef37fe9e99d887d7c8",
      "tree": {
        "sha": "f71faff8588fd819351bb1cda775eab0aac7b8ab",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f71faff8588fd819351bb1cda775eab0aac7b8ab"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree f71faff8588fd819351bb1cda775eab0aac7b8ab\nparent c9519c260b7a13d2a8104ff9842205655aa65ace\nauthor Fabian Jahr <fjahr@protonmail.com> 1759346602 +0200\ncommitter Fabian Jahr <fjahr@protonmail.com> 1764112961 +0100\n\ntest: Add musig failure scenarios\n\nAlso changes the the non-constant variable NUM_WALLETS to lower case and\nrefactors the success case scenarios to reuse existing code.\n\nCo-authored-by: rkrux <rkrux.connect@gmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmkmOkQVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNRf8QAIeZazkYKGEB43f2XkdOVAGQ6L/H\n2wmUAmPRZ2a/dh2fq/1k6VtcWVodfgNM+ouAVCqXh9HWytb6C+pVEwq65/B2XYnS\n2H689wk4lqKge3j2BYk8ACAzOtLrMy64M55KrfkdmpCZiR20SWS2a1Z4OGUL5Nd+\npmisA+/GoRAdrJh7xsFFcUewPfcJ6J30vEBrwemgxvSt1rpk92cgFoH+vOclnbEw\nR6zJTws4AWYzA23RwmPBYtuyXIdH6tr45EpXIa7yJc30hbhZZXoi+WX2pn6MurkC\n33DNcaLZCgAAMFB7fQJR20M4+KZ+lULAZr3b042LGjVBXsq+geUd5r5pzix4SzXy\nhDmVpPCODvFWLs+gpuKtJcp97qZ/oBFEOwWo8++/k/jeAJvFpICmwCTbn85GeH0s\nWtI9J+R2DU9J+h6ZiO9ItvauSbu7a3NgW8QB+b1yDEqV4HjOopyMMsGzhuG/2u+q\ngvaOABNAude6zNQCuy6yFz8dSxw8hycZOFDxdbbPU5HussUgIxXkoes5u8pf3tHx\nU8CFvzSvL2+zjw07WuyHkBBoJnAVY/gnVCJgFs3HHjz/OuifHcev+yG0/IuhqcQJ\nOeW1NhRiCeSLIx+cvBqv5watfBkuXNNt//yoxaDI1EdVC50m+v4IgwiZl+4fo2Qf\nlwREklKwiIPhLpP5\n=qCzd\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c9519c260b7a13d2a8104ff9842205655aa65ace",
          "sha": "c9519c260b7a13d2a8104ff9842205655aa65ace",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c9519c260b7a13d2a8104ff9842205655aa65ace"
        }
      ],
      "message": "test: Add musig failure scenarios\n\nAlso changes the the non-constant variable NUM_WALLETS to lower case and\nrefactors the success case scenarios to reuse existing code.\n\nCo-authored-by: rkrux <rkrux.connect@gmail.com>",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-11-25T23:22:41Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-10-01T19:23:22Z"
      },
      "sha": "217dbbbb5e38ab582ee0b3ef37fe9e99d887d7c8"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21176325581,
      "node_id": "HRFPE_lADOABII587RzUV_zwAAAATuNRXN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21176325581",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "217dbbbb5e38ab582ee0b3ef37fe9e99d887d7c8",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/217dbbbb5e38ab582ee0b3ef37fe9e99d887d7c8",
      "created_at": "2025-11-25T23:22:52Z"
    },
    {
      "event": "reviewed",
      "id": 3510456391,
      "node_id": "PRR_kwDOABII587RPVBH",
      "url": null,
      "actor": null,
      "commit_id": "217dbbbb5e38ab582ee0b3ef37fe9e99d887d7c8",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-11-26T11:25:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "lgtm ACK 217dbbb\n\nThanks for accepting all the suggestions.",
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#pullrequestreview-3510456391",
      "submitted_at": "2025-11-26T11:25:46Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
    },
    {
      "event": "review_requested",
      "id": 21193109350,
      "node_id": "RRE_lADOABII587RzUV_zwAAAATvNS9m",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21193109350",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-26T11:25:50Z",
      "requested_reviewer": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      }
    },
    {
      "event": "commented",
      "id": 3580889312,
      "node_id": "IC_kwDOABII587VcAjg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3580889312",
      "actor": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-26T11:31:55Z",
      "updated_at": "2025-11-26T11:31:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "In PR description:\r\n\r\n```diff\r\n- primarily adds test coverage for some of the most prominent failure cases in the first commit.\r\n+ primarily adds test coverage for some of the most prominent failure cases in the last commit.\r\n``` ",
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#issuecomment-3580889312",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33636"
    },
    {
      "event": "commented",
      "id": 3581563308,
      "node_id": "IC_kwDOABII587VelGs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3581563308",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-11-26T14:26:05Z",
      "updated_at": "2025-11-26T14:26:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "> In PR description:\r\n> \r\n> ```diff\r\n> - primarily adds test coverage for some of the most prominent failure cases in the first commit.\r\n> + primarily adds test coverage for some of the most prominent failure cases in the last commit.\r\n> ```\r\n\r\nFixed as well",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#issuecomment-3581563308",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33636"
    },
    {
      "event": "commented",
      "id": 3684688010,
      "node_id": "IC_kwDOABII587bn-CK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3684688010",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-23T01:04:20Z",
      "updated_at": "2025-12-23T01:04:20Z",
      "author_association": "MEMBER",
      "body": "ACK 217dbbbb5e38ab582ee0b3ef37fe9e99d887d7c8",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#issuecomment-3684688010",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33636"
    },
    {
      "event": "merged",
      "id": 21715846978,
      "node_id": "ME_lADOABII587RzUV_zwAAAAUOXYdC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21715846978",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "d861c3820528fad2e17a45549bec70b6ba434dcc",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d861c3820528fad2e17a45549bec70b6ba434dcc",
      "created_at": "2025-12-23T01:15:04Z"
    },
    {
      "event": "closed",
      "id": 21715846996,
      "node_id": "CE_lADOABII587RzUV_zwAAAAUOXYdU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/21715846996",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-23T01:15:04Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2439794359",
      "pull_request_review_id": 3350082420,
      "id": 2439794359,
      "node_id": "PRRC_kwDOABII586RbE63",
      "diff_hunk": "@@ -28,6 +28,178 @@ def set_test_params(self):\n     def skip_test_if_missing_module(self):\n         self.skip_if_no_wallet()\n \n+    def setup_musig_scenario(self, num_wallets=3):\n+        # Miniscript pattern based on number of wallets",
      "path": "test/functional/wallet_musig.py",
      "position": 1,
      "original_position": 5,
      "commit_id": "73a5d9315340942f030e6586c640b9240498f8ac",
      "original_commit_id": "c7c9dc2d8634bc79e76783be113f8d42cee63c6e",
      "in_reply_to_id": null,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In c7c9dc2d8634bc79e76783be113f8d42cee63c6e \"test: Add musig failure scenarios\"\r\n\r\n`Miniscript` pattern or `Multipath` pattern?",
      "created_at": "2025-10-17T12:32:49Z",
      "updated_at": "2025-10-17T14:33:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#discussion_r2439794359",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2439794359"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2439990998",
      "pull_request_review_id": 3350082420,
      "id": 2439990998,
      "node_id": "PRRC_kwDOABII586Rb07W",
      "diff_hunk": "@@ -28,6 +28,178 @@ def set_test_params(self):\n     def skip_test_if_missing_module(self):\n         self.skip_if_no_wallet()\n \n+    def setup_musig_scenario(self, num_wallets=3):\n+        # Miniscript pattern based on number of wallets\n+        placeholders = \",\".join(f\"${i}/<{i};{i+1}>/*\" for i in range(num_wallets))\n+        pattern = f\"rawtr(musig({placeholders}))\"\n+\n+        wallets = []\n+        keys = []\n+\n+        # Create wallets and extract keys\n+        for i in range(num_wallets):\n+            wallet_name = f\"musig_{self.WALLET_NUM}\"\n+            self.WALLET_NUM += 1\n+            self.nodes[0].createwallet(wallet_name)\n+            wallet = self.nodes[0].get_wallet_rpc(wallet_name)\n+            wallets.append(wallet)\n+\n+            for priv_desc in wallet.listdescriptors(True)[\"descriptors\"]:\n+                desc = priv_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                privkey = PRIVKEY_RE.search(desc).group(1)\n+                break\n+            for pub_desc in wallet.listdescriptors()[\"descriptors\"]:\n+                desc = pub_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                pubkey = PUBKEY_RE.search(desc).group(1)\n+                privkey += ORIGIN_PATH_RE.search(pubkey).group(1)\n+                break\n+            keys.append((privkey, pubkey))\n+\n+        # Construct and import descriptors\n+        for i, wallet in enumerate(wallets):\n+            desc = pattern\n+            for j, (priv, pub) in enumerate(keys):\n+                if j == i:\n+                    desc = desc.replace(f\"${j}\", priv)\n+                else:\n+                    desc = desc.replace(f\"${j}\", pub)\n+\n+            import_descs = [{\n+                \"desc\": descsum_create(desc),\n+                \"active\": True,\n+                \"timestamp\": \"now\",\n+            }]\n+\n+            res = wallet.importdescriptors(import_descs)\n+            for r in res:\n+                assert_equal(r[\"success\"], True)\n+\n+        # Fund address\n+        addr = wallets[0].getnewaddress(address_type=\"bech32m\")\n+        for wallet in wallets[1:]:\n+            assert_equal(addr, wallet.getnewaddress(address_type=\"bech32m\"))\n+\n+        self.def_wallet.sendtoaddress(addr, 10)\n+        self.generate(self.nodes[0], 1)\n+\n+        # Create PSBT\n+        utxo = wallets[0].listunspent()[0]\n+        psbt = wallets[0].walletcreatefundedpsbt(\n+            outputs=[{self.def_wallet.getnewaddress(): 5}],\n+            inputs=[utxo],\n+            change_type=\"bech32m\",\n+            changePosition=1\n+        )[\"psbt\"]\n+\n+        return wallets, psbt\n+\n+    def test_musig_failure_modes(self):\n+        \"\"\"Test various MuSig2 failure scenarios\"\"\"\n+\n+        self.log.info(\"Testing missing participant nonce\")\n+        wallets, psbt = self.setup_musig_scenario(num_wallets=3)\n+\n+        # Only 2 out of 3 participants provide nonces\n+        nonce_psbts = []\n+        for i in range(2):\n+            proc = wallets[i].walletprocesspsbt(psbt=psbt)\n+            nonce_psbts.append(proc[\"psbt\"])\n+\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        # Attempt to create partial sigs. This should not complete due to the\n+        # missing nonce.\n+        for wallet in wallets[:2]:\n+            proc = wallet.walletprocesspsbt(psbt=comb_nonce_psbt)\n+            assert_equal(proc[\"complete\"], False)\n+            # No partial sigs are created\n+            dec = self.nodes[0].decodepsbt(proc[\"psbt\"])\n+            # There are still only two nonces\n+            assert_equal(len(dec[\"inputs\"][0].get(\"musig2_pubnonces\", [])), 2)\n+\n+        self.log.info(\"Testing insufficient partial signatures\")\n+        wallets, psbt = self.setup_musig_scenario(num_wallets=3)\n+        nonce_psbts = [w.walletprocesspsbt(psbt=psbt)[\"psbt\"] for w in wallets]\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        # Only 2 out of 3 provide partial sigs\n+        psig_psbts = []\n+        for i in range(2):\n+            proc = wallets[i].walletprocesspsbt(psbt=comb_nonce_psbt)\n+            psig_psbts.append(proc[\"psbt\"])\n+\n+        comb_psig_psbt = self.nodes[0].combinepsbt(psig_psbts)\n+\n+        # Finalization fails due to missing partial sig\n+        finalized = self.nodes[0].finalizepsbt(comb_psig_psbt)\n+        assert_equal(finalized[\"complete\"], False)\n+\n+        # Still only two partial sigs in combined PSBT\n+        dec = self.nodes[0].decodepsbt(comb_psig_psbt)\n+        assert_equal(len(dec[\"inputs\"][0][\"musig2_partial_sigs\"]), 2)\n+\n+        self.log.info(\"Testing mismatched key order\")\n+        wallets = []\n+        keys = []\n+        for i in range(2):\n+            wallet_name = f\"musig_{self.WALLET_NUM}\"\n+            self.WALLET_NUM += 1\n+            self.nodes[0].createwallet(wallet_name)\n+            wallet = self.nodes[0].get_wallet_rpc(wallet_name)\n+            wallets.append(wallet)\n+\n+            for priv_desc in wallet.listdescriptors(True)[\"descriptors\"]:\n+                desc = priv_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                privkey = PRIVKEY_RE.search(desc).group(1)\n+                break\n+            for pub_desc in wallet.listdescriptors()[\"descriptors\"]:\n+                desc = pub_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                pubkey = PUBKEY_RE.search(desc).group(1)\n+                privkey += ORIGIN_PATH_RE.search(pubkey).group(1)\n+                break\n+            keys.append((privkey, pubkey))\n+\n+        desc0 = f\"rawtr(musig({keys[0][0]},{keys[1][1]}))\"\n+        wallets[0].importdescriptors([{\n+            \"desc\": descsum_create(desc0),\n+            \"active\": True,\n+            \"timestamp\": \"now\",\n+        }])\n+\n+        # Reverse order to desc0\n+        desc1 = f\"rawtr(musig({keys[1][0]},{keys[0][1]}))\"\n+        wallets[1].importdescriptors([{\n+            \"desc\": descsum_create(desc1),\n+            \"active\": True,\n+            \"timestamp\": \"now\",\n+        }])\n+\n+        # Addresses should be different due to different key ordering\n+        addr0 = wallets[0].getnewaddress(address_type=\"bech32m\")\n+        addr1 = wallets[1].getnewaddress(address_type=\"bech32m\")\n+        assert addr0 != addr1\n+\n+        self.log.info(\"Testing finalize without partial sigs\")\n+        wallets, psbt = self.setup_musig_scenario(num_wallets=2)\n+        nonce_psbts = [w.walletprocesspsbt(psbt=psbt)[\"psbt\"] for w in wallets]\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        finalized = self.nodes[0].finalizepsbt(comb_nonce_psbt)\n+        assert_equal(finalized[\"complete\"], False)\n+\n+        dec = self.nodes[0].decodepsbt(comb_nonce_psbt)\n+        assert \"musig2_pubnonces\" in dec[\"inputs\"][0]\n+        assert \"musig2_partial_sigs\" not in dec[\"inputs\"][0]\n+\n+",
      "path": "test/functional/wallet_musig.py",
      "position": 1,
      "original_position": 175,
      "commit_id": "73a5d9315340942f030e6586c640b9240498f8ac",
      "original_commit_id": "c7c9dc2d8634bc79e76783be113f8d42cee63c6e",
      "in_reply_to_id": null,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In c7c9dc2d8634bc79e76783be113f8d42cee63c6e \"test: Add musig failure scenarios\"\r\n\r\nNit: extra blank line",
      "created_at": "2025-10-17T13:12:41Z",
      "updated_at": "2025-10-17T14:33:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#discussion_r2439990998",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2439990998"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 202,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2440002764",
      "pull_request_review_id": 3350082420,
      "id": 2440002764,
      "node_id": "PRRC_kwDOABII586Rb3zM",
      "diff_hunk": "@@ -28,6 +28,178 @@ def set_test_params(self):\n     def skip_test_if_missing_module(self):\n         self.skip_if_no_wallet()\n \n+    def setup_musig_scenario(self, num_wallets=3):\n+        # Miniscript pattern based on number of wallets\n+        placeholders = \",\".join(f\"${i}/<{i};{i+1}>/*\" for i in range(num_wallets))\n+        pattern = f\"rawtr(musig({placeholders}))\"\n+\n+        wallets = []\n+        keys = []\n+\n+        # Create wallets and extract keys\n+        for i in range(num_wallets):\n+            wallet_name = f\"musig_{self.WALLET_NUM}\"\n+            self.WALLET_NUM += 1\n+            self.nodes[0].createwallet(wallet_name)\n+            wallet = self.nodes[0].get_wallet_rpc(wallet_name)\n+            wallets.append(wallet)\n+\n+            for priv_desc in wallet.listdescriptors(True)[\"descriptors\"]:\n+                desc = priv_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                privkey = PRIVKEY_RE.search(desc).group(1)\n+                break\n+            for pub_desc in wallet.listdescriptors()[\"descriptors\"]:\n+                desc = pub_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                pubkey = PUBKEY_RE.search(desc).group(1)\n+                privkey += ORIGIN_PATH_RE.search(pubkey).group(1)\n+                break\n+            keys.append((privkey, pubkey))\n+\n+        # Construct and import descriptors\n+        for i, wallet in enumerate(wallets):\n+            desc = pattern\n+            for j, (priv, pub) in enumerate(keys):\n+                if j == i:\n+                    desc = desc.replace(f\"${j}\", priv)\n+                else:\n+                    desc = desc.replace(f\"${j}\", pub)\n+\n+            import_descs = [{\n+                \"desc\": descsum_create(desc),\n+                \"active\": True,\n+                \"timestamp\": \"now\",\n+            }]\n+\n+            res = wallet.importdescriptors(import_descs)\n+            for r in res:\n+                assert_equal(r[\"success\"], True)\n+\n+        # Fund address\n+        addr = wallets[0].getnewaddress(address_type=\"bech32m\")\n+        for wallet in wallets[1:]:\n+            assert_equal(addr, wallet.getnewaddress(address_type=\"bech32m\"))\n+\n+        self.def_wallet.sendtoaddress(addr, 10)\n+        self.generate(self.nodes[0], 1)\n+\n+        # Create PSBT\n+        utxo = wallets[0].listunspent()[0]\n+        psbt = wallets[0].walletcreatefundedpsbt(\n+            outputs=[{self.def_wallet.getnewaddress(): 5}],\n+            inputs=[utxo],\n+            change_type=\"bech32m\",\n+            changePosition=1\n+        )[\"psbt\"]\n+\n+        return wallets, psbt\n+\n+    def test_musig_failure_modes(self):\n+        \"\"\"Test various MuSig2 failure scenarios\"\"\"\n+\n+        self.log.info(\"Testing missing participant nonce\")\n+        wallets, psbt = self.setup_musig_scenario(num_wallets=3)\n+\n+        # Only 2 out of 3 participants provide nonces\n+        nonce_psbts = []\n+        for i in range(2):\n+            proc = wallets[i].walletprocesspsbt(psbt=psbt)\n+            nonce_psbts.append(proc[\"psbt\"])\n+\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        # Attempt to create partial sigs. This should not complete due to the\n+        # missing nonce.\n+        for wallet in wallets[:2]:\n+            proc = wallet.walletprocesspsbt(psbt=comb_nonce_psbt)\n+            assert_equal(proc[\"complete\"], False)\n+            # No partial sigs are created\n+            dec = self.nodes[0].decodepsbt(proc[\"psbt\"])\n+            # There are still only two nonces\n+            assert_equal(len(dec[\"inputs\"][0].get(\"musig2_pubnonces\", [])), 2)\n+\n+        self.log.info(\"Testing insufficient partial signatures\")\n+        wallets, psbt = self.setup_musig_scenario(num_wallets=3)\n+        nonce_psbts = [w.walletprocesspsbt(psbt=psbt)[\"psbt\"] for w in wallets]\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        # Only 2 out of 3 provide partial sigs\n+        psig_psbts = []\n+        for i in range(2):\n+            proc = wallets[i].walletprocesspsbt(psbt=comb_nonce_psbt)\n+            psig_psbts.append(proc[\"psbt\"])\n+\n+        comb_psig_psbt = self.nodes[0].combinepsbt(psig_psbts)\n+\n+        # Finalization fails due to missing partial sig\n+        finalized = self.nodes[0].finalizepsbt(comb_psig_psbt)\n+        assert_equal(finalized[\"complete\"], False)\n+\n+        # Still only two partial sigs in combined PSBT\n+        dec = self.nodes[0].decodepsbt(comb_psig_psbt)\n+        assert_equal(len(dec[\"inputs\"][0][\"musig2_partial_sigs\"]), 2)\n+\n+        self.log.info(\"Testing mismatched key order\")\n+        wallets = []\n+        keys = []\n+        for i in range(2):\n+            wallet_name = f\"musig_{self.WALLET_NUM}\"\n+            self.WALLET_NUM += 1\n+            self.nodes[0].createwallet(wallet_name)\n+            wallet = self.nodes[0].get_wallet_rpc(wallet_name)\n+            wallets.append(wallet)\n+\n+            for priv_desc in wallet.listdescriptors(True)[\"descriptors\"]:\n+                desc = priv_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                privkey = PRIVKEY_RE.search(desc).group(1)\n+                break\n+            for pub_desc in wallet.listdescriptors()[\"descriptors\"]:\n+                desc = pub_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                pubkey = PUBKEY_RE.search(desc).group(1)\n+                privkey += ORIGIN_PATH_RE.search(pubkey).group(1)\n+                break\n+            keys.append((privkey, pubkey))\n+\n+        desc0 = f\"rawtr(musig({keys[0][0]},{keys[1][1]}))\"\n+        wallets[0].importdescriptors([{\n+            \"desc\": descsum_create(desc0),\n+            \"active\": True,\n+            \"timestamp\": \"now\",\n+        }])\n+\n+        # Reverse order to desc0\n+        desc1 = f\"rawtr(musig({keys[1][0]},{keys[0][1]}))\"\n+        wallets[1].importdescriptors([{\n+            \"desc\": descsum_create(desc1),\n+            \"active\": True,\n+            \"timestamp\": \"now\",\n+        }])\n+\n+        # Addresses should be different due to different key ordering\n+        addr0 = wallets[0].getnewaddress(address_type=\"bech32m\")\n+        addr1 = wallets[1].getnewaddress(address_type=\"bech32m\")\n+        assert addr0 != addr1\n+\n+        self.log.info(\"Testing finalize without partial sigs\")\n+        wallets, psbt = self.setup_musig_scenario(num_wallets=2)\n+        nonce_psbts = [w.walletprocesspsbt(psbt=psbt)[\"psbt\"] for w in wallets]\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        finalized = self.nodes[0].finalizepsbt(comb_nonce_psbt)\n+        assert_equal(finalized[\"complete\"], False)\n+\n+        dec = self.nodes[0].decodepsbt(comb_nonce_psbt)\n+        assert \"musig2_pubnonces\" in dec[\"inputs\"][0]\n+        assert \"musig2_partial_sigs\" not in dec[\"inputs\"][0]\n+\n+\n     def do_test(self, comment, pattern, sighash_type=None, scriptpath=False, nosign_wallets=None, only_one_musig_wallet=False):",
      "path": "test/functional/wallet_musig.py",
      "position": 1,
      "original_position": 176,
      "commit_id": "73a5d9315340942f030e6586c640b9240498f8ac",
      "original_commit_id": "c7c9dc2d8634bc79e76783be113f8d42cee63c6e",
      "in_reply_to_id": null,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In https://github.com/bitcoin/bitcoin/commit/c7c9dc2d8634bc79e76783be113f8d42cee63c6e \"test: Add musig failure scenarios\"\r\n\r\nNit: can rename this function to `test_success_case` now.",
      "created_at": "2025-10-17T13:16:46Z",
      "updated_at": "2025-10-17T14:33:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#discussion_r2440002764",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2440002764"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2440229322",
      "pull_request_review_id": 3350082420,
      "id": 2440229322,
      "node_id": "PRRC_kwDOABII586RcvHK",
      "diff_hunk": "",
      "path": "test/functional/wallet_musig.py",
      "position": 1,
      "original_position": 1,
      "commit_id": "217dbbbb5e38ab582ee0b3ef37fe9e99d887d7c8",
      "original_commit_id": "c7c9dc2d8634bc79e76783be113f8d42cee63c6e",
      "in_reply_to_id": null,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In https://github.com/bitcoin/bitcoin/commit/c7c9dc2d8634bc79e76783be113f8d42cee63c6e \"test: Add musig failure scenarios\"\r\n\r\nI noticed some duplication in both the success and failure cases and I tried to refactor this file based on the following points. Please find full diff below and consider extracting out commonalities.\r\n\r\n1. Separated the loop in the `do_test` func so that wallet creation and expectation calculations are not together.\r\n2. Because of the above separation, extracted `create_wallets_and_keys_from_pattern` func to be used in both success and failure cases.\r\n3. Extracted `construct_and_import_musig_descriptor_in_wallets` func to be used in both success and failure cases.\r\n4. Split the `test_musig_failure_modes` func into 4 funcs that have a similar func signature like the `do_test` func that takes in a comment and pattern to work with. Sort of a nit but I like all the test cases to have a similar format - easier on the eyes of the reader.\r\n\r\n<details open>\r\n<summary>Full diff that works on my system</summary>\r\n\r\n```diff\r\ndiff --git a/test/functional/wallet_musig.py b/test/functional/wallet_musig.py\r\nindex 55129b1676..64e1e40259 100755\r\n--- a/test/functional/wallet_musig.py\r\n+++ b/test/functional/wallet_musig.py\r\n@@ -28,43 +28,52 @@ class WalletMuSigTest(BitcoinTestFramework):\r\n     def skip_test_if_missing_module(self):\r\n         self.skip_if_no_wallet()\r\n \r\n-    def setup_musig_scenario(self, num_wallets=3):\r\n-        # Miniscript pattern based on number of wallets\r\n-        placeholders = \",\".join(f\"${i}/<{i};{i+1}>/*\" for i in range(num_wallets))\r\n-        pattern = f\"rawtr(musig({placeholders}))\"\r\n-\r\n+    # Create wallets and extract keys\r\n+    def create_wallets_and_keys_from_pattern(self, pat):\r\n         wallets = []\r\n         keys = []\r\n \r\n-        # Create wallets and extract keys\r\n-        for i in range(num_wallets):\r\n-            wallet_name = f\"musig_{self.wallet_num}\"\r\n-            self.wallet_num += 1\r\n-            self.nodes[0].createwallet(wallet_name)\r\n-            wallet = self.nodes[0].get_wallet_rpc(wallet_name)\r\n-            wallets.append(wallet)\r\n-\r\n-            for priv_desc in wallet.listdescriptors(True)[\"descriptors\"]:\r\n-                desc = priv_desc[\"desc\"]\r\n-                if not desc.startswith(\"tr(\"):\r\n-                    continue\r\n-                privkey = PRIVKEY_RE.search(desc).group(1)\r\n-                break\r\n-            for pub_desc in wallet.listdescriptors()[\"descriptors\"]:\r\n-                desc = pub_desc[\"desc\"]\r\n-                if not desc.startswith(\"tr(\"):\r\n+        for musig in MUSIG_RE.findall(pat):\r\n+            for placeholder in PLACEHOLDER_RE.findall(musig):\r\n+                wallet_index = int(placeholder[1:])\r\n+                if wallet_index < len(wallets):\r\n                     continue\r\n-                pubkey = PUBKEY_RE.search(desc).group(1)\r\n-                privkey += ORIGIN_PATH_RE.search(pubkey).group(1)\r\n-                break\r\n-            keys.append((privkey, pubkey))\r\n \r\n-        # Construct and import descriptors\r\n+                wallet_name = f\"musig_{self.wallet_num}\"\r\n+                self.wallet_num += 1\r\n+                self.nodes[0].createwallet(wallet_name)\r\n+                wallet = self.nodes[0].get_wallet_rpc(wallet_name)\r\n+                wallets.append(wallet)\r\n+\r\n+                for priv_desc in wallet.listdescriptors(True)[\"descriptors\"]:\r\n+                    desc = priv_desc[\"desc\"]\r\n+                    if not desc.startswith(\"tr(\"):\r\n+                        continue\r\n+                    privkey = PRIVKEY_RE.search(desc).group(1)\r\n+                    break\r\n+                for pub_desc in wallet.listdescriptors()[\"descriptors\"]:\r\n+                    desc = pub_desc[\"desc\"]\r\n+                    if not desc.startswith(\"tr(\"):\r\n+                        continue\r\n+                    pubkey = PUBKEY_RE.search(desc).group(1)\r\n+                    # Since the pubkey is derived from the private key that we have, we need\r\n+                    # to extract and insert the origin path from the pubkey as well.\r\n+                    privkey += ORIGIN_PATH_RE.search(pubkey).group(1)\r\n+                    break\r\n+                keys.append((privkey, pubkey))\r\n+\r\n+        return wallets, keys\r\n+\r\n+    # Construct and import each wallet's musig descriptor that\r\n+    # contains the private key from that wallet and pubkeys of the others\r\n+    def construct_and_import_musig_descriptor_in_wallets(self, pat, wallets, keys, only_one_musig_wallet=False):\r\n         for i, wallet in enumerate(wallets):\r\n-            desc = pattern\r\n+            if only_one_musig_wallet and i > 0:\r\n+                continue\r\n+            desc = pat\r\n             for j, (priv, pub) in enumerate(keys):\r\n                 if j == i:\r\n-                    desc = desc.replace(f\"${j}\", priv)\r\n+                    desc = desc.replace(f\"${i}\", priv)\r\n                 else:\r\n                     desc = desc.replace(f\"${j}\", pub)\r\n \r\n@@ -78,6 +87,10 @@ class WalletMuSigTest(BitcoinTestFramework):\r\n             for r in res:\r\n                 assert_equal(r[\"success\"], True)\r\n \r\n+    def setup_musig_scenario(self, pat):\r\n+        wallets, keys = self.create_wallets_and_keys_from_pattern(pat)\r\n+        self.construct_and_import_musig_descriptor_in_wallets(pat, wallets, keys, only_one_musig_wallet=False)\r\n+\r\n         # Fund address\r\n         addr = wallets[0].getnewaddress(address_type=\"bech32m\")\r\n         for wallet in wallets[1:]:\r\n@@ -97,11 +110,9 @@ class WalletMuSigTest(BitcoinTestFramework):\r\n \r\n         return wallets, psbt\r\n \r\n-    def test_musig_failure_modes(self):\r\n-        \"\"\"Test various MuSig2 failure scenarios\"\"\"\r\n-\r\n-        self.log.info(\"Testing missing participant nonce\")\r\n-        wallets, psbt = self.setup_musig_scenario(num_wallets=3)\r\n+    def test_failure_case_1(self, comment, pat):\r\n+        self.log.info(f\"Testing {comment}\")\r\n+        wallets, psbt = self.setup_musig_scenario(pat)\r\n \r\n         # Only 2 out of 3 participants provide nonces\r\n         nonce_psbts = []\r\n@@ -121,8 +132,9 @@ class WalletMuSigTest(BitcoinTestFramework):\r\n             # There are still only two nonces\r\n             assert_equal(len(dec[\"inputs\"][0].get(\"musig2_pubnonces\", [])), 2)\r\n \r\n-        self.log.info(\"Testing insufficient partial signatures\")\r\n-        wallets, psbt = self.setup_musig_scenario(num_wallets=3)\r\n+    def test_failure_case_2(self, comment, pat):\r\n+        self.log.info(f\"Testing {comment}\")\r\n+        wallets, psbt = self.setup_musig_scenario(pat)\r\n         nonce_psbts = [w.walletprocesspsbt(psbt=psbt)[\"psbt\"] for w in wallets]\r\n         comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\r\n \r\n@@ -142,30 +154,9 @@ class WalletMuSigTest(BitcoinTestFramework):\r\n         dec = self.nodes[0].decodepsbt(comb_psig_psbt)\r\n         assert_equal(len(dec[\"inputs\"][0][\"musig2_partial_sigs\"]), 2)\r\n \r\n-        self.log.info(\"Testing mismatched key order\")\r\n-        wallets = []\r\n-        keys = []\r\n-        for i in range(2):\r\n-            wallet_name = f\"musig_{self.wallet_num}\"\r\n-            self.wallet_num += 1\r\n-            self.nodes[0].createwallet(wallet_name)\r\n-            wallet = self.nodes[0].get_wallet_rpc(wallet_name)\r\n-            wallets.append(wallet)\r\n-\r\n-            for priv_desc in wallet.listdescriptors(True)[\"descriptors\"]:\r\n-                desc = priv_desc[\"desc\"]\r\n-                if not desc.startswith(\"tr(\"):\r\n-                    continue\r\n-                privkey = PRIVKEY_RE.search(desc).group(1)\r\n-                break\r\n-            for pub_desc in wallet.listdescriptors()[\"descriptors\"]:\r\n-                desc = pub_desc[\"desc\"]\r\n-                if not desc.startswith(\"tr(\"):\r\n-                    continue\r\n-                pubkey = PUBKEY_RE.search(desc).group(1)\r\n-                privkey += ORIGIN_PATH_RE.search(pubkey).group(1)\r\n-                break\r\n-            keys.append((privkey, pubkey))\r\n+    def test_failure_case_3(self, comment, pat):\r\n+        self.log.info(f\"Testing {comment}\")\r\n+        wallets, keys = self.create_wallets_and_keys_from_pattern(pat)\r\n \r\n         desc0 = f\"rawtr(musig({keys[0][0]},{keys[1][1]}))\"\r\n         wallets[0].importdescriptors([{\r\n@@ -187,8 +178,9 @@ class WalletMuSigTest(BitcoinTestFramework):\r\n         addr1 = wallets[1].getnewaddress(address_type=\"bech32m\")\r\n         assert addr0 != addr1\r\n \r\n-        self.log.info(\"Testing finalize without partial sigs\")\r\n-        wallets, psbt = self.setup_musig_scenario(num_wallets=2)\r\n+    def test_failure_case_4(self, comment, pat):\r\n+        self.log.info(f\"Testing {comment}\")\r\n+        wallets, psbt = self.setup_musig_scenario(pat)\r\n         nonce_psbts = [w.walletprocesspsbt(psbt=psbt)[\"psbt\"] for w in wallets]\r\n         comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\r\n \r\n@@ -199,17 +191,14 @@ class WalletMuSigTest(BitcoinTestFramework):\r\n         assert \"musig2_pubnonces\" in dec[\"inputs\"][0]\r\n         assert \"musig2_partial_sigs\" not in dec[\"inputs\"][0]\r\n \r\n-\r\n     def do_test(self, comment, pattern, sighash_type=None, scriptpath=False, nosign_wallets=None, only_one_musig_wallet=False):\r\n         self.log.info(f\"Testing {comment}\")\r\n         has_internal = MULTIPATH_TWO_RE.search(pattern) is not None\r\n \r\n-        wallets = []\r\n-        keys = []\r\n-\r\n         pat = pattern.replace(\"$H\", H_POINT)\r\n+        wallets, keys = self.create_wallets_and_keys_from_pattern(pat)\r\n+        self.construct_and_import_musig_descriptor_in_wallets(pat, wallets, keys, only_one_musig_wallet)\r\n \r\n-        # Figure out how many wallets are needed and create them\r\n         expected_pubnonces = 0\r\n         expected_partial_sigs = 0\r\n         for musig in MUSIG_RE.findall(pat):\r\n@@ -224,54 +213,9 @@ class WalletMuSigTest(BitcoinTestFramework):\r\n                     musig_partial_sigs += 1\r\n                 if wallet_index < len(wallets):\r\n                     continue\r\n-                wallet_name = f\"musig_{self.wallet_num}\"\r\n-                self.wallet_num += 1\r\n-                self.nodes[0].createwallet(wallet_name)\r\n-                wallet = self.nodes[0].get_wallet_rpc(wallet_name)\r\n-                wallets.append(wallet)\r\n-\r\n-                for priv_desc in wallet.listdescriptors(True)[\"descriptors\"]:\r\n-                    desc = priv_desc[\"desc\"]\r\n-                    if not desc.startswith(\"tr(\"):\r\n-                        continue\r\n-                    privkey = PRIVKEY_RE.search(desc).group(1)\r\n-                    break\r\n-                for pub_desc in wallet.listdescriptors()[\"descriptors\"]:\r\n-                    desc = pub_desc[\"desc\"]\r\n-                    if not desc.startswith(\"tr(\"):\r\n-                        continue\r\n-                    pubkey = PUBKEY_RE.search(desc).group(1)\r\n-                    # Since the pubkey is derived from the private key that we have, we need\r\n-                    # to extract and insert the origin path from the pubkey as well.\r\n-                    privkey += ORIGIN_PATH_RE.search(pubkey).group(1)\r\n-                    break\r\n-                keys.append((privkey, pubkey))\r\n             if musig_partial_sigs is not None:\r\n                 expected_partial_sigs += musig_partial_sigs\r\n \r\n-        # Construct and import each wallet's musig descriptor that\r\n-        # contains the private key from that wallet and pubkeys of the others\r\n-        for i, wallet in enumerate(wallets):\r\n-            if only_one_musig_wallet and i > 0:\r\n-                continue\r\n-            desc = pat\r\n-            import_descs = []\r\n-            for j, (priv, pub) in enumerate(keys):\r\n-                if j == i:\r\n-                    desc = desc.replace(f\"${i}\", priv)\r\n-                else:\r\n-                    desc = desc.replace(f\"${j}\", pub)\r\n-\r\n-            import_descs.append({\r\n-                \"desc\": descsum_create(desc),\r\n-                \"active\": True,\r\n-                \"timestamp\": \"now\",\r\n-            })\r\n-\r\n-            res = wallet.importdescriptors(import_descs)\r\n-            for r in res:\r\n-                assert_equal(r[\"success\"], True)\r\n-\r\n         # Check that the wallets agree on the same musig address\r\n         addr = None\r\n         change_addr = None\r\n@@ -393,6 +337,11 @@ class WalletMuSigTest(BitcoinTestFramework):\r\n     def run_test(self):\r\n         self.def_wallet = self.nodes[0].get_wallet_rpc(self.default_wallet_name)\r\n \r\n         self.do_test(\"rawtr(musig(keys/*))\", \"rawtr(musig($0/<0;1>/*,$1/<1;2>/*,$2/<2;3>/*))\")\r\n         self.do_test(\"rawtr(musig(keys/*)) with ALL|ANYONECANPAY\", \"rawtr(musig($0/<0;1>/*,$1/<1;2>/*,$2/<2;3>/*))\", \"ALL|ANYONECANPAY\")\r\n         self.do_test(\"tr(musig(keys/*)) no multipath\", \"tr(musig($0/0/*,$1/1/*,$2/2/*))\")\r\n@@ -410,8 +359,10 @@ class WalletMuSigTest(BitcoinTestFramework):\r\n         self.do_test(\"tr(musig/*,{pk(partial keys diff musig-1/*),pk(partial keys diff musig-2/*)})} script-path\", \"tr(musig($0,$1,$2)/<3;4>/*,{pk(musig($0,$1)/<5;6>/*),pk(musig($1,$2)/7/*)})\", scriptpath=True, nosign_wallets=[0])\r\n \r\n         # Run failure mode tests after happy path tests to avoid wallet name conflicts\r\n-        self.test_musig_failure_modes()\r\n-\r\n+        self.test_failure_case_1(\"missing participant nonce\", \"tr(musig($0/<0;1>/*,$1/<1;2>/*,$2/<2;3>/*))\")\r\n+        self.test_failure_case_2(\"insufficient partial signatures\", \"rawtr(musig($0/<0;1>/*,$1/<1;2>/*,$2/<2;3>/*))\")\r\n+        self.test_failure_case_3(\"mismatched key order\", \"tr(musig($0/<0;1>/*,$1/<1;2>/*))\")\r\n+        self.test_failure_case_4(\"finalize without partial sigs\", \"rawtr(musig($0/<0;1>/*,$1/<1;2>/*))\")\r\n \r\n if __name__ == '__main__':\r\n     WalletMuSigTest(__file__).main()\r\n\r\n```\r\n</details>",
      "created_at": "2025-10-17T14:30:31Z",
      "updated_at": "2025-10-17T17:58:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#discussion_r2440229322",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2440229322"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2440231846",
      "pull_request_review_id": 3350082420,
      "id": 2440231846,
      "node_id": "PRRC_kwDOABII586Rcvum",
      "diff_hunk": "@@ -237,6 +409,9 @@ def run_test(self):\n         self.do_test(\"tr(musig/*,{pk(partial keys diff musig-1/*),pk(partial keys diff musig-2/*)})}\", \"tr(musig($0,$1,$2)/<3;4>/*,{pk(musig($0,$1)/<5;6>/*),pk(musig($1,$2)/7/*)})\")\n         self.do_test(\"tr(musig/*,{pk(partial keys diff musig-1/*),pk(partial keys diff musig-2/*)})} script-path\", \"tr(musig($0,$1,$2)/<3;4>/*,{pk(musig($0,$1)/<5;6>/*),pk(musig($1,$2)/7/*)})\", scriptpath=True, nosign_wallets=[0])\n \n+        # Run failure mode tests after happy path tests to avoid wallet name conflicts",
      "path": "test/functional/wallet_musig.py",
      "position": 1,
      "original_position": 183,
      "commit_id": "73a5d9315340942f030e6586c640b9240498f8ac",
      "original_commit_id": "c7c9dc2d8634bc79e76783be113f8d42cee63c6e",
      "in_reply_to_id": null,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In https://github.com/bitcoin/bitcoin/commit/c7c9dc2d8634bc79e76783be113f8d42cee63c6e \"test: Add musig failure scenarios\"\r\n\r\nI don't think this comment is necessary(?) because the tests pass even if the failure cases run first",
      "created_at": "2025-10-17T14:31:23Z",
      "updated_at": "2025-10-17T14:34:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#discussion_r2440231846",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2440231846"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 412,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2557221072",
      "pull_request_review_id": 3501586938,
      "id": 2557221072,
      "node_id": "PRRC_kwDOABII586YbBjQ",
      "diff_hunk": "@@ -28,6 +28,178 @@ def set_test_params(self):\n     def skip_test_if_missing_module(self):\n         self.skip_if_no_wallet()\n \n+    def setup_musig_scenario(self, num_wallets=3):\n+        # Miniscript pattern based on number of wallets",
      "path": "test/functional/wallet_musig.py",
      "position": 1,
      "original_position": 5,
      "commit_id": "73a5d9315340942f030e6586c640b9240498f8ac",
      "original_commit_id": "c7c9dc2d8634bc79e76783be113f8d42cee63c6e",
      "in_reply_to_id": 2439794359,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I guess that might be more informative but the comment is just removed now",
      "created_at": "2025-11-24T17:55:50Z",
      "updated_at": "2025-11-24T17:55:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#discussion_r2557221072",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2557221072"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2557221500",
      "pull_request_review_id": 3501587488,
      "id": 2557221500,
      "node_id": "PRRC_kwDOABII586YbBp8",
      "diff_hunk": "@@ -28,6 +28,178 @@ def set_test_params(self):\n     def skip_test_if_missing_module(self):\n         self.skip_if_no_wallet()\n \n+    def setup_musig_scenario(self, num_wallets=3):\n+        # Miniscript pattern based on number of wallets\n+        placeholders = \",\".join(f\"${i}/<{i};{i+1}>/*\" for i in range(num_wallets))\n+        pattern = f\"rawtr(musig({placeholders}))\"\n+\n+        wallets = []\n+        keys = []\n+\n+        # Create wallets and extract keys\n+        for i in range(num_wallets):\n+            wallet_name = f\"musig_{self.WALLET_NUM}\"\n+            self.WALLET_NUM += 1\n+            self.nodes[0].createwallet(wallet_name)\n+            wallet = self.nodes[0].get_wallet_rpc(wallet_name)\n+            wallets.append(wallet)\n+\n+            for priv_desc in wallet.listdescriptors(True)[\"descriptors\"]:\n+                desc = priv_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                privkey = PRIVKEY_RE.search(desc).group(1)\n+                break\n+            for pub_desc in wallet.listdescriptors()[\"descriptors\"]:\n+                desc = pub_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                pubkey = PUBKEY_RE.search(desc).group(1)\n+                privkey += ORIGIN_PATH_RE.search(pubkey).group(1)\n+                break\n+            keys.append((privkey, pubkey))\n+\n+        # Construct and import descriptors\n+        for i, wallet in enumerate(wallets):\n+            desc = pattern\n+            for j, (priv, pub) in enumerate(keys):\n+                if j == i:\n+                    desc = desc.replace(f\"${j}\", priv)\n+                else:\n+                    desc = desc.replace(f\"${j}\", pub)\n+\n+            import_descs = [{\n+                \"desc\": descsum_create(desc),\n+                \"active\": True,\n+                \"timestamp\": \"now\",\n+            }]\n+\n+            res = wallet.importdescriptors(import_descs)\n+            for r in res:\n+                assert_equal(r[\"success\"], True)\n+\n+        # Fund address\n+        addr = wallets[0].getnewaddress(address_type=\"bech32m\")\n+        for wallet in wallets[1:]:\n+            assert_equal(addr, wallet.getnewaddress(address_type=\"bech32m\"))\n+\n+        self.def_wallet.sendtoaddress(addr, 10)\n+        self.generate(self.nodes[0], 1)\n+\n+        # Create PSBT\n+        utxo = wallets[0].listunspent()[0]\n+        psbt = wallets[0].walletcreatefundedpsbt(\n+            outputs=[{self.def_wallet.getnewaddress(): 5}],\n+            inputs=[utxo],\n+            change_type=\"bech32m\",\n+            changePosition=1\n+        )[\"psbt\"]\n+\n+        return wallets, psbt\n+\n+    def test_musig_failure_modes(self):\n+        \"\"\"Test various MuSig2 failure scenarios\"\"\"\n+\n+        self.log.info(\"Testing missing participant nonce\")\n+        wallets, psbt = self.setup_musig_scenario(num_wallets=3)\n+\n+        # Only 2 out of 3 participants provide nonces\n+        nonce_psbts = []\n+        for i in range(2):\n+            proc = wallets[i].walletprocesspsbt(psbt=psbt)\n+            nonce_psbts.append(proc[\"psbt\"])\n+\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        # Attempt to create partial sigs. This should not complete due to the\n+        # missing nonce.\n+        for wallet in wallets[:2]:\n+            proc = wallet.walletprocesspsbt(psbt=comb_nonce_psbt)\n+            assert_equal(proc[\"complete\"], False)\n+            # No partial sigs are created\n+            dec = self.nodes[0].decodepsbt(proc[\"psbt\"])\n+            # There are still only two nonces\n+            assert_equal(len(dec[\"inputs\"][0].get(\"musig2_pubnonces\", [])), 2)\n+\n+        self.log.info(\"Testing insufficient partial signatures\")\n+        wallets, psbt = self.setup_musig_scenario(num_wallets=3)\n+        nonce_psbts = [w.walletprocesspsbt(psbt=psbt)[\"psbt\"] for w in wallets]\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        # Only 2 out of 3 provide partial sigs\n+        psig_psbts = []\n+        for i in range(2):\n+            proc = wallets[i].walletprocesspsbt(psbt=comb_nonce_psbt)\n+            psig_psbts.append(proc[\"psbt\"])\n+\n+        comb_psig_psbt = self.nodes[0].combinepsbt(psig_psbts)\n+\n+        # Finalization fails due to missing partial sig\n+        finalized = self.nodes[0].finalizepsbt(comb_psig_psbt)\n+        assert_equal(finalized[\"complete\"], False)\n+\n+        # Still only two partial sigs in combined PSBT\n+        dec = self.nodes[0].decodepsbt(comb_psig_psbt)\n+        assert_equal(len(dec[\"inputs\"][0][\"musig2_partial_sigs\"]), 2)\n+\n+        self.log.info(\"Testing mismatched key order\")\n+        wallets = []\n+        keys = []\n+        for i in range(2):\n+            wallet_name = f\"musig_{self.WALLET_NUM}\"\n+            self.WALLET_NUM += 1\n+            self.nodes[0].createwallet(wallet_name)\n+            wallet = self.nodes[0].get_wallet_rpc(wallet_name)\n+            wallets.append(wallet)\n+\n+            for priv_desc in wallet.listdescriptors(True)[\"descriptors\"]:\n+                desc = priv_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                privkey = PRIVKEY_RE.search(desc).group(1)\n+                break\n+            for pub_desc in wallet.listdescriptors()[\"descriptors\"]:\n+                desc = pub_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                pubkey = PUBKEY_RE.search(desc).group(1)\n+                privkey += ORIGIN_PATH_RE.search(pubkey).group(1)\n+                break\n+            keys.append((privkey, pubkey))\n+\n+        desc0 = f\"rawtr(musig({keys[0][0]},{keys[1][1]}))\"\n+        wallets[0].importdescriptors([{\n+            \"desc\": descsum_create(desc0),\n+            \"active\": True,\n+            \"timestamp\": \"now\",\n+        }])\n+\n+        # Reverse order to desc0\n+        desc1 = f\"rawtr(musig({keys[1][0]},{keys[0][1]}))\"\n+        wallets[1].importdescriptors([{\n+            \"desc\": descsum_create(desc1),\n+            \"active\": True,\n+            \"timestamp\": \"now\",\n+        }])\n+\n+        # Addresses should be different due to different key ordering\n+        addr0 = wallets[0].getnewaddress(address_type=\"bech32m\")\n+        addr1 = wallets[1].getnewaddress(address_type=\"bech32m\")\n+        assert addr0 != addr1\n+\n+        self.log.info(\"Testing finalize without partial sigs\")\n+        wallets, psbt = self.setup_musig_scenario(num_wallets=2)\n+        nonce_psbts = [w.walletprocesspsbt(psbt=psbt)[\"psbt\"] for w in wallets]\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        finalized = self.nodes[0].finalizepsbt(comb_nonce_psbt)\n+        assert_equal(finalized[\"complete\"], False)\n+\n+        dec = self.nodes[0].decodepsbt(comb_nonce_psbt)\n+        assert \"musig2_pubnonces\" in dec[\"inputs\"][0]\n+        assert \"musig2_partial_sigs\" not in dec[\"inputs\"][0]\n+\n+",
      "path": "test/functional/wallet_musig.py",
      "position": 1,
      "original_position": 175,
      "commit_id": "73a5d9315340942f030e6586c640b9240498f8ac",
      "original_commit_id": "c7c9dc2d8634bc79e76783be113f8d42cee63c6e",
      "in_reply_to_id": 2439990998,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Fixed",
      "created_at": "2025-11-24T17:56:01Z",
      "updated_at": "2025-11-24T17:56:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#discussion_r2557221500",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2557221500"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 202,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2557221903",
      "pull_request_review_id": 3501587990,
      "id": 2557221903,
      "node_id": "PRRC_kwDOABII586YbBwP",
      "diff_hunk": "@@ -28,6 +28,178 @@ def set_test_params(self):\n     def skip_test_if_missing_module(self):\n         self.skip_if_no_wallet()\n \n+    def setup_musig_scenario(self, num_wallets=3):\n+        # Miniscript pattern based on number of wallets\n+        placeholders = \",\".join(f\"${i}/<{i};{i+1}>/*\" for i in range(num_wallets))\n+        pattern = f\"rawtr(musig({placeholders}))\"\n+\n+        wallets = []\n+        keys = []\n+\n+        # Create wallets and extract keys\n+        for i in range(num_wallets):\n+            wallet_name = f\"musig_{self.WALLET_NUM}\"\n+            self.WALLET_NUM += 1\n+            self.nodes[0].createwallet(wallet_name)\n+            wallet = self.nodes[0].get_wallet_rpc(wallet_name)\n+            wallets.append(wallet)\n+\n+            for priv_desc in wallet.listdescriptors(True)[\"descriptors\"]:\n+                desc = priv_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                privkey = PRIVKEY_RE.search(desc).group(1)\n+                break\n+            for pub_desc in wallet.listdescriptors()[\"descriptors\"]:\n+                desc = pub_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                pubkey = PUBKEY_RE.search(desc).group(1)\n+                privkey += ORIGIN_PATH_RE.search(pubkey).group(1)\n+                break\n+            keys.append((privkey, pubkey))\n+\n+        # Construct and import descriptors\n+        for i, wallet in enumerate(wallets):\n+            desc = pattern\n+            for j, (priv, pub) in enumerate(keys):\n+                if j == i:\n+                    desc = desc.replace(f\"${j}\", priv)\n+                else:\n+                    desc = desc.replace(f\"${j}\", pub)\n+\n+            import_descs = [{\n+                \"desc\": descsum_create(desc),\n+                \"active\": True,\n+                \"timestamp\": \"now\",\n+            }]\n+\n+            res = wallet.importdescriptors(import_descs)\n+            for r in res:\n+                assert_equal(r[\"success\"], True)\n+\n+        # Fund address\n+        addr = wallets[0].getnewaddress(address_type=\"bech32m\")\n+        for wallet in wallets[1:]:\n+            assert_equal(addr, wallet.getnewaddress(address_type=\"bech32m\"))\n+\n+        self.def_wallet.sendtoaddress(addr, 10)\n+        self.generate(self.nodes[0], 1)\n+\n+        # Create PSBT\n+        utxo = wallets[0].listunspent()[0]\n+        psbt = wallets[0].walletcreatefundedpsbt(\n+            outputs=[{self.def_wallet.getnewaddress(): 5}],\n+            inputs=[utxo],\n+            change_type=\"bech32m\",\n+            changePosition=1\n+        )[\"psbt\"]\n+\n+        return wallets, psbt\n+\n+    def test_musig_failure_modes(self):\n+        \"\"\"Test various MuSig2 failure scenarios\"\"\"\n+\n+        self.log.info(\"Testing missing participant nonce\")\n+        wallets, psbt = self.setup_musig_scenario(num_wallets=3)\n+\n+        # Only 2 out of 3 participants provide nonces\n+        nonce_psbts = []\n+        for i in range(2):\n+            proc = wallets[i].walletprocesspsbt(psbt=psbt)\n+            nonce_psbts.append(proc[\"psbt\"])\n+\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        # Attempt to create partial sigs. This should not complete due to the\n+        # missing nonce.\n+        for wallet in wallets[:2]:\n+            proc = wallet.walletprocesspsbt(psbt=comb_nonce_psbt)\n+            assert_equal(proc[\"complete\"], False)\n+            # No partial sigs are created\n+            dec = self.nodes[0].decodepsbt(proc[\"psbt\"])\n+            # There are still only two nonces\n+            assert_equal(len(dec[\"inputs\"][0].get(\"musig2_pubnonces\", [])), 2)\n+\n+        self.log.info(\"Testing insufficient partial signatures\")\n+        wallets, psbt = self.setup_musig_scenario(num_wallets=3)\n+        nonce_psbts = [w.walletprocesspsbt(psbt=psbt)[\"psbt\"] for w in wallets]\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        # Only 2 out of 3 provide partial sigs\n+        psig_psbts = []\n+        for i in range(2):\n+            proc = wallets[i].walletprocesspsbt(psbt=comb_nonce_psbt)\n+            psig_psbts.append(proc[\"psbt\"])\n+\n+        comb_psig_psbt = self.nodes[0].combinepsbt(psig_psbts)\n+\n+        # Finalization fails due to missing partial sig\n+        finalized = self.nodes[0].finalizepsbt(comb_psig_psbt)\n+        assert_equal(finalized[\"complete\"], False)\n+\n+        # Still only two partial sigs in combined PSBT\n+        dec = self.nodes[0].decodepsbt(comb_psig_psbt)\n+        assert_equal(len(dec[\"inputs\"][0][\"musig2_partial_sigs\"]), 2)\n+\n+        self.log.info(\"Testing mismatched key order\")\n+        wallets = []\n+        keys = []\n+        for i in range(2):\n+            wallet_name = f\"musig_{self.WALLET_NUM}\"\n+            self.WALLET_NUM += 1\n+            self.nodes[0].createwallet(wallet_name)\n+            wallet = self.nodes[0].get_wallet_rpc(wallet_name)\n+            wallets.append(wallet)\n+\n+            for priv_desc in wallet.listdescriptors(True)[\"descriptors\"]:\n+                desc = priv_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                privkey = PRIVKEY_RE.search(desc).group(1)\n+                break\n+            for pub_desc in wallet.listdescriptors()[\"descriptors\"]:\n+                desc = pub_desc[\"desc\"]\n+                if not desc.startswith(\"tr(\"):\n+                    continue\n+                pubkey = PUBKEY_RE.search(desc).group(1)\n+                privkey += ORIGIN_PATH_RE.search(pubkey).group(1)\n+                break\n+            keys.append((privkey, pubkey))\n+\n+        desc0 = f\"rawtr(musig({keys[0][0]},{keys[1][1]}))\"\n+        wallets[0].importdescriptors([{\n+            \"desc\": descsum_create(desc0),\n+            \"active\": True,\n+            \"timestamp\": \"now\",\n+        }])\n+\n+        # Reverse order to desc0\n+        desc1 = f\"rawtr(musig({keys[1][0]},{keys[0][1]}))\"\n+        wallets[1].importdescriptors([{\n+            \"desc\": descsum_create(desc1),\n+            \"active\": True,\n+            \"timestamp\": \"now\",\n+        }])\n+\n+        # Addresses should be different due to different key ordering\n+        addr0 = wallets[0].getnewaddress(address_type=\"bech32m\")\n+        addr1 = wallets[1].getnewaddress(address_type=\"bech32m\")\n+        assert addr0 != addr1\n+\n+        self.log.info(\"Testing finalize without partial sigs\")\n+        wallets, psbt = self.setup_musig_scenario(num_wallets=2)\n+        nonce_psbts = [w.walletprocesspsbt(psbt=psbt)[\"psbt\"] for w in wallets]\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        finalized = self.nodes[0].finalizepsbt(comb_nonce_psbt)\n+        assert_equal(finalized[\"complete\"], False)\n+\n+        dec = self.nodes[0].decodepsbt(comb_nonce_psbt)\n+        assert \"musig2_pubnonces\" in dec[\"inputs\"][0]\n+        assert \"musig2_partial_sigs\" not in dec[\"inputs\"][0]\n+\n+\n     def do_test(self, comment, pattern, sighash_type=None, scriptpath=False, nosign_wallets=None, only_one_musig_wallet=False):",
      "path": "test/functional/wallet_musig.py",
      "position": 1,
      "original_position": 176,
      "commit_id": "73a5d9315340942f030e6586c640b9240498f8ac",
      "original_commit_id": "c7c9dc2d8634bc79e76783be113f8d42cee63c6e",
      "in_reply_to_id": 2440002764,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2025-11-24T17:56:11Z",
      "updated_at": "2025-11-24T17:56:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#discussion_r2557221903",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2557221903"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 203,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2557226776",
      "pull_request_review_id": 3501593873,
      "id": 2557226776,
      "node_id": "PRRC_kwDOABII586YbC8Y",
      "diff_hunk": "",
      "path": "test/functional/wallet_musig.py",
      "position": 1,
      "original_position": 1,
      "commit_id": "217dbbbb5e38ab582ee0b3ef37fe9e99d887d7c8",
      "original_commit_id": "c7c9dc2d8634bc79e76783be113f8d42cee63c6e",
      "in_reply_to_id": 2440229322,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yeah, that looks very good to me, I took this almost exactly as is, squashed the `NUM_WALLETS` in there because these lines are now touched as well and made you co-author of that commit. Thanks a lot!",
      "created_at": "2025-11-24T17:57:44Z",
      "updated_at": "2025-11-24T17:57:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#discussion_r2557226776",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2557226776"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2557228453",
      "pull_request_review_id": 3501595947,
      "id": 2557228453,
      "node_id": "PRRC_kwDOABII586YbDWl",
      "diff_hunk": "@@ -237,6 +409,9 @@ def run_test(self):\n         self.do_test(\"tr(musig/*,{pk(partial keys diff musig-1/*),pk(partial keys diff musig-2/*)})}\", \"tr(musig($0,$1,$2)/<3;4>/*,{pk(musig($0,$1)/<5;6>/*),pk(musig($1,$2)/7/*)})\")\n         self.do_test(\"tr(musig/*,{pk(partial keys diff musig-1/*),pk(partial keys diff musig-2/*)})} script-path\", \"tr(musig($0,$1,$2)/<3;4>/*,{pk(musig($0,$1)/<5;6>/*),pk(musig($1,$2)/7/*)})\", scriptpath=True, nosign_wallets=[0])\n \n+        # Run failure mode tests after happy path tests to avoid wallet name conflicts",
      "path": "test/functional/wallet_musig.py",
      "position": 1,
      "original_position": 183,
      "commit_id": "73a5d9315340942f030e6586c640b9240498f8ac",
      "original_commit_id": "c7c9dc2d8634bc79e76783be113f8d42cee63c6e",
      "in_reply_to_id": 2440231846,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "It's gone, probably left-over from an earlier version of the code where this was still the case",
      "created_at": "2025-11-24T17:58:19Z",
      "updated_at": "2025-11-24T17:58:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#discussion_r2557228453",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2557228453"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 412,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2559047569",
      "pull_request_review_id": 3503877587,
      "id": 2559047569,
      "node_id": "PRRC_kwDOABII586Yh_eR",
      "diff_hunk": "@@ -74,32 +61,161 @@ def do_test(self, comment, pattern, sighash_type=None, scriptpath=False, nosign_\n                     privkey += ORIGIN_PATH_RE.search(pubkey).group(1)\n                     break\n                 keys.append((privkey, pubkey))\n-            if musig_partial_sigs is not None:\n-                expected_partial_sigs += musig_partial_sigs\n \n-        # Construct and import each wallet's musig descriptor that\n-        # contains the private key from that wallet and pubkeys of the others\n+        return wallets, keys\n+\n+    # Construct and import each wallet's musig descriptor that\n+    # contains the private key from that wallet and pubkeys of the others\n+    def construct_and_import_musig_descriptor_in_wallets(self, pat, wallets, keys, only_one_musig_wallet=False):\n         for i, wallet in enumerate(wallets):\n             if only_one_musig_wallet and i > 0:\n                 continue\n             desc = pat\n-            import_descs = []\n             for j, (priv, pub) in enumerate(keys):\n                 if j == i:\n                     desc = desc.replace(f\"${i}\", priv)\n                 else:\n                     desc = desc.replace(f\"${j}\", pub)\n \n-            import_descs.append({\n+            import_descs = [{\n                 \"desc\": descsum_create(desc),\n                 \"active\": True,\n                 \"timestamp\": \"now\",\n-            })\n+            }]\n \n             res = wallet.importdescriptors(import_descs)\n             for r in res:\n                 assert_equal(r[\"success\"], True)\n \n+    def setup_musig_scenario(self, pat):\n+        wallets, keys = self.create_wallets_and_keys_from_pattern(pat)\n+        self.construct_and_import_musig_descriptor_in_wallets(pat, wallets, keys, only_one_musig_wallet=False)\n+\n+        # Fund address\n+        addr = wallets[0].getnewaddress(address_type=\"bech32m\")\n+        for wallet in wallets[1:]:\n+            assert_equal(addr, wallet.getnewaddress(address_type=\"bech32m\"))\n+\n+        self.def_wallet.sendtoaddress(addr, 10)\n+        self.generate(self.nodes[0], 1)\n+\n+        # Create PSBT\n+        utxo = wallets[0].listunspent()[0]\n+        psbt = wallets[0].walletcreatefundedpsbt(\n+            outputs=[{self.def_wallet.getnewaddress(): 5}],\n+            inputs=[utxo],\n+            change_type=\"bech32m\",\n+            changePosition=1\n+        )[\"psbt\"]\n+\n+        return wallets, psbt\n+\n+    def test_failure_case_1(self, comment, pat):\n+        self.log.info(f\"Testing {comment}\")\n+        wallets, psbt = self.setup_musig_scenario(pat)\n+\n+        # Only 2 out of 3 participants provide nonces\n+        nonce_psbts = []\n+        for i in range(2):\n+            proc = wallets[i].walletprocesspsbt(psbt=psbt)\n+            nonce_psbts.append(proc[\"psbt\"])\n+\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        # Attempt to create partial sigs. This should not complete due to the\n+        # missing nonce.\n+        for wallet in wallets[:2]:\n+            proc = wallet.walletprocesspsbt(psbt=comb_nonce_psbt)\n+            assert_equal(proc[\"complete\"], False)\n+            # No partial sigs are created\n+            dec = self.nodes[0].decodepsbt(proc[\"psbt\"])\n+            # There are still only two nonces\n+            assert_equal(len(dec[\"inputs\"][0].get(\"musig2_pubnonces\", [])), 2)\n+\n+    def test_failure_case_2(self, comment, pat):\n+        self.log.info(f\"Testing {comment}\")\n+        wallets, psbt = self.setup_musig_scenario(pat)\n+        nonce_psbts = [w.walletprocesspsbt(psbt=psbt)[\"psbt\"] for w in wallets]\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        # Only 2 out of 3 provide partial sigs\n+        psig_psbts = []\n+        for i in range(2):\n+            proc = wallets[i].walletprocesspsbt(psbt=comb_nonce_psbt)\n+            psig_psbts.append(proc[\"psbt\"])\n+\n+        comb_psig_psbt = self.nodes[0].combinepsbt(psig_psbts)\n+\n+        # Finalization fails due to missing partial sig\n+        finalized = self.nodes[0].finalizepsbt(comb_psig_psbt)\n+        assert_equal(finalized[\"complete\"], False)\n+\n+        # Still only two partial sigs in combined PSBT\n+        dec = self.nodes[0].decodepsbt(comb_psig_psbt)\n+        assert_equal(len(dec[\"inputs\"][0][\"musig2_partial_sigs\"]), 2)\n+\n+    def test_failure_case_3(self, comment, pat):\n+        self.log.info(f\"Testing {comment}\")\n+        wallets, keys = self.create_wallets_and_keys_from_pattern(pat)\n+\n+        desc0 = f\"rawtr(musig({keys[0][0]},{keys[1][1]}))\"\n+        wallets[0].importdescriptors([{\n+            \"desc\": descsum_create(desc0),\n+            \"active\": True,\n+            \"timestamp\": \"now\",\n+        }])\n+\n+        # Reverse order to desc0\n+        desc1 = f\"rawtr(musig({keys[1][0]},{keys[0][1]}))\"\n+        wallets[1].importdescriptors([{\n+            \"desc\": descsum_create(desc1),\n+            \"active\": True,\n+            \"timestamp\": \"now\",\n+        }])\n+\n+        # Addresses should be different due to different key ordering\n+        addr0 = wallets[0].getnewaddress(address_type=\"bech32m\")\n+        addr1 = wallets[1].getnewaddress(address_type=\"bech32m\")\n+        assert addr0 != addr1",
      "path": "test/functional/wallet_musig.py",
      "position": 1,
      "original_position": 172,
      "commit_id": "b7215893e566dec8a085c08e722aa61ec5a2f5a0",
      "original_commit_id": "b7215893e566dec8a085c08e722aa61ec5a2f5a0",
      "in_reply_to_id": null,
      "user": {
        "login": "rkrux",
        "id": 5960750,
        "node_id": "MDQ6VXNlcjU5NjA3NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5960750?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rkrux",
        "html_url": "https://github.com/rkrux",
        "followers_url": "https://api.github.com/users/rkrux/followers",
        "following_url": "https://api.github.com/users/rkrux/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rkrux/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rkrux/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rkrux/subscriptions",
        "organizations_url": "https://api.github.com/users/rkrux/orgs",
        "repos_url": "https://api.github.com/users/rkrux/repos",
        "events_url": "https://api.github.com/users/rkrux/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rkrux/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In b7215893e566dec8a085c08e722aa61ec5a2f5a0 \"test: Add musig failure scenarios\"\r\n\r\nThe `self.test_failure_case_3(\"mismatched key order\", \"tr(musig($0/<0;1>/*,$1/<1;2>/*))\")` case seems incorrect to me because the participant pubkeys are sorted before generating the pubkey (and the address) that should result in both the wallets having same address.\r\nhttps://github.com/bitcoin/bitcoin/blob/238c1c8933b1f7479a9bca2b7cb207d26151c39d/src/script/descriptor.cpp#L658\r\n\r\nThis test case is passing because `desc0` and `desc1` are not successfully imported, and instead an error is thrown from the `importdescriptors` call which is unchecked. I believe the last address assertion is on the ones generated by the non-musig taproot descriptors of the two wallets, which anyway would be different.\r\n\r\n```zsh\r\n2025-11-25T08:25:08.970028Z TestFramework (INFO): Testing mismatched key order\r\n[{'success': False,\r\n  'error': {'code': -8, 'message': 'Active descriptors must be ranged'}}]\r\n```\r\n\r\nUpon successfully importing the descriptors after the below diff, the test fails.\r\n```diff\r\ndiff --git a/test/functional/wallet_musig.py b/test/functional/wallet_musig.py\r\nindex 0323d488b5..9d6513c703 100755\r\n--- a/test/functional/wallet_musig.py\r\n+++ b/test/functional/wallet_musig.py\r\n@@ -158,7 +158,7 @@ class WalletMuSigTest(BitcoinTestFramework):\r\n         self.log.info(f\"Testing {comment}\")\r\n         wallets, keys = self.create_wallets_and_keys_from_pattern(pat)\r\n \r\n-        desc0 = f\"rawtr(musig({keys[0][0]},{keys[1][1]}))\"\r\n+        desc0 = f\"rawtr(musig({keys[0][0]},{keys[1][1]})/*)\"\r\n         wallets[0].importdescriptors([{\r\n             \"desc\": descsum_create(desc0),\r\n             \"active\": True,\r\n@@ -166,7 +166,7 @@ class WalletMuSigTest(BitcoinTestFramework):\r\n         }])\r\n \r\n         # Reverse order to desc0\r\n-        desc1 = f\"rawtr(musig({keys[1][0]},{keys[0][1]}))\"\r\n+        desc1 = f\"rawtr(musig({keys[1][0]},{keys[0][1]})/*)\"\r\n         wallets[1].importdescriptors([{\r\n             \"desc\": descsum_create(desc1),\r\n             \"active\": True,\r\n```\r\n\r\n```zsh\r\n2025-11-25T08:36:43.985277Z TestFramework (ERROR): Unexpected exception\r\nTraceback (most recent call last):\r\n  File \"/Users/rkrux/projects/bitcoin/test/functional/test_framework/test_framework.py\", line 142, in main\r\n    self.run_test()\r\n    ~~~~~~~~~~~~~^^\r\n  File \"/Users/rkrux/projects/bitcoin/./build/test/functional/wallet_musig.py\", line 358, in run_test\r\n    self.test_failure_case_3(\"mismatched key order\", \"tr(musig($0/<0;1>/*,$1/<1;2>/*))\")\r\n    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/Users/rkrux/projects/bitcoin/./build/test/functional/wallet_musig.py\", line 179, in test_failure_case_3\r\n    assert addr0 != addr1\r\n           ^^^^^^^^^^^^^^\r\nAssertionError\r\n```\r\n\r\nI believe this test case should be removed.",
      "created_at": "2025-11-25T08:41:18Z",
      "updated_at": "2025-11-25T08:45:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#discussion_r2559047569",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2559047569"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
        }
      },
      "start_line": null,
      "original_start_line": 157,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 179,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2561897010",
      "pull_request_review_id": 3507336727,
      "id": 2561897010,
      "node_id": "PRRC_kwDOABII586Ys3Iy",
      "diff_hunk": "@@ -74,32 +61,161 @@ def do_test(self, comment, pattern, sighash_type=None, scriptpath=False, nosign_\n                     privkey += ORIGIN_PATH_RE.search(pubkey).group(1)\n                     break\n                 keys.append((privkey, pubkey))\n-            if musig_partial_sigs is not None:\n-                expected_partial_sigs += musig_partial_sigs\n \n-        # Construct and import each wallet's musig descriptor that\n-        # contains the private key from that wallet and pubkeys of the others\n+        return wallets, keys\n+\n+    # Construct and import each wallet's musig descriptor that\n+    # contains the private key from that wallet and pubkeys of the others\n+    def construct_and_import_musig_descriptor_in_wallets(self, pat, wallets, keys, only_one_musig_wallet=False):\n         for i, wallet in enumerate(wallets):\n             if only_one_musig_wallet and i > 0:\n                 continue\n             desc = pat\n-            import_descs = []\n             for j, (priv, pub) in enumerate(keys):\n                 if j == i:\n                     desc = desc.replace(f\"${i}\", priv)\n                 else:\n                     desc = desc.replace(f\"${j}\", pub)\n \n-            import_descs.append({\n+            import_descs = [{\n                 \"desc\": descsum_create(desc),\n                 \"active\": True,\n                 \"timestamp\": \"now\",\n-            })\n+            }]\n \n             res = wallet.importdescriptors(import_descs)\n             for r in res:\n                 assert_equal(r[\"success\"], True)\n \n+    def setup_musig_scenario(self, pat):\n+        wallets, keys = self.create_wallets_and_keys_from_pattern(pat)\n+        self.construct_and_import_musig_descriptor_in_wallets(pat, wallets, keys, only_one_musig_wallet=False)\n+\n+        # Fund address\n+        addr = wallets[0].getnewaddress(address_type=\"bech32m\")\n+        for wallet in wallets[1:]:\n+            assert_equal(addr, wallet.getnewaddress(address_type=\"bech32m\"))\n+\n+        self.def_wallet.sendtoaddress(addr, 10)\n+        self.generate(self.nodes[0], 1)\n+\n+        # Create PSBT\n+        utxo = wallets[0].listunspent()[0]\n+        psbt = wallets[0].walletcreatefundedpsbt(\n+            outputs=[{self.def_wallet.getnewaddress(): 5}],\n+            inputs=[utxo],\n+            change_type=\"bech32m\",\n+            changePosition=1\n+        )[\"psbt\"]\n+\n+        return wallets, psbt\n+\n+    def test_failure_case_1(self, comment, pat):\n+        self.log.info(f\"Testing {comment}\")\n+        wallets, psbt = self.setup_musig_scenario(pat)\n+\n+        # Only 2 out of 3 participants provide nonces\n+        nonce_psbts = []\n+        for i in range(2):\n+            proc = wallets[i].walletprocesspsbt(psbt=psbt)\n+            nonce_psbts.append(proc[\"psbt\"])\n+\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        # Attempt to create partial sigs. This should not complete due to the\n+        # missing nonce.\n+        for wallet in wallets[:2]:\n+            proc = wallet.walletprocesspsbt(psbt=comb_nonce_psbt)\n+            assert_equal(proc[\"complete\"], False)\n+            # No partial sigs are created\n+            dec = self.nodes[0].decodepsbt(proc[\"psbt\"])\n+            # There are still only two nonces\n+            assert_equal(len(dec[\"inputs\"][0].get(\"musig2_pubnonces\", [])), 2)\n+\n+    def test_failure_case_2(self, comment, pat):\n+        self.log.info(f\"Testing {comment}\")\n+        wallets, psbt = self.setup_musig_scenario(pat)\n+        nonce_psbts = [w.walletprocesspsbt(psbt=psbt)[\"psbt\"] for w in wallets]\n+        comb_nonce_psbt = self.nodes[0].combinepsbt(nonce_psbts)\n+\n+        # Only 2 out of 3 provide partial sigs\n+        psig_psbts = []\n+        for i in range(2):\n+            proc = wallets[i].walletprocesspsbt(psbt=comb_nonce_psbt)\n+            psig_psbts.append(proc[\"psbt\"])\n+\n+        comb_psig_psbt = self.nodes[0].combinepsbt(psig_psbts)\n+\n+        # Finalization fails due to missing partial sig\n+        finalized = self.nodes[0].finalizepsbt(comb_psig_psbt)\n+        assert_equal(finalized[\"complete\"], False)\n+\n+        # Still only two partial sigs in combined PSBT\n+        dec = self.nodes[0].decodepsbt(comb_psig_psbt)\n+        assert_equal(len(dec[\"inputs\"][0][\"musig2_partial_sigs\"]), 2)\n+\n+    def test_failure_case_3(self, comment, pat):\n+        self.log.info(f\"Testing {comment}\")\n+        wallets, keys = self.create_wallets_and_keys_from_pattern(pat)\n+\n+        desc0 = f\"rawtr(musig({keys[0][0]},{keys[1][1]}))\"\n+        wallets[0].importdescriptors([{\n+            \"desc\": descsum_create(desc0),\n+            \"active\": True,\n+            \"timestamp\": \"now\",\n+        }])\n+\n+        # Reverse order to desc0\n+        desc1 = f\"rawtr(musig({keys[1][0]},{keys[0][1]}))\"\n+        wallets[1].importdescriptors([{\n+            \"desc\": descsum_create(desc1),\n+            \"active\": True,\n+            \"timestamp\": \"now\",\n+        }])\n+\n+        # Addresses should be different due to different key ordering\n+        addr0 = wallets[0].getnewaddress(address_type=\"bech32m\")\n+        addr1 = wallets[1].getnewaddress(address_type=\"bech32m\")\n+        assert addr0 != addr1",
      "path": "test/functional/wallet_musig.py",
      "position": 1,
      "original_position": 172,
      "commit_id": "b7215893e566dec8a085c08e722aa61ec5a2f5a0",
      "original_commit_id": "b7215893e566dec8a085c08e722aa61ec5a2f5a0",
      "in_reply_to_id": 2559047569,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Right, I did have a wrong understanding here. I guess I didn't review the musig descriptors PR and I went by my assumptions, but I have looked at the PR again and at BIP390 and it seems like hitting this error should be impossible. Thanks!",
      "created_at": "2025-11-25T23:22:58Z",
      "updated_at": "2025-11-25T23:22:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33636#discussion_r2561897010",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2561897010"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33636"
        }
      },
      "start_line": null,
      "original_start_line": 157,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 179,
      "side": "RIGHT"
    }
  ]
}