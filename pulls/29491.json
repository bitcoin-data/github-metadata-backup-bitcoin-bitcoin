{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491",
    "id": 1746125849,
    "node_id": "PR_kwDOABII585oE8QZ",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/29491",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/29491.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/29491.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/f178c6cba7d179308324ff4a21b7ff20fc09ec2c",
    "number": 29491,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "[EXPERIMENTAL] Schnorr batch verification for blocks",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "This is a draft implementation of Schnorr signature batch verification in blocks, put here for conceptual discussion, and collaborative benchmarking.\r\n\r\nThe `secp256k1` code is still under review itself, please spend some time giving feedback there if you can:\r\n- [Batch module PR](https://github.com/bitcoin-core/secp256k1/pull/1134)\r\n- [ecmult refactoring PR](https://github.com/bitcoin-core/secp256k1/pull/1789)\r\n\r\nTODOs\r\n- [ ] Batch taproot tweak verification as well",
    "labels": [],
    "created_at": "2024-02-27T17:06:26Z",
    "updated_at": "2026-01-31T15:13:52Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "791ffc85537b5bc69446461522526d80c7a31e57",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "fjahr:2024-02-batch-validation-updated",
      "ref": "2024-02-batch-validation-updated",
      "sha": "f178c6cba7d179308324ff4a21b7ff20fc09ec2c",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 196253948,
        "node_id": "MDEwOlJlcG9zaXRvcnkxOTYyNTM5NDg=",
        "name": "bitcoin",
        "full_name": "fjahr/bitcoin",
        "owner": {
          "login": "fjahr",
          "id": 1322187,
          "node_id": "MDQ6VXNlcjEzMjIxODc=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/fjahr",
          "html_url": "https://github.com/fjahr",
          "followers_url": "https://api.github.com/users/fjahr/followers",
          "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
          "organizations_url": "https://api.github.com/users/fjahr/orgs",
          "repos_url": "https://api.github.com/users/fjahr/repos",
          "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/fjahr/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/fjahr/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/fjahr/bitcoin",
        "archive_url": "https://api.github.com/repos/fjahr/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/fjahr/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/fjahr/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/fjahr/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/fjahr/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/fjahr/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/fjahr/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/fjahr/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/fjahr/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/fjahr/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/fjahr/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/fjahr/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/fjahr/bitcoin/events",
        "forks_url": "https://api.github.com/repos/fjahr/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/fjahr/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/fjahr/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/fjahr/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/fjahr/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/fjahr/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/fjahr/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/fjahr/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/fjahr/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/fjahr/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/fjahr/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/fjahr/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/fjahr/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/fjahr/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/fjahr/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/fjahr/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:fjahr/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/fjahr/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/fjahr/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/fjahr/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/fjahr/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/fjahr/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/fjahr/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/fjahr/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/fjahr/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/fjahr/bitcoin/hooks",
        "svn_url": "https://github.com/fjahr/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 4,
        "watchers_count": 4,
        "size": 287341,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-31T14:00:05Z",
        "created_at": "2019-07-10T18:11:06Z",
        "updated_at": "2024-07-23T22:14:45Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "3d180d3c7f1f26c2fb3139937406cc84dbea5325",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 38821,
        "stargazers_count": 87839,
        "watchers_count": 87839,
        "size": 302866,
        "default_branch": "master",
        "open_issues_count": 742,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-31T14:05:49Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2026-01-31T14:12:58Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": true,
    "additions": 2791,
    "deletions": 504,
    "changed_files": 84,
    "commits": 10,
    "review_comments": 10,
    "comments": 17
  },
  "events": [
    {
      "event": "commented",
      "id": 1967171280,
      "node_id": "IC_kwDOABII5851QKbQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1967171280",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-27T17:06:29Z",
      "updated_at": "2026-01-31T14:01:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/29491.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#34381](https://github.com/bitcoin/bitcoin/pull/34381) (script: return proper error for `CScriptNum` errors by brunoerg)\n* [#34374](https://github.com/bitcoin/bitcoin/pull/34374) (kernel: use structured logging and simplify logging interface by stickies-v)\n* [#34184](https://github.com/bitcoin/bitcoin/pull/34184) (mining: add cooldown to createNewBlock() immediately after IBD by Sjors)\n* [#32575](https://github.com/bitcoin/bitcoin/pull/32575) (refactor: Split multithreaded case out of CheckInputScripts by fjahr)\n* [#32317](https://github.com/bitcoin/bitcoin/pull/32317) (kernel: Separate UTXO set access from validation functions by sedited)\n* [#30342](https://github.com/bitcoin/bitcoin/pull/30342) (kernel, logging: Pass Logger instances to kernel objects by ryanofsky)\n* [#29843](https://github.com/bitcoin/bitcoin/pull/29843) (policy: Allow non-standard scripts with -acceptnonstdtxn=1 (test nets only) by ajtowns)\n* [#28690](https://github.com/bitcoin/bitcoin/pull/28690) (build: Introduce internal kernel library by sedited)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->\n### LLM Linter (âœ¨ experimental)\n\n\n\nPossible typos and grammar issues:\n\n- memeory -> memory [spelling error making the word unclear]\n\n\n\n\nPossible places where named args for integral literals may be used (e.g. `func(x, /*named_arg=*/0)` in C++, and `func(x, named_arg=0)` in Python):\n\n- secp256k1_batch_add_schnorrsig(..., 32, ...) in src/batchverify.cpp\n\n\n\n<sup>2026-01-31 14:01:32</sup>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-1967171280",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11940425825,
      "node_id": "HRFPE_lADOABII586Ak_eDzwAAAALHtHBh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11940425825",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "0a5e6128680c8b4f43fcb2d0450d41d5e4603c9d",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/0a5e6128680c8b4f43fcb2d0450d41d5e4603c9d",
      "created_at": "2024-02-27T17:10:54Z"
    },
    {
      "event": "labeled",
      "id": 11940427505,
      "node_id": "LE_lADOABII586Ak_eDzwAAAALHtHbx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11940427505",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-27T17:10:59Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1967190805,
      "node_id": "IC_kwDOABII5851QPMV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1967190805",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-27T17:11:00Z",
      "updated_at": "2024-02-27T17:11:00Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\nðŸš§ At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/22041704016</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-1967190805",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "commented",
      "id": 1968590438,
      "node_id": "IC_kwDOABII5851Vk5m",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1968590438",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-28T09:40:46Z",
      "updated_at": "2024-02-28T09:41:17Z",
      "author_association": "MEMBER",
      "body": "I guess this is most interesting to test against the last 50K blocks on mainnet, i.e. since early 2023? Given the high percentage of taproot transactions. Such testing could benefit from a assume utxo snapshot, saving everyone the pain of rewinding. I can bake one, though ideally I'd like #26045 to land first.\r\n\r\nIs the current PR already using batches? It's unclear to me by glancing over `validation.cpp` if and how it's collecting up to `max_batch_size{106}` signatures before calling `batch.Verify()`.\r\n\r\nMaybe add a `-schnorrbatchverify` startup argument so more people can try it once it gets through review.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-1968590438",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "commented",
      "id": 1968923056,
      "node_id": "IC_kwDOABII5851W2Gw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1968923056",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-28T12:53:21Z",
      "updated_at": "2024-02-28T15:59:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I guess this is most interesting to test against the last 50K blocks on mainnet, i.e. since early 2023? Given the high percentage of taproot transactions. Such testing could benefit from a assume utxo snapshot, saving everyone the pain of rewinding. I can bake one, though ideally I'd like #26045 to land first.\r\n\r\nYeah, that would be great. I have to get the tracing part to work in my setup again before I can start.\r\n\r\n> Is the current PR already using batches? It's unclear to me by glancing over `validation.cpp` if and how it's collecting up to `max_batch_size{106}` signatures before calling `batch.Verify()`.\r\n\r\nYes, the rough architecture is as as follows (sorry for not writing a better explanation above but it's still very rough and I expect it to change). So, the [`batch` object is constructed](https://github.com/bitcoin/bitcoin/pull/29491/commits/0a5e6128680c8b4f43fcb2d0450d41d5e4603c9d#diff-97c3a52bc5fad452d82670a7fd291800bae20c7bc35bb82686c2c0a4ea7b5b98R2401) and then [handed down from `ConnectBlock()` to `CheckInputScripts()`](https://github.com/bitcoin/bitcoin/pull/29491/commits/0a5e6128680c8b4f43fcb2d0450d41d5e4603c9d#diff-97c3a52bc5fad452d82670a7fd291800bae20c7bc35bb82686c2c0a4ea7b5b98R2454) which [hands it to the `CScriptCheck` constructor](https://github.com/bitcoin/bitcoin/pull/29491/commits/0a5e6128680c8b4f43fcb2d0450d41d5e4603c9d#diff-97c3a52bc5fad452d82670a7fd291800bae20c7bc35bb82686c2c0a4ea7b5b98R1961). When the [`CScriptCheck` instance is executed](https://github.com/bitcoin/bitcoin/pull/29491/commits/0a5e6128680c8b4f43fcb2d0450d41d5e4603c9d#diff-97c3a52bc5fad452d82670a7fd291800bae20c7bc35bb82686c2c0a4ea7b5b98R1863) and the batch object is present [`BatchingCachingTransactionSignatureChecker` is used](https://github.com/bitcoin/bitcoin/pull/29491/commits/0a5e6128680c8b4f43fcb2d0450d41d5e4603c9d#diff-0618dae2990d096e96e0283f7ab8cee069469f1ce603b58c0bb289e154f3aa17R40) which only differs from the default `CachingTransactionSignatureChecker` in that its [implementation of `VerifySchnorrSignature()`](https://github.com/bitcoin/bitcoin/pull/29491/commits/0a5e6128680c8b4f43fcb2d0450d41d5e4603c9d#diff-612abe4a74f2e9f6903cebff057d47bfe4f8a57507c175743f4b62fde0d3cc58R132) and adds the Schnorr sig to the `batch` object instead of verifying it right there. (Here we have an issue because the function is not doing what the name says anymore but it is a much simpler change this way and I find it hard to predict where we will land with this in the end.) Then [back in `ConnectBlock()` the `batch` object is verified](https://github.com/bitcoin/bitcoin/pull/29491/commits/0a5e6128680c8b4f43fcb2d0450d41d5e4603c9d#diff-97c3a52bc5fad452d82670a7fd291800bae20c7bc35bb82686c2c0a4ea7b5b98R2489) after all transactions have been iterated over.\r\n\r\nThe 106 is an implementation detail from `secp256k1` that I am not sure needs to be really exposed here. But what matters for the question is: if there are more than 106 sigs added to the batch the verification for the already added sigs will happen when the next sig is added and if the verification fails the adding itself will fail. So, a callback to the last paragraph, every 106 sigs the naming of `VerifySchnorrSignature()` is actually still correct ;) and the one verify call in the end just verifies the last n % 106 sigs left for that block. I did not put any effort in documenting this properly here yet because the `secp256k1` API is not finalized yet and the details on this particular topic might still change, see for example https://github.com/bitcoin-core/secp256k1/pull/1134#pullrequestreview-1083948472\r\n\r\nEverything should be conditional on the presence of a `batch` object which defaults to `nullptr` and if that is the case all the other functions should work as usual, for example when used outside of the context of a new block.\r\n\r\n> Maybe add a `-schnorrbatchverify` startup argument so more people can try it once it gets through review.\r\n\r\nYeah, I have been thinking that or maybe even a compiler argument",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-1968923056",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11951576394,
      "node_id": "HRFPE_lADOABII586Ak_eDzwAAAALIXpVK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11951576394",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "1825555b6b8d8030e747eda82ddab4b15a87071d",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/1825555b6b8d8030e747eda82ddab4b15a87071d",
      "created_at": "2024-02-28T13:14:03Z"
    },
    {
      "event": "commented",
      "id": 1968959800,
      "node_id": "IC_kwDOABII5851W_E4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1968959800",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-28T13:14:09Z",
      "updated_at": "2024-02-28T13:14:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "@Sjors maybe what confused you is that `BatchingCachingTransactionSignatureChecker::VerifySchnorrSignatureBatch()` was unused. That was actually a leftover from an earlier design spike and I just forgot to remove it. It's gone now.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-1968959800",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "mentioned",
      "id": 11951577950,
      "node_id": "MEE_lADOABII586Ak_eDzwAAAALIXpte",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11951577950",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-28T13:14:10Z"
    },
    {
      "event": "subscribed",
      "id": 11951577978,
      "node_id": "SE_lADOABII586Ak_eDzwAAAALIXpt6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11951577978",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-28T13:14:10Z"
    },
    {
      "event": "commented",
      "id": 1969001095,
      "node_id": "IC_kwDOABII5851XJKH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1969001095",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-28T13:36:35Z",
      "updated_at": "2024-02-28T13:36:35Z",
      "author_association": "MEMBER",
      "body": "> if there are more than 106 sigs added to the batch the verification for the already added sigs will happen when the next sig is added and if the verification fails the adding itself will fail.\r\n\r\nThat clarifies a lot, and should be documented :-)",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-1969001095",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "labeled",
      "id": 12381343879,
      "node_id": "LE_lADOABII586Ak_eDzwAAAALh_FCH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12381343879",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-06T10:25:59Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2106968575,
      "node_id": "IC_kwDOABII5859lcn_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2106968575",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-13T08:33:31Z",
      "updated_at": "2024-05-13T08:36:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "@willcl-ark and I ran a IBD benchmark vs master for this PR: IBD from a local node to height 840000 and currently only looking at the connect_block duration.\r\n\r\nIn the current draft implementation:\r\n- master is currently faster\r\n- batch validation is attempted and decreases performance even before taproot activated\r\n- after taproot activation, batch validation is significantly slower than non-batch validation\r\n\r\n![image](https://github.com/bitcoin/bitcoin/assets/19157360/a6fec9ae-eb74-42b0-9861-f777a0dc7f4d)\r\n\r\n![image](https://github.com/bitcoin/bitcoin/assets/19157360/b4889d98-ea29-4884-9464-6f41e7e3ac7a)\r\n\r\nUsed this bpftrace script to collect CSV data:\r\n```c\r\n#!/usr/bin/env bpftrace\r\n\r\nusdt:./src/bitcoind:validation:block_connected\r\n{\r\n  $height = (int32) arg1;\r\n  $tx = (uint64) arg2;\r\n  $ins = (int32) arg3;\r\n  $sigops = (int64) arg4;\r\n  $duration = (int64) arg5; // in nanoseconds\r\n\r\n  printf(\"%d,%ld,%d,%ld,%ld\\n\", $height, $tx, $ins, $sigops, $duration);\r\n}\r\n```",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-2106968575",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "mentioned",
      "id": 12783459289,
      "node_id": "MEE_lADOABII586Ak_eDzwAAAAL59BvZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12783459289",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-13T08:33:32Z"
    },
    {
      "event": "subscribed",
      "id": 12783459306,
      "node_id": "SE_lADOABII586Ak_eDzwAAAAL59Bvq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12783459306",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-13T08:33:32Z"
    },
    {
      "event": "commented",
      "id": 2106978586,
      "node_id": "IC_kwDOABII5859lfEa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2106978586",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-13T08:38:04Z",
      "updated_at": "2024-05-13T08:38:04Z",
      "author_association": "MEMBER",
      "body": "> batch validation is attempted and decreases performance even before taproot activated\r\n\r\nFrom a quick skim of the changes ISTM that we always use the `BatchingCachingTransactionSignatureChecker`, and there was no switch to the `CachingTransactionSignatureChecker`, but this could well be because this is only in WIP state. It doesnt account for why it's currently slower in all cases though.",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-2106978586",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15544617627,
      "node_id": "HRFPE_lADOABII586Ak_eDzwAAAAOeiAqb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15544617627",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "6f271d7bd0926a926b643f60f65263bed1d07c44",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/6f271d7bd0926a926b643f60f65263bed1d07c44",
      "created_at": "2024-12-05T13:57:12Z"
    },
    {
      "event": "unlabeled",
      "id": 15546090189,
      "node_id": "UNLE_lADOABII586Ak_eDzwAAAAOenoLN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15546090189",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-05T15:35:46Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2525335080,
      "node_id": "IC_kwDOABII586WhY4o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2525335080",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-07T22:55:54Z",
      "updated_at": "2024-12-07T22:55:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "It seems in this approach the `m_batch_mutex` is held for the entirety of adding, which will cause lock contention. `Verify` is then a blocking call on the main thread, which negates the multithreading.\r\n\r\nI think a better approach would be to have a thread local batch for each worker thread and the main thread, so each thread can add all schnorr sigs without locking, and then each thread can verify their batches in parallel at the end.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-2525335080",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 16701880358,
      "node_id": "HRFPE_lADOABII586Ak_eDzwAAAAPjgngm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16701880358",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "cafdd148f6bd2206da1bf88d684b82feea47f65d",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/cafdd148f6bd2206da1bf88d684b82feea47f65d",
      "created_at": "2025-03-11T23:43:41Z"
    },
    {
      "event": "renamed",
      "id": 16701886919,
      "node_id": "RTE_lADOABII586Ak_eDzwAAAAPjgpHH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16701886919",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-11T23:44:24Z",
      "rename": {
        "from": "[DO NOT MERGE] Schnorr batch verification for blocks",
        "to": "[EXPERIMENTAL] Schnorr batch verification for blocks"
      }
    },
    {
      "event": "reviewed",
      "id": 2688529645,
      "node_id": "PRR_kwDOABII586gP7Tt",
      "url": null,
      "actor": null,
      "commit_id": "d333d5c6e3c4b454621998772ff74ff6656af691",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-03-16T06:47:21Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#pullrequestreview-2688529645",
      "submitted_at": "2025-03-16T06:47:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
    },
    {
      "event": "reviewed",
      "id": 2689031245,
      "node_id": "PRR_kwDOABII586gR1xN",
      "url": null,
      "actor": null,
      "commit_id": "454103832351311d11e16505ed1925bd5f1c6875",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-03-17T03:23:19Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#pullrequestreview-2689031245",
      "submitted_at": "2025-03-17T03:23:19Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
    },
    {
      "event": "labeled",
      "id": 16894607478,
      "node_id": "LE_lADOABII586Ak_eDzwAAAAPu_0B2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16894607478",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-20T08:03:08Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2702581295,
      "node_id": "PRR_kwDOABII586hFh4v",
      "url": null,
      "actor": null,
      "commit_id": "6055f3a6f530818e2805d11debb1fb2ce81fc5c0",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-03-20T12:46:38Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#pullrequestreview-2702581295",
      "submitted_at": "2025-03-20T12:46:38Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
    },
    {
      "event": "referenced",
      "id": 16944354487,
      "node_id": "REFE_lADOABII586Ak_eDzwAAAAPx9lS3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16944354487",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b9c281011b77e5b4899bdf835767e45c4fab96e1",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b9c281011b77e5b4899bdf835767e45c4fab96e1",
      "created_at": "2025-03-23T13:03:37Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 16946286061,
      "node_id": "HRFPE_lADOABII586Ak_eDzwAAAAPyE83t",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16946286061",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "4ab16a0b2801023d5656ec9a0cb9cfdeeeb1a029",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/4ab16a0b2801023d5656ec9a0cb9cfdeeeb1a029",
      "created_at": "2025-03-23T22:44:42Z"
    },
    {
      "event": "unlabeled",
      "id": 16946395084,
      "node_id": "UNLE_lADOABII586Ak_eDzwAAAAPyFXfM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16946395084",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-23T23:11:20Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2748140699,
      "node_id": "IC_kwDOABII586jzUyb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2748140699",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-24T13:29:23Z",
      "updated_at": "2025-03-24T13:29:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "I've also rebased to get #31689 in here by the way.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-2748140699",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "unsubscribed",
      "id": 17027651983,
      "node_id": "UE_lADOABII586Ak_eDzwAAAAP27VmP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17027651983",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-28T08:18:19Z"
    },
    {
      "event": "reviewed",
      "id": 2733929171,
      "node_id": "PRR_kwDOABII586i9HLT",
      "url": null,
      "actor": null,
      "commit_id": "696bd7547e0e4ab44388d3c55ed636c46f9bdad5",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-04-01T20:05:27Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#pullrequestreview-2733929171",
      "submitted_at": "2025-04-01T20:05:27Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
    },
    {
      "event": "commented",
      "id": 2851542917,
      "node_id": "IC_kwDOABII586p9xeF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2851542917",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-05T16:24:06Z",
      "updated_at": "2025-05-05T16:27:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "While testing this, I observed a decline in performance as the number of threads increased. I'm not sure why this happens, but I suspect these play a role:\r\n- Doing batch-verification work within the critical section https://github.com/bitcoin/bitcoin/pull/29491/files#diff-0f68d4063c2fb11000f9048e46478e26c0ea2622f7866d00b574f429c3a4db61R151\r\n- Copy operations in https://github.com/bitcoin/bitcoin/pull/29491/files#diff-612abe4a74f2e9f6903cebff057d47bfe4f8a57507c175743f4b62fde0d3cc58R95-R99\r\n\r\nI made some tweaks to my previous batch-verification implementation to produce https://github.com/Eunovo/bitcoin/commits/2025-batch-verification/ and retested. These are results from running the Microbenchmark `build/bin/bench_bitcoin -filter=ConnectBlockAllSchnorr`\r\n\r\n| Commit            | Threads | Run 1 (block/s) | Run 2 (block/s) | Run 3 (block/s) | Min   | Max   | Mean (block/s)       | StdDev              |\r\n|-------------------|---------|------------------|------------------|------------------|--------|--------|------------------------|----------------------|\r\n| fjahr(4ab16a0b)   | 1       | 8.0              | 8.07             | 7.6              | 7.6    | 8.07   | 7.890000000000001     | 0.20704266871026072  |\r\n| fjahr(4ab16a0b)   | 2       | 15.54            | 15.74            | 15.66            | 15.54  | 15.74  | 15.646666666666667    | 0.08219218670625349  |\r\n| fjahr(4ab16a0b)   | 4       | 29.58            | 29.14            | 29.07            | 29.07  | 29.58  | 29.263333333333332    | 0.2257333727111592   |\r\n| fjahr(4ab16a0b)   | 8       | 49.33            | 45.88            | 48.5             | 45.88  | 49.33  | 47.903333333333336    | 1.4702909764925958   |\r\n| fjahr(4ab16a0b)   | 16      | 50.75            | 51.23            | 52.17            | 50.75  | 52.17  | 51.383333333333326    | 0.5897645481225736   |\r\n| master(baa848b8d) | 1       | 6.31             | 6.59             | 6.6              | 6.31   | 6.6    | 6.5                   | 0.13441230102437307  |\r\n| master(baa848b8d) | 2       | 12.88            | 12.93            | 12.65            | 12.65  | 12.93  | 12.82                 | 0.12192894105447909  |\r\n| master(baa848b8d) | 4       | 24.96            | 24.96            | 24.93            | 24.93  | 24.96  | 24.95                 | 0.014142135623731487 |\r\n| master(baa848b8d) | 8       | 46.01            | 46.18            | 46.27            | 46.01  | 46.27  | 46.153333333333336    | 0.10780641085864351  |\r\n| master(baa848b8d) | 16      | 52.84            | 52.36            | 52.83            | 52.36  | 52.84  | 52.67666666666667     | 0.22395436042987837  |\r\n| novo(0493ba332)   | 1       | 8.19             | 8.14             | 8.11             | 8.11   | 8.19   | 8.146666666666667     | 0.03299831645537218  |\r\n| novo(0493ba332)   | 2       | 15.47            | 15.78            | 15.75            | 15.47  | 15.78  | 15.666666666666666    | 0.1396026106091457   |\r\n| novo(0493ba332)   | 4       | 30.23            | 30.46            | 30.28            | 30.23  | 30.46  | 30.323333333333334    | 0.09877021593352711  |\r\n| novo(0493ba332)   | 8       | 53.96            | 50.33            | 54.68            | 50.33  | 54.68  | 52.99                 | 1.9037331745809347   |\r\n| novo(0493ba332)   | 16      | 64.4             | 64.59            | 64.29            | 64.29  | 64.59  | 64.42666666666668     | 0.1239175353029395   |\r\n\r\nHere's a graph of the mean block processing speed (block/s) plotted against the number of threads (Higher is better).\r\n![benchmark_comparison](https://github.com/user-attachments/assets/0b328e10-53b4-4689-a4ca-3c0fb561354d)\r\n  \r\n   \r\n**EDIT**\r\nI'm waiting on more results from a fresh IBD benchmark",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-2851542917",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "commented",
      "id": 2851688561,
      "node_id": "IC_kwDOABII586p-VBx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2851688561",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-05T17:10:54Z",
      "updated_at": "2025-05-05T17:11:52Z",
      "author_association": "CONTRIBUTOR",
      "body": "> While testing this, I observed a decline in performance as the number of threads increased.\r\n\r\nCan you share the setup for these benchmarks so I can test them? Thanks!\r\n\r\nEDIT: I see you added it, it wasn't in the notification I received",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-2851688561",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "commented",
      "id": 2853439571,
      "node_id": "IC_kwDOABII586qFAhT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2853439571",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-06T06:40:38Z",
      "updated_at": "2025-05-06T10:06:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Can you share the setup for these benchmarks so I can test them? Thanks!\r\n\r\nOS is Ubuntu 24.04.2 LTS\r\n\r\nOutput from `lspcu`\r\n```\r\nArchitecture:             x86_64\r\n  CPU op-mode(s):         32-bit, 64-bit\r\n  Address sizes:          48 bits physical, 48 bits virtual\r\n  Byte Order:             Little Endian\r\nCPU(s):                   16\r\n  On-line CPU(s) list:    0-15\r\nVendor ID:                AuthenticAMD\r\n  Model name:             AMD Ryzen 9 8945HS w/ Radeon 780M Graphics\r\n    CPU family:           25\r\n    Model:                117\r\n    Thread(s) per core:   2\r\n    Core(s) per socket:   8\r\n    Socket(s):            1\r\n    Stepping:             2\r\n    Frequency boost:      enabled\r\n    CPU(s) scaling MHz:   83%\r\n    CPU max MHz:          5263.0000\r\n    CPU min MHz:          400.0000\r\n```\r\n\r\nI'm running the IBD benchmark on a different machine. I'll share details when results are in.\r\n\r\n**EDIT**\r\nIt seems you were referring to the command I ran. I used `ConnectBlockAllSchnorr` microbenchmark. Run it with `build/bin/bench_bitcoin -filter=ConnectBlockAllSchnorr` . For IBD benchmarking, I'm doing `bitcoind -assumevalid=0 -par={par} -stopatheight=880000`(I'm testing 1, 2, 4, 6,  8, 12 threads) with [Benchkit](https://github.com/bitcoin-dev-tools/benchkit/tree/master). \r\n\r\nNote that Benchkit is still experimental, it loads the 840000 assumeutxo snapshot and runs hyperfine",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-2853439571",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "labeled",
      "id": 17546304834,
      "node_id": "LE_lADOABII586Ak_eDzwAAAAQV111C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17546304834",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-06T23:29:39Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17705011908,
      "node_id": "HRFPE_lADOABII586Ak_eDzwAAAAQfTQrE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17705011908",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "4d9834e80cfd95795e9cca53a4cff75d22c7f3ad",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/4d9834e80cfd95795e9cca53a4cff75d22c7f3ad",
      "created_at": "2025-05-18T23:57:21Z"
    },
    {
      "event": "commented",
      "id": 2889288127,
      "node_id": "IC_kwDOABII586sNwm_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2889288127",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-18T23:58:49Z",
      "updated_at": "2025-05-18T23:58:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "> It seems you were referring to the command I ran. I used ConnectBlockAllSchnorr microbenchmark. Run it with build/bin/bench_bitcoin -filter=ConnectBlockAllSchnorr . For IBD benchmarking, I'm doing bitcoind -assumevalid=0 -par={par} -stopatheight=880000(I'm testing 1, 2, 4, 6, 8, 12 threads) with Benchkit.\r\n\r\nI couldn't figure out how to test the different thread configurations for the microbench with Benchkit. Are you using Benchkit there as well or are you just setting `worker_threads_num` in `test/util/setup_common.cpp`? That's what I have been doing for now.\r\n\r\n> Copy operations in https://github.com/bitcoin/bitcoin/pull/29491/files#diff-612abe4a74f2e9f6903cebff057d47bfe4f8a57507c175743f4b62fde0d3cc58R95-R99\r\n\r\nI am not sure how to do this completely without copy, using span is unsafe because vChecks is cleared. Using emplace_back is possible and I am using it now but in the benchmarks I didnâ€™t see noticable improvement from this. Can you be a bit more specific what you had in mind?\r\n\r\n> Doing batch-verification work within the critical section https://github.com/bitcoin/bitcoin/pull/29491/files#diff-0f68d4063c2fb11000f9048e46478e26c0ea2622f7866d00b574f429c3a4db61R151\r\n\r\nI have implemented this and see a performance boost from it for the case with 15 worker threads (I didn't test all the other thread configuration yet). On my machine I now get these results (running `build/bin/bench_bitcoin -filter=ConnectBlockAllSchnorr -min-time=1000`):\r\n\r\nnovo (15 worker threads)\r\n```\r\n|            ns/block |             block/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|        9,285,356.00 |              107.70 |    1.6% |      1.09 | `ConnectBlockAllSchnorr`\r\n```\r\n\r\nthis latest state 9d460e82e1404f7cfb29613d3852bbb99e0071ad (15 worker threads)\r\n```\r\n|            ns/block |             block/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|        7,973,364.58 |              125.42 |    1.3% |      1.10 | `ConnectBlockAllSchnorr`\r\n```\r\n\r\nThank you for the continued valuable feedback, I have made you co-author of the relevant commit.\r\n\r\nA few comments on the latest code in the branch you linked to (0493ba332aba6ff0d6da55094fd8d834bb8cc18f):\r\n- Tracking if anything has been added to the batch and skipping verify makes sense as an idea but I have some issues with it: First of all, using the return value of `secp256k1_batch_add_schnorrsig` seems wrong because this will return false if something has gone wrong in adding the signature and this will usually mean that we have a problem, at least in the block verification process it definitely means that. So taking that to mean we donâ€™t have to verify anymore, itâ€™s fine doesnâ€™t seem right. Additionally in my opinion we shouldnâ€™t have to track this in bitcoin core because I believe secp256k1 should handle this. Such behavior should happen closest to the actual data IMO and if this is actually the case calling verify should be costless. In the current secp code the actual verification steps seem to be skipped here: https://github.com/bitcoin-core/secp256k1/pull/1134/files#diff-5a633b880f8591184912dc3e49b3dffc2af714b2fc27404d0a1b12f6a2df7a71R191 so it would be surprising to me if adding `m_needs_verify` gives a real performance boost. Did you benchmark this change in isolation and notice a performance impact? If you did see that I would be interested to dig into why that is. And fwiw, I could also be pursuaded to not trust secp with this and track this ourselves if this is what we usually do in core but I will need to look for some comparable reference code and understand the reasoning for this (seemingly) duplicate behavior.\r\n- IIUC you are using `queue.empty()` as the indicator that all the todos have been added, if I remember correctly I tried this at some point too but it turned out that there is no guarantee for that and it could be that the todos are just not added fast enough, hence the need for `m_complete`. So this means some threads could be verifying multiple times within a block. I donâ€™t see why this would be causing problems with the verification though, I think the result is still correct in this regard. But the question is how this impacts performance. Here as well I would find it kind of surprising if this is faster in practice but maybe my thinking is wrong and your benchmarks tell us we should switch to this approach instead, letting threads verify their batch when they have the chance instead of letting them go to sleep. But I also think we need to wait until we have pippenger as well because that could influence these results significantly I think.\r\n- Running the loop one more time only with `nNow = 0` to trigger the batch verification is very simple but I donâ€™t see how you ensure that all the thread batches have been verified before the master thread returns. It looks to me like as soon as the master thread has verified its batch it simply returns, no matter how many (or any) other threads have verified their batches already and any failures in these batches would be missed. This is what I track with `m_total_verified` here in the code. Additionally, setting `nNow = 0` has the unwanted side-effect that in the cleanup phase of the next iteration the loop seems to be in the very first iteration again and this leads to running `nTotal++;` giving the impression that there are more threads available. I guess this doesnâ€™t cause issues only because there is no tracking of how many of the total threads have already verified their batch.\r\n\r\nA few more comments on this latest push:\r\n- I have also been warming up to the idea of having the thread local batch object in `Loop` rather than in a checkqueue member, this saves us a few lines of code and I didn't see an impact on performance.\r\n- Additionally I have been looking into some c++20 multithreading features since the latest push and tested using std::barrier instead of the counter but so far I didn't see an improvement in performance or code clarity from it.\r\n- I have added a unit test for `BatchSchnorrVerifier`.\r\n- Just FYI, I don't think rebasing currently makes sense for me here because this would require rebasing the secp batch branch and the author is working on doing that shortly themselves so I would rather wait for that.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-2889288127",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "commented",
      "id": 2965262599,
      "node_id": "IC_kwDOABII586wvlEH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2965262599",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-12T06:20:40Z",
      "updated_at": "2025-06-12T06:20:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I couldn't figure out how to test the different thread configurations for the microbench with Benchkit. Are you using Benchkit there as well or are you just setting `worker_threads_num` in `test/util/setup_common.cpp`? That's what I have been doing for now.\r\n\r\nSorry I didn't state that. That's what I did for the microbench. I only use Benchkit for IBD bechmarks.\r\n\r\nI'm going to review and test latest changes.",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-2965262599",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "commented",
      "id": 2965616244,
      "node_id": "IC_kwDOABII586ww7Z0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2965616244",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-12T08:22:29Z",
      "updated_at": "2025-06-12T08:22:29Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I am not sure how to do this completely without copy, using span is unsafe because vChecks is cleared. Using emplace_back is possible and I am using it now but in the benchmarks I didnâ€™t see noticable improvement from this. Can you be a bit more specific what you had in mind?\r\n\r\nI was thinking it might be better to move away from the collecting sigs idea if the copy operations present a significant slowdown. I'll see if I can detect any performance changes in testing.\r\n\r\n> * Tracking if anything has been added to the batch and skipping verify makes sense as an idea but I have some issues with it: First of all, using the return value of `secp256k1_batch_add_schnorrsig` seems wrong because this will return false if something has gone wrong in adding the signature and this will usually mean that we have a problem, at least in the block verification process it definitely means that. So taking that to mean we donâ€™t have to verify anymore, itâ€™s fine doesnâ€™t seem right. Additionally in my opinion we shouldnâ€™t have to track this in bitcoin core because I believe secp256k1 should handle this. Such behavior should happen closest to the actual data IMO and if this is actually the case calling verify should be costless. In the current secp code the actual verification steps seem to be skipped here: https://github.com/bitcoin-core/secp256k1/pull/1134/files#diff-5a633b880f8591184912dc3e49b3dffc2af714b2fc27404d0a1b12f6a2df7a71R191 so it would be surprising to me if adding `m_needs_verify` gives a real performance boost. Did you benchmark this change in isolation and notice a performance impact? If you did see that I would be interested to dig into why that is. And fwiw, I could also be pursuaded to not trust secp with this and track this ourselves if this is what we usually do in core but I will need to look for some comparable reference code and understand the reasoning for this (seemingly) duplicate behavior.\r\n\r\nMakes sense. I agree. We do not need to do this in core.\r\n\r\n> * IIUC you are using `queue.empty()` as the indicator that all the todos have been added, if I remember correctly I tried this at some point too but it turned out that there is no guarantee for that and it could be that the todos are just not added fast enough, hence the need for `m_complete`. So this means some threads could be verifying multiple times within a block. I donâ€™t see why this would be causing problems with the verification though, I think the result is still correct in this regard. But the question is how this impacts performance. Here as well I would find it kind of surprising if this is faster in practice but maybe my thinking is wrong and your benchmarks tell us we should switch to this approach instead, letting threads verify their batch when they have the chance instead of letting them go to sleep. But I also think we need to wait until we have pippenger as well because that could influence these results significantly I think.\r\n> * Running the loop one more time only with `nNow = 0` to trigger the batch verification is very simple but I donâ€™t see how you ensure that all the thread batches have been verified before the master thread returns. It looks to me like as soon as the master thread has verified its batch it simply returns, no matter how many (or any) other threads have verified their batches already and any failures in these batches would be missed. This is what I track with `m_total_verified` here in the code. Additionally, setting `nNow = 0` has the unwanted side-effect that in the cleanup phase of the next iteration the loop seems to be in the very first iteration again and this leads to running `nTotal++;` giving the impression that there are more threads available. I guess this doesnâ€™t cause issues only because there is no tracking of how many of the total threads have already verified their batch.\r\n\r\nIt seems like the major reason for performance drop was the batch-verification work being performed in the critical section. I'll try to reproduce your latest results.",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-2965616244",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "reviewed",
      "id": 2930314844,
      "node_id": "PRR_kwDOABII586uqQ5c",
      "url": null,
      "actor": null,
      "commit_id": "bcd51a49f8b8892254288d7522435287f055f92f",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-06-15T19:32:11Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#pullrequestreview-2930314844",
      "submitted_at": "2025-06-15T19:32:11Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18797979154,
      "node_id": "HRFPE_lADOABII586Ak_eDzwAAAARgcmYS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18797979154",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "bcbbb574b17a0449fa38f65f7c7f5a4f01a825b6",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/bcbbb574b17a0449fa38f65f7c7f5a4f01a825b6",
      "created_at": "2025-07-24T15:30:21Z"
    },
    {
      "event": "unlabeled",
      "id": 18799884106,
      "node_id": "UNLE_lADOABII586Ak_eDzwAAAARgj3dK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18799884106",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-24T17:20:16Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 18928007801,
      "node_id": "LE_lADOABII586Ak_eDzwAAAARoMnp5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18928007801",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-31T22:54:19Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 19942401561,
      "node_id": "UNLE_lADOABII586Ak_eDzwAAAASkqOYZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19942401561",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-26T12:00:23Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22293095126,
      "node_id": "HRFPE_lADOABII586Ak_eDzwAAAAUwxaLW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22293095126",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "452a3754bf77adb7484d789469973f05d4c0e692",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/452a3754bf77adb7484d789469973f05d4c0e692",
      "created_at": "2026-01-26T15:56:25Z"
    },
    {
      "event": "reviewed",
      "id": 3705903604,
      "node_id": "PRR_kwDOABII587c45n0",
      "url": null,
      "actor": null,
      "commit_id": "452a3754bf77adb7484d789469973f05d4c0e692",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-26T15:57:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased on latest master and included the latest API changes in the batch module PR in secp256k1.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#pullrequestreview-3705903604",
      "submitted_at": "2026-01-26T15:57:38Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
    },
    {
      "event": "labeled",
      "id": 22294486721,
      "node_id": "LE_lADOABII586Ak_eDzwAAAAUw2t7B",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22294486721",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-26T16:54:51Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3800626880,
      "node_id": "IC_kwDOABII587iiPbA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3800626880",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-26T16:55:11Z",
      "updated_at": "2026-01-26T16:55:11Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\nðŸš§ At least one of the CI tasks failed.\n<sub>Task `fuzzer,address,undefined,integer`: https://github.com/bitcoin/bitcoin/actions/runs/21364278324/job/61491586498</sub>\n<sub>LLM reason (âœ¨ experimental): Fuzz target crash: libFuzzer reported a deadly signal (exit code 77) during fuzz run.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#issuecomment-3800626880",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29491"
    },
    {
      "event": "unlabeled",
      "id": 22296003013,
      "node_id": "UNLE_lADOABII586Ak_eDzwAAAAUw8gHF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22296003013",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-26T18:01:44Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22316972640,
      "node_id": "HRFPE_lADOABII586Ak_eDzwAAAAUyMfpg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22316972640",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "3029493ef1e1a07995304b08001225f9fda6e882",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/3029493ef1e1a07995304b08001225f9fda6e882",
      "created_at": "2026-01-27T12:53:33Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22322554849,
      "node_id": "HRFPE_lADOABII586Ak_eDzwAAAAUyhyfh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22322554849",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "c5a124f429d7447bf08d2d82a8af5b294acfa759",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/c5a124f429d7447bf08d2d82a8af5b294acfa759",
      "created_at": "2026-01-27T16:19:15Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22323579338,
      "node_id": "HRFPE_lADOABII586Ak_eDzwAAAAUylsnK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22323579338",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "3979539ced5afc82a7858538ca9c49a5cd16cc43",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/3979539ced5afc82a7858538ca9c49a5cd16cc43",
      "created_at": "2026-01-27T17:00:25Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22380716943,
      "node_id": "HRFPE_lADOABII586Ak_eDzwAAAAU1_qOP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22380716943",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "46d1cf7efe2019e379bf2ebc1e4f59701d4d111e",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/46d1cf7efe2019e379bf2ebc1e4f59701d4d111e",
      "created_at": "2026-01-29T15:42:08Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22381747835,
      "node_id": "HRFPE_lADOABII586Ak_eDzwAAAAU2Dl57",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22381747835",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "41e0ea662abdc5259ee05080f4e0a037a38e5d4c",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/41e0ea662abdc5259ee05080f4e0a037a38e5d4c",
      "created_at": "2026-01-29T16:19:23Z"
    },
    {
      "event": "unlabeled",
      "id": 22383988904,
      "node_id": "UNLE_lADOABII586Ak_eDzwAAAAU2MJCo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22383988904",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-29T17:51:32Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 22422356880,
      "node_id": "LE_lADOABII586Ak_eDzwAAAAU4egOQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22422356880",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-31T01:08:21Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQ0MDYzNzBjNzA2NGZiNjMxZjM0NWI3ODk0ZjI5OGI0NmY1NThmNjI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d406370c7064fb631f345b7894f298b46f558f62",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d406370c7064fb631f345b7894f298b46f558f62",
      "tree": {
        "sha": "b002bf66fe4182915b546a12f96605a51df743ab",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b002bf66fe4182915b546a12f96605a51df743ab"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree b002bf66fe4182915b546a12f96605a51df743ab\nparent 3d180d3c7f1f26c2fb3139937406cc84dbea5325\nauthor Fabian Jahr <fjahr@protonmail.com> 1741721249 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1769866087 +0100\n\nvalidation: Add BatchVerify (unused)\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAml+A2cVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jN5xoP/jmkHAKqAMWEDPAQtOoNlaw9SFls\n6YXLFdVEb/QkSXTpNvQYDsSqI0iaj+yBsFTj0wMc/M8wL7WhDBXBbm3d5XXDS/jY\nFoh8xP04UBi4ZClB+RSk+7trhCyqYjKCorR1eTPh+8yJwvrtPnowNt91iZtBobi4\nEWRHXh2uAYXIPgBKYlQmnRB+JlnGDXnVSxyoAtj33OyO1hbl4ZEhGi8N5Bd4p3Tu\n+boEPWsoIWW3hz1yh2rVHcnqGvGPAIGeDCFmxVpwFEr48m02U8P4V6mP33nHJRkR\nWGayJRsJfEIvItKV5usxH5lC1HJ3hIvpx2ZJRy7nQNlBZy6UvujWH3hcZDVlIIx0\nvgLYXoAw8NLYOFzuFAh+zSFoNy2DQr34+MuUaaHqhXi5DMLrcoXi2JqoFVRAwYvU\nbPLeOq7u/WSdkNqD+ngOXIBT3Fti8UDy9DDAdCYwWr63xkufAS/TR4wrE6W42heS\nSLmVLsYp55T56bTpnTzndkZd+xtyCWUAWkqyV8GaEAyhIUaVMYhtVEZWNc8jgNuA\nK7z42ILvW3MWOCmpJOJTlrchT/a3p6vrQFfm+AcJ6/i+ihoUw37SY6J8iWO4JcGN\nxEl/ROv89rdIbPep+UcYaQZIvIG6/NJOM8DF8eUI9dmBDZm7rwP8t8toMcpFQugy\nk8ZxMIHFGI4RNXdl\n=Xudb\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3d180d3c7f1f26c2fb3139937406cc84dbea5325",
          "sha": "3d180d3c7f1f26c2fb3139937406cc84dbea5325",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/3d180d3c7f1f26c2fb3139937406cc84dbea5325"
        }
      ],
      "message": "validation: Add BatchVerify (unused)",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-31T13:28:07Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-03-11T19:27:29Z"
      },
      "sha": "d406370c7064fb631f345b7894f298b46f558f62"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGVhOWE4NGFiM2MzZGNjYzhlZWJjOTY4OWIwMjQyZjY3YjgzZmVkMjQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ea9a84ab3c3dccc8eebc9689b0242f67b83fed24",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ea9a84ab3c3dccc8eebc9689b0242f67b83fed24",
      "tree": {
        "sha": "46e418705a2b1946481431e91c9dafe52f1c45e4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/46e418705a2b1946481431e91c9dafe52f1c45e4"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2fccbea3c8a0e9a994cf3c49db9c74174f5338fc",
          "sha": "2fccbea3c8a0e9a994cf3c49db9c74174f5338fc",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2fccbea3c8a0e9a994cf3c49db9c74174f5338fc"
        }
      ],
      "message": "Squashed 'src/secp256k1/' changes from 14e56970cb..15ea24cb8c\n\n15ea24cb8c batch: make add functions void & introduce reset\nbfcc479a35 batch: remove `batch_usable` api\n15e388e096 batch: make tests functions internal & static\naac054a373 fix typos & index the right inputs for benchmarks\nc07e710003 batch: remove experimental status\n49fb753393 test: fix ci failures\ne96dabb4af batch: Generate speedup graphs\nb0b3425cd4 batch, extrakeys: Add benchmarks\n9d5115156b batch: Add tests for batch_add_* APIs\n668199c917 batch,ecmult: Add tests for core batch APIs and strauss_batch refactor\n53a158203f batch: Add example\nb40b4186b8 batch: Add batch_add_* APIs\n2bed1cb6ee batch, ecmult: Add batch_verify and refactor strauss_batch\n8f13eeae31 batch: Add create and destroy APIs\n0b6b0c87ad batch: Initialize an experimental batch module\nREVERT: 14e56970cb Merge bitcoin-core/secp256k1#1794: ecmult: Use size_t for array indices\nREVERT: c7a52400d6 Merge bitcoin-core/secp256k1#1809: release cleanup: bump version after 0.7.1\nREVERT: ae7eb729c0 release cleanup: bump version after 0.7.1\nREVERT: 1a53f4961f Merge bitcoin-core/secp256k1#1808: Prepare for 0.7.1\nREVERT: 20a209f11c release: prepare for 0.7.1\nREVERT: c4b6a81a60 changelog: update in preparation for the v0.7.1 release\nREVERT: ebb35882da Merge bitcoin-core/secp256k1#1796: bench: fail early if user inputs invalid value for SECP256K1_BENCH_ITERS\nREVERT: c09215f7af bench: fail early if user inputs invalid value for SECP256K1_BENCH_ITERS\nREVERT: 471e3a130d Merge bitcoin-core/secp256k1#1800: sage: verify Eisenstein integer connection for GLV constants\nREVERT: 29ac4d8491 sage: verify Eisenstein integer connection for GLV constants\nREVERT: 4721e077b4 Merge bitcoin-core/secp256k1#1793: doc/bench: added help text for SECP256K1_BENCH_ITERS env var for bench_ecmult\nREVERT: bd5ced1fe1 doc/bench: added help text for SECP256K1_BENCH_ITERS env var for bench_ecmult\nREVERT: 47eb70959a ecmult: Use size_t for array indices in _odd_multiplies_table\nREVERT: bb1d199de5 ecmult: Use size_t for array indices into tables\nREVERT: 2d9137ce9d Merge bitcoin-core/secp256k1#1764: group: Avoid using infinity field directly in other modules\nREVERT: f9a944ff2d Merge bitcoin-core/secp256k1#1790: doc: include arg -DSECP256K1_USE_EXTERNAL_DEFAULT_CALLBACKS=ON for cmake\nREVERT: 0406cfc4d1 doc: include arg -DUSE_EXTERNAL_DEFAULT_CALLBACKS=1 for cmake\nREVERT: 8d445730ec Merge bitcoin-core/secp256k1#1783: Add VERIFY_CHECKs and documentation that flags must be 0 or 1\nREVERT: aa2a39c1a7 Merge bitcoin-core/secp256k1#1778: doc/bench: Added cmake build options to bench error messages\nREVERT: 540fec8ae9 Merge bitcoin-core/secp256k1#1788: test: split monolithic ellswift test into independent cases\nREVERT: d822b29021 test: split monolithic ellswift test into independent cases\nREVERT: ae00c552df Add VERIFY_CHECKs that flags are 0 or 1\nREVERT: 5c75183344 Merge bitcoin-core/secp256k1#1784: refactor: remove ret from secp256k1_ec_pubkey_serialize\nREVERT: be5e4f02fd Merge bitcoin-core/secp256k1#1779: Add ARG_CHECKs to ensure \"array of pointers\" elements are non-NULL\nREVERT: 3daab83a60 refactor: remove ret from secp256k1_ec_pubkey_serialize\nREVERT: 8bcda186d2 test: Add non-NULL checks for \"pointer of array\" API functions\nREVERT: 5a08c1bcdc Add ARG_CHECKs to ensure \"array of pointers\" elements are non-NULL\nREVERT: 3b5b03f301 doc/bench: Added cmake build options to bench error messages\nREVERT: e7f7083b53 Merge bitcoin-core/secp256k1#1774: refactor: split up internal pubkey serialization function into compressed/uncompressed variants\nREVERT: b6c2a3cd77 Merge bitcoin-core/secp256k1#1761: ecmult_multi: reduce strauss memory usage by 30%\nREVERT: f5e815f430 remove secp256k1_eckey_pubkey_serialize function\nREVERT: 0d3659c547 use new `_eckey_pubkey_serialize{33,65}` functions in modules (ellswift,musig)\nREVERT: adb76f82ea use new `_eckey_pubkey_serialize{33,65}` functions in public API\nREVERT: fc7458ca3e introduce `secp256k1_eckey_pubkey_serialize{33,65}` functions\nREVERT: 2f73e5281d group: Avoid using infinity field directly in other modules\nREVERT: 26166c4f5f ecmult_multi: reduce strauss memory usage by 30%\n\ngit-subtree-dir: src/secp256k1\ngit-subtree-split: 15ea24cb8c1bd239a7a39939da1952cf6d3a35b0",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-31T13:28:15Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-31T13:28:15Z"
      },
      "sha": "ea9a84ab3c3dccc8eebc9689b0242f67b83fed24"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDMyNGEzMzhlMTlmYzZiZWVkZmU4NzU1ZmJlMGNlYTI2NDUzYTRiNjE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/324a338e19fc6beedfe8755fbe0cea26453a4b61",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/324a338e19fc6beedfe8755fbe0cea26453a4b61",
      "tree": {
        "sha": "98f7c1ad6e7ebde304452abb8abc2d24a0697ee6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/98f7c1ad6e7ebde304452abb8abc2d24a0697ee6"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 98f7c1ad6e7ebde304452abb8abc2d24a0697ee6\nparent d406370c7064fb631f345b7894f298b46f558f62\nparent ea9a84ab3c3dccc8eebc9689b0242f67b83fed24\nauthor Fabian Jahr <fjahr@protonmail.com> 1769866095 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1769866095 +0100\n\nMerge commit 'ea9a84ab3c3dccc8eebc9689b0242f67b83fed24' into HEAD\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAml+A3IVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNzYgQAKU2Co53JwnKeY3/TVCt1HBJndnb\nja+U8yfKSnRAySyik94oen31nDUW2aNhbMuxnqCb1VAhu577yixN0RYyMIJGWei8\n0+O5c+h1V9MVRiQUbla79MzAtB03dihkurADtgDw1EYWEfYxOxjHwVq2a/OY6vhC\nYitv3+ucIkdlxMb9oRYrxof1fD3x1I31SYExfO/s+CsaEwlzzp0uuSMzuK58TnDi\nhi3LI2yF4y8iGhscNUmkjvupO0c3k4hT71IkcBUnHu9HY33IUbfSBQbrQAKZt89m\nafQLyISuJIXz1DV8Vyc4Kd6Wl3xxg9YCE4taaClNGeq4w+KElc+zYfy4xgozJPC5\ncfmfS7vMCd8qjO9I7GMrMzm0OiJhyp0FjLYEwISh8W8AwrCTzRqhCLxB88jit6KM\nvk/TogIN8et9OBY/EVkT736kovCO8FvJMILAMZ+P+E40w27iAzuUYF7mKeM3wTkl\ndm4SpjjY1jfPGy6GQ/ApLShWnTs9Con7DBakrc/ShngyfF9Bc4Qr1vCpuhNg9NjY\nRwNUrIj4WyfMhsAyWSwSjjbeIVmlWCyC2URaAh3K3TfqbJaSJtJTgW9La53rIu1L\nl7dhqYkvZEfph/7vGmXkBYkgfBVQpLHju8ZjtRfo6kguWT0sgDUZuxB06CIZLoog\nL3qZTYxu63dFlobf\n=QbvM\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d406370c7064fb631f345b7894f298b46f558f62",
          "sha": "d406370c7064fb631f345b7894f298b46f558f62",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d406370c7064fb631f345b7894f298b46f558f62"
        },
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ea9a84ab3c3dccc8eebc9689b0242f67b83fed24",
          "sha": "ea9a84ab3c3dccc8eebc9689b0242f67b83fed24",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ea9a84ab3c3dccc8eebc9689b0242f67b83fed24"
        }
      ],
      "message": "Merge commit 'ea9a84ab3c3dccc8eebc9689b0242f67b83fed24' into HEAD",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-31T13:28:15Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-31T13:28:15Z"
      },
      "sha": "324a338e19fc6beedfe8755fbe0cea26453a4b61"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU2Yjc4NjI5NDNlNzdmYWU2M2YyZDFkZjliMTg4ZGM1YzYwMGI2MzI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e6b7862943e77fae63f2d1df9b188dc5c600b632",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e6b7862943e77fae63f2d1df9b188dc5c600b632",
      "tree": {
        "sha": "887f7a3f5b136d4b1d718a5b5fea77c99f70dc3c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/887f7a3f5b136d4b1d718a5b5fea77c99f70dc3c"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 887f7a3f5b136d4b1d718a5b5fea77c99f70dc3c\nparent 324a338e19fc6beedfe8755fbe0cea26453a4b61\nauthor Fabian Jahr <fjahr@protonmail.com> 1741723569 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1769866126 +0100\n\nscript: Add batch validation error\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAml+A5AVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNjSsQAJ3RdMTekrltj3RzIsz0x+d5HBaH\nEo6nwVIPAMzVdqzQlYcbJ53BroQNEOCRnUDXUlWGeFS45Cn8c73nWDyMDIqI+ZY/\niag07RFi/TqVb8AFMeQwW1/jGTf/4yxDF+Eky4H1twBfCFdPdo2qu3/T7eUWgxWI\n6PzKewnKk2LyvdyV/b0bLgkDvCMBRzipSpLnRpfXULLYvIUyIEk02g+q5lOxWwlZ\niaugDAef2kKoZ+Ng2h2Ek7fS6wdgJrw1RGvaEkJvy7TkCjaNUWelq+yWhwGfUVUF\nausgqriESkpbqATI1lJSES5kNgVVImgUVKU6r1ZsjE7TGXOsAodVZXGU3/slK3Ku\nWhSY2mBqRIs5MO3bEBfdB0Ts9TxVrsWpa69S6jWJHZwvfew5vUeLG/ELLOjwTmK9\nv61H4MluV44amUK8OOkkoKWbIvgeH9C/wLcRGxfJ9459n5R+PWvFDVZbByPil/b5\nQ91tK9mVeEwH+tDE1jTKe0Pw7F+brWrTmZN4koKY3lYEc/znh2q2OAgWTBrd64ZU\nvqjy7u5dliIrgq1l2PyJL+xtCGAXpQ2E3Wv5LINC1krNPnqsF4yKb7C+vpW3CCoM\n8CFmqzpmGcemvD4Wy4ybEC4mC6e2r6lsAnMbsRjmS8wFqQRfgIORT8rrCEwJd2bf\nbZvmrwQfupkEtEUF\n=ztVk\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/324a338e19fc6beedfe8755fbe0cea26453a4b61",
          "sha": "324a338e19fc6beedfe8755fbe0cea26453a4b61",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/324a338e19fc6beedfe8755fbe0cea26453a4b61"
        }
      ],
      "message": "script: Add batch validation error",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-31T13:28:46Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-03-11T20:06:09Z"
      },
      "sha": "e6b7862943e77fae63f2d1df9b188dc5c600b632"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNkOTU4ZGZjZjQ4MmZkMGEzZjE5M2E3YzBkZjE1MjM2ZTI4MDNiY2Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cd958dfcf482fd0a3f193a7c0df15236e2803bcd",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/cd958dfcf482fd0a3f193a7c0df15236e2803bcd",
      "tree": {
        "sha": "8233cee67798395da8f1128fef02a1101d312ce1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8233cee67798395da8f1128fef02a1101d312ce1"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 8233cee67798395da8f1128fef02a1101d312ce1\nparent e6b7862943e77fae63f2d1df9b188dc5c600b632\nauthor Fabian Jahr <fjahr@protonmail.com> 1741724741 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1769866128 +0100\n\nsigcache: Add CollectingSignatureChecker\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAml+A5AVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNxvQP/2/239hgFlUW41SAIvRVXClhrnBj\n4ij73OrOcHn/pa7clLmzHc7nniCm035xOd0kSq7XLlv+zxSnsvqSjhYQevy0cD8r\n3ptiW0FcKIU/3MhqqPBPPC5JxrwwIhkiScFMmA88O1zMZZ/fWeTG63oI/t9XLNJH\nTip0lkKTUMp9jXoF+UmtHgO/Jv8LhBFH/Rr2QgPtQG/Bi9MYl4qSUysgmRyym5/F\n5dkqDP5zwME3kkNk6BHke6x12OS/KTxnQ6iIgKgwsSy2stdNi77Qzuyn+U+01kdA\nA+WoBv4VXXjhmjN8mgBDO0cUZq6ONq4G38YI8MKaQfqeYif3wEh2m9P6dcz3kJGz\ncoXh7/jw9AO64U6tF+i+Nf+E8c4mH++iFmsB5msE8E+Wtm80ICX6w4IvwNFIJsIK\nyh/16yFpgAe9bFk5HxydvYY0634L8JqN8IDPcLAaPacaKgKci4+igABn40WzTxFz\n+x8SuzBV5LLxwCJgW490FrQlsnL0hhL87V7Mk+31imw5t2zJptkoOE9NLD87G9FY\nEEIvV1C946TpMK98WdmMAOtzY0z96Bhfo8JXDi1XALFDSrUtUQSndCGRbi0r/O0q\nVFAlosTIrRCntoCowAM9ngIz+MibMFdojfH4YlkpWC9L/YdvCoBwzDEojaYuSq6m\ni3KYlbUMZtjpxWN0\n=Jhkc\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e6b7862943e77fae63f2d1df9b188dc5c600b632",
          "sha": "e6b7862943e77fae63f2d1df9b188dc5c600b632",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e6b7862943e77fae63f2d1df9b188dc5c600b632"
        }
      ],
      "message": "sigcache: Add CollectingSignatureChecker",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-31T13:28:48Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-03-11T20:25:41Z"
      },
      "sha": "cd958dfcf482fd0a3f193a7c0df15236e2803bcd"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDg1MDhkMDg1OTdjMzIxMTFiMDJhMmYzMDIzMTkyYjYzMmYxNjMzYzU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8508d08597c32111b02a2f3023192b632f1633c5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8508d08597c32111b02a2f3023192b632f1633c5",
      "tree": {
        "sha": "15ecbff7a378953a77d8bbb07f4c44df4931646e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/15ecbff7a378953a77d8bbb07f4c44df4931646e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 15ecbff7a378953a77d8bbb07f4c44df4931646e\nparent cd958dfcf482fd0a3f193a7c0df15236e2803bcd\nauthor Fabian Jahr <fjahr@protonmail.com> 1741731871 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1769866128 +0100\n\nvalidation: Add BatchableScriptChecker\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAml+A5AVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNeB4P/29340F+2F5E8ljnQOeq4OUUw5TM\nitkUn0S6vqBt9GodTuEJJAxjQ/r4TnhVs+lcd8P0FV1UVJO4NZGsyszGcrIhDmFb\n32eJAY7ynoGv5LJCi73SdZXkIcrvx0OXBjVC0QJ69sikeXjF83i93MlY/WYgASM5\n79xxGVxIu5kj4RfXQ7EIcgIlKsOx04QxcCY/vAXAE+3gnpz6QxhYqjC1wOrVgHcZ\np/5t9Vhi+t6vKZPqDGBqfN+BM6CbvvQeK4ZQxYO2oASDqEgotYjKfIBeSLaXvbXz\nzXkgSMa1laZhz9+Fe1qbTExO3uJ86TFqZyoPrWnzKvL1LyhxM2/zCLIrjwFkWl6q\npTVQznunuE6ZAL2EMeCQeY0/+zxe62HHBfGGb2xZtqMiIepvYIzyr02Vjhv/sShs\n/NhiY436m31/B+1QzZLDHTrttNroqRenDEBgwSQCKfeLQN+RLby1nUnfb9x9EZcb\nhlQRZOtcBKV2Xl5a6/3La0M3qJxyO7x+gKWslYotntao67BbZuwD+m3dSc1Hmlty\nIMYB8HYa+V8aAdaHmPVj5ari2x4sylbbMrBlbkfJJJepigEKndR+3beLN/YwpN+a\n5oMiKoTX/vpJhXVVa25HazN5LydVjbzPbIX29HG8A5PIuDIEq6h4qI0/ICcJMlxJ\nomFJaT+QT7m34DQM\n=u5uV\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cd958dfcf482fd0a3f193a7c0df15236e2803bcd",
          "sha": "cd958dfcf482fd0a3f193a7c0df15236e2803bcd",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/cd958dfcf482fd0a3f193a7c0df15236e2803bcd"
        }
      ],
      "message": "validation: Add BatchableScriptChecker",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-31T13:28:48Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-03-11T22:24:31Z"
      },
      "sha": "8508d08597c32111b02a2f3023192b632f1633c5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDEzYWIzMTVhODIyNzEzMjM3M2ViOTk4NDFmZGIyOGI0ZDBkZWZjNDY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/13ab315a8227132373eb99841fdb28b4d0defc46",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/13ab315a8227132373eb99841fdb28b4d0defc46",
      "tree": {
        "sha": "b42aa1c45b88c88037afac47fa8f3c335c894769",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b42aa1c45b88c88037afac47fa8f3c335c894769"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree b42aa1c45b88c88037afac47fa8f3c335c894769\nparent 8508d08597c32111b02a2f3023192b632f1633c5\nauthor Fabian Jahr <fjahr@protonmail.com> 1741732220 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1769866128 +0100\n\nvalidation: Use schnorr signature batch validation in parallel script verification\n\nCo-authored-by: Eunovo <eunovo9@gmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAml+A5AVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNX7oP/jzJPcfJPfYfS8DlOnJnz6j4/3zb\n8puyLGLU7XCFnp5hxhrc6Z6ElOilnGu3i+m5sZPdb9oHaQ2Ip4KXcPGP6cQ6+pOQ\ns4QisA1VLQ6+Kv4mYK20pqjBrutIXQY5eLauYsP4Y+cbZxK86D0HzTSDjrn36vVX\nWNpWqAhyGL+E2VpBpSXnmjH4dVr+R0GTZUsTJCYWLu4GiuwMItZfkX7OYm/6u7E6\nmV/Yiu2cJ/i1Po6CZ+sMXkD43RKCNv+scrN+BY/wQ8kJhv1wD1KuEGxkcKqjB+3m\nR9LIeXKCgn++e8T8gCDlpq4JI8RFMnGoWdK05PxBuBjjeSmdIxfEde0GsQpPlOQB\nWAX02RDARq7sfMUfVenLSFLjn8+Lel0dU+j4SUZJi/+UTcLHx1sNQkZfgUtsN506\nLQdxNPovP0qdoZTiKZmW0yEkfJGbD/ctg78PQ4GTOBzTvvYJnD3rIS0ZGK8+ClgF\nhobNPx2NjPQqmlXTrC72AjMKXwv+Kv64OudgMKoKdqnznyaEta/fvdTjaN/WDQJZ\nwgSpHUvPM4/Ck/7gfb+BOPStSVeL1GuDXfwpbhnbLw0JHAZfq/FGYD5mRBb98IB8\nUJX8iQaQM0CZvHN6l8wp7UBAOnc9EixmwFbaWICzYdWWG3mCDdr3emYr/qQ4hmAw\nIfAysNwCYViLZv/u\n=Z3eZ\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8508d08597c32111b02a2f3023192b632f1633c5",
          "sha": "8508d08597c32111b02a2f3023192b632f1633c5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8508d08597c32111b02a2f3023192b632f1633c5"
        }
      ],
      "message": "validation: Use schnorr signature batch validation in parallel script verification\n\nCo-authored-by: Eunovo <eunovo9@gmail.com>",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-31T13:28:48Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-03-11T22:30:20Z"
      },
      "sha": "13ab315a8227132373eb99841fdb28b4d0defc46"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM0M2MzMWMzZmQ1Yjc2YjljYzAyNmIzNWZiY2IxNjA2OTM1OTRhNGQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c43c31c3fd5b76b9cc026b35fbcb160693594a4d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c43c31c3fd5b76b9cc026b35fbcb160693594a4d",
      "tree": {
        "sha": "65fdbecda81847a2b15eb47491be854947f2d9b3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/65fdbecda81847a2b15eb47491be854947f2d9b3"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 65fdbecda81847a2b15eb47491be854947f2d9b3\nparent 13ab315a8227132373eb99841fdb28b4d0defc46\nauthor Fabian Jahr <fjahr@protonmail.com> 1741736544 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1769866128 +0100\n\nvalidation: Use schnorr batch validation in single thread case\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAml+A5AVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNnXsP/1QeCgZw56PG2evcjwxwstjrYT0v\nq9Ln37GdXCUtl54Z7ZvZyE+NA2xB16yHVP4IXUKT4u41l4JNyVtGnqVceBWmkapQ\nxggULjXOk33PYHPH6WDakpqL82lagSo97CWTA1/Z8lcAGqesbvf525ui7/6tXq/R\nNovAvC3EC8RmeW9ch76s6fDQIHssVHw9P34B2KLcIwd7MM1+kgUhMdu1/xazqzcg\n4Z9+2dFMRdNugRDUHSIaWNdCAzuBQC0h+OaVqLb0TGDZQO8v296fQptJX8OY3C1+\n/uQnGam/QKQEFjHyNqkU/HiTPhBEjjlN4ecQCChE+ju8/pULew2VDHI6S0RB5fK0\nRCTcqesMutFPeP1HqhvLqgzwP9lh9GNdFat9NChq0VDj+JdRCFXF51rgVSiQOJvM\n+g1yx12bX2eJC7BzsIQrl25k8sphH8aJBf+qGWqKyXWsCra6eoaDS6ZyhfpTVPlX\nGJRd6MZ/2NhkYL93lwZJd5+HLceoqK5w3DVAx9UDzYbsSw+hDr5dec6FrdLguTCz\nWHuy1efc/CKonc0eqK+/7YywrtlFiLYLpzyQZ7u1US1n6qg31yRrdtWRdvSx3rnZ\nMXzaKtqr5g6G0RIrjUV1/aoZbEeAG7jpED/ZJFepII/4IWWLcCIgX5DUdlIFQarp\n14PXWnsW5XSd0Zn5\n=wdVi\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/13ab315a8227132373eb99841fdb28b4d0defc46",
          "sha": "13ab315a8227132373eb99841fdb28b4d0defc46",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/13ab315a8227132373eb99841fdb28b4d0defc46"
        }
      ],
      "message": "validation: Use schnorr batch validation in single thread case",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-31T13:28:48Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-03-11T23:42:24Z"
      },
      "sha": "c43c31c3fd5b76b9cc026b35fbcb160693594a4d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGYwM2M0M2FlZDA3MmI5ZmIwNTNmODY0Mjk4ZGI5MDQwYzA2OWI0NTI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f03c43aed072b9fb053f864298db9040c069b452",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f03c43aed072b9fb053f864298db9040c069b452",
      "tree": {
        "sha": "32c59a88f0f6f6f9427608a833720625c5f67c5b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/32c59a88f0f6f6f9427608a833720625c5f67c5b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 32c59a88f0f6f6f9427608a833720625c5f67c5b\nparent c43c31c3fd5b76b9cc026b35fbcb160693594a4d\nauthor Fabian Jahr <fjahr@protonmail.com> 1742237053 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1769866128 +0100\n\nfuzz: Add basic fuzz test for BatchSchnorrVerifier\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAml+A5AVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNlL8P/iZguRzT3Q+sVbaMhVg5tA5fcg99\nNtFw0bNqwQ3YoqX9Y6K7SWp8jZCbq2CxZ5ULFZOPNaTw2GAne3J9nLFyOklDAO8h\nL5CTMTkBb4U7C5Ncc+7dCD4+KtDFqip/DRSrobFc4B7bDDoMhDuQfQgNoEC84R+O\njLBjRb6B2A1Gw/q8ZcQikbSIai0UK4eWalIf+3To3TSGU6A0RDDOy2pyiLXvh8Dj\nEjuGY/XJqbepo3u+XOlNQHJ3ByilyzjlDWuM9CuBOgcGPWWtu43yiu+yXqICLLgl\nbr1XRGKIdRGAonFoGdWyINIgisK5MUGAVW2rUUaS7hx1WcDsE7XiIf22168LFzgB\nPJ8vaT35HOZCMNNYzLrFdlMicSXvvT5ywx8szn5N1BJXEIHNvP6dWnfqwUFUbPgb\ngbarW0yTMttt9CSpJ0lAuOtyEvmsHAyJGEnDZIHFod62/yjc6PxBHu0yGGuRioXp\nVMHUBaYhq29blu1Rd4BtkbHE3AcGW+PKt1eFpE5FMc+bp21DUaI91hQ4bbtEgUXi\n8sEdIjfnc/N+UvF1/Y5ye91WFOtJBdxGDDScI7qvw0MlJMPWTNvI0oMrddvZv3/H\nsZb/DYKzYtt8+wD57mKajyEVryYklRx7GoFkOl/4a1HgKtBnokNFH/SQuSVfUkp0\nc1IMrgTVhDPtIo12\n=nhI+\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c43c31c3fd5b76b9cc026b35fbcb160693594a4d",
          "sha": "c43c31c3fd5b76b9cc026b35fbcb160693594a4d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c43c31c3fd5b76b9cc026b35fbcb160693594a4d"
        }
      ],
      "message": "fuzz: Add basic fuzz test for BatchSchnorrVerifier",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-31T13:28:48Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-03-17T18:44:13Z"
      },
      "sha": "f03c43aed072b9fb053f864298db9040c069b452"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGYxNzhjNmNiYTdkMTc5MzA4MzI0ZmY0YTIxYjdmZjIwZmMwOWVjMmM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f178c6cba7d179308324ff4a21b7ff20fc09ec2c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f178c6cba7d179308324ff4a21b7ff20fc09ec2c",
      "tree": {
        "sha": "205c0e5379a7cc064b28a546410854096be385a6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/205c0e5379a7cc064b28a546410854096be385a6"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 205c0e5379a7cc064b28a546410854096be385a6\nparent f03c43aed072b9fb053f864298db9040c069b452\nauthor Fabian Jahr <fjahr@protonmail.com> 1747607091 +0200\ncommitter Fabian Jahr <fjahr@protonmail.com> 1769866128 +0100\n\ntest: Add BatchSchnorrVerifier unit test\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAml+A5AVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNC4wP/iIMbG4wQa++8SfxAE99ZLQ6mgj9\nGQbWfiaco7dGJg8N+OPSI/tfDZpoW4OKMM0VCvQss0dPmjBYyc4BK+4O+/AxUUIv\nYIdScj7y54HSNidAaOIyj5yluNH4gxyOwww/XMuhJKr0CQ5QUT5NGRhG95lVILyV\n8iIwWI988lxXi+B+SlTFLjEPqq+y+360sXiPa0BfDHUG+PPEiXvBefX3Yv8nW2/Q\nGaBoy94gO/EG9SJVg36GT2Ro9rRIwv9lztCm4ayD8BCPuKeIlW3aIssEBL/KOyxx\nFjXYhiYk8f9yvSqvYjqAw0rZdtB1tDhHDqm4p15DRInYRhozoqU56BqMAmq3xk3X\nnDuy97ukP2q/g2/J/TrukTlmECzmEmwJOY5vuDjM5qKrb07M8EKR9KBFdyyrCh/E\n5oj3szKOteIcI+msXB7+pCaRYc/TMBq22V/1mpkAdukToEsgO7ElqiPE+K5X93iB\ncdpF4gmDP2G3mL4dSxQu/YtIErt/UxT6eeyBOQI0Tv6jr6ed0AVORY5Lwn//SzOV\n7NAkoiOzIrKAQHfIPiYEpbwyVgWezI5BJHD0eBl0SLzP0+2FtvmnIW0pYckjbZNd\nw/AuHLcTfCtgyF5TAve8Dt/c3L0jCA6YpZ9nDpYmIZXg6oe2HB9iWmNJtA8mQzMz\nTDGgoHAU/2Uxmn+R\n=DOBr\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f03c43aed072b9fb053f864298db9040c069b452",
          "sha": "f03c43aed072b9fb053f864298db9040c069b452",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f03c43aed072b9fb053f864298db9040c069b452"
        }
      ],
      "message": "test: Add BatchSchnorrVerifier unit test",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2026-01-31T13:28:48Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-05-18T22:24:51Z"
      },
      "sha": "f178c6cba7d179308324ff4a21b7ff20fc09ec2c"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22428992219,
      "node_id": "HRFPE_lADOABII586Ak_eDzwAAAAU430Lb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22428992219",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "f178c6cba7d179308324ff4a21b7ff20fc09ec2c",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/f178c6cba7d179308324ff4a21b7ff20fc09ec2c",
      "created_at": "2026-01-31T14:00:06Z"
    },
    {
      "event": "unlabeled",
      "id": 22430014024,
      "node_id": "UNLE_lADOABII586Ak_eDzwAAAAU47tpI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/22430014024",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-31T15:13:49Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1997499892",
      "pull_request_review_id": 2688529645,
      "id": 1997499892,
      "node_id": "PRRC_kwDOABII5853D230",
      "diff_hunk": "@@ -71,6 +72,22 @@ class CachingTransactionSignatureChecker : public TransactionSignatureChecker\n \n     bool VerifyECDSASignature(const std::vector<unsigned char>& vchSig, const CPubKey& vchPubKey, const uint256& sighash) const override;\n     bool VerifySchnorrSignature(Span<const unsigned char> sig, const XOnlyPubKey& pubkey, const uint256& sighash) const override;\n+\n+    bool GetStore() const { return store; }\n+    SignatureCache& GetSigCache() const { return m_signature_cache; }\n+};\n+\n+class CollectingSignatureChecker : public CachingTransactionSignatureChecker {",
      "path": "src/script/sigcache.h",
      "position": 1,
      "original_position": 17,
      "commit_id": "bcbbb574b17a0449fa38f65f7c7f5a4f01a825b6",
      "original_commit_id": "d333d5c6e3c4b454621998772ff74ff6656af691",
      "in_reply_to_id": null,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/29491/commits/d333d5c6e3c4b454621998772ff74ff6656af691: This is nice! sets us up nicely to later do batch taptweak checking since we can \"collect\" it too.",
      "created_at": "2025-03-16T06:47:20Z",
      "updated_at": "2025-03-16T06:47:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#discussion_r1997499892",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1997499892"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 81,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1997877541",
      "pull_request_review_id": 2689031245,
      "id": 1997877541,
      "node_id": "PRRC_kwDOABII5853FTEl",
      "diff_hunk": "@@ -128,8 +150,22 @@ class CCheckQueue\n             // execute work\n             if (do_work) {\n                 for (T& check : vChecks) {\n-                    local_result = check();\n-                    if (local_result.has_value()) break;\n+                    auto check_result = check();\n+\n+                    if constexpr (is_batchable_result_v<decltype(check_result)>) {\n+                        if (std::holds_alternative<ScriptFailureResult>(check_result)) {\n+                            local_result = std::get<ScriptFailureResult>(check_result);\n+                            break;\n+                        }\n+                        // Check succeeded; add signatures to shared batch\n+                        const auto& signatures = std::get<std::vector<SchnorrSignatureToVerify>>(check_result);\n+                        for (const auto& sig : signatures) {\n+                            m_batch.Add(sig.sig, sig.pubkey, sig.sighash);",
      "path": "src/checkqueue.h",
      "position": 1,
      "original_position": 69,
      "commit_id": "bcbbb574b17a0449fa38f65f7c7f5a4f01a825b6",
      "original_commit_id": "454103832351311d11e16505ed1925bd5f1c6875",
      "in_reply_to_id": null,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/29491/commits/454103832351311d11e16505ed1925bd5f1c6875: IIUC All the threads still share this batch. That means we still have the same locking problem; threads will be stuck waiting for the batch to be free.  In my very rough implementation https://github.com/bitcoin-dev-tools/benchcoin/pull/41/commits/173f07dc4493de3d3a9420f6a966606913277e9d#diff-0f68d4063c2fb11000f9048e46478e26c0ea2622f7866d00b574f429c3a4db61 I opted to give each batch a thread to resolve this.",
      "created_at": "2025-03-17T03:23:19Z",
      "updated_at": "2025-03-17T03:23:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#discussion_r1997877541",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1997877541"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 163,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2004525996",
      "pull_request_review_id": 2700654961,
      "id": 2004525996,
      "node_id": "PRRC_kwDOABII5853eqOs",
      "diff_hunk": "@@ -128,8 +150,22 @@ class CCheckQueue\n             // execute work\n             if (do_work) {\n                 for (T& check : vChecks) {\n-                    local_result = check();\n-                    if (local_result.has_value()) break;\n+                    auto check_result = check();\n+\n+                    if constexpr (is_batchable_result_v<decltype(check_result)>) {\n+                        if (std::holds_alternative<ScriptFailureResult>(check_result)) {\n+                            local_result = std::get<ScriptFailureResult>(check_result);\n+                            break;\n+                        }\n+                        // Check succeeded; add signatures to shared batch\n+                        const auto& signatures = std::get<std::vector<SchnorrSignatureToVerify>>(check_result);\n+                        for (const auto& sig : signatures) {\n+                            m_batch.Add(sig.sig, sig.pubkey, sig.sighash);",
      "path": "src/checkqueue.h",
      "position": 1,
      "original_position": 69,
      "commit_id": "bcbbb574b17a0449fa38f65f7c7f5a4f01a825b6",
      "original_commit_id": "454103832351311d11e16505ed1925bd5f1c6875",
      "in_reply_to_id": 1997877541,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "You're right, this wasn't a complete solution. I have improved this now by using buckets of signatures for each thread which are all added and only then verified by the master thread at the end. This could be further improved if we could add the signatures to a batch per thread right away but this would require that we could merge batch objects which the secp api currently doesn't make possible. I'll add that to my wish list because I think it should be even better than the current approach but it should be a comparatively minor improvement. I considered other approaches as well but this seems to be a very simple solution that does not rely on a more complex library or code or uses `thread_local` (which we try to avoid).\r\n\r\nYour approach does do batching in each thread but also per each `vChecks` allocation, which are surprisingly small, especially when there are a lot of threads available. This is what caused me to look more into the `nNow` algo behavior. With the current approach here I try to only do one verify call per block which should be the fastest approach once pippenger is used in secp.",
      "created_at": "2025-03-20T00:17:35Z",
      "updated_at": "2025-03-20T00:17:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#discussion_r2004525996",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2004525996"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 163,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2004559393",
      "pull_request_review_id": 2700735399,
      "id": 2004559393,
      "node_id": "PRRC_kwDOABII5853eyYh",
      "diff_hunk": "@@ -128,8 +150,22 @@ class CCheckQueue\n             // execute work\n             if (do_work) {\n                 for (T& check : vChecks) {\n-                    local_result = check();\n-                    if (local_result.has_value()) break;\n+                    auto check_result = check();\n+\n+                    if constexpr (is_batchable_result_v<decltype(check_result)>) {\n+                        if (std::holds_alternative<ScriptFailureResult>(check_result)) {\n+                            local_result = std::get<ScriptFailureResult>(check_result);\n+                            break;\n+                        }\n+                        // Check succeeded; add signatures to shared batch\n+                        const auto& signatures = std::get<std::vector<SchnorrSignatureToVerify>>(check_result);\n+                        for (const auto& sig : signatures) {\n+                            m_batch.Add(sig.sig, sig.pubkey, sig.sighash);",
      "path": "src/checkqueue.h",
      "position": 1,
      "original_position": 69,
      "commit_id": "bcbbb574b17a0449fa38f65f7c7f5a4f01a825b6",
      "original_commit_id": "454103832351311d11e16505ed1925bd5f1c6875",
      "in_reply_to_id": 1997877541,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think @Eunovo's approach is closer to what we want. Instead of a bucket per thread, have a batch per thread. However, instead of batch verifying after each `vChecks` batch, batch verify after the queue of checks is empty for the block. We need CCheckQueue::Complete to set a flag that no more checks will be added, and wake all threads again. The threads will all verify their batches once the global queue is empty. We would need to reset the flag after Complete.\n\nThis approach of verifying on master thread at the end will not be faster even with pippinger algo. The max speedup is closer to 2x, but multi threaded is 16x faster.",
      "created_at": "2025-03-20T00:45:20Z",
      "updated_at": "2025-03-20T00:56:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#discussion_r2004559393",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2004559393"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 163,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2005563093",
      "pull_request_review_id": 2702581295,
      "id": 2005563093,
      "node_id": "PRRC_kwDOABII5853inbV",
      "diff_hunk": "@@ -114,6 +124,12 @@ class CCheckQueue\n                     if (fMaster && nTodo == 0) {\n                         // All checks are done; master performs batch verification\n                         if constexpr (std::is_same_v<R, ScriptFailureResult>) {\n+                            for (auto& bucket : m_signature_buckets) {\n+                                for (const auto& sig : bucket) {\n+                                    m_batch.Add(sig.sig, sig.pubkey, sig.sighash);",
      "path": "src/checkqueue.h",
      "position": 1,
      "original_position": 32,
      "commit_id": "bcbbb574b17a0449fa38f65f7c7f5a4f01a825b6",
      "original_commit_id": "6055f3a6f530818e2805d11debb1fb2ce81fc5c0",
      "in_reply_to_id": null,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/29491/commits/6055f3a6f530818e2805d11debb1fb2ce81fc5c0: This leaves the master thread to do all the \"Pubkey recovery\"(I think that's what its called?) work in each `batch.Add` call, which is substantial. We can call \"secp256k1_xonly_pubkey_parse\" when collecting the signatures so the master thread is not stuck doing all the work to parse the XOnlyPubkey.",
      "created_at": "2025-03-20T12:46:37Z",
      "updated_at": "2025-03-20T12:46:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#discussion_r2005563093",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2005563093"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 129,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2009282526",
      "pull_request_review_id": 2708840199,
      "id": 2009282526,
      "node_id": "PRRC_kwDOABII5853wzfe",
      "diff_hunk": "@@ -128,8 +150,22 @@ class CCheckQueue\n             // execute work\n             if (do_work) {\n                 for (T& check : vChecks) {\n-                    local_result = check();\n-                    if (local_result.has_value()) break;\n+                    auto check_result = check();\n+\n+                    if constexpr (is_batchable_result_v<decltype(check_result)>) {\n+                        if (std::holds_alternative<ScriptFailureResult>(check_result)) {\n+                            local_result = std::get<ScriptFailureResult>(check_result);\n+                            break;\n+                        }\n+                        // Check succeeded; add signatures to shared batch\n+                        const auto& signatures = std::get<std::vector<SchnorrSignatureToVerify>>(check_result);\n+                        for (const auto& sig : signatures) {\n+                            m_batch.Add(sig.sig, sig.pubkey, sig.sighash);",
      "path": "src/checkqueue.h",
      "position": 1,
      "original_position": 69,
      "commit_id": "bcbbb574b17a0449fa38f65f7c7f5a4f01a825b6",
      "original_commit_id": "454103832351311d11e16505ed1925bd5f1c6875",
      "in_reply_to_id": 1997877541,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Instead of a bucket per thread, have a batch per thread. However, instead of batch verifying after each vChecks batch, batch verify after the queue of checks is empty for the block. We need CCheckQueue::Complete to set a flag that no more checks will be added, and wake all threads again. The threads will all verify their batches once the global queue is empty. We would need to reset the flag after Complete.\r\n\r\nYes, one batch per thread is the approach I mentioned above as well as preferred, if that wasn't clear. My thinking was that the fastest approach overall would be if we would do that plus efficient merging of batches which should ideally have the same overhead as adding a single signature to a batch (to be verified that this is possible). It would need to be benchmarked across different scenarios for blocks with varying share of schnorr sigs and across different numbers of available threads, of course. I am sure there will be some scenarios where the \"let each thread verify their own batch\" will be faster and there will be other scenarios where \"merge thread batches and verify once\" is faster and we would need to decide based on that in the end. A definite upside of the merging of thread batches would be that it would be simpler code, we could save this round of waking up the threads with the flag set.\r\n\r\nHowever, in the meantime I have asked Siv how hard it would be to add the merging of batches to the secp api and it appears it might be harder than I thought because it would require merging of scratch spaces, which is currently not possible. So, while maybe theoretically possible, it's quite far of terms of engineering effort. Siv will still look into it and check if it's feasible at all but until then I will disregard this approach.\r\n\r\nSo, long story short, I have now implemented it with a batch per thread using a flag set in complete as you suggested.",
      "created_at": "2025-03-23T22:59:17Z",
      "updated_at": "2025-03-23T22:59:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#discussion_r2009282526",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2009282526"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 163,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2023605645",
      "pull_request_review_id": 2733929171,
      "id": 2023605645,
      "node_id": "PRRC_kwDOABII5854ncWN",
      "diff_hunk": "@@ -70,7 +71,24 @@ class CachingTransactionSignatureChecker : public TransactionSignatureChecker\n     CachingTransactionSignatureChecker(const CTransaction* txToIn, unsigned int nInIn, const CAmount& amountIn, bool storeIn, SignatureCache& signature_cache, PrecomputedTransactionData& txdataIn) : TransactionSignatureChecker(txToIn, nInIn, amountIn, txdataIn, MissingDataBehavior::ASSERT_FAIL), store(storeIn), m_signature_cache(signature_cache)  {}\n \n     bool VerifyECDSASignature(const std::vector<unsigned char>& vchSig, const CPubKey& vchPubKey, const uint256& sighash) const override;\n+\n+    bool VerifySchnorrSignature(std::span<const unsigned char> sig, const XOnlyPubKey& pubkey, const uint256& sighash) const override;\n+\n+    bool GetStore() const { return store; }\n+    SignatureCache& GetSigCache() const { return m_signature_cache; }\n+};\n+\n+class CollectingSignatureChecker : public CachingTransactionSignatureChecker {",
      "path": "src/script/sigcache.h",
      "position": 1,
      "original_position": 19,
      "commit_id": "bcbbb574b17a0449fa38f65f7c7f5a4f01a825b6",
      "original_commit_id": "696bd7547e0e4ab44388d3c55ed636c46f9bdad5",
      "in_reply_to_id": null,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/29491/commits/696bd7547e0e4ab44388d3c55ed636c46f9bdad5: IIUC the original idea was to \"collect the signatures\" and possibly combine them into one batch. Now that a \"one batch per thread\" approach has been taken, should this still be collecting signatures into a vector? the original \"BatchSignatureChecker\" that had a reference to the batch might work better since it skips the vector completely",
      "created_at": "2025-04-01T20:05:27Z",
      "updated_at": "2025-04-01T20:05:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#discussion_r2023605645",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2023605645"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 81,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2024560569",
      "pull_request_review_id": 2735812246,
      "id": 2024560569,
      "node_id": "PRRC_kwDOABII5854rFe5",
      "diff_hunk": "@@ -70,7 +71,24 @@ class CachingTransactionSignatureChecker : public TransactionSignatureChecker\n     CachingTransactionSignatureChecker(const CTransaction* txToIn, unsigned int nInIn, const CAmount& amountIn, bool storeIn, SignatureCache& signature_cache, PrecomputedTransactionData& txdataIn) : TransactionSignatureChecker(txToIn, nInIn, amountIn, txdataIn, MissingDataBehavior::ASSERT_FAIL), store(storeIn), m_signature_cache(signature_cache)  {}\n \n     bool VerifyECDSASignature(const std::vector<unsigned char>& vchSig, const CPubKey& vchPubKey, const uint256& sighash) const override;\n+\n+    bool VerifySchnorrSignature(std::span<const unsigned char> sig, const XOnlyPubKey& pubkey, const uint256& sighash) const override;\n+\n+    bool GetStore() const { return store; }\n+    SignatureCache& GetSigCache() const { return m_signature_cache; }\n+};\n+\n+class CollectingSignatureChecker : public CachingTransactionSignatureChecker {",
      "path": "src/script/sigcache.h",
      "position": 1,
      "original_position": 19,
      "commit_id": "bcbbb574b17a0449fa38f65f7c7f5a4f01a825b6",
      "original_commit_id": "696bd7547e0e4ab44388d3c55ed636c46f9bdad5",
      "in_reply_to_id": 2023605645,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "\r\n> the original \"BatchSignatureChecker\" that had a reference to the batch might work better since it skips the vector completely\r\n\r\n\r\nOn second thought, it might be better to leave as is because we are still experimenting and trying to find the right number  of batches to use",
      "created_at": "2025-04-02T10:35:54Z",
      "updated_at": "2025-04-02T10:35:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#discussion_r2024560569",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2024560569"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 81,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2148806441",
      "pull_request_review_id": 2930314844,
      "id": 2148806441,
      "node_id": "PRRC_kwDOABII586AFC8p",
      "diff_hunk": "@@ -0,0 +1,56 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <batchverify.h>\n+#include <logging.h>\n+#include <pubkey.h>\n+#include <random.h>\n+#include <sync.h>\n+\n+#include <secp256k1.h>\n+#include <secp256k1_batch.h>\n+#include <secp256k1_schnorrsig_batch.h>\n+\n+// This is the maximum number of scalar-point pairs on the batch for which\n+// Strauss' algorithm, which is used in the secp256k1 implementation, is\n+// still efficient. TODO: This will be changed when Pippenger algorithm is\n+// being used in the secp implementation too.\n+const size_t MAX_BATCH_SIZE{106};\n+\n+BatchSchnorrVerifier::BatchSchnorrVerifier() {\n+    unsigned char rnd[16];\n+    GetRandBytes(rnd);\n+    secp256k1_batch* batch{secp256k1_batch_create(secp256k1_context_static, MAX_BATCH_SIZE, rnd)};\n+    m_batch = batch;\n+}\n+\n+BatchSchnorrVerifier::~BatchSchnorrVerifier() {\n+    (void)secp256k1_batch_destroy(secp256k1_context_static, m_batch);\n+}\n+\n+bool BatchSchnorrVerifier::Add(const std::span<const unsigned char> sig, const XOnlyPubKey& pubkey, const uint256& sighash) {\n+    LOCK(m_batch_mutex);\n+    if (secp256k1_batch_usable(secp256k1_context_static, m_batch) == 0) {\n+        return false;\n+    }\n+\n+    secp256k1_xonly_pubkey pubkey_parsed;\n+    (void)secp256k1_xonly_pubkey_parse(secp256k1_context_static, &pubkey_parsed, pubkey.data());",
      "path": "src/batchverify.cpp",
      "position": 1,
      "original_position": 39,
      "commit_id": "bcbbb574b17a0449fa38f65f7c7f5a4f01a825b6",
      "original_commit_id": "bcd51a49f8b8892254288d7522435287f055f92f",
      "in_reply_to_id": null,
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "https://github.com/bitcoin/bitcoin/pull/29491/commits/bcd51a49f8b8892254288d7522435287f055f92f: why discard the return value of `secp256k1_xonly_pubkey_parse()`?",
      "created_at": "2025-06-15T19:32:11Z",
      "updated_at": "2025-06-15T19:32:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#discussion_r2148806441",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2148806441"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 39,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2727489972",
      "pull_request_review_id": 3705903604,
      "id": 2727489972,
      "node_id": "PRRC_kwDOABII586ikjG0",
      "diff_hunk": "@@ -0,0 +1,56 @@\n+// Copyright (c) 2024 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <batchverify.h>\n+#include <logging.h>\n+#include <pubkey.h>\n+#include <random.h>\n+#include <sync.h>\n+\n+#include <secp256k1.h>\n+#include <secp256k1_batch.h>\n+#include <secp256k1_schnorrsig_batch.h>\n+\n+// This is the maximum number of scalar-point pairs on the batch for which\n+// Strauss' algorithm, which is used in the secp256k1 implementation, is\n+// still efficient. TODO: This will be changed when Pippenger algorithm is\n+// being used in the secp implementation too.\n+const size_t MAX_BATCH_SIZE{106};\n+\n+BatchSchnorrVerifier::BatchSchnorrVerifier() {\n+    unsigned char rnd[16];\n+    GetRandBytes(rnd);\n+    secp256k1_batch* batch{secp256k1_batch_create(secp256k1_context_static, MAX_BATCH_SIZE, rnd)};\n+    m_batch = batch;\n+}\n+\n+BatchSchnorrVerifier::~BatchSchnorrVerifier() {\n+    (void)secp256k1_batch_destroy(secp256k1_context_static, m_batch);\n+}\n+\n+bool BatchSchnorrVerifier::Add(const std::span<const unsigned char> sig, const XOnlyPubKey& pubkey, const uint256& sighash) {\n+    LOCK(m_batch_mutex);\n+    if (secp256k1_batch_usable(secp256k1_context_static, m_batch) == 0) {\n+        return false;\n+    }\n+\n+    secp256k1_xonly_pubkey pubkey_parsed;\n+    (void)secp256k1_xonly_pubkey_parse(secp256k1_context_static, &pubkey_parsed, pubkey.data());",
      "path": "src/batchverify.cpp",
      "position": 1,
      "original_position": 39,
      "commit_id": "bcbbb574b17a0449fa38f65f7c7f5a4f01a825b6",
      "original_commit_id": "bcd51a49f8b8892254288d7522435287f055f92f",
      "in_reply_to_id": 2148806441,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Not discarding it anymore in the latest push.",
      "created_at": "2026-01-26T12:49:56Z",
      "updated_at": "2026-01-26T15:57:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29491#discussion_r2727489972",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2727489972"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29491"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 39,
      "side": "RIGHT"
    }
  ]
}