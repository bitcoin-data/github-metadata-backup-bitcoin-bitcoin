{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669",
    "id": 535409,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NTM1NDA5",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/669",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/669.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/669.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/669",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/669/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
    "number": 669,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "Multisignature and OP_EVAL support",
    "user": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This implements BIPS 11, 12, and 13 :\n- OP_CHECKMULTISIG transactions supported, for up to 3 public keys, as 'standard' transactions\n- OP_EVAL (same opcode as OP_NOP1) as a new opcode\n- New OP_EVAL-based 'standard' transaction type and Bitcoin address\n- Blocks mined with this patch will have the string \"OP_EVAL\" in the coinbase scriptSig, so we can tell when a majority of miners support it.\n- New RPC command to add a multisignature-required address to the wallet: addmultisigaddress &lt;nrequired&gt; &lt;'[\"key1\",...]'&gt; &#91;account&#93;  (enabled only for use on the -testnet for now)\n- The 'validateaddress' RPC command shows the full public key of addresses in your wallet\n- Internal changes so if you own all the private keys of a multisignature transaction, then you are able to spend the transaction (and the amount shows up in your balance, and the transaction is listed in listtransactions output)\n\nThere is still a lot of work to be done to get multi-device transaction authorization or multi-party escrow; in particular, this pull doesn't include any support for gathering transaction signatures from multiple places or showing the user transactions that they are involved in but can't spend without getting more signatures from other devices/people.  It just implements the lowest-level support, along with the bare minimum needed to test to make sure the lowest-level stuff is working properly.\n\nTo test / play with:\n1. Run bitcoind -daemon -testnet\n2. Get public keys from 2 or 3 new bitcoin addresses-- e.g. run this twice:  ./bitcoind -testnet validateaddress $(./bitcoind getnewaddress)\n3. Generate a new multisignature address using the public keys from validateaddress-- ./bitcoind addmultisigaddress 2 '[\"...public_key_1...\",\"...public_key_2...\"]'\n4. Send funds to that address --  ./bitcoind sendtoaddress ...result of addmultisigaddress... 11.11\n\nStep (4) can be done from another ./bitcoind, either on another machine or same machine, different -datadir, as long as it is running this patch. The coins should show up in the wallet, be listed in listransactions, and you should be able to spend them as if they were single-signature transactions.\n\nStep (2) could be done on two or three different machines, but without more work you'll have no way to spend coins sent to the resulting multisignature address.\n",
    "labels": [],
    "active_lock_reason": "resolved",
    "created_at": "2011-11-28T22:10:12Z",
    "updated_at": "2021-09-08T10:06:08Z",
    "closed_at": "2011-12-20T19:55:40Z",
    "mergeable_state": "unknown",
    "merged_at": "2011-12-20T19:55:40Z",
    "merge_commit_sha": "b84050b13bc6cc559590e817e6319be01fe44cfb",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "gavinandresen:op_eval",
      "ref": "op_eval",
      "sha": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "user": {
        "login": "gavinandresen",
        "id": 331997,
        "node_id": "MDQ6VXNlcjMzMTk5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gavinandresen",
        "html_url": "https://github.com/gavinandresen",
        "followers_url": "https://api.github.com/users/gavinandresen/followers",
        "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
        "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
        "repos_url": "https://api.github.com/users/gavinandresen/repos",
        "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 774842,
        "node_id": "MDEwOlJlcG9zaXRvcnk3NzQ4NDI=",
        "name": "bitcoin-git",
        "full_name": "gavinandresen/bitcoin-git",
        "owner": {
          "login": "gavinandresen",
          "id": 331997,
          "node_id": "MDQ6VXNlcjMzMTk5Nw==",
          "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/gavinandresen",
          "html_url": "https://github.com/gavinandresen",
          "followers_url": "https://api.github.com/users/gavinandresen/followers",
          "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
          "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
          "repos_url": "https://api.github.com/users/gavinandresen/repos",
          "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/gavinandresen/bitcoin-git",
        "description": "Feature branches that aren't yet, or never will be, ready for mainline bitcoin",
        "fork": true,
        "url": "https://api.github.com/repos/gavinandresen/bitcoin-git",
        "archive_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/contributors",
        "deployments_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/deployments",
        "downloads_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/downloads",
        "events_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/events",
        "forks_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/forks",
        "git_commits_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/git/tags%7B/sha%7D",
        "git_url": "git://github.com/gavinandresen/bitcoin-git.git",
        "issue_comment_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/languages",
        "merges_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/merges",
        "milestones_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/releases%7B/id%7D",
        "ssh_url": "git@github.com:gavinandresen/bitcoin-git.git",
        "stargazers_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/stargazers",
        "statuses_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/subscribers",
        "subscription_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/subscription",
        "tags_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/tags",
        "teams_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/teams",
        "trees_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/gavinandresen/bitcoin-git.git",
        "hooks_url": "https://api.github.com/repos/gavinandresen/bitcoin-git/hooks",
        "svn_url": "https://github.com/gavinandresen/bitcoin-git",
        "homepage": "https://github.com/bitcoin",
        "language": "C++",
        "forks_count": 23,
        "stargazers_count": 116,
        "watchers_count": 116,
        "size": 66221,
        "default_branch": "master",
        "open_issues_count": 5,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2022-07-15T09:13:07Z",
        "created_at": "2010-07-14T15:41:31Z",
        "updated_at": "2023-06-07T20:15:04Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "3ae65166b53ffcf37565cc8362558f3edb9a37b0",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34345,
        "stargazers_count": 69853,
        "watchers_count": 69853,
        "size": 234261,
        "default_branch": "master",
        "open_issues_count": 631,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-06-08T22:17:10Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-06-08T23:51:36Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 1615,
    "deletions": 460,
    "changed_files": 27,
    "commits": 12,
    "review_comments": 27,
    "comments": 2
  },
  "events": [
    {
      "event": "subscribed",
      "id": 5972590,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDU5NzI1OTA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5972590",
      "actor": {
        "login": "gavinandresen",
        "id": 331997,
        "node_id": "MDQ6VXNlcjMzMTk5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gavinandresen",
        "html_url": "https://github.com/gavinandresen",
        "followers_url": "https://api.github.com/users/gavinandresen/followers",
        "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
        "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
        "repos_url": "https://api.github.com/users/gavinandresen/repos",
        "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2011-11-28T22:10:12Z"
    },
    {
      "event": "subscribed",
      "id": 6124890,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDYxMjQ4OTA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6124890",
      "actor": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2011-11-30T23:06:36Z"
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI3MTp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI3Njp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI3OTp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI4MTp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI4Mjp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI4Mzp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI4NDp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI4NTp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI4Njp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI4Nzp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI5MDp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI5MTp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI5NDp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI5Nzp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTI5OTp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkNjc1NTMwMDp2Mg==",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "commented",
      "id": 2998414,
      "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTg0MTQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2998414",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2011-12-03T01:57:15Z",
      "updated_at": "2011-12-03T01:57:15Z",
      "author_association": "MEMBER",
      "body": "NACK\n\n9db95d3 introduces a regression: when you send-to-self, and have to pay a fee, instead of the usual send/receive pair in listtransactions, we now get a second 'send' instead of the 'receive'. This 'send' has an amount that appears to be your _change_ from the transaction, shown in negative.\n",
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#issuecomment-2998414",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/669"
    },
    {
      "event": "subscribed",
      "id": 6236231,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDYyMzYyMzE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6236231",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2011-12-03T01:57:15Z"
    },
    {
      "event": "commented",
      "id": 2998553,
      "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTg1NTM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2998553",
      "actor": {
        "login": "gavinandresen",
        "id": 331997,
        "node_id": "MDQ6VXNlcjMzMTk5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gavinandresen",
        "html_url": "https://github.com/gavinandresen",
        "followers_url": "https://api.github.com/users/gavinandresen/followers",
        "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
        "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
        "repos_url": "https://api.github.com/users/gavinandresen/repos",
        "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2011-12-03T02:21:44Z",
      "updated_at": "2011-12-03T02:21:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "Nice catch on the listtransactions regression.\n",
      "user": {
        "login": "gavinandresen",
        "id": 331997,
        "node_id": "MDQ6VXNlcjMzMTk5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gavinandresen",
        "html_url": "https://github.com/gavinandresen",
        "followers_url": "https://api.github.com/users/gavinandresen/followers",
        "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
        "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
        "repos_url": "https://api.github.com/users/gavinandresen/repos",
        "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#issuecomment-2998553",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/669"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3ZTU1YzFhYjY1MDE2MzAxMWE2OTBkYWY3NGNiMWNjODliZGQ1NjNi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7e55c1ab650163011a690daf74cb1cc89bdd563b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7e55c1ab650163011a690daf74cb1cc89bdd563b",
      "tree": {
        "sha": "497906b6cc9da65ca250e718c1c729f853b7ca1f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/497906b6cc9da65ca250e718c1c729f853b7ca1f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/99a289f531e9dc42aa81ea32ff84b807a46b6a9c",
          "sha": "99a289f531e9dc42aa81ea32ff84b807a46b6a9c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/99a289f531e9dc42aa81ea32ff84b807a46b6a9c"
        }
      ],
      "message": "Collapse no-op ExtractAddress/ExtractAddressInner",
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-19T17:39:47Z"
      },
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-09-29T13:46:52Z"
      },
      "sha": "7e55c1ab650163011a690daf74cb1cc89bdd563b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxNDY2YjhiNzhhZDhjYWJmOTNhYzNmNjVmNTkyOTIxM2M1ZGQzYzhm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1466b8b78ad8cabf93ac3f65f5929213c5dd3c8f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1466b8b78ad8cabf93ac3f65f5929213c5dd3c8f",
      "tree": {
        "sha": "0dc75b665913468ec2f81ab08b934e29b0e7b088",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0dc75b665913468ec2f81ab08b934e29b0e7b088"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7e55c1ab650163011a690daf74cb1cc89bdd563b",
          "sha": "7e55c1ab650163011a690daf74cb1cc89bdd563b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7e55c1ab650163011a690daf74cb1cc89bdd563b"
        }
      ],
      "message": "Rework unit tests so test_bitcoin.cpp does not #include them all",
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-19T17:39:47Z"
      },
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-10-11T23:50:06Z"
      },
      "sha": "1466b8b78ad8cabf93ac3f65f5929213c5dd3c8f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiZjc5ODczNGRiNDUzOWEzOWVkZDZiYWRmNTRhMWMzYWVjZjE5M2U1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bf798734db4539a39edd6badf54a1c3aecf193e5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/bf798734db4539a39edd6badf54a1c3aecf193e5",
      "tree": {
        "sha": "850f60c149335de2c85c0aafd10a8fc50aca9c7e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/850f60c149335de2c85c0aafd10a8fc50aca9c7e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1466b8b78ad8cabf93ac3f65f5929213c5dd3c8f",
          "sha": "1466b8b78ad8cabf93ac3f65f5929213c5dd3c8f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1466b8b78ad8cabf93ac3f65f5929213c5dd3c8f"
        }
      ],
      "message": "Support 3 new multisignature IsStandard transactions\n\nInitial support for (a and b), (a or b), and 2-of-3 escrow\ntransactions (where a, b, and c are keys).",
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-19T17:40:19Z"
      },
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-09-28T16:30:06Z"
      },
      "sha": "bf798734db4539a39edd6badf54a1c3aecf193e5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjYzQwYmEyMTUxYTYyN2I2ZGE5YWY0OTMyZTBiZWU1OGU2OWFhY2I1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cc40ba2151a627b6da9af4932e0bee58e69aacb5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/cc40ba2151a627b6da9af4932e0bee58e69aacb5",
      "tree": {
        "sha": "c8fd986dd581f35d01241b695ca1b2823c27f24a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c8fd986dd581f35d01241b695ca1b2823c27f24a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bf798734db4539a39edd6badf54a1c3aecf193e5",
          "sha": "bf798734db4539a39edd6badf54a1c3aecf193e5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/bf798734db4539a39edd6badf54a1c3aecf193e5"
        }
      ],
      "message": "Global fixture to send output to console instead of debug.log",
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-19T17:40:19Z"
      },
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-10-03T20:14:13Z"
      },
      "sha": "cc40ba2151a627b6da9af4932e0bee58e69aacb5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzplNjc5ZWM5NjljOGIyMmM2NzZlYmIxMGJlYTEwMzhmNmM4ZjEzYjMz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e679ec969c8b22c676ebb10bea1038f6c8f13b33",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e679ec969c8b22c676ebb10bea1038f6c8f13b33",
      "tree": {
        "sha": "c584f1a152c376ca0df93261d447c5b719449508",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c584f1a152c376ca0df93261d447c5b719449508"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cc40ba2151a627b6da9af4932e0bee58e69aacb5",
          "sha": "cc40ba2151a627b6da9af4932e0bee58e69aacb5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/cc40ba2151a627b6da9af4932e0bee58e69aacb5"
        }
      ],
      "message": "OP_EVAL implementation\n\nOP_EVAL is a new opcode that evaluates an item on the stack as a script.\nIt enables a new type of bitcoin address that needs an arbitrarily\ncomplex script to redeem.",
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-19T17:40:19Z"
      },
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-10-03T17:05:43Z"
      },
      "sha": "e679ec969c8b22c676ebb10bea1038f6c8f13b33"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkNzA2MmVmMWJkMzMxOTY4OWQ0MDIwMjcxMzFmMmM0NmVmZWRkY2I2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d7062ef1bd3319689d402027131f2c46efeddcb6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d7062ef1bd3319689d402027131f2c46efeddcb6",
      "tree": {
        "sha": "975b65f6410e515c4463ad15f1f306909337987b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/975b65f6410e515c4463ad15f1f306909337987b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e679ec969c8b22c676ebb10bea1038f6c8f13b33",
          "sha": "e679ec969c8b22c676ebb10bea1038f6c8f13b33",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e679ec969c8b22c676ebb10bea1038f6c8f13b33"
        }
      ],
      "message": "Put OP_EVAL string in coinbase of generated blocks",
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-19T18:24:48Z"
      },
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-10-13T20:03:58Z"
      },
      "sha": "d7062ef1bd3319689d402027131f2c46efeddcb6"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWUzZTJhYWI2NDZhNDgxM2M2YjlhZDI4YjRjOWNmNDMzMGMxYTU5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fae3e2aab646a4813c6b9ad28b4c9cf4330c1a59",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/fae3e2aab646a4813c6b9ad28b4c9cf4330c1a59",
      "tree": {
        "sha": "5dcad7e4b5dc84b3c52a2230ce778f13f727151e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5dcad7e4b5dc84b3c52a2230ce778f13f727151e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d7062ef1bd3319689d402027131f2c46efeddcb6",
          "sha": "d7062ef1bd3319689d402027131f2c46efeddcb6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d7062ef1bd3319689d402027131f2c46efeddcb6"
        }
      ],
      "message": "Disable addmultisigaddress if not testnet",
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-19T18:24:48Z"
      },
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-10-19T13:50:15Z"
      },
      "sha": "fae3e2aab646a4813c6b9ad28b4c9cf4330c1a59"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzphMDg3MWFmYjJiMWQ2ZDM1OGM4MzNmZDA4YmNhMmYxM2M4NDBmZDRk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a0871afb2b1d6d358c833fd08bca2f13c840fd4d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a0871afb2b1d6d358c833fd08bca2f13c840fd4d",
      "tree": {
        "sha": "e983da1f47c6d64d16eb2bf83b58d2764b4853d0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e983da1f47c6d64d16eb2bf83b58d2764b4853d0"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fae3e2aab646a4813c6b9ad28b4c9cf4330c1a59",
          "sha": "fae3e2aab646a4813c6b9ad28b4c9cf4330c1a59",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/fae3e2aab646a4813c6b9ad28b4c9cf4330c1a59"
        }
      ],
      "message": "Interpret OP_EVAL as OP_NOP until Feb 1, 2012",
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-19T18:24:48Z"
      },
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-10-21T17:12:05Z"
      },
      "sha": "a0871afb2b1d6d358c833fd08bca2f13c840fd4d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyYTQ1YTQ5NGIwYmVjNmEwZjFmYzZhYjdmMjZjMjYwYjg1ZTdmZjNl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2a45a494b0bec6a0f1fc6ab7f26c260b85e7ff3e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/2a45a494b0bec6a0f1fc6ab7f26c260b85e7ff3e",
      "tree": {
        "sha": "a6c8ad492ea81d6f1c2b8694351a7b7bfa785ae6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a6c8ad492ea81d6f1c2b8694351a7b7bfa785ae6"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a0871afb2b1d6d358c833fd08bca2f13c840fd4d",
          "sha": "a0871afb2b1d6d358c833fd08bca2f13c840fd4d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a0871afb2b1d6d358c833fd08bca2f13c840fd4d"
        }
      ],
      "message": "Use block times for 'hard' OP_EVAL switchover, and refactored EvalScript\nso it takes a flag for how to interpret OP_EVAL.\nAlso increased IsStandard size of scriptSigs to 500 bytes, so\na 3-of-3 multisig transaction IsStandard.",
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-19T18:24:48Z"
      },
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-11-08T18:20:29Z"
      },
      "sha": "2a45a494b0bec6a0f1fc6ab7f26c260b85e7ff3e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiZTIzN2MxMTllODJhNGMwMWY0ZWYzZGE0MjY0ZmFhNmM5MDBlOWUz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/be237c119e82a4c01f4ef3da4264faa6c900e9e3",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/be237c119e82a4c01f4ef3da4264faa6c900e9e3",
      "tree": {
        "sha": "68e672f788c7242a32153208f5511eea4f510ae1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/68e672f788c7242a32153208f5511eea4f510ae1"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2a45a494b0bec6a0f1fc6ab7f26c260b85e7ff3e",
          "sha": "2a45a494b0bec6a0f1fc6ab7f26c260b85e7ff3e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2a45a494b0bec6a0f1fc6ab7f26c260b85e7ff3e"
        }
      ],
      "message": "Fix logic for IsChange() for send-to-self transactions.",
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-19T18:24:49Z"
      },
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-05T15:32:35Z"
      },
      "sha": "be237c119e82a4c01f4ef3da4264faa6c900e9e3"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5ZTQ3MDU4NWIzNWE4NGZjYjdmNmFhNDFhYzAyMTZjMTE3ZTJhNWUx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9e470585b35a84fcb7f6aa41ac0216c117e2a5e1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9e470585b35a84fcb7f6aa41ac0216c117e2a5e1",
      "tree": {
        "sha": "88ead3af4b648db71bda23131b4b70d5c1af7f6e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/88ead3af4b648db71bda23131b4b70d5c1af7f6e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/be237c119e82a4c01f4ef3da4264faa6c900e9e3",
          "sha": "be237c119e82a4c01f4ef3da4264faa6c900e9e3",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/be237c119e82a4c01f4ef3da4264faa6c900e9e3"
        }
      ],
      "message": "Update bitcoin address numbers for latest luke-jr/sipa scheme",
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-19T18:24:51Z"
      },
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-16T23:03:48Z"
      },
      "sha": "9e470585b35a84fcb7f6aa41ac0216c117e2a5e1"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3N2YyMWYxNTgzZGViODliZjNmZmZlODBmZTliMTgxZmVkYjFkZDYw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "tree": {
        "sha": "a09b310f27f334784f6d2be2e83fc77c74a10543",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a09b310f27f334784f6d2be2e83fc77c74a10543"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9e470585b35a84fcb7f6aa41ac0216c117e2a5e1",
          "sha": "9e470585b35a84fcb7f6aa41ac0216c117e2a5e1",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9e470585b35a84fcb7f6aa41ac0216c117e2a5e1"
        }
      ],
      "message": "include util.h to get SecureString definition.",
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-20T17:21:47Z"
      },
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-12-20T17:21:47Z"
      },
      "sha": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60"
    },
    {
      "event": "merged",
      "id": 6996929,
      "node_id": "MDExOk1lcmdlZEV2ZW50Njk5NjkyOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6996929",
      "actor": {
        "login": "gavinandresen",
        "id": 331997,
        "node_id": "MDQ6VXNlcjMzMTk5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gavinandresen",
        "html_url": "https://github.com/gavinandresen",
        "followers_url": "https://api.github.com/users/gavinandresen/followers",
        "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
        "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
        "repos_url": "https://api.github.com/users/gavinandresen/repos",
        "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "created_at": "2011-12-20T19:55:40Z"
    },
    {
      "event": "closed",
      "id": 6996930,
      "node_id": "MDExOkNsb3NlZEV2ZW50Njk5NjkzMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6996930",
      "actor": {
        "login": "gavinandresen",
        "id": 331997,
        "node_id": "MDQ6VXNlcjMzMTk5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gavinandresen",
        "html_url": "https://github.com/gavinandresen",
        "followers_url": "https://api.github.com/users/gavinandresen/followers",
        "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
        "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
        "repos_url": "https://api.github.com/users/gavinandresen/repos",
        "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2011-12-20T19:55:40Z"
    },
    {
      "event": "referenced",
      "id": 1125710588,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDExMjU3MTA1ODg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1125710588",
      "actor": {
        "login": "ptschip",
        "id": 12862928,
        "node_id": "MDQ6VXNlcjEyODYyOTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/12862928?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ptschip",
        "html_url": "https://github.com/ptschip",
        "followers_url": "https://api.github.com/users/ptschip/followers",
        "following_url": "https://api.github.com/users/ptschip/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ptschip/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ptschip/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ptschip/subscriptions",
        "organizations_url": "https://api.github.com/users/ptschip/orgs",
        "repos_url": "https://api.github.com/users/ptschip/repos",
        "events_url": "https://api.github.com/users/ptschip/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ptschip/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "42bcdf440c06e10eeb6030e71971fcf3d4d4fcbd",
      "commit_url": "https://api.github.com/repos/ptschip/bitcoin/commits/42bcdf440c06e10eeb6030e71971fcf3d4d4fcbd",
      "created_at": "2017-06-15T19:19:01Z"
    },
    {
      "event": "referenced",
      "id": 2777171939,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDI3NzcxNzE5Mzk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2777171939",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "b586bbd5585a094f193f1dab38df1a77bfb807fc",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/b586bbd5585a094f193f1dab38df1a77bfb807fc",
      "created_at": "2019-11-06T22:53:15Z"
    },
    {
      "event": "referenced",
      "id": 2778769876,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDI3Nzg3Njk4NzY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2778769876",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "97b66d34eb2dfcf8a505243221f7a03052f969bd",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/97b66d34eb2dfcf8a505243221f7a03052f969bd",
      "created_at": "2019-11-07T10:16:57Z"
    },
    {
      "event": "referenced",
      "id": 2779466875,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDI3Nzk0NjY4NzU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2779466875",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "e9c85bb139cef653151e8f8d50e7e365331065e3",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/e9c85bb139cef653151e8f8d50e7e365331065e3",
      "created_at": "2019-11-07T14:09:57Z"
    },
    {
      "event": "referenced",
      "id": 2780855402,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDI3ODA4NTU0MDI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2780855402",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "c92f7af6181c998137898efcd7e6fef9c9eef571",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/c92f7af6181c998137898efcd7e6fef9c9eef571",
      "created_at": "2019-11-07T21:10:40Z"
    },
    {
      "event": "referenced",
      "id": 2866704089,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDI4NjY3MDQwODk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2866704089",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "656712fe94e432f641e9d4532d0bc786cfd4f2f0",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/656712fe94e432f641e9d4532d0bc786cfd4f2f0",
      "created_at": "2019-12-09T15:12:30Z"
    },
    {
      "event": "referenced",
      "id": 2877137979,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDI4NzcxMzc5Nzk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2877137979",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "4abd92d5c4a8310259fc3b2b8dd5fd6d1fa61299",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/4abd92d5c4a8310259fc3b2b8dd5fd6d1fa61299",
      "created_at": "2019-12-12T09:11:14Z"
    },
    {
      "event": "referenced",
      "id": 2918686254,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDI5MTg2ODYyNTQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2918686254",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "89c8fe5189d4f10961ed59189990bc429304f1ad",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/89c8fe5189d4f10961ed59189990bc429304f1ad",
      "created_at": "2020-01-02T20:20:07Z"
    },
    {
      "event": "referenced",
      "id": 2986276655,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDI5ODYyNzY2NTU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/2986276655",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "66480821b36c839ab7615cb9309850015bceadb0",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/66480821b36c839ab7615cb9309850015bceadb0",
      "created_at": "2020-01-28T16:14:03Z"
    },
    {
      "event": "referenced",
      "id": 3123128595,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDMxMjMxMjg1OTU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3123128595",
      "actor": {
        "login": "Losangelosgenetics",
        "id": 62075594,
        "node_id": "MDQ6VXNlcjYyMDc1NTk0",
        "avatar_url": "https://avatars.githubusercontent.com/u/62075594?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Losangelosgenetics",
        "html_url": "https://github.com/Losangelosgenetics",
        "followers_url": "https://api.github.com/users/Losangelosgenetics/followers",
        "following_url": "https://api.github.com/users/Losangelosgenetics/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Losangelosgenetics/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Losangelosgenetics/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Losangelosgenetics/subscriptions",
        "organizations_url": "https://api.github.com/users/Losangelosgenetics/orgs",
        "repos_url": "https://api.github.com/users/Losangelosgenetics/repos",
        "events_url": "https://api.github.com/users/Losangelosgenetics/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Losangelosgenetics/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "de6dde848269fdd6360e5e7dce4874ce62fbed7f",
      "commit_url": "https://api.github.com/repos/Losangelosgenetics/bitcoin/commits/de6dde848269fdd6360e5e7dce4874ce62fbed7f",
      "created_at": "2020-03-12T14:41:24Z"
    },
    {
      "event": "referenced",
      "id": 4518456976,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQ1MTg0NTY5NzY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4518456976",
      "actor": {
        "login": "backpacker69",
        "id": 19201340,
        "node_id": "MDQ6VXNlcjE5MjAxMzQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19201340?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/backpacker69",
        "html_url": "https://github.com/backpacker69",
        "followers_url": "https://api.github.com/users/backpacker69/followers",
        "following_url": "https://api.github.com/users/backpacker69/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/backpacker69/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/backpacker69/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/backpacker69/subscriptions",
        "organizations_url": "https://api.github.com/users/backpacker69/orgs",
        "repos_url": "https://api.github.com/users/backpacker69/repos",
        "events_url": "https://api.github.com/users/backpacker69/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/backpacker69/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "9a4d4e59a38d3bf7508d646ad7cf9ecabeee9e73",
      "commit_url": "https://api.github.com/repos/peercoin/peercoin/commits/9a4d4e59a38d3bf7508d646ad7cf9ecabeee9e73",
      "created_at": "2021-03-28T19:23:27Z"
    },
    {
      "event": "referenced",
      "id": 5118001010,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUxMTgwMDEwMTA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5118001010",
      "actor": {
        "login": "rajarshimaitra",
        "id": 36541669,
        "node_id": "MDQ6VXNlcjM2NTQxNjY5",
        "avatar_url": "https://avatars.githubusercontent.com/u/36541669?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rajarshimaitra",
        "html_url": "https://github.com/rajarshimaitra",
        "followers_url": "https://api.github.com/users/rajarshimaitra/followers",
        "following_url": "https://api.github.com/users/rajarshimaitra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rajarshimaitra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rajarshimaitra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rajarshimaitra/subscriptions",
        "organizations_url": "https://api.github.com/users/rajarshimaitra/orgs",
        "repos_url": "https://api.github.com/users/rajarshimaitra/repos",
        "events_url": "https://api.github.com/users/rajarshimaitra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rajarshimaitra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "47c1762c4674f8f46aa89d032645d45d7639a89b",
      "commit_url": "https://api.github.com/repos/rajarshimaitra/bitcoin/commits/47c1762c4674f8f46aa89d032645d45d7639a89b",
      "created_at": "2021-08-05T14:50:51Z"
    },
    {
      "event": "locked",
      "id": 5271235217,
      "node_id": "LOE_lADOABII584AJDn-zwAAAAE6MKqR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5271235217",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-09-08T10:06:08Z",
      "lock_reason": "resolved"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262727",
      "pull_request_review_id": null,
      "id": 262727,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MjcyNw==",
      "diff_hunk": "@@ -420,6 +420,18 @@ public:\n         return Write(std::make_pair(std::string(\"mkey\"), nID), kMasterKey, true);\n     }\n \n+    bool ReadCScript(const uint160 &hash, std::vector<unsigned char>& data)",
      "path": "src/db.h",
      "position": null,
      "original_position": 4,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Maybe add comments in keystore.h and db.h indicating why you might want to store scripts keyed by hash in your wallet, as this is not obvious at all given the readers basic mental model of how Bitcoin works.\n",
      "created_at": "2011-11-30T23:06:36Z",
      "updated_at": "2011-12-20T17:22:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262727",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262727"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262730",
      "pull_request_review_id": null,
      "id": 262730,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MjczMA==",
      "diff_hunk": "@@ -28,17 +28,23 @@ public:\n     // This may succeed even if GetKey fails (e.g., encrypted wallets)\n     virtual bool GetPubKey(const CBitcoinAddress &address, std::vector<unsigned char>& vchPubKeyOut) const;\n \n+    virtual bool AddCScript(const uint160 &hash, const std::vector<unsigned char>& data) =0;",
      "path": "src/keystore.h",
      "position": null,
      "original_position": 4,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Same here, consider comments explaining what this is all about and why scripts are keyed by hash. Also, the methods say \"AddCScript\" but actually take an arbitrary byte buffer - which do you want, scripts or any data? Be consistent.\n",
      "created_at": "2011-11-30T23:07:43Z",
      "updated_at": "2011-12-20T17:22:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262730",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262730"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262732",
      "pull_request_review_id": null,
      "id": 262732,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MjczMg==",
      "diff_hunk": "@@ -28,17 +28,23 @@ public:\n     // This may succeed even if GetKey fails (e.g., encrypted wallets)\n     virtual bool GetPubKey(const CBitcoinAddress &address, std::vector<unsigned char>& vchPubKeyOut) const;\n \n+    virtual bool AddCScript(const uint160 &hash, const std::vector<unsigned char>& data) =0;\n+    virtual bool HaveCScript(const uint160 &hash) const =0;\n+    virtual bool GetCScript(const uint160 &hash, std::vector<unsigned char>& dataOut) const =0;\n+\n     // Generate a new key, and add it to the store\n     virtual std::vector<unsigned char> GenerateNewKey();\n };\n \n typedef std::map<CBitcoinAddress, CSecret> KeyMap;\n+typedef std::map<uint160, std::vector<unsigned char> > DataMap;\n \n // Basic key store, that keeps keys in an address->secret map\n class CBasicKeyStore : public CKeyStore\n {\n protected:\n     KeyMap mapKeys;\n+    DataMap mapData;",
      "path": "src/keystore.h",
      "position": null,
      "original_position": 20,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "mapData is not a very descriptive name, don't all maps contain data?\n",
      "created_at": "2011-11-30T23:07:59Z",
      "updated_at": "2011-12-20T17:22:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262732",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262732"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262734",
      "pull_request_review_id": null,
      "id": 262734,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MjczNA==",
      "diff_hunk": "@@ -241,6 +241,65 @@ bool CTransaction::ReadFromDisk(COutPoint prevout)\n     return ReadFromDisk(txdb, prevout, txindex);\n }\n \n+bool CTransaction::IsStandard() const\n+{\n+    BOOST_FOREACH(const CTxIn& txin, vin)\n+    {\n+        // Biggest 'standard' txin is a 3-signature 3-of-3 CHECKMULTISIG\n+        // in an OP_EVAL, which is 3 ~80-byte signatures, 3\n+        // ~65-byte public keys, plus a few script ops.\n+        if (txin.scriptSig.size() > 500)\n+            return error(\"nonstandard txin, size %d\\n\", txin.scriptSig.size());\n+        if (!txin.scriptSig.IsPushOnly())\n+            return error(\"nonstandard txin: %s\", txin.scriptSig.ToString().c_str());",
      "path": "src/main.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Maybe state explicitly in these messages why they are considered non-standard (too large, opcodes present)\n",
      "created_at": "2011-11-30T23:08:32Z",
      "updated_at": "2011-12-20T17:22:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262734",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262734"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262740",
      "pull_request_review_id": null,
      "id": 262740,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2Mjc0MA==",
      "diff_hunk": "@@ -241,6 +241,65 @@ bool CTransaction::ReadFromDisk(COutPoint prevout)\n     return ReadFromDisk(txdb, prevout, txindex);\n }\n \n+bool CTransaction::IsStandard() const\n+{\n+    BOOST_FOREACH(const CTxIn& txin, vin)\n+    {\n+        // Biggest 'standard' txin is a 3-signature 3-of-3 CHECKMULTISIG\n+        // in an OP_EVAL, which is 3 ~80-byte signatures, 3\n+        // ~65-byte public keys, plus a few script ops.\n+        if (txin.scriptSig.size() > 500)\n+            return error(\"nonstandard txin, size %d\\n\", txin.scriptSig.size());\n+        if (!txin.scriptSig.IsPushOnly())\n+            return error(\"nonstandard txin: %s\", txin.scriptSig.ToString().c_str());\n+    }\n+    BOOST_FOREACH(const CTxOut& txout, vout)\n+        if (!::IsStandard(txout.scriptPubKey))\n+            return error(\"nonstandard txout: %s\", txout.scriptPubKey.ToString().c_str());\n+    return true;\n+}\n+\n+//\n+// Check transaction inputs, and make sure any\n+// OP_EVAL transactions are evaluating IsStandard scripts\n+//\n+// Why bother? To avoid denial-of-service attacks; an attacker\n+// can submit a standard DUP HASH... OP_EVAL transaction,\n+// which will get accepted into blocks. The script being\n+// EVAL'ed can be anything; an attacker could use a very\n+// expensive-to-check-upon-redemption script like:\n+//   DUP CHECKSIG DROP ... repeated 100 times... OP_1\n+//\n+bool CTransaction::IsStandardInputs(std::map<uint256, std::pair<CTxIndex, CTransaction> > mapInputs) const",
      "path": "src/main.cpp",
      "position": null,
      "original_position": 33,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "::AreInputsStandard?\n\nConsider commenting (or using a typedef) that the map key is a tx hash\n",
      "created_at": "2011-11-30T23:09:31Z",
      "updated_at": "2011-12-20T17:22:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262740",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262740"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262746",
      "pull_request_review_id": null,
      "id": 262746,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2Mjc0Ng==",
      "diff_hunk": "@@ -241,6 +241,65 @@ bool CTransaction::ReadFromDisk(COutPoint prevout)\n     return ReadFromDisk(txdb, prevout, txindex);\n }\n \n+bool CTransaction::IsStandard() const\n+{\n+    BOOST_FOREACH(const CTxIn& txin, vin)\n+    {\n+        // Biggest 'standard' txin is a 3-signature 3-of-3 CHECKMULTISIG\n+        // in an OP_EVAL, which is 3 ~80-byte signatures, 3\n+        // ~65-byte public keys, plus a few script ops.\n+        if (txin.scriptSig.size() > 500)\n+            return error(\"nonstandard txin, size %d\\n\", txin.scriptSig.size());\n+        if (!txin.scriptSig.IsPushOnly())\n+            return error(\"nonstandard txin: %s\", txin.scriptSig.ToString().c_str());\n+    }\n+    BOOST_FOREACH(const CTxOut& txout, vout)\n+        if (!::IsStandard(txout.scriptPubKey))\n+            return error(\"nonstandard txout: %s\", txout.scriptPubKey.ToString().c_str());\n+    return true;\n+}\n+\n+//\n+// Check transaction inputs, and make sure any\n+// OP_EVAL transactions are evaluating IsStandard scripts\n+//\n+// Why bother? To avoid denial-of-service attacks; an attacker\n+// can submit a standard DUP HASH... OP_EVAL transaction,\n+// which will get accepted into blocks. The script being\n+// EVAL'ed can be anything; an attacker could use a very\n+// expensive-to-check-upon-redemption script like:\n+//   DUP CHECKSIG DROP ... repeated 100 times... OP_1\n+//\n+bool CTransaction::IsStandardInputs(std::map<uint256, std::pair<CTxIndex, CTransaction> > mapInputs) const\n+{\n+    if (fTestNet)\n+        return true; // Allow non-standard on testnet\n+\n+    for (int i = 0; i < vin.size(); i++)\n+    {\n+        COutPoint prevout = vin[i].prevout;\n+        assert(mapInputs.count(prevout.hash) > 0);\n+        CTransaction& txPrev = mapInputs[prevout.hash].second;\n+\n+        vector<vector<unsigned char> > vSolutions;\n+        txntype whichType;\n+        if (!Solver(txPrev.vout[vin[i].prevout.n].scriptPubKey, whichType, vSolutions))",
      "path": "src/main.cpp",
      "position": null,
      "original_position": 46,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This is a fairly complex expression, comment what txPrev.vout[vin[i].prevout.n] refers to here (I know it's obvious if you think about it but it's easier to read....)\n",
      "created_at": "2011-11-30T23:11:04Z",
      "updated_at": "2011-12-20T17:22:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262746",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262746"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262748",
      "pull_request_review_id": null,
      "id": 262748,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2Mjc0OA==",
      "diff_hunk": "@@ -241,6 +241,65 @@ bool CTransaction::ReadFromDisk(COutPoint prevout)\n     return ReadFromDisk(txdb, prevout, txindex);\n }\n \n+bool CTransaction::IsStandard() const\n+{\n+    BOOST_FOREACH(const CTxIn& txin, vin)\n+    {\n+        // Biggest 'standard' txin is a 3-signature 3-of-3 CHECKMULTISIG\n+        // in an OP_EVAL, which is 3 ~80-byte signatures, 3\n+        // ~65-byte public keys, plus a few script ops.\n+        if (txin.scriptSig.size() > 500)\n+            return error(\"nonstandard txin, size %d\\n\", txin.scriptSig.size());\n+        if (!txin.scriptSig.IsPushOnly())\n+            return error(\"nonstandard txin: %s\", txin.scriptSig.ToString().c_str());\n+    }\n+    BOOST_FOREACH(const CTxOut& txout, vout)\n+        if (!::IsStandard(txout.scriptPubKey))\n+            return error(\"nonstandard txout: %s\", txout.scriptPubKey.ToString().c_str());\n+    return true;\n+}\n+\n+//\n+// Check transaction inputs, and make sure any\n+// OP_EVAL transactions are evaluating IsStandard scripts\n+//\n+// Why bother? To avoid denial-of-service attacks; an attacker\n+// can submit a standard DUP HASH... OP_EVAL transaction,\n+// which will get accepted into blocks. The script being\n+// EVAL'ed can be anything; an attacker could use a very\n+// expensive-to-check-upon-redemption script like:\n+//   DUP CHECKSIG DROP ... repeated 100 times... OP_1\n+//\n+bool CTransaction::IsStandardInputs(std::map<uint256, std::pair<CTxIndex, CTransaction> > mapInputs) const\n+{\n+    if (fTestNet)\n+        return true; // Allow non-standard on testnet\n+\n+    for (int i = 0; i < vin.size(); i++)\n+    {\n+        COutPoint prevout = vin[i].prevout;\n+        assert(mapInputs.count(prevout.hash) > 0);\n+        CTransaction& txPrev = mapInputs[prevout.hash].second;\n+\n+        vector<vector<unsigned char> > vSolutions;\n+        txntype whichType;\n+        if (!Solver(txPrev.vout[vin[i].prevout.n].scriptPubKey, whichType, vSolutions))\n+            return false;",
      "path": "src/main.cpp",
      "position": null,
      "original_position": 47,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "return error(\"...\")? same for other locations in this function?\n",
      "created_at": "2011-11-30T23:11:16Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262748",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262748"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262757",
      "pull_request_review_id": null,
      "id": 262757,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2Mjc1Nw==",
      "diff_hunk": "@@ -813,8 +882,61 @@ bool CTransaction::DisconnectInputs(CTxDB& txdb)\n }\n \n \n-bool CTransaction::ConnectInputs(CTxDB& txdb, map<uint256, CTxIndex>& mapTestPool, CDiskTxPos posThisTx,\n-                                 CBlockIndex* pindexBlock, int64& nFees, bool fBlock, bool fMiner, int64 nMinFee)\n+bool CTransaction::FetchInputs(CTxDB& txdb, const map<uint256, CTxIndex>& mapTestPool,\n+                               bool fBlock, bool fMiner, map<uint256, pair<CTxIndex, CTransaction> >& inputsRet)\n+{\n+    if (IsCoinBase())\n+        return true; // Coinbase transactions have no inputs to fetch.\n+    \n+    for (int i = 0; i < vin.size(); i++)\n+    {\n+        COutPoint prevout = vin[i].prevout;\n+        if (inputsRet.count(prevout.hash))\n+            continue; // Got it already\n+\n+        // Read txindex\n+        CTxIndex& txindex = inputsRet[prevout.hash].first;\n+        bool fFound = true;\n+        if ((fBlock || fMiner) && mapTestPool.count(prevout.hash))\n+        {\n+            // Get txindex from current proposed changes\n+            txindex = mapTestPool.find(prevout.hash)->second;\n+        }\n+        else\n+        {\n+            // Read txindex from txdb\n+            fFound = txdb.ReadTxIndex(prevout.hash, txindex);\n+        }\n+        if (!fFound && (fBlock || fMiner))\n+            return fMiner ? false : error(\"FetchInputs() : %s prev tx %s index entry not found\", GetHash().ToString().substr(0,10).c_str(),  prevout.hash.ToString().substr(0,10).c_str());\n+\n+        // Read txPrev\n+        CTransaction& txPrev = inputsRet[prevout.hash].second;\n+        if (!fFound || txindex.pos == CDiskTxPos(1,1,1))",
      "path": "src/main.cpp",
      "position": 157,
      "original_position": 155,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "What does the magic 1,1,1 mean, maybe this should be a global constant?\n",
      "created_at": "2011-11-30T23:14:38Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262757",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262757"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 930,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262763",
      "pull_request_review_id": null,
      "id": 262763,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2Mjc2Mw==",
      "diff_hunk": "@@ -877,9 +965,27 @@ bool CTransaction::ConnectInputs(CTxDB& txdb, map<uint256, CTxIndex>& mapTestPoo\n             // (before the last blockchain checkpoint). This is safe because block merkle hashes are\n             // still computed and checked, and any change will be caught at the next checkpoint.\n             if (!(fBlock && IsInitialBlockDownload()))\n+            {\n+                bool fStrictOpEval = true;\n+                // This code should be removed when OP_EVAL has\n+                // a majority of hashing power on the network.\n+                if (fBlock)\n+                {\n+                    // To avoid being on the short end of a block-chain split,\n+                    // interpret OP_EVAL as a NO_OP until blocks with timestamps\n+                    // after opevaltime:\n+                    int64 nEvalSwitchTime = GetArg(\"opevaltime\", 1328054400); // Feb 1, 2012",
      "path": "src/main.cpp",
      "position": 245,
      "original_position": 243,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Would it be worth allowing the default time to be adjusted using a message signed by you, embedded in a block coinbase?\n\nAlternatively, calculate it dynamically based on the frequency of the coinbase markers?\n",
      "created_at": "2011-11-30T23:17:02Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262763",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262763"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 992,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262770",
      "pull_request_review_id": null,
      "id": 262770,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2Mjc3MA==",
      "diff_hunk": "@@ -2862,6 +2992,12 @@ void IncrementExtraNonce(CBlock* pblock, CBlockIndex* pindexPrev, unsigned int&\n     ++nExtraNonce;\n     pblock->vtx[0].vin[0].scriptSig = CScript() << pblock->nTime << CBigNum(nExtraNonce);\n     pblock->hashMerkleRoot = pblock->BuildMerkleTree();\n+\n+    // Put \"OP_EVAL\" in the coinbase so everybody can tell when",
      "path": "src/main.cpp",
      "position": null,
      "original_position": 346,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "That's rather verbose. Why not just have some kind of code prefix like \"FM\" and then 16 feature bits, in case you want to do this again in future?\n",
      "created_at": "2011-11-30T23:18:42Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262770",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262770"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262777",
      "pull_request_review_id": null,
      "id": 262777,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2Mjc3Nw==",
      "diff_hunk": "@@ -70,20 +70,187 @@ static inline void popstack(vector<valtype>& stack)\n }\n \n \n-bool EvalScript(vector<vector<unsigned char> >& stack, const CScript& script, const CTransaction& txTo, unsigned int nIn, int nHashType)\n+const char* GetTxnTypeName(txntype t)\n+{\n+    switch (t)\n+    {\n+    case TX_NONSTANDARD: return \"nonstandard\";\n+    case TX_PUBKEY: return \"pubkey\";\n+    case TX_PUBKEYHASH: return \"pubkeyhash\";\n+    case TX_SCRIPTHASH: return \"scripthash\";\n+    case TX_MULTISIG: return \"multisig\";\n+    }\n+    return NULL;\n+}\n+\n+\n+const char* GetOpName(opcodetype opcode)\n+{\n+    switch (opcode)\n+    {\n+    // push value\n+    case OP_0                      : return \"0\";",
      "path": "src/script.cpp",
      "position": 24,
      "original_position": 24,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This sort of table is often done with a macro to avoid the possibility of typos.\n",
      "created_at": "2011-11-30T23:20:42Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262777",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262777"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 92,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262780",
      "pull_request_review_id": null,
      "id": 262780,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2Mjc4MA==",
      "diff_hunk": "@@ -844,6 +1013,30 @@ bool EvalScript(vector<vector<unsigned char> >& stack, const CScript& script, co\n                 }\n                 break;\n \n+                case OP_EVAL:\n+                {\n+                    if (!fStrictOpEval)\n+                        break; // Act as a NO_OP\n+\n+\n+                    // Evaluate the top item on the stack as a Script\n+                    // [serialized script ] -- [result(s) of executing script]\n+                    if (stack.size() < 1)\n+                        return false;\n+                    valtype& vchScript = stacktop(-1);\n+                    CScript subscript(vchScript.begin(), vchScript.end());\n+                    popstack(stack);\n+                    \n+                    // Codeseparators not allowed",
      "path": "src/script.cpp",
      "position": null,
      "original_position": 250,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Why forbid them?\n",
      "created_at": "2011-11-30T23:21:30Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262780",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262780"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262782",
      "pull_request_review_id": null,
      "id": 262782,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2Mjc4Mg==",
      "diff_hunk": "@@ -70,20 +70,187 @@ static inline void popstack(vector<valtype>& stack)\n }\n \n \n-bool EvalScript(vector<vector<unsigned char> >& stack, const CScript& script, const CTransaction& txTo, unsigned int nIn, int nHashType)\n+const char* GetTxnTypeName(txntype t)",
      "path": "src/script.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "These are actually types of scriptPubKeys, not transactions\n",
      "created_at": "2011-11-30T23:22:54Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262782",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262782"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262816",
      "pull_request_review_id": null,
      "id": 262816,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MjgxNg==",
      "diff_hunk": "@@ -993,170 +1209,317 @@ bool Solver(const CScript& scriptPubKey, vector<pair<opcodetype, valtype> >& vSo\n             if (pc1 == script1.end() && pc2 == script2.end())\n             {\n                 // Found a match\n-                reverse(vSolutionRet.begin(), vSolutionRet.end());\n+                typeRet = tplate.first;\n+                if (typeRet == TX_MULTISIG)\n+                {\n+                    // Additional checks for TX_MULTISIG:\n+                    unsigned char m = vSolutionsRet.front()[0];\n+                    unsigned char n = vSolutionsRet.back()[0];\n+                    if (m < 1 || n < 1 || m > n || vSolutionsRet.size()-2 != n)\n+                        return false;\n+                }\n                 return true;\n             }\n             if (!script1.GetOp(pc1, opcode1, vch1))\n                 break;\n             if (!script2.GetOp(pc2, opcode2, vch2))\n                 break;\n+\n+            // Template matching opcodes:\n+            if (opcode2 == OP_PUBKEYS)\n+            {\n+                while (vch1.size() >= 33 && vch1.size() <= 120)\n+                {\n+                    vSolutionsRet.push_back(vch1);\n+                    if (!script1.GetOp(pc1, opcode1, vch1))\n+                        break;\n+                }\n+                if (!script2.GetOp(pc2, opcode2, vch2))\n+                    break;\n+                // Normal situation is to fall through\n+                // to other if/else statments\n+            }\n+\n             if (opcode2 == OP_PUBKEY)\n             {\n                 if (vch1.size() < 33 || vch1.size() > 120)\n                     break;\n-                vSolutionRet.push_back(make_pair(opcode2, vch1));\n+                vSolutionsRet.push_back(vch1);\n             }\n             else if (opcode2 == OP_PUBKEYHASH)\n             {\n                 if (vch1.size() != sizeof(uint160))\n                     break;\n-                vSolutionRet.push_back(make_pair(opcode2, vch1));\n+                vSolutionsRet.push_back(vch1);\n+            }\n+            else if (opcode2 == OP_SCRIPTHASH)\n+            {\n+                if (vch1.size() != sizeof(uint160))\n+                    break;\n+                vSolutionsRet.push_back(vch1);\n+            }\n+            else if (opcode2 == OP_SMALLINTEGER)\n+            {   // Single-byte small integer pushed onto vSolutions\n+                if (opcode1 == OP_0 ||\n+                    (opcode1 >= OP_1 && opcode1 <= OP_16))\n+                {\n+                    char n = (char)CScript::DecodeOP_N(opcode1);\n+                    vSolutionsRet.push_back(valtype(1, n));\n+                }\n+                else\n+                    break;\n             }\n             else if (opcode1 != opcode2 || vch1 != vch2)\n             {\n+                // Others must match exactly\n                 break;\n             }\n         }\n     }\n \n-    vSolutionRet.clear();\n+    vSolutionsRet.clear();\n+    typeRet = TX_NONSTANDARD;\n     return false;\n }\n \n \n-bool Solver(const CKeyStore& keystore, const CScript& scriptPubKey, uint256 hash, int nHashType, CScript& scriptSigRet)\n+bool Sign1(const CBitcoinAddress& address, const CKeyStore& keystore, uint256 hash, int nHashType, CScript& scriptSigRet)\n {\n-    scriptSigRet.clear();\n+    CKey key;\n+    if (!keystore.GetKey(address, key))\n+        return false;\n \n-    vector<pair<opcodetype, valtype> > vSolution;\n-    if (!Solver(scriptPubKey, vSolution))\n+    vector<unsigned char> vchSig;\n+    if (!key.Sign(hash, vchSig))\n         return false;\n+    vchSig.push_back((unsigned char)nHashType);\n+    scriptSigRet << vchSig;\n+\n+    return true;\n+}\n \n-    // Compile solution\n-    BOOST_FOREACH(PAIRTYPE(opcodetype, valtype)& item, vSolution)\n+bool SignN(const vector<valtype>& multisigdata, const CKeyStore& keystore, uint256 hash, int nHashType, CScript& scriptSigRet)\n+{\n+    int nSigned = 0;\n+    int nRequired = multisigdata.front()[0];\n+    for (vector<valtype>::const_iterator it = multisigdata.begin()+1; it != multisigdata.begin()+multisigdata.size()-1; it++)\n     {\n-        if (item.first == OP_PUBKEY)\n-        {\n-            // Sign\n-            const valtype& vchPubKey = item.second;\n-            CKey key;\n-            if (!keystore.GetKey(Hash160(vchPubKey), key))\n-                return false;\n-            if (key.GetPubKey() != vchPubKey)\n-                return false;\n-            if (hash != 0)\n-            {\n-                vector<unsigned char> vchSig;\n-                if (!key.Sign(hash, vchSig))\n-                    return false;\n-                vchSig.push_back((unsigned char)nHashType);\n-                scriptSigRet << vchSig;\n-            }\n-        }\n-        else if (item.first == OP_PUBKEYHASH)\n+        const valtype& pubkey = *it;\n+        CBitcoinAddress address;\n+        address.SetPubKey(pubkey);\n+        if (Sign1(address, keystore, hash, nHashType, scriptSigRet))\n         {\n-            // Sign and give pubkey\n-            CKey key;\n-            if (!keystore.GetKey(uint160(item.second), key))\n-                return false;\n-            if (hash != 0)\n-            {\n-                vector<unsigned char> vchSig;\n-                if (!key.Sign(hash, vchSig))\n-                    return false;\n-                vchSig.push_back((unsigned char)nHashType);\n-                scriptSigRet << vchSig << key.GetPubKey();\n-            }\n+            ++nSigned;\n+            if (nSigned == nRequired) break;\n         }\n+    }\n+    return nSigned==nRequired;\n+}\n+\n+//\n+// Sign scriptPubKey with private keys stored in keystore, given transaction hash and hash type.\n+// Signatures are returned in scriptSigRet (or returns false if scriptPubKey can't be signed).\n+// Returns true if scriptPubKey could be completely satisified.\n+//\n+bool Solver(const CKeyStore& keystore, const CScript& scriptPubKey, uint256 hash, int nHashType, CScript& scriptSigRet)\n+{\n+    scriptSigRet.clear();\n+\n+    txntype whichType;\n+    vector<valtype> vSolutions;\n+    if (!Solver(scriptPubKey, whichType, vSolutions))\n+        return false;\n+\n+    CBitcoinAddress address;\n+    valtype subscript;\n+    switch (whichType)\n+    {\n+    case TX_NONSTANDARD:\n+        return false;\n+    case TX_PUBKEY:\n+        address.SetPubKey(vSolutions[0]);\n+        return Sign1(address, keystore, hash, nHashType, scriptSigRet);\n+    case TX_PUBKEYHASH:\n+        address.SetHash160(uint160(vSolutions[0]));\n+        if (!Sign1(address, keystore, hash, nHashType, scriptSigRet))\n+            return false;\n         else\n         {\n-            return false;\n+            valtype vch;\n+            keystore.GetPubKey(address, vch);\n+            scriptSigRet << vch;\n         }\n+        break;\n+    case TX_SCRIPTHASH:\n+        if (!keystore.GetCScript(uint160(vSolutions[0]), subscript))\n+            return false;\n+        if (!Solver(keystore, CScript(subscript.begin(), subscript.end()), hash, nHashType, scriptSigRet))\n+            return false;\n+        if (hash != 0)\n+            scriptSigRet << subscript; // signatures AND serialized script\n+        break;\n+    case TX_MULTISIG:\n+        scriptSigRet << OP_0; // workaround CHECKMULTISIG bug\n+        return (SignN(vSolutions, keystore, hash, nHashType, scriptSigRet));\n     }\n-\n     return true;\n }\n \n \n bool IsStandard(const CScript& scriptPubKey)\n {\n-    vector<pair<opcodetype, valtype> > vSolution;\n-    return Solver(scriptPubKey, vSolution);\n+    vector<valtype> vSolutions;\n+    txntype whichType;\n+    if (!Solver(scriptPubKey, whichType, vSolutions))\n+        return false;\n+\n+    if (whichType == TX_MULTISIG)\n+    {\n+        unsigned char m = vSolutions.front()[0];\n+        unsigned char n = vSolutions.back()[0];\n+        // Support up to x-of-3 multisig txns as standard\n+        if (n < 1 || n > 3)\n+            return false;\n+        if (m < 1 || m > n)\n+            return false;\n+    }\n+\n+    return whichType != TX_NONSTANDARD;\n }\n \n \n+int HaveKeys(const vector<valtype>& pubkeys, const CKeyStore& keystore)\n+{\n+    int nResult = 0;\n+    BOOST_FOREACH(const valtype& pubkey, pubkeys)\n+    {\n+        CBitcoinAddress address;\n+        address.SetPubKey(pubkey);\n+        if (keystore.HaveKey(address))\n+            ++nResult;\n+    }\n+    return nResult;\n+}\n+\n bool IsMine(const CKeyStore &keystore, const CScript& scriptPubKey)\n {\n-    vector<pair<opcodetype, valtype> > vSolution;\n-    if (!Solver(scriptPubKey, vSolution))\n+    vector<valtype> vSolutions;\n+    txntype whichType;\n+    if (!Solver(scriptPubKey, whichType, vSolutions))\n         return false;\n \n-    // Compile solution\n-    BOOST_FOREACH(PAIRTYPE(opcodetype, valtype)& item, vSolution)\n+    CBitcoinAddress address;\n+    switch (whichType)\n     {\n-        if (item.first == OP_PUBKEY)\n-        {\n-            const valtype& vchPubKey = item.second;\n-            vector<unsigned char> vchPubKeyFound;\n-            if (!keystore.GetPubKey(Hash160(vchPubKey), vchPubKeyFound))\n-                return false;\n-            if (vchPubKeyFound != vchPubKey)\n-                return false;\n-        }\n-        else if (item.first == OP_PUBKEYHASH)\n-        {\n-            if (!keystore.HaveKey(uint160(item.second)))\n-                return false;\n-        }\n-        else\n-        {\n+    case TX_NONSTANDARD:\n+        return false;\n+    case TX_PUBKEY:\n+        address.SetPubKey(vSolutions[0]);\n+        return keystore.HaveKey(address);\n+    case TX_PUBKEYHASH:\n+        address.SetHash160(uint160(vSolutions[0]));\n+        return keystore.HaveKey(address);\n+    case TX_SCRIPTHASH:\n+    {\n+        valtype subscript;\n+        if (!keystore.GetCScript(uint160(vSolutions[0]), subscript))\n             return false;\n-        }\n+        return IsMine(keystore, CScript(subscript.begin(), subscript.end()));\n     }\n-\n-    return true;\n+    case TX_MULTISIG:\n+    {\n+        // Only consider transactions \"mine\" if we own ALL the\n+        // keys involved. multi-signature transactions that are\n+        // partially owned (somebody else has a key that can spend\n+        // them) enable spend-out-from-under-you attacks, especially\n+        // in shared-wallet situations.\n+        vector<valtype> keys(vSolutions.begin()+1, vSolutions.begin()+vSolutions.size()-1);\n+        return HaveKeys(vSolutions, keystore);\n+    }\n+    }\n+    return false;\n }\n \n-bool static ExtractAddressInner(const CScript& scriptPubKey, const CKeyStore* keystore, CBitcoinAddress& addressRet)\n+bool ExtractAddress(const CScript& scriptPubKey, const CKeyStore* keystore, CBitcoinAddress& addressRet)\n {\n-    vector<pair<opcodetype, valtype> > vSolution;\n-    if (!Solver(scriptPubKey, vSolution))\n+    vector<valtype> vSolutions;\n+    txntype whichType;\n+    if (!Solver(scriptPubKey, whichType, vSolutions))\n         return false;\n \n-    BOOST_FOREACH(PAIRTYPE(opcodetype, valtype)& item, vSolution)\n+    if (whichType == TX_PUBKEY)\n     {\n-        if (item.first == OP_PUBKEY)\n-            addressRet.SetPubKey(item.second);\n-        else if (item.first == OP_PUBKEYHASH)\n-            addressRet.SetHash160((uint160)item.second);\n-        if (keystore == NULL || keystore->HaveKey(addressRet))\n-            return true;\n+        addressRet.SetPubKey(vSolutions[0]);\n+        return true;\n     }\n-\n+    else if (whichType == TX_PUBKEYHASH)\n+    {\n+        addressRet.SetHash160(uint160(vSolutions[0]));\n+        return true;\n+    }\n+    else if (whichType == TX_SCRIPTHASH)\n+    {\n+        addressRet.SetScriptHash160(uint160(vSolutions[0]));\n+        return true;\n+    }\n+    // Multisig txns have more than one address...\n     return false;\n }\n \n-\n-bool ExtractAddress(const CScript& scriptPubKey, const CKeyStore* keystore, CBitcoinAddress& addressRet)\n+bool ExtractAddresses(const CScript& scriptPubKey, const CKeyStore* keystore, txntype& typeRet, vector<CBitcoinAddress>& addressRet, int& nRequiredRet)\n {\n-    if (keystore)\n-        return ExtractAddressInner(scriptPubKey, keystore, addressRet);\n+    addressRet.clear();\n+    typeRet = TX_NONSTANDARD;\n+    vector<valtype> vSolutions;\n+    if (!Solver(scriptPubKey, typeRet, vSolutions))\n+        return false;\n+\n+    if (typeRet == TX_MULTISIG)\n+    {\n+        nRequiredRet = vSolutions.front()[0];\n+        int n = vSolutions.back()[0];\n+        for (vector<valtype>::const_iterator it = vSolutions.begin()+1; it != vSolutions.begin()+vSolutions.size()-1; it++)",
      "path": "src/script.cpp",
      "position": null,
      "original_position": 683,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "this might be clearer using integer indexs\n",
      "created_at": "2011-11-30T23:27:56Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262816",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262816"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262841",
      "pull_request_review_id": null,
      "id": 262841,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2Mjg0MQ==",
      "diff_hunk": "@@ -0,0 +1,250 @@\n+#include <boost/assert.hpp>\n+#include <boost/assign/list_of.hpp>\n+#include <boost/assign/list_inserter.hpp>\n+#include <boost/assign/std/vector.hpp>\n+#include <boost/test/unit_test.hpp>\n+#include <boost/foreach.hpp>\n+\n+#include \"../main.h\"\n+#include \"../script.h\"\n+#include \"../wallet.h\"\n+\n+using namespace std;\n+\n+// Test routines internal to script.cpp:\n+extern uint256 SignatureHash(CScript scriptCode, const CTransaction& txTo, unsigned int nIn, int nHashType);\n+extern bool VerifyScript(const CScript& scriptSig, const CScript& scriptPubKey, const CTransaction& txTo, unsigned int nIn, int& nSigOps,\n+                         int nHashType, bool fStrictOpEval);\n+\n+static const int64 nEvalSwitchover = 1328054400;\n+\n+struct CEvalFixture {\n+    CEvalFixture()\n+    {\n+        // Set mock time to AFTER OP_EVAL deployed\n+        SetMockTime(nEvalSwitchover+1);\n+    }\n+    ~CEvalFixture()\n+    {\n+        // Reset back to use-real-time\n+        SetMockTime(0);\n+    }\n+};\n+\n+BOOST_FIXTURE_TEST_SUITE(script_op_eval_tests, CEvalFixture)\n+\n+BOOST_AUTO_TEST_CASE(script_op_eval1)\n+{\n+    // OP_EVAL looks like this:\n+    // scriptSig:    <sig> <sig...> <serialized_script>\n+    // scriptPubKey: DUP HASH160 <hash> EQUALVERIFY EVAL\n+\n+    // Test SignSignature() (and therefore the version of Solver() that signs transactions)\n+    CBasicKeyStore keystore;\n+    CKey key[4];\n+    for (int i = 0; i < 4; i++)\n+    {\n+        key[i].MakeNewKey();\n+        keystore.AddKey(key[i]);\n+    }\n+\n+    // 8 Scripts: checking all combinations of\n+    // different keys, straight/EVAL, pubkey/pubkeyhash\n+    CScript standardScripts[4];\n+    standardScripts[0] << key[0].GetPubKey() << OP_CHECKSIG;\n+    standardScripts[1].SetBitcoinAddress(key[1].GetPubKey());\n+    standardScripts[2] << key[1].GetPubKey() << OP_CHECKSIG;\n+    standardScripts[3].SetBitcoinAddress(key[2].GetPubKey());\n+    CScript evalScripts[4];\n+    uint160 sigScriptHashes[4];\n+    for (int i = 0; i < 4; i++)\n+    {\n+        sigScriptHashes[i] = Hash160(standardScripts[i]);\n+        keystore.AddCScript(sigScriptHashes[i], standardScripts[i]);\n+        evalScripts[i] << OP_DUP << OP_HASH160 << sigScriptHashes[i] << OP_EQUALVERIFY << OP_EVAL;\n+    }\n+\n+    CTransaction txFrom;  // Funding transaction:\n+    txFrom.vout.resize(8);\n+    for (int i = 0; i < 4; i++)\n+    {\n+        txFrom.vout[i].scriptPubKey = evalScripts[i];\n+        txFrom.vout[i+4].scriptPubKey = standardScripts[i];\n+    }\n+    BOOST_CHECK(txFrom.IsStandard());\n+\n+    CTransaction txTo[8]; // Spending transactions\n+    for (int i = 0; i < 8; i++)\n+    {\n+        txTo[i].vin.resize(1);\n+        txTo[i].vout.resize(1);\n+        txTo[i].vin[0].prevout.n = i;\n+        txTo[i].vin[0].prevout.hash = txFrom.GetHash();\n+        txTo[i].vout[0].nValue = 1;\n+        BOOST_CHECK_MESSAGE(IsMine(keystore, txFrom.vout[i].scriptPubKey), strprintf(\"IsMine %d\", i));\n+    }\n+    for (int i = 0; i < 8; i++)\n+    {\n+        BOOST_CHECK_MESSAGE(SignSignature(keystore, txFrom, txTo[i], 0), strprintf(\"SignSignature %d\", i));\n+    }\n+    // All of the above should be OK, and the txTos have valid signatures\n+    // Check to make sure signature verification fails if we use the wrong ScriptSig:\n+    for (int i = 0; i < 8; i++)\n+        for (int j = 0; j < 8; j++)\n+        {\n+            CScript sigSave = txTo[i].vin[0].scriptSig;\n+            txTo[i].vin[0].scriptSig = txTo[j].vin[0].scriptSig;\n+            int nUnused = 0;\n+            bool sigOK = VerifySignature(txFrom, txTo[i], 0, nUnused);\n+            if (i == j)\n+                BOOST_CHECK_MESSAGE(sigOK, strprintf(\"VerifySignature %d %d\", i, j));\n+            else\n+                BOOST_CHECK_MESSAGE(!sigOK, strprintf(\"VerifySignature %d %d\", i, j));\n+            txTo[i].vin[0].scriptSig = sigSave;\n+        }\n+}\n+\n+BOOST_AUTO_TEST_CASE(script_op_eval2)\n+{\n+    // Test OP_EVAL edge cases\n+\n+    CScript recurse;\n+    recurse << OP_DUP << OP_EVAL;\n+\n+    uint160 recurseHash = Hash160(recurse);\n+\n+    CScript fund;\n+    fund << OP_DUP << OP_HASH160 << recurseHash << OP_EQUALVERIFY << OP_EVAL;\n+\n+    CTransaction txFrom;  // Funding transaction:\n+    txFrom.vout.resize(1);\n+    txFrom.vout[0].scriptPubKey = fund;\n+\n+    BOOST_CHECK(txFrom.IsStandard()); // Looks like a standard transaction until you try to spend it\n+\n+    CTransaction txTo;\n+    txTo.vin.resize(1);\n+    txTo.vout.resize(1);\n+    txTo.vin[0].prevout.n = 0;\n+    txTo.vin[0].prevout.hash = txFrom.GetHash();\n+    txTo.vin[0].scriptSig = CScript() << static_cast<std::vector<unsigned char> >(recurse);\n+    txTo.vout[0].nValue = 1;\n+\n+    int nUnused = 0;\n+    BOOST_CHECK(!VerifyScript(txTo.vin[0].scriptSig, txFrom.vout[0].scriptPubKey, txTo, 0, nUnused, 0, true));\n+    BOOST_CHECK(!VerifySignature(txFrom, txTo, 0, nUnused, true));\n+}\n+\n+BOOST_AUTO_TEST_CASE(script_op_eval3)\n+{\n+    // Test the CScript::Set* methods\n+    CBasicKeyStore keystore;\n+    CKey key[4];\n+    std::vector<CKey> keys;\n+    for (int i = 0; i < 4; i++)\n+    {\n+        key[i].MakeNewKey();\n+        keystore.AddKey(key[i]);\n+        keys.push_back(key[i]);\n+    }\n+\n+    CScript inner[4];\n+    inner[0].SetBitcoinAddress(key[0].GetPubKey());\n+    inner[1].SetMultisig(2, std::vector<CKey>(keys.begin(), keys.begin()+2));\n+    inner[2].SetMultisig(1, std::vector<CKey>(keys.begin(), keys.begin()+2));\n+    inner[3].SetMultisig(2, std::vector<CKey>(keys.begin(), keys.begin()+3));\n+\n+    CScript outer[4];\n+    for (int i = 0; i < 4; i++)\n+    {\n+        outer[i].SetEval(inner[i]);\n+        keystore.AddCScript(Hash160(inner[i]), inner[i]);\n+    }\n+\n+    CTransaction txFrom;  // Funding transaction:\n+    txFrom.vout.resize(4);\n+    for (int i = 0; i < 4; i++)\n+    {\n+        txFrom.vout[i].scriptPubKey = outer[i];\n+    }\n+    BOOST_CHECK(txFrom.IsStandard());\n+\n+    CTransaction txTo[4]; // Spending transactions\n+    for (int i = 0; i < 4; i++)\n+    {\n+        txTo[i].vin.resize(1);\n+        txTo[i].vout.resize(1);\n+        txTo[i].vin[0].prevout.n = i;\n+        txTo[i].vin[0].prevout.hash = txFrom.GetHash();\n+        txTo[i].vout[0].nValue = 1;\n+        txTo[i].vout[0].scriptPubKey = inner[i];\n+        BOOST_CHECK_MESSAGE(IsMine(keystore, txFrom.vout[i].scriptPubKey), strprintf(\"IsMine %d\", i));\n+    }\n+    for (int i = 0; i < 4; i++)\n+    {\n+        BOOST_CHECK_MESSAGE(SignSignature(keystore, txFrom, txTo[i], 0), strprintf(\"SignSignature %d\", i));\n+        BOOST_CHECK_MESSAGE(txTo[i].IsStandard(), strprintf(\"txTo[%d].IsStandard\", i));\n+    }\n+}\n+\n+BOOST_AUTO_TEST_CASE(script_op_eval_backcompat1)\n+{\n+    // Check backwards-incompatibility-testing code\n+    CScript returnsEleven;\n+    returnsEleven << OP_11;\n+\n+    // This should validate on new clients, but will\n+    // be invalid on old clients (that interpret OP_EVAL as a no-op)\n+    //  ... except there's a special rule that makes new clients reject\n+    // it.\n+    CScript fund;\n+    fund << OP_EVAL << OP_11 << OP_EQUAL;\n+\n+    CTransaction txFrom;  // Funding transaction:\n+    txFrom.vout.resize(1);\n+    txFrom.vout[0].scriptPubKey = fund;\n+\n+    CTransaction txTo;\n+    txTo.vin.resize(1);\n+    txTo.vout.resize(1);\n+    txTo.vin[0].prevout.n = 0;\n+    txTo.vin[0].prevout.hash = txFrom.GetHash();\n+    txTo.vin[0].scriptSig = CScript() << static_cast<std::vector<unsigned char> >(returnsEleven);\n+    txTo.vout[0].nValue = 1;\n+\n+    int nUnused = 0;\n+    BOOST_CHECK(!VerifyScript(txTo.vin[0].scriptSig, txFrom.vout[0].scriptPubKey, txTo, 0, nUnused, 0, true));\n+    BOOST_CHECK(!VerifySignature(txFrom, txTo, 0, nUnused, true));\n+}\n+\n+BOOST_AUTO_TEST_CASE(script_op_eval_switchover)\n+{\n+    // Test OP_EVAL switchover code\n+    CScript notValid;\n+    notValid << OP_11 << OP_12 << OP_EQUALVERIFY;\n+\n+    // This will be valid under old rules, invalid under new:\n+    CScript fund;\n+    fund << OP_EVAL;\n+\n+    CTransaction txFrom;  // Funding transaction:\n+    txFrom.vout.resize(1);\n+    txFrom.vout[0].scriptPubKey = fund;\n+\n+    CTransaction txTo;\n+    txTo.vin.resize(1);\n+    txTo.vout.resize(1);\n+    txTo.vin[0].prevout.n = 0;\n+    txTo.vin[0].prevout.hash = txFrom.GetHash();\n+    txTo.vin[0].scriptSig = CScript() << static_cast<std::vector<unsigned char> >(notValid);\n+    txTo.vout[0].nValue = 1;\n+\n+    int nUnused = 0;\n+    BOOST_CHECK(VerifyScript(txTo.vin[0].scriptSig, txFrom.vout[0].scriptPubKey, txTo, 0, nUnused, 0, false));\n+\n+    // After eval switchover, it should be considered invalid:\n+    SetMockTime(nEvalSwitchover);",
      "path": "src/test/script_op_eval_tests.cpp",
      "position": null,
      "original_position": 246,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Do you need to reset the mock time afterwards? Don't recall how this works.\n",
      "created_at": "2011-11-30T23:35:18Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262841",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262841"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262850",
      "pull_request_review_id": null,
      "id": 262850,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2Mjg1MA==",
      "diff_hunk": "@@ -365,6 +374,16 @@ int64 CWallet::GetDebit(const CTxIn &txin) const\n     return 0;\n }\n \n+bool CWallet::IsChange(const CTxOut& txout) const\n+{\n+    CBitcoinAddress address;\n+    if (ExtractAddress(txout.scriptPubKey, this, address) && !address.IsScript())\n+        CRITICAL_BLOCK(cs_wallet)\n+            if (!mapAddressBook.count(address))",
      "path": "src/wallet.cpp",
      "position": null,
      "original_position": 25,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "That's a bit confusing. Isn't there a simpler way to phrase this check?\n",
      "created_at": "2011-11-30T23:37:13Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r262850",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/262850"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263278",
      "pull_request_review_id": null,
      "id": 263278,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MzI3OA==",
      "diff_hunk": "@@ -28,17 +28,23 @@ public:\n     // This may succeed even if GetKey fails (e.g., encrypted wallets)\n     virtual bool GetPubKey(const CBitcoinAddress &address, std::vector<unsigned char>& vchPubKeyOut) const;\n \n+    virtual bool AddCScript(const uint160 &hash, const std::vector<unsigned char>& data) =0;\n+    virtual bool HaveCScript(const uint160 &hash) const =0;\n+    virtual bool GetCScript(const uint160 &hash, std::vector<unsigned char>& dataOut) const =0;\n+\n     // Generate a new key, and add it to the store\n     virtual std::vector<unsigned char> GenerateNewKey();\n };\n \n typedef std::map<CBitcoinAddress, CSecret> KeyMap;\n+typedef std::map<uint160, std::vector<unsigned char> > DataMap;\n \n // Basic key store, that keeps keys in an address->secret map\n class CBasicKeyStore : public CKeyStore\n {\n protected:\n     KeyMap mapKeys;\n+    DataMap mapData;",
      "path": "src/keystore.h",
      "position": null,
      "original_position": 20,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "gavinandresen",
        "id": 331997,
        "node_id": "MDQ6VXNlcjMzMTk5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gavinandresen",
        "html_url": "https://github.com/gavinandresen",
        "followers_url": "https://api.github.com/users/gavinandresen/followers",
        "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
        "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
        "repos_url": "https://api.github.com/users/gavinandresen/repos",
        "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I hate naming things... must be my Australian roots.  I'll call it Bruce.\n",
      "created_at": "2011-12-01T03:31:17Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r263278",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263278"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263279",
      "pull_request_review_id": null,
      "id": 263279,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MzI3OQ==",
      "diff_hunk": "@@ -241,6 +241,65 @@ bool CTransaction::ReadFromDisk(COutPoint prevout)\n     return ReadFromDisk(txdb, prevout, txindex);\n }\n \n+bool CTransaction::IsStandard() const\n+{\n+    BOOST_FOREACH(const CTxIn& txin, vin)\n+    {\n+        // Biggest 'standard' txin is a 3-signature 3-of-3 CHECKMULTISIG\n+        // in an OP_EVAL, which is 3 ~80-byte signatures, 3\n+        // ~65-byte public keys, plus a few script ops.\n+        if (txin.scriptSig.size() > 500)\n+            return error(\"nonstandard txin, size %d\\n\", txin.scriptSig.size());\n+        if (!txin.scriptSig.IsPushOnly())\n+            return error(\"nonstandard txin: %s\", txin.scriptSig.ToString().c_str());\n+    }\n+    BOOST_FOREACH(const CTxOut& txout, vout)\n+        if (!::IsStandard(txout.scriptPubKey))\n+            return error(\"nonstandard txout: %s\", txout.scriptPubKey.ToString().c_str());\n+    return true;\n+}\n+\n+//\n+// Check transaction inputs, and make sure any\n+// OP_EVAL transactions are evaluating IsStandard scripts\n+//\n+// Why bother? To avoid denial-of-service attacks; an attacker\n+// can submit a standard DUP HASH... OP_EVAL transaction,\n+// which will get accepted into blocks. The script being\n+// EVAL'ed can be anything; an attacker could use a very\n+// expensive-to-check-upon-redemption script like:\n+//   DUP CHECKSIG DROP ... repeated 100 times... OP_1\n+//\n+bool CTransaction::IsStandardInputs(std::map<uint256, std::pair<CTxIndex, CTransaction> > mapInputs) const\n+{\n+    if (fTestNet)\n+        return true; // Allow non-standard on testnet\n+\n+    for (int i = 0; i < vin.size(); i++)\n+    {\n+        COutPoint prevout = vin[i].prevout;\n+        assert(mapInputs.count(prevout.hash) > 0);\n+        CTransaction& txPrev = mapInputs[prevout.hash].second;\n+\n+        vector<vector<unsigned char> > vSolutions;\n+        txntype whichType;\n+        if (!Solver(txPrev.vout[vin[i].prevout.n].scriptPubKey, whichType, vSolutions))",
      "path": "src/main.cpp",
      "position": null,
      "original_position": 46,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "gavinandresen",
        "id": 331997,
        "node_id": "MDQ6VXNlcjMzMTk5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gavinandresen",
        "html_url": "https://github.com/gavinandresen",
        "followers_url": "https://api.github.com/users/gavinandresen/followers",
        "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
        "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
        "repos_url": "https://api.github.com/users/gavinandresen/repos",
        "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "That (and several of your other line comments here) is SatoshiCode, just moved around.  But you're right, this is a good opportunity to make it easier to read....\n",
      "created_at": "2011-12-01T03:33:47Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r263279",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263279"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263281",
      "pull_request_review_id": null,
      "id": 263281,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MzI4MQ==",
      "diff_hunk": "@@ -813,8 +882,61 @@ bool CTransaction::DisconnectInputs(CTxDB& txdb)\n }\n \n \n-bool CTransaction::ConnectInputs(CTxDB& txdb, map<uint256, CTxIndex>& mapTestPool, CDiskTxPos posThisTx,\n-                                 CBlockIndex* pindexBlock, int64& nFees, bool fBlock, bool fMiner, int64 nMinFee)\n+bool CTransaction::FetchInputs(CTxDB& txdb, const map<uint256, CTxIndex>& mapTestPool,\n+                               bool fBlock, bool fMiner, map<uint256, pair<CTxIndex, CTransaction> >& inputsRet)\n+{\n+    if (IsCoinBase())\n+        return true; // Coinbase transactions have no inputs to fetch.\n+    \n+    for (int i = 0; i < vin.size(); i++)\n+    {\n+        COutPoint prevout = vin[i].prevout;\n+        if (inputsRet.count(prevout.hash))\n+            continue; // Got it already\n+\n+        // Read txindex\n+        CTxIndex& txindex = inputsRet[prevout.hash].first;\n+        bool fFound = true;\n+        if ((fBlock || fMiner) && mapTestPool.count(prevout.hash))\n+        {\n+            // Get txindex from current proposed changes\n+            txindex = mapTestPool.find(prevout.hash)->second;\n+        }\n+        else\n+        {\n+            // Read txindex from txdb\n+            fFound = txdb.ReadTxIndex(prevout.hash, txindex);\n+        }\n+        if (!fFound && (fBlock || fMiner))\n+            return fMiner ? false : error(\"FetchInputs() : %s prev tx %s index entry not found\", GetHash().ToString().substr(0,10).c_str(),  prevout.hash.ToString().substr(0,10).c_str());\n+\n+        // Read txPrev\n+        CTransaction& txPrev = inputsRet[prevout.hash].second;\n+        if (!fFound || txindex.pos == CDiskTxPos(1,1,1))",
      "path": "src/main.cpp",
      "position": 157,
      "original_position": 155,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "gavinandresen",
        "id": 331997,
        "node_id": "MDQ6VXNlcjMzMTk5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gavinandresen",
        "html_url": "https://github.com/gavinandresen",
        "followers_url": "https://api.github.com/users/gavinandresen/followers",
        "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
        "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
        "repos_url": "https://api.github.com/users/gavinandresen/repos",
        "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Darn good question.  More SatoshiCode (in this case, I think just the indentation level changed).\n",
      "created_at": "2011-12-01T03:34:58Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r263281",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263281"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 930,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263283",
      "pull_request_review_id": null,
      "id": 263283,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MzI4Mw==",
      "diff_hunk": "@@ -877,9 +965,27 @@ bool CTransaction::ConnectInputs(CTxDB& txdb, map<uint256, CTxIndex>& mapTestPoo\n             // (before the last blockchain checkpoint). This is safe because block merkle hashes are\n             // still computed and checked, and any change will be caught at the next checkpoint.\n             if (!(fBlock && IsInitialBlockDownload()))\n+            {\n+                bool fStrictOpEval = true;\n+                // This code should be removed when OP_EVAL has\n+                // a majority of hashing power on the network.\n+                if (fBlock)\n+                {\n+                    // To avoid being on the short end of a block-chain split,\n+                    // interpret OP_EVAL as a NO_OP until blocks with timestamps\n+                    // after opevaltime:\n+                    int64 nEvalSwitchTime = GetArg(\"opevaltime\", 1328054400); // Feb 1, 2012",
      "path": "src/main.cpp",
      "position": 245,
      "original_position": 243,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "gavinandresen",
        "id": 331997,
        "node_id": "MDQ6VXNlcjMzMTk5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gavinandresen",
        "html_url": "https://github.com/gavinandresen",
        "followers_url": "https://api.github.com/users/gavinandresen/followers",
        "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
        "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
        "repos_url": "https://api.github.com/users/gavinandresen/repos",
        "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Luke-Jr was big on doing something like that. I don't think the extra code complication is worth it; this is the Simplest Possible Thing That Will Work.  Keeping track of frequency, or a signed message, means storing the message somewhere, or storing the frequency somewhere (or recomputing it in LoadBlockChain and recomputing it whenever there's a new block or a block chain reorg, etc etc etc).\n",
      "created_at": "2011-12-01T03:37:41Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r263283",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263283"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 992,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263289",
      "pull_request_review_id": null,
      "id": 263289,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MzI4OQ==",
      "diff_hunk": "@@ -2862,6 +2992,12 @@ void IncrementExtraNonce(CBlock* pblock, CBlockIndex* pindexPrev, unsigned int&\n     ++nExtraNonce;\n     pblock->vtx[0].vin[0].scriptSig = CScript() << pblock->nTime << CBigNum(nExtraNonce);\n     pblock->hashMerkleRoot = pblock->BuildMerkleTree();\n+\n+    // Put \"OP_EVAL\" in the coinbase so everybody can tell when",
      "path": "src/main.cpp",
      "position": null,
      "original_position": 346,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "gavinandresen",
        "id": 331997,
        "node_id": "MDQ6VXNlcjMzMTk5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gavinandresen",
        "html_url": "https://github.com/gavinandresen",
        "followers_url": "https://api.github.com/users/gavinandresen/followers",
        "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
        "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
        "repos_url": "https://api.github.com/users/gavinandresen/repos",
        "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Again, Simplest Possible Thing that will work.\n\nThe release after OP_EVAL has majority mining support this code will be removed-- I assume the big mining pools aren't going to remove support for it once they add support for it.  The next time with have an OP_EVAL-like change, we'll lobby miners to put some other string in their coinbases....\n",
      "created_at": "2011-12-01T03:40:41Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r263289",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263289"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263311",
      "pull_request_review_id": null,
      "id": 263311,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MzMxMQ==",
      "diff_hunk": "@@ -844,6 +1013,30 @@ bool EvalScript(vector<vector<unsigned char> >& stack, const CScript& script, co\n                 }\n                 break;\n \n+                case OP_EVAL:\n+                {\n+                    if (!fStrictOpEval)\n+                        break; // Act as a NO_OP\n+\n+\n+                    // Evaluate the top item on the stack as a Script\n+                    // [serialized script ] -- [result(s) of executing script]\n+                    if (stack.size() < 1)\n+                        return false;\n+                    valtype& vchScript = stacktop(-1);\n+                    CScript subscript(vchScript.begin(), vchScript.end());\n+                    popstack(stack);\n+                    \n+                    // Codeseparators not allowed",
      "path": "src/script.cpp",
      "position": null,
      "original_position": 250,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "gavinandresen",
        "id": 331997,
        "node_id": "MDQ6VXNlcjMzMTk5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gavinandresen",
        "html_url": "https://github.com/gavinandresen",
        "followers_url": "https://api.github.com/users/gavinandresen/followers",
        "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
        "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
        "repos_url": "https://api.github.com/users/gavinandresen/repos",
        "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Because they don't make sense inside OP_EVAL'ed code.\n\nExample:\nscriptPubKey: DUP HASH160 ...hash of serialized script... EQUALVERIFY EVAL\n\nRedeemed in a transaction that has:\nscriptSig:  <sig> <pubkey> serialized(stuff... CODESEPARATOR CHECKSIG)\n\nSo: CHECKSIG takes the part of the scriptPubKey from the last CODESEPARATOR to the end of the scriptPubKey and replaces the scriptSig with that.\n\nBut there is no CODESEPARATOR in the scriptPubKey.  It is buried inside the scriptSig.  The scriptSig that is signed will be DUP HASH160 <hash_of_serialized_script> EQUALVERIFY EVAL\n\nI suppose OP_EVAL could interact with OP_CHECKSIG so the scriptPubKey is rewritten to \"expand out\" all the OP_EVALs somehow before evaluation so CODESEPARATORS inside the EVAL would make sense...  but since I don't see a use for CODESEPARATOR and since that would add quite a lot of extra code and complication just disallowing CODESEPARATOR inside EVAL'd scripts seems like the correct thing to do.\n",
      "created_at": "2011-12-01T04:03:59Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r263311",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263311"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263314",
      "pull_request_review_id": null,
      "id": 263314,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MzMxNA==",
      "diff_hunk": "@@ -70,20 +70,187 @@ static inline void popstack(vector<valtype>& stack)\n }\n \n \n-bool EvalScript(vector<vector<unsigned char> >& stack, const CScript& script, const CTransaction& txTo, unsigned int nIn, int nHashType)\n+const char* GetTxnTypeName(txntype t)",
      "path": "src/script.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "gavinandresen",
        "id": 331997,
        "node_id": "MDQ6VXNlcjMzMTk5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gavinandresen",
        "html_url": "https://github.com/gavinandresen",
        "followers_url": "https://api.github.com/users/gavinandresen/followers",
        "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
        "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
        "repos_url": "https://api.github.com/users/gavinandresen/repos",
        "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Naming again....  GetScriptPubKeyTypeName ?    Is there a better term for \"part of a transaction that specifies the conditions necessary to redeem\" ?\n",
      "created_at": "2011-12-01T04:06:07Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r263314",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263314"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263697",
      "pull_request_review_id": null,
      "id": 263697,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MzY5Nw==",
      "diff_hunk": "@@ -70,20 +70,187 @@ static inline void popstack(vector<valtype>& stack)\n }\n \n \n-bool EvalScript(vector<vector<unsigned char> >& stack, const CScript& script, const CTransaction& txTo, unsigned int nIn, int nHashType)\n+const char* GetTxnTypeName(txntype t)",
      "path": "src/script.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "GetOutputType?\n",
      "created_at": "2011-12-01T11:17:54Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r263697",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263697"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263699",
      "pull_request_review_id": null,
      "id": 263699,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MzY5OQ==",
      "diff_hunk": "@@ -844,6 +1013,30 @@ bool EvalScript(vector<vector<unsigned char> >& stack, const CScript& script, co\n                 }\n                 break;\n \n+                case OP_EVAL:\n+                {\n+                    if (!fStrictOpEval)\n+                        break; // Act as a NO_OP\n+\n+\n+                    // Evaluate the top item on the stack as a Script\n+                    // [serialized script ] -- [result(s) of executing script]\n+                    if (stack.size() < 1)\n+                        return false;\n+                    valtype& vchScript = stacktop(-1);\n+                    CScript subscript(vchScript.begin(), vchScript.end());\n+                    popstack(stack);\n+                    \n+                    // Codeseparators not allowed",
      "path": "src/script.cpp",
      "position": null,
      "original_position": 250,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Makes sense. Best to put the explanation in a comment rather than a code review thread though.\n",
      "created_at": "2011-12-01T11:18:12Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r263699",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263699"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263701",
      "pull_request_review_id": null,
      "id": 263701,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2MzcwMQ==",
      "diff_hunk": "@@ -813,8 +882,61 @@ bool CTransaction::DisconnectInputs(CTxDB& txdb)\n }\n \n \n-bool CTransaction::ConnectInputs(CTxDB& txdb, map<uint256, CTxIndex>& mapTestPool, CDiskTxPos posThisTx,\n-                                 CBlockIndex* pindexBlock, int64& nFees, bool fBlock, bool fMiner, int64 nMinFee)\n+bool CTransaction::FetchInputs(CTxDB& txdb, const map<uint256, CTxIndex>& mapTestPool,\n+                               bool fBlock, bool fMiner, map<uint256, pair<CTxIndex, CTransaction> >& inputsRet)\n+{\n+    if (IsCoinBase())\n+        return true; // Coinbase transactions have no inputs to fetch.\n+    \n+    for (int i = 0; i < vin.size(); i++)\n+    {\n+        COutPoint prevout = vin[i].prevout;\n+        if (inputsRet.count(prevout.hash))\n+            continue; // Got it already\n+\n+        // Read txindex\n+        CTxIndex& txindex = inputsRet[prevout.hash].first;\n+        bool fFound = true;\n+        if ((fBlock || fMiner) && mapTestPool.count(prevout.hash))\n+        {\n+            // Get txindex from current proposed changes\n+            txindex = mapTestPool.find(prevout.hash)->second;\n+        }\n+        else\n+        {\n+            // Read txindex from txdb\n+            fFound = txdb.ReadTxIndex(prevout.hash, txindex);\n+        }\n+        if (!fFound && (fBlock || fMiner))\n+            return fMiner ? false : error(\"FetchInputs() : %s prev tx %s index entry not found\", GetHash().ToString().substr(0,10).c_str(),  prevout.hash.ToString().substr(0,10).c_str());\n+\n+        // Read txPrev\n+        CTransaction& txPrev = inputsRet[prevout.hash].second;\n+        if (!fFound || txindex.pos == CDiskTxPos(1,1,1))",
      "path": "src/main.cpp",
      "position": 157,
      "original_position": 155,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "mikehearn",
        "id": 971089,
        "node_id": "MDQ6VXNlcjk3MTA4OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/971089?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mikehearn",
        "html_url": "https://github.com/mikehearn",
        "followers_url": "https://api.github.com/users/mikehearn/followers",
        "following_url": "https://api.github.com/users/mikehearn/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mikehearn/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mikehearn/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
        "organizations_url": "https://api.github.com/users/mikehearn/orgs",
        "repos_url": "https://api.github.com/users/mikehearn/repos",
        "events_url": "https://api.github.com/users/mikehearn/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mikehearn/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yup, sorry, I realize it's not yours. Just might as well fix up minor things like this whilst there is attention on a particular part of the code.\n",
      "created_at": "2011-12-01T11:19:23Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r263701",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/263701"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 930,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/264336",
      "pull_request_review_id": null,
      "id": 264336,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2NDMzNg==",
      "diff_hunk": "@@ -0,0 +1,250 @@\n+#include <boost/assert.hpp>\n+#include <boost/assign/list_of.hpp>\n+#include <boost/assign/list_inserter.hpp>\n+#include <boost/assign/std/vector.hpp>\n+#include <boost/test/unit_test.hpp>\n+#include <boost/foreach.hpp>\n+\n+#include \"../main.h\"\n+#include \"../script.h\"\n+#include \"../wallet.h\"\n+\n+using namespace std;\n+\n+// Test routines internal to script.cpp:\n+extern uint256 SignatureHash(CScript scriptCode, const CTransaction& txTo, unsigned int nIn, int nHashType);\n+extern bool VerifyScript(const CScript& scriptSig, const CScript& scriptPubKey, const CTransaction& txTo, unsigned int nIn, int& nSigOps,\n+                         int nHashType, bool fStrictOpEval);\n+\n+static const int64 nEvalSwitchover = 1328054400;\n+\n+struct CEvalFixture {\n+    CEvalFixture()\n+    {\n+        // Set mock time to AFTER OP_EVAL deployed\n+        SetMockTime(nEvalSwitchover+1);\n+    }\n+    ~CEvalFixture()\n+    {\n+        // Reset back to use-real-time\n+        SetMockTime(0);\n+    }\n+};\n+\n+BOOST_FIXTURE_TEST_SUITE(script_op_eval_tests, CEvalFixture)\n+\n+BOOST_AUTO_TEST_CASE(script_op_eval1)\n+{\n+    // OP_EVAL looks like this:\n+    // scriptSig:    <sig> <sig...> <serialized_script>\n+    // scriptPubKey: DUP HASH160 <hash> EQUALVERIFY EVAL\n+\n+    // Test SignSignature() (and therefore the version of Solver() that signs transactions)\n+    CBasicKeyStore keystore;\n+    CKey key[4];\n+    for (int i = 0; i < 4; i++)\n+    {\n+        key[i].MakeNewKey();\n+        keystore.AddKey(key[i]);\n+    }\n+\n+    // 8 Scripts: checking all combinations of\n+    // different keys, straight/EVAL, pubkey/pubkeyhash\n+    CScript standardScripts[4];\n+    standardScripts[0] << key[0].GetPubKey() << OP_CHECKSIG;\n+    standardScripts[1].SetBitcoinAddress(key[1].GetPubKey());\n+    standardScripts[2] << key[1].GetPubKey() << OP_CHECKSIG;\n+    standardScripts[3].SetBitcoinAddress(key[2].GetPubKey());\n+    CScript evalScripts[4];\n+    uint160 sigScriptHashes[4];\n+    for (int i = 0; i < 4; i++)\n+    {\n+        sigScriptHashes[i] = Hash160(standardScripts[i]);\n+        keystore.AddCScript(sigScriptHashes[i], standardScripts[i]);\n+        evalScripts[i] << OP_DUP << OP_HASH160 << sigScriptHashes[i] << OP_EQUALVERIFY << OP_EVAL;\n+    }\n+\n+    CTransaction txFrom;  // Funding transaction:\n+    txFrom.vout.resize(8);\n+    for (int i = 0; i < 4; i++)\n+    {\n+        txFrom.vout[i].scriptPubKey = evalScripts[i];\n+        txFrom.vout[i+4].scriptPubKey = standardScripts[i];\n+    }\n+    BOOST_CHECK(txFrom.IsStandard());\n+\n+    CTransaction txTo[8]; // Spending transactions\n+    for (int i = 0; i < 8; i++)\n+    {\n+        txTo[i].vin.resize(1);\n+        txTo[i].vout.resize(1);\n+        txTo[i].vin[0].prevout.n = i;\n+        txTo[i].vin[0].prevout.hash = txFrom.GetHash();\n+        txTo[i].vout[0].nValue = 1;\n+        BOOST_CHECK_MESSAGE(IsMine(keystore, txFrom.vout[i].scriptPubKey), strprintf(\"IsMine %d\", i));\n+    }\n+    for (int i = 0; i < 8; i++)\n+    {\n+        BOOST_CHECK_MESSAGE(SignSignature(keystore, txFrom, txTo[i], 0), strprintf(\"SignSignature %d\", i));\n+    }\n+    // All of the above should be OK, and the txTos have valid signatures\n+    // Check to make sure signature verification fails if we use the wrong ScriptSig:\n+    for (int i = 0; i < 8; i++)\n+        for (int j = 0; j < 8; j++)\n+        {\n+            CScript sigSave = txTo[i].vin[0].scriptSig;\n+            txTo[i].vin[0].scriptSig = txTo[j].vin[0].scriptSig;\n+            int nUnused = 0;\n+            bool sigOK = VerifySignature(txFrom, txTo[i], 0, nUnused);\n+            if (i == j)\n+                BOOST_CHECK_MESSAGE(sigOK, strprintf(\"VerifySignature %d %d\", i, j));\n+            else\n+                BOOST_CHECK_MESSAGE(!sigOK, strprintf(\"VerifySignature %d %d\", i, j));\n+            txTo[i].vin[0].scriptSig = sigSave;\n+        }\n+}\n+\n+BOOST_AUTO_TEST_CASE(script_op_eval2)\n+{\n+    // Test OP_EVAL edge cases\n+\n+    CScript recurse;\n+    recurse << OP_DUP << OP_EVAL;\n+\n+    uint160 recurseHash = Hash160(recurse);\n+\n+    CScript fund;\n+    fund << OP_DUP << OP_HASH160 << recurseHash << OP_EQUALVERIFY << OP_EVAL;\n+\n+    CTransaction txFrom;  // Funding transaction:\n+    txFrom.vout.resize(1);\n+    txFrom.vout[0].scriptPubKey = fund;\n+\n+    BOOST_CHECK(txFrom.IsStandard()); // Looks like a standard transaction until you try to spend it\n+\n+    CTransaction txTo;\n+    txTo.vin.resize(1);\n+    txTo.vout.resize(1);\n+    txTo.vin[0].prevout.n = 0;\n+    txTo.vin[0].prevout.hash = txFrom.GetHash();\n+    txTo.vin[0].scriptSig = CScript() << static_cast<std::vector<unsigned char> >(recurse);\n+    txTo.vout[0].nValue = 1;\n+\n+    int nUnused = 0;\n+    BOOST_CHECK(!VerifyScript(txTo.vin[0].scriptSig, txFrom.vout[0].scriptPubKey, txTo, 0, nUnused, 0, true));\n+    BOOST_CHECK(!VerifySignature(txFrom, txTo, 0, nUnused, true));\n+}\n+\n+BOOST_AUTO_TEST_CASE(script_op_eval3)\n+{\n+    // Test the CScript::Set* methods\n+    CBasicKeyStore keystore;\n+    CKey key[4];\n+    std::vector<CKey> keys;\n+    for (int i = 0; i < 4; i++)\n+    {\n+        key[i].MakeNewKey();\n+        keystore.AddKey(key[i]);\n+        keys.push_back(key[i]);\n+    }\n+\n+    CScript inner[4];\n+    inner[0].SetBitcoinAddress(key[0].GetPubKey());\n+    inner[1].SetMultisig(2, std::vector<CKey>(keys.begin(), keys.begin()+2));\n+    inner[2].SetMultisig(1, std::vector<CKey>(keys.begin(), keys.begin()+2));\n+    inner[3].SetMultisig(2, std::vector<CKey>(keys.begin(), keys.begin()+3));\n+\n+    CScript outer[4];\n+    for (int i = 0; i < 4; i++)\n+    {\n+        outer[i].SetEval(inner[i]);\n+        keystore.AddCScript(Hash160(inner[i]), inner[i]);\n+    }\n+\n+    CTransaction txFrom;  // Funding transaction:\n+    txFrom.vout.resize(4);\n+    for (int i = 0; i < 4; i++)\n+    {\n+        txFrom.vout[i].scriptPubKey = outer[i];\n+    }\n+    BOOST_CHECK(txFrom.IsStandard());\n+\n+    CTransaction txTo[4]; // Spending transactions\n+    for (int i = 0; i < 4; i++)\n+    {\n+        txTo[i].vin.resize(1);\n+        txTo[i].vout.resize(1);\n+        txTo[i].vin[0].prevout.n = i;\n+        txTo[i].vin[0].prevout.hash = txFrom.GetHash();\n+        txTo[i].vout[0].nValue = 1;\n+        txTo[i].vout[0].scriptPubKey = inner[i];\n+        BOOST_CHECK_MESSAGE(IsMine(keystore, txFrom.vout[i].scriptPubKey), strprintf(\"IsMine %d\", i));\n+    }\n+    for (int i = 0; i < 4; i++)\n+    {\n+        BOOST_CHECK_MESSAGE(SignSignature(keystore, txFrom, txTo[i], 0), strprintf(\"SignSignature %d\", i));\n+        BOOST_CHECK_MESSAGE(txTo[i].IsStandard(), strprintf(\"txTo[%d].IsStandard\", i));\n+    }\n+}\n+\n+BOOST_AUTO_TEST_CASE(script_op_eval_backcompat1)\n+{\n+    // Check backwards-incompatibility-testing code\n+    CScript returnsEleven;\n+    returnsEleven << OP_11;\n+\n+    // This should validate on new clients, but will\n+    // be invalid on old clients (that interpret OP_EVAL as a no-op)\n+    //  ... except there's a special rule that makes new clients reject\n+    // it.\n+    CScript fund;\n+    fund << OP_EVAL << OP_11 << OP_EQUAL;\n+\n+    CTransaction txFrom;  // Funding transaction:\n+    txFrom.vout.resize(1);\n+    txFrom.vout[0].scriptPubKey = fund;\n+\n+    CTransaction txTo;\n+    txTo.vin.resize(1);\n+    txTo.vout.resize(1);\n+    txTo.vin[0].prevout.n = 0;\n+    txTo.vin[0].prevout.hash = txFrom.GetHash();\n+    txTo.vin[0].scriptSig = CScript() << static_cast<std::vector<unsigned char> >(returnsEleven);\n+    txTo.vout[0].nValue = 1;\n+\n+    int nUnused = 0;\n+    BOOST_CHECK(!VerifyScript(txTo.vin[0].scriptSig, txFrom.vout[0].scriptPubKey, txTo, 0, nUnused, 0, true));\n+    BOOST_CHECK(!VerifySignature(txFrom, txTo, 0, nUnused, true));\n+}\n+\n+BOOST_AUTO_TEST_CASE(script_op_eval_switchover)\n+{\n+    // Test OP_EVAL switchover code\n+    CScript notValid;\n+    notValid << OP_11 << OP_12 << OP_EQUALVERIFY;\n+\n+    // This will be valid under old rules, invalid under new:\n+    CScript fund;\n+    fund << OP_EVAL;\n+\n+    CTransaction txFrom;  // Funding transaction:\n+    txFrom.vout.resize(1);\n+    txFrom.vout[0].scriptPubKey = fund;\n+\n+    CTransaction txTo;\n+    txTo.vin.resize(1);\n+    txTo.vout.resize(1);\n+    txTo.vin[0].prevout.n = 0;\n+    txTo.vin[0].prevout.hash = txFrom.GetHash();\n+    txTo.vin[0].scriptSig = CScript() << static_cast<std::vector<unsigned char> >(notValid);\n+    txTo.vout[0].nValue = 1;\n+\n+    int nUnused = 0;\n+    BOOST_CHECK(VerifyScript(txTo.vin[0].scriptSig, txFrom.vout[0].scriptPubKey, txTo, 0, nUnused, 0, false));\n+\n+    // After eval switchover, it should be considered invalid:\n+    SetMockTime(nEvalSwitchover);",
      "path": "src/test/script_op_eval_tests.cpp",
      "position": null,
      "original_position": 246,
      "commit_id": "77f21f1583deb89bf3fffe80fe9b181fedb1dd60",
      "original_commit_id": "d433be28411ca4f8f9c8a2d3ad956238c418b02d",
      "in_reply_to_id": null,
      "user": {
        "login": "gavinandresen",
        "id": 331997,
        "node_id": "MDQ6VXNlcjMzMTk5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gavinandresen",
        "html_url": "https://github.com/gavinandresen",
        "followers_url": "https://api.github.com/users/gavinandresen/followers",
        "following_url": "https://api.github.com/users/gavinandresen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gavinandresen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gavinandresen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
        "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
        "repos_url": "https://api.github.com/users/gavinandresen/repos",
        "events_url": "https://api.github.com/users/gavinandresen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The test fixture resets mock time between tests.  Although the mock time doesn't matter any more-- a previous refactoring added Yet Another argument to VerifyScript that controls whether it interprets OP_EVAL as a no-op or not.  I'll fix the test case.\n",
      "created_at": "2011-12-01T16:57:25Z",
      "updated_at": "2011-12-20T17:22:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/669#discussion_r264336",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/264336"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/669"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    }
  ]
}